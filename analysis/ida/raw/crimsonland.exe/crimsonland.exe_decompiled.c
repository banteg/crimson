
// console_input_clear @ 0x00401030
// clears console input buffer
int sub_401030()
{
  console_input_ready = 0;
  dword_47EA54 = 0;
  byte_47E448 = 0;
  return 0;
}

// console_input_buffer @ 0x00401050
// returns console input buffer pointer
char *sub_401050()
{
  return &byte_47E448;
}

// console_input_poll @ 0x00401060
// polls text input and updates console buffer
int sub_401060()
{
  int result; // eax
  int v1; // eax
  int v2; // eax
  int v3; // ecx
  int v4; // ecx

  result = (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 80))(grim_interface_ptr);
  if ( !console_input_enabled )
    return result;
  if ( !result || console_input_ready )
    return 0;
  if ( result == 13 )
  {
    v1 = dword_47EA54;
    console_input_ready = 1;
    byte_47E448[dword_47EA54] = 0;
    dword_47EA54 = v1 + 1;
    return 0;
  }
  if ( result != 8 )
  {
    v3 = dword_47EA54;
    byte_47E448[dword_47EA54] = result;
    v4 = v3 + 1;
    dword_47EA54 = v4;
    if ( v4 >= 1024 )
      dword_47EA54 = --v4;
    byte_47E448[v4] = 0;
    return 0;
  }
  v2 = dword_47EA54;
  if ( dword_47EA54 > 0 )
    v2 = --dword_47EA54;
  byte_47E448[v2] = 0;
  return 0;
}

// FUN_004010f0 @ 0x004010F0
// [binja] int32_t __stdcall sub_4010f0(int32_t arg1, int32_t arg2, int32_t arg3, int32_t arg4)
int __stdcall sub_4010F0(int a1, int a2, int a3, int (__thiscall *a4)(int))
{
  int result; // eax
  int v6; // edi

  result = a3 - 1;
  if ( a3 - 1 >= 0 )
  {
    v6 = a3;
    do
    {
      result = a4(a1);
      a1 += a2;
      --v6;
    }
    while ( v6 );
  }
  return result;
}

// FUN_00401120 @ 0x00401120
// [binja] void* sub_401120(int32_t arg1)
char *__cdecl sub_401120(int a1)
{
  if ( dword_47F4CC <= 0 || a1 <= 0 || a1 >= dword_47F4CC )
    return (char *)off_471158;
  else
    return *(char **)&dword_47EA60[4 * a1];
}

// FUN_00401150 @ 0x00401150
// [binja] int32_t sub_401150()
int sub_401150()
{
  return dword_47F4CC;
}

// sub_401160 @ 0x00401160
// [binja] int32_t sub_401180()
int sub_401160()
{
  FUN_00401170();
  return crt_atexit(unknown_libname_2);
}

// console_clear_log @ 0x004011A0
// clears console log history and resets scroll state (clear command handler)
int sub_4011A0()
{
  _DWORD *v0; // esi
  int v1; // ecx
  int result; // eax

  v0 = (_DWORD *)console_log_head;
  if ( console_log_head )
  {
    if ( *(_DWORD *)console_log_head )
      crt_free(*(LPVOID *)console_log_head);
    v1 = v0[1];
    *v0 = 0;
    if ( v1 )
      console_log_node_free(1);
    v0[1] = 0;
    result = crt_free(v0);
  }
  console_log_head = 0;
  dword_47EEC0 = 0;
  dword_47EEC4 = 0;
  return result;
}

// console_log_node_free @ 0x004011F0
// frees a console log node (text + next chain) and optionally frees the node
int __thiscall sub_4011F0(int this, char a2)
{
  int v3; // ecx

  if ( *(_DWORD *)this )
    crt_free(*(LPVOID *)this);
  v3 = *(_DWORD *)(this + 4);
  *(_DWORD *)this = 0;
  if ( v3 )
    console_log_node_free(1);
  *(_DWORD *)(this + 4) = 0;
  if ( (a2 & 1) != 0 )
    crt_free((LPVOID)this);
  return this;
}

// console_cmd_quit @ 0x00401240
// sets the quit/exit flag (quit command handler)
void sub_401240()
{
  byte_47EA50 = 1;
}

// console_cmd_exec @ 0x00401250
// executes a script file via console_exec_line (exec command handler)
int sub_401250()
{
  FILE *v1; // esi
  char *v2; // eax
  char v3; // [esp+0h] [ebp-4h]

  if ( dword_47F4CC != 2 )
    return console_printf((int)&console_log_queue, aExecScript, v3);
  v1 = crt_fopen(ArgList, Mode);
  if ( !v1 )
    return console_printf((int)&console_log_queue, aCannotOpenFile, (char)ArgList);
  console_printf((int)&console_log_queue, aExecutingS, (char)ArgList);
  while ( FUN_00460fac(&Buffer, 511, v1) )
  {
    v2 = strchr(&Buffer, 10);
    if ( v2 )
      *v2 = 0;
    byte_47EA47 = 0;
    if ( Buffer != 47 && byte_47E849 != 47 && Buffer != 10 && Buffer && Buffer != 35 )
      console_exec_line((int)&console_log_queue, (int)&Buffer);
  }
  return crt_fclose(v1);
}

// console_cmd_extend @ 0x00401340
// extends console height (extendconsole command handler)
__int64 console_cmd_extend()
{
  __int64 result; // rax

  result = (__int64)flt_471144;
  console_height_px = result;
  return result;
}

// console_cmd_minimize @ 0x00401360
// minimizes console height (minimizeconsole command handler)
void sub_401360()
{
  console_height_px = 300;
}

// console_cmdlist @ 0x00401370
// prints registered command names and a count (cmdlist command handler)
int sub_401370()
{
  _DWORD *v0; // esi
  char v1; // di

  v0 = (_DWORD *)console_command_list_head;
  v1 = 0;
  if ( console_command_list_head )
  {
    do
    {
      console_printf((int)&console_log_queue, aS_4, *v0);
      v0 = (_DWORD *)v0[1];
      ++v1;
    }
    while ( v0 );
  }
  return console_printf((int)&console_log_queue, aICommands, v1);
}

// console_vars @ 0x004013C0
// prints registered cvar names and a count (vars command handler)
int sub_4013C0()
{
  _DWORD *v0; // esi
  char v1; // di

  v0 = (_DWORD *)console_log_queue;
  v1 = 0;
  if ( console_log_queue )
  {
    do
    {
      console_printf((int)&console_log_queue, aS_4, *v0);
      v0 = (_DWORD *)v0[1];
      ++v1;
    }
    while ( v0 );
  }
  return console_printf((int)&console_log_queue, aIVariables, v1);
}

// console_echo @ 0x00401410
// toggles echo on/off or prints args back into the console (echo command handler)
int sub_401410()
{
  int result; // eax
  int i; // esi
  char v2; // al
  char v3; // [esp+0h] [ebp-8h]

  if ( FUN_00401150() != 2 || (result = strcmp(aOff, FUN_00401120(1))) != 0 )
  {
    if ( FUN_00401150() != 2 || (result = strcmp(aOn, FUN_00401120(1))) != 0 )
    {
      for ( i = 1; i < FUN_00401150(); ++i )
      {
        v2 = (unsigned __int8)FUN_00401120(i);
        console_printf((int)&console_log_queue, aS_5, v2);
      }
      return console_printf((int)&console_log_queue, asc_4711C0, v3);
    }
    else
    {
      console_echo_enabled = 1;
    }
  }
  else
  {
    console_echo_enabled = 0;
  }
  return result;
}

// console_cmd_set @ 0x00401510
// sets a cvar from tokens (set command handler)
char console_cmd_set()
{
  const char **v1; // eax

  if ( dword_47F4CC != 3 )
    return console_printf((int)&console_log_queue, aSetVarValue);
  v1 = (const char **)console_register_cvar((char ***)&console_log_queue, ArgList, dword_47EA68);
  return console_printf((int)&console_log_queue, "'%s' set to '%s'\n", *v1, v1[4]);
}

// console_init @ 0x00401560
// initializes the console state, registers core commands/cvars, and seeds prompt/version strings
_BYTE *__thiscall sub_401560(_BYTE *this)
{
  char **v2; // eax
  char **v3; // edi
  _DWORD *v4; // eax

  *(this + 12) = 1;
  *((_DWORD *)this + 6) = 300;
  *((_DWORD *)this + 7) = -1013579776;
  *((_DWORD *)this + 9) = 0;
  *((_DWORD *)this + 2) = 0;
  v2 = (char **)operator new(0x24u);
  v3 = v2;
  if ( v2 )
  {
    v2[6] = 0;
    v2[7] = 0;
    v2[8] = 0;
    *v2 = strdup_malloc(aVersion);
    v3[1] = 0;
    v3[2] = 0;
    v3[3] = 0;
    v3[4] = 0;
    v3[5] = 0;
  }
  else
  {
    v3 = 0;
  }
  *(_DWORD *)this = v3;
  v3[3] = (char *)1065353216;
  *(_DWORD *)(*(_DWORD *)this + 16) = strdup_malloc(a07);
  *(_DWORD *)(*(_DWORD *)this + 20) = 1;
  dword_47F4D0 = console_register_cvar(aConMonofont, a1);
  *(_DWORD *)dword_47EAA0 = 0;
  dword_47EAA4 = 0;
  dword_47EAA8 = 0;
  dword_47EAAC = 0;
  dword_47F4CC = 0;
  console_register_command(console_cmd_cmdlist, (int)console_cmdlist);
  console_register_command(console_cmd_vars, (int)console_vars);
  console_register_command(console_cmd_echo, (int)console_echo);
  console_register_command(aSet, (int)console_cmd_set);
  console_register_command(aQuit, (int)console_cmd_quit);
  console_register_command(console_cmd_clear, (int)console_clear_log);
  console_register_command(aExtendconsole, (int)console_cmd_extend);
  console_register_command(aMinimizeconsol, (int)console_cmd_minimize);
  console_register_command(aExec, (int)console_cmd_exec);
  v4 = operator new(8u);
  if ( v4 )
  {
    v4[1] = 0;
    *v4 = 0;
  }
  else
  {
    v4 = 0;
  }
  *((_DWORD *)this + 4) = v4;
  **((_DWORD **)this + 4) = strdup_malloc(szPassword);
  *((_DWORD *)this + 5) = 0;
  return this;
}

// FUN_004016e0 @ 0x004016E0
// [binja] void __fastcall sub_4016e0(int32_t* arg1)
int __thiscall sub_4016E0(LPVOID **this)
{
  int v2; // esi
  int v3; // ecx
  int result; // eax
  LPVOID *v5; // esi
  LPVOID *v6; // esi
  int v7; // esi
  int v8; // ecx

  v2 = (int)*(this + 2);
  if ( v2 )
  {
    if ( *(_DWORD *)v2 )
      crt_free(*(LPVOID *)v2);
    v3 = *(_DWORD *)(v2 + 4);
    *(_DWORD *)v2 = 0;
    if ( v3 )
      console_log_node_free(v3, 1);
    *(_DWORD *)(v2 + 4) = 0;
    result = crt_free((LPVOID)v2);
  }
  v5 = *this;
  *(this + 2) = 0;
  if ( v5 )
  {
    if ( *v5 )
      crt_free(*v5);
    *v5 = 0;
    result = crt_free(v5);
  }
  v6 = *(this + 1);
  *this = 0;
  if ( v6 )
  {
    if ( *v6 )
      crt_free(*v6);
    *v6 = 0;
    result = crt_free(v6);
  }
  v7 = (int)*(this + 4);
  *(this + 1) = 0;
  if ( v7 )
  {
    if ( *(_DWORD *)v7 )
      crt_free(*(LPVOID *)v7);
    v8 = *(_DWORD *)(v7 + 4);
    *(_DWORD *)v7 = 0;
    if ( v8 )
      console_log_node_free(v8, 1);
    *(_DWORD *)(v7 + 4) = 0;
    result = crt_free((LPVOID)v7);
  }
  *(this + 4) = 0;
  return result;
}

// console_push_line @ 0x004017A0
// pushes line into console queue
char __thiscall sub_4017A0(int this, char *Source)
{
  int v3; // eax
  int v4; // esi
  int i; // eax
  int v6; // edi
  int v7; // ecx
  char **v8; // eax
  char **v9; // esi

  LOBYTE(v3) = *(_BYTE *)(this + 12);
  if ( (_BYTE)v3 )
  {
    if ( *(_DWORD *)(this + 32) == 4096 )
    {
      v4 = *(_DWORD *)(this + 8);
      for ( i = *(_DWORD *)(v4 + 4); *(_DWORD *)(i + 4); i = *(_DWORD *)(i + 4) )
        v4 = i;
      v6 = *(_DWORD *)(v4 + 4);
      if ( v6 )
      {
        if ( *(_DWORD *)v6 )
          crt_free(*(LPVOID *)v6);
        v7 = *(_DWORD *)(v6 + 4);
        *(_DWORD *)v6 = 0;
        if ( v7 )
          console_log_node_free(v7, 1);
        *(_DWORD *)(v6 + 4) = 0;
        crt_free((LPVOID)v6);
      }
      *(_DWORD *)(v4 + 4) = 0;
      --*(_DWORD *)(this + 32);
    }
    v8 = (char **)operator new(8u);
    if ( v8 )
    {
      v8[1] = 0;
      *v8 = 0;
      v9 = v8;
    }
    else
    {
      v9 = 0;
    }
    *v9 = strdup_malloc(Source);
    v9[1] = *(char **)(this + 8);
    v3 = *(_DWORD *)(this + 32) + 1;
    *(_DWORD *)(this + 8) = v9;
    *(_DWORD *)(this + 32) = v3;
  }
  return v3;
}

// console_printf @ 0x00401870
// formats then pushes line
char sub_401870(int a1, char *Format, ...)
{
  char result; // al
  va_list va; // [esp+10h] [ebp+Ch] BYREF

  va_start(va, Format);
  result = *(_BYTE *)(a1 + 12);
  if ( result )
  {
    crt_vsprintf(byte_47F2CC, Format, va);
    return console_push_line(a1, byte_47F2CC);
  }
  return result;
}

// console_set_open @ 0x004018B0
// sets console_open_flag (console_state+0x28) and console_input_enabled (0x0047f4d4); flushes input via Grim2D vtable +0x4c
int __thiscall sub_4018B0(_BYTE *this, char a2)
{
  *(this + 40) = a2;
  console_input_enabled = a2;
  return (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
}

// console_history_apply @ 0x004018D0
// loads a history entry into the input buffer (used by Up/Down navigation)
int __thiscall sub_4018D0(_DWORD *this)
{
  int v1; // eax
  int v2; // edx
  int v3; // edi

  v1 = *(this + 4);
  v2 = 0;
  v3 = *(this + 5) - 1;
  if ( v3 > 0 )
  {
    while ( *(_DWORD *)(v1 + 4) )
    {
      ++v2;
      v1 = *(_DWORD *)(v1 + 4);
      if ( v2 >= v3 )
        goto LABEL_6;
    }
    *(this + 5) = v2;
  }
LABEL_6:
  strcpy(byte_47E448, *(const char **)v1);
  dword_47EA54 = strlen(byte_47E448);
  console_input_ready = 0;
  return 0;
}

// console_exec_line @ 0x00401940
// executes a console command or cvar assignment from a line
char __thiscall sub_401940(char *this, int a2)
{
  char result; // al
  const char **v4; // esi
  int v5; // eax
  double v6; // st7

  console_tokenize_line(a2);
  result = dword_47F4CC;
  if ( dword_47F4CC )
  {
    v4 = (const char **)console_cvar_find(*(_DWORD *)dword_47EA60);
    v5 = console_command_find(*(_DWORD *)dword_47EA60);
    if ( v4 )
    {
      if ( dword_47F4CC == 2 )
      {
        if ( v4[4] )
          crt_free((LPVOID)v4[4]);
        v4[4] = 0;
        v4[4] = strdup_malloc(ArgList);
        v6 = crt_atof_l(ArgList);
        *((float *)v4 + 3) = v6;
        result = *(this + 12);
        if ( result )
          return console_printf((int)this, "\"%s\" set to \"%s\" (%ff)\n", *v4, v4[4], v6);
      }
      else
      {
        result = *(this + 12);
        if ( result )
          return console_printf((int)this, "\"%s\" is \"%s\" (%ff)\n", *v4, v4[4], *((float *)v4 + 3));
      }
    }
    else if ( v5 )
    {
      return (*(int (**)(void))(v5 + 8))();
    }
    else
    {
      return console_printf((int)this, "Unknown command \"%s\"\n", *(const char **)dword_47EA60);
    }
  }
  return result;
}

// console_update @ 0x00401A40
// console update loop: input polling, history, autocomplete, and key handling
void __usercall sub_401A40(int a1@<ecx>, int a2@<edi>, int a3@<esi>)
{
  double v3; // st7
  double v5; // st7
  int v6; // eax
  int v7; // eax
  char *v8; // eax
  char *v9; // eax
  const char *v10; // edx
  char *v11; // eax
  char **v12; // eax
  char **v13; // esi
  char *v14; // eax
  char *v15; // eax
  char *v16; // eax
  double v17; // st7

  v3 = *(float *)&dword_47EA48 * 3.5;
  if ( *(_BYTE *)(a1 + 40) )
  {
    v5 = flt_47115C - v3;
    flt_47115C = v5;
    if ( v5 < 0.0 )
      flt_47115C = 0.0;
    *(float *)(a1 + 28) = sin((1.0 - flt_47115C) * 1.5707964) * (double)*(int *)(a1 + 24) - (double)*(int *)(a1 + 24);
    console_input_poll();
    if ( ((*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 29)
       || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 157))
      && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 200) )
    {
      ++*(_DWORD *)(a1 + 36);
    }
    else if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(
                grim_interface_ptr,
                200) )
    {
      ++*(_DWORD *)(a1 + 20);
      console_history_apply((_DWORD *)a1);
    }
    if ( ((*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 29)
       || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 157))
      && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 208) )
    {
      --*(_DWORD *)(a1 + 36);
    }
    else if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(
                grim_interface_ptr,
                208) )
    {
      v6 = *(_DWORD *)(a1 + 20) - 1;
      *(_DWORD *)(a1 + 20) = v6;
      if ( v6 < 0 )
        *(_DWORD *)(a1 + 20) = 0;
      console_history_apply((_DWORD *)a1);
    }
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 203) )
    {
      if ( --dword_47EA54 < 0 )
        dword_47EA54 = 0;
    }
    if ( (*(unsigned __int8 (__thiscall **)(int, int, int, int))(*(_DWORD *)grim_interface_ptr + 72))(
           grim_interface_ptr,
           205,
           a2,
           a3) )
    {
      ++dword_47EA54;
      if ( dword_47EA54 > (int)strlen(byte_47E448) )
        dword_47EA54 = strlen(byte_47E448);
    }
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 201) )
      *(_DWORD *)(a1 + 36) += 2;
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 209) )
    {
      v7 = *(_DWORD *)(a1 + 36);
      *(_DWORD *)(a1 + 36) = v7 - 2;
      if ( v7 - 2 < 0 )
        *(_DWORD *)(a1 + 36) = 0;
    }
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 199) )
      *(_DWORD *)(a1 + 36) += 20;
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 207) )
      *(_DWORD *)(a1 + 36) = 0;
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 15) )
    {
      v8 = console_input_buffer();
      console_tokenize_line(v8);
      v9 = console_input_buffer();
      v10 = (const char *)console_cvar_autocomplete(v9);
      if ( v10 || (v11 = console_input_buffer(), (v10 = (const char *)console_command_autocomplete(v11)) != 0) )
      {
        strcpy(byte_47E448, v10);
        dword_47EA54 = strlen(v10);
      }
    }
    if ( console_input_ready )
    {
      if ( strcmp(**(const char ***)(a1 + 16), console_input_buffer()) )
      {
        v12 = (char **)operator new(8u);
        if ( v12 )
        {
          v12[1] = 0;
          *v12 = 0;
          v13 = v12;
        }
        else
        {
          v13 = 0;
        }
        v14 = console_input_buffer();
        *v13 = strdup_malloc(v14);
        v13[1] = *(char **)(a1 + 16);
        *(_DWORD *)(a1 + 16) = v13;
      }
      *(_DWORD *)(a1 + 20) = 0;
      v15 = console_input_buffer();
      console_printf((int)&console_log_queue, "> %s\n", v15);
      v16 = console_input_buffer();
      console_exec_line((char *)a1, (int)v16);
      console_input_clear();
      (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28);
    }
    else
    {
      console_input_buffer();
      (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28);
    }
  }
  else
  {
    v17 = v3 + flt_47115C;
    flt_47115C = v17;
    if ( v17 > 1.0 )
      flt_47115C = 1.0;
    *(float *)(a1 + 28) = sin((1.0 - flt_47115C) * 1.5707964) * (double)*(int *)(a1 + 24) - (double)*(int *)(a1 + 24);
  }
}

// FUN_00401dd0 @ 0x00401DD0
// [binja] int32_t __fastcall sub_401dd0(void* arg1)
void __thiscall sub_401DD0(int this)
{
  int v2; // ecx
  int *v3; // edi
  int v4; // ebp
  double v5; // st7
  double v6; // st7
  double v7; // st7
  double v8; // st6
  int v9; // ebx
  char *v10; // eax
  int v11; // ebx
  int v12; // eax
  int v13; // ebx
  int v14; // edx
  char v16; // c3
  int v17; // edi
  int v18; // edi
  long double v19; // st7
  long double v20; // st7
  double v21; // st7
  int v22; // edx
  int v23; // ebx
  char *v24; // eax
  int v25; // [esp+D8h] [ebp-38h]
  int v26; // [esp+D8h] [ebp-38h]
  float v27; // [esp+D8h] [ebp-38h]
  float v28; // [esp+D8h] [ebp-38h]
  float v29; // [esp+D8h] [ebp-38h]
  int v30; // [esp+D8h] [ebp-38h]
  float v31; // [esp+DCh] [ebp-34h]
  int v32; // [esp+DCh] [ebp-34h]
  int v33; // [esp+DCh] [ebp-34h]
  float v34; // [esp+DCh] [ebp-34h]
  float v35; // [esp+DCh] [ebp-34h]
  float v36; // [esp+DCh] [ebp-34h]
  float v37; // [esp+DCh] [ebp-34h]
  float v38; // [esp+DCh] [ebp-34h]
  int v39; // [esp+DCh] [ebp-34h]
  float v40; // [esp+DCh] [ebp-34h]
  float v41; // [esp+E0h] [ebp-30h]
  int v42; // [esp+E0h] [ebp-30h]
  int v43; // [esp+E0h] [ebp-30h]
  float v44; // [esp+E0h] [ebp-30h]
  float v45; // [esp+E0h] [ebp-30h]
  float v46; // [esp+E0h] [ebp-30h]
  char *v47; // [esp+E0h] [ebp-30h]
  float v48; // [esp+E0h] [ebp-30h]
  int v49; // [esp+E0h] [ebp-30h]
  int v50; // [esp+E0h] [ebp-30h]
  float v51; // [esp+E0h] [ebp-30h]
  float v52; // [esp+F4h] [ebp-1Ch]
  float v53; // [esp+F4h] [ebp-1Ch]
  float v54; // [esp+F4h] [ebp-1Ch]
  int v55; // [esp+F4h] [ebp-1Ch]
  int v56; // [esp+F4h] [ebp-1Ch]
  float v57; // [esp+F4h] [ebp-1Ch]
  int v58; // [esp+F8h] [ebp-18h] BYREF
  float v59; // [esp+FCh] [ebp-14h]
  int v60; // [esp+100h] [ebp-10h] BYREF
  int v61; // [esp+104h] [ebp-Ch]
  int v62; // [esp+108h] [ebp-8h]
  float v63; // [esp+10Ch] [ebp-4h]

  v2 = *(_DWORD *)(this + 24);
  v58 = -v2;
  if ( (double)-v2 < *(float *)(this + 28) )
  {
    v3 = *(int **)(this + 8);
    v4 = v2 / 16 - 2;
    if ( *(_DWORD *)(this + 32) <= v4 )
      v4 = *(_DWORD *)(this + 32);
    v52 = ((double)v2 + *(float *)(this + 28)) / (double)v2;
    if ( v52 <= 1.0 )
    {
      if ( v52 < 0.0 )
        v52 = 0.0;
    }
    else
    {
      v52 = 1.0;
    }
    (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1058642330,
      1058642330,
      1058642330,
      COERCE_FLOAT(LODWORD(v52)));
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    v5 = *(float *)(this + 28);
    v63 = v52;
    v59 = v5;
    v6 = (double)*(int *)(this + 24);
    v60 = 1041235968;
    v61 = 1044381696;
    v62 = 1049886720;
    v31 = v6;
    *(float *)&v58 = 0.0;
    (*(void (__thiscall **)(int, int *, _DWORD, _DWORD, int *))(*(_DWORD *)grim_interface_ptr + 208))(
      grim_interface_ptr,
      &v58,
      LODWORD(screen_width_f),
      LODWORD(v31),
      &v60);
    v41 = ((double)*(int *)(this + 24) + *(float *)(this + 28)) / (double)*(int *)(this + 24);
    (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      1036831949,
      1058642330,
      1065353216,
      LODWORD(v41));
    v7 = (double)*(int *)(this + 24);
    v8 = v7 + *(float *)(this + 28);
    v60 = 1046478848;
    v61 = 1049100288;
    v62 = 1052508160;
    *(float *)&v58 = 0.0;
    v53 = v8;
    v63 = v8 / v7;
    v59 = v53 - 4.0;
    (*(void (__thiscall **)(int, int *, _DWORD, int, int *))(*(_DWORD *)grim_interface_ptr + 208))(
      grim_interface_ptr,
      &v58,
      LODWORD(screen_width_f),
      1082130432,
      &v60);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      2,
      v25,
      v32,
      v42);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      1056964608,
      v26,
      v33,
      v43);
    v44 = ((double)*(int *)(this + 24) + *(float *)(this + 28)) / (double)*(int *)(this + 24) * 0.30000001;
    (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v44));
    v34 = (double)*(int *)(this + 24) + *(float *)(this + 28) - 18.0;
    v27 = screen_width_f - 210.0;
    (*(void (__stdcall **)(_DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 324))(
      LODWORD(v27),
      LODWORD(v34),
      aCrimsonland199);
    v45 = ((double)*(int *)(this + 24) + *(float *)(this + 28)) / (double)*(int *)(this + 24) * 0.5;
    (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v45));
    v46 = ((double)*(int *)(this + 24) + *(float *)(this + 28)) / (double)*(int *)(this + 24);
    (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v46));
    if ( *(float *)(dword_47F4D0 + 12) == 0.0 )
    {
      v11 = *(_DWORD *)grim_interface_ptr;
      v47 = console_input_buffer();
      v58 = 16 * (v4 + 1);
      v28 = (double)v58 + *(float *)(this + 28);
      (*(void (**)(int, int, _DWORD, char *, ...))(v11 + 328))(grim_interface_ptr, 1092616192, LODWORD(v28), aS_1, v47);
    }
    else
    {
      v58 = 16 * (v4 + 1);
      v54 = (float)v58;
      v35 = v54 + *(float *)(this + 28);
      (*(void (__stdcall **)(int, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 316))(
        1092616192,
        LODWORD(v35),
        console_prompt_string);
      v9 = *(_DWORD *)grim_interface_ptr;
      v10 = console_input_buffer();
      v36 = v54 + *(float *)(this + 28);
      (*(void (__thiscall **)(int, int, _DWORD, char *))(v9 + 316))(grim_interface_ptr, 1104150528, LODWORD(v36), v10);
    }
    v48 = ((double)*(int *)(this + 24) + *(float *)(this + 28)) / (double)*(int *)(this + 24);
    (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      1058642330,
      1058642330,
      1060320051,
      LODWORD(v48));
    v12 = *(_DWORD *)(this + 36);
    if ( v12 <= 0 )
    {
LABEL_14:
      if ( v3 )
      {
        v13 = 16 * v4;
        v55 = 16 * v4;
        do
        {
          if ( v4 < 0 )
            break;
          v14 = *(_DWORD *)grim_interface_ptr;
          v49 = *v3;
          v37 = (double)v55 + *(float *)(this + 28);
          if ( v16 )
            (*(void (__stdcall **)(int, float, int))(v14 + 324))(1092616192, COERCE_FLOAT(LODWORD(v37)), v49);
          else
            (*(void (__stdcall **)(int, float, int))(v14 + 316))(1092616192, COERCE_FLOAT(LODWORD(v37)), v49);
          v3 = (int *)v3[1];
          --v4;
          v13 -= 16;
          v55 = v13;
        }
        while ( v3 );
      }
    }
    else
    {
      while ( v3 )
      {
        v3 = (int *)v3[1];
        if ( --v12 <= 0 )
          goto LABEL_14;
      }
    }
    v17 = *(_DWORD *)(this + 32);
    v56 = *(_DWORD *)(this + 24);
    if ( v17 > v56 / 16 - 2 )
      v17 = v56 / 16 - 2;
    v18 = v17 + 1;
    v19 = sin(flt_47EA4C * 3.0);
    *(float *)&v58 = v19;
    v20 = pow(v19, 8.0);
    if ( v20 < 0.2 )
      v20 = 0.2;
    v57 = ((double)v56 + *(float *)(this + 28)) / (double)v56 * v20;
    if ( v57 <= 1.0 )
    {
      if ( v57 < 0.0 )
        v57 = 0.0;
    }
    else
    {
      v57 = 1.0;
    }
    (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      COERCE_FLOAT(LODWORD(v57)));
    if ( *(float *)(dword_47F4D0 + 12) == 0.0 )
    {
      v58 = 16 * v18;
      v23 = *(_DWORD *)grim_interface_ptr;
      v40 = (double)(16 * v18) + *(float *)(this + 28) + 2.0;
      v24 = console_input_buffer();
      v60 = (*(int (__thiscall **)(int, char *, _DWORD, char *))(v23 + 332))(
              grim_interface_ptr,
              v24,
              LODWORD(v40),
              asc_4712B8);
      v51 = (double)v60 + 16.0;
      (*(void (__thiscall **)(int, _DWORD))(v23 + 324))(grim_interface_ptr, LODWORD(v51));
    }
    else
    {
      v58 = 16 * v18;
      v21 = (double)(16 * v18) + *(float *)(this + 28);
      v22 = *(_DWORD *)grim_interface_ptr;
      v58 = 8 * dword_47EA54;
      v38 = v21 + 2.0;
      v29 = (double)(8 * dword_47EA54) + 26.0;
      (*(void (__stdcall **)(_DWORD, _DWORD, char *))(v22 + 316))(LODWORD(v29), LODWORD(v38), asc_4712B8);
    }
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      2,
      v30,
      v39,
      v50);
  }
}

// console_register_cvar @ 0x00402350
// registers or updates a console cvar entry (stores string + float value)
char **__thiscall sub_402350(char ***this, char *Source, char *String)
{
  int v4; // eax
  int v5; // esi
  char **v7; // eax
  char **v8; // ebx
  char *i; // eax
  char **v10; // eax
  char **v11; // esi
  char **v12; // eax
  char **v13; // esi

  v4 = console_cvar_find(Source);
  v5 = v4;
  if ( v4 )
  {
    if ( *(_DWORD *)(v4 + 16) )
      crt_free(*(LPVOID *)(v4 + 16));
    *(_DWORD *)(v5 + 16) = 0;
    *(_DWORD *)(v5 + 16) = strdup_malloc(String);
    *(float *)(v5 + 12) = crt_atof_l(String);
    return (char **)v5;
  }
  else
  {
    v7 = *this;
    if ( *this )
    {
      v8 = *this;
      for ( i = v7[1]; i; i = (char *)*((_DWORD *)i + 1) )
        v8 = (char **)i;
      v10 = (char **)operator new(0x24u);
      v11 = v10;
      if ( v10 )
      {
        v10[6] = 0;
        v10[7] = 0;
        v10[8] = 0;
        *v10 = strdup_malloc(Source);
        v11[1] = 0;
        v11[2] = 0;
        v11[3] = 0;
        v11[4] = 0;
        v11[5] = 0;
      }
      else
      {
        v11 = 0;
      }
      v8[1] = (char *)v11;
      *((_DWORD *)v8[1] + 4) = strdup_malloc(String);
      *((float *)v8[1] + 3) = crt_atof_l(String);
      return (char **)v8[1];
    }
    else
    {
      v12 = (char **)operator new(0x24u);
      v13 = v12;
      if ( v12 )
      {
        v12[6] = 0;
        v12[7] = 0;
        v12[8] = 0;
        *v12 = strdup_malloc(Source);
        v13[1] = 0;
        v13[2] = 0;
        v13[3] = 0;
        v13[4] = 0;
        v13[5] = 0;
      }
      else
      {
        v13 = 0;
      }
      *this = v13;
      (*this)[4] = strdup_malloc(String);
      *((float *)*this + 3) = crt_atof_l(String);
      return *this;
    }
  }
}

// console_cvar_find @ 0x00402480
// finds a cvar entry by name
int __thiscall sub_402480(int *this, const char *a2)
{
  int v2; // edi

  v2 = *this;
  if ( !*this )
    return 0;
  while ( strcmp(a2, *(const char **)v2) )
  {
    v2 = *(_DWORD *)(v2 + 4);
    if ( !v2 )
      return 0;
  }
  return v2;
}

// console_cvar_unregister @ 0x004024E0
// removes a cvar entry by name
char __thiscall sub_4024E0(int *this, const char *a2)
{
  int v3; // eax
  int v4; // ecx
  int v6; // edx

  v3 = console_cvar_find(this, a2);
  if ( !v3 )
    return 0;
  v4 = *this;
  if ( v3 == *this )
  {
    *this = *(_DWORD *)(v4 + 4);
    return 1;
  }
  if ( !v4 )
    return 0;
  while ( 1 )
  {
    v6 = *(_DWORD *)(v4 + 4);
    if ( v6 == v3 )
      break;
    v4 = *(_DWORD *)(v4 + 4);
    if ( !v6 )
      return 0;
  }
  *(_DWORD *)(v4 + 4) = *(_DWORD *)(*(_DWORD *)(v4 + 4) + 4);
  return 1;
}

// console_command_unregister @ 0x00402530
// removes a console command entry by name
char __thiscall sub_402530(_DWORD *this, int a2)
{
  int v3; // eax
  int v4; // ecx
  int v6; // edx

  v3 = console_command_find(a2);
  if ( !v3 )
    return 0;
  v4 = *(this + 1);
  if ( v3 == v4 )
  {
    *(this + 1) = *(_DWORD *)(v4 + 4);
    return 1;
  }
  if ( !v4 )
    return 0;
  while ( 1 )
  {
    v6 = *(_DWORD *)(v4 + 4);
    if ( v6 == v3 )
      break;
    v4 = *(_DWORD *)(v4 + 4);
    if ( !v6 )
      return 0;
  }
  *(_DWORD *)(v4 + 4) = *(_DWORD *)(*(_DWORD *)(v4 + 4) + 4);
  return 1;
}

// console_tokenize_line @ 0x00402580
// splits a console line into tokens
void __stdcall sub_402580(int a1)
{
  char *v1; // eax
  int v2; // edi
  char **i; // esi
  char *v4; // eax

  dword_47F4CC = 0;
  if ( a1 && (strlen((const char *)a1) < 2 || *(_BYTE *)a1 != 47 || *(_BYTE *)(a1 + 1) != 47) )
  {
    strcpy(dword_47EAA0, (const char *)a1);
    v1 = crt_strtok(dword_47EAA0, Delimiter);
    if ( v1 )
    {
      *(_DWORD *)dword_47EA60 = v1;
      v2 = 1;
      for ( i = &ArgList; ; ++i )
      {
        v4 = crt_strtok(0, Delimiter);
        if ( !v4 )
          break;
        *i = v4;
        ++v2;
      }
      dword_47F4CC = v2;
    }
  }
}

// console_cvar_autocomplete @ 0x00402630
// returns exact or prefix-matched cvar name
int __thiscall sub_402630(int *this, char *Str1)
{
  unsigned int v3; // kr04_4
  size_t v4; // ebx
  int v5; // edx
  int v6; // edi
  int v7; // esi

  v3 = strlen(Str1) + 1;
  v4 = v3 - 1;
  if ( v3 == 1 )
    return 0;
  v5 = *this;
  v6 = v5;
  if ( !v5 )
  {
LABEL_6:
    v7 = v5;
    if ( v5 )
    {
      while ( strncmp(Str1, *(const char **)v7, v4) )
      {
        v7 = *(_DWORD *)(v7 + 4);
        if ( !v7 )
          return 0;
      }
      return *(_DWORD *)v7;
    }
    return 0;
  }
  while ( strcmp(Str1, *(const char **)v6) )
  {
    v6 = *(_DWORD *)(v6 + 4);
    if ( !v6 )
    {
      v4 = v3 - 1;
      goto LABEL_6;
    }
  }
  return *(_DWORD *)v6;
}

// console_register_command @ 0x004026E0
// registers a console command and handler
char *__thiscall sub_4026E0(char **this, char *Source, int a3)
{
  char *result; // eax
  char *v5; // esi
  char *v6; // ecx

  result = (char *)operator new(0xCu);
  v5 = result;
  if ( result )
  {
    result = strdup_malloc(Source);
    *(_DWORD *)v5 = result;
    *((_DWORD *)v5 + 1) = 0;
    *((_DWORD *)v5 + 2) = 0;
  }
  else
  {
    v5 = 0;
  }
  *((_DWORD *)v5 + 2) = a3;
  v6 = *(this + 1);
  if ( v6 )
  {
    for ( result = (char *)*((_DWORD *)v6 + 1); result; result = (char *)*((_DWORD *)result + 1) )
      v6 = result;
    *((_DWORD *)v6 + 1) = v5;
  }
  else
  {
    *(this + 1) = v5;
  }
  return result;
}

// console_command_find @ 0x00402750
// finds a console command entry by name
int __thiscall sub_402750(_DWORD *this, const char *a2)
{
  int v2; // edi

  v2 = *(this + 1);
  if ( !v2 )
    return 0;
  while ( strcmp(a2, *(const char **)v2) )
  {
    v2 = *(_DWORD *)(v2 + 4);
    if ( !v2 )
      return 0;
  }
  return v2;
}

// console_command_autocomplete @ 0x004027B0
// returns exact or prefix-matched command name
int __thiscall sub_4027B0(_DWORD *this, char *Str1)
{
  unsigned int v3; // kr04_4
  size_t v4; // ebx
  int v5; // edx
  int v6; // edi
  int v7; // esi

  v3 = strlen(Str1) + 1;
  v4 = v3 - 1;
  if ( v3 == 1 )
    return 0;
  v5 = *(this + 1);
  v6 = v5;
  if ( !v5 )
  {
LABEL_6:
    v7 = v5;
    if ( v5 )
    {
      while ( strncmp(Str1, *(const char **)v7, v4) )
      {
        v7 = *(_DWORD *)(v7 + 4);
        if ( !v7 )
          return 0;
      }
      return *(_DWORD *)v7;
    }
    return 0;
  }
  while ( strcmp(Str1, *(const char **)v6) )
  {
    v6 = *(_DWORD *)(v6 + 4);
    if ( !v6 )
    {
      v4 = v3 - 1;
      goto LABEL_6;
    }
  }
  return *(_DWORD *)v6;
}

// console_flush_log @ 0x00402860
// flushes console lines to the log file
char __thiscall sub_402860(_DWORD *this, int a2)
{
  const char *v3; // eax
  FILE *v4; // ebx
  int i; // esi
  int v7; // eax
  int v8; // ecx

  v3 = (const char *)game_build_path(a2);
  v4 = crt_fopen(v3, aWt);
  if ( !v4 )
    return 0;
  for ( i = *(this + 8) - 1; i >= 0; --i )
  {
    v7 = *(this + 2);
    if ( i > 0 )
    {
      v8 = i;
      do
      {
        v7 = *(_DWORD *)(v7 + 4);
        --v8;
      }
      while ( v8 );
    }
    crt_fwrite(*(void **)v7, strlen(*(const char **)v7), 1u, v4);
  }
  crt_fflush(v4);
  crt_fclose(v4);
  return 1;
}

// sub_4028F0 @ 0x004028F0
int sub_4028F0()
{
  int v0; // ebx
  int v1; // ebp
  char *v3; // [esp+10h] [ebp-4h]

  config_player_name_buf = 0;
  dword_4803C0 = 0;
  config_hardcore = 0;
  config_full_version = 1;
  config_perk_prompt_counter = 0;
  flt_4807BC = 0.5;
  dword_480798 = 1;
  config_key_pick_perk = 257;
  config_key_reload = 258;
  byte_4807B6 = 0;
  *(_DWORD *)config_texture_scale = 1065353216;
  config_score_load_gate = 0;
  byte_4803C4 = 0;
  v0 = 0;
  v3 = (char *)&config_saved_name_0;
  v1 = 34;
  do
  {
    config_blob[v1++] = v0;
    strcpy(v3, aDefault);
    ++v0;
    v3 += 27;
  }
  while ( v1 < 42 );
  HIWORD(config_blob[0]) = 0;
  memset(config_player_name, 0, sizeof(config_player_name));
  strcpy(config_player_name, default_player_name);
  config_name_slot_count = 1;
  config_name_slot_selected = 0;
  LOWORD(config_blob[0]) = 0;
  config_fx_toggle = 0;
  byte_4807A8 = 1;
  dword_4804F0 = 0;
  dword_4804F4 = 0;
  dword_4803B4 = 0;
  config_display_bpp = 32;
  config_windowed = 0;
  config_game_mode = 1;
  config_fx_detail_flag0 = 1;
  byte_480357 = 0;
  config_fx_detail_flag1 = 1;
  config_player_mode_flags = 2;
  dword_480368 = 2;
  config_aim_scheme = 0;
  dword_480390 = 0;
  config_fx_detail_flag2 = 1;
  config_player_count = 1;
  config_p1_turn_right = 32;
  config_detail_preset = 5;
  dword_4804F8 = 9000;
  dword_4804FC = 27000;
  dword_4804EC = 100;
  *(_DWORD *)config_screen_width = 800;
  config_screen_height = 600;
  config_sfx_volume = 1.0;
  config_music_volume = 1.0;
  config_p1_move_forward = 17;
  config_p1_move_backward = 31;
  config_p1_turn_left = 30;
  config_p1_fire = 256;
  config_p1_key_reserved_0 = 382;
  config_p1_key_reserved_1 = 382;
  config_p1_aim_left = 16;
  config_p1_aim_right = 18;
  config_p1_axis_aim_y = 319;
  config_p1_axis_aim_x = 320;
  config_p1_axis_move_y = 321;
  config_p1_axis_move_x = 339;
  config_p1_padding_0 = 382;
  config_p1_padding_1 = 382;
  config_p1_padding_2 = 382;
  config_p2_move_forward = 200;
  config_p2_move_backward = 208;
  config_p2_turn_left = 203;
  config_p2_turn_right = 205;
  config_p2_fire = 157;
  config_p2_key_reserved_0 = 382;
  config_p2_key_reserved_1 = 382;
  config_p2_aim_left = 211;
  config_p2_aim_right = 209;
  config_p2_axis_aim_y = 319;
  config_p2_axis_aim_x = 320;
  config_p2_axis_move_y = 321;
  config_p2_axis_move_x = 339;
  config_p2_padding_0 = 382;
  config_p2_padding_1 = 382;
  config_p2_padding_2 = 382;
  config_hud_indicator_toggle = 257;
  return 382;
}

// game_build_path @ 0x00402BD0
// builds a game path by combining game_base_path with filename
char *__cdecl sub_402BD0(const char *a1)
{
  crt_sprintf(game_path_buf, "%s\\%s", game_base_path, a1);
  return game_path_buf;
}

// register_core_cvars @ 0x00402C00
// registers built-in cvars
char **sub_402C00()
{
  char **result; // eax

  dword_480854 = (int)console_register_cvar((char ***)&console_log_queue, aCvSilentloads, a1);
  dword_480858 = (int)console_register_cvar((char ***)&console_log_queue, aCvTerrainfilte, a1);
  dword_48085C = (int)console_register_cvar((char ***)&console_log_queue, aCvBodiesfade, a1);
  dword_480870 = (int)console_register_cvar((char ***)&console_log_queue, aCvUitransparen, a1);
  dword_48088C = (int)console_register_cvar((char ***)&console_log_queue, aCvUipointfilte, a0);
  dword_480874 = (int)console_register_cvar((char ***)&console_log_queue, aCvEnablemousep, a0);
  dword_480864 = (int)console_register_cvar((char ***)&console_log_queue, aCvVerbose, a0);
  dword_480860 = (int)console_register_cvar((char ***)&console_log_queue, aCvTerrainbodie, a0);
  dword_480878 = (int)console_register_cvar((char ***)&console_log_queue, aCvUismallindic, a0);
  dword_48087C = (int)console_register_cvar((char ***)&console_log_queue, aCvAimenhanceme, a07);
  dword_48086C = (int)console_register_cvar((char ***)&console_log_queue, aCvFriendlyfire, a0);
  dword_480868 = (int)console_register_cvar((char ***)&console_log_queue, aCvShowfps, a0);
  result = console_register_cvar((char ***)&console_log_queue, aCvPadaimdistmu, a96);
  dword_480880 = (int)result;
  return result;
}

// FUN_00402d50 @ 0x00402D50
// [binja] int32_t sub_402d50()
int sub_402D50()
{
  int v0; // esi
  int v2; // [esp+40h] [ebp-30h]
  int v3; // [esp+44h] [ebp-2Ch]
  float v4; // [esp+48h] [ebp-28h]
  float v5; // [esp+4Ch] [ebp-24h]
  int v6; // [esp+54h] [ebp-1Ch]
  float v7; // [esp+58h] [ebp-18h] BYREF
  int v8; // [esp+5Ch] [ebp-14h]
  _DWORD v9[4]; // [esp+60h] [ebp-10h] BYREF

  (*(void (__thiscall **)(int, int, int, int, float, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v3,
    COERCE_FLOAT(LODWORD(v4)),
    COERCE_FLOAT(LODWORD(v5)));
  memset(v9, 0, 12);
  v9[3] = 1056964608;
  v7 = (float)(*(_DWORD *)config_screen_width / 2 - 110);
  v6 = config_screen_height / 2 - 30;
  *(float *)&v8 = (float)v6;
  (*(void (__thiscall **)(int, float *, int, int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    &v7,
    1130102784,
    1114636288,
    v9);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v7 = (float)(*(_DWORD *)config_screen_width / 2 - 110);
  v6 = config_screen_height / 2 - 30;
  *(float *)&v8 = (float)v6;
  (*(void (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
    grim_interface_ptr,
    &v7,
    1130102784,
    1114636288);
  v0 = *(_DWORD *)grim_interface_ptr;
  v6 = config_screen_height / 2 - 8;
  v4 = (float)v6;
  v8 = *(_DWORD *)config_screen_width / 2
     - (*(int (__stdcall **)(char *, float, char *))(v0 + 332))(aPleaseWait, COERCE_FLOAT(LODWORD(v4)), aPleaseWait) / 2;
  v5 = (float)v8;
  (*(void (__thiscall **)(int, float))(v0 + 324))(grim_interface_ptr, COERCE_FLOAT(LODWORD(v5)));
  LOBYTE(v2) = 1;
  return (*(int (__thiscall **)(int, int, int, int, float, float))(*(_DWORD *)grim_interface_ptr + 32))(
           grim_interface_ptr,
           54,
           v2,
           v3,
           COERCE_FLOAT(LODWORD(v4)),
           COERCE_FLOAT(LODWORD(v5)));
}

// demo_setup_variant_0 @ 0x00402ED0
// demo setup 0: 2P, spawns template 0x38 grid, assigns weapon 0xb
int sub_402ED0()
{
  int v0; // ebx
  int v1; // edi
  int v3; // [esp+Ch] [ebp-1Ch]
  float v4; // [esp+Ch] [ebp-1Ch]
  float v5[2]; // [esp+18h] [ebp-10h] BYREF
  float v6[2]; // [esp+20h] [ebp-8h] BYREF

  v0 = 256;
  config_player_count = 2;
  dword_4712F0 = 4000;
  v1 = 0;
  v3 = 256;
  do
  {
    v5[0] = (float)((v1 % 2 + 2) << 6);
    v4 = (float)v3;
    v5[1] = v4;
    creature_spawn_template(56, v5, -1027080192);
    v6[1] = v4;
    v6[0] = (float)(((v1 % 2) << 6) + 798);
    creature_spawn_template(56, v6, -1027080192);
    v0 += 80;
    ++v1;
    v3 = v0;
  }
  while ( v0 < 1696 );
  player_pos_x = 1138753536;
  player_pos_y = 1136656384;
  player2_pos_x = 1141407744;
  player2_pos_y = 1143177216;
  weapon_assign_player(0, 11);
  return weapon_assign_player(1, 11);
}

// demo_setup_variant_2 @ 0x00402FE0
// demo setup 2: 1P, spawns template 0x41 columns, assigns weapon 0x15
int sub_402FE0()
{
  int v0; // ebp
  int v1; // ebx
  int v3; // [esp+10h] [ebp-28h]
  float v4; // [esp+10h] [ebp-28h]
  float v5[2]; // [esp+18h] [ebp-20h] BYREF
  float v6[2]; // [esp+20h] [ebp-18h] BYREF
  float v7[2]; // [esp+28h] [ebp-10h] BYREF
  float v8[2]; // [esp+30h] [ebp-8h] BYREF

  v0 = 128;
  config_player_count = 1;
  dword_4712F0 = 5000;
  v1 = 0;
  v3 = 128;
  do
  {
    v5[0] = (float)(((v1 % 2) << 6) + 32);
    v4 = (float)v3;
    v5[1] = v4;
    creature_spawn_template(65, v5, -1027080192);
    v6[1] = v4;
    v6[0] = (float)((v1 % 2 + 2) << 6);
    creature_spawn_template(65, v6, -1027080192);
    v7[1] = v4;
    v7[0] = (float)(((v1 % 2) << 6) - 64);
    creature_spawn_template(65, v7, -1027080192);
    v8[1] = v4;
    v8[0] = (float)((v1 % 2 + 12) << 6);
    creature_spawn_template(65, v8, -1027080192);
    v0 += 60;
    ++v1;
    v3 = v0;
  }
  while ( v0 < 848 );
  return weapon_assign_player(0, 21);
}

// demo_setup_variant_1 @ 0x004030F0
// demo setup 1: 2P, terrain preset DAT_00484914, templates 0x34/0x35, weapon 5, power-up timer
int sub_4030F0()
{
  int i; // esi
  int v1; // eax
  int v2; // eax
  int result; // eax
  float v4; // [esp+4h] [ebp-1Ch]
  float v5; // [esp+8h] [ebp-18h]
  _DWORD v6[2]; // [esp+10h] [ebp-10h] BYREF
  _DWORD v7[2]; // [esp+18h] [ebp-8h] BYREF

  config_player_count = 2;
  terrain_generate(&dword_484914);
  dword_4712F0 = 5000;
  for ( i = 0; i < 20; ++i )
  {
    v5 = (float)(crt_rand() % 200 + 32);
    v1 = crt_rand();
    *(float *)v6 = v5;
    *(float *)&v6[1] = (float)(v1 % 899 + 64);
    creature_spawn_template(52, v6, -1027080192);
    if ( i % 3 )
    {
      v4 = (float)(crt_rand() % 30 + 32);
      v2 = crt_rand();
      *(float *)v7 = v4;
      *(float *)&v7[1] = (float)(v2 % 899 + 64);
      creature_spawn_template(53, v7, -1027080192);
    }
  }
  player_pos_x = 1140129792;
  player_pos_y = 1138753536;
  player2_pos_x = 1139802112;
  player2_pos_y = 1141899264;
  weapon_assign_player(0, 5);
  result = weapon_assign_player(1, 5);
  bonus_weapon_power_up_timer = 1097859072;
  return result;
}

// demo_setup_variant_3 @ 0x00403250
// demo setup 3: 1P, quest-selected terrain, templates 0x24/0x25, weapon 0x12
int sub_403250()
{
  int i; // esi
  int v1; // eax
  int v2; // eax
  float v4; // [esp+4h] [ebp-1Ch]
  float v5; // [esp+8h] [ebp-18h]
  _DWORD v6[2]; // [esp+10h] [ebp-10h] BYREF
  _DWORD v7[2]; // [esp+18h] [ebp-8h] BYREF

  config_player_count = 1;
  terrain_generate(&quest_selected_meta);
  dword_4712F0 = 4000;
  for ( i = 0; i < 20; ++i )
  {
    v5 = (float)(crt_rand() % 200 + 32);
    v1 = crt_rand();
    *(float *)v6 = v5;
    *(float *)&v6[1] = (float)(v1 % 899 + 64);
    creature_spawn_template(36, v6, 0);
    if ( i % 3 )
    {
      v4 = (float)(crt_rand() % 30 + 32);
      v2 = crt_rand();
      *(float *)v7 = v4;
      *(float *)&v7[1] = (float)(v2 % 899 + 64);
      creature_spawn_template(37, v7, 0);
    }
  }
  player_pos_x = 1140850688;
  player_pos_y = 1140850688;
  return weapon_assign_player(0, 18);
}

// FUN_00403370 @ 0x00403370
// [binja] int32_t sub_403370()
void sub_403370()
{
  dword_4712F0 = 10000;
  byte_480890 = 1;
}

// demo_mode_start @ 0x00403390
// starts demo mode and cycles the demo setup
int sub_403390()
{
  int result; // eax

  if ( game_state_id != 9 )
    game_state_set(9);
  byte_480890 = 0;
  demo_mode_active = 1;
  gameplay_reset_state();
  config_game_mode = 1;
  if ( dword_480894 )
  {
    switch ( dword_480894 )
    {
      case 1:
        demo_setup_variant_1();
        goto LABEL_13;
      case 2:
        demo_setup_variant_2();
        goto LABEL_13;
      case 3:
        demo_setup_variant_3();
        goto LABEL_13;
    }
    if ( dword_480894 != 4 )
    {
      FUN_00403370();
      goto LABEL_13;
    }
  }
  demo_setup_variant_0();
LABEL_13:
  quest_spawn_timeline = 0;
  result = (dword_480894 + 1) / 6;
  byte_48702C = 0;
  dword_480894 = (dword_480894 + 1) % 6;
  return result;
}

// FUN_00403430 @ 0x00403430
// [binja] int32_t sub_403430(float* arg1, int32_t arg2, int32_t arg3)
BOOL __cdecl sub_403430(float *a1, int a2, int a3)
{
  return *a1 - 10.0 < ui_mouse_x
      && a1[1] - 2.0 < ui_mouse_y
      && (double)a3 + *a1 > ui_mouse_x
      && (double)a2 + a1[1] > ui_mouse_y
      && !ui_mouse_blocked;
}

// ui_mouse_inside_rect @ 0x004034A0
// returns 1 when the mouse is inside the rect and mouse capture is clear
BOOL __cdecl sub_4034A0(float *a1, int a2, int a3)
{
  return ui_mouse_x > (double)*a1
      && ui_mouse_y > (double)a1[1]
      && (double)a3 + *a1 > ui_mouse_x
      && (double)a2 + a1[1] > ui_mouse_y
      && !ui_mouse_blocked;
}

// game_core_init @ 0x00403500
// initializes core game systems (quests, effects, UI assets) and sets initial state
char sub_403500()
{
  console_printf((int)&console_log_queue, aGdiInitializin);
  quest_database_init();
  effect_defaults_reset();
  ui_menu_assets_init();
  bonus_metadata_init();
  render_pass_mode = 0;
  game_state_set(0);
  console_printf((int)&console_log_queue, aCoreInitDone);
  return 1;
}

// perk_prompt_update_and_render @ 0x00403550
// updates perk prompt timer, animates transforms, and renders the prompt text
char sub_403550()
{
  char result; // al
  int v1; // eax
  const char *v2; // eax
  int v3; // esi
  long double v4; // st7
  long double v5; // st6
  float v6; // [esp+18h] [ebp-90h]
  float v7; // [esp+1Ch] [ebp-8Ch]
  float v8; // [esp+1Ch] [ebp-8Ch]
  float v9; // [esp+24h] [ebp-84h]
  char Buffer[4]; // [esp+28h] [ebp-80h] BYREF
  int v11; // [esp+2Ch] [ebp-7Ch]

  result = demo_mode_active;
  if ( demo_mode_active || config_game_mode == 2 )
    return result;
  if ( perk_pending_count > 0 && game_state_id == 9 )
  {
    v1 = frame_dt_ms + perk_prompt_timer;
    perk_prompt_timer += frame_dt_ms;
    if ( perk_prompt_timer > 200 )
    {
      v1 = 200;
LABEL_9:
      perk_prompt_timer = v1;
    }
  }
  else
  {
    v1 = perk_prompt_timer - frame_dt_ms;
    perk_prompt_timer -= frame_dt_ms;
    if ( perk_prompt_timer < 0 )
    {
      v1 = 0;
      goto LABEL_9;
    }
  }
  if ( config_full_version )
  {
    if ( v1 > 0 )
    {
      v7 = (double)perk_prompt_timer * 0.0049999999;
      (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v7));
      v2 = (const char *)input_key_name(config_key_pick_perk);
      crt_sprintf(Buffer, "Press %s to pick a perk", v2);
      v3 = *(_DWORD *)grim_interface_ptr;
      v6 = perk_prompt_origin_y + 8.0;
      v11 = *(_DWORD *)config_screen_width
          - (*(int (__stdcall **)(char *, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 332))(
              Buffer,
              LODWORD(v6),
              Buffer)
          - 16;
      v8 = (float)v11;
      (*(void (__thiscall **)(int, _DWORD))(v3 + 324))(grim_interface_ptr, LODWORD(v8));
    }
  }
  byte_48F20C = 1;
  v4 = (1.0 - (double)perk_prompt_timer * 0.0049999999) * -1.5707964;
  v9 = v4;
  perk_prompt_transform_cos = cos(v4);
  v5 = sin(v9);
  perk_prompt_transform_sin_neg = -v5;
  perk_prompt_transform_sin = v5;
  perk_prompt_transform_cos_2 = perk_prompt_transform_cos;
  return ui_element_render(&byte_48F20C);
}

// input_key_name @ 0x004036D0
// maps key codes (DIK/virtual) to display labels
char *__cdecl sub_4036D0(int a1)
{
  char *result; // eax
  const char *v2; // edi

  if ( a1 > 255 )
  {
    switch ( a1 )
    {
      case 256:
        strcpy(String, aMouse1);
        return String;
      case 257:
        v2 = aMouse2;
        break;
      case 258:
        strcpy(String, aMouse3);
        return String;
      case 259:
        v2 = aMouse4;
        break;
      case 260:
        strcpy(String, aMouse5);
        return String;
      case 265:
        v2 = aMwheelup;
        break;
      case 266:
        strcpy(String, aMwheeldown);
        return String;
      case 287:
        v2 = aJoys1;
        break;
      case 288:
        strcpy(String, aJoys2);
        return String;
      case 289:
        v2 = aJoys3;
        break;
      case 290:
        strcpy(String, aJoys4);
        return String;
      case 291:
        v2 = aJoys5;
        break;
      case 292:
        strcpy(String, aJoys6);
        return String;
      case 293:
        v2 = aJoys7;
        break;
      case 294:
        strcpy(String, aJoys8);
        return String;
      case 295:
        v2 = aJoys9;
        break;
      case 296:
        strcpy(String, aJoys10);
        return String;
      case 297:
        v2 = aJoys11;
        break;
      case 298:
        strcpy(String, aJoys12);
        return String;
      case 305:
        v2 = aJoysup;
        break;
      case 306:
        strcpy(String, aJoysdown);
        return String;
      case 307:
        v2 = aJoysleft;
        break;
      case 308:
        strcpy(String, aJoysright);
        return String;
      case 319:
        v2 = aJoyaxisx;
        break;
      case 320:
        strcpy(String, aJoyaxisy);
        return String;
      case 321:
        v2 = aJoyaxisz;
        break;
      case 339:
        strcpy(String, aJoyrotx);
        return String;
      case 340:
        v2 = aJoyroty;
        break;
      case 341:
        strcpy(String, aJoyrotz);
        return String;
      case 382:
        v2 = aUnbound;
        break;
      case 355:
        strcpy(String, aRim0xaxis);
        return String;
      case 356:
        v2 = aRim1xaxis;
        break;
      case 357:
        strcpy(String, aRim2xaxis);
        return String;
      case 360:
        v2 = aRim0yaxis;
        break;
      case 361:
        strcpy(String, aRim1yaxis);
        return String;
      case 362:
        v2 = aRim2yaxis;
        break;
      case 365:
        strcpy(String, aRim0btn1);
        return String;
      case 366:
        v2 = aRim0btn2;
        break;
      case 367:
        strcpy(String, aRim0btn3);
        return String;
      case 368:
        v2 = aRim0btn4;
        break;
      case 369:
        strcpy(String, aRim0btn5);
        return String;
      case 370:
        v2 = aRim1btn1;
        break;
      case 371:
        strcpy(String, aRim1btn2);
        return String;
      case 372:
        v2 = aRim1btn3;
        break;
      case 373:
        strcpy(String, aRim1btn4);
        return String;
      case 374:
        v2 = aRim1btn5;
        break;
      case 375:
        strcpy(String, aRim2btn1);
        return String;
      case 376:
        v2 = aRim2btn2;
        break;
      case 377:
        strcpy(String, aRim2btn3);
        return String;
      case 378:
        v2 = aRim2btn4;
        break;
      case 379:
        strcpy(String, aRim2btn5);
        return String;
      default:
        if ( a1 <= 355 )
          return String;
        v2 = aRawinput;
        break;
    }
    strcpy(String, v2);
    return String;
  }
  if ( GetKeyNameTextA(a1 << 16, String, 63) )
    return String;
  switch ( a1 )
  {
    case 1:
      result = aDikEscape;
      break;
    case 2:
      result = aDik1;
      break;
    case 3:
      result = aDik2;
      break;
    case 4:
      result = aDik3;
      break;
    case 5:
      result = aDik4;
      break;
    case 6:
      result = aDik5;
      break;
    case 7:
      result = aDik6;
      break;
    case 8:
      result = aDik7;
      break;
    case 9:
      result = aDik8;
      break;
    case 10:
      result = aDik9;
      break;
    case 11:
      result = aDik0;
      break;
    case 12:
      result = aMinus;
      break;
    case 13:
      result = aEquals;
      break;
    case 14:
      result = aBack;
      break;
    case 15:
      result = (char *)&off_47186C;
      break;
    case 16:
      result = aQ;
      break;
    case 17:
      result = aW;
      break;
    case 18:
      result = aE;
      break;
    case 19:
      result = aR;
      break;
    case 20:
      result = aT;
      break;
    case 21:
      result = aY;
      break;
    case 22:
      result = aU;
      break;
    case 23:
      result = aI;
      break;
    case 24:
      result = aO;
      break;
    case 25:
      result = aP;
      break;
    case 26:
      result = aLbracket;
      break;
    case 27:
      result = aRbracket;
      break;
    case 28:
      result = aReturn;
      break;
    case 29:
      result = aLcontrol;
      break;
    case 30:
      result = aA;
      break;
    case 31:
      result = aS_3;
      break;
    case 32:
      result = aD_1;
      break;
    case 33:
      result = asc_471808;
      break;
    case 34:
      result = aG;
      break;
    case 35:
      result = asc_471800;
      break;
    case 36:
      result = aJ;
      break;
    case 37:
      result = aK;
      break;
    case 38:
      result = asc_4717F4;
      break;
    case 39:
      result = aSemicolon;
      break;
    case 40:
      result = aApostrophe;
      break;
    case 41:
      result = aGrave;
      break;
    case 42:
      result = aLshift;
      break;
    case 43:
      result = aBackslash;
      break;
    case 44:
      result = aZ;
      break;
    case 45:
      result = asc_4717B8;
      break;
    case 46:
      result = aC;
      break;
    case 47:
      result = aV;
      break;
    case 48:
      result = aB;
      break;
    case 49:
      result = aN;
      break;
    case 50:
      result = aM;
      break;
    case 51:
      result = aComma;
      break;
    case 52:
      result = aPeriod;
      break;
    case 53:
      result = aSlash;
      break;
    case 54:
      result = aRshift;
      break;
    case 55:
      result = aMultiply;
      break;
    case 56:
      result = aLmenu;
      break;
    case 57:
      result = aSpace;
      break;
    case 58:
      result = aCapital;
      break;
    case 59:
      result = aF1;
      break;
    case 60:
      result = aF2;
      break;
    case 61:
      result = aF3;
      break;
    case 62:
      result = aF4;
      break;
    case 63:
      result = aF5;
      break;
    case 64:
      result = aF6;
      break;
    case 65:
      result = aF7;
      break;
    case 66:
      result = aF8;
      break;
    case 67:
      result = aF9;
      break;
    case 68:
      result = aF10;
      break;
    case 69:
      result = aNumlock;
      break;
    case 70:
      result = aScroll;
      break;
    case 71:
      result = aNumpad7;
      break;
    case 72:
      result = aNumpad8;
      break;
    case 73:
      result = aNumpad9;
      break;
    case 74:
      result = aSubtract;
      break;
    case 75:
      result = aNumpad4;
      break;
    case 76:
      result = aNumpad5;
      break;
    case 77:
      result = aNumpad6;
      break;
    case 78:
      result = (char *)&off_4716E8;
      break;
    case 79:
      result = aNumpad1;
      break;
    case 80:
      result = aNumpad2;
      break;
    case 81:
      result = aNumpad3;
      break;
    case 82:
      result = aNumpad0;
      break;
    case 83:
      result = aDecimal;
      break;
    case 86:
      result = aOem102;
      break;
    case 87:
      result = aF11;
      break;
    case 88:
      result = aF12;
      break;
    case 100:
      result = aF13;
      break;
    case 101:
      result = aF14;
      break;
    case 102:
      result = aF15;
      break;
    case 112:
      result = aKana;
      break;
    case 115:
      result = aAbntC1;
      break;
    case 121:
      result = aConvert;
      break;
    case 123:
      result = aNoconvert;
      break;
    case 125:
      result = aYen;
      break;
    case 126:
      result = aAbntC2;
      break;
    case 141:
      result = aNumpadequals;
      break;
    case 144:
      result = aPrevtrack;
      break;
    case 145:
      result = aAt;
      break;
    case 146:
      result = aColon;
      break;
    case 147:
      result = aUnderline;
      break;
    case 148:
      result = aKanji;
      break;
    case 149:
      result = aStop;
      break;
    case 150:
      result = aAx;
      break;
    case 151:
      result = aUnlabeled;
      break;
    case 153:
      result = aNexttrack;
      break;
    case 156:
      result = aNumpadenter;
      break;
    case 157:
      result = aRcontrol;
      break;
    case 160:
      result = aMute;
      break;
    case 161:
      result = aCalculator;
      break;
    case 162:
      result = aPlaypause;
      break;
    case 164:
      result = aMediastop;
      break;
    case 174:
      result = aVolumedown;
      break;
    case 176:
      result = aVolumeup;
      break;
    case 178:
      result = aWebhome;
      break;
    case 179:
      result = aNumpadcomma;
      break;
    case 181:
      result = aDivide;
      break;
    case 183:
      result = aSysrq;
      break;
    case 184:
      result = aRmenu;
      break;
    case 197:
      result = aPause;
      break;
    case 199:
      result = aHome;
      break;
    case 200:
      result = aUp;
      break;
    case 201:
      result = aPrior;
      break;
    case 203:
      result = aLeft;
      break;
    case 205:
      result = aRight;
      break;
    case 207:
      result = (char *)&off_47155C;
      break;
    case 208:
      result = aDown;
      break;
    case 209:
      result = aNext;
      break;
    case 210:
      result = aInsert;
      break;
    case 211:
      result = aDelete;
      break;
    case 219:
      result = aLwin;
      break;
    case 220:
      result = aRwin;
      break;
    case 221:
      result = aApps;
      break;
    case 222:
      result = aPower;
      break;
    case 223:
      result = aSleep;
      break;
    case 227:
      result = aWake;
      break;
    case 229:
      result = aWebsearch;
      break;
    case 230:
      result = aWebfavorites;
      break;
    case 231:
      result = aWebrefresh;
      break;
    case 232:
      result = aWebstop;
      break;
    case 233:
      result = aWebforward;
      break;
    case 234:
      result = aWebback;
      break;
    case 235:
      result = aMycomputer;
      break;
    case 236:
      result = aMail;
      break;
    case 237:
      result = aMediaselect;
      break;
    default:
      result = aUnknown;
      break;
  }
  return result;
}

// perks_generate_choices @ 0x004045A0
// builds the current perk choice list
int sub_4045A0()
{
  int v0; // esi
  int v1; // edi
  int v2; // eax
  int v3; // ecx
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int *v7; // ecx
  int v8; // eax
  int result; // eax

  v0 = 0;
  memset(perk_choice_ids, 0, 0x1Cu);
  do
  {
    if ( !v0
      && *(_DWORD *)quest_stage_major == *(_DWORD *)quest_monster_vision_meta
      && quest_stage_minor == *(_DWORD *)(quest_monster_vision_meta + 4)
      && !perk_count_get(perk_id_monster_vision) )
    {
      v0 = 1;
      perk_choice_ids[0] = perk_id_monster_vision;
    }
    v1 = 0;
    do
    {
      while ( 1 )
      {
        do
        {
LABEL_8:
          ++v1;
          v2 = perk_select_random();
          v3 = perk_id_pyromaniac;
          perk_choice_ids[v0] = v2;
        }
        while ( v2 == v3 && player_weapon_id != 8 );
        if ( perk_count_get(perk_id_death_clock) )
        {
          v4 = perk_choice_ids[v0];
          if ( v4 == perk_id_jinxed
            || v4 == perk_id_breathing_room
            || v4 == perk_id_grim_deal
            || v4 == perk_id_highlander
            || v4 == perk_id_fatal_lottery
            || v4 == dword_4C2B8C
            || v4 == perk_id_ammunition_within
            || v4 == perk_id_infernal_contract
            || v4 == perk_id_regeneration
            || v4 == perk_id_greater_regeneration
            || v4 == perk_id_thick_skinned
            || v4 == perk_id_bandage )
          {
            continue;
          }
        }
        v5 = perk_choice_ids[v0];
        if ( v5 != perk_id_jinxed
          && v5 != perk_id_ammunition_within
          && v5 != perk_id_anxious_loader
          && v5 != perk_id_monster_vision )
        {
          break;
        }
        if ( (crt_rand() & 3) != 1 )
          break;
      }
      if ( v1 > 10000 && (perk_flags_table[20 * perk_choice_ids[v0]] & 4) != 0 )
        break;
      v6 = 0;
      v7 = perk_choice_ids;
      while ( v6 < v0 )
      {
        if ( *v7 == perk_choice_ids[v0] )
          goto LABEL_8;
        ++v6;
        ++v7;
      }
      v8 = perk_choice_ids[v0];
      if ( (perk_flags_table[20 * v8] & 4) != 0 )
        break;
    }
    while ( (int)*(&player_perk_counts + v8) > 0 && v1 < 30000 );
    if ( v1 >= 25000 )
      console_printf((int)&console_log_queue, aPerkRandomizer);
    ++v0;
  }
  while ( v0 < 7 );
  result = config_game_mode;
  if ( config_game_mode == 8 )
  {
    perk_choice_ids[0] = perk_id_sharpshooter;
    dword_4807EC = perk_id_long_distance_runner;
    dword_4807F0 = perk_id_evil_eyes;
    dword_4807F4 = perk_id_radioactive;
    dword_4807F8 = perk_id_fastshot;
    dword_4807FC = perk_id_fastshot;
    dword_480800 = perk_id_fastshot;
    return perk_id_fastshot;
  }
  return result;
}

// demo_trial_overlay_render @ 0x004047C0
// renders the demo trial warning panel and remaining time message
int __cdecl sub_4047C0(float *a1, float a2)
{
  int v2; // edi
  int v3; // eax
  float v4; // edx
  int v5; // ecx
  signed int v6; // ebp
  int v7; // edi
  int v8; // ebx
  std::codecvt_base *v9; // ecx
  float v10; // edi
  int v11; // ecx
  int v12; // ecx
  double v13; // st7
  int v14; // ecx
  int v15; // ecx
  int v16; // ecx
  int v17; // ecx
  double v18; // st7
  int v19; // ecx
  int v20; // ecx
  int v21; // ecx
  int v22; // ecx
  int v23; // ecx
  int v24; // ecx
  int v25; // ecx
  int v26; // ecx
  int v27; // ecx
  int v28; // ecx
  double v29; // st7
  int result; // eax
  float v31; // [esp+6Ch] [ebp-144h]
  float v32; // [esp+70h] [ebp-140h]
  float v33; // [esp+70h] [ebp-140h]
  int v34; // [esp+70h] [ebp-140h]
  float v35; // [esp+74h] [ebp-13Ch]
  int v36; // [esp+74h] [ebp-13Ch]
  const char *v37; // [esp+74h] [ebp-13Ch]
  int v38; // [esp+78h] [ebp-138h]
  float v39; // [esp+8Ch] [ebp-124h] BYREF
  float v40; // [esp+90h] [ebp-120h]
  float v41; // [esp+94h] [ebp-11Ch]
  float v42[2]; // [esp+98h] [ebp-118h] BYREF
  _DWORD v43[4]; // [esp+A0h] [ebp-110h] BYREF
  char v44[128]; // [esp+B0h] [ebp-100h] BYREF
  char Buffer[128]; // [esp+130h] [ebp-80h] BYREF

  *(float *)&v43[3] = a2 * 0.80000001;
  byte_480850 = 1;
  memset(v43, 0, 12);
  (*(void (__thiscall **)(int, float *, int, int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    a1,
    1140850688,
    1132462080,
    v43);
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    LODWORD(a2));
  (*(void (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
    grim_interface_ptr,
    a1,
    1140850688,
    1132462080);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v2 = *(_DWORD *)grim_interface_ptr;
  v3 = (*(int (__thiscall **)(int, char *, _DWORD))(*(_DWORD *)grim_interface_ptr + 192))(
         grim_interface_ptr,
         aClLogo,
         0);
  (*(void (__thiscall **)(int, int))(v2 + 196))(grim_interface_ptr, v3);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  v32 = a1[1] + 22.0;
  v31 = *a1 + 72.0;
  (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    LODWORD(v31),
    LODWORD(v32),
    1136236954,
    1111071130);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  v35 = a1[1] + 9.0;
  v33 = *a1 + 131.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v33),
    LODWORD(v35),
    aYouVeBeenPlayi);
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    LODWORD(a2));
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v34,
    v36,
    v38);
  v4 = a1[1];
  v39 = *a1 + 26.0;
  v40 = v4 + 80.0;
  v5 = sub_41DF50() - *(_DWORD *)&game_sequence_id;
  if ( dword_48084C > 0 )
    v5 = 300000 - dword_48084C;
  v6 = v5 / 1000 / 60
     + 60
     * (((unsigned int)(((unsigned __int64)(2004318071LL * (v5 / 1000 / 60)) >> 32) - v5 / 1000 / 60) >> 31)
      + ((int)(((unsigned __int64)(2004318071LL * (v5 / 1000 / 60)) >> 32) - v5 / 1000 / 60) >> 5));
  v7 = v5 / 1000 - 60 * v6;
  v8 = v5 % 1000 / 10;
  if ( v6 >= 0 )
  {
    if ( v7 >= 10 )
      v37 = aD_0;
    else
      v37 = a0D;
    crt_sprintf(Buffer, v37, v7);
  }
  else
  {
    v7 = 0;
    v8 = 0;
    v6 = 0;
    crt_sprintf(Buffer, "0%d", 0);
  }
  if ( v8 >= 10 )
    crt_sprintf(v44, "%d:%s.%d", v6, Buffer, v8);
  else
    crt_sprintf(v44, "%d:%s.0%d", v6, Buffer, v8);
  if ( game_is_full_version(v9) )
    goto LABEL_27;
  if ( config_game_mode == 8 )
    goto LABEL_27;
  *(_DWORD *)&game_sequence_id = game_sequence_get();
  if ( *(int *)&game_sequence_id > 2400000 )
    goto LABEL_27;
  if ( dword_48084C <= 0 )
  {
    if ( config_game_mode != 3 )
      goto LABEL_27;
  }
  else if ( config_game_mode != 3
         || (LODWORD(v41) = dword_48084C / 1000, (double)(dword_48084C / 1000) * 0.016666668 > 5.0) )
  {
LABEL_27:
    if ( v6 > 0 || v7 > 0 )
    {
      v10 = v39;
      v23 = *(_DWORD *)grim_interface_ptr;
      v40 = v40 - 7.0;
      (*(void (__cdecl **)(int, float, float, char *, char *))(v23 + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aYouHaveUsedUpY,
        v44);
      v24 = *(_DWORD *)grim_interface_ptr;
      v40 = v40 + 16.0;
      (*(void (**)(int, float, float, char *, ...))(v24 + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aHaveSTimeLeftT,
        v44);
      v25 = *(_DWORD *)grim_interface_ptr;
      v40 = v40 + 22.0;
      (*(void (__cdecl **)(int, float, float, char *))(v25 + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aIfYouWouldLike);
      v26 = *(_DWORD *)grim_interface_ptr;
      v40 = v40 + 16.0;
      (*(void (__cdecl **)(int, float, float, char *))(v26 + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aPleaseUpgradeT_0);
      v27 = *(_DWORD *)grim_interface_ptr;
      v40 = v40 + 16.0;
      (*(void (__cdecl **)(int, float, float, char *))(v27 + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aAndTakesJustMi);
      v28 = *(_DWORD *)grim_interface_ptr;
      v40 = v40 + 22.0;
      (*(void (__cdecl **)(int, float, float, char *))(v28 + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aBuyTheFullVers);
      v40 = v40 + 16.0;
      (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aGameModesAndBe);
      v18 = v40 + 16.0;
    }
    else
    {
      v10 = v39;
      (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aTrialTimeIsUpI);
      v19 = *(_DWORD *)grim_interface_ptr;
      v40 = v40 + 18.0;
      (*(void (__cdecl **)(int, float, float, char *))(v19 + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aAllFeaturesPle);
      v20 = *(_DWORD *)grim_interface_ptr;
      v40 = v40 + 18.0;
      (*(void (__cdecl **)(int, float, float, char *))(v20 + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aIsVeryEasyAndT);
      v21 = *(_DWORD *)grim_interface_ptr;
      v40 = v40 + 24.0;
      (*(void (__cdecl **)(int, float, float, char *))(v21 + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aBuyTheFullVers);
      v22 = *(_DWORD *)grim_interface_ptr;
      v40 = v40 + 18.0;
      (*(void (__cdecl **)(int, float, float, char *))(v22 + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v39)),
        COERCE_FLOAT(LODWORD(v40)),
        aGameModesAndBe);
      v18 = v40 + 18.0;
    }
    goto LABEL_31;
  }
  if ( game_state_id != 9 || *(int *)quest_stage_major <= 1 && quest_stage_minor <= 10 )
    goto LABEL_27;
  v40 = v40 - 6.0;
  v10 = v39;
  if ( dword_48084C > 0 )
  {
    v14 = *(_DWORD *)grim_interface_ptr;
    v40 = v40 + 6.0;
    (*(void (__cdecl **)(int, float, float, char *))(v14 + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v39)),
      COERCE_FLOAT(LODWORD(v40)),
      aYouVeCompleted_0);
    v13 = v40 + 18.0;
  }
  else
  {
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v39)),
      COERCE_FLOAT(LODWORD(v40)),
      aYouVeCompleted_0);
    v11 = *(_DWORD *)grim_interface_ptr;
    v40 = v40 + 18.0;
    (*(void (**)(int, float, float, char *, ...))(v11 + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v39)),
      COERCE_FLOAT(LODWORD(v40)),
      aHoweverYouStil,
      v44);
    v12 = *(_DWORD *)grim_interface_ptr;
    v40 = v40 + 18.0;
    (*(void (__cdecl **)(int, float, float, CHAR *))(v12 + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v39)),
      COERCE_FLOAT(LODWORD(v40)),
      szPassword);
    v13 = v40 + 14.0;
  }
  v40 = v13;
  (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v39)),
    COERCE_FLOAT(LODWORD(v40)),
    aIfYouWouldLike);
  v15 = *(_DWORD *)grim_interface_ptr;
  v40 = v40 + 18.0;
  (*(void (__cdecl **)(int, float, float, char *))(v15 + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v39)),
    COERCE_FLOAT(LODWORD(v40)),
    aPleaseUpgradeT);
  v16 = *(_DWORD *)grim_interface_ptr;
  v40 = v40 + 22.0;
  (*(void (__cdecl **)(int, float, float, char *))(v16 + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v39)),
    COERCE_FLOAT(LODWORD(v40)),
    aTheFullVersion);
  v17 = *(_DWORD *)grim_interface_ptr;
  v40 = v40 + 18.0;
  (*(void (__cdecl **)(int, float, float, char *))(v17 + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v39)),
    COERCE_FLOAT(LODWORD(v40)),
    aGameModesAndBe);
  v18 = v40 + 18.0;
LABEL_31:
  v40 = v18;
  (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v10)),
    COERCE_FLOAT(LODWORD(v40)),
    aItNowYouLlHave);
  if ( (byte_47F62C & 1) == 0 )
  {
    byte_48080E = 1;
    byte_47F62C |= 1u;
    byte_48081D = 0;
    byte_48081C = 0;
    dword_480818 = 1065353216;
    dword_480814 = 0;
    dword_480808 = 0;
    byte_48080C = 0;
    byte_48080D = 0;
    dword_480810 = 0;
    crt_atexit(nullsub_3);
  }
  dword_480808 = (int)aMaybeLater;
  if ( (byte_47F62C & 2) == 0 )
  {
    byte_47F5FE = 1;
    byte_47F62C |= 2u;
    byte_47F60D = 0;
    byte_47F60C = 0;
    dword_47F608 = 1065353216;
    dword_47F604 = 0;
    ui_button_table_a = 0;
    byte_47F5FC = 0;
    byte_47F5FD = 0;
    dword_47F600 = 0;
    crt_atexit(nullsub_2);
  }
  ui_button_table_a = (int)aPurchase;
  if ( (byte_47F62C & 4) == 0 )
  {
    byte_47F616 = 1;
    byte_47F62C |= 4u;
    byte_47F625 = 0;
    byte_47F624 = 0;
    dword_47F620 = 1065353216;
    dword_47F61C = 0;
    dword_47F610 = 0;
    byte_47F614 = 0;
    byte_47F615 = 0;
    dword_47F618 = 0;
    crt_atexit(nullsub_1);
  }
  dword_47F610 = (int)aAlreadyPaid;
  v42[0] = *a1 + 22.0;
  v29 = a1[1] + 212.0;
  v39 = v42[0] + 6.0;
  v41 = v29 + 6.0;
  v40 = v41;
  if ( (unsigned __int8)ui_button_update(&v39, &ui_button_table_a) )
  {
    byte_480851 = 1;
    byte_47EA50 = 1;
    ShellExecuteA(0, Operation, File, 0, 0, 1);
  }
  v42[0] = v42[0] + 326.0;
  v42[1] = v41;
  result = ui_button_update(v42, &dword_480808);
  if ( (_BYTE)result )
  {
    ui_transition_direction = 0;
    game_state_pending = 0;
    render_pass_mode = 0;
    sfx_mute_all(music_track_intro_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    return sfx_play_exclusive(music_track_crimson_theme_id);
  }
  return result;
}

// nullsub_1 @ 0x00405130
void __cdecl nullsub_1()
{
  ;
}

// nullsub_2 @ 0x00405140
void __cdecl nullsub_2()
{
  ;
}

// nullsub_3 @ 0x00405150
void __cdecl nullsub_3()
{
  ;
}

// ui_render_keybind_help @ 0x00405160
// renders the in-game key bindings help overlay
int __cdecl sub_405160(float *a1, float a2)
{
  float v2; // edi
  int v3; // ebx
  char *v4; // eax
  int v5; // ebp
  char *v6; // eax
  int v7; // eax
  float v8; // ebp
  int v9; // esi
  int v10; // esi
  int v11; // ebp
  char *v12; // eax
  float v13; // ebx
  int v14; // ebp
  char *v15; // eax
  int v16; // eax
  int v17; // ebp
  char *v18; // eax
  int v19; // ebp
  char *v20; // eax
  char *v21; // eax
  int v23; // [esp+5Ch] [ebp-40h]
  int v24; // [esp+5Ch] [ebp-40h]
  int v25; // [esp+64h] [ebp-38h]
  float v26; // [esp+64h] [ebp-38h]
  int v27; // [esp+64h] [ebp-38h]
  float v28; // [esp+64h] [ebp-38h]
  int v29; // [esp+68h] [ebp-34h]
  float v30; // [esp+68h] [ebp-34h]
  int v31; // [esp+68h] [ebp-34h]
  float v32; // [esp+68h] [ebp-34h]
  int v33; // [esp+6Ch] [ebp-30h]
  int v34; // [esp+6Ch] [ebp-30h]
  int v35; // [esp+80h] [ebp-1Ch]
  float v36; // [esp+84h] [ebp-18h]
  float v37; // [esp+88h] [ebp-14h]
  float v38; // [esp+88h] [ebp-14h]
  float v39; // [esp+88h] [ebp-14h]
  float v40; // [esp+88h] [ebp-14h]
  float v41; // [esp+88h] [ebp-14h]
  float v42; // [esp+88h] [ebp-14h]
  float v43; // [esp+88h] [ebp-14h]
  _DWORD v44[4]; // [esp+8Ch] [ebp-10h] BYREF
  float v45; // [esp+A0h] [ebp+4h]
  int v46; // [esp+A0h] [ebp+4h]
  float v47; // [esp+A4h] [ebp+8h]
  int v48; // [esp+A4h] [ebp+8h]

  *(float *)&v44[3] = a2 * 0.80000001;
  memset(v44, 0, 12);
  (*(void (__thiscall **)(int, float *, int, int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    a1,
    1140850688,
    1132462080,
    v44);
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    LODWORD(a2));
  (*(void (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
    grim_interface_ptr,
    a1,
    1140850688,
    1132462080);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1061997773,
    v25,
    v29,
    v33);
  v30 = a1[1] + 16.0;
  v26 = *a1 + 16.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 320))(
    grim_interface_ptr,
    LODWORD(v26),
    LODWORD(v30),
    aKeyInfo);
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    LODWORD(a2));
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v27,
    v31,
    v34);
  v36 = *a1 + 32.0;
  v37 = a1[1] + 50.0;
  v2 = v36;
  (*(void (__cdecl **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v36)),
    LODWORD(v37),
    aLevelUp);
  v3 = *(_DWORD *)grim_interface_ptr;
  v47 = v36 + 128.0;
  v4 = input_key_name(config_key_pick_perk);
  (*(void (**)(int, _DWORD, _DWORD, char *, ...))(v3 + 328))(
    grim_interface_ptr,
    LODWORD(v47),
    LODWORD(v37),
    aSOrSpaceBarOrK,
    v4);
  v38 = v37 + 18.0;
  (*(void (__cdecl **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v36)),
    LODWORD(v38),
    aReload);
  v5 = *(_DWORD *)grim_interface_ptr;
  v6 = input_key_name(config_key_reload);
  (*(void (**)(int, _DWORD, _DWORD, char *, ...))(v5 + 328))(grim_interface_ptr, LODWORD(v47), LODWORD(v38), aS_0, v6);
  v7 = 0;
  v48 = 0;
  v39 = v38 + 18.0 + 20.0;
  v8 = v39;
  do
  {
    v9 = 5 * v7;
    if ( v7 == 1 )
    {
      v36 = v36 + 256.0;
      v2 = v36;
    }
    v35 = v7 + 1;
    (*(void (**)(int, float, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v2)),
      COERCE_FLOAT(LODWORD(v8)),
      aPlayerD,
      v7 + 1);
    v40 = v39 + 22.0;
    (*(void (__cdecl **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v2)),
      LODWORD(v40),
      aUp_0);
    v23 = config_p1_move_forward[v9];
    v10 = v9 + 1;
    v11 = *(_DWORD *)grim_interface_ptr;
    v45 = v36 + 64.0;
    v12 = input_key_name(v23);
    v13 = v45;
    (*(void (**)(int, _DWORD, _DWORD, char *, ...))(v11 + 328))(
      grim_interface_ptr,
      LODWORD(v45),
      LODWORD(v40),
      aS_0,
      v12);
    v41 = v40 + 16.0;
    (*(void (__cdecl **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v2)),
      LODWORD(v41),
      aDown_0);
    v24 = config_p1_move_forward[v10++];
    v14 = *(_DWORD *)grim_interface_ptr;
    v15 = input_key_name(v24);
    (*(void (**)(int, _DWORD, _DWORD, char *, ...))(v14 + 328))(
      grim_interface_ptr,
      LODWORD(v45),
      LODWORD(v41),
      aS_0,
      v15);
    v42 = v41 + 16.0;
    (*(void (__cdecl **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v2)),
      LODWORD(v42),
      aLeft_0);
    v16 = config_p1_move_forward[v10++];
    v17 = *(_DWORD *)grim_interface_ptr;
    v18 = input_key_name(v16);
    (*(void (**)(int, _DWORD, _DWORD, char *, ...))(v17 + 328))(
      grim_interface_ptr,
      LODWORD(v45),
      LODWORD(v42),
      aS_0,
      v18);
    v43 = v42 + 16.0;
    (*(void (__cdecl **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v2)),
      LODWORD(v43),
      aRight_0);
    v19 = *(_DWORD *)grim_interface_ptr;
    v20 = input_key_name(config_p1_move_forward[v10]);
    (*(void (**)(int, _DWORD, _DWORD, char *, ...))(v19 + 328))(
      grim_interface_ptr,
      LODWORD(v45),
      LODWORD(v43),
      aS_0,
      v20);
    v39 = v43 + 16.0;
    v8 = v39;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v2)),
      COERCE_FLOAT(LODWORD(v39)),
      aFire);
    v46 = *(_DWORD *)grim_interface_ptr;
    v21 = input_key_name(config_p1_move_backward[v10]);
    (*(void (**)(int, float, float, char *, ...))(v46 + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v13)),
      COERCE_FLOAT(LODWORD(v39)),
      aS_0,
      v21);
    if ( !v48 )
    {
      v39 = v39 - 94.0;
      v8 = v39;
    }
    v7 = v35;
    v48 = v35;
  }
  while ( v35 < 2 );
  v32 = v39 + 32.0;
  v28 = v36 - 20.0;
  return (*(int (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
           grim_interface_ptr,
           LODWORD(v28),
           LODWORD(v32),
           aPressF1ToRetur);
}

// perk_apply @ 0x004055E0
// applies perk effects and increments perk counter
int __cdecl sub_4055E0(int a1)
{
  int v1; // edi
  bool v2; // zf
  char v3; // bl
  char *v4; // esi
  int v5; // ebp
  float *v6; // ecx
  int v7; // edx
  double v8; // st7
  float *v9; // eax
  int v10; // ecx
  double v11; // st7
  float *v12; // eax
  int v13; // esi
  int v14; // eax
  int v15; // esi
  int *v16; // edi
  int v17; // edx
  int *v18; // ecx
  int v19; // edx
  int v20; // edi
  float *v21; // esi
  double v22; // st7
  float *v23; // eax
  double v24; // st7
  int result; // eax

  sfx_play(sfx_ui_bonus, 1.0);
  v1 = a1;
  v2 = a1 == perk_id_instant_winner;
  *(&player_perk_counts + a1) = (std::codecvt_base *)((char *)*(&player_perk_counts + a1) + 1);
  if ( v2 )
  {
    player_experience += 2500;
LABEL_39:
    v5 = config_player_count;
    goto LABEL_40;
  }
  if ( a1 == perk_id_fatal_lottery )
  {
    if ( (crt_rand() & 1) != 0 )
      player_health = -1082130432;
    else
      player_experience += 10000;
    goto LABEL_39;
  }
  if ( a1 == perk_id_lifeline_50_50 )
  {
    v3 = 0;
    v4 = &creature_pool;
    do
    {
      if ( (v3 & 1) != 0 && *v4 && *((float *)v4 + 9) <= 500.0 && (v4[140] & 4) == 0 )
      {
        *v4 = 0;
        effect_spawn_burst(v4 + 20, 4);
      }
      v4 += 152;
      ++v3;
    }
    while ( (int)v4 < (int)byte_4AA338 );
    v5 = config_player_count;
  }
  else if ( a1 == perk_id_thick_skinned )
  {
    v5 = config_player_count;
    if ( config_player_count > 0 )
    {
      v6 = (float *)&player_health;
      v7 = config_player_count;
      do
      {
        if ( *v6 > 0.0 )
        {
          v8 = *v6 - *v6 * 0.33333334;
          *v6 = v8;
          if ( v8 <= 0.0 )
            *v6 = 1.0;
        }
        v6 += 216;
        --v7;
      }
      while ( v7 );
    }
  }
  else
  {
    if ( a1 != perk_id_breathing_room )
    {
      if ( a1 == perk_id_random_weapon )
      {
        v13 = 0;
        do
        {
          v14 = weapon_pick_random_available();
          ++v13;
        }
        while ( (v14 == 1 || v14 == player_weapon_id) && v13 < 100 );
        weapon_assign_player(0, v14);
      }
      goto LABEL_39;
    }
    v5 = config_player_count;
    if ( config_player_count > 0 )
    {
      v9 = (float *)&player_health;
      v10 = config_player_count;
      do
      {
        v11 = *v9 * 0.66666669;
        v9 += 216;
        --v10;
        *(v9 - 216) = *(v9 - 216) - v11;
      }
      while ( v10 );
    }
    v12 = (float *)&creature_hitbox_size;
    do
    {
      if ( *((_BYTE *)v12 - 16) )
        *v12 = *v12 - frame_dt;
      v12 += 38;
    }
    while ( (int)v12 < (int)&flt_4AA348 );
    bonus_spawn_guard = 0;
  }
LABEL_40:
  if ( a1 == perk_id_infernal_contract )
  {
    player_level += 3;
    perk_pending_count += 3;
    if ( *(float *)&player_health > 0.0 )
      player_health = 1036831949;
    if ( player2_health > 0.0 )
      player2_health = 0.1;
  }
  if ( a1 == perk_id_grim_deal )
  {
    player_health = -1082130432;
    player_experience += (__int64)((double)player_experience * 0.18000001);
  }
  if ( a1 == perk_id_ammo_maniac )
  {
    v15 = 0;
    if ( v5 > 0 )
    {
      v16 = &player_weapon_id;
      do
      {
        weapon_assign_player(v15, *v16);
        v5 = config_player_count;
        ++v15;
        v16 += 216;
      }
      while ( v15 < config_player_count );
      v1 = a1;
    }
  }
  if ( v1 == perk_id_death_clock )
  {
    v17 = perk_id_regeneration;
    *(&player_perk_counts + perk_id_greater_regeneration) = 0;
    *(&player_perk_counts + v17) = 0;
    if ( v5 > 0 )
    {
      v18 = &player_health;
      v19 = v5;
      do
      {
        if ( *(float *)v18 > 0.0 )
          *v18 = 1120403456;
        v18 += 216;
        --v19;
      }
      while ( v19 );
    }
  }
  if ( v1 == perk_id_bandage )
  {
    v20 = 0;
    if ( v5 > 0 )
    {
      v21 = (float *)&player_health;
      do
      {
        v22 = ((double)(crt_rand() % 50) + 1.0) * *v21;
        *v21 = v22;
        if ( v22 > 100.0 )
          *v21 = 100.0;
        effect_spawn_burst(v21 - 4, 8);
        v5 = config_player_count;
        ++v20;
        v21 += 216;
      }
      while ( v20 < config_player_count );
    }
    v1 = a1;
  }
  if ( v1 == perk_id_my_favourite_weapon && v5 > 0 )
  {
    v23 = (float *)&player_clip_size;
    do
    {
      v24 = *v23 + 2.0;
      v23 += 216;
      --v5;
      *(v23 - 216) = v24;
    }
    while ( v5 );
  }
  result = perk_id_plaguebearer;
  if ( v1 == perk_id_plaguebearer )
    player_plaguebearer_active = 1;
  return result;
}

// perk_selection_screen_update @ 0x00405BE0
// perk selection screen: list choices, preview text, and selection handling
int sub_405BE0()
{
  double v0; // st7
  int v1; // ecx
  _DWORD *v2; // eax
  int v3; // edi
  char *v4; // esi
  int *v5; // ebp
  int result; // eax
  float v7; // [esp+54h] [ebp-44h]
  float v8; // [esp+54h] [ebp-44h]
  int v9; // [esp+54h] [ebp-44h]
  float v10; // [esp+54h] [ebp-44h]
  float v11; // [esp+58h] [ebp-40h]
  float v12; // [esp+58h] [ebp-40h]
  int v13; // [esp+58h] [ebp-40h]
  int v14; // [esp+5Ch] [ebp-3Ch]
  int v15; // [esp+60h] [ebp-38h]
  int v16; // [esp+64h] [ebp-34h]
  int v17; // [esp+68h] [ebp-30h]
  char v18; // [esp+73h] [ebp-25h]
  int v19; // [esp+74h] [ebp-24h]
  float v20[2]; // [esp+78h] [ebp-20h] BYREF
  float v21; // [esp+80h] [ebp-18h] BYREF
  float v22; // [esp+84h] [ebp-14h]
  float v23; // [esp+88h] [ebp-10h]
  float v24; // [esp+8Ch] [ebp-Ch]
  float v25; // [esp+94h] [ebp-4h]

  gameplay_render_world();
  ui_elements_update_and_render();
  v25 = flt_48C634 + flt_48C658;
  v20[0] = 19.0;
  v18 = 0;
  v19 = 5;
  v23 = flt_48C654 + flt_48C630 + 180.0;
  v24 = v25 + 40.0;
  v22 = v24;
  v21 = flt_48C620 + v23 + 44.0;
  v23 = v21;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  ui_draw_textured_quad((__int64)(v21 + 54.0), (__int64)(v24 + 6.0), 128, 32, dword_48F800);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1056964608);
  if ( (int)*(&player_perk_counts + perk_id_perk_master) <= 0 )
  {
    if ( (int)*(&player_perk_counts + perk_id_perk_expert) > 0 )
    {
      v12 = v22 - 8.0;
      v8 = v21 - 26.0;
      (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v8),
        LODWORD(v12),
        aExtraPerkSpons);
      v19 = 6;
    }
  }
  else
  {
    v11 = v22 - 8.0;
    v7 = v21 - 28.0;
    (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      LODWORD(v7),
      LODWORD(v11),
      aExtraPerksSpon);
    v19 = 7;
  }
  if ( (int)*(&player_perk_counts + perk_id_perk_expert) <= 0 )
  {
    v0 = v22 + 50.0;
  }
  else
  {
    v0 = v22 + 40.0;
    v20[0] = 18.0;
  }
  v22 = v0;
  if ( (byte_4807C8 & 1) == 0 )
  {
    dword_480298 = 1049398413;
    byte_4807C8 |= 1u;
    dword_48029C = 1060418741;
    dword_4802A0 = 1064366321;
    dword_4802A4 = 1058642330;
    crt_atexit(nullsub_8);
  }
  if ( (byte_4807C8 & 2) == 0 )
  {
    dword_480310 = 1049398413;
    byte_4807C8 |= 2u;
    dword_480314 = 1060418741;
    dword_480318 = 1064366321;
    dword_48031C = 1065353216;
    crt_atexit(nullsub_7);
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  if ( (byte_4807C8 & 4) == 0 )
  {
    v1 = 10;
    byte_4807C8 |= 4u;
    v2 = &unk_4800B4;
    do
    {
      *((_BYTE *)v2 - 6) = 1;
      *v2 = 1065353216;
      *(v2 - 3) = 0;
      *((_BYTE *)v2 - 8) = 0;
      *((_BYTE *)v2 - 7) = 0;
      *(v2 - 1) = 0;
      v2 += 4;
      --v1;
    }
    while ( v1 );
    crt_atexit(nullsub_6);
  }
  v3 = 0;
  v4 = (char *)&unk_4800A8;
  v5 = perk_choice_ids;
  do
  {
    *(_DWORD *)v4 = perk_name_table[5 * *v5];
    ui_menu_item_update(&v21, v4, v15, v16, v17);
    if ( v4[4] )
    {
      v18 = 1;
      dword_48089C = v3;
    }
    ++v3;
    ++v5;
    v4 += 16;
    v22 = v22 + v20[0];
  }
  while ( v3 < v19 );
  v22 = v22 + 32.0;
  if ( v19 > 5 )
    v22 = v22 - 20.0;
  v21 = v21 - 28.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v9,
    v13,
    v14);
  v10 = v21 + 16.0;
  (*(void (__stdcall **)(_DWORD, float, int))(*(_DWORD *)grim_interface_ptr + 324))(
    LODWORD(v10),
    COERCE_FLOAT(LODWORD(v22)),
    perk_desc_table[5 * perk_choice_ids[dword_48089C]]);
  if ( (byte_4807C8 & 8) == 0 )
  {
    byte_480096 = 1;
    byte_4807C8 |= 8u;
    byte_4800A5 = 0;
    byte_4800A4 = 0;
    dword_4800A0 = 1065353216;
    dword_48009C = 0;
    dword_480090 = 0;
    byte_480094 = 0;
    byte_480095 = 0;
    dword_480098 = 0;
    crt_atexit(nullsub_5);
  }
  dword_480090 = (int)aCancel;
  if ( (byte_4807C8 & 0x10) == 0 )
  {
    byte_480826 = 1;
    byte_4807C8 |= 0x10u;
    byte_480835 = 0;
    byte_480834 = 0;
    dword_480830 = 1065353216;
    dword_48082C = 0;
    dword_480820 = 0;
    byte_480824 = 0;
    byte_480825 = 0;
    dword_480828 = 0;
    crt_atexit(nullsub_4);
  }
  dword_480820 = (int)aSelect;
  v20[0] = v23 + 162.0;
  v20[1] = v24 + 276.0;
  if ( (unsigned __int8)ui_button_update(v20, &dword_480090) )
  {
    ui_transition_direction = 0;
    game_state_pending = 9;
  }
  perk_prompt_update_and_render();
  result = ui_cursor_render();
  if ( v18 )
  {
    result = dword_48089C;
    if ( dword_48089C >= 0 )
    {
      result = 16 * dword_48089C;
      if ( byte_4800AD[16 * dword_48089C] )
      {
        sfx_play(sfx_ui_buttonclick, 1.0);
        perk_apply(perk_choice_ids[dword_48089C]);
        result = perk_pending_count - 1;
        ui_transition_direction = 0;
        game_state_pending = 9;
        --perk_pending_count;
        perk_choices_dirty = 1;
      }
    }
  }
  return result;
}

// nullsub_4 @ 0x00406130
void __cdecl nullsub_4()
{
  ;
}

// nullsub_5 @ 0x00406140
void __cdecl nullsub_5()
{
  ;
}

// nullsub_6 @ 0x00406150
void __cdecl nullsub_6()
{
  ;
}

// nullsub_7 @ 0x00406160
void __cdecl nullsub_7()
{
  ;
}

// nullsub_8 @ 0x00406170
void __cdecl nullsub_8()
{
  ;
}

// sub_406180 @ 0x00406180
char *__cdecl sub_406180(int a1)
{
  int v1; // edx

  if ( a1 >= 8 && a1 <= 20 )
    goto LABEL_10;
  v1 = a1 % 10;
  if ( !(a1 % 10) )
    goto LABEL_10;
  if ( v1 != 1 )
  {
    if ( v1 == 2 )
    {
      crt_sprintf(byte_4802C8, "%d%s", a1, aNd);
      return byte_4802C8;
    }
    if ( v1 == 3 )
    {
      crt_sprintf(byte_4802C8, "%d%s", a1, aRd);
      return byte_4802C8;
    }
LABEL_10:
    crt_sprintf(byte_4802C8, "%d%s", a1, aTh);
    return byte_4802C8;
  }
  crt_sprintf(byte_4802C8, "%d%s", a1, aSt);
  return byte_4802C8;
}

// ui_draw_clock_gauge @ 0x004061E0
// draws the 32x32 clock gauge at the current transform
int __cdecl sub_4061E0(int a1, int a2, int a3, int a4)
{
  int v5; // [esp+64h] [ebp-18h]
  int v6; // [esp+68h] [ebp-14h]
  int v7; // [esp+6Ch] [ebp-10h]
  float v8; // [esp+6Ch] [ebp-10h]
  float v9; // [esp+84h] [ebp+8h]
  float v10; // [esp+8Ch] [ebp+10h]

  (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 21, 1);
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
    grim_interface_ptr,
    ui_clock_table_texture,
    0);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    a4);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v10 = (float)a2;
  v9 = (float)a1;
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    grim_interface_ptr,
    LODWORD(v9),
    LODWORD(v10),
    1107296256,
    1107296256);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v5,
    v6,
    v7);
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_48F7CC, 0);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v8 = (double)(a3 / 1000) * 0.10471976;
  (*(void (__stdcall **)(_DWORD))(*(_DWORD *)grim_interface_ptr + 252))(LODWORD(v8));
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    grim_interface_ptr,
    LODWORD(v9),
    LODWORD(v10),
    1107296256,
    1107296256);
  return (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
}

// FUN_00406350 @ 0x00406350
// [binja] int32_t sub_406350()
int sub_406350()
{
  int v0; // ecx
  int v1; // ecx
  int v3; // [esp+28h] [ebp-28h]
  int v4; // [esp+28h] [ebp-28h]
  int v5; // [esp+2Ch] [ebp-24h]
  int v6; // [esp+2Ch] [ebp-24h]
  int v7; // [esp+30h] [ebp-20h]
  int v8; // [esp+30h] [ebp-20h]
  float v9; // [esp+38h] [ebp-18h] BYREF
  float v10; // [esp+3Ch] [ebp-14h]
  float v11; // [esp+40h] [ebp-10h]
  float v12; // [esp+44h] [ebp-Ch]
  float v13; // [esp+4Ch] [ebp-4h]

  gameplay_render_world();
  ui_elements_update_and_render();
  v13 = flt_48DBDC + flt_48DC00;
  v11 = flt_48DBFC + flt_48DBD8 + 180.0;
  v12 = v13 + 40.0;
  v10 = v12;
  v9 = flt_48DBC8 + v11 + 44.0 - 10.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v10 = v12 + 6.0;
  if ( dword_487234 == -1 )
    dword_487234 = 0;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1061997773,
    v3,
    v5,
    v7);
  v0 = *(_DWORD *)grim_interface_ptr;
  if ( config_hardcore )
    (*(void (__cdecl **)(int, float, float, char *))(v0 + 320))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aIncredible);
  else
    (*(void (__cdecl **)(int, float, float, char *))(v0 + 320))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aCongratulation);
  v10 = v10 + 32.0;
  v9 = v9 - 8.0;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v4,
    v6,
    v8);
  v1 = *(_DWORD *)grim_interface_ptr;
  if ( config_hardcore )
  {
    (*(void (__cdecl **)(int, float, float, char *))(v1 + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aYouVeDoneTheTh);
    v10 = v10 + 14.0;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aVirtuallyImpos);
    v10 = v10 + 14.0;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aEffortsANewWea);
    v10 = v10 + 14.0;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aForYouSplitter);
    v10 = v10 + 14.0;
    (*(void (__cdecl **)(int, float, float, CHAR *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      szPassword);
    v10 = v10 + 14.0;
    (*(void (__cdecl **)(int, float, float, CHAR *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      szPassword);
  }
  else
  {
    (*(void (__cdecl **)(int, float, float, char *))(v1 + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aYouVeCompleted);
    v10 = v10 + 14.0;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aIsnTOverYetWit);
    v10 = v10 + 14.0;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aAndWeaponsYour);
    v10 = v10 + 14.0;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aYouCanAlsoRepl);
    v10 = v10 + 14.0;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aAsAnAdditional);
    v10 = v10 + 14.0;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aPlayingAComple);
    v10 = v10 + 14.0;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v9)),
      COERCE_FLOAT(LODWORD(v10)),
      aModeIsUnlocked);
  }
  v10 = v10 + 14.0 + 8.0;
  (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v9)),
    COERCE_FLOAT(LODWORD(v10)),
    aGoodLuckWithYo);
  v13 = flt_48DBDC + flt_48DC00;
  v11 = flt_48DBFC + flt_48DBD8 + 180.0;
  v12 = v13 + 40.0;
  v9 = v11 + flt_48DBC8 + 44.0 + 20.0;
  v10 = v12 + 170.0;
  if ( (byte_480321 & 1) == 0 )
  {
    byte_47F5E6 = 1;
    byte_480321 |= 1u;
    byte_47F5F5 = 0;
    byte_47F5F4 = 0;
    dword_47F5F0 = 1065353216;
    dword_47F5EC = 0;
    dword_47F5E0 = 0;
    byte_47F5E4 = 0;
    byte_47F5E5 = 0;
    dword_47F5E8 = 0;
    crt_atexit(nullsub_12);
  }
  dword_47F5E0 = (int)aSurvival;
  if ( (byte_480321 & 2) == 0 )
  {
    byte_480286 = 1;
    byte_480321 |= 2u;
    byte_480295 = 0;
    byte_480294 = 0;
    dword_480290 = 1065353216;
    dword_48028C = 0;
    dword_480280 = 0;
    byte_480284 = 0;
    byte_480285 = 0;
    dword_480288 = 0;
    crt_atexit(nullsub_11);
  }
  dword_480280 = (int)aRush;
  if ( (byte_480321 & 4) == 0 )
  {
    byte_48032E = 1;
    byte_480321 |= 4u;
    byte_48033D = 0;
    byte_48033C = 0;
    dword_480338 = 1065353216;
    dword_480334 = 0;
    dword_480328 = 0;
    byte_48032C = 0;
    byte_48032D = 0;
    dword_480330 = 0;
    crt_atexit(nullsub_10);
  }
  dword_480328 = (int)aTypOShooter;
  if ( (byte_480321 & 8) == 0 )
  {
    byte_48026E = 1;
    byte_480321 |= 8u;
    byte_48027D = 0;
    byte_48027C = 0;
    dword_480278 = 1065353216;
    dword_480274 = 0;
    dword_480268 = 0;
    byte_48026C = 0;
    byte_48026D = 0;
    dword_480270 = 0;
    crt_atexit(nullsub_9);
  }
  dword_480268 = (int)aMainMenu;
  v9 = v9 - 4.0 + 26.0;
  ui_button_update(&v9, &dword_47F5E0);
  v10 = v10 + 32.0;
  ui_button_update(&v9, &dword_480280);
  v10 = v10 + 32.0;
  ui_button_update(&v9, &dword_480328);
  v10 = v10 + 32.0;
  ui_button_update(&v9, &dword_480268);
  v10 = v10 + 32.0;
  if ( byte_480285 )
  {
    ui_transition_direction = 0;
    game_state_pending = 9;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    config_game_mode = 2;
  }
  if ( byte_47F5E5 )
  {
    ui_transition_direction = 0;
    game_state_pending = 9;
    config_game_mode = 1;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
  }
  if ( byte_48032D )
  {
    render_pass_mode = 0;
    ui_transition_direction = 0;
    game_state_pending = 18;
    config_game_mode = 4;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    byte_48702C = 1;
  }
  if ( byte_48026D )
  {
    sfx_mute_all(music_track_extra_0);
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_play_exclusive(music_track_crimson_theme_id);
    ui_transition_direction = 0;
    game_state_pending = 0;
    byte_487292 = 0;
  }
  return ui_cursor_render();
}

// nullsub_9 @ 0x00406AB0
void __cdecl nullsub_9()
{
  ;
}

// nullsub_10 @ 0x00406AC0
void __cdecl nullsub_10()
{
  ;
}

// nullsub_11 @ 0x00406AD0
void __cdecl nullsub_11()
{
  ;
}

// nullsub_12 @ 0x00406AE0
void __cdecl nullsub_12()
{
  ;
}

// FUN_00406af0 @ 0x00406AF0
// [binja] int32_t sub_406af0()
int sub_406AF0()
{
  if ( render_pass_mode || game_state_id == 5 )
    gameplay_render_world();
  else
    terrain_render();
  (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 204))(
    grim_interface_ptr,
    0,
    0,
    0,
    LODWORD(screen_fade_alpha));
  ui_elements_update_and_render();
  perk_prompt_update_and_render();
  return ui_cursor_render();
}

// perks_update_effects @ 0x00406B40
// updates perk timers/effects (regen, shields, evil eyes, jinxed, bonus timers)
void sub_406B40()
{
  int v0; // edx
  double v1; // st7
  int v2; // ecx
  double v3; // st7
  int v4; // eax
  int v5; // eax
  int v6; // edx
  int *v7; // ecx
  int v8; // edi
  double v9; // st7
  int *v10; // esi
  double v11; // st7
  int v12; // eax
  int v13; // edx
  double v14; // st7
  float v15; // [esp+0h] [ebp-24h]
  float v16; // [esp+0h] [ebp-24h]
  float v17; // [esp+0h] [ebp-24h]
  float v18; // [esp+0h] [ebp-24h]
  float v19; // [esp+0h] [ebp-24h]
  int v20; // [esp+1Ch] [ebp-8h] BYREF
  int v21; // [esp+20h] [ebp-4h]

  if ( perk_count_get(perk_id_regeneration) && (crt_rand() & 1) != 0 )
  {
    v0 = config_player_count;
    if ( config_player_count > 0 )
    {
      v1 = *(float *)player_health;
      v2 = config_player_count;
      do
      {
        if ( v1 < 100.0 && v1 > 0.0 )
        {
          v1 = v1 + frame_dt;
          if ( v1 > 100.0 )
            v1 = 100.0;
        }
        --v2;
      }
      while ( v2 );
      *(float *)player_health = v1;
    }
  }
  else
  {
    v0 = config_player_count;
  }
  v3 = flt_4808A4 - frame_dt;
  flt_4808A4 = v3;
  if ( v3 < 0.0 )
  {
    flt_4808A4 = 0.25;
    v4 = (int)*(&player_perk_counts + perk_id_lean_mean_exp_machine);
    if ( v4 > 0 )
      player_experience += 10 * v4;
  }
  render_overlay_player_index = 0;
  if ( v0 > 0 )
  {
    do
    {
      v5 = perk_count_get(perk_id_death_clock);
      v6 = render_overlay_player_index;
      if ( v5 )
      {
        v7 = &player_health[216 * render_overlay_player_index];
        if ( *(float *)v7 <= 0.0 )
          *v7 = 0;
        else
          *(float *)v7 = *(float *)v7 - frame_dt * 3.3333333;
      }
      if ( *(float *)&player_shield_timer[216 * v6] <= 0.0 )
        player_shield_timer[216 * v6] = 0;
      else
        *(float *)&player_shield_timer[216 * v6] = *(float *)&player_shield_timer[216 * v6] - frame_dt;
      if ( *(float *)&player_fire_bullets_timer[216 * v6] <= 0.0 )
        player_fire_bullets_timer[216 * v6] = 0;
      else
        *(float *)&player_fire_bullets_timer[216 * v6] = *(float *)&player_fire_bullets_timer[216 * v6] - frame_dt;
      if ( *(float *)&player_speed_bonus_timer[216 * v6] <= 0.0 )
        player_speed_bonus_timer[216 * v6] = 0;
      else
        *(float *)&player_speed_bonus_timer[216 * v6] = *(float *)&player_speed_bonus_timer[216 * v6] - frame_dt;
      render_overlay_player_index = v6 + 1;
    }
    while ( v6 + 1 < config_player_count );
  }
  dword_487268 = -1;
  if ( (int)*(&player_perk_counts + perk_id_doctor) > 0
    || (int)*(&player_perk_counts + perk_id_pyrokinetic) > 0
    || (int)*(&player_perk_counts + perk_id_evil_eyes) > 0 )
  {
    evil_eyes_target_creature = -1;
    v8 = creature_find_in_radius((int)&player_aim_x, 12.0, 0);
    if ( v8 != -1 )
    {
      if ( perk_count_get(perk_id_doctor) )
        dword_487268 = v8;
      if ( perk_count_get(perk_id_pyrokinetic) )
      {
        v9 = *(float *)&creature_collision_timer[38 * v8] - frame_dt;
        *(float *)&creature_collision_timer[38 * v8] = v9;
        if ( v9 < 0.0 )
        {
          creature_collision_timer[38 * v8] = 1056964608;
          v10 = &creature_pos_x + 38 * v8;
          v20 = 0;
          v21 = 0;
          v15 = (double)(crt_rand() % 628) * 0.0099999998;
          fx_spawn_particle((int)v10, v15, (int)&v20, 1061997773);
          v20 = 0;
          v21 = 0;
          v16 = (double)(crt_rand() % 628) * 0.0099999998;
          fx_spawn_particle((int)v10, v16, (int)&v20, 1058642330);
          v20 = 0;
          v21 = 0;
          v17 = (double)(crt_rand() % 628) * 0.0099999998;
          fx_spawn_particle((int)v10, v17, (int)&v20, 1053609165);
          v20 = 0;
          v21 = 0;
          v18 = (double)(crt_rand() % 628) * 0.0099999998;
          fx_spawn_particle((int)v10, v18, (int)&v20, 1050253722);
          v20 = 0;
          v21 = 0;
          v19 = (double)(crt_rand() % 628) * 0.0099999998;
          fx_spawn_particle((int)v10, v19, (int)&v20, 1045220557);
          fx_queue_add_random(v10);
        }
      }
      if ( perk_count_get(perk_id_evil_eyes) )
        evil_eyes_target_creature = v8;
    }
  }
  if ( !perk_count_get(perk_id_evil_eyes) )
    evil_eyes_target_creature = -1;
  if ( flt_4AAF1C < 0.0 || (v11 = flt_4AAF1C - frame_dt, flt_4AAF1C = v11, v11 < 0.0) )
  {
    if ( (int)*(&player_perk_counts + perk_id_jinxed) > 0 )
    {
      if ( crt_rand() % 10 == 3 )
      {
        *(float *)player_health = *(float *)player_health - 5.0;
        fx_queue_add_random(&player_pos_x);
        fx_queue_add_random(&player_pos_x);
      }
      flt_4AAF1C = (double)(crt_rand() % 20) * 0.1 + flt_4AAF1C + 2.0;
      if ( bonus_freeze_timer <= 0.0 )
      {
        v12 = crt_rand();
        render_overlay_player_index = 0;
        v13 = v12 % 383;
        do
        {
          if ( creature_pool[152 * v13] )
            break;
          v13 = crt_rand() % 383;
          ++render_overlay_player_index;
        }
        while ( render_overlay_player_index < 10 );
        render_overlay_player_index = 0;
        if ( creature_pool[152 * v13] )
        {
          v14 = frame_dt * 20.0;
          creature_health[38 * v13] = -1082130432;
          *(float *)&creature_hitbox_size[38 * v13] = *(float *)&creature_hitbox_size[38 * v13] - v14;
          player_experience = (__int64)((double)player_experience + creature_reward_value[38 * v13]);
          sfx_play_panned(sfx_trooper_inpain_01_alias_1, (int)(&creature_pos_x + 38 * v13), 1.0);
        }
      }
    }
  }
}

// quest_mode_update @ 0x004070E0
// quest mode update: spawn timeline, stage completion, and transitions
char sub_4070E0()
{
  int v0; // eax
  int v1; // eax
  int v2; // eax

  if ( !console_open_flag && render_pass_mode )
  {
    if ( !(unsigned __int8)creatures_none_active() || !(unsigned __int8)quest_spawn_table_empty() )
      quest_spawn_timeline += frame_dt_ms;
    dword_487244 += frame_dt_ms;
  }
  quest_spawn_timeline_update();
  LOBYTE(v0) = demo_mode_active;
  if ( !demo_mode_active )
  {
    LOBYTE(v0) = creatures_none_active();
    if ( (_BYTE)v0 )
    {
      LOBYTE(v0) = quest_spawn_table_empty();
      if ( (_BYTE)v0 )
      {
        v1 = dword_487088;
        bonus_reflex_boost_timer = 0.0;
        if ( dword_487088 >= 0 )
        {
          if ( dword_487088 <= 800 || dword_487088 > 850 )
          {
            if ( dword_487088 <= 2000 || dword_487088 > 2050 )
            {
              if ( dword_487088 > 2500 )
              {
                v2 = quest_stage_minor + 10 * *(_DWORD *)quest_stage_major - 10;
                if ( v2 > quest_unlock_index )
                  quest_unlock_index = quest_stage_minor + 10 * *(_DWORD *)quest_stage_major - 10;
                if ( config_hardcore && v2 > quest_unlock_index_full )
                  quest_unlock_index_full = quest_stage_minor + 10 * *(_DWORD *)quest_stage_major - 10;
                game_save_status();
                game_state_pending = 8;
                ui_transition_direction = 0;
                (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
                console_input_poll();
                v1 = dword_487088;
                highscore_score_xp = 0;
              }
              v0 = frame_dt_ms + v1;
              dword_487088 = v0;
            }
            else
            {
              dword_487088 = 2051;
              sfx_play_exclusive(music_track_crimsonquest_id);
              v0 = frame_dt_ms + dword_487088;
              sfx_volume_table[music_track_crimsonquest_id] = 0;
              dword_487088 = v0;
            }
          }
          else
          {
            sfx_play(sfx_questhit, 1.0);
            dword_487088 = frame_dt_ms + 851;
            LOBYTE(v0) = frame_dt_ms + 83;
          }
        }
        else
        {
          sfx_mute_all(music_track_extra_0);
          ++dword_4856B8[10 * *(_DWORD *)quest_stage_major + quest_stage_minor];
          dword_487088 = frame_dt_ms;
          LOBYTE(v0) = frame_dt_ms;
        }
      }
    }
  }
  return v0;
}

// rush_mode_update @ 0x004072B0
// rush mode update: spawns edge waves and handles demo exit
char sub_4072B0()
{
  char result; // al
  double v1; // st7
  int v2; // eax
  long double v3; // st7
  int v4; // eax
  int v5; // ecx
  float v6[2]; // [esp+4h] [ebp-20h] BYREF
  _DWORD v7[2]; // [esp+Ch] [ebp-18h] BYREF
  float v8; // [esp+14h] [ebp-10h] BYREF
  float v9; // [esp+18h] [ebp-Ch]
  float v10; // [esp+1Ch] [ebp-8h]
  int v11; // [esp+20h] [ebp-4h]

  result = console_open_flag;
  player_weapon_id = 2;
  player_ammo = 1106247680;
  player2_weapon_id = 2;
  player2_ammo = 1106247680;
  if ( !console_open_flag )
  {
    for ( survival_spawn_cooldown -= frame_dt_ms * config_player_count;
          survival_spawn_cooldown < 0;
          *(float *)(v4 * 4 + 4833172) = *(float *)(v4 * 4 + 4833172) * 1.4 )
    {
      survival_spawn_cooldown += 250;
      v1 = (double)(survival_elapsed_ms + 1);
      v11 = 1065353216;
      v8 = v1 * 0.0000083333334 + 0.30000001;
      v9 = v1 * 10000.0 + 0.30000001;
      v10 = sin(v1 * 0.0001) + 0.30000001;
      if ( v8 >= 0.0 )
      {
        if ( v8 > 1.0 )
          v8 = 1.0;
      }
      else
      {
        v8 = 0.0;
      }
      if ( v9 >= 0.0 )
      {
        if ( v9 > 1.0 )
          v9 = 1.0;
      }
      else
      {
        v9 = 0.0;
      }
      if ( v10 >= 0.0 )
      {
        if ( v10 > 1.0 )
          v10 = 1.0;
      }
      else
      {
        v10 = 0.0;
      }
      v6[0] = (double)terrain_texture_width + 64.0;
      v6[1] = cos((double)survival_elapsed_ms * 0.001) * 256.0 + (double)terrain_texture_height * 0.5;
      v2 = creature_spawn(v6, &v8, 2);
      v7[0] = -1031798784;
      v3 = sin((double)survival_elapsed_ms * 0.001);
      creature_ai_mode[38 * v2] = 8;
      *(float *)&v7[1] = v3 * 256.0 + (double)terrain_texture_height * 0.5;
      v4 = 38 * creature_spawn(v7, &v8, 3);
      creature_ai_mode[v4] = 8;
      v5 = creature_flags[v4];
      LOBYTE(v5) = v5 | 0x80;
      creature_flags[v4] = v5;
    }
    result = demo_mode_active;
    if ( demo_mode_active )
    {
      result = quest_spawn_timeline;
      if ( quest_spawn_timeline > dword_4712F0 )
      {
        render_pass_mode = 0;
        return demo_mode_start();
      }
    }
  }
  return result;
}

// survival_spawn_creature @ 0x00407510
// spawns a creature at the given position, selecting type/stats based on DAT_0049095c
void __cdecl sub_407510(_DWORD *a1)
{
  int v1; // esi
  int v2; // edx
  int v3; // eax
  int v4; // eax
  double v5; // st7
  int v6; // eax
  int v7; // eax
  double v8; // st7
  int v9; // edi
  double v10; // st7
  double v11; // st7
  double v12; // st7
  double v13; // st7
  double v14; // st7
  int v15; // edx
  int v16; // [esp+20h] [ebp+4h]

  v1 = 152 * creature_alloc_slot() + 4833080;
  *(_DWORD *)(v1 + 20) = *a1;
  *(_DWORD *)(v1 + 24) = a1[1];
  *(_BYTE *)(v1 + 9) = 0;
  *(_DWORD *)(v1 + 12) = 0;
  *(_DWORD *)(v1 + 144) = 0;
  v2 = crt_rand() % 10;
  if ( player_experience >= 12000 )
  {
    if ( player_experience >= 25000 )
    {
      if ( player_experience >= 42000 )
      {
        if ( player_experience < 50000 )
        {
          *(_DWORD *)(v1 + 108) = 2;
          goto LABEL_25;
        }
        if ( player_experience < 90000 )
        {
          *(_DWORD *)(v1 + 108) = 4;
          goto LABEL_25;
        }
        if ( player_experience < 110000 )
          goto LABEL_24;
        if ( v2 <= 5 )
        {
          *(_DWORD *)(v1 + 108) = 2;
          goto LABEL_25;
        }
        if ( v2 > 8 )
LABEL_24:
          *(_DWORD *)(v1 + 108) = 0;
        else
          *(_DWORD *)(v1 + 108) = 4;
      }
      else if ( v2 > 4 )
      {
        *(_DWORD *)(v1 + 108) = crt_rand() % 2 + 3;
      }
      else
      {
        *(_DWORD *)(v1 + 108) = 2;
      }
    }
    else
    {
      if ( v2 > 3 )
        *(_DWORD *)(v1 + 108) = 3;
      else
        *(_DWORD *)(v1 + 108) = 0;
      if ( v2 >= 9 )
        *(_DWORD *)(v1 + 108) = 2;
    }
  }
  else if ( v2 > 8 )
  {
    *(_DWORD *)(v1 + 108) = 3;
  }
  else
  {
    *(_DWORD *)(v1 + 108) = 2;
  }
LABEL_25:
  if ( (crt_rand() & 0x1F) == 2 )
    *(_DWORD *)(v1 + 108) = 3;
  v3 = crt_rand();
  *(_BYTE *)v1 = 1;
  *(_BYTE *)(v1 + 76) = 0;
  *(_DWORD *)(v1 + 16) = 1098907648;
  *(_DWORD *)(v1 + 28) = 0;
  *(_DWORD *)(v1 + 32) = 0;
  *(float *)(v1 + 52) = (float)(v3 % 20 + 44);
  *(float *)(v1 + 44) = (double)(crt_rand() % 314) * 0.0099999998;
  v4 = *(_DWORD *)(v1 + 108);
  *(float *)(v1 + 92) = (double)(player_experience / 4000) * 0.045000002 + 0.89999998;
  if ( v4 == 3 )
  {
    v5 = *(float *)(v1 + 92) * 1.3;
    v6 = *(_DWORD *)(v1 + 140);
    LOBYTE(v6) = v6 | 0x80;
    *(_DWORD *)(v1 + 140) = v6;
    *(float *)(v1 + 92) = v5;
  }
  v16 = crt_rand() & 0xF;
  v7 = *(_DWORD *)(v1 + 108);
  *(float *)(v1 + 36) = (double)v16 + (double)player_experience * 0.00125 + 52.0;
  if ( !v7 )
  {
    v8 = *(float *)(v1 + 92) * 0.60000002;
    *(float *)(v1 + 92) = v8;
    if ( v8 < 1.3 )
      *(_DWORD *)(v1 + 92) = 1067869798;
    *(float *)(v1 + 36) = *(float *)(v1 + 36) * 1.5;
  }
  if ( *(float *)(v1 + 92) > 3.5 )
    *(_DWORD *)(v1 + 92) = 1080033280;
  *(_DWORD *)(v1 + 96) = 0;
  *(_DWORD *)(v1 + 100) = 0;
  if ( player_experience >= 50000 )
  {
    v9 = v1 + 60;
    if ( player_experience >= 100000 )
    {
      *(float *)v9 = 1.0 - 1.0 / ((double)(player_experience / 1000) + 10.0);
      *(float *)(v1 + 64) = (double)(crt_rand() % 10) * 0.0099999998
                          + 0.89999998
                          - 1.0 / ((double)(player_experience / 10000) + 10.0);
      v10 = (double)(crt_rand() % 10) * 0.0099999998 + 1.0 - (double)(player_experience - 100000) * 0.0000030000001;
      *(float *)(v1 + 68) = v10;
      if ( v10 < 0.5 )
        *(_DWORD *)(v1 + 68) = 1056964608;
    }
    else
    {
      *(float *)v9 = 0.89999998 - 1.0 / ((double)(player_experience / 1000) + 10.0);
      *(float *)(v1 + 64) = (double)(crt_rand() % 10) * 0.0099999998
                          + 0.80000001
                          - 1.0 / ((double)(player_experience / 10000) + 10.0);
      *(float *)(v1 + 68) = (double)(crt_rand() % 10) * 0.0099999998
                          + (double)(player_experience - 50000) * 0.0000060000002
                          + 0.69999999;
    }
  }
  else
  {
    v9 = v1 + 60;
    *(float *)(v1 + 60) = 1.0 - 1.0 / ((double)(player_experience / 1000) + 10.0);
    *(float *)(v1 + 64) = (double)(crt_rand() % 10) * 0.0099999998
                        + 0.89999998
                        - 1.0 / ((double)(player_experience / 10000) + 10.0);
    *(float *)(v1 + 68) = (double)(crt_rand() % 10) * 0.0099999998 + 0.69999999;
  }
  v11 = *(float *)(v1 + 52) * 0.095238097;
  *(_DWORD *)(v1 + 72) = 1065353216;
  *(float *)(v1 + 88) = v11;
  if ( *(float *)(v1 + 100) == 0.0 )
    *(float *)(v1 + 100) = (double)(crt_rand() % 10 + 10)
                         + *(float *)(v1 + 92) * 5.0
                         + *(float *)(v1 + 88) * 0.80000001
                         + *(float *)(v1 + 36) * 0.40000001;
  if ( crt_rand() % 180 >= 2 )
  {
    if ( crt_rand() % 240 >= 2 )
    {
      if ( crt_rand() % 360 < 2 )
      {
        *(_DWORD *)v9 = 1053609165;
        *(_DWORD *)(v1 + 36) = 1123680256;
        *(_DWORD *)(v9 + 4) = 1053609165;
        *(_DWORD *)(v1 + 100) = 1140981760;
        *(_DWORD *)(v9 + 8) = 1063675494;
        *(_DWORD *)(v9 + 12) = 1065353216;
      }
    }
    else
    {
      *(_DWORD *)v9 = 1053609165;
      *(_DWORD *)(v1 + 36) = 1118437376;
      *(_DWORD *)(v9 + 4) = 1063675494;
      *(_DWORD *)(v1 + 100) = 1137836032;
      *(_DWORD *)(v9 + 8) = 1053609165;
      *(_DWORD *)(v9 + 12) = 1065353216;
    }
  }
  else
  {
    *(_DWORD *)v9 = 1063675494;
    *(_DWORD *)(v1 + 36) = 1115815936;
    *(_DWORD *)(v9 + 4) = 1053609165;
    *(_DWORD *)(v1 + 100) = 1134559232;
    *(_DWORD *)(v9 + 8) = 1053609165;
    *(_DWORD *)(v9 + 12) = 1065353216;
  }
  if ( crt_rand() % 1320 >= 4 )
  {
    if ( crt_rand() % 1620 < 4 )
    {
      v13 = *(float *)(v1 + 36) + 2230.0;
      *(_DWORD *)v9 = 1064346583;
      *(float *)(v1 + 36) = v13;
      *(_DWORD *)(v9 + 4) = 1062668861;
      *(_DWORD *)(v1 + 52) = 1118437376;
      *(_DWORD *)(v9 + 8) = 1049918177;
      *(_DWORD *)(v1 + 100) = 1147207680;
      *(_DWORD *)(v9 + 12) = 1065353216;
    }
  }
  else
  {
    v12 = *(float *)(v1 + 36) + 230.0;
    *(_DWORD *)v9 = 1062668861;
    *(float *)(v1 + 36) = v12;
    *(_DWORD *)(v9 + 4) = 1047904911;
    *(_DWORD *)(v1 + 52) = 1117782016;
    *(_DWORD *)(v9 + 8) = 1063507722;
    *(_DWORD *)(v1 + 100) = 1142292480;
    *(_DWORD *)(v9 + 12) = 1065353216;
  }
  v14 = *(float *)(v1 + 100) * 0.80000001;
  v15 = *(_DWORD *)(v1 + 36);
  *(_BYTE *)(v1 + 8) = 1;
  *(_DWORD *)(v1 + 40) = v15;
  *(float *)(v1 + 100) = v14;
  if ( *(float *)v9 >= 0.0 )
  {
    if ( *(float *)v9 > 1.0 )
      *(_DWORD *)v9 = 1065353216;
  }
  else
  {
    *(_DWORD *)v9 = 0;
  }
  if ( *(float *)(v9 + 4) >= 0.0 )
  {
    if ( *(float *)(v9 + 4) > 1.0 )
      *(_DWORD *)(v9 + 4) = 1065353216;
  }
  else
  {
    *(_DWORD *)(v9 + 4) = 0;
  }
  if ( *(float *)(v9 + 8) >= 0.0 )
  {
    if ( *(float *)(v9 + 8) > 1.0 )
      *(_DWORD *)(v9 + 8) = 1065353216;
  }
  else
  {
    *(_DWORD *)(v9 + 8) = 0;
  }
  if ( *(float *)(v9 + 12) >= 0.0 )
  {
    if ( *(float *)(v9 + 12) > 1.0 )
      *(_DWORD *)(v9 + 12) = 1065353216;
  }
  else
  {
    *(_DWORD *)(v9 + 12) = 0;
  }
}

// survival_update @ 0x00407CD0
// main survival mode update: timers, scripted spawns, and enemy wave spawning
char sub_407CD0()
{
  char result; // al
  int v1; // ecx
  double v2; // st4
  int v3; // esi
  int v4; // esi
  int v5; // esi
  int v6; // esi
  int v7; // esi
  int v8; // esi
  int v9; // esi
  int v10; // esi
  bool v11; // sf
  int v12; // esi
  unsigned int v13; // edi
  int v14; // ebp
  int v15; // eax
  float *v16; // ecx
  int v17; // ebp
  int v18; // ebp
  int v19; // eax
  int v20; // ebp
  int v21; // eax
  int v22; // esi
  int v23; // eax
  float *v24; // edx
  int v25; // esi
  int v26; // esi
  int v27; // eax
  int v28; // esi
  int v29; // [esp+Ch] [ebp-48h] BYREF
  float v30; // [esp+10h] [ebp-44h]
  float v31; // [esp+14h] [ebp-40h] BYREF
  float v32; // [esp+18h] [ebp-3Ch]
  float v33[2]; // [esp+1Ch] [ebp-38h] BYREF
  _DWORD v34[2]; // [esp+24h] [ebp-30h] BYREF
  float v35[2]; // [esp+2Ch] [ebp-28h] BYREF
  float v36[2]; // [esp+34h] [ebp-20h] BYREF
  float v37[2]; // [esp+3Ch] [ebp-18h] BYREF
  _DWORD v38[2]; // [esp+44h] [ebp-10h] BYREF
  float v39[2]; // [esp+4Ch] [ebp-8h] BYREF

  result = console_open_flag;
  if ( console_open_flag )
    return result;
  v1 = frame_dt_ms + quest_spawn_timeline;
  result = demo_mode_active;
  quest_spawn_timeline += frame_dt_ms;
  if ( demo_mode_active )
  {
    if ( v1 > dword_4712F0 )
    {
      render_pass_mode = 0;
      return demo_mode_start();
    }
    return result;
  }
  if ( config_player_count == 1 )
  {
    if ( !survival_reward_damage_seen
      && !survival_reward_fire_seen
      && survival_elapsed_ms > 64000
      && survival_reward_handout_enabled )
    {
      if ( player_weapon_id == 1 )
      {
        weapon_assign_player(0, 24);
        dword_486FB8 = 24;
      }
      survival_reward_handout_enabled = 0;
      survival_reward_damage_seen = 1;
      survival_reward_fire_seen = 1;
    }
    if ( survival_recent_death_count == 3 && !survival_reward_fire_seen )
    {
      v30 = flt_486FF4 + *(float *)&survival_recent_death_pos_y;
      v30 = flt_486FFC + v30;
      v30 = v30 * 0.33333334;
      v2 = *(float *)&player_pos_x - (survival_recent_death_pos_x + flt_486FF0 + flt_486FF8) * 0.33333334;
      if ( sqrt((*(float *)&player_pos_y - v30) * (*(float *)&player_pos_y - v30) + v2 * v2) < 16.0
        && *(float *)player_health < 15.0 )
      {
        weapon_assign_player(0, 25);
        dword_486FB8 = 25;
        survival_reward_fire_seen = 1;
        survival_reward_handout_enabled = 0;
      }
    }
  }
  if ( !survival_spawn_stage )
  {
    if ( player_level <= 4 )
      goto LABEL_59;
    survival_spawn_stage = 1;
    v29 = -1021050880;
    v30 = 512.0;
    creature_spawn_template(18, &v29, 1078530011);
    v29 = 1150582784;
    v30 = 512.0;
    creature_spawn_template(18, &v29, 1078530011);
  }
  if ( survival_spawn_stage == 1 )
  {
    if ( player_level <= 8 )
      goto LABEL_59;
    survival_spawn_stage = 2;
    v29 = 1149763584;
    v30 = 512.0;
    creature_spawn_template(44, &v29, 1078530011);
  }
  if ( survival_spawn_stage == 2 )
  {
    if ( player_level <= 10 )
      goto LABEL_59;
    v3 = 0;
    survival_spawn_stage = 3;
    v29 = 0;
    do
    {
      v31 = 1088.0;
      v32 = (double)v29 * 42.666668 + 256.0;
      creature_spawn_template(53, &v31, 1078530011);
      v29 = ++v3;
    }
    while ( v3 < 12 );
  }
  if ( survival_spawn_stage == 3 )
  {
    if ( player_level <= 12 )
      goto LABEL_59;
    v4 = 0;
    survival_spawn_stage = 4;
    v29 = 0;
    do
    {
      v31 = 1088.0;
      v32 = (double)v29 * 64.0 + 384.0;
      creature_spawn_template(43, &v31, 1078530011);
      v29 = ++v4;
    }
    while ( v4 < 4 );
  }
  if ( survival_spawn_stage == 4 )
  {
    if ( player_level <= 14 )
      goto LABEL_59;
    v5 = 0;
    survival_spawn_stage = 5;
    v29 = 0;
    do
    {
      v31 = 1088.0;
      v32 = (double)v29 * 64.0 + 384.0;
      creature_spawn_template(56, &v31, 1078530011);
      v29 = ++v5;
    }
    while ( v5 < 4 );
    v6 = 0;
    v29 = 0;
    do
    {
      v31 = -64.0;
      v32 = (double)v29 * 64.0 + 384.0;
      creature_spawn_template(56, &v31, 1078530011);
      v29 = ++v6;
    }
    while ( v6 < 4 );
  }
  if ( survival_spawn_stage == 5 )
  {
    if ( player_level <= 16 )
      goto LABEL_59;
    survival_spawn_stage = 6;
    v31 = 1088.0;
    v32 = 512.0;
    creature_spawn_template(58, &v31, 1078530011);
  }
  if ( survival_spawn_stage == 6 )
  {
    if ( player_level <= 18 )
      goto LABEL_59;
    survival_spawn_stage = 7;
    v31 = 640.0;
    v32 = 512.0;
    creature_spawn_template(1, &v31, 1078530011);
  }
  if ( survival_spawn_stage == 7 )
  {
    if ( player_level <= 20 )
      goto LABEL_59;
    survival_spawn_stage = 8;
    v31 = 384.0;
    v32 = 256.0;
    creature_spawn_template(1, &v31, 1078530011);
    v31 = 640.0;
    v32 = 768.0;
    creature_spawn_template(1, &v31, 1078530011);
  }
  if ( survival_spawn_stage != 8 )
    goto LABEL_53;
  if ( player_level > 25 )
  {
    v7 = 0;
    survival_spawn_stage = 9;
    v29 = 0;
    do
    {
      v31 = 1088.0;
      v32 = (double)v29 * 64.0 + 384.0;
      creature_spawn_template(60, &v31, 1078530011);
      v29 = ++v7;
    }
    while ( v7 < 4 );
    v8 = 0;
    v29 = 0;
    do
    {
      v31 = -64.0;
      v32 = (double)v29 * 64.0 + 384.0;
      creature_spawn_template(60, &v31, 1078530011);
      v29 = ++v8;
    }
    while ( v8 < 4 );
LABEL_53:
    if ( survival_spawn_stage == 9 && player_level > 31 )
    {
      survival_spawn_stage = 10;
      v31 = 1088.0;
      v32 = 512.0;
      creature_spawn_template(58, &v31, 1078530011);
      v31 = -64.0;
      v32 = 512.0;
      creature_spawn_template(58, &v31, 1078530011);
      v9 = 0;
      v29 = 0;
      do
      {
        v32 = -64.0;
        v31 = (double)v29 * 64.0 + 384.0;
        creature_spawn_template(60, &v31, 1078530011);
        v29 = ++v9;
      }
      while ( v9 < 4 );
      v10 = 0;
      v29 = 0;
      do
      {
        v32 = 1088.0;
        v31 = (double)v29 * 64.0 + 384.0;
        creature_spawn_template(60, &v31, 1078530011);
        v29 = ++v10;
      }
      while ( v10 < 4 );
    }
  }
LABEL_59:
  result = frame_dt_ms * config_player_count;
  v11 = survival_spawn_cooldown - frame_dt_ms * config_player_count < 0;
  render_overlay_player_index = 0;
  survival_spawn_cooldown -= frame_dt_ms * config_player_count;
  if ( v11 )
  {
    do
    {
      v12 = 500 - survival_elapsed_ms / 1800;
      if ( v12 < 0 )
      {
        v13 = (unsigned int)(1 - v12) >> 1;
        v12 += 2 * v13;
        do
        {
          switch ( crt_rand() & 3 )
          {
            case 0:
              v14 = terrain_texture_width;
              v15 = crt_rand();
              v32 = -40.0;
              v16 = &v31;
              v29 = v15 % v14;
              v31 = (float)(v15 % v14);
              goto LABEL_67;
            case 1:
              v17 = terrain_texture_width;
              v29 = crt_rand() % v17;
              v33[0] = (float)v29;
              v33[1] = (double)terrain_texture_height + 40.0;
              survival_spawn_creature(v33);
              break;
            case 2:
              v18 = terrain_texture_height;
              v19 = crt_rand();
              v34[0] = -1038090240;
              v29 = v19 % v18;
              *(float *)&v34[1] = (float)(v19 % v18);
              survival_spawn_creature(v34);
              break;
            case 3:
              v20 = terrain_texture_height;
              v21 = crt_rand();
              v16 = v35;
              v29 = v21 % v20;
              v35[0] = (double)terrain_texture_width + 40.0;
              v35[1] = (float)(v21 % v20);
LABEL_67:
              survival_spawn_creature(v16);
              break;
            default:
              break;
          }
          --v13;
        }
        while ( v13 );
      }
      if ( v12 < 1 )
        v12 = 1;
      survival_spawn_cooldown += v12;
      switch ( crt_rand() & 3 )
      {
        case 0:
          v22 = terrain_texture_width;
          v23 = crt_rand();
          v36[1] = -40.0;
          v29 = v23 % v22;
          v24 = v36;
          v36[0] = (float)(v23 % v22);
          goto LABEL_76;
        case 1:
          v25 = terrain_texture_width;
          v29 = crt_rand() % v25;
          v37[0] = (float)v29;
          v37[1] = (double)terrain_texture_height + 40.0;
          survival_spawn_creature(v37);
          break;
        case 2:
          v26 = terrain_texture_height;
          v27 = crt_rand();
          v38[0] = -1038090240;
          v29 = v27 % v26;
          *(float *)&v38[1] = (float)(v27 % v26);
          survival_spawn_creature(v38);
          break;
        case 3:
          v28 = terrain_texture_height;
          v29 = crt_rand() % v28;
          v24 = v39;
          v39[0] = (double)terrain_texture_width + 40.0;
          v39[1] = (float)v29;
LABEL_76:
          survival_spawn_creature(v24);
          break;
        default:
          break;
      }
      result = survival_spawn_cooldown;
    }
    while ( survival_spawn_cooldown < 0 );
  }
  return result;
}

// tutorial_prompt_dialog @ 0x00408530
// renders tutorial prompt text + Repeat/Play/Skip buttons and handles selections
char __cdecl sub_408530(char *Str, int a2, char a3)
{
  int v3; // ebp
  int v4; // esi
  int v5; // edi
  char result; // al
  double v7; // st7
  float v8; // [esp+30h] [ebp-48h]
  float v9; // [esp+4Ch] [ebp-2Ch]
  float v10; // [esp+50h] [ebp-28h]
  float v11; // [esp+54h] [ebp-24h]
  float v12; // [esp+58h] [ebp-20h] BYREF
  float v13; // [esp+5Ch] [ebp-1Ch]
  int v14; // [esp+60h] [ebp-18h]
  float v15; // [esp+64h] [ebp-14h]
  int v16; // [esp+68h] [ebp-10h] BYREF
  int v17; // [esp+6Ch] [ebp-Ch]
  float v18; // [esp+70h] [ebp-8h]
  float v19; // [esp+74h] [ebp-4h]

  v3 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 332))(grim_interface_ptr, Str);
  v4 = 1;
  if ( strchr(Str, 10) )
    v4 = 2;
  if ( a3 )
    v4 = 4;
  v5 = (__int64)((double)(*(_DWORD *)config_screen_width / 2) - (double)v3 * 0.5 - 20.0);
  v19 = *(float *)&a2 * 0.80000001;
  v11 = (float)v5;
  v12 = v11;
  v16 = 0;
  v17 = 0;
  v18 = 0.0;
  v9 = (float)(16 * v4 + 6);
  v13 = 64.0;
  v10 = (float)(v3 + 40);
  (*(void (__thiscall **)(int, float *, _DWORD, _DWORD, int *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    &v12,
    LODWORD(v10),
    LODWORD(v9),
    &v16);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    a2);
  v13 = 64.0;
  v12 = v11;
  (*(void (__thiscall **)(int, float *, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 212))(
    grim_interface_ptr,
    &v12,
    LODWORD(v10),
    LODWORD(v9));
  v12 = 1.0;
  v14 = 1065353216;
  v16 = 1065353216;
  v13 = 1.0;
  v15 = *(float *)&a2 * 0.89999998;
  v18 = 1.0;
  v19 = v15;
  v17 = 1065353216;
  v8 = (float)(v5 + 20);
  (*(void (__cdecl **)(int, _DWORD, int, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v8),
    1116209152,
    Str);
  if ( (byte_480148 & 1) == 0 )
  {
    byte_480256 = 1;
    byte_480148 |= 1u;
    byte_480265 = 0;
    byte_480264 = 0;
    dword_480260 = 1065353216;
    dword_48025C = 0;
    ui_button_table_b = 0;
    byte_480254 = 0;
    byte_480255 = 0;
    dword_480258 = 0;
    crt_atexit(nullsub_14);
  }
  ui_button_table_b = (int)aRepeatTutorial;
  if ( (byte_480148 & 2) == 0 )
  {
    byte_4807D6 = 1;
    byte_480148 |= 2u;
    byte_4807E5 = 0;
    byte_4807E4 = 0;
    dword_4807E0 = 1065353216;
    dword_4807DC = 0;
    ui_button_table_c = 0;
    byte_4807D4 = 0;
    byte_4807D5 = 0;
    dword_4807D8 = 0;
    crt_atexit(nullsub_13);
  }
  ui_button_table_c = (int)aPlayAGame;
  if ( a3 )
  {
    dword_4807E0 = a2;
    v12 = (float)(v5 + 32);
    dword_480260 = a2;
    v13 = 90.0;
    ui_button_update(&v12, &ui_button_table_c);
    v13 = 90.0;
    v12 = (float)(v5 + 192);
    ui_button_update(&v12, &ui_button_table_b);
    result = byte_4807D5;
    if ( byte_4807D5 )
    {
      byte_487292 = 0;
      game_state_pending = 1;
      render_pass_mode = 0;
      ui_transition_direction = 0;
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
      result = console_input_poll();
      tutorial_stage_transition_timer = -1000;
    }
    if ( byte_480255 )
    {
      player_level = 1;
      memset(&player_perk_counts, 0, 0x200u);
      tutorial_stage_transition_timer = -1000;
      perk_pending_count = 0;
      tutorial_stage_timer = 2000;
      return 0;
    }
  }
  else
  {
    v7 = (double)(tutorial_stage_timer - 1000) * 0.001;
    *(float *)&dword_4807E0 = v7;
    if ( v7 <= 1.0 )
    {
      if ( *(float *)&dword_4807E0 < 0.0 )
        dword_4807E0 = 0;
    }
    else
    {
      dword_4807E0 = 1065353216;
    }
    ui_button_table_c = (int)aSkipTutorial;
    v12 = 10.0;
    v13 = (float)(config_screen_height - 50);
    ui_button_update(&v12, &ui_button_table_c);
    result = byte_4807D5;
    if ( byte_4807D5 )
    {
      byte_487292 = 0;
      game_state_pending = 1;
      render_pass_mode = 0;
      ui_transition_direction = 0;
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
      result = console_input_poll();
      tutorial_stage_transition_timer = -1000;
    }
  }
  return result;
}

// nullsub_13 @ 0x00408970
void __cdecl nullsub_13()
{
  ;
}

// nullsub_14 @ 0x00408980
void __cdecl nullsub_14()
{
  ;
}

// tutorial_timeline_update @ 0x00408990
// drives tutorial stage timing, messages, and scripted spawns
char sub_408990()
{
  int v0; // eax
  int v1; // eax
  int v2; // esi
  double v3; // st7
  int v4; // edx
  int v5; // eax
  int *v6; // esi
  int v7; // ecx
  int *v8; // esi
  int v9; // ecx
  int v10; // ecx
  int v12; // [esp+10h] [ebp-70h]
  char v13[4]; // [esp+24h] [ebp-5Ch] BYREF
  int v14; // [esp+28h] [ebp-58h]
  _DWORD v15[2]; // [esp+2Ch] [ebp-54h] BYREF
  int v16; // [esp+34h] [ebp-4Ch] BYREF
  int v17; // [esp+38h] [ebp-48h]
  char *v18[7]; // [esp+3Ch] [ebp-44h]
  char *Str[10]; // [esp+58h] [ebp-28h]

  LOBYTE(v0) = console_open_flag;
  if ( console_open_flag )
    return v0;
  tutorial_stage_timer += frame_dt_ms;
  v18[0] = aThisIsTheSpeed;
  v18[1] = aThisIsAWeaponP;
  v18[2] = aThisPowerupDou;
  v18[3] = aThisIsTheNukeP;
  v18[4] = aReflexBoostPow;
  v18[5] = (char *)&tutorial_empty_string;
  v18[6] = (char *)&tutorial_empty_string;
  Str[0] = aInThisTutorial;
  Str[1] = aFirstLearnToMo;
  Str[2] = aNowPickUpTheBo;
  Str[3] = aNowLearnToShoo;
  Str[4] = aNowMoveTheMous;
  Str[5] = aItWillHelpYouT;
  Str[6] = aNowLetSLearnAb;
  Str[7] = aPerksCanGiveYo;
  Str[8] = aGreatNowYouAre;
  Str[9] = (char *)&tutorial_empty_string;
  quest_spawn_timeline += frame_dt_ms;
  player_health[0] = 1120403456;
  if ( tutorial_stage_index != 6 )
    player_experience = 0;
  v1 = tutorial_stage_transition_timer;
  if ( tutorial_stage_transition_timer >= -1 )
  {
    if ( tutorial_stage_transition_timer >= 0 )
    {
      v1 = frame_dt_ms + tutorial_stage_transition_timer;
      tutorial_stage_transition_timer += frame_dt_ms;
    }
  }
  else
  {
    v1 = frame_dt_ms + tutorial_stage_transition_timer;
    tutorial_stage_transition_timer = v1;
    if ( v1 >= -1 )
    {
      if ( ++tutorial_stage_index == 9 )
        tutorial_stage_index = 0;
      tutorial_stage_transition_timer = 0;
      goto LABEL_13;
    }
  }
  if ( v1 > 1000 )
    tutorial_stage_transition_timer = -1;
LABEL_13:
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v2 = tutorial_stage_transition_timer;
  if ( tutorial_stage_transition_timer < 0 )
  {
    if ( tutorial_stage_transition_timer >= -1 )
    {
      *(float *)v13 = 1.0;
      goto LABEL_16;
    }
    *(_DWORD *)v13 = -tutorial_stage_transition_timer;
    v3 = (double)-tutorial_stage_transition_timer;
  }
  else
  {
    v3 = (double)tutorial_stage_transition_timer;
  }
  *(float *)v13 = v3 * 0.001;
  if ( *(float *)v13 < 1.0 )
  {
    v4 = tutorial_stage_index;
    if ( tutorial_stage_index != 5 )
      goto LABEL_26;
    goto LABEL_24;
  }
LABEL_16:
  v4 = tutorial_stage_index;
  if ( tutorial_stage_index != 5 )
    goto LABEL_26;
  if ( tutorial_stage_timer > 5000 && tutorial_stage_transition_timer >= -1 )
    *(float *)v13 = 1.0 - (double)(tutorial_stage_timer - 5000) * 0.001;
LABEL_24:
  if ( tutorial_stage_timer > 6000 )
  {
    *(float *)v13 = 0.0;
LABEL_33:
    tutorial_prompt_dialog(Str[v4], *(int *)v13, v4 == 8);
    v2 = tutorial_stage_transition_timer;
    v4 = tutorial_stage_index;
    goto LABEL_34;
  }
LABEL_26:
  if ( *(float *)v13 <= 1.0 )
  {
    if ( *(float *)v13 < 0.0 )
      *(float *)v13 = 0.0;
  }
  else
  {
    *(float *)v13 = 1.0;
  }
  if ( v4 >= 0 && (v4 != 6 || perk_pending_count > 0) )
    goto LABEL_33;
LABEL_34:
  if ( byte_4808B0 )
  {
    v5 = frame_dt_ms + tutorial_hint_alpha + 2 * frame_dt_ms;
  }
  else
  {
    if ( tutorial_hint_bonus_ptr
      && !*(_BYTE *)tutorial_hint_bonus_ptr
      && *(float *)(tutorial_hint_bonus_ptr + 36) <= 0.0
      && (*(_DWORD *)(tutorial_hint_bonus_ptr + 140) & 0x400) != 0 )
    {
      dword_4712F4 = *(__int16 *)(tutorial_hint_bonus_ptr + 120);
      dword_4712F8 = *(__int16 *)(tutorial_hint_bonus_ptr + 122);
      byte_4808B0 = 1;
      *(float *)v13 = 128.0;
      v14 = 1124073472;
      creature_spawn_template(36, v13, 1078530011);
      *(float *)v13 = 152.0;
      v14 = 1126170624;
      creature_spawn_template(38, v13, 1078530011);
      v2 = tutorial_stage_transition_timer;
      v4 = tutorial_stage_index;
      ++tutorial_hint_index;
    }
    v5 = -3 * frame_dt_ms + tutorial_hint_alpha;
  }
  tutorial_hint_alpha = v5;
  if ( v5 <= 1000 )
  {
    if ( v5 < 0 )
      tutorial_hint_alpha = 0;
  }
  else
  {
    tutorial_hint_alpha = 1000;
  }
  LOBYTE(v0) = tutorial_hint_index;
  if ( tutorial_hint_index >= 0 )
  {
    v0 = (int)v18[tutorial_hint_index];
    if ( *(_BYTE *)v0 != 0xA7 )
    {
      *(float *)&v12 = (double)tutorial_hint_alpha * 0.001;
      LOBYTE(v0) = tutorial_prompt_dialog((char *)v0, v12, 0);
      v2 = tutorial_stage_transition_timer;
      v4 = tutorial_stage_index;
    }
  }
  if ( v4 )
  {
    switch ( v4 )
    {
      case 1:
        v6 = &player_move_key_backward;
        while ( 1 )
        {
          LOBYTE(v0) = (*(int (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
                         grim_interface_ptr,
                         *(v6 - 1));
          if ( (_BYTE)v0
            || (LOBYTE(v0) = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
                               grim_interface_ptr,
                               *v6),
                (_BYTE)v0)
            || (LOBYTE(v0) = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
                               grim_interface_ptr,
                               v6[1]),
                (_BYTE)v0)
            || (LOBYTE(v0) = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
                               grim_interface_ptr,
                               v6[2]),
                (_BYTE)v0) )
          {
            if ( tutorial_stage_transition_timer == -1 )
              break;
          }
          v6 += 216;
          if ( (int)v6 >= (int)dword_4912A0 )
            return v0;
        }
        tutorial_stage_transition_timer = -1000;
        sfx_play(sfx_ui_levelup, 1.0);
        *(float *)v13 = 260.0;
        v14 = 1132593152;
        bonus_pool = 1;
        bonus_time_left = 1120403456;
        bonus_time_max = 1120403456;
        bonus_state = 0;
        bonus_amount = 500;
        bonus_pos_x = 1132593152;
        bonus_pos_y = 1132593152;
        effect_spawn_burst(&bonus_pos_x, 12);
        *(float *)v13 = 600.0;
        v14 = 1137180672;
        dword_482964 = 1;
        dword_48296C = 1120403456;
        dword_482970 = bonus_time_left;
        byte_482968 = 0;
        dword_48297C = 1000;
        dword_482974 = 1142292480;
        dword_482978 = 1137180672;
        effect_spawn_burst(&dword_482974, 12);
        *(float *)v13 = 300.0;
        v14 = 1137180672;
        dword_482980 = 1;
        dword_482988 = 1120403456;
        dword_48298C = bonus_time_left;
        byte_482984 = 0;
        dword_482998 = 500;
        dword_482990 = 1133903872;
        dword_482994 = 1137180672;
        LOBYTE(v0) = effect_spawn_burst(&dword_482990, 12);
        break;
      case 2:
        v7 = 0;
        v0 = (int)&bonus_pool;
        do
        {
          if ( *(_DWORD *)v0 )
            break;
          v0 += 28;
          ++v7;
        }
        while ( v0 < (int)&quest_spawn_count );
        if ( v7 == 16 && v2 == -1 )
        {
          tutorial_stage_transition_timer = -1000;
          LOBYTE(v0) = sfx_play(sfx_ui_levelup, 1.0);
        }
        break;
      case 3:
        v8 = &player_fire_key;
        do
        {
          LOBYTE(v0) = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(grim_interface_ptr, *v8);
          if ( (_BYTE)v0 && tutorial_stage_transition_timer == -1 )
          {
            tutorial_stage_transition_timer = -1000;
            sfx_play(sfx_ui_levelup, 1.0);
            *(float *)v13 = -164.0;
            v14 = 1137573888;
            creature_spawn_template(36, v13, 1078530011);
            v15[0] = -1019740160;
            v15[1] = 1140850688;
            creature_spawn_template(38, v15, 1078530011);
            v16 = -1021706240;
            v17 = 1142489088;
            LOBYTE(v0) = creature_spawn_template(36, &v16, 1078530011);
          }
          v8 += 216;
        }
        while ( (int)v8 < (int)&dword_4912AC );
        break;
      case 4:
        LOBYTE(v0) = creatures_none_active();
        if ( (_BYTE)v0 && tutorial_stage_transition_timer == -1 )
        {
          tutorial_stage_timer = 1000;
          tutorial_stage_transition_timer = -1000;
          sfx_play(sfx_ui_levelup, 1.0);
          tutorial_repeat_spawn_count = 0;
          v16 = 1150582784;
          v17 = 1137573888;
          creature_spawn_template(36, &v16, 1078530011);
          v16 = 1150746624;
          v17 = 1140850688;
          creature_spawn_template(38, &v16, 1078530011);
          v16 = 1150500864;
          v17 = 1142489088;
          LOBYTE(v0) = creature_spawn_template(36, &v16, 1078530011);
        }
        break;
      case 5:
        v9 = 0;
        v0 = (int)&bonus_pool;
        do
        {
          if ( *(_DWORD *)v0 )
            break;
          v0 += 28;
          ++v9;
        }
        while ( v0 < (int)&quest_spawn_count );
        if ( v9 == 16 )
        {
          LOBYTE(v0) = creatures_none_active();
          if ( (_BYTE)v0 )
          {
            v0 = ++tutorial_repeat_spawn_count;
            if ( tutorial_repeat_spawn_count <= 7 )
            {
              byte_4808B0 = 0;
              if ( (v0 & 1) != 0 )
              {
                if ( v0 < 6 )
                {
                  v16 = -1040187392;
                  v17 = 1149501440;
                  tutorial_hint_bonus_ptr = creature_spawn_template(39, &v16, 1078530011);
                }
                v16 = -1021050880;
                v17 = 1137573888;
                creature_spawn_template(36, &v16, 1078530011);
                v16 = -1019740160;
                v17 = 1140850688;
                creature_spawn_template(38, &v16, 1078530011);
                v16 = -1021706240;
                v17 = 1142489088;
                creature_spawn_template(36, &v16, 1078530011);
              }
              else
              {
                if ( v0 < 6 )
                {
                  v16 = 1149501440;
                  v17 = 1149501440;
                  tutorial_hint_bonus_ptr = creature_spawn_template(39, &v16, 1078530011);
                }
                v16 = 1150582784;
                v17 = 1150156800;
                creature_spawn_template(36, &v16, 1078530011);
                v16 = 1150746624;
                v17 = 1140850688;
                creature_spawn_template(38, &v16, 1078530011);
                v16 = 1150500864;
                v17 = 1142489088;
                creature_spawn_template(36, &v16, 1078530011);
              }
              v0 = tutorial_repeat_spawn_count;
              if ( tutorial_repeat_spawn_count == 4 )
              {
                v16 = 1140850688;
                v17 = 1149501440;
                creature_spawn_template(64, &v16, 1078530011);
                v0 = tutorial_repeat_spawn_count;
              }
              if ( v0 < 6 )
              {
                switch ( --v0 )
                {
                  case 0:
                    *(_WORD *)(tutorial_hint_bonus_ptr + 120) = 13;
                    *(_WORD *)(tutorial_hint_bonus_ptr + 122) = -1;
                    break;
                  case 1:
                    LOBYTE(v0) = tutorial_hint_bonus_ptr;
                    *(_WORD *)(tutorial_hint_bonus_ptr + 120) = 3;
                    *(_WORD *)(tutorial_hint_bonus_ptr + 122) = 5;
                    break;
                  case 2:
                    *(_WORD *)(tutorial_hint_bonus_ptr + 120) = 6;
                    LOBYTE(v0) = tutorial_hint_bonus_ptr;
                    *(_WORD *)(tutorial_hint_bonus_ptr + 122) = -1;
                    break;
                  case 3:
                    *(_WORD *)(tutorial_hint_bonus_ptr + 120) = 5;
                    *(_WORD *)(tutorial_hint_bonus_ptr + 122) = -1;
                    break;
                  case 4:
                    LOBYTE(v0) = tutorial_hint_bonus_ptr;
                    *(_WORD *)(tutorial_hint_bonus_ptr + 120) = 9;
                    *(_WORD *)(tutorial_hint_bonus_ptr + 122) = -1;
                    break;
                  default:
                    return v0;
                }
              }
            }
            else if ( tutorial_stage_transition_timer == -1 )
            {
              tutorial_stage_transition_timer = -1000;
              LOBYTE(v0) = sfx_play(sfx_ui_levelup, 1.0);
              player_experience = 3000;
            }
          }
        }
        break;
      case 6:
        if ( perk_pending_count <= 0 && v2 == -1 )
        {
          tutorial_stage_transition_timer = -1000;
          v16 = -1021050880;
          v17 = 1137573888;
          creature_spawn_template(36, &v16, 1078530011);
          v16 = -1019740160;
          v17 = 1140850688;
          creature_spawn_template(38, &v16, 1078530011);
          v16 = -1021706240;
          v17 = 1142489088;
          creature_spawn_template(36, &v16, 1078530011);
          v16 = -1040187392;
          v17 = -1040187392;
          creature_spawn_template(40, &v16, 1078530011);
          v16 = 1150582784;
          v17 = 1137573888;
          creature_spawn_template(36, &v16, 1078530011);
          v16 = 1150746624;
          v17 = 1140850688;
          creature_spawn_template(38, &v16, 1078530011);
          v16 = 1150500864;
          v17 = 1142489088;
          LOBYTE(v0) = creature_spawn_template(36, &v16, 1078530011);
        }
        break;
      case 7:
        v10 = 0;
        v0 = (int)&bonus_pool;
        do
        {
          if ( *(_DWORD *)v0 )
            break;
          v0 += 28;
          ++v10;
        }
        while ( v0 < (int)&quest_spawn_count );
        if ( v10 == 16 )
        {
          LOBYTE(v0) = creatures_none_active();
          if ( (_BYTE)v0 )
          {
            if ( tutorial_stage_transition_timer == -1 )
              tutorial_stage_transition_timer = -1000;
          }
        }
        break;
    }
  }
  else if ( tutorial_stage_timer > 6000 && v2 == -1 )
  {
    tutorial_repeat_spawn_count = 0;
    tutorial_hint_index = -1;
    byte_4808B0 = 0;
    tutorial_stage_transition_timer = -1000;
  }
  return v0;
}

// camera_update @ 0x00409500
// updates camera offsets and screen shake
void sub_409500()
{
  double v0; // st7
  int v1; // esi
  int v2; // esi
  double v3; // st7
  int v4; // esi
  int v5; // esi
  double v6; // st7
  double v7; // st7
  char v8; // fps^1
  char v9; // ah
  bool v10; // c0
  bool v11; // c3
  double v12; // st7
  double v13; // st7

  if ( camera_shake_timer <= 0.0 )
  {
    camera_shake_offset_x = 0.0;
    camera_shake_offset_y = 0.0;
  }
  else
  {
    v0 = camera_shake_timer - frame_dt * 3.0;
    camera_shake_timer = v0;
    if ( v0 < 0.0 )
    {
      if ( --camera_shake_pulses <= 0 )
      {
        camera_shake_timer = 0.0;
      }
      else
      {
        camera_shake_timer = 0.1;
        if ( time_scale_active )
          camera_shake_timer = 0.059999999;
        v1 = crt_rand() % (60 * camera_shake_pulses / 20);
        v2 = crt_rand() % 10 + v1;
        if ( (crt_rand() & 1) != 0 )
          v3 = (double)v2;
        else
          v3 = (double)-v2;
        camera_shake_offset_x = v3;
        v4 = crt_rand() % (60 * camera_shake_pulses / 20);
        v5 = crt_rand() % 10 + v4;
        if ( (crt_rand() & 1) != 0 )
          v6 = (double)v5;
        else
          v6 = (double)-v5;
        camera_shake_offset_y = v6;
      }
    }
  }
  if ( config_player_count == 1 )
  {
    *(float *)&camera_offset_x = (double)(*(_DWORD *)config_screen_width / 2)
                               - *(float *)&player_pos_x[216 * render_overlay_player_index];
    v7 = (double)(config_screen_height / 2) - *(float *)&player_pos_y[216 * render_overlay_player_index];
    goto LABEL_27;
  }
  v9 = v8;
  v10 = player2_health < 0.0;
  v11 = player2_health == 0.0;
  if ( (v9 & 0x41) != 0 )
  {
    if ( !v10 && !v11 )
    {
      *(float *)&camera_offset_x = (double)(*(_DWORD *)config_screen_width / 2) - *(float *)&player2_pos_x;
      v7 = (double)(config_screen_height / 2) - *(float *)&player2_pos_y;
      goto LABEL_27;
    }
LABEL_21:
    if ( *(float *)player_health > 0.0 )
    {
      *(float *)&camera_offset_x = (double)(*(_DWORD *)config_screen_width / 2) - *(float *)player_pos_x;
      v7 = (double)(config_screen_height / 2) - *(float *)player_pos_y;
      goto LABEL_27;
    }
    if ( player2_health <= 0.0 )
      goto LABEL_26;
    goto LABEL_24;
  }
  if ( v10 || v11 )
    goto LABEL_21;
LABEL_24:
  if ( *(float *)player_health > 0.0 )
  {
    *(float *)&camera_offset_x = (double)(*(_DWORD *)config_screen_width / 2)
                               - (*(float *)player_pos_x
                                - (*(float *)player_pos_x - *(float *)&player2_pos_x) * 0.5);
    v7 = (double)(config_screen_height / 2)
       - (*(float *)player_pos_y
        - (*(float *)player_pos_y - *(float *)&player2_pos_y) * 0.5);
    goto LABEL_27;
  }
LABEL_26:
  v7 = *(float *)&camera_offset_y;
LABEL_27:
  *(float *)&camera_offset_x = *(float *)&camera_offset_x + camera_shake_offset_x;
  *(float *)&camera_offset_y = v7 + camera_shake_offset_y;
  if ( *(float *)&camera_offset_x > -1.0 )
    camera_offset_x = -1082130432;
  if ( *(float *)&camera_offset_y > -1.0 )
    camera_offset_y = -1082130432;
  v12 = (double)(*(_DWORD *)config_screen_width - terrain_texture_width);
  if ( *(float *)&camera_offset_x < v12 )
    *(float *)&camera_offset_x = v12;
  v13 = (double)(config_screen_height - terrain_texture_height);
  if ( *(float *)&camera_offset_y < v13 )
    *(float *)&camera_offset_y = v13;
}

// bonus_apply @ 0x00409890
// applies a picked bonus to the player and spawns related effects
int __cdecl sub_409890(int a1, float *a2)
{
  float v2; // eax
  float *v3; // ecx
  double v4; // st7
  int v5; // ecx
  int *v6; // eax
  int v7; // eax
  double v8; // st7
  int *v9; // esi
  int v10; // edi
  int v11; // edi
  int v12; // eax
  int v13; // ebp
  int v14; // esi
  int v15; // eax
  int v16; // eax
  int v17; // ebp
  int v18; // eax
  float *v19; // esi
  int v20; // ebp
  char *v21; // edi
  double v22; // st6
  double v23; // st5
  long double v24; // st7
  int result; // eax
  int v26; // esi
  int v27; // eax
  float v28; // [esp+0h] [ebp-2Ch]
  float v29; // [esp+0h] [ebp-2Ch]
  float v30; // [esp+0h] [ebp-2Ch]
  float v31; // [esp+0h] [ebp-2Ch]
  float v32; // [esp+0h] [ebp-2Ch]
  float v33; // [esp+0h] [ebp-2Ch]
  float v34; // [esp+8h] [ebp-24h]
  float v35; // [esp+8h] [ebp-24h]
  int v36; // [esp+1Ch] [ebp-10h] BYREF
  int v37; // [esp+20h] [ebp-Ch]
  int v38; // [esp+24h] [ebp-8h]
  int v39; // [esp+28h] [ebp-4h]
  int v40; // [esp+30h] [ebp+4h]
  float v41; // [esp+30h] [ebp+4h]
  float v42; // [esp+30h] [ebp+4h]

  sfx_play(sfx_ui_bonus, 1.0);
  *(float *)&v36 = 1.0;
  if ( perk_count_get(perk_id_bonus_economist) )
    *(float *)&v36 = 1.5;
  v2 = *a2;
  if ( *(_DWORD *)a2 == 3 )
  {
    weapon_assign_player(a1, *((_DWORD *)a2 + 6));
  }
  else
  {
    switch ( LODWORD(v2) )
    {
      case 0xC:
        v3 = (float *)&player_health[216 * a1];
        if ( *v3 < 100.0 )
        {
          v4 = *v3 + 10.0;
          *v3 = v4;
          if ( v4 > 100.0 )
            *v3 = 100.0;
        }
        break;
      case 9:
        if ( bonus_reflex_boost_timer <= 0.0 )
          sub_41A810(dword_485484, dword_48548C, &bonus_reflex_boost_timer, 0);
        v5 = config_player_count;
        bonus_reflex_boost_timer = (double)*((int *)a2 + 6) * *(float *)&v36 + bonus_reflex_boost_timer;
        if ( config_player_count > 0 )
        {
          v6 = player_ammo;
          do
          {
            *v6 = *(v6 - 2);
            v6[1] = 0;
            v6 += 216;
            --v5;
          }
          while ( v5 );
        }
        v37 = 1058642330;
        *(float *)&v36 = 0.60000002;
        effect_template_color_g = 1058642330;
        v38 = 1065353216;
        v39 = 1065353216;
        effect_template_color_r = 1058642330;
        effect_template_flags = 25;
        effect_template_color_b = 1065353216;
        effect_template_color_a = 1065353216;
        effect_template_lifetime = 1048576000;
        effect_template_age = 0;
        effect_template_half_width = 1107296256;
        effect_template_half_height = 1107296256;
        effect_template_rotation = 0;
        effect_template_vel_x = 0;
        effect_template_vel_y = 0;
        effect_template_scale_step = 1112014848;
        effect_spawn(1, a2 + 4);
        effect_template_rotation = 0;
        effect_template_vel_x = 0;
        effect_template_vel_y = 0;
        break;
      case 4:
        if ( *(float *)&bonus_weapon_power_up_timer <= 0.0 )
          sub_41A810(dword_485420, dword_485428, &bonus_weapon_power_up_timer, 0);
        v7 = 216 * a1;
        v8 = (double)*((int *)a2 + 6) * *(float *)&v36 + *(float *)&bonus_weapon_power_up_timer;
        player_weapon_reset_latch[v7] = 0;
        player_shot_cooldown[v7] = 0;
        player_reload_timer[v7] = 0;
        player_ammo[v7] = player_clip_size[216 * a1];
        *(float *)&bonus_weapon_power_up_timer = v8;
        break;
      case 0xD:
        if ( *(float *)player_speed_bonus_timer <= 0.0 && player2_speed_bonus_timer <= 0.0 )
          sub_41A810(dword_4854D4, dword_4854DC, player_speed_bonus_timer, &player2_speed_bonus_timer);
        *(float *)&player_speed_bonus_timer[216 * a1] = (double)*((int *)a2 + 6) * *(float *)&v36
                                                      + *(float *)&player_speed_bonus_timer[216 * a1];
        break;
      case 0xB:
        if ( bonus_freeze_timer <= 0.0 )
          sub_41A810(dword_4854AC, dword_4854B4, &bonus_freeze_timer, 0);
        v9 = &creature_pos_x;
        bonus_freeze_timer = (double)*((int *)a2 + 6) * *(float *)&v36 + bonus_freeze_timer;
        do
        {
          if ( *((_BYTE *)v9 - 20) && *((float *)v9 + 4) <= 0.0 )
          {
            v10 = 8;
            do
            {
              v34 = (double)(crt_rand() % 612) * 0.0099999998;
              effect_spawn_freeze_shard((int)v9, v34);
              --v10;
            }
            while ( v10 );
            v35 = (double)(crt_rand() % 612) * 0.0099999998;
            effect_spawn_freeze_shatter((int)v9, v35);
            *((_BYTE *)v9 - 20) = 0;
          }
          v9 += 38;
        }
        while ( (int)v9 < (int)&dword_4AA34C );
        *(float *)&v36 = 0.30000001;
        v37 = 1056964608;
        v38 = 1061997773;
        v39 = 1065353216;
        effect_template_color_r = 1050253722;
        effect_template_flags = 25;
        effect_template_color_g = 1056964608;
        effect_template_color_b = 1061997773;
        effect_template_color_a = 1065353216;
        effect_template_lifetime = 1048576000;
        effect_template_age = 0;
        effect_template_half_width = 1107296256;
        effect_template_half_height = 1107296256;
        effect_template_rotation = 0;
        effect_template_vel_x = 0;
        effect_template_vel_y = 0;
        effect_template_scale_step = 1112014848;
        effect_spawn(1, a2 + 4);
        sfx_play_panned(sfx_shockwave, (int)(a2 + 4), 1.0);
        effect_template_rotation = 0;
        effect_template_vel_x = 0;
        effect_template_vel_y = 0;
        break;
      case 0xA:
        if ( *(float *)player_shield_timer <= 0.0 && player2_shield_timer <= 0.0 )
          sub_41A810(dword_485498, dword_4854A0, player_shield_timer, &player2_shield_timer);
        *(float *)&player_shield_timer[216 * a1] = (double)*((int *)a2 + 6) * *(float *)&v36
                                                 + *(float *)&player_shield_timer[216 * a1];
        break;
      case 7:
        bonus_spawn_guard = 1;
        if ( *(float *)(dword_48086C + 12) == 0.0 )
          v11 = -100;
        else
          v11 = -1 - a1;
        shock_chain_links_left = 32;
        v12 = creature_find_nearest((int)(a2 + 4), -1, 0.0);
        v28 = atan2(creature_pos_y[38 * v12] - a2[5], *((float *)&creature_pos_x + 38 * v12) - a2[4])
            - 1.5707964
            - 3.1415927;
        shock_chain_projectile_id = projectile_spawn((int)(a2 + 4), v28, 21, v11);
        bonus_spawn_guard = 0;
        sfx_play_panned(sfx_shock_hit_01, (int)(a2 + 4), 1.0);
        break;
      case 8:
        bonus_spawn_guard = 1;
        if ( *(float *)(dword_48086C + 12) == 0.0 )
          v13 = -100;
        else
          v13 = -1 - a1;
        v14 = 0;
        v40 = 0;
        do
        {
          v29 = (double)v40 * 0.39269909;
          projectile_spawn((int)(a2 + 4), v29, 9, v13);
          v40 = ++v14;
        }
        while ( v14 < 16 );
        bonus_spawn_guard = 0;
        sfx_play_panned(sfx_explosion_medium, (int)(a2 + 4), 1.0);
        break;
      case 0xE:
        if ( *(float *)player_fire_bullets_timer <= 0.0 && player2_fire_bullets_timer <= 0.0 )
          sub_41A810(dword_4854E8, dword_4854F0, player_fire_bullets_timer, &player2_fire_bullets_timer);
        v15 = 216 * a1;
        *(float *)(v15 * 4 + 4787148) = *(float *)&v36 * 5.0 + *(float *)&player_fire_bullets_timer[216 * a1];
        player_weapon_reset_latch[v15] = 0;
        player_shot_cooldown[v15] = 0;
        player_reload_timer[v15] = 0;
        player_ammo[v15] = player_clip_size[216 * a1];
        break;
      case 2:
        if ( bonus_energizer_timer <= 0.0 )
          sub_41A810(dword_4853F8, dword_485400, &bonus_energizer_timer, 0);
        bonus_energizer_timer = *(float *)&v36 * 8.0 + bonus_energizer_timer;
        break;
      case 6:
        if ( bonus_double_xp_timer <= 0.0 )
          sub_41A810(dword_485448, dword_485450, &bonus_double_xp_timer, 0);
        bonus_double_xp_timer = *(float *)&v36 * 6.0 + bonus_double_xp_timer;
        break;
      case 5:
        v16 = (crt_rand() & 3) + 4;
        if ( v16 > 0 )
        {
          v17 = v16;
          do
          {
            v30 = (double)(crt_rand() % 628) * 0.0099999998;
            v18 = projectile_spawn((int)(a2 + 4), v30, 1, -100);
            if ( v18 != -1 )
              projectile_speed_scale[16 * v18] = ((double)(crt_rand() % 50) * 0.0099999998 + 0.5)
                                               * projectile_speed_scale[16 * v18];
            --v17;
          }
          while ( v17 );
        }
        v19 = a2 + 4;
        v31 = (double)(crt_rand() % 628) * 0.0099999998;
        projectile_spawn((int)(a2 + 4), v31, 6, -100);
        v32 = (double)(crt_rand() % 628) * 0.0099999998;
        projectile_spawn((int)(a2 + 4), v32, 6, -100);
        effect_spawn_explosion_burst((int)(a2 + 4), 1.0);
        camera_shake_pulses = 20;
        camera_shake_timer = 0.2;
        bonus_spawn_guard = 1;
        v20 = 0;
        v21 = creature_pool;
        do
        {
          if ( *v21 )
          {
            v41 = *((float *)v21 + 5) - *v19;
            if ( COERCE_FLOAT(LODWORD(v41) & 0x7FFFFFFF) <= 256.0 )
            {
              v42 = *((float *)v21 + 6) - a2[5];
              if ( COERCE_FLOAT(LODWORD(v42) & 0x7FFFFFFF) <= 256.0 )
              {
                v22 = *((float *)v21 + 6) - a2[5];
                v23 = *((float *)v21 + 5) - *v19;
                v24 = 256.0 - sqrt(v23 * v23 + v22 * v22);
                if ( v24 > 0.0 )
                {
                  *(float *)&v36 = 0.0;
                  v37 = 0;
                  v33 = v24 * 5.0;
                  creature_apply_damage(v20, v33, 3, (int)&v36);
                }
              }
            }
          }
          v21 += 152;
          ++v20;
        }
        while ( (int)v21 < (int)byte_4AA338 );
        bonus_spawn_guard = 0;
        sfx_play_panned(sfx_explosion_large, (int)(a2 + 4), 1.0);
        sfx_play_panned(sfx_shockwave, (int)(a2 + 4), 1.0);
        break;
      case 1:
        player_experience += *((_DWORD *)a2 + 6);
        break;
    }
  }
  *(float *)&v36 = 0.40000001;
  v37 = 1056964608;
  result = 1056964608;
  v38 = 1065353216;
  v39 = 1056964608;
  effect_template_color_r = 1053609165;
  effect_template_flags = 29;
  effect_template_color_g = 1056964608;
  effect_template_color_b = 1065353216;
  effect_template_color_a = 1056964608;
  effect_template_lifetime = 1053609165;
  effect_template_half_width = 1107296256;
  effect_template_half_height = 1107296256;
  if ( *(_DWORD *)a2 != 5 )
  {
    v26 = 12;
    do
    {
      *(float *)&effect_template_rotation = (double)(crt_rand() & 0x7F) * 0.049087387;
      *(float *)&effect_template_vel_x = (float)(crt_rand() % 128 - 64);
      v27 = crt_rand() % 128;
      effect_template_scale_step = 1036831949;
      *(float *)&effect_template_vel_y = (float)(v27 - 64);
      result = effect_spawn(0, a2 + 4);
      --v26;
    }
    while ( v26 );
  }
  return result;
}

// bonus_update @ 0x0040A320
// updates bonus lifetimes and handles player pickups
void sub_40A320()
{
  int v0; // edx
  float *v1; // edi
  float *v2; // esi
  char v3; // cl
  double v4; // st7
  int v5; // ecx
  float *v6; // eax
  double v7; // st6
  double v8; // st5

  if ( render_pass_mode )
  {
    v0 = config_player_count;
    v1 = (float *)&bonus_time_left;
    do
    {
      v2 = v1 - 2;
      if ( *((_DWORD *)v1 - 2) )
      {
        v3 = *((_BYTE *)v1 - 4);
        if ( v3 )
          v4 = *v1 - frame_dt * 3.0;
        else
          v4 = *v1 - frame_dt;
        *v1 = v4;
        if ( !v3 && config_game_mode == 8 )
          *v1 = 5.0;
        if ( *v1 < 0.0 )
          *v2 = 0.0;
        if ( !v3 )
        {
          v5 = 0;
          for ( render_overlay_player_index = 0; v5 < v0; render_overlay_player_index = v5 )
          {
            v6 = (float *)&player_pos_x[216 * v5];
            v7 = v1[3] - v6[1];
            v8 = v1[2] - *v6;
            if ( sqrt(v8 * v8 + v7 * v7) < 26.0 )
            {
              bonus_apply(v5, v1 - 2);
              v0 = config_player_count;
              v5 = render_overlay_player_index;
              *((_BYTE *)v2 + 4) = 1;
              *v1 = 0.5;
            }
            ++v5;
          }
        }
      }
      v1 += 7;
    }
    while ( (int)v1 < (int)&highscore_table );
    render_overlay_player_index = 0;
    if ( bonus_freeze_timer <= 0.0 )
      bonus_freeze_timer = 0.0;
    else
      bonus_freeze_timer = bonus_freeze_timer - frame_dt;
    if ( bonus_double_xp_timer <= 0.0 )
      bonus_double_xp_timer = 0.0;
    else
      bonus_double_xp_timer = bonus_double_xp_timer - frame_dt;
    if ( flt_4AAF2C >= 0.0 )
      flt_4AAF2C = (flt_4AAF2C + 1.0) * frame_dt * 1.8 + flt_4AAF2C;
  }
}

// ui_draw_clock_gauge_at @ 0x0040A4C0
// draws the clock gauge at a position when progress > 0
void __cdecl sub_40A4C0(float *a1, int a2, float a3)
{
  if ( a3 > 0.0 )
    ui_draw_clock_gauge((__int64)*a1, (__int64)a1[1], (__int64)(a3 * 60000.0), 1065353216);
}

// ui_render_aim_indicators @ 0x0040A510
// renders aim reticles, reload gauges, and player HUD indicators
void sub_40A510()
{
  int v0; // esi
  int v1; // edx
  double v2; // st6
  double v3; // st4
  long double v4; // st7
  float *v5; // eax
  double v6; // st7
  double v7; // st7
  double v8; // st7
  int v9; // ecx
  float *v10; // eax
  int v11; // eax
  int v12; // edx
  long double v13; // st7
  double v14; // st6
  int v15; // edx
  double v16; // st7
  int v17; // [esp+BCh] [ebp-50h]
  int v18; // [esp+C0h] [ebp-4Ch]
  int v19; // [esp+C4h] [ebp-48h]
  float v20; // [esp+C4h] [ebp-48h]
  float v21; // [esp+D4h] [ebp-38h]
  float v22; // [esp+D8h] [ebp-34h]
  int v23; // [esp+DCh] [ebp-30h]
  int v24; // [esp+DCh] [ebp-30h]
  int v25; // [esp+E0h] [ebp-2Ch]
  int v26; // [esp+E0h] [ebp-2Ch]
  int v27; // [esp+E4h] [ebp-28h] BYREF
  int v28; // [esp+E8h] [ebp-24h]
  float v29; // [esp+ECh] [ebp-20h]
  float v30; // [esp+F4h] [ebp-18h]
  float v31; // [esp+100h] [ebp-Ch]
  float v32; // [esp+104h] [ebp-8h]

  if ( !demo_mode_active )
  {
    if ( (byte_480340 & 1) == 0 )
    {
      byte_480340 |= 1u;
      crt_atexit(nullsub_16);
    }
    if ( (byte_480340 & 2) == 0 )
    {
      byte_480340 |= 2u;
      crt_atexit(nullsub_15);
    }
    (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 19, 5);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      v17,
      v18,
      v19);
    v0 = config_player_count;
    v1 = 0;
    for ( render_overlay_player_index = 0; v1 < v0; render_overlay_player_index = v1 )
    {
      if ( *(float *)&player_health[216 * v1] > 0.0 )
      {
        v2 = *(float *)&player_aim_y[216 * v1] - *(float *)&player_pos_y[216 * v1];
        v3 = *(float *)&player_aim_x[216 * v1] - *(float *)&player_pos_x[216 * v1];
        v4 = sqrt(v2 * v2 + v3 * v3) * *(float *)&player_spread_heat[216 * v1] * 0.5;
        v21 = v4;
        if ( v4 < 6.0 )
          v21 = 6.0;
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
          grim_interface_ptr,
          1056964608,
          1056964608,
          1056964608,
          1056964608);
        (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          0,
          0,
          1036831949,
          1050253722);
        v5 = (float *)&player_aim_x[216 * render_overlay_player_index];
        *(float *)&v23 = *(float *)&camera_offset_x + *v5;
        v6 = *(float *)&camera_offset_y + v5[1];
        aim_screen_x = v23;
        *(float *)&v25 = v6;
        aim_screen_y = v25;
        (*(void (__thiscall **)(int, int, int, float))(*(_DWORD *)grim_interface_ptr + 216))(
          grim_interface_ptr,
          v23,
          v25,
          COERCE_FLOAT(LODWORD(v21)));
        (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
          grim_interface_ptr,
          bullet_trail_texture,
          0);
        (*(void (__thiscall **)(int, int, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
          grim_interface_ptr,
          1056964608,
          0,
          1056964608,
          1065353216);
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          1057803469);
        (*(void (__thiscall **)(int, int, int, float))(*(_DWORD *)grim_interface_ptr + 220))(
          grim_interface_ptr,
          aim_screen_x,
          aim_screen_y,
          COERCE_FLOAT(LODWORD(v21)));
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1060320051,
          1036831949,
          1061997773);
        *(float *)&v27 = *(float *)&camera_offset_x + *(float *)&player_aim_x[216 * render_overlay_player_index];
        v7 = *(float *)&camera_offset_y + *(float *)&player_aim_y[216 * render_overlay_player_index];
        aim_screen_x = v27;
        *(float *)&v28 = v7;
        v8 = *(float *)&player_reload_timer[216 * render_overlay_player_index]
           / *(float *)&player_reload_timer_max[216 * render_overlay_player_index];
        aim_screen_y = v28;
        v20 = v8;
        ui_draw_clock_gauge_at((float *)&aim_screen_x, 1111490560, v20);
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          1060320051);
        v1 = render_overlay_player_index;
        v0 = config_player_count;
      }
      ++v1;
    }
    v9 = 0;
    for ( render_overlay_player_index = 0; v9 < v0; render_overlay_player_index = v9 )
    {
      if ( *(float *)&player_health[216 * v9] > 0.0 && *((_BYTE *)&config_hud_indicator_toggle + v9) )
      {
        (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 252))(
          grim_interface_ptr,
          player_heading[216 * v9]);
        (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
          grim_interface_ptr,
          dword_48F7D8,
          0);
        (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
          grim_interface_ptr,
          0,
          0,
          1065353216,
          1065353216);
        if ( config_player_count == 2 )
        {
          if ( render_overlay_player_index )
            (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
              grim_interface_ptr,
              1065353216,
              1063675494,
              1061997773,
              1058642330);
          else
            (*(void (__stdcall **)(int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
              1061997773,
              1063675494,
              1065353216,
              1058642330);
        }
        else
        {
          (*(void (__stdcall **)(int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
            1065353216,
            1065353216,
            1065353216,
            1050253722);
        }
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
        if ( config_player_mode_flags[render_overlay_player_index] == 4 )
        {
          v10 = (float *)((char *)&player_move_target_x + 864 * render_overlay_player_index);
          v22 = *(float *)&camera_offset_y + v10[1];
          *(float *)&v27 = *(float *)&camera_offset_x + *v10 - 16.0;
          v11 = v27;
          aim_screen_x = v27;
          *(float *)&v28 = v22 - 16.0;
          v12 = v28;
        }
        else
        {
          v13 = *(float *)&player_heading[216 * render_overlay_player_index] - 1.5707964;
          v29 = cos(v13);
          v30 = v29 * 60.0;
          v14 = *(float *)&camera_offset_x + *(float *)&player_pos_x[216 * render_overlay_player_index];
          v31 = *(float *)&camera_offset_y + *(float *)&player_pos_y[216 * render_overlay_player_index];
          v32 = v14 + v30;
          *(float *)&v24 = v32 - 16.0;
          v11 = v24;
          aim_screen_x = v24;
          *(float *)&v26 = sin(v13) * 60.0 + v31 - 16.0;
          v12 = v26;
        }
        aim_screen_y = v12;
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
          grim_interface_ptr,
          v11,
          v12,
          1107296256,
          1107296256);
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
        v9 = render_overlay_player_index;
        v0 = config_player_count;
      }
      ++v9;
    }
    v15 = 0;
    for ( render_overlay_player_index = 0; v15 < v0; render_overlay_player_index = v15 )
    {
      if ( *(float *)&player_health[216 * v15] > 0.0 )
      {
        v16 = *(float *)&camera_offset_y + *(float *)&player_aim_y[216 * v15];
        *(float *)&v27 = *(float *)&camera_offset_x + *(float *)&player_aim_x[216 * v15];
        *(float *)&v28 = v16;
        ui_render_aim_enhancement(&v27);
        v15 = render_overlay_player_index;
        v0 = config_player_count;
      }
      ++v15;
    }
    render_overlay_player_index = 0;
  }
}

// nullsub_15 @ 0x0040AA90
void __cdecl nullsub_15()
{
  ;
}

// nullsub_16 @ 0x0040AAA0
void __cdecl nullsub_16()
{
  ;
}

// gameplay_update_and_render @ 0x0040AAB0
// main gameplay frame loop for state 9 (timers, updates, renders, UI)
void __usercall sub_40AAB0(std::codecvt_base *a1@<ecx>, int a2@<esi>)
{
  double v2; // st7
  std::codecvt_base *v3; // ecx
  int *v4; // eax
  int v5; // eax
  int v6; // eax
  std::codecvt_base *v7; // ecx
  std::codecvt_base *v8; // ecx
  std::codecvt_base *v9; // ecx
  int v10; // eax
  std::codecvt_base *v11; // ecx
  unsigned int v12; // ecx
  int v13; // eax
  float v14; // [esp+1Ch] [ebp-20h]
  int v15; // [esp+20h] [ebp-1Ch]
  int v16; // [esp+34h] [ebp-8h] BYREF
  int v17; // [esp+38h] [ebp-4h] BYREF
  float retaddr; // [esp+3Ch] [ebp+0h]

  if ( time_scale_active )
  {
    time_scale_factor = 1050253722;
    if ( bonus_reflex_boost_timer < 1.0 )
      *(float *)&time_scale_factor = (1.0 - bonus_reflex_boost_timer) * 0.69999999 + 0.30000001;
    v2 = *(float *)&time_scale_factor * frame_dt;
    frame_dt = v2;
    frame_dt_ms = (__int64)(v2 * 1000.0);
  }
  if ( demo_mode_active )
  {
LABEL_19:
    if ( game_paused_flag )
      goto LABEL_22;
    goto LABEL_20;
  }
  if ( !game_is_full_version(a1) && config_game_mode != 8 )
  {
    *(_DWORD *)&game_sequence_id = game_sequence_get();
    if ( *(int *)&game_sequence_id > 2400000 )
    {
LABEL_12:
      frame_dt_ms = 0;
      frame_dt = 0.0;
      goto LABEL_19;
    }
    if ( dword_48084C <= 0 )
    {
      if ( config_game_mode != 3 )
        goto LABEL_17;
    }
    else
    {
      if ( config_game_mode != 3 )
        goto LABEL_12;
      v16 = dword_48084C / 1000;
      if ( (double)(dword_48084C / 1000) * 0.016666668 > 5.0 )
        goto LABEL_12;
    }
    if ( game_state_id == 9 && (*(int *)quest_stage_major > 1 || quest_stage_minor > 10) )
      goto LABEL_12;
  }
LABEL_17:
  if ( game_paused_flag )
    goto LABEL_12;
LABEL_20:
  if ( !console_open_flag )
    perks_update_effects();
LABEL_22:
  effects_update(a2);
  if ( !demo_mode_active && !game_is_full_version(v3) && config_game_mode != 8 )
  {
    *(_DWORD *)&game_sequence_id = game_sequence_get();
    if ( *(int *)&game_sequence_id > 2400000 )
      goto LABEL_37;
    v3 = (std::codecvt_base *)dword_48084C;
    if ( dword_48084C > 0 )
    {
      if ( config_game_mode != 3 )
        goto LABEL_37;
      v16 = dword_48084C / 1000;
      if ( (double)(dword_48084C / 1000) * 0.016666668 > 5.0 )
        goto LABEL_37;
      goto LABEL_31;
    }
    if ( config_game_mode == 3 )
    {
LABEL_31:
      if ( game_state_id == 9 && (*(int *)quest_stage_major > 1 || quest_stage_minor > 10) )
        goto LABEL_37;
    }
  }
  if ( !game_paused_flag && game_state_id == 9 )
  {
    creature_update_all();
    projectile_update();
  }
LABEL_37:
  if ( !demo_mode_active && !game_is_full_version(v3) && config_game_mode != 8 )
  {
    *(_DWORD *)&game_sequence_id = game_sequence_get();
    if ( *(int *)&game_sequence_id > 2400000 )
      goto LABEL_53;
    if ( dword_48084C > 0 )
    {
      if ( config_game_mode != 3 )
        goto LABEL_53;
      v16 = dword_48084C / 1000;
      if ( (double)(dword_48084C / 1000) * 0.016666668 > 5.0 )
        goto LABEL_53;
      goto LABEL_46;
    }
    if ( config_game_mode == 3 )
    {
LABEL_46:
      if ( game_state_id == 9 && (*(int *)quest_stage_major > 1 || quest_stage_minor > 10) )
        goto LABEL_53;
    }
  }
  if ( !game_paused_flag && game_state_id == 9 )
  {
    for ( render_overlay_player_index = 0; render_overlay_player_index < config_player_count; ++render_overlay_player_index )
      player_update();
  }
LABEL_53:
  render_overlay_player_index = 0;
  if ( config_game_mode == 1 )
    survival_update();
  if ( config_game_mode == 2 )
    rush_mode_update();
  if ( config_game_mode == 3 )
    quest_mode_update();
  highscore_score_xp = player_experience;
  if ( !console_open_flag && !game_paused_flag )
  {
    if ( *(float *)&bonus_weapon_power_up_timer > 0.0 )
      *(float *)&bonus_weapon_power_up_timer = *(float *)&bonus_weapon_power_up_timer - frame_dt;
    if ( bonus_energizer_timer > 0.0 )
      bonus_energizer_timer = bonus_energizer_timer - frame_dt;
    if ( bonus_reflex_boost_timer <= 0.0 )
    {
      time_scale_active = 0;
    }
    else
    {
      time_scale_active = 1;
      bonus_reflex_boost_timer = bonus_reflex_boost_timer - frame_dt;
    }
    survival_elapsed_ms += frame_dt_ms;
    dword_48708C[player_weapon_id] += frame_dt_ms;
  }
  camera_update();
  gameplay_render_world();
  if ( config_game_mode == 8 )
    tutorial_timeline_update();
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216,
    v15);
  if ( demo_mode_active )
  {
    v4 = player_health;
    do
    {
      *v4 = 1120403456;
      v4 += 216;
    }
    while ( (int)v4 < (int)dword_490F94 );
  }
  else if ( *(float *)player_health <= 0.0
         && player_death_timer < 0.0
         && (config_player_count == 1 || player2_health <= 0.0 && player2_death_timer < 0.0) )
  {
    render_pass_mode = 0;
    ui_transition_direction = 0;
    game_state_pending = config_game_mode != 3 ? 7 : 12;
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
    console_input_poll();
    sfx_mute_all(music_track_extra_0);
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_play_exclusive(music_track_shortie_monk_id);
  }
  if ( config_game_mode != 2
    && player_experience > (int)(1000 - (__int64)(pow((double)player_level, 1.799999952316284) * -1000.0)) )
  {
    ++perk_pending_count;
    if ( ++config_perk_prompt_counter > 50 )
    {
      config_perk_prompt_counter = 0;
      config_full_version = 0;
    }
    sfx_play(sfx_ui_levelup, 1.0);
    ++player_level;
  }
  if ( !console_open_flag && !game_paused_flag )
  {
    if ( perk_prompt_hover_active )
      v5 = 3 * frame_dt_ms;
    else
      v5 = -frame_dt_ms;
    v6 = perk_prompt_pulse + 2 * v5;
    perk_prompt_pulse = v6;
    if ( v6 >= 0 )
    {
      if ( v6 > 1000 )
        perk_prompt_pulse = 1000;
    }
    else
    {
      perk_prompt_pulse = 0;
    }
  }
  if ( !demo_mode_active
    && !game_paused_flag
    && !mouse_button_down
    && config_game_mode != 2
    && perk_pending_count > 0
    && (*(float *)player_health > 0.0 || config_player_count == 2 && player2_health > 0.0) )
  {
    *(float *)&v17 = ui_mouse_x - perk_prompt_origin_x;
    retaddr = ui_mouse_y - perk_prompt_origin_y;
    if ( game_state_pending != 6 )
    {
      if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
             grim_interface_ptr,
             config_key_pick_perk)
        || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 57)
        || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 78) )
      {
        perk_prompt_pulse = 1000;
        if ( perk_choices_dirty )
        {
LABEL_116:
          perks_generate_choices();
          perk_choices_dirty = 0;
        }
LABEL_117:
        game_state_set(6);
        goto LABEL_118;
      }
      if ( *(float *)&v17 <= (double)perk_prompt_bounds_min_x
        || retaddr <= (double)perk_prompt_bounds_min_y
        || *(float *)&v17 >= (double)perk_prompt_bounds_max_x
        || retaddr >= (double)perk_prompt_bounds_max_y )
      {
        perk_prompt_hover_active = 0;
      }
      else
      {
        perk_prompt_hover_active = 1;
        if ( (unsigned __int8)input_primary_just_pressed() )
        {
          if ( perk_choices_dirty )
            goto LABEL_116;
          goto LABEL_117;
        }
      }
    }
  }
LABEL_118:
  mouse_button_down = (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 88))(
                        grim_interface_ptr,
                        0) != 0;
  bonus_update();
  LODWORD(frame_dt) = v16;
  frame_dt_ms = (__int64)(*(float *)&v16 * 1000.0);
  if ( demo_mode_active )
    goto LABEL_131;
  perk_prompt_update_and_render();
  if ( demo_mode_active || game_is_full_version(v7) || config_game_mode == 8 )
    goto LABEL_131;
  *(_DWORD *)&game_sequence_id = game_sequence_get();
  if ( *(int *)&game_sequence_id > 2400000 )
    goto LABEL_132;
  if ( dword_48084C <= 0 )
  {
    if ( config_game_mode != 3 )
      goto LABEL_131;
    goto LABEL_128;
  }
  if ( config_game_mode == 3 )
  {
    v17 = dword_48084C / 1000;
    if ( (double)(dword_48084C / 1000) * 0.016666668 <= 5.0 )
    {
LABEL_128:
      if ( game_state_id == 9 && (*(int *)quest_stage_major > 1 || quest_stage_minor > 10) )
        goto LABEL_132;
LABEL_131:
      ui_render_aim_indicators();
    }
  }
LABEL_132:
  hud_update_and_render();
  ui_elements_update_and_render();
  if ( game_is_full_version(v8) )
    goto LABEL_151;
  if ( demo_mode_active || game_is_full_version(v9) || config_game_mode == 8 )
    goto LABEL_146;
  *(_DWORD *)&game_sequence_id = game_sequence_get();
  if ( *(int *)&game_sequence_id > 2400000 )
  {
LABEL_145:
    dword_480898 += frame_dt_ms;
    *(float *)&v17 = (double)*(int *)config_screen_width * 0.5 - 256.0;
    retaddr = (double)config_screen_height * 0.5 - 128.0;
    demo_trial_overlay_render((float *)&v17, 1.0);
    v10 = dword_480898;
    byte_480850 = 1;
    goto LABEL_147;
  }
  if ( dword_48084C <= 0 )
  {
    if ( config_game_mode != 3 )
      goto LABEL_146;
  }
  else
  {
    if ( config_game_mode != 3 )
      goto LABEL_145;
    v17 = dword_48084C / 1000;
    if ( (double)(dword_48084C / 1000) * 0.016666668 > 5.0 )
      goto LABEL_145;
  }
  if ( game_state_id == 9 && (*(int *)quest_stage_major > 1 || quest_stage_minor > 10) )
    goto LABEL_145;
LABEL_146:
  v10 = dword_480898 - frame_dt_ms;
  byte_480850 = 0;
  dword_480898 -= frame_dt_ms;
LABEL_147:
  if ( v10 >= 0 )
  {
    if ( v10 > 1000 )
      dword_480898 = 1000;
  }
  else
  {
    dword_480898 = 0;
  }
LABEL_151:
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 59) )
    game_paused_flag = game_paused_flag == 0;
  if ( !game_is_full_version(v11) && config_game_mode != 8 )
  {
    *(_DWORD *)&game_sequence_id = game_sequence_get();
    if ( *(int *)&game_sequence_id > 2400000 )
    {
LABEL_164:
      game_paused_flag = 0;
LABEL_165:
      v12 = -frame_dt_ms;
      v13 = dword_487284 - 4 * frame_dt_ms;
      goto LABEL_166;
    }
    v12 = dword_48084C;
    if ( dword_48084C <= 0 )
    {
      if ( config_game_mode != 3 )
        goto LABEL_168;
    }
    else
    {
      if ( config_game_mode != 3 )
        goto LABEL_164;
      v12 = (unsigned int)((unsigned __int64)(274877907LL * dword_48084C) >> 32) >> 31;
      v16 = dword_48084C / 1000;
      if ( (double)(dword_48084C / 1000) * 0.016666668 > 5.0 )
        goto LABEL_164;
    }
    if ( game_state_id == 9 && (*(int *)quest_stage_major > 1 || quest_stage_minor > 10) )
      goto LABEL_164;
  }
LABEL_168:
  if ( !game_paused_flag )
    goto LABEL_165;
  v13 = dword_487284 + 2 * frame_dt_ms;
LABEL_166:
  dword_487284 = v13;
  if ( v13 < 0 )
  {
    dword_487284 = 0;
    goto LABEL_174;
  }
  if ( v13 <= 1000 )
  {
    if ( v13 <= 0 )
      goto LABEL_174;
  }
  else
  {
    dword_487284 = 1000;
  }
  *(float *)&v16 = (double)*(int *)config_screen_width * 0.5 - 256.0;
  *(float *)&v17 = (double)config_screen_height * 0.5 - 128.0;
  v14 = (double)dword_487284 * 0.001;
  ui_render_keybind_help((float *)&v16, v14);
LABEL_174:
  if ( !game_is_full_version((std::codecvt_base *)v12) && config_game_mode != 8 )
  {
    *(_DWORD *)&game_sequence_id = game_sequence_get();
    if ( *(int *)&game_sequence_id > 2400000 )
      goto LABEL_185;
    if ( dword_48084C <= 0 )
    {
      if ( config_game_mode != 3 )
        return;
    }
    else
    {
      if ( config_game_mode != 3 )
        goto LABEL_185;
      v16 = dword_48084C / 1000;
      if ( (double)(dword_48084C / 1000) * 0.016666668 > 5.0 )
        goto LABEL_185;
    }
    if ( game_state_id == 9 && (*(int *)quest_stage_major > 1 || quest_stage_minor > 10) )
    {
LABEL_185:
      if ( !demo_mode_active )
        ui_cursor_render();
    }
  }
}

// FUN_0040b5d0 @ 0x0040B5D0
// [binja] int32_t* sub_40b5d0()
int *sub_40B5D0()
{
  int *v0; // eax
  int *v1; // eax
  char *v2; // eax
  int *result; // eax

  v0 = &bonus_pool;
  do
  {
    *v0 = 0;
    v0 += 7;
  }
  while ( (int)v0 < (int)&quest_spawn_count );
  v1 = creature_health;
  do
  {
    *((_BYTE *)v1 - 36) = 0;
    *v1 = -1082130432;
    v1 += 38;
  }
  while ( (int)v1 < (int)&dword_4AA35C );
  v2 = &projectile_pool;
  do
  {
    *v2 = 0;
    v2 += 64;
  }
  while ( (int)v2 < (int)&particle_pool );
  result = player_health;
  do
  {
    *((_BYTE *)result - 36) = 0;
    *result = -1082130432;
    result += 216;
  }
  while ( (int)result < (int)dword_490F94 );
  return result;
}

// sub_40B630 @ 0x0040B630
int sub_40B630()
{
  int result; // eax

  if ( plugin_interface_ptr )
  {
    if ( game_state_id == 22 && byte_471304 )
    {
      byte_471304 = 0;
      byte_4824D1 = 0;
      sfx_mute_all(music_track_extra_0);
      FUN_0040b5d0();
      (**(void (__thiscall ***)(int))plugin_interface_ptr)(plugin_interface_ptr);
      *(_BYTE *)(plugin_interface_ptr + 9) = 0;
    }
    else if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)plugin_interface_ptr + 8))(
                plugin_interface_ptr,
                frame_dt_ms) )
    {
      byte_4824D1 = 1;
    }
    else
    {
      byte_4824D1 = 0;
      (*(void (__thiscall **)(int))(*(_DWORD *)plugin_interface_ptr + 4))(plugin_interface_ptr);
      sfx_mute_all(music_track_extra_0);
      plugin_interface_ptr = 0;
      FreeLibrary(hLibModule);
      hLibModule = 0;
      byte_471304 = 1;
      game_state_pending = 20;
      ui_transition_direction = 0;
    }
    ui_elements_update_and_render();
    if ( !ui_transition_direction && game_state_id == 22 )
      return ui_cursor_render();
    result = plugin_interface_ptr;
    if ( plugin_interface_ptr )
    {
      if ( byte_4824D1 && *(_BYTE *)(plugin_interface_ptr + 8) )
        return ui_cursor_render();
    }
  }
  else
  {
    game_state_pending = 20;
    ui_transition_direction = 0;
    result = ui_elements_update_and_render();
    byte_471304 = 1;
  }
  return result;
}

// demo_purchase_screen_update @ 0x0040B740
// demo upsell screen: feature list, purchase link, and exit handling
unsigned __int8 __thiscall sub_40B740(std::codecvt_base *this)
{
  unsigned __int8 result; // al
  int v2; // ecx
  long double v3; // st7
  int v4; // esi
  int v5; // eax
  int v6; // ebp
  float v7; // edi
  int v8; // esi
  const char *v9; // esi
  double v10; // st7
  double v11; // st6
  int v12; // edx
  int v13; // [esp+130h] [ebp-48h]
  int v14; // [esp+130h] [ebp-48h]
  float v15; // [esp+130h] [ebp-48h]
  int v16; // [esp+134h] [ebp-44h]
  float v17; // [esp+134h] [ebp-44h]
  float v18; // [esp+134h] [ebp-44h]
  int v19; // [esp+134h] [ebp-44h]
  int v20; // [esp+138h] [ebp-40h]
  float v21; // [esp+138h] [ebp-40h]
  int v22; // [esp+138h] [ebp-40h]
  int v23; // [esp+138h] [ebp-40h]
  int v24; // [esp+138h] [ebp-40h]
  float v25; // [esp+138h] [ebp-40h]
  float v26; // [esp+14Ch] [ebp-2Ch]
  float v27; // [esp+14Ch] [ebp-2Ch]
  float v28; // [esp+14Ch] [ebp-2Ch]
  float v29; // [esp+14Ch] [ebp-2Ch]
  float v30; // [esp+14Ch] [ebp-2Ch]
  float v31; // [esp+14Ch] [ebp-2Ch]
  float v32; // [esp+14Ch] [ebp-2Ch]
  float v33; // [esp+14Ch] [ebp-2Ch]
  float v34; // [esp+14Ch] [ebp-2Ch]
  float v35; // [esp+14Ch] [ebp-2Ch]
  float v36; // [esp+14Ch] [ebp-2Ch]
  float v37; // [esp+14Ch] [ebp-2Ch]
  float v38; // [esp+150h] [ebp-28h]
  float v39; // [esp+150h] [ebp-28h]
  const char *v40; // [esp+154h] [ebp-24h]
  float v41; // [esp+154h] [ebp-24h]
  float v42; // [esp+158h] [ebp-20h]
  float v43; // [esp+15Ch] [ebp-1Ch]
  float v44; // [esp+15Ch] [ebp-1Ch]
  float v45; // [esp+15Ch] [ebp-1Ch]
  float v46; // [esp+15Ch] [ebp-1Ch]
  float v47; // [esp+160h] [ebp-18h] BYREF
  float v48; // [esp+164h] [ebp-14h] BYREF
  int v49; // [esp+168h] [ebp-10h] BYREF
  int v50; // [esp+16Ch] [ebp-Ch]
  int v51; // [esp+170h] [ebp-8h]
  float v52; // [esp+174h] [ebp-4h]

  if ( ui_transition_direction && game_is_full_version(this) )
  {
    ui_transition_direction = 0;
    game_state_pending = 0;
    demo_mode_active = 1;
    config_load_presets(0);
    sfx_mute_all(music_track_intro_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_play_exclusive(music_track_crimson_theme_id);
    ui_elements_update_and_render();
    return ui_cursor_render();
  }
  if ( !byte_480890
    && ((unsigned __int8)input_primary_just_pressed()
     || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 1)
     || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 57)) )
  {
    v2 = 16000;
    byte_480890 = 1;
    dword_4712F0 = 16000;
  }
  else
  {
    v2 = dword_4712F0;
  }
  if ( (byte_480320 & 1) == 0 )
  {
    byte_4802B6 = 1;
    byte_480320 |= 1u;
    byte_4802C5 = 0;
    byte_4802C4 = 0;
    dword_4802C0 = 1065353216;
    dword_4802BC = 0;
    dword_4802B0 = 0;
    byte_4802B4 = 0;
    byte_4802B5 = 0;
    dword_4802B8 = 0;
    crt_atexit(nullsub_18);
    v2 = dword_4712F0;
  }
  dword_4802B0 = (int)aMaybeLater;
  if ( (byte_480320 & 2) == 0 )
  {
    byte_47F67E = 1;
    byte_480320 |= 2u;
    byte_47F68D = 0;
    byte_47F68C = 0;
    dword_47F688 = 1065353216;
    dword_47F684 = 0;
    dword_47F678 = 0;
    byte_47F67C = 0;
    byte_47F67D = 0;
    dword_47F680 = 0;
    crt_atexit(nullsub_17);
    v2 = dword_4712F0;
  }
  dword_47F678 = (int)aPurchase;
  v42 = 1.0;
  v26 = (double)quest_spawn_timeline * 0.016000001;
  if ( v26 < 20.0 )
    v42 = v26 * 0.050000001;
  if ( quest_spawn_timeline > v2 - 500 )
    v42 = (double)(v2 - quest_spawn_timeline) * 0.0020000001;
  (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    COERCE_FLOAT(LODWORD(v42)));
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1061997773,
    v13,
    v16,
    v20);
  v40 = szPassword;
  if ( !byte_480890 )
  {
    v12 = dword_4808BC;
    if ( !quest_spawn_timeline )
    {
      v12 = (dword_4808BC + 1) % 5;
      dword_4808BC = v12;
    }
    if ( v12 )
    {
      switch ( v12 )
      {
        case 1:
          v40 = aWantMoreWeapon;
          break;
        case 2:
          v40 = aWantMorePerks;
          break;
        case 3:
          v40 = aWantUnlimitedP;
          break;
        case 4:
          v40 = aWantToPostYour;
          break;
      }
    }
    else
    {
      v40 = aWantMoreLevels;
    }
LABEL_33:
    v9 = v40;
    v49 = 0;
    v50 = 0;
    v51 = 0;
    v10 = (double)strlen(v40) * 12.8;
    v47 = 60.0;
    v41 = (double)quest_spawn_timeline / (double)dword_4712F0 * v10;
    v52 = v42 * 0.5;
    v11 = v26 + 50.0;
    v46 = v11;
    v48 = v11 - 4.0;
    v15 = v10 + 12.0;
    (*(void (__thiscall **)(int, float *, _DWORD, int, int *))(*(_DWORD *)grim_interface_ptr + 208))(
      grim_interface_ptr,
      &v47,
      LODWORD(v15),
      1106247680,
      &v49);
    v52 = v42 * 0.80000001;
    v49 = 1056964608;
    v50 = 1036831949;
    v51 = 1036831949;
    v47 = 64.0;
    v48 = v26 + 72.0;
    (*(void (__thiscall **)(int, float *, _DWORD, int, int *))(*(_DWORD *)grim_interface_ptr + 208))(
      grim_interface_ptr,
      &v47,
      LODWORD(v41),
      1077936128,
      &v49);
    (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      COERCE_FLOAT(LODWORD(v42)));
    (*(void (__thiscall **)(int, int, _DWORD, const char *))(*(_DWORD *)grim_interface_ptr + 316))(
      grim_interface_ptr,
      1112014848,
      LODWORD(v46),
      v9);
LABEL_34:
    ui_elements_update_and_render();
    return ui_cursor_render();
  }
  ui_pulse_timer_ms += frame_dt_ms;
  v3 = sin((double)(ui_pulse_timer_ms % 1000) * 6.2831855);
  v38 = v3 * v3;
  (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 280))(
    grim_interface_ptr,
    0,
    0,
    0,
    0,
    1065353216);
  (*(void (__thiscall **)(int, int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 280))(
    grim_interface_ptr,
    1,
    0,
    0,
    1050253722,
    1065353216);
  v17 = v38 * 0.55000001;
  (*(void (__stdcall **)(int, _DWORD, int, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 280))(
    2,
    0,
    1053609165,
    LODWORD(v17),
    LODWORD(v38));
  (*(void (__thiscall **)(int, int, _DWORD, int, int, int))(*(_DWORD *)grim_interface_ptr + 280))(
    grim_interface_ptr,
    3,
    0,
    1053609165,
    1053609165,
    1065353216);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1056964608,
    1056964608);
  v4 = *(_DWORD *)grim_interface_ptr;
  v5 = (*(int (__thiscall **)(int, char *, _DWORD))(*(_DWORD *)grim_interface_ptr + 192))(
         grim_interface_ptr,
         aBackplasma,
         0);
  (*(void (__thiscall **)(int, int))(v4 + 196))(grim_interface_ptr, v5);
  v21 = (float)config_screen_height;
  v18 = (float)*(int *)config_screen_width;
  (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
    0,
    0,
    LODWORD(v18),
    LODWORD(v21));
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v39 = 0.0;
  if ( *(_DWORD *)config_screen_width == 800 )
  {
    v39 = 64.0;
  }
  else if ( *(_DWORD *)config_screen_width == 1024 )
  {
    v39 = 128.0;
  }
  v22 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(grim_interface_ptr, aMockup);
  ui_draw_textured_quad(
    (__int64)((double)(*(_DWORD *)config_screen_width / 2 - 128) + v39),
    config_screen_height / 2 - 140,
    512,
    256,
    v22);
  v23 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(grim_interface_ptr, aClLogo);
  ui_draw_textured_quad(
    *(_DWORD *)config_screen_width / 2 - 256,
    (__int64)((double)(config_screen_height / 2 - 200) - v39 * 0.40000001),
    512,
    64,
    v23);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1058642330,
    v14,
    v19,
    v24);
  v27 = (float)(config_screen_height / 2 - 104);
  v6 = (__int64)((double)(*(_DWORD *)config_screen_width / 2 - 296) - v39 * 0.80000001);
  v43 = (float)v6;
  v7 = v43;
  (*(void (__thiscall **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 324))(
    grim_interface_ptr,
    LODWORD(v43),
    LODWORD(v27),
    aUpgradeToTheFu);
  v28 = v27 + 28.0;
  (*(void (__thiscall **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 324))(
    grim_interface_ptr,
    LODWORD(v43),
    LODWORD(v28),
    aFullVersionFea);
  v47 = v43;
  v48 = v28 + 15.0;
  v8 = *(_DWORD *)grim_interface_ptr;
  v47 = COERCE_FLOAT(
          (*(int (__thiscall **)(int, char *, int))(*(_DWORD *)grim_interface_ptr + 332))(
            grim_interface_ptr,
            aFullVersionFea,
            1065353216));
  v25 = (float)SLODWORD(v47);
  (*(void (__thiscall **)(int, float *, _DWORD))(v8 + 212))(grim_interface_ptr, &v48, LODWORD(v25));
  v29 = v28 + 22.0;
  v44 = (float)(v6 + 8);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 324))(
    grim_interface_ptr,
    LODWORD(v44),
    LODWORD(v29),
    aUnlimitedPlayT);
  v30 = v29 + 22.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v44),
    LODWORD(v30),
    aTheVariedWeapo);
  v31 = v30 + 17.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v44),
    LODWORD(v31),
    aWeaponsThatAll);
  v32 = v31 + 17.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v44),
    LODWORD(v32),
    aFireAndElectri);
  v33 = v32 + 22.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v44),
    LODWORD(v33),
    aOver40GameAlte);
  v34 = v33 + 22.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v44),
    LODWORD(v34),
    a40InsaneLevels);
  v35 = v34 + 18.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v44),
    LODWORD(v35),
    aHoursOfIntense);
  v36 = v35 + 22.0;
  (*(void (__thiscall **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 324))(
    grim_interface_ptr,
    LODWORD(v44),
    LODWORD(v36),
    aTheAbilityToPo);
  v37 = v36 + 22.0 + 22.0;
  (*(void (__thiscall **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 324))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v7)),
    LODWORD(v37),
    aPurchasingTheG);
  v26 = v37 + 17.0 + 17.0 + 22.0;
  v47 = (float)(*(_DWORD *)config_screen_width / 2 + 128);
  v45 = v39 * 0.30000001;
  v48 = (double)(config_screen_height / 2 + 102) + v45 + 50.0;
  if ( (unsigned __int8)ui_button_update(&v47, &dword_47F678) )
  {
    byte_480851 = 1;
    byte_47EA50 = 1;
    return (unsigned __int8)ShellExecuteA(0, Operation, File, 0, 0, 1);
  }
  v47 = (float)(*(_DWORD *)config_screen_width / 2 + 128);
  v48 = (double)(config_screen_height / 2 + 102) + v45 + 90.0;
  if ( !(unsigned __int8)ui_button_update(&v47, &dword_4802B0) )
  {
    quest_spawn_timeline += frame_dt_ms;
    if ( quest_spawn_timeline > dword_4712F0 )
    {
      render_pass_mode = 0;
      demo_mode_start();
    }
    if ( byte_480890 )
      goto LABEL_34;
    goto LABEL_33;
  }
  result = byte_480851;
  if ( byte_480851 )
    byte_47EA50 = 1;
  ui_transition_direction = 0;
  game_state_pending = 0;
  demo_mode_active = 1;
  if ( !byte_480851 )
  {
    config_load_presets(0);
    sfx_mute_all(music_track_intro_id);
    sfx_mute_all(music_track_crimsonquest_id);
    return sfx_play_exclusive(music_track_crimson_theme_id);
  }
  return result;
}

// nullsub_17 @ 0x0040C1A0
void __cdecl nullsub_17()
{
  ;
}

// nullsub_18 @ 0x0040C1B0
void __cdecl nullsub_18()
{
  ;
}

// console_hotkey_update @ 0x0040C1C0
// per-frame input/update function; contains console hotkey block (DIK_GRAVE) at 0x0040c360 and DIK_F12 check; entry identified via WinDbg
char __usercall sub_40C1C0@<al>(int a1@<edi>, int a2@<esi>)
{
  std::codecvt_base *v2; // ecx
  std::codecvt_base *v3; // ecx
  std::codecvt_base *v4; // ecx
  unsigned int v5; // ecx
  int v7; // eax
  FILE *v8; // eax
  char v9; // cl
  int v10; // eax
  __int64 v11; // rax
  double v12; // st7
  double v13; // st7
  double v14; // st7
  double v15; // st7
  int v16; // ecx
  double v17; // st7
  double v18; // st7
  float *v19; // eax
  double v20; // st7
  double v21; // st7
  double v22; // st7
  std::codecvt_base *v23; // ecx
  std::codecvt_base *v24; // ecx
  __int64 v25; // rax
  int v26; // esi
  double v27; // st7
  std::codecvt_base *v28; // ecx
  int v29; // eax
  int v30; // esi
  double v31; // st7
  double v32; // st7
  double v33; // st7
  std::codecvt_base *v34; // ecx
  std::codecvt_base *v35; // ecx
  std::codecvt_base *v36; // ecx
  std::codecvt_base *v37; // ecx
  std::codecvt_base *v38; // ecx
  float v39; // [esp+FCh] [ebp-40h]
  int v40; // [esp+100h] [ebp-3Ch]
  int v41; // [esp+100h] [ebp-3Ch]
  int v42; // [esp+100h] [ebp-3Ch]
  float v43; // [esp+100h] [ebp-3Ch]
  float v44; // [esp+100h] [ebp-3Ch]
  float v45; // [esp+100h] [ebp-3Ch]
  int v46; // [esp+104h] [ebp-38h]
  int v47; // [esp+104h] [ebp-38h]
  int v48; // [esp+104h] [ebp-38h]
  char *v49; // [esp+104h] [ebp-38h]
  int v50; // [esp+108h] [ebp-34h]
  int v51; // [esp+108h] [ebp-34h]
  int v52; // [esp+108h] [ebp-34h]
  int v53; // [esp+108h] [ebp-34h]
  float v54; // [esp+108h] [ebp-34h]
  float v55; // [esp+114h] [ebp-28h]
  float v56; // [esp+114h] [ebp-28h]
  float v57; // [esp+114h] [ebp-28h]
  float v58; // [esp+114h] [ebp-28h]
  float v59; // [esp+114h] [ebp-28h]
  float v60; // [esp+11Ch] [ebp-20h]
  int v61; // [esp+11Ch] [ebp-20h]
  int v62; // [esp+11Ch] [ebp-20h]
  float v63; // [esp+120h] [ebp-1Ch]
  int v64; // [esp+124h] [ebp-18h] BYREF
  float v65; // [esp+128h] [ebp-14h]
  float v66; // [esp+12Ch] [ebp-10h] BYREF
  float v67; // [esp+130h] [ebp-Ch]
  float v68; // [esp+134h] [ebp-8h]
  int v69; // [esp+138h] [ebp-4h]

  frame_dt = ((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 60))(grim_interface_ptr);
  if ( quest_unlock_index < 40 )
    config_hardcore = 0;
  if ( !game_is_full_version(v2) )
  {
    if ( *(int *)&game_sequence_id < 0 )
      *(_DWORD *)&game_sequence_id = 1200000;
    *(_DWORD *)&game_sequence_id = game_sequence_get();
    config_hardcore = 0;
  }
  if ( game_is_full_version(v3) )
  {
    dword_48823C = (int)sub_447350;
    byte_480851 = 0;
  }
  if ( !byte_486FAA && game_is_full_version(v4) )
  {
    v4 = (std::codecvt_base *)dword_488218;
    dword_4875B8 = dword_488218;
    dword_4875BC = dword_48821C;
    byte_486FAA = 1;
    byte_488208 = 0;
    flt_4875C4 = flt_4875C4 + 60.0;
    flt_4875C0 = flt_4875C0 - 20.0;
  }
  if ( !audio_suspend_flag
    && *(_BYTE *)(*(int (__thiscall **)(int, float *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                   grim_interface_ptr,
                   &v66,
                   87) )
  {
    if ( render_pass_mode && config_game_mode == 3 )
    {
      v5 = quest_stage_minor - 1;
      a2 = *(_DWORD *)quest_stage_major - 1;
      if ( quest_stage_minor - 1 >= 10 )
        v5 %= 0xAu;
      if ( a2 >= 4 )
        a2 -= 4 * ((unsigned int)a2 >> 2);
      terrain_generate(44 * (a2 + 10 * v5) + 4736816);
    }
    else
    {
      terrain_generate_random();
    }
    (*(void (__thiscall **)(int, int, _BYTE))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 87, 0);
  }
  if ( !game_is_full_version(v4) && quest_unlock_index > 10 )
    quest_unlock_index = 10;
  if ( audio_suspend_flag )
  {
    audio_resume_all();
    return 1;
  }
  dword_480848 += frame_dt_ms;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 41) )
    console_set_open(&console_log_queue, console_open_flag == 0);
  console_update((int)&console_log_queue, a1, a2);
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 88) )
  {
    v7 = dword_4808C4;
    do
    {
      if ( v7 >= 10 )
      {
        if ( v7 >= 100 )
          crt_sprintf(byte_47F634, "shot_%d.bmp", v7);
        else
          crt_sprintf(byte_47F634, "shot_0%d.bmp", v7);
      }
      else
      {
        crt_sprintf(byte_47F634, "shot_00%d.bmp", v7);
      }
      v8 = crt_fopen(byte_47F634, file_mode_read_binary);
      if ( v8 )
      {
        crt_fclose(v8);
        v9 = 0;
      }
      else
      {
        v9 = 1;
      }
      v7 = ++dword_4808C4;
    }
    while ( !v9 );
    (*(void (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 12))(grim_interface_ptr, byte_47F634);
  }
  if ( !demo_mode_active && !byte_480850 )
  {
    v10 = game_sequence_get();
    a2 = game_state_id;
    *(_DWORD *)&game_sequence_id = v10;
    if ( !console_open_flag && render_pass_mode && game_state_id == 9 )
      *(_DWORD *)&game_sequence_id += (__int64)(frame_dt * 1000.0);
    if ( dword_48084C > 0 && !console_open_flag )
    {
      if ( !render_pass_mode )
        goto LABEL_59;
      if ( game_state_id == 9 && config_game_mode != 8 )
        dword_48084C += (__int64)(frame_dt * 1000.0);
    }
  }
  if ( render_pass_mode && perk_count_get(perk_id_reflex_boosted) && game_state_id == 9 )
    frame_dt = frame_dt * 0.89999998;
LABEL_59:
  dword_47EA48 = LODWORD(frame_dt);
  flt_47EA4C = flt_47EA4C + frame_dt;
  v11 = (__int64)(frame_dt * 1000.0);
  frame_dt_ms = v11;
  if ( !console_open_flag && render_pass_mode && game_state_id == 9 && config_game_mode != 8 )
    *(_DWORD *)&dword_48718C += v11;
  v12 = frame_dt;
  if ( byte_48702C )
    v13 = v12 * 10.0 + screen_fade_alpha;
  else
    v13 = screen_fade_alpha - (v12 + v12);
  screen_fade_alpha = v13;
  if ( screen_fade_alpha >= 0.0 )
  {
    if ( screen_fade_alpha > 1.0 )
      screen_fade_alpha = 1.0;
  }
  else
  {
    screen_fade_alpha = 0.0;
  }
  if ( console_open_flag )
    frame_dt = 0.0;
  if ( ((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 112))(grim_interface_ptr) == 0.0
    || ((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 116))(grim_interface_ptr) == 0.0 )
  {
    byte_4871CB = 0;
  }
  else
  {
    byte_4871CB = 1;
    ui_mouse_blocked = 0;
    dword_4808C8 = 0;
  }
  v60 = 0.0;
  v63 = 0.0;
  v55 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
          grim_interface_ptr,
          player_axis_aim_x);
  v14 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
          grim_interface_ptr,
          player_axis_aim_y);
  if ( sqrt(v14 * v14 + v55 * v55) > 0.2 )
  {
    v63 = v14;
    v60 = v55;
  }
  v56 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
          grim_interface_ptr,
          player_axis_move_x);
  v15 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
          grim_interface_ptr,
          player_axis_move_y);
  if ( sqrt(v15 * v15 + v56 * v56) > 0.2 )
  {
    v60 = v60 + v56;
    v63 = v63 + v15;
  }
  if ( sqrt(v63 * v63 + v60 * v60) > 0.2 )
    dword_4808C8 = 1;
  v16 = game_state_id;
  if ( game_state_id == 9 )
  {
    dword_4808C8 = 0;
  }
  else if ( dword_4808C8 == 1 )
  {
    v21 = flt_4807BC * frame_dt;
    ui_mouse_x = v21 * v60 * 540.0 + ui_mouse_x;
    ui_mouse_y = v21 * v63 * 540.0 + ui_mouse_y;
    goto LABEL_88;
  }
  v17 = ((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 112))(grim_interface_ptr);
  ui_mouse_x = v17 * flt_4807BC + v17 * flt_4807BC + ui_mouse_x;
  v18 = ((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 116))(grim_interface_ptr);
  v19 = (float *)&dword_4871F4;
  ui_mouse_y = v18 * flt_4807BC + v18 * flt_4807BC + ui_mouse_y;
  do
  {
    *v19 = ui_mouse_x;
    v19[1] = ui_mouse_y;
    v19 += 2;
  }
  while ( (int)v19 < (int)flt_487204 );
  v16 = game_state_id;
LABEL_88:
  if ( ui_mouse_x < 0.0 )
    ui_mouse_x = 0.0;
  if ( ui_mouse_y < 0.0 )
    ui_mouse_y = 0.0;
  v20 = (double)(*(_DWORD *)config_screen_width - 1);
  if ( ui_mouse_x > v20 )
    ui_mouse_x = v20;
  v22 = (double)(config_screen_height - 1);
  if ( ui_mouse_y > v22 )
    ui_mouse_y = v22;
  if ( v16 == 22 || byte_4824D1 )
  {
    sub_40B630();
    goto LABEL_125;
  }
  if ( v16 != 9 )
  {
    if ( v16 != 24 )
    {
      switch ( v16 )
      {
        case 6:
          perk_selection_screen_update();
          break;
        case 7:
          game_over_screen_update();
          break;
        case 8:
          quest_results_screen_update();
          break;
        case 12:
          quest_failed_screen_update();
          break;
        case 18:
          survival_gameplay_update_and_render();
          break;
        case 21:
          FUN_00406350();
          break;
        default:
          byte_480890 = 0;
          FUN_00406af0();
          break;
      }
      goto LABEL_125;
    }
    gameplay_update_and_render((std::codecvt_base *)0x18, a2);
    goto LABEL_108;
  }
  if ( byte_480890 )
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 44))(
      grim_interface_ptr,
      0,
      0,
      0,
      0);
  else
    gameplay_update_and_render((std::codecvt_base *)9, a2);
  if ( demo_mode_active )
LABEL_108:
    demo_purchase_screen_update(v23);
  if ( audio_suspend_flag )
    return 1;
LABEL_125:
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    0x40000000,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v40,
    v46,
    v50);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1058642330);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1053609165,
    v41,
    v47,
    v51);
  if ( !game_is_full_version(v24) )
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1050253722,
      1050253722,
      1058642330);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1055286886,
    v42,
    v48,
    v52);
  if ( *(float *)(dword_480868 + 12) != 0.0 )
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1058642330);
    v25 = (__int64)((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 64))(grim_interface_ptr);
    v26 = *(_DWORD *)grim_interface_ptr;
    if ( (int)v25 < 400 )
    {
      v53 = (__int64)((double (*)(void))*(_DWORD *)(v26 + 64))();
      v49 = aD_0;
      v43 = (float)(config_screen_height - 24);
      v27 = (double)(*(_DWORD *)config_screen_width - 45);
    }
    else
    {
      v53 = (__int64)((double (*)(void))*(_DWORD *)(v26 + 64))();
      v49 = a400;
      v43 = (float)(config_screen_height - 24);
      v27 = (double)(*(_DWORD *)config_screen_width - 51);
    }
    v39 = v27;
    (*(void (__cdecl **)(int, _DWORD, float, char *, int))(v26 + 328))(
      grim_interface_ptr,
      LODWORD(v39),
      COERCE_FLOAT(LODWORD(v43)),
      v49,
      v53);
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1058642330);
  FUN_00401dd0((int)&console_log_queue);
  crt_rand();
  audio_update();
  if ( !(*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 1) )
    goto LABEL_140;
  v28 = (std::codecvt_base *)game_state_id;
  if ( (render_pass_mode || game_state_id == 22) && (game_state_id == 9 || game_state_id == 22 || game_state_id == 18) )
  {
    ui_transition_direction = 0;
    game_state_pending = 5;
    if ( plugin_interface_ptr )
    {
      *(_BYTE *)(plugin_interface_ptr + 9) = 1;
LABEL_140:
      v28 = (std::codecvt_base *)game_state_id;
    }
  }
  v29 = dword_471308;
  if ( dword_471308 == -1 )
  {
    v29 = crt_rand() % 32;
    v28 = (std::codecvt_base *)game_state_id;
    dword_471308 = v29;
  }
  if ( v28 == (std::codecvt_base *)4
    && !render_pass_mode
    && local_system_time.wMonth == 3
    && local_system_time.wDay == 3
    && v29 == 3 )
  {
    dword_471308 = -1;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1045220557,
      1065353216,
      1058642330,
      1056964608);
    v30 = *(_DWORD *)grim_interface_ptr;
    v54 = (float)(crt_rand() % 64 + 16);
    (*(void (__thiscall **)(int, _DWORD))(v30 + 324))(grim_interface_ptr, LODWORD(v54));
  }
  if ( game_is_full_version(v28) )
  {
LABEL_154:
    if ( !demo_mode_active )
      goto LABEL_166;
    goto LABEL_155;
  }
  if ( !demo_mode_active )
  {
    v31 = (double)*(int *)&game_sequence_id / (double)sub_41DF50();
    v57 = v31;
    if ( v31 > 1.0 )
      v57 = 1.0;
    v66 = 0.0;
    v67 = 0.0;
    v65 = (float)(config_screen_height - 7);
    v68 = 0.0;
    v69 = 1056964608;
    v64 = 0;
    v44 = (float)*(int *)config_screen_width;
    (*(void (__thiscall **)(int, int *, _DWORD, int, float *))(*(_DWORD *)grim_interface_ptr + 208))(
      grim_interface_ptr,
      &v64,
      LODWORD(v44),
      1090519040,
      &v66);
    v66 = v57;
    v32 = v57 * 4.0 + 1.0;
    v69 = 1056964608;
    v64 = 0x40000000;
    v67 = 0.89999998 / v32;
    v68 = 0.5 / v32;
    v65 = (float)(config_screen_height - 5);
    v45 = (double)(*(_DWORD *)config_screen_width - 4) * v57;
    (*(void (__thiscall **)(int, int *, _DWORD, int, float *))(*(_DWORD *)grim_interface_ptr + 208))(
      grim_interface_ptr,
      &v64,
      LODWORD(v45),
      1077936128,
      &v66);
    goto LABEL_154;
  }
LABEL_155:
  if ( !game_state_pending )
  {
    v61 = ui_elements_max_timeline();
    if ( v61 )
      v33 = 1.0 - (double)ui_elements_timeline / (double)v61;
    else
      v33 = 1.0;
    v58 = v33 * v33;
    if ( game_state_prev == 24 )
    {
      byte_480890 = 0;
      v58 = 1.0 - v58;
    }
    if ( v58 >= 0.0 )
    {
      if ( v58 > 1.0 )
        v58 = 1.0;
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 204))(
        grim_interface_ptr,
        0,
        0,
        0,
        COERCE_FLOAT(LODWORD(v58)));
    }
    else
    {
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 204))(
        grim_interface_ptr,
        0,
        0,
        0,
        0);
    }
  }
LABEL_166:
  if ( game_state_pending == 10 )
  {
    v62 = ui_elements_max_timeline();
    if ( v62 )
      v59 = 1.0 - (double)ui_elements_timeline / (double)v62;
    else
      v59 = 1.0;
    if ( game_state_prev == 22 )
      v59 = 1.0 - v59;
    if ( v59 >= 0.0 )
    {
      if ( v59 > 1.0 )
        v59 = 1.0;
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 204))(
        grim_interface_ptr,
        0,
        0,
        0,
        COERCE_FLOAT(LODWORD(v59)));
    }
    else
    {
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 204))(
        grim_interface_ptr,
        0,
        0,
        0,
        0);
    }
  }
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 16)
    && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 56) )
  {
    byte_47EA50 = 1;
  }
  else if ( !byte_47EA50 )
  {
LABEL_186:
    if ( byte_4D7A24 )
    {
      byte_4D7A24 = 0;
      FUN_00402d50();
      FUN_00402d50();
      audio_suspend_all();
      game_is_full_version(v36);
    }
    if ( byte_4D7A25 )
    {
      byte_4D7A25 = 0;
      FUN_00402d50();
      FUN_00402d50();
      audio_suspend_all();
      game_is_full_version(v37);
    }
    if ( byte_4D7A26 )
    {
      byte_4D7A26 = 0;
      FUN_00402d50();
      FUN_00402d50();
      audio_suspend_all();
      game_is_full_version(v38);
    }
    if ( dword_4D11F0 || !byte_4D11F8 || !lpMultiByteStr || game_state_id == 14 && !byte_480838 )
      return 1;
    Sleep(0x64u);
    return 0;
  }
  if ( game_is_full_version(v34) )
  {
    config_sync_from_grim();
    return 0;
  }
  if ( !byte_480851 && !game_is_full_version(v35) )
  {
    config_sync_from_grim();
    demo_mode_start();
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_extra_0);
    sfx_mute_all(music_track_intro_id);
    sfx_play_exclusive(music_track_shortie_monk_id);
    byte_47EA50 = 0;
    byte_480851 = 1;
    goto LABEL_186;
  }
  return 0;
}

// sub_40CFE0 @ 0x0040CFE0
int *sub_40CFE0()
{
  int *result; // eax
  int v1; // ecx

  result = &credits_line_table_ptrs;
  v1 = 256;
  do
  {
    result[1] = 0;
    *result = 0;
    result += 2;
    --v1;
  }
  while ( v1 );
  return result;
}

// credits_line_set @ 0x0040D000
// stores a credits line string + flags into the credits line table
char *__cdecl sub_40D000(int a1, char *Source, int a3)
{
  char *result; // eax

  credits_line_table_flags[2 * a1] = a3;
  if ( credits_line_table_ptrs[2 * a1] )
    crt_free((LPVOID)credits_line_table_ptrs[2 * a1]);
  result = strdup_malloc(Source);
  credits_line_table_ptrs[2 * a1] = (int)result;
  dword_4811B8 = a1;
  return result;
}

// credits_line_clear_flag @ 0x0040D040
// walks backward to find the last line with flag 0x4 and clears it (penalty for wrong click; plays sfx)
int __cdecl sub_40D040(int a1)
{
  int result; // eax
  _BYTE *i; // ecx

  result = a1;
  if ( a1 >= 0 )
  {
    for ( i = (_BYTE *)(8 * a1 + 4721028); (*i & 4) == 0; i -= 8 )
    {
      if ( --result < 0 )
        return result;
    }
    credits_line_table_flags[2 * result] &= ~4u;
    return sfx_play(sfx_trooper_inpain_01, 1.0);
  }
  return result;
}

// credits_build_lines @ 0x0040D090
// populates credits line table with headings, names, and hint lines
char *sub_40D090()
{
  credits_line_set(0, szPassword, 0);
  credits_line_set(1, szAgent, 1);
  credits_line_set(2, szPassword, 0);
  credits_line_set(3, szPassword, 0);
  credits_line_set(4, aGameDesign, 1);
  credits_line_set(5, aTeroAlatalo, 0);
  credits_line_set(6, szPassword, 0);
  credits_line_set(7, aProgramming, 1);
  credits_line_set(8, aTeroAlatalo, 0);
  credits_line_set(9, szPassword, 0);
  credits_line_set(10, aProducer, 1);
  credits_line_set(11, aZachYoung, 0);
  credits_line_set(12, szPassword, 0);
  credits_line_set(13, a2dArt, 1);
  credits_line_set(14, aTeroAlatalo, 0);
  credits_line_set(15, szPassword, 0);
  credits_line_set(16, a3dModelling, 1);
  credits_line_set(17, aTeroAlatalo, 0);
  credits_line_set(18, aTimoPalonen, 0);
  credits_line_set(19, szPassword, 0);
  credits_line_set(20, aMusic, 1);
  credits_line_set(21, aValtteriPihlaj, 0);
  credits_line_set(22, aVilleEriksson, 0);
  credits_line_set(23, szPassword, 0);
  credits_line_set(24, aSoundEffects, 1);
  credits_line_set(25, aIonHardie, 0);
  credits_line_set(26, aTeroAlatalo, 0);
  credits_line_set(27, aValtteriPihlaj, 0);
  credits_line_set(28, aVilleEriksson, 0);
  credits_line_set(29, szPassword, 0);
  credits_line_set(30, aManual, 1);
  credits_line_set(31, aMiikkaKulmala, 0);
  credits_line_set(32, aZachYoung, 0);
  credits_line_set(33, szPassword, 0);
  credits_line_set(34, aSpecialThanksT, 1);
  credits_line_set(35, aPetriJ, 0);
  credits_line_set(36, aPeterHajbaReme, 0);
  credits_line_set(37, szPassword, 0);
  credits_line_set(38, aPlayTesters, 1);
  credits_line_set(39, aAvrahamPetrosy, 0);
  credits_line_set(40, aBryceBaker, 0);
  credits_line_set(41, aDanRuskin, 0);
  credits_line_set(42, aDirkBunk, 0);
  credits_line_set(43, aEricDallaire, 0);
  credits_line_set(44, aErikVanPelt, 0);
  credits_line_set(45, aErnieRamirez, 0);
  credits_line_set(46, aIonHardie, 0);
  credits_line_set(47, aJamesCSmith, 0);
  credits_line_set(48, aJarkkoForsback, 0);
  credits_line_set(49, aJeffMcateer, 0);
  credits_line_set(50, aJuhaAlatalo, 0);
  credits_line_set(51, aKalleHahl, 0);
  credits_line_set(52, aLarsBrubaker, 0);
  credits_line_set(53, aLeeCooper, 0);
  credits_line_set(54, aMarkusLassila, 0);
  credits_line_set(55, aMattiAlanen, 0);
  credits_line_set(56, aMiikkaKulmala, 0);
  credits_line_set(57, aMikaAlatalo, 0);
  credits_line_set(58, aMikeColonnese, 0);
  credits_line_set(59, aSimonHallam, 0);
  credits_line_set(60, aToniNurminen, 0);
  credits_line_set(61, aValtteriPihlaj, 0);
  credits_line_set(62, aVilleEriksson, 0);
  credits_line_set(63, aVilleM, 0);
  credits_line_set(64, aZachYoung, 0);
  credits_line_set(65, szPassword, 0);
  credits_line_set(66, aGreetingTo, 0);
  credits_line_set(66, aChaos, 0);
  credits_line_set(66, aMatricks, 0);
  credits_line_set(66, aMuzzy, 0);
  credits_line_set(66, szPassword, 0);
  credits_line_set(67, szPassword, 0);
  credits_line_set(68, a2003C10tonsEnt, 0);
  credits_line_set(69, a10tonsLogoBy, 0);
  credits_line_set(70, aPasiHeinonen, 0);
  credits_line_set(71, szPassword, 0);
  credits_line_set(72, szPassword, 0);
  credits_line_set(73, szPassword, 0);
  credits_line_set(74, aUsesVorbisAudi, 0);
  credits_line_set(75, a2003CXiphOrgFo, 0);
  credits_line_set(76, aSeeVorbisTxt, 0);
  credits_line_set(77, szPassword, 0);
  credits_line_set(78, szPassword, 0);
  credits_line_set(79, szPassword, 0);
  credits_line_set(80, szPassword, 0);
  credits_line_set(81, szPassword, 0);
  credits_line_set(82, szPassword, 0);
  credits_line_set(83, szPassword, 0);
  credits_secret_line_base_index = 84;
  credits_line_set(84, szPassword, 0);
  credits_line_set(85, szPassword, 0);
  credits_line_set(86, szPassword, 0);
  credits_line_set(87, aYouCanStopWatc, 0);
  credits_line_set(88, szPassword, 0);
  credits_line_set(89, szPassword, 0);
  credits_line_set(90, szPassword, 0);
  credits_line_set(91, szPassword, 0);
  credits_line_set(92, szPassword, 0);
  credits_line_set(93, szPassword, 0);
  credits_line_set(94, szPassword, 0);
  credits_line_set(95, szPassword, 0);
  credits_line_set(96, szPassword, 0);
  credits_line_set(97, szPassword, 0);
  credits_line_set(98, szPassword, 0);
  credits_line_set(99, szPassword, 0);
  credits_line_set(100, szPassword, 0);
  credits_line_set(101, szPassword, 0);
  credits_line_set(102, szPassword, 0);
  credits_line_set(103, szPassword, 0);
  credits_line_set(104, szPassword, 0);
  credits_line_set(105, szPassword, 0);
  credits_line_set(106, szPassword, 0);
  credits_line_set(107, szPassword, 0);
  credits_line_set(108, szPassword, 0);
  credits_line_set(109, szPassword, 0);
  credits_line_set(110, szPassword, 0);
  credits_line_set(111, szPassword, 0);
  credits_line_set(112, szPassword, 0);
  credits_line_set(113, szPassword, 0);
  credits_line_set(114, szPassword, 0);
  credits_line_set(115, szPassword, 0);
  credits_line_set(116, szPassword, 0);
  credits_line_set(117, szPassword, 0);
  credits_line_set(118, szPassword, 0);
  credits_line_set(119, aClickTheOnesWi, 0);
  credits_line_set(120, aAndBePatient, 0);
  credits_line_set(121, szPassword, 0);
  credits_line_set(122, szPassword, 0);
  credits_line_set(123, szPassword, 0);
  credits_line_set(124, szPassword, 0);
  return credits_line_set(125, szPassword, 0);
}

// credits_screen_update @ 0x0040D800
// credits screen update/render loop; clicks flag lines containing 'o' (lowercase) and misclicks clear the last flagged line; when all 'o' lines are flagged, sets DAT_004811c4 and injects secret lines at DAT_004811bc; Secret button sets game_state_pending=0x1a (AlienZooKeeper)
int __usercall sub_40D800@<eax>(float a1@<ebp>, int a2@<esi>)
{
  int result; // eax
  double v3; // st7
  int v4; // ecx
  int v5; // edx
  double v6; // st7
  unsigned __int8 v8; // c0
  unsigned __int8 v9; // c3
  int v10; // ebp
  int v11; // esi
  int v12; // ecx
  double v13; // st7
  double v14; // st6
  double v15; // st6
  double v16; // st6
  int v17; // eax
  int v18; // eax
  int v19; // edx
  int v20; // edx
  int *v21; // esi
  int v22; // esi
  int v23; // eax
  int v24; // ebp
  int v25; // ecx
  int v26; // edx
  int v27; // ebp
  int v28; // ecx
  int v29; // edx
  int v30; // ebp
  int v31; // ecx
  float v32; // [esp+24h] [ebp-44h]
  float v33; // [esp+24h] [ebp-44h]
  int v36; // [esp+44h] [ebp-24h]
  float v37; // [esp+48h] [ebp-20h]
  float v38; // [esp+4Ch] [ebp-1Ch]
  float v39; // [esp+50h] [ebp-18h]
  float v40; // [esp+54h] [ebp-14h]
  float v41; // [esp+54h] [ebp-14h]
  float v42; // [esp+58h] [ebp-10h] BYREF
  float v43; // [esp+5Ch] [ebp-Ch]
  float v44; // [esp+60h] [ebp-8h] BYREF
  float v45; // [esp+64h] [ebp-4h]
  float retaddr; // [esp+68h] [ebp+0h] BYREF

  if ( (byte_480978 & 1) == 0 )
  {
    byte_4811A6 = 1;
    byte_480978 |= 1u;
    byte_4811B5 = 0;
    byte_4811B4 = 0;
    dword_4811B0 = 1065353216;
    dword_4811AC = 0;
    credits_back_button = 0;
    byte_4811A4 = 0;
    credits_back_button_clicked = 0;
    dword_4811A8 = 0;
    crt_atexit(nullsub_20);
  }
  if ( (byte_480978 & 2) == 0 )
  {
    byte_48118E = 1;
    byte_480978 |= 2u;
    byte_48119D = 0;
    byte_48119C = 0;
    dword_481198 = 1065353216;
    dword_481194 = 0;
    credits_secret_button = 0;
    byte_48118C = 0;
    credits_secret_button_clicked = 0;
    dword_481190 = 0;
    crt_atexit(nullsub_19);
  }
  credits_secret_button = (int)menu_label_secret;
  v45 = flt_489DFC + flt_489E20;
  v39 = flt_489E1C + flt_489DF8 + 300.0;
  v40 = v45 + 40.0;
  v43 = v40 + 10.0;
  v42 = v39 + flt_489DE8 + 48.0 - 110.0 - 40.0;
  if ( !dword_487234 )
  {
    dword_487234 = 1;
    credits_build_lines();
    dword_4811C0 = 0;
    dword_481184 = 0;
    goto LABEL_7;
  }
  if ( dword_487234 == 1 )
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    if ( dword_481184 > dword_4811B8 + 2 )
    {
      dword_4811C0 = 0;
      dword_481184 = 0;
    }
    v43 = v43 - 4.0;
    v32 = v42 + 4.0;
    (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      LODWORD(v32),
      COERCE_FLOAT(LODWORD(v43)),
      menu_label_credits);
    v43 = v43 + 20.0 - 6.0;
    v3 = frame_dt + *(float *)&dword_4811C0;
    *(float *)&dword_4811C0 = v3;
    v4 = (__int64)v3 - 15;
    dword_481184 = v4;
    v5 = v4 + 16;
    dword_481180 = v4 + 16;
    if ( v4 + 16 > dword_4811B8 )
    {
      v5 = dword_4811B8;
      dword_481180 = dword_4811B8;
    }
    v6 = *(float *)&dword_4811C0 * 16.0;
    if ( !(v8 | v9) )
    {
      do
        v6 = v6 - 16.0;
      while ( v6 > 16.0 );
    }
    v10 = 0;
    if ( v5 - v4 > 0 )
    {
      v36 = 0;
      while ( 1 )
      {
        v11 = v4 + v10;
        if ( v4 + v10 < 0 )
          v11 = 0;
        v12 = (*(int (__thiscall **)(int, int, int, float))(*(_DWORD *)grim_interface_ptr + 332))(
                grim_interface_ptr,
                credits_line_table_ptrs[2 * v11],
                a2,
                COERCE_FLOAT(LODWORD(a1)));
        v13 = (double)SLODWORD(v38) + v45 - v39;
        v42 = v13;
        v14 = v45 - 16.0 + 24.0;
        if ( v13 < v14 )
          break;
        v16 = (double)(16 * (dword_481180 - dword_481184 - 1)) + v45 - 24.0;
        if ( v13 > v16 )
        {
          v15 = (v16 - v13) * 0.041666668 + 1.0;
LABEL_30:
          v37 = v15;
          if ( v37 <= 1.0 )
          {
            if ( v37 < 0.0 )
              v37 = 0.0;
          }
          else
          {
            v37 = 1.0;
          }
          goto LABEL_35;
        }
        v37 = 1.0;
LABEL_35:
        v41 = (float)(v12 / 2);
        retaddr = v44 + 140.0 - v41;
        if ( ui_mouse_inside_rect(&retaddr, 16, v12) && (unsigned __int8)input_primary_just_pressed() )
        {
          if ( strchr((const char *)credits_line_table_ptrs[2 * v11], 111) )
          {
            if ( (credits_line_table_flags[2 * v11] & 4) == 0 )
              sfx_play(sfx_ui_bonus, 1.0);
            v17 = credits_line_table_flags[2 * v11];
            LOBYTE(v17) = v17 | 4;
            credits_line_table_flags[2 * v11] = v17;
          }
          else
          {
            credits_line_clear_flag(v11);
          }
        }
        v18 = credits_line_table_flags[2 * v11];
        if ( (v18 & 4) != 0 )
        {
          v19 = *(_DWORD *)grim_interface_ptr;
          a1 = v37;
          if ( (v18 & 1) != 0 )
          {
            a2 = 1063675494;
            (*(void (__stdcall **)(int, int))(v19 + 276))(1063675494, 1065353216);
          }
          else
          {
            a2 = 1060320051;
            (*(void (__stdcall **)(int, int))(v19 + 276))(1053609165, 1060320051);
          }
        }
        else
        {
          v20 = *(_DWORD *)grim_interface_ptr;
          a1 = v37;
          if ( (v18 & 1) != 0 )
          {
            a2 = 1065353216;
            (*(void (__stdcall **)(int, int))(v20 + 276))(1065353216, 1065353216);
          }
          else
          {
            a2 = 1060320051;
            (*(void (__stdcall **)(int, int))(v20 + 276))(1053609165, 1056964608);
          }
        }
        v33 = v42 + 140.0 - v38;
        (*(void (__stdcall **)(_DWORD, float, int))(*(_DWORD *)grim_interface_ptr + 324))(
          LODWORD(v33),
          COERCE_FLOAT(LODWORD(v39)),
          credits_line_table_ptrs[2 * v11]);
        v4 = dword_481184;
        ++v10;
        v36 += 16;
        if ( v10 >= dword_481180 - dword_481184 )
          goto LABEL_51;
      }
      v15 = 1.0 - (v14 - v13) * 0.041666668;
      goto LABEL_30;
    }
LABEL_51:
    credits_back_button = (int)aBack_0;
    v42 = v42 + 100.0;
    v43 = v43 + 250.0;
    ui_button_update(&v42, &credits_back_button);
    v21 = credits_line_table_ptrs;
    while ( !*v21 || !strchr((const char *)*v21, 111) || (v21[1] & 4) != 0 )
    {
      v21 += 2;
      if ( (int)v21 >= (int)&dword_481180 )
      {
        if ( !credits_secret_unlock_flag )
        {
          v22 = credits_secret_line_base_index;
          v23 = credits_secret_line_base_index;
          credits_secret_unlock_flag = 1;
          credits_line_table_flags[2 * credits_secret_line_base_index] |= 4u;
          v24 = dword_48098C[2 * v23++];
          credits_line_table_flags[2 * v23] = v24 | 4;
          v25 = dword_48098C[2 * v23++];
          credits_line_table_flags[2 * v23] = v25 | 4;
          v26 = dword_48098C[2 * v23++];
          credits_line_table_flags[2 * v23] = v26 | 4;
          v27 = dword_48098C[2 * v23++];
          credits_line_table_flags[2 * v23] = v27 | 4;
          v28 = dword_48098C[2 * v23++];
          credits_line_table_flags[2 * v23] = v28 | 4;
          v29 = dword_48098C[2 * v23++];
          credits_line_table_flags[2 * v23] = v29 | 4;
          v30 = dword_48098C[2 * v23++];
          credits_line_table_flags[2 * v23] = v30 | 4;
          v31 = dword_48098C[2 * v23++];
          credits_line_table_flags[2 * v23] = v31 | 4;
          dword_48098C[2 * v23] |= 4u;
          credits_line_table_ptrs[2 * v22++] = (int)strdup_malloc(aInsideDeadLetM);
          credits_line_table_ptrs[2 * v22++] = (int)strdup_malloc(aDoFirepowerSee);
          credits_line_table_ptrs[2 * v22++] = (int)strdup_malloc(aTheSacrificeOl);
          credits_line_table_ptrs[2 * v22++] = (int)strdup_malloc(aYourselfGround);
          credits_line_table_ptrs[2 * v22++] = (int)strdup_malloc(aTriangleCubeLa);
          credits_line_table_ptrs[2 * v22++] = (int)strdup_malloc(a00010011100000);
          credits_line_table_ptrs[2 * v22++] = (int)strdup_malloc(a01010010111000);
          credits_line_table_ptrs[2 * v22++] = (int)strdup_malloc(a01111100100011);
          credits_line_table_ptrs[2 * v22] = (int)strdup_malloc(a4BitsForIndexO);
          crt_free((LPVOID)dword_480988[2 * v22]);
          credits_line_table_ptrs[2 * v22 + 2] = (int)strdup_malloc(a4BitsForIndex);
        }
        v44 = v42 + 94.0;
        v45 = v43;
        ui_button_update(&v44, &credits_secret_button);
        break;
      }
    }
  }
LABEL_7:
  if ( credits_back_button_clicked )
  {
    ui_transition_direction = 0;
    game_state_pending = 4;
    nullsub_72();
  }
  if ( credits_secret_button_clicked )
  {
    ui_transition_direction = 0;
    game_state_pending = 26;
    nullsub_72();
  }
  result = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 1);
  if ( (_BYTE)result )
  {
    ui_transition_direction = 0;
    game_state_pending = 4;
    return nullsub_72();
  }
  return result;
}

// nullsub_19 @ 0x0040DF50
void __cdecl nullsub_19()
{
  ;
}

// nullsub_20 @ 0x0040DF60
void __cdecl nullsub_20()
{
  ;
}

// nullsub_105 @ 0x0040DF80
void nullsub_105()
{
  ;
}

// sub_40DFA0 @ 0x0040DFA0
void sub_40DFA0()
{
  mod_api_context = (int)&off_46F3E4;
  dword_481AE8 = 1;
}

// FUN_0040e000 @ 0x0040E000
// [binja] int32_t sub_40e000(char* arg1)
void sub_40E000(char *Format, ...)
{
  char Buffer[4092]; // [esp+0h] [ebp-FFCh] BYREF
  va_list va; // [esp+1004h] [ebp+8h] BYREF

  va_start(va, Format);
  crt_vsprintf(Buffer, Format, va);
  OutputDebugStringA(Buffer);
}

// sub_40E040 @ 0x0040E040
char **__stdcall sub_40E040(char *Source)
{
  char **v1; // eax
  char *v2; // edx

  v1 = (char **)console_cvar_find(&console_log_queue, Source);
  if ( !v1 )
    v1 = console_register_cvar((char ***)&console_log_queue, Source, a1);
  v2 = *v1;
  v1[8] = (char *)(v1 + 3);
  v1[6] = v2;
  v1[7] = v1[4];
  return v1 + 6;
}

// sub_40E080 @ 0x0040E080
char __stdcall sub_40E080(const char *a1)
{
  return console_cvar_unregister(&console_log_queue, a1);
}

// sub_40E0A0 @ 0x0040E0A0
char __stdcall sub_40E0A0(int a1)
{
  return console_exec_line((char *)&console_log_queue, a1);
}

// sub_40E0C0 @ 0x0040E0C0
char *__stdcall sub_40E0C0(char *Source, int a2)
{
  return console_register_command((char **)&console_log_queue, Source, a2);
}

// sub_40E0E0 @ 0x0040E0E0
char __stdcall sub_40E0E0(int a1)
{
  return console_command_unregister(&console_log_queue, a1);
}

// sub_40E100 @ 0x0040E100
int __stdcall sub_40E100(const char *a1)
{
  _BYTE v2[16]; // [esp+Ch] [ebp-10h] BYREF

  if ( !strcmp(a1, aGrimgfx) )
    return grim_interface_ptr;
  if ( !strcmp(a1, aGrimsfx) || strcmp(a1, aIdirect3d8) )
    return 0;
  return *(_DWORD *)((*(int (__thiscall **)(int, _BYTE *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                       grim_interface_ptr,
                       v2,
                       81)
                   + 12);
}

// sub_40E1F0 @ 0x0040E1F0
int __stdcall sub_40E1F0(int a1, int a2, int a3, int a4)
{
  return (*(int (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 44))(
           grim_interface_ptr,
           a1,
           a2,
           a3,
           a4);
}

// sub_40E220 @ 0x0040E220
int __stdcall sub_40E220(int a1)
{
  return (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 332))(grim_interface_ptr, a1);
}

// sub_40E240 @ 0x0040E240
int sub_40E240(int a1, int a2, int a3, char *Format, ...)
{
  va_list va; // [esp+14h] [ebp+14h] BYREF

  va_start(va, Format);
  crt_vsprintf(byte_4D9D00, Format, va);
  return (*(int (__thiscall **)(int, int, int, char *))(*(_DWORD *)grim_interface_ptr + 324))(
           grim_interface_ptr,
           a2,
           a3,
           byte_4D9D00);
}

// sub_40E280 @ 0x0040E280
int __stdcall sub_40E280(const char *a1)
{
  char Buffer[260]; // [esp+4h] [ebp-208h] BYREF
  char v3[260]; // [esp+108h] [ebp-104h] BYREF

  crt_sprintf(Buffer, "mods\\%s", a1);
  crt_sprintf(v3, "CLM_%s", a1);
  return texture_get_or_load((int)v3, (char)Buffer);
}

// sub_40E2E0 @ 0x0040E2E0
char __stdcall sub_40E2E0(int a1)
{
  (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 188))(grim_interface_ptr, a1);
  return 1;
}

// sub_40E300 @ 0x0040E300
int __stdcall sub_40E300(int a1)
{
  return (*(int (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, a1, 0);
}

// sub_40E320 @ 0x0040E320
int __stdcall sub_40E320(int a1, int a2, int a3, int a4)
{
  return (*(int (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
           grim_interface_ptr,
           a1,
           a2,
           a3,
           a4);
}

// sub_40E350 @ 0x0040E350
int __stdcall sub_40E350(int a1, int a2, int a3, int a4)
{
  return (*(int (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
           grim_interface_ptr,
           a1,
           a2,
           a3,
           a4);
}

// sub_40E380 @ 0x0040E380
int __stdcall sub_40E380(int a1)
{
  int v2; // [esp-Ch] [ebp-Ch]
  int v3; // [esp-8h] [ebp-8h]
  int v4; // [esp-4h] [ebp-4h]

  return (*(int (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
           grim_interface_ptr,
           21,
           a1,
           v2,
           v3,
           v4);
}

// sub_40E3A0 @ 0x0040E3A0
int __stdcall sub_40E3A0(int a1, int a2)
{
  int v3; // [esp+4h] [ebp-Ch]
  int v4; // [esp+8h] [ebp-8h]
  int v5; // [esp+Ch] [ebp-4h]

  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    a2,
    v3,
    v4,
    v5);
  return (*(int (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
           grim_interface_ptr,
           19,
           a1,
           v3,
           v4,
           v5);
}

// sub_40E3E0 @ 0x0040E3E0
int sub_40E3E0()
{
  int result; // eax

  result = (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  byte_4824D0 = 1;
  return result;
}

// sub_40E400 @ 0x0040E400
int sub_40E400()
{
  int result; // eax

  result = (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  byte_4824D0 = 0;
  return result;
}

// sub_40E420 @ 0x0040E420
char __stdcall sub_40E420(int a1, int a2, int a3, int a4)
{
  char result; // al

  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    grim_interface_ptr,
    a1,
    a2,
    a3,
    a4);
  result = byte_4824D0;
  if ( !byte_4824D0 )
    return (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  return result;
}

// sub_40E470 @ 0x0040E470
char __stdcall sub_40E470(int a1, int a2, int a3, int a4, int a5)
{
  char result; // al

  (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, a5);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 292))(
    grim_interface_ptr,
    a1,
    a2,
    a3,
    a4);
  result = byte_4824D0;
  if ( !byte_4824D0 )
    return (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  return result;
}

// sub_40E4C0 @ 0x0040E4C0
char __stdcall sub_40E4C0(int a1, int a2)
{
  char result; // al
  _DWORD v3[2]; // [esp+0h] [ebp-8h] BYREF

  if ( !byte_4824D0 )
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v3[0] = 0;
  v3[1] = 0;
  (*(void (__thiscall **)(int, int, int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 300))(
    grim_interface_ptr,
    a1,
    a2,
    v3);
  result = byte_4824D0;
  if ( !byte_4824D0 )
    return (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  return result;
}

// sub_40E530 @ 0x0040E530
int __stdcall sub_40E530(const char *a1)
{
  char Buffer[260]; // [esp+0h] [ebp-104h] BYREF

  crt_sprintf(Buffer, "mods\\%s", a1);
  return sfx_load_sample(Buffer);
}

// sub_40E560 @ 0x0040E560
int __stdcall sub_40E560(int a1)
{
  return sfx_release_sample(a1);
}

// sub_40E570 @ 0x0040E570
int __stdcall sub_40E570(int a1, float a2, float a3)
{
  int v4[2]; // [esp+0h] [ebp-8h] BYREF

  *(float *)v4 = a2 * 512.0;
  v4[1] = 0;
  return sfx_play_panned(a1, (int)v4, a3);
}

// sub_40E5B0 @ 0x0040E5B0
int __stdcall sub_40E5B0(const char *a1)
{
  char Buffer[260]; // [esp+0h] [ebp-104h] BYREF

  crt_sprintf(Buffer, "mods\\%s", a1);
  return music_load_track((size_t)Buffer);
}

// sub_40E5E0 @ 0x0040E5E0
int __stdcall sub_40E5E0(int a1)
{
  return music_release_track(a1);
}

// sub_40E5F0 @ 0x0040E5F0
int __stdcall sub_40E5F0(int a1)
{
  return sfx_play_exclusive(a1);
}

// sub_40E600 @ 0x0040E600
int __stdcall sub_40E600(int a1)
{
  return sfx_mute_all(a1);
}

// sub_40E610 @ 0x0040E610
int sub_40E610()
{
  return (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 80))(grim_interface_ptr);
}

// sub_40E620 @ 0x0040E620
double __stdcall sub_40E620(int a1)
{
  double result; // st7

  if ( a1 == 355 )
    return ui_mouse_x;
  if ( a1 == 356 )
    return ui_mouse_y;
  (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 132))(grim_interface_ptr, a1);
  return result;
}

// sub_40E660 @ 0x0040E660
char __stdcall sub_40E660(int a1)
{
  if ( a1 == 1 )
    return 0;
  else
    return (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(grim_interface_ptr, a1);
}

// sub_40E680 @ 0x0040E680
char *__stdcall sub_40E680(int a1)
{
  return input_key_name(a1);
}

// FUN_0040e690 @ 0x0040E690
// [binja] void __stdcall sub_40e690(char* arg1)
void __stdcall sub_40E690(const char *a1)
{
  if ( a1 && !strcmp(aGamePause, a1) )
  {
    if ( plugin_interface_ptr )
      *(_BYTE *)(plugin_interface_ptr + 9) = 1;
    ui_transition_direction = 0;
    game_state_pending = 5;
  }
}

// mod_load_info @ 0x0040E700
// loads mods\%s, calls CMOD_GetInfo, copies the info struct to DAT_00481c88, and returns it
char *__cdecl sub_40E700(const char *a1)
{
  HMODULE LibraryA; // eax
  int (*CMOD_GetInfo)(void); // esi
  const void *v4; // eax
  CHAR LibFileName[512]; // [esp+4h] [ebp-200h] BYREF

  crt_sprintf(LibFileName, "mods\\%s", a1);
  console_printf((int)&console_log_queue, "CMOD: '%s'\n", LibFileName);
  LibraryA = LoadLibraryA(LibFileName);
  hLibModule = LibraryA;
  if ( LibraryA )
  {
    CMOD_GetInfo = GetProcAddress(LibraryA, ProcName);
    if ( CMOD_GetInfo )
    {
      if ( (byte_4819C8 & 1) == 0 )
      {
        dword_481CC8 = 1065353216;
        dword_481CCC = 3;
        memset(mod_info_block, 0, sizeof(mod_info_block));
        memset(&unk_481CA8, 0, 0x20u);
        byte_4819C8 |= 1u;
        crt_atexit(nullsub_21);
      }
      v4 = (const void *)CMOD_GetInfo();
      if ( v4 )
        qmemcpy(mod_info_block, v4, 0x48u);
      else
        console_printf((int)&console_log_queue, aCmodBadCmodGet);
      FreeLibrary(hLibModule);
      console_printf((int)&console_log_queue, "CMOD: mod enum '%s'\n", mod_info_block);
      return mod_info_block;
    }
    else
    {
      console_printf((int)&console_log_queue, aCmodGetinfoFai);
      FreeLibrary(hLibModule);
      return 0;
    }
  }
  else
  {
    console_printf((int)&console_log_queue, aCmodLoadLibrar);
    return 0;
  }
}

// nullsub_21 @ 0x0040E850
void __cdecl nullsub_21()
{
  ;
}

// mod_load_mod @ 0x0040E860
// loads mods\%s, calls CMOD_GetMod, wires the mod context (offset +4), and returns the mod interface pointer
int __cdecl sub_40E860(const char *a1)
{
  HMODULE LibraryA; // eax
  int (*CMOD_GetMod)(void); // eax
  int v4; // eax
  int v5; // esi
  CHAR LibFileName[512]; // [esp+0h] [ebp-200h] BYREF

  crt_sprintf(LibFileName, "mods\\%s", a1);
  console_printf((int)&console_log_queue, "CMOD: '%s'\n", LibFileName);
  LibraryA = LoadLibraryA(LibFileName);
  hLibModule = LibraryA;
  if ( LibraryA )
  {
    CMOD_GetMod = GetProcAddress(LibraryA, aCmodGetmod);
    if ( CMOD_GetMod )
    {
      v4 = CMOD_GetMod();
      v5 = v4;
      if ( v4 )
        *(_DWORD *)(v4 + 4) = &mod_api_context;
      else
        console_printf((int)&console_log_queue, aCmodBadCmodGet_0);
      console_printf((int)&console_log_queue, aCmodGetmodOk);
      return v5;
    }
    else
    {
      console_printf((int)&console_log_queue, aCmodCmodGetmod);
      FreeLibrary(hLibModule);
      return 0;
    }
  }
  else
  {
    console_printf((int)&console_log_queue, aCmodLoadLibrar);
    return 0;
  }
}

// mods_any_available @ 0x0040E940
// returns true if any mods\*.dll exist
BOOL sub_40E940()
{
  int v0; // edi
  void *v1; // esi
  int v3; // [esp+0h] [ebp-120h] BYREF
  int v4[5]; // [esp+8h] [ebp-118h] BYREF

  v0 = 0;
  v1 = (void *)crt_findfirst(FileName, (int)v4);
  if ( v1 != (void *)-1 && &v3 != (int *)-28 )
  {
    do
      ++v0;
    while ( !crt_findnext(v1, (int)v4) );
  }
  crt_findclose((intptr_t)v1);
  return v0 != 0;
}

// sub_40E9A0 @ 0x0040E9A0
int sub_40E9A0()
{
  int v0; // edx
  intptr_t v1; // ebp
  int v2; // edx
  char *v3; // ebp
  char *v4; // edi
  int v5; // eax
  int v6; // esi
  int v7; // esi
  int v8; // esi
  int v9; // esi
  _DWORD *v10; // ecx
  int *v11; // eax
  int v12; // edx
  int result; // eax
  float v14; // [esp+FCh] [ebp-164h]
  float v15; // [esp+FCh] [ebp-164h]
  float v16; // [esp+FCh] [ebp-164h]
  int v17; // [esp+100h] [ebp-160h]
  float v18; // [esp+100h] [ebp-160h]
  int v19; // [esp+100h] [ebp-160h]
  float v20; // [esp+100h] [ebp-160h]
  int v21; // [esp+104h] [ebp-15Ch]
  float v22; // [esp+104h] [ebp-15Ch]
  int v23; // [esp+104h] [ebp-15Ch]
  float v24; // [esp+104h] [ebp-15Ch]
  double v25; // [esp+108h] [ebp-158h] BYREF
  float v26; // [esp+11Ch] [ebp-144h] BYREF
  float v27; // [esp+120h] [ebp-140h]
  float v28; // [esp+124h] [ebp-13Ch]
  float v29; // [esp+128h] [ebp-138h] BYREF
  float v30; // [esp+12Ch] [ebp-134h] BYREF
  float v31; // [esp+130h] [ebp-130h]
  float v32; // [esp+134h] [ebp-12Ch]
  char v33[4]; // [esp+138h] [ebp-128h] BYREF
  int v34; // [esp+13Ch] [ebp-124h]
  int v35; // [esp+140h] [ebp-120h]
  int v36; // [esp+144h] [ebp-11Ch]
  int v37; // [esp+148h] [ebp-118h] BYREF
  char Buffer[16]; // [esp+14Ch] [ebp-114h] BYREF
  char v39[260]; // [esp+15Ch] [ebp-104h] BYREF

  v27 = flt_489DFC + flt_48A138;
  v31 = flt_48A134 + flt_489DF8 + 300.0;
  v32 = v27 + 40.0;
  v26 = flt_489DE8 - 240.0 + v31 + 64.0;
  v31 = v26;
  v27 = v32 + 4.0;
  v0 = *(_DWORD *)grim_interface_ptr;
  v32 = v27;
  (*(void (__thiscall **)(int, int, int, int, int))(v0 + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1065353216,
    v17,
    v21,
    LODWORD(v25));
  v22 = v27 - 8.0;
  v18 = v26 - 16.0 + 144.0;
  (*(void (__stdcall **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 320))(
    grim_interface_ptr,
    LODWORD(v18),
    LODWORD(v22),
    aMods);
  v25 = 0.00003051757812500016;
  (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 24);
  v27 = v27 + 32.0;
  if ( byte_472EE8 )
  {
    dword_4824DC = 0;
    v1 = crt_findfirst(FileName, (int)&v37);
    v28 = *(float *)&v1;
    if ( v1 != -1 && (double *)((char *)&v25 + 4) != (double *)-80 )
    {
      do
      {
        v2 = dword_4824DC;
        if ( dword_4824DC == 31 )
        {
          dword_481B84 = (int)byte_482490;
          strcpy(byte_481988, aMore);
          strcpy(byte_482490, aMore);
        }
        else
        {
          strcpy(&byte_4811C8[64 * dword_4824DC], v39);
          v3 = (char *)&unk_481CD0 + 64 * v2;
          v4 = mod_load_info(v39);
          v5 = dword_4824DC;
          strcpy(v3, v4);
          dword_481B04[++v5] = (int)v3;
          v1 = LODWORD(v28);
          dword_4824DC = v5;
        }
      }
      while ( !crt_findnext((HANDLE)v1, (int)&v37) );
    }
    crt_findclose(v1);
    byte_472EE8 = 0;
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1061997773);
  (*(void (__thiscall **)(int, int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v19,
    v23,
    LODWORD(v25));
  if ( (byte_481BB8 & 1) == 0 )
  {
    dword_481BE8 = 0;
    byte_481BB8 |= 1u;
    dword_481BEC = 0;
    crt_atexit(nullsub_24);
  }
  dword_481C08 = (int)&unk_481B08;
  dword_481C0C = dword_4824DC;
  dword_481BE4 = 5;
  v26 = v26 + 4.0;
  v27 = v27 + 6.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1056964608);
  v24 = v27 - 14.0;
  (*(void (__cdecl **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v26)),
    LODWORD(v24),
    aListOfMods);
  ui_scrollbar_update(&v26, &unk_481BD8);
  if ( dword_481BE0 != dword_472EEC )
  {
    dword_472EEC = dword_481BE0;
    dword_4824E0 = (int)mod_load_info(&byte_4811C8[64 * dword_481BE0]);
  }
  v27 = v27 + 104.0;
  if ( dword_4824E0 )
  {
    (*(void (__thiscall **)(int, int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1056964608,
      HIDWORD(v25));
    v34 = dword_4965F8;
    v35 = dword_4965FC;
    v28 = v28 + 8.0;
    v36 = dword_496600;
    v37 = 1065353216;
    v25 = 0.007187501520093065;
    v27 = v27 + 12.0 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065185444);
    HIDWORD(v25) = dword_4824E0;
    (*(void (__cdecl **)(int, float, float))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v27)),
      COERCE_FLOAT(LODWORD(v28)));
    crt_sprintf(Buffer, "v%.2f", *(float *)(dword_4824E0 + 64));
    v6 = *(_DWORD *)grim_interface_ptr;
    HIDWORD(v25) = Buffer;
    v29 = v27 + 192.0;
    v29 = COERCE_FLOAT(
            (*(int (__thiscall **)(int, char *, float, char *, char *))(v6 + 332))(
              grim_interface_ptr,
              Buffer,
              COERCE_FLOAT(LODWORD(v28)),
              aS_0,
              Buffer));
    v14 = v28 - (double)SLODWORD(v29);
    (*(void (__cdecl **)(int, _DWORD))(v6 + 328))(grim_interface_ptr, LODWORD(v14));
    v27 = v27 + 14.0;
    (*(void (__thiscall **)(int, char *, _DWORD))(*(_DWORD *)grim_interface_ptr + 272))(
      grim_interface_ptr,
      v33,
      HIDWORD(v25));
    v25 = 0.007812501958142093;
    v30 = v27 - 4.0;
    v31 = v28;
    (*(void (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
      grim_interface_ptr,
      &v30,
      1128792064,
      1065353216);
    v25 = 0.0000008964540247902164;
    v28 = v28 - 2.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1051595899);
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v27)),
      COERCE_FLOAT(LODWORD(v28)),
      aName);
    v7 = *(_DWORD *)grim_interface_ptr;
    HIDWORD(v25) = aVersion;
    v29 = v27 + 192.0;
    v29 = COERCE_FLOAT(
            (*(int (__thiscall **)(int, char *, float, char *))(v7 + 332))(
              grim_interface_ptr,
              aVersion,
              COERCE_FLOAT(LODWORD(v28)),
              aVersion));
    v20 = v28 - (double)SLODWORD(v29);
    (*(void (__cdecl **)(int, _DWORD))(v7 + 328))(grim_interface_ptr, LODWORD(v20));
    (*(void (__thiscall **)(int, int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051,
      HIDWORD(v25));
    HIDWORD(v25) = aAuthorS;
    v28 = v28 + 22.0;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v27)),
      COERCE_FLOAT(LODWORD(v28)),
      aAuthorS);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1064682127);
    v8 = *(_DWORD *)grim_interface_ptr;
    HIDWORD(v25) = dword_4824E0 + 32;
    v29 = v27 + 192.0;
    v29 = COERCE_FLOAT(
            (*(int (__thiscall **)(int, int, float, char *, int))(v8 + 332))(
              grim_interface_ptr,
              dword_4824E0 + 32,
              COERCE_FLOAT(LODWORD(v28)),
              aS_0,
              dword_4824E0 + 32));
    v15 = v28 - (double)SLODWORD(v29);
    (*(void (__cdecl **)(int, _DWORD))(v8 + 328))(grim_interface_ptr, LODWORD(v15));
    v27 = v27 + 15.0;
    (*(void (__thiscall **)(int, int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051,
      HIDWORD(v25));
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v27)),
      COERCE_FLOAT(LODWORD(v28)),
      aFilename);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1064682127);
    v9 = *(_DWORD *)grim_interface_ptr;
    v29 = v27 + 192.0;
    v29 = COERCE_FLOAT(
            (*(int (__thiscall **)(int, char *, float, char *, char *))(v9 + 332))(
              grim_interface_ptr,
              &byte_4811C8[64 * dword_481BE0],
              COERCE_FLOAT(LODWORD(v28)),
              aS_0,
              &byte_4811C8[64 * dword_481BE0]));
    v16 = v28 - (double)SLODWORD(v29);
    (*(void (__cdecl **)(int, _DWORD))(v9 + 328))(grim_interface_ptr, LODWORD(v16));
    v27 = v27 + 15.0;
    if ( *(_DWORD *)(dword_4824E0 + 68) != 3 )
    {
      (*(void (__thiscall **)(int, int, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        0,
        0,
        1065353216);
      (*(void (__cdecl **)(int, float, float, char *, int))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v26)),
        COERCE_FLOAT(LODWORD(v27)),
        aUnsupportedApi,
        dword_4824E0 + 32);
    }
    v27 = v27 + 15.0 + 15.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1058642330);
    v26 = v26 - 16.0 - 16.0;
    v27 = v27 + 32.0;
  }
  if ( (byte_481BB8 & 2) == 0 )
  {
    byte_481AF6 = 1;
    byte_481BB8 |= 2u;
    LOWORD(dword_481B04[0]) = 0;
    dword_481B00 = 1065353216;
    dword_481AFC = 0;
    dword_481AF0 = 0;
    byte_481AF4 = 0;
    byte_481AF5 = 0;
    dword_481AF8 = 0;
    crt_atexit(nullsub_23);
  }
  dword_481AF0 = (int)aMainMenu_0;
  if ( (byte_481BB8 & 4) == 0 )
  {
    byte_481B8E = 1;
    byte_481BB8 |= 4u;
    byte_481B9D = 0;
    byte_481B9C = 0;
    dword_481B98 = 1065353216;
    dword_481B94 = 0;
    dword_481B88 = 0;
    byte_481B8C = 0;
    byte_481B8D = 0;
    dword_481B90 = 0;
    crt_atexit(nullsub_22);
  }
  dword_481B88 = (int)aLaunch;
  if ( dword_4824E0 )
  {
    if ( *(_DWORD *)(dword_4824E0 + 68) == 3 )
    {
      v29 = v31 + 58.0;
      v30 = v32 + 232.0;
      if ( (unsigned __int8)ui_button_update(&v29, &dword_481B88) )
      {
        if ( dword_481BE0 >= 0 )
        {
          plugin_interface_ptr = mod_load_mod(&byte_4811C8[64 * dword_481BE0]);
          if ( plugin_interface_ptr )
          {
            game_state_pending = 22;
            ui_transition_direction = 0;
            v10 = &unk_481A90;
            v11 = &player_move_key_backward;
            do
            {
              v12 = *(v11 - 1);
              v11 += 216;
              *(v10 - 2) = v12;
              *v10 = *(v11 - 216);
              v10[2] = *(v11 - 215);
              v10[4] = *(v11 - 214);
              v10[6] = *(v11 - 213);
              v10[8] = *(v11 - 210);
              v10[10] = *(v11 - 209);
              v10[12] = *(v11 - 208);
              v10[14] = *(v11 - 207);
              v10[16] = *(v11 - 206);
              v10[18] = *(v11 - 205);
              ++v10;
            }
            while ( (int)v11 < (int)dword_4912A0 );
            dword_481AE0 = config_key_pick_perk;
            dword_481AE4 = config_key_reload;
          }
        }
      }
    }
  }
  v29 = v31 + 58.0;
  v30 = v32 + 266.0;
  result = ui_button_update(&v29, &dword_481AF0);
  if ( (_BYTE)result )
  {
    ui_transition_direction = 0;
    game_state_pending = 0;
    byte_472EE8 = 1;
  }
  return result;
}

// nullsub_22 @ 0x0040F3D0
void __cdecl nullsub_22()
{
  ;
}

// nullsub_23 @ 0x0040F3E0
void __cdecl nullsub_23()
{
  ;
}

// nullsub_24 @ 0x0040F3F0
void __cdecl nullsub_24()
{
  ;
}

// credits_secret_match3_find @ 0x0040F400
// scans a 6x6 board for a 3-in-a-row match; writes start index (row-major; leftmost/topmost) + orientation (0=vertical, 1=horizontal)
char __cdecl sub_40F400(int *a1, _DWORD *a2, _BYTE *a3)
{
  int *v3; // edi
  int *v4; // ebx
  int v5; // edx
  int i; // ecx
  int v7; // eax
  int v8; // esi
  int v9; // ebx
  int v10; // esi
  int *v11; // eax
  int v12; // ecx
  int v13; // edx
  int v15; // [esp+10h] [ebp-4h]

  v3 = a1;
  v15 = 0;
  v4 = a1;
  v5 = 2;
  while ( 2 )
  {
    for ( i = 0; i < 4; ++i )
    {
      v7 = *v4;
      if ( *v4 >= 0 )
      {
        v8 = 1;
        if ( v3[v5 - 1 + i] == v7 )
          v8 = 2;
        if ( v3[v5 + i] == v7 )
          ++v8;
        if ( v8 == 3 )
        {
          *a2 = i + 6 * v15;
          *a3 = 1;
          return 1;
        }
      }
      ++v4;
    }
    v5 += 6;
    ++v15;
    v4 = a1 + 6;
    a1 += 6;
    if ( v5 < 38 )
      continue;
    break;
  }
  v9 = 0;
  while ( 2 )
  {
    v10 = 0;
    v11 = v3;
    do
    {
      v12 = *v11;
      if ( *v11 >= 0 )
      {
        v13 = 1;
        if ( v11[6] == v12 )
          v13 = 2;
        if ( v11[12] == v12 )
          ++v13;
        if ( v13 == 3 )
        {
          *a2 = v9 + 6 * v10;
          *a3 = 0;
          return 1;
        }
      }
      ++v10;
      v11 += 6;
    }
    while ( v10 < 4 );
    ++v9;
    ++v3;
    if ( v9 < 6 )
      continue;
    break;
  }
  return 0;
}

// credits_secret_alien_zookeeper_update @ 0x0040F4F0
// updates and renders the AlienZooKeeper credits secret; drives match-3 board state and UI
int sub_40F4F0()
{
  int v0; // edx
  bool v1; // sf
  int v2; // esi
  int v3; // edi
  int *v4; // esi
  int v5; // ebp
  int v6; // eax
  int v7; // eax
  int v8; // ecx
  bool v9; // zf
  int v10; // eax
  int *v11; // esi
  int v12; // edi
  int *v13; // esi
  int v14; // edi
  int result; // eax
  float v16; // [esp+144h] [ebp-74h]
  float v17; // [esp+144h] [ebp-74h]
  int v18; // [esp+148h] [ebp-70h]
  float v19; // [esp+148h] [ebp-70h]
  float v20; // [esp+148h] [ebp-70h]
  int v21; // [esp+148h] [ebp-70h]
  float v22; // [esp+148h] [ebp-70h]
  float v23; // [esp+148h] [ebp-70h]
  float v24; // [esp+148h] [ebp-70h]
  int v25; // [esp+148h] [ebp-70h]
  float v26; // [esp+148h] [ebp-70h]
  int v27; // [esp+14Ch] [ebp-6Ch]
  float v28; // [esp+14Ch] [ebp-6Ch]
  float v29; // [esp+14Ch] [ebp-6Ch]
  float v30; // [esp+14Ch] [ebp-6Ch]
  int v31; // [esp+14Ch] [ebp-6Ch]
  int v32; // [esp+14Ch] [ebp-6Ch]
  float v33; // [esp+14Ch] [ebp-6Ch]
  int v34; // [esp+150h] [ebp-68h]
  int v35; // [esp+150h] [ebp-68h]
  int v36; // [esp+150h] [ebp-68h]
  int v37; // [esp+164h] [ebp-54h] BYREF
  int v38; // [esp+168h] [ebp-50h]
  int v39; // [esp+16Ch] [ebp-4Ch]
  int v40; // [esp+170h] [ebp-48h] BYREF
  float v41; // [esp+174h] [ebp-44h]
  float v42; // [esp+178h] [ebp-40h] BYREF
  float v43; // [esp+17Ch] [ebp-3Ch]
  int v44; // [esp+180h] [ebp-38h] BYREF
  float v45; // [esp+184h] [ebp-34h]
  float v46; // [esp+188h] [ebp-30h] BYREF
  float v47; // [esp+18Ch] [ebp-2Ch]
  float v48; // [esp+190h] [ebp-28h]
  float v49; // [esp+194h] [ebp-24h]
  float v50; // [esp+198h] [ebp-20h] BYREF
  float v51; // [esp+19Ch] [ebp-1Ch]
  float v52; // [esp+1A4h] [ebp-14h]
  int v53; // [esp+1A8h] [ebp-10h] BYREF
  float v54; // [esp+1ACh] [ebp-Ch]
  int v55; // [esp+1B0h] [ebp-8h]
  int v56; // [esp+1B4h] [ebp-4h]

  v51 = flt_489DFC + flt_489E20;
  *(float *)&v44 = flt_489E1C + flt_489DF8 + 300.0;
  v45 = v51 + 40.0;
  v46 = *(float *)&v44 + flt_489DE8 - 80.0;
  v48 = v46;
  v47 = v45 + 10.0;
  v0 = *(_DWORD *)grim_interface_ptr;
  v49 = v47;
  (*(void (__thiscall **)(int, int, int, int, int))(v0 + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1061997773,
    v18,
    v27,
    v34);
  v28 = v47 - 14.0;
  (*(void (__stdcall **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v46)),
    LODWORD(v28),
    aAlienzookeeper);
  (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 24);
  v29 = v47 + 10.0;
  v19 = v46 + 12.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v19),
    LODWORD(v29),
    aAPuzzleGameUnf);
  v30 = v47 + 23.0;
  v20 = v46 + 18.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v20),
    LODWORD(v30),
    aOrSomethingMor);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1061997773);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1054280253,
    v21,
    v31,
    v35);
  v1 = credits_secret_timer_ms < 0;
  credits_secret_anim_time_ms += frame_dt_ms;
  if ( credits_secret_timer_ms > 0 )
  {
    credits_secret_timer_ms -= frame_dt_ms;
    if ( credits_secret_timer_ms > 0 )
      goto LABEL_6;
    sfx_play(sfx_trooper_die_01, 1.0);
    v1 = credits_secret_timer_ms < 0;
  }
  if ( v1 )
    credits_secret_timer_ms = 0;
LABEL_6:
  v47 = v47 + 40.0;
  v46 = v46 + 22.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1060320051);
  v22 = v47 - 16.0;
  v16 = v46 + 124.0;
  (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v16),
    LODWORD(v22),
    aScoreD,
    credits_secret_score);
  v53 = 0;
  v54 = 0.0;
  v55 = 0;
  v56 = 1058642330;
  (*(void (__thiscall **)(int, float *, int, int, int *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    &v46,
    1128267776,
    1128267776,
    &v53);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
    grim_interface_ptr,
    &v46,
    1128267776,
    1128267776);
  v44 = credits_secret_timer_ms / 100;
  if ( credits_secret_timer_ms / 100 > 192 )
    v44 = 192;
  v42 = v46;
  v43 = v47 + 200.0;
  v53 = 1045220557;
  v54 = 0.60000002;
  v55 = 1065353216;
  v23 = (float)v44;
  v56 = 1058642330;
  (*(void (__thiscall **)(int, float *, _DWORD, int, int *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    &v42,
    LODWORD(v23),
    1086324736,
    &v53);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  *(float *)&v44 = v46;
  v45 = v47 + 200.0;
  (*(void (__thiscall **)(int, int *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
    grim_interface_ptr,
    &v44,
    1128267776,
    1086324736);
  v39 = 0;
  v2 = 0;
  do
  {
    v3 = 0;
    v38 = 0;
    do
    {
      if ( credits_secret_selected_index == v2 )
      {
        v53 = 1045220557;
        v51 = (float)v39;
        v54 = 0.40000001;
        v55 = 1060320051;
        v56 = 1053609165;
        v43 = v51 * 32.0;
        v41 = v43 + v47;
        *(float *)&v44 = (double)v38 * 32.0 + v46 + 4.0;
        v45 = v41 + 4.0;
        (*(void (__thiscall **)(int, int *, int, int, int *))(*(_DWORD *)grim_interface_ptr + 208))(
          grim_interface_ptr,
          &v44,
          1103101952,
          1103101952,
          &v53);
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          1065353216);
        (*(void (__thiscall **)(int, int *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
          grim_interface_ptr,
          &v44,
          1103101952,
          1103101952);
      }
      ++v3;
      ++v2;
      v38 = v3;
    }
    while ( v3 < 6 );
    ++v39;
  }
  while ( v2 < 36 );
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_4827B0, 0);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  v39 = 0;
  *(float *)&v44 = 0.0;
  v42 = 0.0;
  v4 = credits_secret_board;
  do
  {
    v5 = 0;
    v38 = 0;
    v40 = 0;
    do
    {
      if ( *v4 != -3 )
      {
        (*(void (__stdcall **)(int, int))(*(_DWORD *)grim_interface_ptr + 260))(
          8,
          (credits_secret_anim_time_ms / 50 + 2 * *v4) % 32);
        v6 = *v4;
        if ( *v4 )
        {
          switch ( v6 )
          {
            case 1:
              (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
                grim_interface_ptr,
                1056964608,
                1056964608,
                1065353216,
                1065353216);
              break;
            case 2:
              (*(void (__stdcall **)(int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
                1065353216,
                1056964608,
                1065353216,
                1065353216);
              break;
            case 3:
              (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
                grim_interface_ptr,
                1056964608,
                1065353216,
                1065353216,
                1065353216);
              break;
            case 4:
              (*(void (__stdcall **)(int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
                1065353216,
                1065353216,
                1056964608,
                1065353216);
              break;
          }
        }
        else
        {
          (*(void (__stdcall **)(int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
            1065353216,
            1056964608,
            1056964608,
            1065353216);
        }
        v24 = (double)v44 + v47;
        v17 = (double)v40 + v46;
        (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
          LODWORD(v17),
          LODWORD(v24),
          1107296256,
          1107296256);
        if ( credits_secret_timer_ms > 0 )
        {
          v52 = (float)v39;
          v54 = v52 * 32.0;
          v50 = (double)v38 * 32.0 + v46;
          v51 = v54 + v47;
          if ( ui_mouse_inside_rect(&v50, 32, 32) )
          {
            if ( (unsigned __int8)input_primary_just_pressed() )
            {
              sfx_play(sfx_ui_clink_01, 1.0);
              v7 = credits_secret_selected_index;
              if ( credits_secret_selected_index == -1 )
              {
                credits_secret_selected_index = v38 + LODWORD(v42);
              }
              else
              {
                v8 = *v4;
                *v4 = credits_secret_board[credits_secret_selected_index];
                credits_secret_board[v7] = v8;
                credits_secret_selected_index = -1;
                v40 = 0;
                HIBYTE(v37) = 0;
                if ( credits_secret_match3_find(credits_secret_board, &v40, (_BYTE *)&v37 + 3) )
                {
                  v9 = HIBYTE(v37) == 0;
                  v10 = v40;
                  credits_secret_board[v40] = -3;
                  if ( v9 )
                  {
                    credits_secret_match_mask_v0[v10] = -3;
                    credits_secret_match_mask_v1[v10] = -3;
                  }
                  else
                  {
                    credits_secret_match_mask_h0[v10] = -3;
                    credits_secret_match_mask_h1[v10] = -3;
                  }
                  ++credits_secret_score;
                  sfx_play(sfx_ui_bonus, 1.0);
                  credits_secret_timer_ms += 2000;
                }
              }
            }
          }
        }
      }
      v5 += 32;
      ++v4;
      ++v38;
      v40 = v5;
    }
    while ( v5 < 192 );
    ++v39;
    LODWORD(v42) += 6;
    v44 += 32;
  }
  while ( (int)v4 < (int)&dword_481A7C );
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  if ( !credits_secret_timer_ms )
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      1065353216,
      v25,
      v32,
      v36);
    if ( cos((double)credits_secret_anim_time_ms * 0.0049999999) > 0.0 )
    {
      v33 = v47 + 96.0 - 22.0;
      v26 = v46 + 38.0;
      (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v26),
        LODWORD(v33),
        aGameOver);
    }
  }
  v11 = credits_secret_board;
  do
  {
    v12 = 6;
    do
    {
      if ( *v11 == -1 )
        *v11 = crt_rand() % 5;
      ++v11;
      --v12;
    }
    while ( v12 );
  }
  while ( (int)v11 < (int)&dword_481A7C );
  if ( (credits_secret_flags & 1) == 0 )
  {
    byte_4819D6 = 1;
    credits_secret_flags |= 1u;
    byte_4819E5 = 0;
    byte_4819E4 = 0;
    dword_4819E0 = 1065353216;
    dword_4819DC = 0;
    credits_secret_reset_button = 0;
    byte_4819D4 = 0;
    byte_4819D5 = 0;
    dword_4819D8 = 0;
    crt_atexit(nullsub_26);
  }
  credits_secret_reset_button = (int)aReset;
  v50 = v48 + 38.0;
  v42 = v49 + 256.0;
  v51 = v42;
  if ( (unsigned __int8)ui_button_update(&v50, &credits_secret_reset_button) )
  {
    *(float *)&v44 = 0.0;
    HIBYTE(v37) = 0;
    do
    {
      v13 = credits_secret_board;
      do
      {
        v14 = 6;
        do
        {
          ++v13;
          --v14;
          *(v13 - 1) = crt_rand() % 5;
        }
        while ( v14 );
      }
      while ( (int)v13 < (int)&dword_481A7C );
    }
    while ( credits_secret_match3_find(credits_secret_board, &v44, (_BYTE *)&v37 + 3) );
    credits_secret_selected_index = -1;
    credits_secret_score = 0;
    credits_secret_timer_ms = 9600;
  }
  if ( (credits_secret_flags & 2) == 0 )
  {
    byte_481BC6 = 1;
    credits_secret_flags |= 2u;
    byte_481BD5 = 0;
    byte_481BD4 = 0;
    dword_481BD0 = 1065353216;
    dword_481BCC = 0;
    credits_secret_back_button = 0;
    byte_481BC4 = 0;
    byte_481BC5 = 0;
    dword_481BC8 = 0;
    crt_atexit(nullsub_25);
  }
  v50 = v48 + 138.0;
  credits_secret_back_button = (int)aBack_0;
  v51 = v42;
  result = ui_button_update(&v50, &credits_secret_back_button);
  if ( (_BYTE)result )
  {
    ui_transition_direction = 0;
    game_state_pending = 4;
  }
  return result;
}

// nullsub_25 @ 0x0040FF30
void __cdecl nullsub_25()
{
  ;
}

// nullsub_26 @ 0x0040FF40
void __cdecl nullsub_26()
{
  ;
}

// FUN_0040ff50 @ 0x0040FF50
// [binja] int32_t sub_40ff50(int32_t arg1)
char *__cdecl sub_40FF50(int a1)
{
  int v2; // [esp+0h] [ebp-4h]

  v2 = a1 % 60;
  if ( a1 % 60 >= 10 )
    crt_sprintf(byte_482624, "%d:%d", a1 / 60, v2);
  else
    crt_sprintf(byte_482624, "%d:0%d", a1 / 60, v2);
  return byte_482624;
}

// game_over_screen_update @ 0x0040FFC0
// game over flow: high score entry, results text, and navigation buttons
int sub_40FFC0()
{
  signed int v0; // eax
  unsigned int v1; // kr08_4
  double v3; // st7
  double v4; // st7
  float v5; // [esp+0h] [ebp-38h]
  float v6; // [esp+4h] [ebp-34h]
  int v7; // [esp+10h] [ebp-28h]
  int v8; // [esp+14h] [ebp-24h]
  int v9; // [esp+18h] [ebp-20h]
  int v10; // [esp+1Ch] [ebp-1Ch]
  int v11; // [esp+20h] [ebp-18h] BYREF
  float v12; // [esp+24h] [ebp-14h]
  int v13; // [esp+28h] [ebp-10h] BYREF
  float v14; // [esp+2Ch] [ebp-Ch]
  float v15; // [esp+30h] [ebp-8h]
  float v16; // [esp+34h] [ebp-4h]

  if ( (byte_4825FC & 1) == 0 )
  {
    byte_4825AE = 1;
    byte_4825FC |= 1u;
    byte_4825BD = 0;
    byte_4825BC = 0;
    dword_4825B8 = 1065353216;
    dword_4825B4 = 0;
    dword_4825A8 = 0;
    byte_4825AC = 0;
    byte_4825AD = 0;
    dword_4825B0 = 0;
    crt_atexit(nullsub_31);
  }
  if ( (byte_4825FC & 2) == 0 )
  {
    dword_4825A0 = 1065353216;
    byte_4825FC |= 2u;
    dword_482590 = (int)byte_48256C;
    dword_482594 = 0;
    dword_482598 = 24;
    dword_48259C = 96;
    crt_atexit(nullsub_30);
  }
  bonus_reflex_boost_timer = 0.0;
  if ( ui_transition_direction && byte_48724D )
  {
    byte_48724D = 0;
    dword_487234 = 1;
  }
  if ( game_state_id == 7
    && game_state_pending == 25
    && ui_transition_direction
    && !(unsigned __int8)sfx_is_unmuted(music_track_shortie_monk_id) )
  {
    sfx_play_exclusive(music_track_shortie_monk_id);
  }
  gameplay_render_world();
  ui_elements_update_and_render();
  perk_prompt_update_and_render();
  v16 = flt_48CC64 + flt_48CC88;
  *(float *)&v13 = flt_48CC84 + flt_48CC60 + 180.0;
  v14 = v16 + 40.0;
  v12 = v14;
  *(float *)&v11 = flt_48CC50 + *(float *)&v13 + 44.0 - 10.0;
  v15 = *(float *)&v11;
  ui_draw_textured_quad((__int64)(*(float *)&v11 - 2.0), (__int64)v14, 256, 64, dword_48F7F8);
  switch ( dword_487234 )
  {
    case -1:
      j_highscore_load_table();
      dword_4825A4 = highscore_rank_index();
      highscore_record_game_mode = config_game_mode;
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
      console_input_poll();
      (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28);
      if ( dword_4825A4 >= 100 )
      {
        dword_487234 = 1;
LABEL_29:
        v12 = v14;
        dword_482590 = (int)byte_48256C;
        *(float *)&v11 = v15 + 30.0;
        v3 = v14;
        if ( dword_4825A4 < 100 )
        {
          v4 = v3 + 64.0;
        }
        else
        {
          v12 = v3 + 62.0;
          v5 = *(float *)&v11 + 8.0;
          (*(void (**)(int, _DWORD, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
            grim_interface_ptr,
            LODWORD(v5),
            COERCE_FLOAT(LODWORD(v12)),
            aScoreTooLowFor,
            100);
          v4 = v12 + 6.0;
        }
        v12 = v4;
        v13 = v11;
        v14 = v12 + 16.0;
        ui_text_input_render((int)&v13, (int)highscore_active_record, 1.0, dword_4825A4 + 1, v7, v8, v9, v10);
        v12 = v12 + 146.0;
        if ( (byte_4825FC & 4) == 0 )
        {
          byte_48250E = 1;
          byte_4825FC |= 4u;
          byte_48251D = 0;
          byte_48251C = 0;
          dword_482518 = 1065353216;
          dword_482514 = 0;
          dword_482508 = 0;
          byte_48250C = 0;
          byte_48250D = 0;
          dword_482510 = 0;
          crt_atexit(nullsub_29);
        }
        dword_482508 = (int)aPlayAgain;
        if ( (byte_4825FC & 8) == 0 )
        {
          byte_482556 = 1;
          byte_4825FC |= 8u;
          byte_482565 = 0;
          byte_482564 = 0;
          dword_482560 = 1065353216;
          dword_48255C = 0;
          dword_482550 = 0;
          byte_482554 = 0;
          byte_482555 = 0;
          dword_482558 = 0;
          crt_atexit(nullsub_28);
        }
        dword_482550 = (int)aHighScores;
        if ( (byte_4825FC & 0x10) == 0 )
        {
          byte_48253E = 1;
          byte_4825FC |= 0x10u;
          byte_48254D = 0;
          byte_48254C = 0;
          dword_482548 = 1065353216;
          dword_482544 = 0;
          dword_482538 = 0;
          byte_48253C = 0;
          byte_48253D = 0;
          dword_482540 = 0;
          crt_atexit(nullsub_27);
        }
        dword_482538 = (int)aMainMenu;
        *(float *)&v11 = *(float *)&v11 - 4.0 + 26.0;
        ui_button_update(&v11, &dword_482508);
        v12 = v12 + 32.0;
        ui_button_update(&v11, &dword_482550);
        v12 = v12 + 32.0;
        ui_button_update(&v11, &dword_482538);
        v12 = v12 + 32.0;
        if ( byte_48250D )
        {
          ui_transition_direction = 0;
          game_state_pending = 9;
          if ( config_game_mode == 4 )
            game_state_pending = 18;
          sfx_mute_all(music_track_crimson_theme_id);
          sfx_mute_all(music_track_shortie_monk_id);
          sfx_mute_all(music_track_extra_0);
        }
        if ( byte_482555 )
        {
          dword_487258 = config_game_mode;
          byte_48724D = 1;
          dword_487250 = *(_DWORD *)quest_stage_major;
          dword_487254 = quest_stage_minor;
          byte_48725C = config_hardcore;
          ui_transition_direction = 0;
          game_state_pending = 14;
        }
        if ( byte_48253D )
        {
          sfx_mute_all(music_track_extra_0);
          sfx_mute_all(music_track_crimson_theme_id);
          sfx_mute_all(music_track_shortie_monk_id);
          sfx_play_exclusive(music_track_crimson_theme_id);
          ui_transition_direction = 0;
          game_state_pending = 0;
          byte_487292 = 0;
        }
        return ui_cursor_render();
      }
      dword_487234 = 0;
      dword_482598 = 20;
      dword_482590 = (int)strcpy(byte_48256C, highscore_active_record);
      dword_482594 = strlen(highscore_active_record);
      goto LABEL_18;
    case 0:
LABEL_18:
      flt_496604 = 1.0;
      *(float *)&v11 = *(float *)&v11 + 8.0;
      v12 = v12 + 84.0;
      (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4965F8);
      v6 = *(float *)&v11 + 42.0;
      (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v6),
        COERCE_FLOAT(LODWORD(v12)),
        aStateYourNameT);
      flt_496604 = 0.69999999;
      dword_4825A8 = (int)aOk;
      v12 = v12 + 40.0;
      *(float *)&v13 = *(float *)&v11 + 170.0;
      v14 = v12 - 8.0;
      ui_button_update(&v13, &dword_4825A8);
      dword_48259C = 166;
      if ( (unsigned __int8)ui_text_input_update(&v11, &dword_482590) || byte_4825AD )
      {
        v0 = 0;
        v1 = strlen(byte_48256C) + 1;
        if ( (int)(v1 - 1) < 1 )
          goto LABEL_25;
        do
        {
          if ( byte_48256C[v0] != 32 )
            break;
          ++v0;
        }
        while ( v0 < (int)(v1 - 1) );
        if ( byte_48256C[v0] )
        {
          dword_487234 = 1;
          sfx_play(sfx_ui_typeenter, 1.0);
          memset(highscore_active_record, 0, 0x1Cu);
          dword_482590 = (int)byte_48256C;
          strcpy(highscore_active_record, byte_48256C);
          player_name_length = dword_482594;
          highscore_active_record[dword_482594] = 0;
          highscore_save_active();
          j_highscore_load_table();
        }
        else
        {
LABEL_25:
          byte_4825AD = 0;
          sfx_play(sfx_shock_hit_01, 1.0);
        }
      }
      v12 = v12 + 60.0;
      (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4965F8);
      if ( dword_4825A4 < 100 )
      {
        *(float *)&v13 = *(float *)&v11 + 16.0;
        v14 = v12 + 16.0;
        ui_text_input_render((int)&v13, (int)highscore_active_record, 1.0, dword_4825A4 + 1, v7, v8, v9, v10);
        return ui_cursor_render();
      }
      return ui_cursor_render();
    case 1:
      goto LABEL_29;
  }
  return ui_cursor_render();
}

// nullsub_27 @ 0x00410790
void __cdecl nullsub_27()
{
  ;
}

// nullsub_28 @ 0x004107A0
void __cdecl nullsub_28()
{
  ;
}

// nullsub_29 @ 0x004107B0
void __cdecl nullsub_29()
{
  ;
}

// nullsub_30 @ 0x004107C0
void __cdecl nullsub_30()
{
  ;
}

// nullsub_31 @ 0x004107D0
void __cdecl nullsub_31()
{
  ;
}

// quest_failed_screen_update @ 0x004107E0
// quest failure screen: retry options and navigation
int sub_4107E0()
{
  double v0; // st7
  int v2; // [esp+0h] [ebp-24h]
  int v3; // [esp+4h] [ebp-20h]
  int v4; // [esp+8h] [ebp-1Ch]
  int v5; // [esp+Ch] [ebp-18h] BYREF
  float v6; // [esp+10h] [ebp-14h]
  int v7; // [esp+14h] [ebp-10h] BYREF
  float v8; // [esp+18h] [ebp-Ch]
  int v9; // [esp+1Ch] [ebp-8h]
  float v10; // [esp+20h] [ebp-4h]

  bonus_reflex_boost_timer = 0.0;
  if ( game_state_id == 12
    && game_state_pending == 25
    && ui_transition_direction
    && !(unsigned __int8)sfx_is_unmuted(music_track_shortie_monk_id) )
  {
    sfx_play_exclusive(music_track_shortie_monk_id);
  }
  gameplay_render_world();
  ui_elements_update_and_render();
  perk_prompt_update_and_render();
  v10 = flt_48DBDC + flt_48DC00;
  *(float *)&v7 = flt_48DBFC + flt_48DBD8 + 180.0;
  v8 = v10 + 40.0;
  v6 = v8;
  *(float *)&v5 = flt_48DBC8 + *(float *)&v7 + 44.0 - 10.0;
  v9 = v5;
  ui_draw_textured_quad((__int64)(*(float *)&v5 - 2.0), (__int64)v8, 256, 64, dword_48F7F8);
  if ( dword_487234 == -1 )
  {
    j_highscore_load_table();
    dword_482604 = highscore_rank_index();
    highscore_record_game_mode = config_game_mode;
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
    console_input_poll();
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28);
    dword_487234 = 0;
  }
  else if ( dword_487234 )
  {
    return ui_cursor_render();
  }
  *(float *)&v5 = *(float *)&v9 + 30.0;
  v6 = v8 + 70.0 + 16.0;
  switch ( dword_487194 )
  {
    case 1:
      (*(void (__stdcall **)(int, float, char *))(*(_DWORD *)grim_interface_ptr + 324))(
        v5,
        COERCE_FLOAT(LODWORD(v6)),
        aYouDidnTMakeIt);
      break;
    case 2:
      (*(void (__stdcall **)(int, float, char *))(*(_DWORD *)grim_interface_ptr + 324))(
        v5,
        COERCE_FLOAT(LODWORD(v6)),
        aThirdTimeNoGoo);
      break;
    case 3:
      (*(void (__stdcall **)(int, float, char *))(*(_DWORD *)grim_interface_ptr + 324))(
        v5,
        COERCE_FLOAT(LODWORD(v6)),
        aNoLuckThisTime);
      break;
    case 4:
      (*(void (__stdcall **)(int, float, char *))(*(_DWORD *)grim_interface_ptr + 324))(
        v5,
        COERCE_FLOAT(LODWORD(v6)),
        aPersistenceWil);
      break;
    case 5:
      (*(void (__stdcall **)(int, float, char *))(*(_DWORD *)grim_interface_ptr + 324))(
        v5,
        COERCE_FLOAT(LODWORD(v6)),
        aTryOneMoreTime);
      break;
    default:
      (*(void (__stdcall **)(int, float, char *))(*(_DWORD *)grim_interface_ptr + 324))(
        v5,
        COERCE_FLOAT(LODWORD(v6)),
        aQuestFailedTry);
      break;
  }
  v6 = v6 + 16.0;
  v0 = *(float *)&v5 + 6.0;
  *(float *)&v5 = v0;
  *(float *)&v7 = v0 + 4.0;
  v8 = v6 + 10.0;
  ui_text_input_render((int)&v7, (int)highscore_active_record, 1.0, dword_482604 + 1, v2, v3, v4, v5);
  v6 = v6 + 98.0;
  *(float *)&v5 = *(float *)&v5 + 16.0;
  if ( (byte_4825D8 & 1) == 0 )
  {
    byte_482686 = 1;
    byte_4825D8 |= 1u;
    byte_482695 = 0;
    byte_482694 = 0;
    dword_482690 = 1065353216;
    dword_48268C = 0;
    dword_482680 = 0;
    byte_482684 = 0;
    byte_482685 = 0;
    dword_482688 = 0;
    crt_atexit(nullsub_34);
  }
  dword_482680 = (int)aPlayAgain;
  if ( (byte_4825D8 & 2) == 0 )
  {
    byte_48269E = 1;
    byte_4825D8 |= 2u;
    byte_4826AD = 0;
    byte_4826AC = 0;
    dword_4826A8 = 1065353216;
    dword_4826A4 = 0;
    dword_482698 = 0;
    byte_48269C = 0;
    byte_48269D = 0;
    dword_4826A0 = 0;
    crt_atexit(nullsub_33);
  }
  dword_482698 = (int)aPlayAnother;
  if ( (byte_4825D8 & 4) == 0 )
  {
    byte_4824F6 = 1;
    byte_4825D8 |= 4u;
    byte_482505 = 0;
    byte_482504 = 0;
    dword_482500 = 1065353216;
    dword_4824FC = 0;
    dword_4824F0 = 0;
    byte_4824F4 = 0;
    byte_4824F5 = 0;
    dword_4824F8 = 0;
    crt_atexit(nullsub_32);
  }
  dword_4824F0 = (int)aMainMenu;
  ui_button_update(&v5, &dword_482680);
  v6 = v6 + 32.0;
  ui_button_update(&v5, &dword_482698);
  v6 = v6 + 32.0;
  ui_button_update(&v5, &dword_4824F0);
  v6 = v6 + 32.0;
  if ( byte_482685 )
  {
    ++dword_487194;
    ui_transition_direction = 0;
    game_state_pending = 9;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    render_pass_mode = 0;
  }
  if ( byte_48269D )
  {
    dword_487194 = 0;
    ui_transition_direction = 0;
    game_state_pending = 11;
    byte_487292 = 0;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    sfx_play_exclusive(music_track_crimson_theme_id);
  }
  if ( byte_4824F5 )
  {
    dword_487194 = 0;
    sfx_mute_all(music_track_extra_0);
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_play_exclusive(music_track_crimson_theme_id);
    ui_transition_direction = 0;
    game_state_pending = 0;
    byte_487292 = 0;
  }
  return ui_cursor_render();
}

// nullsub_32 @ 0x00410CF0
void __cdecl nullsub_32()
{
  ;
}

// nullsub_33 @ 0x00410D00
void __cdecl nullsub_33()
{
  ;
}

// nullsub_34 @ 0x00410D10
void __cdecl nullsub_34()
{
  ;
}

// quest_results_screen_update @ 0x00410D20
// quest/campaign results screen: final time, perk bonus, high score entry, and buttons
int sub_410D20()
{
  int v0; // eax
  int v1; // eax
  int v2; // edx
  double v3; // st7
  int v4; // esi
  bool v5; // cc
  int v6; // eax
  double v7; // st7
  int v8; // edi
  char *v9; // eax
  int v10; // edi
  char *v11; // eax
  int v12; // edi
  char *v13; // eax
  int v14; // esi
  char *v15; // eax
  signed int v17; // eax
  unsigned int v18; // kr0C_4
  int v19; // eax
  int v20; // esi
  int v21; // eax
  float v22; // [esp+8Ch] [ebp-38h]
  float v23; // [esp+8Ch] [ebp-38h]
  float v24; // [esp+8Ch] [ebp-38h]
  float v25; // [esp+8Ch] [ebp-38h]
  float v26; // [esp+8Ch] [ebp-38h]
  float v27; // [esp+90h] [ebp-34h]
  float v28; // [esp+94h] [ebp-30h]
  float v29; // [esp+94h] [ebp-30h]
  float v30; // [esp+98h] [ebp-2Ch]
  float v31; // [esp+98h] [ebp-2Ch]
  float v32; // [esp+98h] [ebp-2Ch]
  float v33; // [esp+98h] [ebp-2Ch]
  float v34; // [esp+98h] [ebp-2Ch]
  int v35; // [esp+9Ch] [ebp-28h]
  int v36; // [esp+A0h] [ebp-24h]
  int v37; // [esp+A4h] [ebp-20h]
  int v38; // [esp+A8h] [ebp-1Ch]
  int v39; // [esp+ACh] [ebp-18h] BYREF
  float v40; // [esp+B0h] [ebp-14h]
  int v41; // [esp+B4h] [ebp-10h] BYREF
  float v42; // [esp+B8h] [ebp-Ch]
  int v43; // [esp+BCh] [ebp-8h] BYREF
  float v44; // [esp+C0h] [ebp-4h]

  bonus_reflex_boost_timer = 0.0;
  dword_487194 = 0;
  if ( game_state_id == 8
    && game_state_pending == 25
    && ui_transition_direction
    && !(unsigned __int8)sfx_is_unmuted(music_track_shortie_monk_id) )
  {
    sfx_play_exclusive(music_track_crimsonquest_id);
  }
  gameplay_render_world();
  ui_elements_update_and_render();
  if ( (byte_482568 & 1) == 0 )
  {
    byte_482526 = 1;
    byte_482568 |= 1u;
    byte_482535 = 0;
    byte_482534 = 0;
    dword_482530 = 1065353216;
    dword_48252C = 0;
    dword_482520 = 0;
    byte_482524 = 0;
    byte_482525 = 0;
    dword_482528 = 0;
    crt_atexit(nullsub_40);
  }
  if ( (byte_482568 & 2) == 0 )
  {
    dword_4826F8 = 1065353216;
    byte_482568 |= 2u;
    dword_4826E8 = (int)byte_4825DC;
    dword_4826EC = 0;
    dword_4826F0 = 24;
    dword_4826F4 = 96;
    crt_atexit(nullsub_39);
  }
  v44 = flt_48DBDC + flt_48DC00;
  *(float *)&v39 = flt_48DBFC + flt_48DBD8 + 180.0;
  v40 = v44 + 40.0;
  *(float *)&v41 = *(float *)&v39 + flt_48DBC8 + 40.0;
  ui_draw_textured_quad((__int64)(*(float *)&v41 - 18.0), (__int64)(v40 - 4.0), 256, 64, dword_48F804);
  v43 = v41;
  v42 = v40 + 56.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  if ( game_state_prev == 14 && ui_transition_direction && byte_48724D )
  {
    byte_48724D = 0;
    dword_487234 = 2;
    goto LABEL_77;
  }
  v0 = dword_487234;
  if ( dword_487234 == -2 )
  {
    v1 = 11 * (quest_stage_minor + 10 * *(_DWORD *)quest_stage_major - 11);
    v2 = quest_unlock_perk_id[v1];
    dword_482700 = quest_unlock_weapon_id[v1];
    dword_482704 = v2;
    v39 = (__int64)*(float *)player_health;
    v3 = (double)v39;
    *(float *)player_health = v3;
    v4 = (__int64)(v3 * 50.0);
    dword_482600 = v4;
    if ( config_player_count == 2 )
    {
      v4 += (__int64)(player2_health * 50.0);
      dword_482600 = v4;
    }
    dword_48270C = quest_spawn_timeline - 1000 * perk_pending_count - v4;
    survival_elapsed_ms = quest_spawn_timeline - 1000 * perk_pending_count - v4;
    if ( !dword_48270C )
      survival_elapsed_ms = 1;
    dword_482708 = 0;
    highscore_record_init();
    dword_482724 = 700;
    v0 = dword_487234 + 1;
    dword_482710 = 0;
    dword_482714 = 0;
    dword_482718 = 0;
    dword_48271C = 0;
    dword_482720 = 0;
    ++dword_487234;
  }
  if ( v0 == -1 )
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    v5 = dword_482724 - frame_dt_ms <= 0;
    dword_482724 -= frame_dt_ms;
    v42 = v42 + 40.0;
    if ( v5 )
    {
      if ( dword_48271C >= 3 )
      {
        if ( dword_48271C == 3 )
        {
          dword_482724 = 50;
          ++dword_482708;
        }
      }
      else if ( dword_48271C )
      {
        if ( dword_48271C == 1 )
        {
          dword_482714 += 1000;
          dword_482724 = 150;
          sfx_play(sfx_ui_clink_01, 1.0);
          dword_482720 -= 1000;
          if ( dword_482714 >= dword_482600 )
          {
            dword_482714 = dword_482600;
            ++dword_48271C;
          }
        }
        else if ( dword_48271C == 2 )
        {
          dword_482724 = 300;
          ++dword_482718;
          sfx_play(sfx_ui_clink_01, 1.0);
          dword_482720 -= 1000;
          if ( dword_482718 >= perk_pending_count )
          {
            dword_482718 = perk_pending_count;
            dword_482724 = 1000;
            ++dword_48271C;
            survival_elapsed_ms = dword_48270C;
            dword_482720 = dword_48270C;
          }
        }
      }
      else
      {
        dword_482724 = 40;
        dword_482710 += 2000;
        sfx_play(sfx_ui_clink_01, 1.0);
        v6 = dword_482710;
        if ( dword_482710 >= quest_spawn_timeline )
        {
          v6 = quest_spawn_timeline;
          dword_482710 = quest_spawn_timeline;
          ++dword_48271C;
        }
        dword_482720 = v6;
      }
    }
    v7 = 1.0 - (double)dword_482708 * 0.1;
    *(float *)&v39 = v7;
    if ( v7 >= 0.0 )
    {
      if ( *(float *)&v39 > 1.0 )
        *(float *)&v39 = 1.0;
    }
    else
    {
      *(float *)&v39 = 0.0;
    }
    *(float *)&v41 = *(float *)&v41 + 32.0;
    v42 = v42 + 20.0;
    if ( dword_48271C )
    {
      v30 = *(float *)&v39 * 0.40000001;
      (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v30));
    }
    else
    {
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1036831949,
        1061997773,
        1036831949,
        v39);
    }
    (*(void (__cdecl **)(int, int, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      v41,
      COERCE_FLOAT(LODWORD(v42)),
      aBaseTime);
    v8 = *(_DWORD *)grim_interface_ptr;
    v9 = FUN_0040ff50(dword_482710 / 1000);
    v22 = *(float *)&v41 + 132.0;
    (*(void (**)(int, _DWORD, float, char *, ...))(v8 + 328))(
      grim_interface_ptr,
      LODWORD(v22),
      COERCE_FLOAT(LODWORD(v42)),
      aS_0,
      v9);
    v42 = v42 + 20.0;
    if ( dword_48271C == 1 )
    {
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1036831949,
        1061997773,
        1036831949,
        v39);
    }
    else
    {
      v31 = *(float *)&v39 * 0.40000001;
      (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v31));
    }
    if ( dword_48271C < 1 )
    {
      v32 = *(float *)&v39 * 0.2;
      (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v32));
    }
    (*(void (__cdecl **)(int, int, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      v41,
      COERCE_FLOAT(LODWORD(v42)),
      aLifeBonus);
    v10 = *(_DWORD *)grim_interface_ptr;
    v11 = FUN_0040ff50(dword_482714 / 1000);
    v23 = *(float *)&v41 + 132.0;
    (*(void (**)(int, _DWORD, float, char *, ...))(v10 + 328))(
      grim_interface_ptr,
      LODWORD(v23),
      COERCE_FLOAT(LODWORD(v42)),
      aS_0,
      v11);
    v42 = v42 + 20.0;
    if ( dword_48271C == 2 )
    {
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1036831949,
        1061997773,
        1036831949,
        v39);
    }
    else
    {
      v33 = *(float *)&v39 * 0.40000001;
      (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v33));
    }
    if ( dword_48271C < 2 )
    {
      v34 = *(float *)&v39 * 0.2;
      (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v34));
    }
    (*(void (__cdecl **)(int, int, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      v41,
      COERCE_FLOAT(LODWORD(v42)),
      aUnpickedPerkBo);
    v12 = *(_DWORD *)grim_interface_ptr;
    v13 = FUN_0040ff50(dword_482718);
    v24 = *(float *)&v41 + 132.0;
    (*(void (**)(int, _DWORD, float, char *, ...))(v12 + 328))(
      grim_interface_ptr,
      LODWORD(v24),
      COERCE_FLOAT(LODWORD(v42)),
      aS_0,
      v13);
    v42 = v42 + 20.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      v39);
    *(float *)&v39 = *(float *)&v41 - 4.0;
    v40 = v42 + 1.0;
    (*(void (__thiscall **)(int, int *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
      grim_interface_ptr,
      &v39,
      1126694912,
      1065353216);
    v42 = v42 + 8.0;
    (*(void (__cdecl **)(int, int, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      v41,
      COERCE_FLOAT(LODWORD(v42)),
      aFinalTime);
    v14 = *(_DWORD *)grim_interface_ptr;
    v15 = FUN_0040ff50(dword_482720 / 1000);
    v25 = *(float *)&v41 + 132.0;
    (*(void (**)(int, _DWORD, float, char *, ...))(v14 + 328))(
      grim_interface_ptr,
      LODWORD(v25),
      COERCE_FLOAT(LODWORD(v42)),
      aS_0,
      v15);
    v42 = v42 + 20.0;
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28);
    if ( dword_487234 == -1
      && ((*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 57)
       || (unsigned __int8)input_primary_just_pressed()) )
    {
      ++dword_487234;
      perk_prompt_update_and_render();
      return ui_cursor_render();
    }
    if ( dword_482708 > 10 )
    {
      dword_482708 = 0;
      ++dword_487234;
      perk_prompt_update_and_render();
      return ui_cursor_render();
    }
    goto LABEL_108;
  }
  if ( v0 )
  {
    if ( v0 != 1 )
    {
      if ( v0 != 2 )
      {
LABEL_108:
        perk_prompt_update_and_render();
        return ui_cursor_render();
      }
LABEL_77:
      if ( dword_482708 >= 500 )
        dword_482708 = 500;
      else
        dword_482708 += frame_dt_ms;
      *(float *)&v39 = (double)dword_482708 * 0.0020000001;
      *(float *)&v41 = *(float *)&v43 + 30.0;
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        v39);
      if ( dword_482620 >= 100 )
      {
        v42 = v42 + 6.0;
        v26 = *(float *)&v41 + 8.0;
        (*(void (**)(int, _DWORD, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
          grim_interface_ptr,
          LODWORD(v26),
          COERCE_FLOAT(LODWORD(v42)),
          aScoreTooLowFor,
          100);
        v42 = v42 + 6.0;
      }
      v43 = v41;
      v44 = v42 + 16.0;
      ui_text_input_render(
        (int)&v43,
        (int)highscore_active_record,
        *(float *)&v39,
        dword_482620 + 1,
        v35,
        v36,
        v37,
        v38);
      v42 = v42 + 78.0 + 6.0;
      if ( dword_482700 )
      {
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          1060320051);
        v28 = v42 + 1.0;
        (*(void (__cdecl **)(int, int, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
          grim_interface_ptr,
          v41,
          LODWORD(v28),
          aWeaponUnlocked);
        v42 = v42 + 14.0;
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          1063675494);
        v20 = *(_DWORD *)grim_interface_ptr;
        v21 = weapon_table_entry(quest_unlock_weapon_id[110 * *(_DWORD *)quest_stage_major
                                                      - 121
                                                      + 11 * quest_stage_minor]);
        (*(void (**)(int, int, float, char *, ...))(v20 + 328))(
          grim_interface_ptr,
          v41,
          COERCE_FLOAT(LODWORD(v42)),
          aS_0,
          v21);
        v42 = v42 + 16.0;
      }
      if ( dword_482704 != perk_id_antiperk )
      {
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          1060320051);
        v29 = v42 + 1.0;
        (*(void (__cdecl **)(int, int, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
          grim_interface_ptr,
          v41,
          LODWORD(v29),
          aPerkUnlocked);
        v42 = v42 + 14.0;
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          1063675494);
        (*(void (**)(int, int, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
          grim_interface_ptr,
          v41,
          COERCE_FLOAT(LODWORD(v42)),
          aS_0,
          perk_name_table[5 * quest_unlock_perk_id[110 * *(_DWORD *)quest_stage_major - 121 + 11 * quest_stage_minor]]);
        v42 = v42 + 16.0;
      }
      if ( (byte_482568 & 4) == 0 )
      {
        byte_4825C6 = 1;
        byte_482568 |= 4u;
        byte_4825D5 = 0;
        byte_4825D4 = 0;
        dword_4825D0 = 1065353216;
        dword_4825CC = 0;
        dword_4825C0 = 0;
        byte_4825C4 = 0;
        byte_4825C5 = 0;
        dword_4825C8 = 0;
        crt_atexit(nullsub_38);
      }
      dword_4825C0 = (int)aPlayNext;
      if ( (byte_482568 & 8) == 0 )
      {
        byte_48260E = 1;
        byte_482568 |= 8u;
        byte_48261D = 0;
        byte_48261C = 0;
        dword_482618 = 1065353216;
        dword_482614 = 0;
        dword_482608 = 0;
        byte_48260C = 0;
        byte_48260D = 0;
        dword_482610 = 0;
        crt_atexit(nullsub_37);
      }
      dword_482608 = (int)aPlayAgain;
      if ( (byte_482568 & 0x10) == 0 )
      {
        byte_48266E = 1;
        byte_482568 |= 0x10u;
        byte_48267D = 0;
        byte_48267C = 0;
        dword_482678 = 1065353216;
        dword_482674 = 0;
        dword_482668 = 0;
        byte_48266C = 0;
        byte_48266D = 0;
        dword_482670 = 0;
        crt_atexit(nullsub_36);
      }
      dword_482668 = (int)aHighScores;
      if ( (byte_482568 & 0x20) == 0 )
      {
        byte_482568 |= 0x20u;
        byte_4826B6 = 1;
        byte_4826C5 = 0;
        byte_4826C4 = 0;
        dword_4826C0 = 1065353216;
        dword_4826BC = 0;
        dword_4826B0 = 0;
        byte_4826B4 = 0;
        byte_4826B5 = 0;
        dword_4826B8 = 0;
        crt_atexit(nullsub_35);
      }
      dword_4826B0 = (int)aMainMenu;
      v42 = v42 + 6.0;
      if ( *(_DWORD *)quest_stage_major == 5 && quest_stage_minor == 10 )
        dword_4825C0 = (int)aShowEndNote;
      dword_482678 = v39;
      dword_4825D0 = v39;
      *(float *)&v41 = *(float *)&v41 + 20.0;
      dword_482618 = v39;
      dword_4826C0 = v39;
      ui_button_update(&v41, &dword_4825C0);
      v42 = v42 + 32.0;
      ui_button_update(&v41, &dword_482608);
      v42 = v42 + 32.0;
      ui_button_update(&v41, &dword_482668);
      v42 = v42 + 32.0;
      ui_button_update(&v41, &dword_4826B0);
      v42 = v42 + 32.0;
      if ( byte_4825C5 )
      {
        if ( *(_DWORD *)quest_stage_major == 5 && quest_stage_minor == 10 )
        {
          render_pass_mode = 0;
          game_state_pending = 21;
          ui_transition_direction = 0;
        }
        else
        {
          sfx_mute_all(music_track_extra_0);
          sfx_mute_all(music_track_crimson_theme_id);
          sfx_mute_all(music_track_shortie_monk_id);
          ui_transition_direction = 0;
          game_state_pending = 9;
          render_pass_mode = 0;
          ++quest_stage_minor;
        }
      }
      if ( byte_48260D )
      {
        ui_transition_direction = 0;
        game_state_pending = 9;
        sfx_mute_all(music_track_crimson_theme_id);
        sfx_mute_all(music_track_shortie_monk_id);
        sfx_mute_all(music_track_extra_0);
        render_pass_mode = 0;
      }
      if ( byte_48266D )
      {
        dword_487258 = config_game_mode;
        byte_48724D = 1;
        dword_487250 = *(_DWORD *)quest_stage_major;
        dword_487254 = quest_stage_minor;
        byte_48725C = config_hardcore;
        ui_transition_direction = 0;
        game_state_pending = 14;
      }
      if ( byte_4826B5 )
      {
        sfx_mute_all(music_track_extra_0);
        sfx_mute_all(music_track_crimson_theme_id);
        sfx_mute_all(music_track_shortie_monk_id);
        sfx_play_exclusive(music_track_crimson_theme_id);
        ui_transition_direction = 0;
        game_state_pending = 0;
        byte_487292 = 0;
      }
      goto LABEL_108;
    }
    if ( dword_482708 >= 500 )
      dword_482708 = 500;
    else
      dword_482708 += frame_dt_ms;
    *(float *)&v39 = (double)dword_482708 * 0.0020000001;
    v42 = v42 + 22.0;
    flt_496604 = *(float *)&v39;
    (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4965F8);
    v27 = *(float *)&v41 + 42.0;
    (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      LODWORD(v27),
      COERCE_FLOAT(LODWORD(v42)),
      aStateYourNameT_0);
    flt_496604 = 0.69999999;
    v42 = v42 + 32.0;
    dword_4826F4 = 166;
    dword_4826F8 = v39;
    dword_482520 = (int)aOk;
    dword_482530 = v39;
    *(float *)&v43 = *(float *)&v41 + 170.0;
    v44 = v42 - 8.0;
    ui_button_update(&v43, &dword_482520);
    if ( (unsigned __int8)ui_text_input_update(&v41, &dword_4826E8) || byte_482525 )
    {
      v17 = 0;
      v18 = strlen(byte_4825DC) + 1;
      if ( (int)(v18 - 1) < 1 )
        goto LABEL_74;
      do
      {
        if ( byte_4825DC[v17] != 32 )
          break;
        ++v17;
      }
      while ( v17 < (int)(v18 - 1) );
      if ( byte_4825DC[v17] )
      {
        dword_487234 = 2;
        sfx_play(sfx_ui_typeenter, 1.0);
        v19 = dword_4826EC;
        player_name_length = dword_4826EC;
        strcpy(highscore_active_record, byte_4825DC);
        dword_4826EC = 0;
        dword_4826F0 = 0;
        highscore_active_record[v19] = 0;
        dword_4826E8 = (int)byte_4825DC;
        highscore_save_active();
        j_highscore_load_table();
      }
      else
      {
LABEL_74:
        byte_482525 = 0;
        sfx_play(sfx_shock_hit_01, 1.0);
      }
    }
    v42 = v42 + 30.0;
    (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4965F8);
    *(float *)&v43 = *(float *)&v41 + 26.0;
    v44 = v42 + 16.0;
    ui_text_input_render((int)&v43, (int)highscore_active_record, *(float *)&v39, dword_482620 + 1, v35, v36, v37, v38);
    perk_prompt_update_and_render();
    return ui_cursor_render();
  }
  else
  {
    j_highscore_load_table();
    dword_482620 = highscore_rank_index();
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28);
    if ( dword_482620 < 100 )
    {
      dword_4826F0 = 20;
      dword_4826E8 = (int)byte_4825DC;
      dword_487234 = 1;
      strcpy(byte_4825DC, highscore_active_record);
      dword_4826EC = strlen(highscore_active_record);
    }
    else
    {
      dword_4826EC = 0;
      dword_4826F0 = 0;
      dword_4826E8 = (int)byte_4825DC;
      dword_487234 = 2;
    }
    perk_prompt_update_and_render();
    return ui_cursor_render();
  }
}

// nullsub_35 @ 0x00412020
void __cdecl nullsub_35()
{
  ;
}

// nullsub_36 @ 0x00412030
void __cdecl nullsub_36()
{
  ;
}

// nullsub_37 @ 0x00412040
void __cdecl nullsub_37()
{
  ;
}

// nullsub_38 @ 0x00412050
void __cdecl nullsub_38()
{
  ;
}

// nullsub_39 @ 0x00412060
void __cdecl nullsub_39()
{
  ;
}

// nullsub_40 @ 0x00412070
void __cdecl nullsub_40()
{
  ;
}

// nullsub_106 @ 0x00412090
void nullsub_106()
{
  ;
}

// FUN_004120b0 @ 0x004120B0
// [binja] int32_t sub_4120b0()
int sub_4120B0()
{
  memset(highscore_active_record, 0, 0x48u);
  strcpy(highscore_active_record, default_player_name);
  highscore_flags = 0;
  byte_487086 = 124;
  byte_487087 = -1;
  dword_487078 = crt_rand() & 0xFEE050F;
  bonus_energizer_timer = 0.0;
  survival_spawn_stage = 0;
  dword_487028 = 0;
  dword_487194 = 0;
  demo_mode_active = 0;
  byte_486FAA = 0;
  quest_unlock_index = 0;
  creature_active_count = 0;
  *(_DWORD *)&dword_48718C = 0;
  dword_487088 = -1;
  *(_DWORD *)quest_stage_major = 1;
  quest_stage_minor = 1;
  return 1;
}

// nullsub_107 @ 0x00412170
void nullsub_107()
{
  ;
}

// sub_412180 @ 0x00412180
// [binja] int32_t sub_4121f0()
int sub_412180()
{
  FUN_00412190();
  return crt_atexit(sub_412200);
}

// FUN_00412190 @ 0x00412190
// [binja] int32_t sub_412190()
void sub_412190()
{
  crt_ehvec_ctor(&quest_selected_meta, 0x2Cu, 50, sub_4121B0, sub_4121E0);
}

// sub_4121B0 @ 0x004121B0
void __thiscall sub_4121B0(_DWORD *this)
{
  *(this + 7) = 0;
  *(this + 10) = 1;
  *(this + 3) = 0;
  *(this + 9) = 0;
  *(this + 8) = 0;
  *(this + 4) = 0;
  *(this + 5) = 1;
  *(this + 6) = 2;
  *(this + 2) = 120000;
}

// sub_4121E0 @ 0x004121E0
void __thiscall sub_4121E0(LPVOID *this)
{
  if ( *(this + 3) )
    crt_free(*(this + 3));
}

// sub_412200 @ 0x00412200
void __cdecl sub_412200()
{
  crt_ehvec_dtor(&quest_selected_meta, 0x2Cu, 50, (void (__thiscall *)(void *))sub_4121E0);
}

// sub_412230 @ 0x00412230
int *sub_412230()
{
  int *result; // eax
  int v1; // ecx

  result = &bonus_pool;
  v1 = 16;
  do
  {
    *result = 0;
    result += 7;
    --v1;
  }
  while ( v1 );
  return result;
}

// sub_412260 @ 0x00412260
float *sub_412260()
{
  float *result; // eax
  int v1; // ecx

  result = &creature_spawn_slot_timer;
  v1 = 32;
  do
  {
    *(result - 4) = 0.0;
    *(result - 1) = 0.5;
    *result = 0.5;
    *(result - 3) = 0.0;
    *(result - 2) = NAN;
    result += 6;
    --v1;
  }
  while ( v1 );
  return result;
}

// sub_4122A0 @ 0x004122A0
int sub_4122A0()
{
  int v0; // eax
  int v2; // et2

  dword_48578C = 0;
  dword_485784 = 0;
  dword_485788 = 0;
  dword_485790 = 0;
  memset(&dword_4856E4, 0, 0x30u);
  unk_485714 = 0;
  memset(&dword_485644, 0, 0x30u);
  unk_485674 = 0;
  memset(&dword_485544, 0, 0x100u);
  game_status_blob = 0;
  *(_DWORD *)&game_sequence_id = 0;
  dword_485798 = crt_rand() % 345354345;
  dword_48579C = crt_rand() % 345354345;
  dword_4857A0 = crt_rand() % 345354345;
  v0 = crt_rand();
  v2 = v0 % 345354345;
  dword_4857A4 = v2;
  return v0 / 345354345;
}

// FUN_00412360 @ 0x00412360
// [binja] int32_t sub_412360()
int sub_412360()
{
  _BYTE *v0; // ebp
  int v1; // ebx
  int result; // eax

  v0 = &unk_482B56;
  v1 = 100;
  do
  {
    memset(v0 - 70, 0, 0x48u);
    strcpy(v0 - 70, default_player_name);
    *(v0 - 2) = 0;
    *v0 = 124;
    v0[1] = -1;
    result = crt_rand() & 0xFEE050F;
    *(_DWORD *)(v0 - 14) = result;
    v0 += 72;
    --v1;
  }
  while ( v1 );
  return result;
}

// sub_4123C0 @ 0x004123C0
// [binja] int32_t sub_412440()
int sub_4123C0()
{
  FUN_004123d0();
  return crt_atexit(sub_412450);
}

// FUN_004123d0 @ 0x004123D0
// [binja] int32_t sub_4123d0()
void sub_4123D0()
{
  crt_ehvec_ctor(&bonus_meta_label, 0x14u, 15, sub_4123F0, FUN_00412410);
}

// sub_4123F0 @ 0x004123F0
void __thiscall sub_4123F0(_DWORD *this)
{
  *(this + 4) = 1;
  *(this + 2) = -1;
  *(this + 1) = 0;
  *this = 0;
  *((_BYTE *)this + 12) = 0;
}

// FUN_00412410 @ 0x00412410
// [binja] void* __fastcall sub_412410(int32_t* arg1)
void __thiscall sub_412410(LPVOID *this)
{
  void *v2; // esi

  if ( *this )
    crt_free(*this);
  v2 = *(this + 1);
  if ( v2 )
    crt_free(v2);
}

// sub_412450 @ 0x00412450
void __cdecl sub_412450()
{
  crt_ehvec_dtor(&bonus_meta_label, 0x14u, 15, (void (__thiscall *)(void *))FUN_00412410);
}

// bonus_pick_random_type @ 0x00412470
// rolls a bonus id while respecting timers, perks, quest stage, and enabled flags
int sub_412470()
{
  char v0; // bl
  char *v1; // eax
  int v2; // esi
  int v3; // edi
  int v4; // esi
  int v5; // esi
  int v6; // eax
  int v9; // [esp+Ch] [ebp-4h]

  v9 = 0;
  v0 = 0;
  v1 = &bonus_state;
  do
  {
    if ( *((_DWORD *)v1 - 1) == 14 && !*v1 )
      v0 = 1;
    v1 += 28;
  }
  while ( (int)v1 < (int)byte_482B0C );
  do
  {
    v2 = crt_rand() % 162 + 1;
    v3 = v2 <= 13;
    v4 = v2 - 13;
    if ( !v3 && v4 <= 1 )
      v3 = 2;
    v5 = v4 - 1;
    if ( v3 == 2 )
    {
      if ( (crt_rand() & 0x3F) == 0 )
        goto LABEL_18;
      v3 = 0;
    }
    else if ( v3 )
    {
      goto LABEL_18;
    }
    v6 = 3;
    while ( v5 > 10 )
    {
      v5 -= 10;
      if ( ++v6 >= 15 )
        goto LABEL_18;
    }
    v3 = v6;
LABEL_18:
    if ( shock_chain_links_left <= 0 || v3 != 7 )
    {
      if ( config_game_mode == 3 )
      {
        if ( config_hardcore && *(_DWORD *)quest_stage_major == 3 )
        {
          if ( quest_stage_minor == 10 && v3 == 5 )
            continue;
        }
        else if ( *(_DWORD *)quest_stage_major == 2 && quest_stage_minor == 10 && v3 == 5 )
        {
          continue;
        }
        if ( config_hardcore && *(_DWORD *)quest_stage_major == 2 )
        {
          if ( quest_stage_minor == 10 && v3 == 11 )
            continue;
        }
        else if ( *(_DWORD *)quest_stage_major == 4 )
        {
          if ( quest_stage_minor == 10 && (v3 == 5 || v3 == 11) )
            continue;
        }
        else if ( *(_DWORD *)quest_stage_major == 5 && quest_stage_minor == 10 && v3 == *(_DWORD *)quest_stage_major )
        {
          continue;
        }
      }
      if ( (bonus_freeze_timer <= 0.0 || v3 != 11)
        && (*(float *)player_shield_timer <= 0.0 && player2_shield_timer <= 0.0 || v3 != 10)
        && (!perk_count_get(perk_id_my_favourite_weapon) || v3 != 3)
        && (!perk_count_get(perk_id_death_clock) || v3 != 12)
        && (v3 != 3 || !v0)
        && bonus_meta_enabled[20 * v3] )
      {
        return v3;
      }
    }
  }
  while ( v9++ < 100 );
  return 1;
}

// bonus_metadata_init @ 0x00412660
// builds bonus metadata table (labels, descriptions, durations)
int sub_412660()
{
  int result; // eax

  dword_4853E4 = (int)strdup_malloc(aPoints);
  dword_4853E8 = sub_42FD00(aYouGainSomeExp, 256);
  dword_4853EC = 12;
  dword_4853F4 = 500;
  byte_4853F0 = 1;
  dword_48540C = (int)strdup_malloc(aWeapon);
  dword_485410 = sub_42FD00(aYouGetANewWeap, 256);
  dword_485414 = -1;
  dword_48541C = 3;
  dword_485434 = (int)strdup_malloc(aNuke);
  dword_485438 = sub_42FD00(aAnAmazingExplo, 256);
  dword_48543C = 1;
  dword_485448 = (int)strdup_malloc(aDoubleExperien);
  dword_48544C = sub_42FD00(aEveryExperienc, 256);
  dword_485450 = 4;
  dword_485470 = (int)strdup_malloc(aFireblast);
  dword_485474 = sub_42FD00(aFireballsAllOv, 256);
  dword_485478 = 2;
  dword_48545C = (int)strdup_malloc(aShockChain);
  dword_485460 = sub_42FD00(aChainOfShocksS, 256);
  dword_485464 = 3;
  dword_485484 = (int)strdup_malloc(aReflexBoost);
  dword_485488 = sub_42FD00(aYouGetMoreTime, 256);
  dword_48548C = 5;
  dword_485494 = 3;
  dword_485498 = (int)strdup_malloc(aShield);
  dword_48549C = sub_42FD00(aForceFieldProt, 256);
  dword_4854A0 = 6;
  dword_4854A8 = 7;
  dword_4854AC = (int)strdup_malloc(aFreeze);
  dword_4854B0 = sub_42FD00(aMonstersAreFro, 256);
  dword_4854B4 = 8;
  dword_4854BC = 5;
  dword_4854D4 = (int)strdup_malloc(aSpeed);
  dword_4854D8 = sub_42FD00(aYourMovementSp, 256);
  dword_4854DC = 9;
  dword_4854E4 = 8;
  dword_4853F8 = (int)strdup_malloc(aEnergizer);
  dword_4853FC = sub_42FD00(aSuddenlyMonste, 256);
  dword_485400 = 10;
  dword_485408 = 8;
  dword_485420 = (int)strdup_malloc(aWeaponPowerUp);
  dword_485424 = sub_42FD00(aYourFirerateAn, 256);
  dword_485428 = 7;
  dword_485430 = 10;
  dword_4854E8 = (int)strdup_malloc(aFireBullets);
  dword_4854EC = sub_42FD00(aForFewSecondsM, 256);
  dword_4854F0 = 11;
  dword_4854F8 = 4;
  dword_4854C0 = (int)strdup_malloc(aMedikit);
  result = sub_42FD00(aYouRegainSomeO, 256);
  dword_4854D0 = 10;
  dword_4854C4 = result;
  dword_4854C8 = 14;
  return result;
}

// FUN_00412940 @ 0x00412940
// [binja] char* sub_412940()
char *sub_412940()
{
  char *result; // eax

  result = bonus_meta_enabled;
  do
  {
    *result = 1;
    result += 20;
  }
  while ( (int)result < (int)byte_485508 );
  bonus_meta_enabled[0] = 0;
  return result;
}

// game_mode_label @ 0x00412960
// returns a display label for the current game mode
char *sub_412960()
{
  const char *v0; // edi
  unsigned int v1; // edx
  char *v2; // edi

  if ( config_game_mode != 2 )
  {
    switch ( config_game_mode )
    {
      case 1:
        v1 = strlen(aSurvival) + 1;
        v2 = &aSurvival[v1];
        break;
      case 3:
        v0 = aQuests;
        goto LABEL_11;
      case 4:
        v1 = strlen(aTypOShooter) + 1;
        v2 = &aTypOShooter[v1];
        break;
      default:
        v0 = aUnknown;
        goto LABEL_11;
    }
    qmemcpy(byte_4854FC, &v2[-v1], v1);
    return byte_4854FC;
  }
  v0 = aRush_0;
LABEL_11:
  strcpy(byte_4854FC, v0);
  return byte_4854FC;
}

// game_sequence_load @ 0x00412A10
// reads the sequence value from registry
LSTATUS sub_412A10()
{
  LSTATUS result; // eax
  HKEY phkResult; // [esp+0h] [ebp-8h] BYREF
  DWORD Type; // [esp+4h] [ebp-4h] BYREF

  result = RegCreateKeyExA(HKEY_LOCAL_MACHINE, &SubKey, 0, 0, 0, 0xF003Fu, 0, &phkResult, 0);
  if ( !result )
  {
    reg_read_dword_default(phkResult, ValueName, (DWORD)&Type, 0);
    if ( *(_DWORD *)&game_sequence_id < Type )
      *(_DWORD *)&game_sequence_id = Type;
    return RegCloseKey(phkResult);
  }
  return result;
}

// game_save_status @ 0x00412A80
// writes registry state and saves status file
LSTATUS sub_412A80()
{
  int v0; // esi
  char *v1; // eax
  FILE *v2; // ebp
  int v3; // edi
  int v4; // ecx
  unsigned int v5; // esi
  char v6; // dl
  unsigned int v7; // ebx
  HKEY phkResult; // [esp+8h] [ebp-8h] BYREF
  int Buffer; // [esp+Ch] [ebp-4h] BYREF

  if ( !RegCreateKeyExA(HKEY_LOCAL_MACHINE, &SubKey, 0, 0, 0, 0xF003Fu, 0, &phkResult, 0) )
  {
    v0 = *(_DWORD *)&game_sequence_id;
    reg_write_dword(phkResult, ValueName, game_sequence_id);
    reg_write_dword(phkResult, aDatapathid, (unsigned int)(13 * v0 + 3) >> 1);
    reg_write_dword(phkResult, aTransferfailed, 0);
    RegCloseKey(phkResult);
  }
  v1 = game_build_path(game_status_filename);
  v2 = crt_fopen(v1, file_mode_write_binary);
  if ( v2 )
  {
    LOWORD(game_status_blob) = quest_unlock_index;
    v3 = 0;
    v4 = 0;
    HIWORD(game_status_blob) = quest_unlock_index_full;
    v5 = 0;
    do
    {
      v6 = *((_BYTE *)&game_status_blob + v4);
      v7 = v5 + v6 * (v4 + 7 * v6);
      v5 += 111;
      v3 += v7 + 13;
      *((_BYTE *)&game_status_blob + v4) = v6 + v4 * (v4 * (7 * v4 + 15) + 3) + 111;
      ++v4;
    }
    while ( v5 < 0x10B18 );
    Buffer = v3;
    crt_fwrite(&game_status_blob, 0x268u, 1u, v2);
    crt_fwrite(&Buffer, 4u, 1u, v2);
    crt_fclose(v2);
    if ( *(float *)(dword_480864 + 12) != 0.0 )
      console_printf((int)&console_log_queue, aGameSavestatus);
    game_load_status();
    game_sequence_load();
    return game_sequence_load();
  }
  else
  {
    console_printf((int)&console_log_queue, aGameSavestatus_0);
    return game_sequence_load();
  }
}

// game_load_status @ 0x00412C10
// loads status file; regenerates on failure
void sub_412C10()
{
  char *v0; // eax
  FILE *v1; // eax
  FILE *v2; // ebp
  unsigned int v3; // esi
  int v4; // edi
  int v5; // ecx
  char v6; // al
  unsigned int v7; // edx
  int Buffer; // [esp+8h] [ebp-4h] BYREF

  v0 = game_build_path(game_status_filename);
  v1 = crt_fopen(v0, file_mode_read_binary);
  v2 = v1;
  v3 = 0;
  if ( v1 )
  {
    crt_fseek(v1, 0, 2);
    if ( crt_ftell(v2) == 620 )
    {
      crt_fseek(v2, 0, 0);
      crt_fread(&game_status_blob, 0x268u, 1u, v2);
      Buffer = 0;
      crt_fread(&Buffer, 4u, 1u, v2);
      v4 = 0;
      v5 = 0;
      do
      {
        v6 = -111 - v5 * (v5 * (7 * v5 + 15) + 3) + *((_BYTE *)&game_status_blob + v5);
        *((_BYTE *)&game_status_blob + v5) = v6;
        v7 = v3 + v6 * (v5 + 7 * v6);
        v3 += 111;
        ++v5;
        v4 += v7 + 13;
      }
      while ( v3 < 0x10B18 );
      if ( v4 == Buffer )
      {
        quest_unlock_index = (unsigned __int16)game_status_blob;
        quest_unlock_index_full = HIWORD(game_status_blob);
        crt_fclose(v2);
        if ( *(float *)(dword_480864 + 12) != 0.0 )
          console_printf((int)&console_log_queue, aGameLoadstatus_1);
      }
      else
      {
        crt_fclose(v2);
        console_printf((int)&console_log_queue, aGameLoadstatus_0);
        game_sequence_load();
      }
    }
    else
    {
      crt_fclose(v2);
      console_printf((int)&console_log_queue, aGameLoadstatus);
      game_sequence_load();
    }
  }
  else
  {
    console_printf((int)&console_log_queue, aGameLoadstatus_2);
    console_printf((int)&console_log_queue, aGeneratingNewF);
    game_status_blob = 0;
    game_sequence_load();
    game_save_status();
    game_sequence_load();
  }
}

// gameplay_reset_state @ 0x00412DC0
// resets gameplay/session globals, pools, and availability tables
int sub_412DC0()
{
  _DWORD *v0; // eax
  int v1; // eax
  int *v2; // eax
  int *v3; // eax
  char *v4; // eax
  char *v5; // eax
  _BYTE *v6; // eax
  int v7; // edi
  char *v8; // esi
  int v9; // ecx
  int *v10; // eax
  int v12; // [esp+18h] [ebp-8h]
  int v13; // [esp+1Ch] [ebp-4h]

  v0 = &bonus_hud_slot_y;
  byte_48727C = 0;
  do
  {
    v0[6] = 1084227584;
    *((_BYTE *)v0 - 4) = 0;
    *v0 = 0;
    v0[5] = 1;
    v0[4] = aEmpty;
    v0[1] = 1065353216;
    v0 += 8;
  }
  while ( (int)v0 < (int)dword_48F78C );
  quest_spawn_timeline = 0;
  shock_chain_links_left = 0;
  dword_486FB8 = 1;
  creature_spawned_count = 0;
  survival_recent_death_count = 0;
  survival_reward_damage_seen = 0;
  survival_reward_fire_seen = 0;
  byte_486FA9 = 1;
  survival_reward_handout_enabled = 1;
  tutorial_stage_index = -1;
  tutorial_stage_timer = 0;
  tutorial_stage_transition_timer = -1000;
  dword_487088 = -1;
  bonus_double_xp_timer = 0.0;
  survival_spawn_stage = 0;
  camera_shake_pulses = 0;
  FUN_00412940();
  dword_482940 = 6;
  creature_type_texture = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                            grim_interface_ptr,
                            aZombie);
  creature_type_sfx_b0 = sfx_zombie_attack_01;
  creature_type_sfx_b1 = sfx_zombie_attack_02;
  creature_type_sfx_a0 = sfx_zombie_die_01;
  creature_type_sfx_a1 = sfx_zombie_die_02;
  dword_482748 = 1065353216;
  creature_type_anim_rate = 1067030938;
  creature_type_sfx_a2 = sfx_zombie_die_03;
  creature_type_sfx_a3 = sfx_zombie_die_04;
  creature_type_base_frame = 32;
  creature_type_corpse_frame = 0;
  dword_48276C = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(grim_interface_ptr, aLizard);
  dword_482784 = sfx_lizard_attack_02;
  dword_482780 = sfx_lizard_attack_01;
  dword_482770 = sfx_lizard_die_01;
  dword_482778 = sfx_lizard_die_03;
  dword_48278C = 1065353216;
  dword_4827A0 = 1070386381;
  dword_482774 = sfx_lizard_die_02;
  dword_48277C = sfx_lizard_die_04;
  dword_4827AC = 1;
  dword_4827A4 = 16;
  dword_4827A8 = 3;
  dword_4827F4 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                   grim_interface_ptr,
                   aSpiderSp1);
  dword_482808 = sfx_spider_attack_01;
  dword_48280C = sfx_spider_attack_02;
  dword_482814 = 1065353216;
  dword_482828 = 1069547520;
  dword_4827F8 = sfx_spider_die_01;
  dword_4827FC = sfx_spider_die_02;
  dword_482800 = sfx_spider_die_03;
  dword_482804 = sfx_spider_die_04;
  dword_482834 = 1;
  dword_48282C = 16;
  dword_482830 = 1;
  dword_482838 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                   grim_interface_ptr,
                   aSpiderSp2);
  dword_482850 = sfx_spider_attack_02;
  dword_48284C = sfx_spider_attack_01;
  dword_48283C = sfx_spider_die_01;
  dword_482844 = sfx_spider_die_03;
  dword_482858 = 1065353216;
  dword_48286C = 1069547520;
  dword_482840 = sfx_spider_die_02;
  dword_482848 = sfx_spider_die_04;
  dword_482878 = 1;
  dword_482870 = 16;
  dword_482874 = 2;
  dword_4827B0 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(grim_interface_ptr, aAlien);
  dword_4827C4 = sfx_alien_attack_01;
  dword_4827C8 = sfx_alien_attack_02;
  dword_4827B4 = sfx_alien_die_01;
  dword_4827B8 = sfx_alien_die_02;
  dword_4827BC = sfx_alien_die_03;
  dword_4827C0 = sfx_alien_die_04;
  dword_482880 = sfx_trooper_die_01;
  dword_4827D0 = 1065353216;
  dword_4827E4 = 1068289229;
  dword_4827F0 = 0;
  dword_4827E8 = 32;
  dword_4827EC = 4;
  dword_482884 = sfx_trooper_die_02;
  dword_482888 = sfx_trooper_die_03;
  dword_4828B8 = 7;
  dword_48287C = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                   grim_interface_ptr,
                   aTrooper);
  perk_choices_dirty = 1;
  bonus_spawn_guard = 0;
  memset(dword_48708C, 0, sizeof(dword_48708C));
  *(float *)&v12 = (double)terrain_texture_width * 0.5;
  camera_offset_x = v12;
  *(float *)&v13 = (double)terrain_texture_height * 0.5;
  camera_offset_y = v13;
  weapon_table_init();
  weapon_refresh_available();
  perks_rebuild_available();
  effect_defaults_reset();
  perk_pending_count = 0;
  survival_spawn_cooldown = 0;
  creatures_any_active_flag = 0;
  time_scale_active = 0;
  time_scale_factor = 1065353216;
  bonus_reflex_boost_timer = 0.0;
  bonus_weapon_power_up_timer = 0;
  bonus_energizer_timer = 0.0;
  plaguebearer_infection_count = 0;
  dword_487268 = -1;
  highscore_full_version_marker = 0;
  survival_elapsed_ms = 0;
  highscore_score_xp = 0;
  highscore_record_quest_minor = 0;
  highscore_record_quest_major = 0;
  highscore_record_game_mode = 0;
  highscore_record_weapon_id = 0;
  creature_kill_count = 0;
  highscore_record_shots_hit = 0;
  highscore_record_shots_fired = 0;
  byte_487081 = 0;
  highscore_year_offset = 0;
  highscore_month = 0;
  highscore_day = 0;
  highscore_flags = 0;
  v1 = crt_rand();
  dword_4AAF24 = 0;
  dword_487078 = v1 & 0xFEE050F;
  bonus_freeze_timer = 0.0;
  flt_4AAF1C = 0.0;
  flt_4AAF2C = -1.0;
  perk_prompt_timer = 0;
  projectile_reset_pools();
  FUN_0041fc80();
  dword_4871D0 = 0;
  dword_4871D4 = 0;
  v2 = &player_low_health_timer;
  do
  {
    v2[5] = -1082130432;
    v2[6] = -1082130432;
    *v2 = 1120403456;
    v2[3] = 0;
    v2 += 216;
  }
  while ( (int)v2 < (int)dword_491280 );
  v3 = &bonus_pool;
  do
  {
    *v3 = 0;
    v3 += 7;
  }
  while ( (int)v3 < (int)&quest_spawn_count );
  v4 = &projectile_pool;
  do
  {
    *v4 = 0;
    v4 += 64;
  }
  while ( (int)v4 < (int)&particle_pool );
  v5 = &sprite_effect_pool;
  do
  {
    *v5 = 0;
    v5 += 44;
  }
  while ( (int)v5 < (int)byte_49AA20 );
  v6 = &secondary_projectile_pool;
  do
  {
    *v6 = 0;
    v6 += 44;
  }
  while ( (int)v6 < (int)&dword_4965D8 );
  v7 = 0;
  v8 = &creature_target_player;
  do
  {
    v9 = config_player_count;
    *((_DWORD *)v8 - 14) = 0;
    *(v8 - 112) = 0;
    if ( v9 )
      *v8 = v7 % v9;
    else
      *v8 = 0;
    *(v8 - 104) = 1;
    *((_DWORD *)v8 + 7) = 0;
    v8 += 152;
    ++v7;
    *((float *)v8 - 29) = (float)(crt_rand() % 31);
  }
  while ( (int)v8 < (int)byte_4AA3A8 );
  v10 = &creature_spawn_slot_owner;
  do
  {
    *v10 = 0;
    v10 += 6;
  }
  while ( (int)v10 < (int)&SubKey );
  fx_queue_rotated = 0;
  fx_queue_count = 0;
  highscore_full_version_marker = 0;
  survival_elapsed_ms = 0;
  highscore_score_xp = 0;
  highscore_record_quest_minor = 0;
  highscore_record_quest_major = 0;
  highscore_record_game_mode = 0;
  highscore_record_weapon_id = 0;
  creature_kill_count = 0;
  highscore_record_shots_hit = 0;
  highscore_record_shots_fired = 0;
  byte_487081 = 0;
  highscore_year_offset = 0;
  highscore_month = 0;
  highscore_day = 0;
  highscore_flags = 0;
  dword_487078 = crt_rand() & 0xFEE050F;
  return terrain_generate_random();
}

// player_start_reload @ 0x00413430
// starts reload for the active player, sets timers, and plays SFX
void sub_413430()
{
  int v0; // eax
  int v1; // ecx
  int v2; // eax
  double v3; // st7

  v0 = render_overlay_player_index;
  if ( player_reload_active[864 * render_overlay_player_index] )
  {
    if ( perk_count_get(perk_id_ammunition_within) || perk_count_get(perk_id_regression_bullets) )
      return;
    v0 = render_overlay_player_index;
  }
  v1 = 216 * v0;
  if ( !player_reload_active[864 * v0] )
  {
    sfx_play_panned(*(&dword_4D7A8C + 31 * player_weapon_id[216 * v0]), (int)&player_pos_x[216 * v0], 1.0);
    v1 = 216 * render_overlay_player_index;
    player_reload_active[864 * render_overlay_player_index] = 1;
  }
  v2 = perk_id_fastloader;
  v3 = flt_4D7A78[31 * player_weapon_id[v1]];
  *(float *)(v1 * 4 + 4787072) = flt_4D7A78[31 * player_weapon_id[v1]];
  if ( (int)*(&player_perk_counts + v2) > 0 )
    *(float *)(v1 * 4 + 4787072) = v3 * 0.69999999;
  if ( *(float *)&bonus_weapon_power_up_timer > 0.0 )
    *(float *)(v1 * 4 + 4787072) = *(float *)(v1 * 4 + 4787072) * 0.60000002;
  player_reload_timer_max[v1] = player_reload_timer[v1];
}

// sub_413540 @ 0x00413540
double __cdecl sub_413540(float a1)
{
  int v1; // ecx
  double v2; // st7
  double v3; // st7
  double v4; // st7
  double v5; // st6
  double result; // st7
  unsigned __int8 v8; // c0
  unsigned __int8 v9; // c3
  double v10; // st6
  double v11; // st6
  int v12; // [esp+0h] [ebp-8h]
  float v13; // [esp+4h] [ebp-4h]
  float v14; // [esp+4h] [ebp-4h]
  int v15; // [esp+4h] [ebp-4h]

  v1 = 864 * render_overlay_player_index;
  if ( *(float *)&player_heading[216 * render_overlay_player_index] < 0.0 )
  {
    do
    {
      v2 = *(float *)(v1 + 4786396) + 6.2831855;
      *(float *)(v1 + 4786396) = v2;
    }
    while ( v2 < 0.0 );
  }
  if ( *(float *)(v1 + 4786396) > 6.2831855 )
  {
    do
    {
      v3 = *(float *)(v1 + 4786396) - 6.2831855;
      *(float *)(v1 + 4786396) = v3;
    }
    while ( v3 > 6.2831855 );
  }
  v13 = a1 - *(float *)(v1 + 4786396);
  v4 = *(float *)(v1 + 4786396);
  v12 = LODWORD(v13) & 0x7FFFFFFF;
  if ( a1 > v4 )
    v4 = a1;
  v5 = *(float *)(v1 + 4786396);
  if ( a1 < v5 )
    v5 = a1;
  v14 = 6.2831855 - v4 + v5;
  v15 = LODWORD(v14) & 0x7FFFFFFF;
  if ( *(float *)&v12 >= (double)*(float *)&v15 )
    result = *(float *)&v15;
  else
    result = *(float *)&v12;
  if ( v8 | v9 )
  {
    v10 = frame_dt * result;
    if ( a1 > (double)*(float *)(v1 + 4786396) )
    {
      v11 = v10 * 5.0;
      goto LABEL_18;
    }
LABEL_17:
    v11 = v10 * -5.0;
    goto LABEL_18;
  }
  v10 = frame_dt * result;
  if ( a1 >= (double)*(float *)(v1 + 4786396) )
    goto LABEL_17;
  v11 = v10 * 5.0;
LABEL_18:
  flt_487198 = v11;
  *(float *)(v1 + 4786396) = flt_487198 + *(float *)(v1 + 4786396);
  return result;
}

// player_update @ 0x004136B0
// per-player gameplay update: movement, firing, status timers, and effects
void __usercall sub_4136B0(int a1@<ebp>)
{
  int v1; // eax
  int v2; // edi
  char *v3; // edi
  float *v4; // esi
  double v5; // st7
  long double v6; // st7
  float v7; // ebp
  char v8; // al
  double v9; // st7
  double v10; // st7
  double v11; // st7
  int v12; // ebp
  int v13; // ebx
  double v14; // st7
  double v15; // st7
  long double v16; // st7
  int v17; // ebp
  float v18; // eax
  float *v19; // ebx
  double v20; // st7
  double v21; // st7
  float *v22; // eax
  double v23; // st7
  double v24; // st7
  int v25; // eax
  double v26; // st7
  int v27; // ebp
  int v28; // ebx
  double v29; // st7
  double v30; // st7
  float v31; // edx
  int v32; // eax
  double v33; // st6
  double v34; // st4
  long double v35; // st7
  int v36; // edx
  char *v37; // ecx
  double v38; // st4
  double v39; // st3
  long double v40; // st4
  int v41; // eax
  double v42; // st7
  long double v43; // st7
  long double v44; // st6
  double v45; // st7
  char v47; // c0
  double v48; // st7
  double v49; // st6
  double v50; // st6
  double v51; // st7
  double v52; // st7
  double v53; // st7
  double v54; // st7
  char v56; // c0
  double v57; // st7
  double v58; // st6
  double v59; // st6
  double v60; // st7
  double v61; // st7
  char v62; // bl
  int v63; // eax
  int v64; // eax
  double v65; // st7
  double v66; // st7
  double v67; // st7
  int v68; // eax
  int v69; // eax
  double v70; // st7
  double v71; // st7
  double v72; // st7
  double v73; // st7
  double v74; // st7
  double v75; // st7
  double v76; // st7
  double v77; // st7
  double v78; // st7
  double v79; // st6
  double v80; // st6
  double v81; // st7
  double v82; // st7
  double v83; // st7
  int v84; // eax
  double v85; // st4
  double v86; // st7
  long double v87; // st7
  double v88; // st6
  double v89; // st6
  double v90; // st7
  double v91; // st7
  int v92; // eax
  double v93; // st7
  double v94; // st7
  double v95; // st7
  double v96; // st7
  double v97; // st7
  double v98; // st6
  int v99; // ebx
  float v100; // ebp
  int v101; // eax
  int v102; // ecx
  int v103; // eax
  double v104; // st7
  long double v105; // st7
  double v106; // st7
  double v107; // st7
  long double v108; // st7
  long double v109; // st7
  long double v110; // st7
  long double v111; // st6
  double v112; // st7
  int v113; // eax
  double v114; // st7
  int v115; // ecx
  long double v116; // st7
  long double v117; // st6
  double v118; // st7
  float *v119; // ebp
  double v120; // st7
  long double v121; // st7
  int v122; // edx
  double v123; // st7
  double v124; // st7
  float *v125; // ebp
  char v126; // bl
  int v127; // ecx
  double v128; // st7
  double v129; // st7
  double v130; // st7
  double v131; // st7
  double v132; // st7
  double v133; // st7
  double v134; // st6
  double v135; // st7
  long double v136; // st7
  char v137; // al
  double v138; // st7
  char v139; // al
  int v140; // eax
  double v141; // st7
  int v142; // ebp
  int v143; // ebx
  int v144; // ecx
  double v145; // st7
  double v146; // st7
  int v147; // eax
  double v148; // st7
  int v149; // ebx
  double v150; // st7
  double v151; // st7
  int v152; // eax
  int v153; // ebx
  int v154; // eax
  int v155; // eax
  double v156; // st7
  long double v157; // st7
  long double v158; // st7
  double v159; // st7
  int v160; // eax
  double v161; // st7
  double v162; // st7
  int v163; // eax
  int v164; // eax
  double v165; // st7
  long double v166; // st7
  long double v167; // st7
  double v168; // st7
  int v169; // eax
  double v170; // st7
  double v171; // st7
  long double v172; // st7
  long double v173; // st7
  double v174; // st7
  int v175; // eax
  double v176; // st7
  double v177; // st7
  int v178; // eax
  double v179; // st7
  double v180; // st7
  long double v181; // st7
  long double v182; // st7
  double v183; // st7
  int v184; // eax
  double v185; // st7
  double v186; // st7
  int v187; // eax
  double v188; // st7
  int v189; // ebx
  int v190; // eax
  bool v191; // zf
  double v192; // st7
  int v193; // eax
  double v194; // st7
  int v195; // ebx
  int v196; // eax
  long double v197; // st7
  long double v198; // st7
  double v199; // st7
  int v200; // eax
  double v201; // st7
  double v202; // st7
  int v203; // eax
  double v204; // st7
  int v205; // ebx
  int v206; // eax
  double v207; // st7
  double v208; // st7
  int v209; // eax
  double v210; // st7
  int v211; // eax
  long double v212; // st7
  long double v213; // st7
  double v214; // st7
  int v215; // eax
  double v216; // st7
  double v217; // st7
  int v218; // eax
  double v219; // st7
  double v220; // st7
  double v221; // st7
  double v222; // st7
  double v223; // st7
  double v224; // st7
  double v225; // st7
  double v226; // st7
  double v227; // st7
  double v228; // st7
  double v229; // st7
  double v230; // st7
  double v231; // st7
  double v232; // st7
  double v233; // st7
  double v234; // st7
  int v235; // ebx
  int v236; // eax
  double v237; // st7
  long double v238; // st7
  long double v239; // st7
  double v240; // st7
  int v241; // eax
  double v242; // st7
  double v243; // st7
  int v244; // eax
  double v245; // st7
  int v246; // ebx
  int v247; // eax
  long double v248; // st7
  long double v249; // st7
  double v250; // st7
  int v251; // eax
  double v252; // st7
  double v253; // st7
  int v254; // eax
  double v255; // st7
  double v256; // st7
  long double v257; // st7
  long double v258; // st7
  double v259; // st7
  int v260; // eax
  double v261; // st7
  double v262; // st7
  int v263; // eax
  double v264; // st7
  double v265; // st7
  long double v266; // st7
  long double v267; // st7
  double v268; // st7
  int v269; // eax
  double v270; // st7
  double v271; // st7
  int v272; // eax
  int v273; // ebx
  double v274; // st7
  double v275; // st7
  int v276; // eax
  double v277; // st7
  double v278; // st7
  long double v279; // st7
  long double v280; // st7
  double v281; // st7
  int v282; // eax
  double v283; // st7
  double v284; // st7
  int v285; // eax
  double v286; // st7
  double v287; // st7
  double v288; // st7
  double v289; // st7
  int v290; // ebx
  int v291; // eax
  double v292; // st7
  double v293; // st7
  double v294; // st7
  double v295; // st7
  double v296; // st7
  double v297; // st7
  double v298; // st6
  bool v299; // c0
  bool v300; // c3
  float *v301; // edi
  double v302; // st7
  int v303; // [esp+14h] [ebp-68h]
  float v304; // [esp+18h] [ebp-64h]
  float v305; // [esp+18h] [ebp-64h]
  float v306; // [esp+18h] [ebp-64h]
  float v307; // [esp+18h] [ebp-64h]
  float v308; // [esp+18h] [ebp-64h]
  float v309; // [esp+18h] [ebp-64h]
  float v310; // [esp+18h] [ebp-64h]
  float v311; // [esp+18h] [ebp-64h]
  float v312; // [esp+18h] [ebp-64h]
  float v313; // [esp+18h] [ebp-64h]
  float v314; // [esp+18h] [ebp-64h]
  float v315; // [esp+18h] [ebp-64h]
  float v316; // [esp+18h] [ebp-64h]
  int v317; // [esp+1Ch] [ebp-60h]
  int v318; // [esp+1Ch] [ebp-60h]
  float v319; // [esp+1Ch] [ebp-60h]
  int v320; // [esp+24h] [ebp-58h]
  char v321; // [esp+36h] [ebp-46h]
  char v322; // [esp+37h] [ebp-45h]
  float v323; // [esp+38h] [ebp-44h]
  float v324; // [esp+38h] [ebp-44h]
  int v325; // [esp+3Ch] [ebp-40h]
  float v326; // [esp+3Ch] [ebp-40h]
  float v327; // [esp+3Ch] [ebp-40h]
  float v328; // [esp+3Ch] [ebp-40h]
  float v329; // [esp+3Ch] [ebp-40h]
  float v330; // [esp+3Ch] [ebp-40h]
  float v331; // [esp+3Ch] [ebp-40h]
  float v332; // [esp+3Ch] [ebp-40h]
  float v333; // [esp+3Ch] [ebp-40h]
  float v334; // [esp+3Ch] [ebp-40h]
  float v335; // [esp+3Ch] [ebp-40h]
  float v336; // [esp+3Ch] [ebp-40h]
  float v337; // [esp+3Ch] [ebp-40h]
  float v338; // [esp+3Ch] [ebp-40h]
  float v339; // [esp+40h] [ebp-3Ch]
  float v340; // [esp+40h] [ebp-3Ch]
  int v341; // [esp+40h] [ebp-3Ch]
  float v342; // [esp+40h] [ebp-3Ch]
  float v343; // [esp+40h] [ebp-3Ch]
  float v344; // [esp+40h] [ebp-3Ch]
  float v345; // [esp+40h] [ebp-3Ch]
  float v346; // [esp+40h] [ebp-3Ch]
  int v347; // [esp+40h] [ebp-3Ch]
  int v348; // [esp+40h] [ebp-3Ch]
  float v349; // [esp+40h] [ebp-3Ch]
  int v350; // [esp+40h] [ebp-3Ch]
  float v351; // [esp+40h] [ebp-3Ch]
  int v352; // [esp+40h] [ebp-3Ch]
  float v353; // [esp+40h] [ebp-3Ch]
  int v354; // [esp+40h] [ebp-3Ch]
  float v355; // [esp+40h] [ebp-3Ch]
  float v356; // [esp+40h] [ebp-3Ch]
  float v357; // [esp+40h] [ebp-3Ch]
  float v358; // [esp+40h] [ebp-3Ch]
  float v359; // [esp+40h] [ebp-3Ch]
  int v360; // [esp+40h] [ebp-3Ch]
  float v361; // [esp+44h] [ebp-38h]
  int v362; // [esp+44h] [ebp-38h]
  float v363; // [esp+44h] [ebp-38h]
  float v364; // [esp+44h] [ebp-38h]
  int v365; // [esp+44h] [ebp-38h]
  float v366; // [esp+44h] [ebp-38h]
  float v367; // [esp+44h] [ebp-38h]
  float v368; // [esp+44h] [ebp-38h]
  float v369; // [esp+44h] [ebp-38h]
  int v370; // [esp+44h] [ebp-38h]
  float v371; // [esp+44h] [ebp-38h]
  float v372; // [esp+44h] [ebp-38h]
  float v373; // [esp+48h] [ebp-34h]
  int v374; // [esp+48h] [ebp-34h]
  float v375[2]; // [esp+4Ch] [ebp-30h] BYREF
  int v376; // [esp+54h] [ebp-28h]
  float v377; // [esp+58h] [ebp-24h]
  int v378; // [esp+5Ch] [ebp-20h] BYREF
  float v379; // [esp+60h] [ebp-1Ch] BYREF
  int v380; // [esp+64h] [ebp-18h] BYREF
  float v381; // [esp+68h] [ebp-14h]
  int v382; // [esp+6Ch] [ebp-10h] BYREF
  float v383; // [esp+70h] [ebp-Ch]
  int v384; // [esp+74h] [ebp-8h]
  int v385; // [esp+78h] [ebp-4h]

  if ( console_open_flag )
    return;
  v1 = render_overlay_player_index;
  v2 = 3 * render_overlay_player_index;
  dword_4871F4[2 * render_overlay_player_index] = LODWORD(ui_mouse_x);
  dword_4871F8[2 * v1] = ui_mouse_y;
  v3 = (char *)&unk_4908B0 + 288 * v2;
  v4 = (float *)(v3 + 20);
  v376 = *((int *)v3 + 5);
  v377 = *((float *)v3 + 6);
  if ( *((float *)v3 + 9) <= 0.0 )
  {
    *((float *)v3 + 4) = *((float *)v3 + 4) - frame_dt * 20.0;
    return;
  }
  if ( *((float *)v3 + 197) > 0.0 )
    *((float *)v3 + 23) = *((float *)v3 + 23) + 1.0;
  v320 = a1;
  if ( *((_DWORD *)v3 + 196) != 1120403456 && *((float *)v3 + 9) < 20.0 )
  {
    v5 = *((float *)v3 + 196) - frame_dt;
    *((float *)v3 + 196) = v5;
    if ( v5 < 0.0 )
    {
      v6 = cos(*((float *)v3 + 192) + 1.5707964 - 0.5);
      v381 = sin(*((float *)v3 + 192) + 1.5707964 - 0.5) * -6.0;
      v7 = *((float *)v3 + 192);
      *(float *)&v380 = v6 * -6.0 + *v4;
      v381 = v381 + *((float *)v3 + 6);
      effect_spawn_blood_splatter((int)&v380, v7, 0.0);
      effect_spawn_blood_splatter((int)&v380, v7, 0.0);
      effect_spawn_blood_splatter((int)&v380, v7, 0.0);
      v8 = crt_rand();
      sfx_play_panned(sfx_bloodspill_01 + (v8 & 1), (int)(v3 + 20), 1.0);
      *((_DWORD *)v3 + 196) = 1065353216;
    }
  }
  LODWORD(v373) = v3 + 764;
  v9 = *((float *)v3 + 191) - (frame_dt + frame_dt);
  *((float *)v3 + 191) = v9;
  if ( v9 < 0.0 )
    *((_DWORD *)v3 + 191) = 0;
  if ( *(float *)&bonus_weapon_power_up_timer <= 0.0 )
    v10 = *((float *)v3 + 181) - frame_dt;
  else
    v10 = *((float *)v3 + 181) - frame_dt * 1.5;
  *((float *)v3 + 181) = v10;
  if ( *((float *)v3 + 181) < 0.0 )
    *((_DWORD *)v3 + 181) = 0;
  if ( perk_count_get(perk_id_man_bomb) )
  {
    v11 = frame_dt + *((float *)v3 + 40);
    *((float *)v3 + 40) = v11;
    if ( v11 > flt_473310 )
    {
      if ( *(float *)(dword_48086C + 12) == 0.0 )
        v12 = -100;
      else
        v12 = -1 - render_overlay_player_index;
      *(float *)&v13 = 0.0;
      v361 = 0.0;
      do
      {
        if ( (v13 & 1) != 0 )
          v317 = 21;
        else
          v317 = 22;
        v304 = (double)(crt_rand() % 50) * 0.0099999998 + (double)SLODWORD(v361) * 0.78539819 - 0.25;
        projectile_spawn((int)(v3 + 20), v304, v317, v12);
        ++v13;
        v361 = *(float *)&v13;
      }
      while ( v13 < 8 );
      sfx_play_panned(sfx_explosion_small, (int)(v3 + 20), 1.0);
      *((float *)v3 + 40) = *((float *)v3 + 40) - flt_473310;
      flt_473310 = 4.0;
    }
  }
  else
  {
    *((_DWORD *)v3 + 40) = 0;
  }
  if ( perk_count_get(perk_id_living_fortress) )
  {
    v14 = frame_dt + *((float *)v3 + 41);
    *((float *)v3 + 41) = v14;
    if ( v14 > 30.0 )
      *((_DWORD *)v3 + 41) = 1106247680;
  }
  else
  {
    *((_DWORD *)v3 + 41) = 0;
  }
  if ( perk_count_get(perk_id_fire_caugh) )
  {
    v15 = frame_dt + *((float *)v3 + 42);
    *((float *)v3 + 42) = v15;
    if ( v15 > flt_473314 )
    {
      if ( *(float *)(dword_48086C + 12) == 0.0 )
        v325 = -100;
      else
        v325 = -1 - render_overlay_player_index;
      sfx_play_panned(dword_4D9050, (int)(v3 + 20), 1.0);
      sfx_play_panned(dword_4D7FD8, (int)(v3 + 20), 1.0);
      v361 = *((float *)v3 + 192);
      v16 = v361 - 1.5707964 - 0.150915;
      v17 = 864 * render_overlay_player_index;
      v18 = *(float *)&player_aim_x[216 * render_overlay_player_index];
      v379 = *(float *)&player_aim_y[216 * render_overlay_player_index];
      v19 = (float *)&player_pos_x[216 * render_overlay_player_index];
      *(float *)&v378 = v18;
      *(float *)&v380 = cos(v16) * 16.0;
      v381 = sin(v16) * 16.0;
      v20 = v379 - v19[1];
      *(float *)&v382 = v18 - *v19;
      v383 = v20;
      v375[0] = sub_417660(&v382) * 0.5;
      v339 = (double)(crt_rand() & 0x1FF) * 0.012271847;
      v21 = (double)(crt_rand() & 0x1FF) * (v375[0] * *(float *)(v17 + 4787048)) * 0.001953125;
      *(float *)&v378 = cos(v339) * v21 + *(float *)&v378;
      v379 = sin(v339) * v21 + v379;
      v22 = (float *)FUN_00417640(v375, &v378);
      v375[0] = atan2(v22[1], *v22) - 1.5707964;
      v23 = v381 + *((float *)v3 + 6);
      *(float *)&v382 = *(float *)&v380 + *v4;
      v383 = v23;
      projectile_spawn((int)&v382, v375[0], 45, v325);
      *(float *)&v382 = cos(v361) * 25.0;
      v383 = sin(v361) * 25.0;
      v24 = v381 + *((float *)v3 + 6);
      *(float *)&v380 = *(float *)&v380 + *v4;
      v381 = v24;
      v25 = 11 * fx_spawn_sprite(&v380, &v382, 1065353216);
      sprite_effect_color_r[v25] = 1056964608;
      sprite_effect_color_g[v25] = 1056964608;
      sprite_effect_color_b[v25] = 1056964608;
      sprite_effect_color_a[v25] = 1054045372;
      *((float *)v3 + 42) = *((float *)v3 + 42) - flt_473314;
      LODWORD(v375[0]) = crt_rand() % 4;
      flt_473314 = (double)SLODWORD(v375[0]) + 2.0;
    }
  }
  else
  {
    *((_DWORD *)v3 + 42) = 0;
  }
  if ( perk_count_get(perk_id_hot_tempered) )
  {
    v26 = frame_dt + *((float *)v3 + 39);
    *((float *)v3 + 39) = v26;
    if ( v26 > flt_473318 )
    {
      if ( *(float *)(dword_48086C + 12) == 0.0 )
        v27 = -100;
      else
        v27 = -1 - render_overlay_player_index;
      *(float *)&v28 = 0.0;
      v361 = 0.0;
      do
      {
        if ( (v28 & 1) != 0 )
          v318 = 9;
        else
          v318 = 11;
        v305 = (double)SLODWORD(v361) * 0.78539819;
        projectile_spawn((int)(v3 + 20), v305, v318, v27);
        ++v28;
        v361 = *(float *)&v28;
      }
      while ( v28 < 8 );
      sfx_play_panned(sfx_explosion_small, (int)(v3 + 20), 1.0);
      *((float *)v3 + 39) = *((float *)v3 + 39) - flt_473318;
      LODWORD(v375[0]) = crt_rand() % 8;
      flt_473318 = (double)SLODWORD(v375[0]) + 2.0;
    }
  }
  else
  {
    *((_DWORD *)v3 + 39) = 0;
  }
  if ( flt_4AAF34 <= 0.0 )
  {
    v30 = frame_dt * 0.80000001 + flt_473A40;
    flt_473A40 = v30;
    if ( v30 > 1.0 )
      flt_473A40 = 1.0;
  }
  else
  {
    v29 = flt_473A40 - frame_dt;
    flt_473A40 = v29;
    if ( v29 < 0.30000001 )
      flt_473A40 = 0.30000001;
  }
  v31 = *((float *)v3 + 23);
  *(float *)&v380 = 0.0;
  v381 = 0.0;
  *((_DWORD *)v3 + 7) = 0;
  *((float *)v3 + 8) = v381;
  v340 = v31;
  if ( time_scale_active )
    frame_dt = 0.60000002 / *(float *)&time_scale_factor * frame_dt;
  v32 = render_overlay_player_index;
  if ( demo_mode_active
    || config_player_mode_flags[render_overlay_player_index] == 5
    || config_aim_scheme[render_overlay_player_index] == 5 )
  {
    if ( *((int *)v3 + 200) < 0 )
      *((_DWORD *)v3 + 200) = 0;
    if ( creature_pool[152 * *((_DWORD *)v3 + 200)] && *(float *)&creature_health[38 * *((_DWORD *)v3 + 200)] > 0.0 )
    {
      v33 = *v4 - *((float *)&creature_pos_x + 38 * *((_DWORD *)v3 + 200));
      v34 = *((float *)v3 + 6) - creature_pos_y[38 * *((_DWORD *)v3 + 200)];
      v35 = sqrt(v33 * v33 + v34 * v34);
    }
    else
    {
      v35 = 100000.0;
    }
    v36 = 0;
    v37 = creature_pool;
    do
    {
      if ( *v37 )
      {
        if ( *((float *)v37 + 9) > 0.0 )
        {
          v38 = *v4 - *((float *)v37 + 5);
          v39 = *((float *)v3 + 6) - *((float *)v37 + 6);
          v40 = sqrt(v38 * v38 + v39 * v39);
          v375[0] = v40;
          if ( v40 < v35 - 64.0 )
          {
            *((_DWORD *)v3 + 200) = v36;
            v35 = v375[0];
          }
        }
      }
      v37 += 152;
      ++v36;
    }
    while ( (int)v37 < (int)byte_4AA338 );
    if ( demo_mode_active )
      goto LABEL_214;
    v32 = render_overlay_player_index;
  }
  v41 = config_player_mode_flags[v32];
  switch ( v41 )
  {
    case 5:
LABEL_214:
      v84 = *((_DWORD *)v3 + 200);
      if ( v84 < 0 || *(float *)&creature_health[38 * v84] <= 0.0 )
      {
        v87 = atan2(*((float *)v3 + 6) - 512.0, *v4 - 512.0) + 3.1415927;
      }
      else
      {
        v85 = *((float *)v3 + 6) - 512.0;
        if ( sqrt((*v4 - 512.0) * (*v4 - 512.0) + v85 * v85) <= 300.0 )
        {
          v86 = *((float *)v3 + 6) - creature_pos_y[38 * *((_DWORD *)v3 + 200)];
          *(float *)&v378 = *v4 - *((float *)&creature_pos_x + 38 * *((_DWORD *)v3 + 200));
        }
        else
        {
          v86 = *((float *)v3 + 6) - 512.0;
          *(float *)&v378 = *v4 - 512.0;
        }
        v379 = v86;
        v380 = v378;
        v381 = v379;
        v87 = atan2(v379, *(float *)&v378) - 1.5707964;
      }
      if ( v87 == -1.0 )
      {
        v90 = *((float *)v3 + 26) - frame_dt * 15.0;
        *((float *)v3 + 26) = v90;
        if ( v90 < 0.0 )
          *((_DWORD *)v3 + 26) = 0;
        *((float *)v3 + 7) = cos(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v340 * 25.0;
        *((float *)v3 + 8) = sin(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v340 * 25.0;
        v91 = frame_dt * *((float *)v3 + 8);
        *(float *)&v382 = frame_dt * *((float *)v3 + 7);
        v383 = v91;
        goto LABEL_236;
      }
      v368 = v87;
      v57 = sub_413540(v368);
      if ( (int)*(&player_perk_counts + perk_id_long_distance_runner) <= 0 )
      {
        v89 = frame_dt * 5.0 + *((float *)v3 + 26);
        *((float *)v3 + 26) = v89;
        if ( v89 > 2.0 )
          *((_DWORD *)v3 + 26) = 0x40000000;
      }
      else
      {
        if ( *((float *)v3 + 26) < 2.0 )
          *((float *)v3 + 26) = frame_dt * 4.0 + *((float *)v3 + 26);
        v88 = frame_dt + *((float *)v3 + 26);
        *((float *)v3 + 26) = v88;
        if ( v88 > 2.8 )
          *((_DWORD *)v3 + 26) = 1077097267;
      }
      if ( *((_DWORD *)v3 + 176) == 7 && *((float *)v3 + 26) > 0.80000001 )
        *((_DWORD *)v3 + 26) = 1061997773;
      goto LABEL_116;
    case 4:
      if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
             grim_interface_ptr,
             config_key_reload) )
      {
        v42 = dword_4871F8[2 * render_overlay_player_index] - *(float *)&camera_offset_y;
        *(float *)&v380 = *(float *)&dword_4871F4[2 * render_overlay_player_index] - *(float *)&camera_offset_x;
        v381 = v42;
        *((float *)v3 + 201) = *(float *)&v380;
        *((float *)v3 + 202) = v381;
      }
      if ( *((_DWORD *)v3 + 201) != -1082130432 )
      {
        v43 = *((float *)v3 + 6) - *((float *)v3 + 202);
        v44 = *v4 - *((float *)v3 + 201);
        if ( sqrt(v44 * v44 + v43 * v43) > 20.0 )
        {
          v45 = atan2(v43, v44) - 1.5707964;
          *(float *)&v362 = v45;
          if ( v47 )
          {
            do
              v45 = v45 + 6.2831855;
            while ( v45 < 0.0 );
            *(float *)&v362 = v45;
          }
          if ( v45 != -1.0 )
          {
            v48 = sub_413540(*(float *)&v362);
            if ( (int)*(&player_perk_counts + perk_id_long_distance_runner) <= 0 )
            {
              v50 = frame_dt * 5.0 + *((float *)v3 + 26);
              *((float *)v3 + 26) = v50;
              if ( v50 > 2.0 )
                *((_DWORD *)v3 + 26) = 0x40000000;
            }
            else
            {
              if ( *((float *)v3 + 26) < 2.0 )
                *((float *)v3 + 26) = frame_dt * 4.0 + *((float *)v3 + 26);
              v49 = frame_dt + *((float *)v3 + 26);
              *((float *)v3 + 26) = v49;
              if ( v49 > 2.8 )
                *((_DWORD *)v3 + 26) = 1077097267;
            }
            if ( *((_DWORD *)v3 + 176) == 7 && *((float *)v3 + 26) > 0.80000001 )
              *((_DWORD *)v3 + 26) = 1061997773;
            v363 = 3.1415927 - v48;
            *((float *)v3 + 7) = cos(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v363 * v340 * 7.957747;
            *((float *)v3 + 8) = sin(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v363 * v340 * 7.957747;
            v51 = frame_dt * *((float *)v3 + 8);
            *(float *)&v382 = frame_dt * *((float *)v3 + 7);
            v383 = v51;
LABEL_236:
            player_apply_move_with_spawn_avoidance(render_overlay_player_index, v3 + 20, &v382);
            goto LABEL_237;
          }
        }
      }
      v52 = *((float *)v3 + 26) - frame_dt * 15.0;
      *((float *)v3 + 26) = v52;
      if ( v52 < 0.0 )
        *((_DWORD *)v3 + 26) = 0;
      goto LABEL_99;
    case 3:
      v364 = -((double (__thiscall *)(int, _DWORD))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
                grim_interface_ptr,
                *((_DWORD *)v3 + 215));
      *(float *)&v378 = -((double (__thiscall *)(int, _DWORD))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
                           grim_interface_ptr,
                           *((_DWORD *)v3 + 214));
      v379 = v364;
      if ( sqrt(*(float *)&v378 * *(float *)&v378 + v364 * v364) <= 0.2 )
        goto LABEL_117;
      j_FUN_00452f1d(&v378);
      v54 = atan2(v379, *(float *)&v378) - 1.5707964;
      *(float *)&v365 = v54;
      if ( v56 )
      {
        do
          v54 = v54 + 6.2831855;
        while ( v54 < 0.0 );
        *(float *)&v365 = v54;
      }
      if ( v54 == -1.0 )
      {
LABEL_117:
        v61 = *((float *)v3 + 26) - frame_dt * 15.0;
        *((float *)v3 + 26) = v61;
        if ( v61 < 0.0 )
          *((_DWORD *)v3 + 26) = 0;
LABEL_99:
        *((float *)v3 + 7) = cos(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v340 * 25.0;
        *((float *)v3 + 8) = sin(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v340 * 25.0;
        v53 = frame_dt * *((float *)v3 + 8);
        *(float *)&v382 = frame_dt * *((float *)v3 + 7);
        v383 = v53;
        player_apply_move_with_spawn_avoidance(render_overlay_player_index, v3 + 20, &v382);
LABEL_237:
        v77 = frame_dt * *((float *)v3 + 26);
        goto LABEL_238;
      }
      v57 = sub_413540(*(float *)&v365);
      if ( (int)*(&player_perk_counts + perk_id_long_distance_runner) <= 0 )
      {
        v59 = frame_dt * 5.0 + *((float *)v3 + 26);
        *((float *)v3 + 26) = v59;
        if ( v59 > 2.0 )
          *((_DWORD *)v3 + 26) = 0x40000000;
      }
      else
      {
        if ( *((float *)v3 + 26) < 2.0 )
          *((float *)v3 + 26) = frame_dt * 4.0 + *((float *)v3 + 26);
        v58 = frame_dt + *((float *)v3 + 26);
        *((float *)v3 + 26) = v58;
        if ( v58 > 2.8 )
          *((_DWORD *)v3 + 26) = 1077097267;
      }
      if ( *((_DWORD *)v3 + 176) == 7 && *((float *)v3 + 26) > 0.80000001 )
        *((_DWORD *)v3 + 26) = 1061997773;
LABEL_116:
      v366 = 3.1415927 - v57;
      *((float *)v3 + 7) = cos(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v366 * v340 * 7.957747;
      *((float *)v3 + 8) = sin(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v366 * v340 * 7.957747;
      v60 = frame_dt * *((float *)v3 + 8);
      *(float *)&v382 = frame_dt * *((float *)v3 + 7);
      v383 = v60;
      player_apply_move_with_spawn_avoidance(render_overlay_player_index, v3 + 20, &v382);
      goto LABEL_237;
    case 1:
      v62 = 0;
      if ( *((float *)v3 + 193) < 1.0 )
        *((_DWORD *)v3 + 193) = 1065353216;
      if ( *((float *)v3 + 193) > 7.0 )
        *((_DWORD *)v3 + 193) = 1088421888;
      v63 = (*(int (__thiscall **)(int, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 128))(
              grim_interface_ptr,
              *((_DWORD *)v3 + 205),
              v320);
      if ( (_BYTE)v63
        || config_player_count == 1
        && (LOBYTE(v63) = player_alt_turn_key_left,
            (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, v63)) )
      {
        v67 = frame_dt * 10.0 + *((float *)v3 + 193);
        *((float *)v3 + 193) = v67;
        *((float *)v3 + 11) = *((float *)v3 + 11) - v67 * frame_dt * 0.5;
        v66 = *((float *)v3 + 192) - frame_dt * *((float *)v3 + 193) * 0.5;
      }
      else
      {
        v64 = (*(int (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
                grim_interface_ptr,
                *((_DWORD *)v3 + 206));
        if ( !(_BYTE)v64 )
        {
          if ( config_player_count != 1
            || (LOBYTE(v64) = player_alt_turn_key_right,
                !(*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(
                   grim_interface_ptr,
                   v64)) )
          {
LABEL_134:
            v373 = 1.0;
            v68 = (*(int (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
                    grim_interface_ptr,
                    *((_DWORD *)v3 + 203));
            if ( (_BYTE)v68
              || config_player_count == 1
              && (LOBYTE(v68) = player_alt_move_key_forward,
                  (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(
                    grim_interface_ptr,
                    v68)) )
            {
              if ( (int)*(&player_perk_counts + perk_id_long_distance_runner) <= 0 )
              {
                v75 = frame_dt * 5.0 + *((float *)v3 + 26);
                *((float *)v3 + 26) = v75;
                if ( v75 > 2.0 )
                  *((_DWORD *)v3 + 26) = 0x40000000;
              }
              else
              {
                if ( *((float *)v3 + 26) < 2.0 )
                  *((float *)v3 + 26) = frame_dt * 4.0 + *((float *)v3 + 26);
                v74 = frame_dt + *((float *)v3 + 26);
                *((float *)v3 + 26) = v74;
                if ( v74 > 2.8 )
                  *((_DWORD *)v3 + 26) = 1077097267;
              }
              if ( *((_DWORD *)v3 + 176) == 7 && *((float *)v3 + 26) > 0.80000001 )
                *((_DWORD *)v3 + 26) = 1061997773;
            }
            else
            {
              v69 = (*(int (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
                      grim_interface_ptr,
                      *((_DWORD *)v3 + 204));
              if ( (_BYTE)v69
                || config_player_count == 1
                && (LOBYTE(v69) = player_alt_move_key_backward,
                    (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(
                      grim_interface_ptr,
                      v69)) )
              {
                if ( (int)*(&player_perk_counts + perk_id_long_distance_runner) <= 0 )
                {
                  v72 = frame_dt * 5.0 + *((float *)v3 + 26);
                  *((float *)v3 + 26) = v72;
                  if ( v72 > 2.0 )
                    *((_DWORD *)v3 + 26) = 0x40000000;
                }
                else
                {
                  if ( *((float *)v3 + 26) < 2.0 )
                    *((float *)v3 + 26) = frame_dt * 4.0 + *((float *)v3 + 26);
                  v71 = frame_dt + *((float *)v3 + 26);
                  *((float *)v3 + 26) = v71;
                  if ( v71 > 2.8 )
                    *((_DWORD *)v3 + 26) = 1077097267;
                }
                v361 = -1.0;
                *((float *)v3 + 7) = cos(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v340 * -25.0;
                *((float *)v3 + 8) = sin(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v340 * -25.0;
                v73 = frame_dt * *((float *)v3 + 8);
                *(float *)&v382 = frame_dt * *((float *)v3 + 7);
                v383 = v73;
                goto LABEL_164;
              }
              if ( !v62 )
                *((_DWORD *)v3 + 193) = 1065353216;
              v70 = *((float *)v3 + 26) - frame_dt * 15.0;
              *((float *)v3 + 26) = v70;
              if ( v70 < 0.0 )
                *((_DWORD *)v3 + 26) = 0;
            }
            *((float *)v3 + 7) = cos(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v340 * 25.0;
            *((float *)v3 + 8) = sin(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v340 * 25.0;
            v76 = frame_dt * *((float *)v3 + 8);
            *(float *)&v382 = frame_dt * *((float *)v3 + 7);
            v383 = v76;
LABEL_164:
            player_apply_move_with_spawn_avoidance(render_overlay_player_index, v3 + 20, &v382);
            v77 = v361 * *((float *)v3 + 26) * frame_dt;
LABEL_238:
            *((float *)v3 + 37) = v77 * 19.0 + *((float *)v3 + 37);
            break;
          }
        }
        v65 = frame_dt * 10.0 + *((float *)v3 + 193);
        *((float *)v3 + 193) = v65;
        *((float *)v3 + 11) = v65 * frame_dt * 0.5 + *((float *)v3 + 11);
        v66 = frame_dt * *((float *)v3 + 193) * 0.5 + *((float *)v3 + 192);
      }
      *((float *)v3 + 192) = v66;
      v62 = 1;
      goto LABEL_134;
    case 2:
      if ( (*(unsigned __int8 (__thiscall **)(int, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 128))(
             grim_interface_ptr,
             *((_DWORD *)v3 + 205),
             v320)
        || config_player_count == 1
        && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
             grim_interface_ptr,
             player_alt_turn_key_left) )
      {
        v340 = 4.712389;
      }
      if ( (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
             grim_interface_ptr,
             *((_DWORD *)v3 + 206))
        || config_player_count == 1
        && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
             grim_interface_ptr,
             player_alt_turn_key_right) )
      {
        v340 = 1.5707964;
      }
      if ( (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
             grim_interface_ptr,
             *((_DWORD *)v3 + 203))
        || config_player_count == 1
        && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
             grim_interface_ptr,
             player_alt_move_key_forward) )
      {
        if ( (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
               grim_interface_ptr,
               *((_DWORD *)v3 + 205))
          || config_player_count == 1
          && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
               grim_interface_ptr,
               player_alt_turn_key_left) )
        {
          v340 = 5.4977875;
        }
        else if ( (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
                    grim_interface_ptr,
                    *((_DWORD *)v3 + 206))
               || config_player_count == 1
               && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
                    grim_interface_ptr,
                    player_alt_turn_key_right) )
        {
          v340 = 0.78539819;
        }
        else
        {
          v340 = 0.0;
        }
      }
      if ( (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
             grim_interface_ptr,
             *((_DWORD *)v3 + 204))
        || config_player_count == 1
        && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
             grim_interface_ptr,
             player_alt_move_key_backward) )
      {
        if ( (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
               grim_interface_ptr,
               *((_DWORD *)v3 + 205))
          || config_player_count == 1
          && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
               grim_interface_ptr,
               player_alt_turn_key_left) )
        {
          v78 = sub_413540(3.926991);
        }
        else if ( (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
                    grim_interface_ptr,
                    *((_DWORD *)v3 + 206))
               || config_player_count == 1
               && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
                    grim_interface_ptr,
                    player_alt_turn_key_right) )
        {
          v78 = sub_413540(2.3561945);
        }
        else
        {
          v78 = sub_413540(3.1415927);
        }
        *((float *)v3 + 192) = flt_487198 + *((float *)v3 + 192);
        if ( (int)*(&player_perk_counts + perk_id_long_distance_runner) <= 0 )
        {
          v80 = frame_dt * 5.0 + *((float *)v3 + 26);
          *((float *)v3 + 26) = v80;
          if ( v80 > 2.0 )
            *((_DWORD *)v3 + 26) = 0x40000000;
        }
        else
        {
          if ( *((float *)v3 + 26) < 2.0 )
            *((float *)v3 + 26) = frame_dt * 4.0 + *((float *)v3 + 26);
          v79 = frame_dt + *((float *)v3 + 26);
          *((float *)v3 + 26) = v79;
          if ( v79 > 2.8 )
            *((_DWORD *)v3 + 26) = 1077097267;
        }
        if ( *((_DWORD *)v3 + 176) == 7 && *((float *)v3 + 26) > 0.80000001 )
          *((_DWORD *)v3 + 26) = 1061997773;
        v367 = 3.1415927 - v78;
        *((float *)v3 + 7) = cos(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v367 * v340 * 7.957747;
        *((float *)v3 + 8) = sin(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v367 * v340 * 7.957747;
        v81 = frame_dt * *((float *)v3 + 8);
        *(float *)&v382 = frame_dt * *((float *)v3 + 7);
        v383 = v81;
        player_apply_move_with_spawn_avoidance(render_overlay_player_index, v3 + 20, &v382);
      }
      else
      {
        v82 = *((float *)v3 + 26) - frame_dt * 15.0;
        *((float *)v3 + 26) = v82;
        if ( v82 < 0.0 )
          *((_DWORD *)v3 + 26) = 0;
        *((float *)v3 + 7) = cos(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v340 * 25.0;
        *((float *)v3 + 8) = sin(*((float *)v3 + 11) - 1.5707964) * *((float *)v3 + 26) * v340 * 25.0;
        v83 = frame_dt * *((float *)v3 + 8);
        *(float *)&v382 = frame_dt * *((float *)v3 + 7);
        v383 = v83;
        player_apply_move_with_spawn_avoidance(render_overlay_player_index, v3 + 20, &v382);
      }
      *((float *)v3 + 37) = frame_dt * *((float *)v3 + 26) * 19.0 + *((float *)v3 + 37);
      break;
  }
  if ( time_scale_active )
    frame_dt = *(float *)&time_scale_factor * frame_dt * 1.6666666;
  v92 = perk_count_get(perk_id_sharpshooter);
  v93 = frame_dt;
  if ( v92 )
  {
    v94 = *((float *)v3 + 174) - (v93 + v93);
    *((float *)v3 + 174) = v94;
    if ( v94 < 0.25 )
      *((_DWORD *)v3 + 174) = 1048576000;
    *((_DWORD *)v3 + 174) = 1017370378;
  }
  else
  {
    v95 = *((float *)v3 + 174) - v93 * 0.40000001;
    *((float *)v3 + 174) = v95;
    if ( v95 < 0.0099999998 )
      *((_DWORD *)v3 + 174) = 1008981770;
  }
  if ( perk_count_get(perk_id_anxious_loader) )
  {
    if ( (unsigned __int8)input_primary_just_pressed() )
    {
      if ( *((float *)v3 + 180) > 0.0 )
      {
        v96 = *((float *)v3 + 180) - 0.050000001;
        *((float *)v3 + 180) = v96;
        if ( v96 <= 0.0 )
          *((float *)v3 + 180) = frame_dt * 0.80000001;
      }
    }
  }
  if ( *((float *)v3 + 180) - frame_dt < 0.0 && *((float *)v3 + 180) > 0.0 )
    *((_DWORD *)v3 + 179) = *((_DWORD *)v3 + 177);
  v369 = 1.0;
  if ( *v4 == *(float *)&v376 && *((float *)v3 + 6) == v377 )
  {
    if ( perk_count_get(perk_id_stationary_reloader) )
      v369 = 3.0;
  }
  else
  {
    *((_DWORD *)v3 + 40) = 0;
    *((_DWORD *)v3 + 41) = 0;
  }
  if ( perk_count_get(perk_id_angry_reloader)
    && *((float *)v3 + 182) > 0.5
    && (v97 = *((float *)v3 + 182) * 0.5, v97 < *((float *)v3 + 180)) )
  {
    v98 = *((float *)v3 + 180) - v369 * frame_dt;
    *((float *)v3 + 180) = v98;
    if ( v98 <= v97 )
    {
      bonus_spawn_guard = 1;
      if ( *(float *)(dword_48086C + 12) == 0.0 )
        v369 = NAN;
      else
        LODWORD(v369) = -1 - render_overlay_player_index;
      v99 = 0;
      LODWORD(v100) = 7 - (__int64)(*((float *)v3 + 182) * -4.0);
      v341 = 0;
      v375[0] = v100;
      if ( SLODWORD(v100) > 0 )
      {
        v375[0] = 6.2831855 / (double)SLODWORD(v375[0]);
        do
        {
          v306 = (double)v341 * v375[0] + 0.1;
          projectile_spawn((int)(v3 + 20), v306, 11, SLODWORD(v369));
          v341 = ++v99;
        }
        while ( v99 < SLODWORD(v100) );
      }
      bonus_spawn_guard = 0;
      sfx_play_panned(sfx_explosion_small, (int)(v3 + 20), 1.0);
    }
  }
  else
  {
    *((float *)v3 + 180) = *((float *)v3 + 180) - v369 * frame_dt;
  }
  if ( *((float *)v3 + 180) < 0.0 )
    *((_DWORD *)v3 + 180) = 0;
  if ( demo_mode_active )
    goto LABEL_281;
  v101 = perk_count_get(perk_id_alternate_weapon);
  v102 = render_overlay_player_index;
  if ( !v101 && config_player_mode_flags[render_overlay_player_index] != 4 )
  {
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
           grim_interface_ptr,
           config_key_reload)
      && *((float *)v3 + 180) == 0.0
      && config_player_count == 1 )
    {
      player_start_reload();
    }
LABEL_281:
    v102 = render_overlay_player_index;
  }
  v322 = 0;
  if ( demo_mode_active || (v103 = config_aim_scheme[v102], v103 == 5) )
  {
    v119 = (float *)(v3 + 80);
    v120 = creature_pos_y[38 * *((_DWORD *)v3 + 200)] - *((float *)v3 + 21);
    *(float *)&v378 = *((float *)&creature_pos_x + 38 * *((_DWORD *)v3 + 200)) - *((float *)v3 + 20);
    v379 = v120;
    v121 = sqrt(*(float *)&v378 * *(float *)&v378 + v120 * v120);
    *(float *)&v370 = v121;
    if ( v121 >= 4.0 )
    {
      j_FUN_00452f1d(&v378);
      v123 = *(float *)&v370 * 6.0 * frame_dt;
      *(float *)&v382 = *(float *)&v378 * v123;
      v124 = v123 * v379;
      *v119 = *(float *)&v382 + *v119;
      *((float *)v3 + 21) = v124 + *((float *)v3 + 21);
    }
    else
    {
      v122 = 19 * *((_DWORD *)v3 + 200);
      *(_DWORD *)v119 = *(&creature_pos_x + 38 * *((_DWORD *)v3 + 200));
      *((float *)v3 + 21) = creature_pos_y[2 * v122];
    }
    if ( *(float *)&v370 < 128.0 && *(float *)&creature_health[38 * *((_DWORD *)v3 + 200)] > 0.0 )
      v322 = 1;
  }
  else
  {
    if ( !v103 )
    {
      v104 = dword_4871F8[2 * v102] - *(float *)&camera_offset_y;
      *(float *)&v380 = *(float *)&dword_4871F4[2 * v102] - *(float *)&camera_offset_x;
      v381 = v104;
      *((float *)v3 + 20) = *(float *)&v380;
      *((float *)v3 + 21) = v381;
LABEL_286:
      *((float *)v3 + 192) = atan2(*((float *)v3 + 6) - *((float *)v3 + 21), *v4 - *((float *)v3 + 20)) - 1.5707964;
      goto LABEL_317;
    }
    if ( v103 == 4 )
    {
      *(float *)&v374 = ((double (__thiscall *)(int, _DWORD, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
                          grim_interface_ptr,
                          *((_DWORD *)v3 + 213),
                          v320);
      v379 = ((double (__thiscall *)(int, _DWORD))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
               grim_interface_ptr,
               *((_DWORD *)v3 + 212));
      v380 = v374;
      v105 = sqrt(v379 * v379 + *(float *)&v374 * *(float *)&v374);
      if ( v105 <= 1.0 )
        v373 = v105;
      else
        v373 = 1.0;
      j_FUN_00452f1d(&v379);
      v106 = v369 * *(float *)(dword_480880 + 12) + 42.0;
      *(float *)&v382 = v106 * *(float *)&v378;
      v107 = v106 * v379 + *((float *)v3 + 6);
      *(float *)&v380 = *(float *)&v382 + *v4;
      v381 = v107;
      *((float *)v3 + 20) = *(float *)&v380;
      *((float *)v3 + 21) = v381;
      goto LABEL_286;
    }
    if ( v103 != 3 )
    {
      if ( v103 == 1 )
      {
        v115 = config_player_mode_flags[v102];
        if ( v115 != 1 && v115 != 2 )
          goto LABEL_317;
        if ( (*(unsigned __int8 (__thiscall **)(int, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 128))(
               grim_interface_ptr,
               *((_DWORD *)v3 + 211),
               v320) )
        {
          *((float *)v3 + 192) = frame_dt * 3.0 + *((float *)v3 + 192);
        }
        if ( (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
               grim_interface_ptr,
               *((_DWORD *)v3 + 210)) )
        {
          *((float *)v3 + 192) = *((float *)v3 + 192) - frame_dt * 3.0;
        }
      }
      else
      {
        if ( (unsigned __int8)sub_41E8D0() )
          *((float *)v3 + 192) = *((float *)v3 + 192) - frame_dt * 4.0;
        if ( (unsigned __int8)sub_41E8F0() )
          *((float *)v3 + 192) = frame_dt * 4.0 + *((float *)v3 + 192);
      }
      v116 = *((float *)v3 + 192) - 1.5707964;
      v375[0] = v116;
      v383 = sin(v375[0]);
      v117 = cos(v116) * 60.0;
      v118 = v383 * 60.0 + *((float *)v3 + 6);
      *(float *)&v380 = v117 + *v4;
      v381 = v118;
      *((float *)v3 + 20) = *(float *)&v380;
      *((float *)v3 + 21) = v381;
      goto LABEL_317;
    }
    v108 = dword_4871F8[2 * v102] - 200.0;
    *(float *)&v378 = *(float *)&dword_4871F4[2 * v102] - 200.0;
    v379 = v108;
    if ( *(float *)&v378 != 0.0 || v108 != 0.0 )
    {
      v109 = atan2(v108, *(float *)&v378) + 1.5707964;
      *((float *)v3 + 192) = v109;
      v110 = v109 - 1.5707964;
      v375[0] = v110;
      v383 = sin(v375[0]);
      v111 = cos(v110) * 60.0;
      v112 = v383 * 60.0 + *((float *)v3 + 6);
      *(float *)&v380 = v111 + *v4;
      v381 = v112;
      *((float *)v3 + 20) = *(float *)&v380;
      *((float *)v3 + 21) = v381;
    }
    if ( sqrt(v379 * v379 + *(float *)&v378 * *(float *)&v378) > 30.0 )
    {
      j_FUN_00452f1d(&v378);
      v113 = render_overlay_player_index;
      v383 = v379 * 30.0;
      *(float *)&v380 = *(float *)&v378 * 30.0 + 200.0;
      v114 = v383 + 200.0;
      dword_4871F4[2 * render_overlay_player_index] = v380;
      v381 = v114;
      dword_4871F8[2 * v113] = v381;
    }
  }
LABEL_317:
  v125 = (float *)(v3 + 724);
  v126 = 0;
  v321 = 0;
  *((float *)v3 + 192) = atan2(*((float *)v3 + 6) - *((float *)v3 + 21), *v4 - *((float *)v3 + 20)) - 1.5707964;
  if ( *((float *)v3 + 181) <= 0.0 && *((float *)v3 + 180) == 0.0 )
  {
    v126 = 1;
    v3[712] = 0;
  }
  if ( *v125 <= 0.0
    && *((int *)v3 + 43) > 0
    && (perk_count_get(perk_id_regression_bullets) || perk_count_get(perk_id_ammunition_within)) )
  {
    v321 = 1;
  }
  if ( perk_count_get(perk_id_alternate_weapon) )
  {
    if ( (dword_48719C <= 0 || (dword_48719C -= frame_dt_ms, dword_48719C <= 0))
      && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
           grim_interface_ptr,
           config_key_reload) )
    {
      v127 = *((_DWORD *)v3 + 183);
      *((_DWORD *)v3 + 183) = *((_DWORD *)v3 + 176);
      *((_DWORD *)v3 + 176) = v127;
      v128 = *((float *)v3 + 184);
      *((_DWORD *)v3 + 184) = *((_DWORD *)v3 + 177);
      *((float *)v3 + 177) = v128;
      LOBYTE(v127) = v3[740];
      v3[740] = v3[712];
      v3[712] = v127;
      v129 = *((float *)v3 + 186);
      *((_DWORD *)v3 + 186) = *((_DWORD *)v3 + 179);
      *((float *)v3 + 179) = v129;
      v130 = *((float *)v3 + 187);
      *((_DWORD *)v3 + 187) = *((_DWORD *)v3 + 180);
      *((float *)v3 + 180) = v130;
      v131 = *((float *)v3 + 188);
      *((float *)v3 + 188) = *v125;
      *v125 = v131;
      v132 = *((float *)v3 + 189);
      *((_DWORD *)v3 + 189) = *((_DWORD *)v3 + 182);
      *((float *)v3 + 182) = v132;
      sfx_play_panned(*(&dword_4D7A8C + 31 * *((_DWORD *)v3 + 176)), (int)(v3 + 20), 1.0);
      *v125 = *v125 + 0.1;
      dword_48719C = 200;
    }
    else if ( !(*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
                 grim_interface_ptr,
                 config_key_reload) )
    {
      dword_48719C = 0;
    }
  }
  if ( !v126 && !v321 )
    goto LABEL_459;
  v342 = *((float *)v3 + 192);
  if ( !(*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 128))(
          grim_interface_ptr,
          *((_DWORD *)v3 + 207))
    && !v322 )
  {
    goto LABEL_459;
  }
  survival_reward_fire_seen = 1;
  if ( !v126 )
  {
    if ( perk_count_get(perk_id_regression_bullets) )
    {
      v133 = (double)*((int *)v3 + 43);
      v134 = flt_4D7A78[31 * *((_DWORD *)v3 + 176)];
      if ( weapon_ammo_class[31 * *((_DWORD *)v3 + 176)] == 1 )
        *((_DWORD *)v3 + 43) = (__int64)(v133 - v134 * 4.0);
      else
        *((_DWORD *)v3 + 43) = (__int64)(v133 - v134 * 200.0);
    }
    else if ( perk_count_get(perk_id_ammunition_within) )
    {
      if ( weapon_ammo_class[31 * *((_DWORD *)v3 + 176)] == 1 )
        player_take_damage(render_overlay_player_index, 0.15000001);
      else
        player_take_damage(render_overlay_player_index, 1.0);
    }
    if ( *((int *)v3 + 43) < 0 )
      *((_DWORD *)v3 + 43) = 0;
  }
  v135 = v342 - 1.5707964;
  v326 = v135;
  v136 = v135 - 0.150915;
  *(float *)&v378 = cos(v136) * 16.0;
  v379 = sin(v136) * 16.0;
  if ( (byte_4D7A94[124 * *((_DWORD *)v3 + 176)] & 1) != 0 )
  {
    LODWORD(v375[0]) = crt_rand() & 0x3F;
    v371 = (double)SLODWORD(v375[0]) * 0.0099999998 + v342;
    v137 = crt_rand();
    *(float *)&v382 = 1.0;
    LODWORD(v375[0]) = v137 & 0x3F;
    v383 = 1.0;
    v384 = 1065353216;
    v385 = 1058642330;
    effect_template_color_r = 1065353216;
    effect_template_flags = 453;
    v138 = (double)SLODWORD(v375[0]) * 0.022727273 + 1.0;
    effect_template_color_g = 1065353216;
    effect_template_color_b = 1065353216;
    effect_template_color_a = 1058642330;
    effect_template_lifetime = 1041865114;
    effect_template_age = 0;
    *(float *)&v380 = cos(v371) * v138;
    v381 = sin(v371) * v138;
    v139 = crt_rand();
    effect_template_half_height = 0x40000000;
    effect_template_half_width = 0x40000000;
    LODWORD(v375[0]) = (v139 & 0x3F) - 32;
    *(float *)&effect_template_rotation = (double)SLODWORD(v375[0]) * 0.1;
    *(float *)&effect_template_vel_x = *(float *)&v380 * 100.0;
    *(float *)&effect_template_vel_y = v381 * 100.0;
    v140 = crt_rand();
    effect_template_scale_step = 0;
    LODWORD(v375[0]) = v140 % 20;
    effect_template_rotation_step = ((double)(v140 % 20) * 0.1 - 1.0) * 14.0;
    v141 = v379 + *((float *)v3 + 6);
    *(float *)&v382 = *(float *)&v378 + *v4;
    v383 = v141;
    effect_spawn(18, &v382);
  }
  if ( *(float *)LODWORD(v373) > 1.0 )
    *(_DWORD *)LODWORD(v373) = 1065353216;
  v372 = 1.0;
  if ( *(float *)(dword_48086C + 12) == 0.0 )
    v142 = -100;
  else
    v142 = -1 - render_overlay_player_index;
  v143 = 864 * render_overlay_player_index;
  v144 = player_aim_x[216 * render_overlay_player_index];
  v381 = *(float *)&player_aim_y[216 * render_overlay_player_index];
  v380 = v144;
  v145 = v381 - *(float *)&player_pos_y[216 * render_overlay_player_index];
  *(float *)&v382 = *(float *)&v144 - *(float *)&player_pos_x[216 * render_overlay_player_index];
  v383 = v145;
  *(float *)&v376 = sub_417660(&v382) * 0.5;
  LODWORD(v375[0]) = crt_rand() & 0x1FF;
  v323 = (double)SLODWORD(v375[0]) * 0.012271847;
  LODWORD(v375[0]) = crt_rand() & 0x1FF;
  v146 = (double)SLODWORD(v375[0]) * (*(float *)&v376 * *(float *)(v143 + 4787048)) * 0.001953125;
  *(float *)&v380 = cos(v323) * v146 + *(float *)&v380;
  v324 = atan2(*(float *)(v143 + 4786376) - (v146 * sin(v323) + v381), *(float *)(v143 + 4786372) - *(float *)&v380)
       - 1.5707964;
  if ( (*(unsigned __int8 (__stdcall **)(int))(*(_DWORD *)grim_interface_ptr + 128))(34) )
    *((_DWORD *)v3 + 199) = 1092616192;
  if ( *((float *)v3 + 199) <= 0.0 )
  {
    *((_DWORD *)v3 + 181) = dword_4D7A74[31 * *((_DWORD *)v3 + 176)];
    *(float *)LODWORD(v373) = flt_4D7A7C[31 * *((_DWORD *)v3 + 176)] + *(float *)LODWORD(v373);
    v153 = 31 * *((_DWORD *)v3 + 176);
    v154 = crt_rand();
    sfx_play_panned(*(int *)((char *)&dword_4D7A84 + v153 * 4) + v154 % dword_4D7A88[v153], (int)(v3 + 20), 1.0);
    v155 = *((_DWORD *)v3 + 176);
    if ( v155 == 24 )
    {
      v156 = v379 + *((float *)v3 + 6);
      *(float *)&v382 = *(float *)&v378 + *v4;
      v383 = v156;
      projectile_spawn((int)&v382, v324, 24, v142);
      v157 = cos(v342);
      v327 = v157;
      *(float *)&v382 = v157 * 25.0;
      v158 = sin(v342);
      v343 = v158;
      v383 = v158 * 25.0;
      v159 = v379 + *((float *)v3 + 6);
      *(float *)&v380 = *(float *)&v378 + *v4;
      v381 = v159;
      v160 = fx_spawn_sprite(&v380, &v382, 1065353216);
      *(float *)&v382 = v327 * 15.0;
      v160 *= 44;
      v383 = v343 * 15.0;
      v161 = v379;
      *(int *)((char *)sprite_effect_color_r + v160) = 1056964608;
      *(int *)((char *)sprite_effect_color_g + v160) = 1056964608;
      *(int *)((char *)sprite_effect_color_b + v160) = 1056964608;
      *(int *)((char *)sprite_effect_color_a + v160) = 1047233823;
      v162 = v161 + *((float *)v3 + 6);
      *(float *)&v380 = *(float *)&v378 + *v4;
      v381 = v162;
      v163 = fx_spawn_sprite(&v380, &v382, 0x40000000);
    }
    else
    {
      if ( v155 != 1 )
      {
        switch ( v155 )
        {
          case 2:
            v172 = cos(v342);
            v329 = v172;
            *(float *)&v382 = v172 * 25.0;
            v173 = sin(v342);
            v345 = v173;
            v383 = v173 * 25.0;
            v174 = v379 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v174;
            v175 = fx_spawn_sprite(&v380, &v382, 1065353216);
            *(float *)&v382 = v329 * 15.0;
            v175 *= 44;
            v383 = v345 * 15.0;
            v176 = v379;
            *(int *)((char *)sprite_effect_color_r + v175) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v175) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v175) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v175) = 1047233823;
            v177 = v176 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v177;
            v178 = fx_spawn_sprite(&v380, &v382, 0x40000000);
            v179 = v379;
            v178 *= 44;
            *(int *)((char *)sprite_effect_color_r + v178) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v178) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v178) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v178) = 1046092972;
            v180 = v179 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v180;
            projectile_spawn((int)&v382, v324, 2, v142);
            break;
          case 3:
            v181 = cos(v342);
            v330 = v181;
            *(float *)&v382 = v181 * 25.0;
            v182 = sin(v342);
            v346 = v182;
            v383 = v182 * 25.0;
            v183 = v379 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v183;
            v184 = fx_spawn_sprite(&v380, &v382, 1065353216);
            *(float *)&v382 = v330 * 15.0;
            v184 *= 44;
            v383 = v346 * 15.0;
            v185 = v379;
            *(int *)((char *)sprite_effect_color_r + v184) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v184) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v184) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v184) = 1048576000;
            v186 = v185 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v186;
            v347 = 12;
            v187 = 11 * fx_spawn_sprite(&v380, &v382, 0x40000000);
            sprite_effect_color_r[v187] = 1056964608;
            sprite_effect_color_g[v187] = 1056964608;
            sprite_effect_color_b[v187] = 1056964608;
            sprite_effect_color_a[v187] = 1046764061;
            do
            {
              v188 = v379 + *((float *)v3 + 6);
              *(float *)&v382 = *(float *)&v378 + *v4;
              v383 = v188;
              v376 = crt_rand() % 200 - 100;
              v307 = (double)v376 * 0.0013 + v324;
              v189 = projectile_spawn((int)&v382, v307, 3, v142);
              v190 = crt_rand();
              v191 = v347-- == 1;
              v376 = v190 % 100;
              projectile_speed_scale[16 * v189] = (double)(v190 % 100) * 0.0099999998 + 1.0;
            }
            while ( !v191 );
            break;
          case 20:
            *(float *)&v382 = cos(v342) * 15.0;
            v383 = sin(v342) * 15.0;
            v192 = v379 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v192;
            v348 = 4;
            v193 = 11 * fx_spawn_sprite(&v380, &v382, 0x40000000);
            sprite_effect_color_r[v193] = 1056964608;
            sprite_effect_color_g[v193] = 1056964608;
            sprite_effect_color_b[v193] = 1056964608;
            sprite_effect_color_a[v193] = 1046764061;
            do
            {
              v194 = v379 + *((float *)v3 + 6);
              *(float *)&v382 = *(float *)&v378 + *v4;
              v383 = v194;
              v376 = crt_rand() % 200 - 100;
              v308 = (double)v376 * 0.0013 + v324;
              v195 = projectile_spawn((int)&v382, v308, 3, v142);
              v196 = crt_rand();
              v191 = v348-- == 1;
              v376 = v196 % 100;
              projectile_speed_scale[16 * v195] = (double)(v196 % 100) * 0.0099999998 + 1.0;
            }
            while ( !v191 );
            break;
          case 4:
            v197 = cos(v342);
            v331 = v197;
            *(float *)&v382 = v197 * 25.0;
            v198 = sin(v342);
            v349 = v198;
            v383 = v198 * 25.0;
            v199 = v379 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v199;
            v200 = fx_spawn_sprite(&v380, &v382, 1065353216);
            *(float *)&v382 = v331 * 15.0;
            v200 *= 44;
            v383 = v349 * 15.0;
            v201 = v379;
            *(int *)((char *)sprite_effect_color_r + v200) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v200) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v200) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v200) = 1048911544;
            v202 = v201 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v202;
            v350 = 12;
            v203 = 11 * fx_spawn_sprite(&v380, &v382, 0x40000000);
            sprite_effect_color_r[v203] = 1056964608;
            sprite_effect_color_g[v203] = 1056964608;
            sprite_effect_color_b[v203] = 1056964608;
            sprite_effect_color_a[v203] = 1047435149;
            do
            {
              v204 = v379 + *((float *)v3 + 6);
              *(float *)&v382 = *(float *)&v378 + *v4;
              v383 = v204;
              v376 = crt_rand() % 200 - 100;
              v309 = (double)v376 * 0.0040000002 + v324;
              v205 = projectile_spawn((int)&v382, v309, 3, v142);
              v206 = crt_rand();
              v191 = v350-- == 1;
              v376 = v206 % 100;
              projectile_speed_scale[16 * v205] = (double)(v206 % 100) * 0.0099999998 + 1.0;
            }
            while ( !v191 );
            break;
          case 8:
            v207 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v207;
            fx_spawn_particle((int)&v382, v326, (int)(v3 + 28), 1065353216);
            v372 = 0.1;
            break;
          case 16:
            v208 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v208;
            v209 = fx_spawn_particle((int)&v382, v326, (int)(v3 + 28), 1065353216);
            if ( v209 != -1 )
              particle_style_id[56 * v209] = 2;
            v372 = 0.1;
            break;
          case 15:
            v210 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v210;
            v211 = fx_spawn_particle((int)&v382, v326, (int)(v3 + 28), 1065353216);
            if ( v211 != -1 )
              particle_style_id[56 * v211] = 1;
            v372 = 0.050000001;
            break;
          case 5:
            v212 = cos(v342);
            v332 = v212;
            *(float *)&v382 = v212 * 25.0;
            v213 = sin(v342);
            v351 = v213;
            v383 = v213 * 25.0;
            v214 = v379 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v214;
            v215 = fx_spawn_sprite(&v380, &v382, 1065353216);
            *(float *)&v382 = v332 * 15.0;
            v215 *= 44;
            v383 = v351 * 15.0;
            v216 = v379;
            *(int *)((char *)sprite_effect_color_r + v215) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v215) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v215) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v215) = 1047233823;
            v217 = v216 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v217;
            v218 = fx_spawn_sprite(&v380, &v382, 0x40000000);
            v219 = v379;
            v218 *= 44;
            *(int *)((char *)sprite_effect_color_r + v218) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v218) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v218) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v218) = 1046092972;
            v220 = v219 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v220;
            projectile_spawn((int)&v382, v324, 5, v142);
            break;
          case 9:
            v221 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v221;
            projectile_spawn((int)&v382, v324, 9, v142);
            break;
          case 10:
            v222 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v222;
            v310 = v324 - 0.31415927;
            projectile_spawn((int)&v382, v310, 9, v142);
            v223 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v223;
            v311 = v324 - 0.52359879;
            projectile_spawn((int)&v382, v311, 11, v142);
            v224 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v224;
            projectile_spawn((int)&v382, v324, 9, v142);
            v225 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v225;
            v312 = v324 + 0.52359879;
            projectile_spawn((int)&v382, v312, 11, v142);
            v226 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v226;
            v313 = v324 + 0.31415927;
            projectile_spawn((int)&v382, v313, 9, v142);
            break;
          case 19:
            v227 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v227;
            projectile_spawn((int)&v382, v324, 19, v142);
            break;
          case 25:
            v228 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v228;
            projectile_spawn((int)&v382, v324, 25, v142);
            break;
          case 29:
            v229 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v229;
            projectile_spawn((int)&v382, v324, 29, v142);
            break;
          case 21:
            v230 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v230;
            projectile_spawn((int)&v382, v324, 21, v142);
            break;
          case 22:
            v231 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v231;
            projectile_spawn((int)&v382, v324, 22, v142);
            break;
          case 23:
            v232 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v232;
            projectile_spawn((int)&v382, v324, 23, v142);
            break;
          case 28:
            v233 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v233;
            projectile_spawn((int)&v382, v324, 28, v142);
            break;
          case 31:
            v352 = 8;
            do
            {
              v234 = v379 + *((float *)v3 + 6);
              *(float *)&v382 = *(float *)&v378 + *v4;
              v383 = v234;
              v376 = crt_rand() % 200 - 100;
              v314 = (double)v376 * 0.0026 + v324;
              v235 = projectile_spawn((int)&v382, v314, 22, v142);
              v236 = crt_rand();
              v191 = v352-- == 1;
              v376 = v236 % 80;
              projectile_speed_scale[16 * v235] = (double)(v236 % 80) * 0.0099999998 + 1.4;
            }
            while ( !v191 );
            break;
          case 11:
            v237 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v237;
            projectile_spawn((int)&v382, v324, 11, v142);
            break;
          case 30:
            v238 = cos(v342);
            v333 = v238;
            *(float *)&v382 = v238 * 25.0;
            v239 = sin(v342);
            v353 = v239;
            v383 = v239 * 25.0;
            v240 = v379 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v240;
            v241 = fx_spawn_sprite(&v380, &v382, 1065353216);
            *(float *)&v382 = v333 * 15.0;
            v241 *= 44;
            v383 = v353 * 15.0;
            v242 = v379;
            *(int *)((char *)sprite_effect_color_r + v241) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v241) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v241) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v241) = 1051260355;
            v243 = v242 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v243;
            v354 = 6;
            v244 = 11 * fx_spawn_sprite(&v380, &v382, 0x40000000);
            sprite_effect_color_r[v244] = 1056964608;
            sprite_effect_color_g[v244] = 1056964608;
            sprite_effect_color_b[v244] = 1056964608;
            sprite_effect_color_a[v244] = 1049012208;
            do
            {
              v245 = v379 + *((float *)v3 + 6);
              *(float *)&v382 = *(float *)&v378 + *v4;
              v383 = v245;
              v376 = crt_rand() % 200 - 100;
              v315 = (double)v376 * 0.0020000001 + v324;
              v246 = projectile_spawn((int)&v382, v315, 6, v142);
              v247 = crt_rand();
              v191 = v354-- == 1;
              v376 = v247 % 80;
              projectile_speed_scale[16 * v246] = (double)(v247 % 80) * 0.0099999998 + 1.4;
            }
            while ( !v191 );
            break;
          case 6:
            v248 = cos(v342);
            v334 = v248;
            *(float *)&v382 = v248 * 25.0;
            v249 = sin(v342);
            v355 = v249;
            v383 = v249 * 25.0;
            v250 = v379 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v250;
            v251 = fx_spawn_sprite(&v380, &v382, 1065353216);
            *(float *)&v382 = v334 * 15.0;
            v251 *= 44;
            v383 = v355 * 15.0;
            v252 = v379;
            *(int *)((char *)sprite_effect_color_r + v251) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v251) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v251) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v251) = 1051260355;
            v253 = v252 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v253;
            v254 = fx_spawn_sprite(&v380, &v382, 0x40000000);
            v255 = v379;
            v254 *= 44;
            *(int *)((char *)sprite_effect_color_r + v254) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v254) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v254) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v254) = 1049012208;
            v256 = v255 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v256;
            projectile_spawn((int)&v382, v324, 6, v142);
            break;
          case 12:
            v257 = cos(v342);
            v335 = v257;
            *(float *)&v382 = v257 * 25.0;
            v258 = sin(v342);
            v356 = v258;
            v383 = v258 * 25.0;
            v259 = v379 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v259;
            v260 = fx_spawn_sprite(&v380, &v382, 1065353216);
            *(float *)&v382 = v335 * 15.0;
            v260 *= 44;
            v383 = v356 * 15.0;
            v261 = v379;
            *(int *)((char *)sprite_effect_color_r + v260) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v260) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v260) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v260) = 1051595899;
            v262 = v261 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v262;
            v263 = fx_spawn_sprite(&v380, &v382, 0x40000000);
            v264 = v379;
            v263 *= 44;
            *(int *)((char *)sprite_effect_color_r + v263) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v263) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v263) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v263) = 1049683296;
            v265 = v264 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v265;
            fx_spawn_secondary_projectile((int)&v382, v324, 1);
            break;
          case 17:
            v266 = cos(v342);
            v336 = v266;
            *(float *)&v382 = v266 * 25.0;
            v267 = sin(v342);
            v357 = v267;
            v383 = v267 * 25.0;
            v268 = v379 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v268;
            v269 = fx_spawn_sprite(&v380, &v382, 1065353216);
            *(float *)&v382 = v336 * 15.0;
            v269 *= 44;
            v383 = v357 * 15.0;
            v270 = v379;
            *(int *)((char *)sprite_effect_color_r + v269) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v269) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v269) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v269) = 1051595899;
            v271 = v270 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v271;
            v272 = 11 * fx_spawn_sprite(&v380, &v382, 0x40000000);
            sprite_effect_color_r[v272] = 1056964608;
            sprite_effect_color_g[v272] = 1056964608;
            sprite_effect_color_b[v272] = 1056964608;
            sprite_effect_color_a[v272] = 1049683296;
            *(float *)&v273 = 0.0;
            v337 = *((float *)v3 + 179) * 1.0471976;
            v358 = v324 - 3.1415927 - v337 * *((float *)v3 + 179) * 0.5;
            if ( *((float *)v3 + 179) > 0.0 )
            {
              do
              {
                v274 = v379 + *((float *)v3 + 6);
                *(float *)&v382 = *(float *)&v378 + *v4;
                v383 = v274;
                fx_spawn_secondary_projectile((int)&v382, v358, 2);
                v376 = ++v273;
                v358 = v358 + v337;
              }
              while ( (double)v273 < *((float *)v3 + 179) );
            }
            v372 = *((float *)v3 + 179);
            break;
          case 18:
            *(float *)&v382 = cos(v342) * 25.0;
            v383 = sin(v342) * 25.0;
            v275 = v379 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v275;
            v276 = fx_spawn_sprite(&v380, &v382, 1065353216);
            v277 = v379;
            v276 *= 44;
            *(int *)((char *)sprite_effect_color_r + v276) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v276) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v276) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v276) = 1051595899;
            v278 = v277 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v278;
            fx_spawn_secondary_projectile((int)&v382, v324, 4);
            break;
          case 13:
            v279 = cos(v342);
            v338 = v279;
            *(float *)&v382 = v279 * 25.0;
            v280 = sin(v342);
            v359 = v280;
            v383 = v280 * 25.0;
            v281 = v379 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v281;
            v282 = fx_spawn_sprite(&v380, &v382, 1065353216);
            *(float *)&v382 = v338 * 15.0;
            v282 *= 44;
            v383 = v359 * 15.0;
            v283 = v379;
            *(int *)((char *)sprite_effect_color_r + v282) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v282) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v282) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v282) = 1050589266;
            v284 = v283 + *((float *)v3 + 6);
            *(float *)&v380 = *(float *)&v378 + *v4;
            v381 = v284;
            v285 = fx_spawn_sprite(&v380, &v382, 0x40000000);
            v286 = v379;
            v285 *= 44;
            *(int *)((char *)sprite_effect_color_r + v285) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v285) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v285) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v285) = 1048106238;
            v287 = v286 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v287;
            fx_spawn_secondary_projectile((int)&v382, v324, 2);
            break;
          case 7:
            v288 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v288;
            projectile_spawn((int)&v382, v324, 1, v142);
            break;
          case 14:
            v360 = 14;
            do
            {
              v289 = v379 + *((float *)v3 + 6);
              *(float *)&v382 = *(float *)&v378 + *v4;
              v383 = v289;
              v376 = (unsigned __int8)crt_rand() - 128;
              v316 = (double)v376 * 0.0020000001 + v324;
              v290 = projectile_spawn((int)&v382, v316, 11, v142);
              v291 = crt_rand();
              v191 = v360-- == 1;
              v376 = v291 % 100;
              projectile_speed_scale[16 * v290] = (double)(v291 % 100) * 0.0099999998 + 1.0;
            }
            while ( !v191 );
            break;
          case 41:
            v292 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v292;
            projectile_spawn((int)&v382, v324, 41, v142);
            break;
          case 43:
            v293 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v293;
            projectile_spawn((int)&v382, v324, 43, v142);
            break;
          case 42:
            v294 = v379 + *((float *)v3 + 6);
            *(float *)&v382 = *(float *)&v378 + *v4;
            v383 = v294;
            v319 = v324 - 1.5707964;
            fx_spawn_particle_slow((int)&v382, v319);
            v372 = 0.15000001;
            break;
        }
        goto LABEL_447;
      }
      v165 = v379 + *((float *)v3 + 6);
      *(float *)&v382 = *(float *)&v378 + *v4;
      v383 = v165;
      projectile_spawn((int)&v382, v324, 1, v142);
      v166 = cos(v342);
      v328 = v166;
      *(float *)&v382 = v166 * 25.0;
      v167 = sin(v342);
      v344 = v167;
      v383 = v167 * 25.0;
      v168 = v379 + *((float *)v3 + 6);
      *(float *)&v380 = *(float *)&v378 + *v4;
      v381 = v168;
      v169 = fx_spawn_sprite(&v380, &v382, 1065353216);
      *(float *)&v382 = v328 * 15.0;
      v169 *= 44;
      v383 = v344 * 15.0;
      v170 = v379;
      *(int *)((char *)sprite_effect_color_r + v169) = 1056964608;
      *(int *)((char *)sprite_effect_color_g + v169) = 1056964608;
      *(int *)((char *)sprite_effect_color_b + v169) = 1056964608;
      *(int *)((char *)sprite_effect_color_a + v169) = 1047233823;
      v171 = v170 + *((float *)v3 + 6);
      *(float *)&v380 = *(float *)&v378 + *v4;
      v381 = v171;
      v163 = fx_spawn_sprite(&v380, &v382, 0x40000000);
    }
    v164 = 11 * v163;
    sprite_effect_color_r[v164] = 1056964608;
    sprite_effect_color_g[v164] = 1056964608;
    sprite_effect_color_b[v164] = 1056964608;
    sprite_effect_color_a[v164] = 1046092972;
LABEL_447:
    if ( !perk_count_get(perk_id_sharpshooter) )
      *((float *)v3 + 174) = flt_4D7A7C[31 * *((_DWORD *)v3 + 176)] * 1.3 + *((float *)v3 + 174);
    if ( bonus_reflex_boost_timer <= 0.0 )
      *((float *)v3 + 179) = *((float *)v3 + 179) - v372;
    goto LABEL_451;
  }
  sfx_play_panned(dword_4D9050, (int)(v3 + 20), 1.0);
  sfx_play_panned(dword_4D7FD8, (int)(v3 + 20), 1.0);
  v147 = 31 * *((_DWORD *)v3 + 176);
  if ( weapon_projectile_pellet_count[v147] == 1 )
  {
    *((_DWORD *)v3 + 181) = dword_4D9040;
    v148 = flt_4D9048;
  }
  else
  {
    *((_DWORD *)v3 + 181) = dword_4D7A74[v147];
    v148 = flt_4D7A7C[31 * *((_DWORD *)v3 + 176)];
  }
  v149 = 0;
  for ( *(float *)LODWORD(v373) = v148 + *(float *)LODWORD(v373);
        v149 < weapon_projectile_pellet_count[31 * *((_DWORD *)v3 + 176)];
        ++v149 )
  {
    *(float *)&v376 = (double)(crt_rand() % 200 - 100) * 0.0015 + v324;
    v150 = v379 + *((float *)v3 + 6);
    *(float *)&v382 = *(float *)&v378 + *v4;
    v383 = v150;
    projectile_spawn((int)&v382, *(float *)&v376, 45, v142);
  }
  *(float *)&v382 = cos(v342) * 25.0;
  v383 = sin(v342) * 25.0;
  v151 = v379 + *((float *)v3 + 6);
  *(float *)&v380 = *(float *)&v378 + *v4;
  v381 = v151;
  v152 = fx_spawn_sprite(&v380, &v382, 1065353216);
  v303 = perk_id_sharpshooter;
  v152 *= 44;
  *(int *)((char *)sprite_effect_color_r + v152) = 1056964608;
  *(int *)((char *)sprite_effect_color_g + v152) = 1056964608;
  *(int *)((char *)sprite_effect_color_b + v152) = 1056964608;
  *(int *)((char *)sprite_effect_color_a + v152) = 1054045372;
  if ( !perk_count_get(v303) )
    *((float *)v3 + 174) = flt_4D9048 * 1.3 + *((float *)v3 + 174);
LABEL_451:
  if ( *((float *)v3 + 174) > 0.47999999 )
    *((_DWORD *)v3 + 174) = 1056293519;
  if ( (int)*(&player_perk_counts + perk_id_fastshot) > 0 )
    *((float *)v3 + 181) = *((float *)v3 + 181) * 0.88;
  if ( (int)*(&player_perk_counts + perk_id_sharpshooter) > 0 )
    *((float *)v3 + 181) = *((float *)v3 + 181) * 1.05;
  if ( *((float *)v3 + 179) <= 0.0 )
    player_start_reload();
LABEL_459:
  if ( *((float *)v3 + 37) > 14.0 )
  {
    do
    {
      v295 = *((float *)v3 + 37) - 14.0;
      *((float *)v3 + 37) = v295;
    }
    while ( v295 > 14.0 );
  }
  if ( *((float *)v3 + 37) < 0.0 )
  {
    do
    {
      v296 = *((float *)v3 + 37) + 14.0;
      *((float *)v3 + 37) = v296;
    }
    while ( v296 < 0.0 );
  }
  if ( *((float *)v3 + 197) > 0.0 )
    *((float *)v3 + 23) = *((float *)v3 + 23) - 1.0;
  v297 = *((float *)v3 + 13) * 0.5;
  if ( v297 > *v4 )
    *v4 = v297;
  v298 = (double)terrain_texture_width - v297;
  if ( v298 < *v4 )
    *v4 = v298;
  v299 = v297 < *((float *)v3 + 6);
  v300 = v297 == *((float *)v3 + 6);
  v301 = (float *)(v3 + 24);
  if ( !v299 && !v300 )
    *v301 = v297;
  v302 = (double)terrain_texture_height - v297;
  if ( v302 < *v301 )
    *v301 = v302;
  if ( *(float *)LODWORD(v373) > 0.80000001 )
    *(_DWORD *)LODWORD(v373) = 1061997773;
}

// FUN_00417640 @ 0x00417640
// [binja] float* __thiscall sub_417640(float* arg1, float* arg2, float* arg3)
float *__thiscall sub_417640(float *this, float *a2, float *a3)
{
  double v3; // st7

  v3 = *(this + 1) - a3[1];
  *a2 = *this - *a3;
  a2[1] = v3;
  return a2;
}

// sub_417660 @ 0x00417660
long double __cdecl sub_417660(float *a1)
{
  return sqrt(*a1 * *a1 + a1[1] * a1[1]);
}

// FUN_00417690 @ 0x00417690
// [binja] int32_t sub_417690()
int sub_417690()
{
  Iostream_init *v0; // esi
  int v1; // edi
  Iostream_init *v2; // esi
  int v3; // edi
  Iostream_init *v4; // esi
  int v5; // edi
  Iostream_init *v6; // esi
  int v7; // edi
  Iostream_init *v8; // esi
  int v9; // edi
  Iostream_init *v10; // esi
  int v11; // edi
  int result; // eax

  v0 = (Iostream_init *)&unk_48F808;
  v1 = 8;
  do
  {
    Iostream_init::Iostream_init(v0);
    v0 = (Iostream_init *)((char *)v0 + 28);
    --v1;
  }
  while ( v1 );
  v2 = (Iostream_init *)&unk_48F8F0;
  dword_48F8EC = 4;
  v3 = 8;
  do
  {
    Iostream_init::Iostream_init(v2);
    v2 = (Iostream_init *)((char *)v2 + 28);
    --v3;
  }
  while ( v3 );
  dword_48F9D4 = 4;
  v4 = (Iostream_init *)&unk_48F9D8;
  v5 = 8;
  do
  {
    Iostream_init::Iostream_init(v4);
    v4 = (Iostream_init *)((char *)v4 + 28);
    --v5;
  }
  while ( v5 );
  dword_48FABC = 4;
  v6 = (Iostream_init *)&unk_48FAC0;
  v7 = 8;
  do
  {
    Iostream_init::Iostream_init(v6);
    v6 = (Iostream_init *)((char *)v6 + 28);
    --v7;
  }
  while ( v7 );
  dword_48FBA4 = 4;
  v8 = (Iostream_init *)&unk_48FBA8;
  v9 = 8;
  do
  {
    Iostream_init::Iostream_init(v8);
    v8 = (Iostream_init *)((char *)v8 + 28);
    --v9;
  }
  while ( v9 );
  dword_48FC8C = 4;
  v10 = (Iostream_init *)&unk_48FC90;
  v11 = 8;
  do
  {
    Iostream_init::Iostream_init(v10);
    v10 = (Iostream_init *)((char *)v10 + 28);
    --v11;
  }
  while ( v11 );
  dword_48FD74 = 4;
  FUN_004010f0((int)&unk_48FD78, 28, 8, (int (__thiscall *)(int))Iostream_init::Iostream_init);
  dword_48FE5C = 4;
  FUN_004010f0((int)&unk_48FE60, 28, 8, (int (__thiscall *)(int))Iostream_init::Iostream_init);
  dword_48FF44 = 4;
  FUN_004010f0((int)&unk_48FF48, 28, 8, (int (__thiscall *)(int))Iostream_init::Iostream_init);
  dword_49002C = 4;
  FUN_004010f0((int)&unk_490030, 28, 8, (int (__thiscall *)(int))Iostream_init::Iostream_init);
  dword_490114 = 4;
  FUN_004010f0((int)&unk_490118, 28, 8, (int (__thiscall *)(int))Iostream_init::Iostream_init);
  dword_4901FC = 4;
  result = FUN_004010f0((int)&unk_490200, 28, 8, (int (__thiscall *)(int))Iostream_init::Iostream_init);
  dword_4902E4 = 4;
  return result;
}

// sub_4177F0 @ 0x004177F0
int sub_4177F0()
{
  FUN_004010f0((int)&unk_4872B0, 8, 2, (int (__thiscall *)(int))Iostream_init::Iostream_init);
  FUN_00417aa0(&unk_4872CC);
  FUN_00417aa0(&unk_4873B4);
  FUN_00417aa0(&unk_48749C);
  dword_487588 = 0;
  byte_4875A4 = 0;
  dword_4872C8 = 0;
  dword_4872C4 = 0;
  byte_487290 = 0;
  FUN_004010f0((int)&unk_4875C8, 8, 2, (int (__thiscall *)(int))Iostream_init::Iostream_init);
  FUN_00417aa0(&unk_4875E4);
  FUN_00417aa0(&unk_4876CC);
  FUN_00417aa0(&unk_4877B4);
  dword_4878A0 = 0;
  byte_4878BC = 0;
  dword_4875E0 = 0;
  dword_4875DC = 0;
  byte_4875A8 = 0;
  FUN_00417ab0(&byte_4878C0);
  FUN_00417ab0(&byte_487BD8);
  FUN_00417ab0(&byte_487EF0);
  FUN_00417ab0(&byte_488208);
  FUN_00417ab0(&byte_488520);
  FUN_00417ab0(&byte_488838);
  FUN_00417ab0(&byte_488B50);
  FUN_00417ab0(&byte_488E68);
  FUN_00417ab0(&unk_489180);
  FUN_00417ab0(&byte_489498);
  FUN_00417ab0(&byte_4897B0);
  FUN_00417ab0(&unk_489AC8);
  FUN_00417ab0(&byte_489DE0);
  FUN_00417ab0(&byte_48A0F8);
  FUN_00417ab0(&unk_48A410);
  FUN_00417ab0(&unk_48A728);
  FUN_00417ab0(&unk_48AA40);
  FUN_00417ab0(&unk_48AD58);
  FUN_00417ab0(&unk_48B070);
  FUN_00417ab0(&unk_48B388);
  FUN_00417ab0(&unk_48B6A0);
  FUN_00417ab0(&byte_48B9B8);
  FUN_00417ab0(&byte_48BCD0);
  FUN_00417ab0(&byte_48BFE8);
  FUN_00417ab0(&unk_48C300);
  FUN_00417ab0(&byte_48C618);
  FUN_00417ab0(&unk_48C930);
  FUN_00417ab0(&byte_48CC48);
  FUN_00417ab0(&unk_48CF60);
  FUN_00417ab0(&byte_48D278);
  FUN_00417ab0(&byte_48D590);
  FUN_00417ab0(&unk_48D8A8);
  FUN_00417ab0(&byte_48DBC0);
  FUN_00417ab0(&unk_48DED8);
  FUN_00417ab0(&byte_48E1F0);
  FUN_00417ab0(&unk_48E508);
  FUN_00417ab0(&byte_48E820);
  FUN_00417ab0(&byte_48EB38);
  FUN_00417ab0(&byte_48EE50);
  FUN_00417ab0(&byte_48F20C);
  byte_48724D = 0;
  byte_48727C = 0;
  dword_487284 = 0;
  player_name_length = 0;
  camera_shake_timer = 0.0;
  byte_487241 = 0;
  byte_4871C9 = 0;
  byte_4871CA = 0;
  byte_4871CB = 0;
  ui_mouse_blocked = 0;
  ui_transition_alpha = 1.0;
  camera_shake_offset_x = 0.0;
  camera_shake_offset_y = 0.0;
  return 0;
}

// FUN_00417aa0 @ 0x00417AA0
// [binja] void* __fastcall sub_417aa0(void* arg1)
_DWORD *__thiscall sub_417AA0(_DWORD *this)
{
  *(this + 57) = 4;
  return this;
}

// FUN_00417ab0 @ 0x00417AB0
// [binja] char* __fastcall sub_417ab0(char* arg1)
_DWORD *__thiscall sub_417AB0(_DWORD *this)
{
  *(this + 72) = 4;
  *(this + 130) = 4;
  *(this + 188) = 4;
  *(this + 190) = 0;
  *((_BYTE *)this + 788) = 0;
  *(this + 14) = 0;
  *(this + 13) = 0;
  *(_BYTE *)this = 0;
  return this;
}

// ui_draw_textured_quad @ 0x00417AE0
// binds a texture and draws a screen-space quad
int __cdecl sub_417AE0(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // eax
  float v7; // [esp+2Ch] [ebp-10h]
  float v8; // [esp+30h] [ebp-Ch]
  float v9; // [esp+34h] [ebp-8h]
  float v10; // [esp+38h] [ebp-4h]

  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, a5, 0);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, float, float, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    COERCE_FLOAT(LODWORD(v8)),
    COERCE_FLOAT(LODWORD(v9)),
    COERCE_FLOAT(LODWORD(v10)));
  v10 = *(float *)&grim_interface_ptr;
  v5 = *(_DWORD *)grim_interface_ptr;
  v10 = (float)a4;
  v9 = (float)a3;
  v8 = (float)a2;
  v7 = (float)a1;
  (*(void (__stdcall **)(float, float, float, float))(v5 + 284))(
    COERCE_FLOAT(LODWORD(v7)),
    COERCE_FLOAT(LODWORD(v8)),
    COERCE_FLOAT(LODWORD(v9)),
    COERCE_FLOAT(LODWORD(v10)));
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  return (*(int (__thiscall **)(int, int, int, float, float, float))(*(_DWORD *)grim_interface_ptr + 32))(
           grim_interface_ptr,
           21,
           2,
           COERCE_FLOAT(LODWORD(v8)),
           COERCE_FLOAT(LODWORD(v9)),
           COERCE_FLOAT(LODWORD(v10)));
}

// terrain_generate @ 0x00417B80
// generates terrain texture into a render target using a level descriptor
int __cdecl sub_417B80(_DWORD *a1)
{
  int result; // eax
  int v3; // edx
  int v4; // esi
  int v5; // ebp
  int v6; // eax
  int v7; // eax
  int v8; // esi
  int v9; // ebp
  int v10; // eax
  int v11; // eax
  int v12; // esi
  int v13; // ebx
  int v14; // eax
  _DWORD v15[4]; // [esp+D0h] [ebp-34h] BYREF
  float v16; // [esp+F0h] [ebp-14h]
  float v17; // [esp+F4h] [ebp-10h]
  int v18; // [esp+F8h] [ebp-Ch]
  float v19; // [esp+FCh] [ebp-8h] BYREF
  float v20; // [esp+100h] [ebp-4h]
  float v21; // [esp+108h] [ebp+4h]
  float v22; // [esp+108h] [ebp+4h]
  float v23; // [esp+108h] [ebp+4h]

  v17 = 0.0;
  camera_offset_x = 0;
  v18 = 0;
  camera_offset_y = 0;
  v16 = 1.0 / *(float *)config_texture_scale;
  if ( terrain_texture_failed )
  {
    result = a1[4];
    terrain_render_target = dword_48F548[result];
  }
  else
  {
    LOBYTE(v15[0]) = 1;
    (*(void (__thiscall **)(int, int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      18,
      v15[0],
      v15[1],
      v15[2],
      v15[3]);
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      5,
      v15[1],
      v15[2],
      v15[3]);
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      v15[1],
      v15[2],
      v15[3]);
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      1,
      v15[1],
      v15[2],
      v15[3]);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 48))(grim_interface_ptr, terrain_render_target);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 44))(
      grim_interface_ptr,
      1048378621,
      1046536417,
      1036568777,
      1065353216);
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      dword_48F548[a1[4]],
      0);
    v3 = *(_DWORD *)grim_interface_ptr;
    qmemcpy(v15, "333?333?333?fff?", sizeof(v15));
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(v3 + 276))(
      grim_interface_ptr,
      v15[0],
      v15[1],
      v15[2],
      v15[3]);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v4 = 0;
    if ( 800 * terrain_texture_width * terrain_texture_height / 0x80000 > 0 )
    {
      v21 = v16 * 128.0;
      do
      {
        v5 = *(_DWORD *)grim_interface_ptr;
        *(float *)&v15[3] = (double)(crt_rand() % 314) * 0.0099999998;
        (*(void (__thiscall **)(int, _DWORD))(v5 + 252))(grim_interface_ptr, v15[3]);
        v17 = (double)(crt_rand() % (terrain_texture_width + 128)) - 64.0;
        v6 = crt_rand();
        *(float *)&v15[3] = v21;
        *(float *)&v15[2] = v21;
        v15[1] = &v19;
        v19 = ((double)(v6 % (terrain_texture_width + 128)) - 64.0) * v16;
        v20 = v17 * v16;
        (*(void (__thiscall **)(int, float *, float, float))(*(_DWORD *)grim_interface_ptr + 288))(
          grim_interface_ptr,
          &v19,
          COERCE_FLOAT(LODWORD(v21)),
          COERCE_FLOAT(LODWORD(v21)));
        ++v4;
      }
      while ( v4 < 800 * terrain_texture_width * terrain_texture_height / 0x80000 );
    }
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      dword_48F548[a1[5]],
      0);
    v7 = *(_DWORD *)grim_interface_ptr;
    qmemcpy(v15, "333?333?333?fff?", sizeof(v15));
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(v7 + 276))(
      grim_interface_ptr,
      v15[0],
      v15[1],
      v15[2],
      v15[3]);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v8 = 0;
    if ( 35 * terrain_texture_width * terrain_texture_height / 0x80000 > 0 )
    {
      v22 = v16 * 128.0;
      do
      {
        v9 = *(_DWORD *)grim_interface_ptr;
        *(float *)&v15[3] = (double)(crt_rand() % 314) * 0.0099999998;
        (*(void (__thiscall **)(int, _DWORD))(v9 + 252))(grim_interface_ptr, v15[3]);
        v17 = (double)(crt_rand() % (terrain_texture_width + 128)) - 64.0;
        v10 = crt_rand();
        *(float *)&v15[3] = v22;
        *(float *)&v15[2] = v22;
        v15[1] = &v19;
        v19 = ((double)(v10 % (terrain_texture_width + 128)) - 64.0) * v16;
        v20 = v17 * v16;
        (*(void (__thiscall **)(int, float *, float, float))(*(_DWORD *)grim_interface_ptr + 288))(
          grim_interface_ptr,
          &v19,
          COERCE_FLOAT(LODWORD(v22)),
          COERCE_FLOAT(LODWORD(v22)));
        ++v8;
      }
      while ( v8 < 35 * terrain_texture_width * terrain_texture_height / 0x80000 );
    }
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      dword_48F548[a1[6]],
      0);
    v15[3] = 1058642330;
    v11 = *(_DWORD *)grim_interface_ptr;
    qmemcpy(v15, "333?333?333?", 12);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(v11 + 276))(
      grim_interface_ptr,
      v15[0],
      v15[1],
      v15[2],
      1058642330);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v12 = 0;
    if ( 15 * terrain_texture_width * terrain_texture_height / 0x80000 > 0 )
    {
      v23 = v16 * 128.0;
      do
      {
        v13 = *(_DWORD *)grim_interface_ptr;
        *(float *)&v15[3] = (double)(crt_rand() % 314) * 0.0099999998;
        (*(void (__thiscall **)(int, _DWORD))(v13 + 252))(grim_interface_ptr, v15[3]);
        v17 = (double)(crt_rand() % (terrain_texture_width + 128)) - 64.0;
        v14 = crt_rand();
        *(float *)&v15[3] = v23;
        *(float *)&v15[2] = v23;
        v15[1] = &v19;
        v19 = ((double)(v14 % (terrain_texture_width + 128)) - 64.0) * v16;
        v20 = v17 * v16;
        (*(void (__thiscall **)(int, float *, float, float))(*(_DWORD *)grim_interface_ptr + 288))(
          grim_interface_ptr,
          &v19,
          COERCE_FLOAT(LODWORD(v23)),
          COERCE_FLOAT(LODWORD(v23)));
        ++v12;
      }
      while ( v12 < 15 * terrain_texture_width * terrain_texture_height / 0x80000 );
    }
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    v17 = 0.0;
    v18 = 0;
    camera_offset_x = 0;
    camera_offset_y = 0;
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      5,
      v15[1],
      v15[2],
      v15[3]);
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      v15[1],
      v15[2],
      v15[3]);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      1,
      v15[1],
      v15[2],
      v15[3]);
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      5,
      v15[1],
      v15[2],
      v15[3]);
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      v15[1],
      v15[2],
      v15[3]);
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      2,
      v15[1],
      v15[2],
      v15[3]);
    return (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 48))(grim_interface_ptr, -1);
  }
  return result;
}

// terrain_generate_random @ 0x004181B0
// selects a terrain variant and generates the terrain texture
void sub_4181B0()
{
  int v0; // esi
  int v1; // ebp
  int v2; // eax
  int v3; // esi
  int v4; // edi
  int v5; // ebx
  int v6; // eax
  int v7; // edx
  int v8; // esi
  int v9; // edi
  int v10; // ebx
  int v11; // eax
  int v12; // eax
  int v13; // esi
  int v14; // edi
  int v15; // ebx
  int v16; // eax
  _DWORD v17[4]; // [esp+D0h] [ebp-44h] BYREF
  float v18; // [esp+F0h] [ebp-24h]
  int v19; // [esp+F4h] [ebp-20h]
  int v20; // [esp+F8h] [ebp-1Ch]
  int v21; // [esp+FCh] [ebp-18h]
  float v22; // [esp+100h] [ebp-14h] BYREF
  float v23; // [esp+104h] [ebp-10h]
  int v24; // [esp+110h] [ebp-4h]

  v18 = 1.0 / *(float *)config_texture_scale;
  dword_48F53C = crt_rand() % 7;
  dword_48F540 = crt_rand() % 7;
  crt_rand();
  v0 = dword_48F548[0];
  v1 = dword_48F54C;
  dword_48F53C = 0;
  dword_48F540 = 1;
  dword_48F544 = 0;
  v24 = dword_48F548[0];
  if ( (unsigned __int16)game_status_blob >= 0x28u && (crt_rand() & 7) == 3 )
  {
    terrain_generate(dword_484C84);
  }
  else if ( (unsigned __int16)game_status_blob >= 0x1Eu && (crt_rand() & 7) == 3 )
  {
    terrain_generate(dword_484ACC);
  }
  else if ( (unsigned __int16)game_status_blob >= 0x14u && (crt_rand() & 7) == 3 )
  {
    terrain_generate(dword_484914);
  }
  else
  {
    v21 = 0;
    camera_offset_y = 0;
    *(float *)&v20 = 0.0;
    camera_offset_x = 0;
    if ( !terrain_texture_failed )
    {
      LOBYTE(v17[0]) = 1;
      (*(void (__thiscall **)(int, int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        18,
        v17[0],
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        21,
        1,
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
        grim_interface_ptr,
        0,
        0,
        1065353216,
        1065353216);
      (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 48))(grim_interface_ptr, terrain_render_target);
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 44))(
        grim_interface_ptr,
        1048378621,
        1046536417,
        1036568777,
        1065353216);
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, v0, 0);
      v2 = *(_DWORD *)grim_interface_ptr;
      qmemcpy(v17, "333?333?333?fff?", sizeof(v17));
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(v2 + 276))(
        grim_interface_ptr,
        v17[0],
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v3 = 0;
      if ( 800 * terrain_texture_width * terrain_texture_height / 0x80000 > 0 )
      {
        *(float *)&v19 = v18 * 128.0;
        v4 = v19;
        do
        {
          v5 = *(_DWORD *)grim_interface_ptr;
          v19 = crt_rand() % 314;
          *(float *)&v17[3] = (double)v19 * 0.0099999998;
          (*(void (__thiscall **)(int, _DWORD))(v5 + 252))(grim_interface_ptr, v17[3]);
          v19 = crt_rand() % (terrain_texture_width + 128);
          *(float *)&v20 = (double)v19 - 64.0;
          v6 = crt_rand();
          v17[3] = v4;
          v17[2] = v4;
          v17[1] = &v22;
          v19 = v6 % (terrain_texture_width + 128);
          v22 = ((double)v19 - 64.0) * v18;
          v23 = *(float *)&v20 * v18;
          (*(void (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 288))(
            grim_interface_ptr,
            &v22,
            v4,
            v4);
          ++v3;
        }
        while ( v3 < 800 * terrain_texture_width * terrain_texture_height / 0x80000 );
      }
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, v1, 0);
      v7 = *(_DWORD *)grim_interface_ptr;
      qmemcpy(v17, "333?333?333?fff?", sizeof(v17));
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(v7 + 276))(
        grim_interface_ptr,
        v17[0],
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v8 = 0;
      if ( 35 * terrain_texture_width * terrain_texture_height / 0x80000 > 0 )
      {
        *(float *)&v19 = v18 * 128.0;
        v9 = v19;
        do
        {
          v10 = *(_DWORD *)grim_interface_ptr;
          v20 = crt_rand() % 314;
          *(float *)&v17[3] = (double)v20 * 0.0099999998;
          (*(void (__thiscall **)(int, _DWORD))(v10 + 252))(grim_interface_ptr, v17[3]);
          v20 = crt_rand() % (terrain_texture_width + 128);
          *(float *)&v19 = (double)v20 - 64.0;
          v11 = crt_rand();
          v17[3] = v9;
          v17[2] = v9;
          v17[1] = &v22;
          v20 = v11 % (terrain_texture_width + 128);
          v22 = ((double)v20 - 64.0) * v18;
          v23 = *(float *)&v19 * v18;
          (*(void (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 288))(
            grim_interface_ptr,
            &v22,
            v9,
            v9);
          ++v8;
        }
        while ( v8 < 35 * terrain_texture_width * terrain_texture_height / 0x80000 );
      }
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, v24, 0);
      v17[3] = 1058642330;
      v12 = *(_DWORD *)grim_interface_ptr;
      qmemcpy(v17, "333?333?333?", 12);
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(v12 + 276))(
        grim_interface_ptr,
        v17[0],
        v17[1],
        v17[2],
        1058642330);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v13 = 0;
      if ( 15 * terrain_texture_width * terrain_texture_height / 0x80000 > 0 )
      {
        *(float *)&v19 = v18 * 128.0;
        v14 = v19;
        do
        {
          v15 = *(_DWORD *)grim_interface_ptr;
          v20 = crt_rand() % 314;
          *(float *)&v17[3] = (double)v20 * 0.0099999998;
          (*(void (__thiscall **)(int, _DWORD))(v15 + 252))(grim_interface_ptr, v17[3]);
          v20 = crt_rand() % (terrain_texture_width + 128);
          *(float *)&v19 = (double)v20 - 64.0;
          v16 = crt_rand();
          v17[3] = v14;
          v17[2] = v14;
          v17[1] = &v22;
          v20 = v16 % (terrain_texture_width + 128);
          v22 = ((double)v20 - 64.0) * v18;
          v23 = *(float *)&v19 * v18;
          (*(void (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 288))(
            grim_interface_ptr,
            &v22,
            v14,
            v14);
          ++v13;
        }
        while ( v13 < 15 * terrain_texture_width * terrain_texture_height / 0x80000 );
      }
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      *(float *)&v20 = 0.0;
      v21 = 0;
      camera_offset_x = 0;
      camera_offset_y = 0;
      (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        1065353216);
      (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        1,
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        21,
        2,
        v17[1],
        v17[2],
        v17[3]);
      (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 48))(grim_interface_ptr, -1);
      if ( *(float *)(dword_480864 + 12) != 0.0 )
        console_printf((int)&console_log_queue, aGeneratedTerra);
    }
  }
}

// terrain_render @ 0x004188A0
// renders the terrain layer from terrain_render_target; tiles fallback when texture missing
int sub_4188A0()
{
  int v0; // eax
  int v1; // edi
  int v2; // ecx
  int v3; // esi
  double v5; // st7
  double v6; // st6
  int v7; // [esp+64h] [ebp-28h]
  float v8; // [esp+64h] [ebp-28h]
  int v9; // [esp+64h] [ebp-28h]
  int v10; // [esp+68h] [ebp-24h]
  int v11; // [esp+68h] [ebp-24h]
  float v12; // [esp+68h] [ebp-24h]
  int v13; // [esp+68h] [ebp-24h]
  int v14; // [esp+68h] [ebp-24h]
  int v15; // [esp+6Ch] [ebp-20h]
  int v16; // [esp+6Ch] [ebp-20h]
  int v17; // [esp+6Ch] [ebp-20h]
  float v18; // [esp+6Ch] [ebp-20h]
  int v19; // [esp+6Ch] [ebp-20h]
  int v20; // [esp+70h] [ebp-1Ch]
  int v21; // [esp+70h] [ebp-1Ch]
  int v22; // [esp+70h] [ebp-1Ch]
  float v23; // [esp+70h] [ebp-1Ch]
  int v24; // [esp+70h] [ebp-1Ch]
  int v25; // [esp+80h] [ebp-Ch]
  float v26; // [esp+80h] [ebp-Ch]
  int v27; // [esp+84h] [ebp-8h]
  float v28; // [esp+84h] [ebp-8h]
  float v29; // [esp+88h] [ebp-4h]

  if ( *(_DWORD *)(dword_480858 + 12) == 0x40000000 )
    (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 21, 1);
  v0 = *(_DWORD *)grim_interface_ptr;
  if ( terrain_texture_failed )
  {
    (*(void (__stdcall **)(int, _DWORD))(v0 + 196))(terrain_render_target, 0);
    LOBYTE(v7) = 0;
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      18,
      v7,
      v10,
      v15,
      v20);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    v1 = 0;
    if ( terrain_texture_height / 256 + 1 > 0 )
    {
      v2 = terrain_texture_width;
      v27 = 0;
      do
      {
        v3 = 0;
        if ( v2 / 256 + 1 > 0 )
        {
          v25 = 0;
          do
          {
            v29 = (float)v27;
            v12 = v29 + *(float *)&camera_offset_y;
            v8 = (double)v25 + *(float *)&camera_offset_x;
            (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
              LODWORD(v8),
              LODWORD(v12),
              1132462080,
              1132462080);
            v2 = terrain_texture_width;
            ++v3;
            v25 += 256;
          }
          while ( v3 < terrain_texture_width / 256 + 1 );
        }
        ++v1;
        v27 += 256;
      }
      while ( v1 < terrain_texture_height / 256 + 1 );
    }
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      2,
      v11,
      v16,
      v21);
    LOBYTE(v9) = 1;
    return (*(int (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
             grim_interface_ptr,
             18,
             v9,
             v13,
             v17,
             v22);
  }
  else
  {
    (*(void (__stdcall **)(int, _DWORD))(v0 + 196))(terrain_render_target, 0);
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    v5 = (double)terrain_texture_width;
    v26 = -(*(float *)&camera_offset_x / v5);
    v6 = (double)terrain_texture_height;
    v28 = -(*(float *)&camera_offset_y / v6);
    v23 = (double)config_screen_height / v6 + v28;
    v18 = (double)*(int *)config_screen_width / v5 + v26;
    (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 256))(
      LODWORD(v26),
      LODWORD(v28),
      LODWORD(v18),
      LODWORD(v23));
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 200))(grim_interface_ptr, 0);
    return (*(int (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
             grim_interface_ptr,
             21,
             2,
             v14,
             v19,
             v24);
  }
}

// creature_render_type @ 0x00418B60
// renders active creatures matching type_id using 8x8 atlases and animation strips
char __cdecl sub_418B60(int a1, float a2)
{
  int v2; // ebp
  int *v3; // esi
  int v4; // ebx
  int v5; // eax
  double v6; // st7
  __int64 v7; // rax
  double v8; // st7
  double v9; // st7
  float *v10; // esi
  double v11; // st7
  int v12; // ebx
  int v13; // eax
  double v14; // st7
  __int64 v15; // rax
  double v16; // st7
  double v17; // st7
  char v18; // al
  float *v19; // esi
  int v20; // ebx
  int v21; // eax
  double v22; // st7
  __int64 v23; // rax
  double v24; // st7
  double v25; // st7
  char v26; // al
  char result; // al
  int *v28; // esi
  double v29; // st7
  int v30; // ebx
  int v31; // eax
  __int64 v32; // rax
  double v33; // st7
  int v34; // [esp+C0h] [ebp-58h]
  int v35; // [esp+C0h] [ebp-58h]
  int v36; // [esp+C0h] [ebp-58h]
  int v37; // [esp+C0h] [ebp-58h]
  int v38; // [esp+C0h] [ebp-58h]
  int v39; // [esp+C4h] [ebp-54h]
  int v40; // [esp+C4h] [ebp-54h]
  int v41; // [esp+C4h] [ebp-54h]
  int v42; // [esp+C4h] [ebp-54h]
  int v43; // [esp+C4h] [ebp-54h]
  int v44; // [esp+C8h] [ebp-50h]
  int v45; // [esp+C8h] [ebp-50h]
  float v46; // [esp+C8h] [ebp-50h]
  int v47; // [esp+C8h] [ebp-50h]
  int v48; // [esp+C8h] [ebp-50h]
  float v49; // [esp+C8h] [ebp-50h]
  float v50; // [esp+C8h] [ebp-50h]
  int v51; // [esp+C8h] [ebp-50h]
  float v52; // [esp+C8h] [ebp-50h]
  float v53; // [esp+DCh] [ebp-3Ch]
  float v54; // [esp+E0h] [ebp-38h]
  float v55; // [esp+E4h] [ebp-34h]
  float v56; // [esp+E8h] [ebp-30h]
  float v57; // [esp+E8h] [ebp-30h]
  float v58; // [esp+E8h] [ebp-30h]
  float v59; // [esp+E8h] [ebp-30h]
  float v60; // [esp+ECh] [ebp-2Ch]
  float v61; // [esp+ECh] [ebp-2Ch]
  float v62; // [esp+ECh] [ebp-2Ch]
  float v63; // [esp+F0h] [ebp-28h]
  float v64; // [esp+F4h] [ebp-24h]
  float v65; // [esp+F4h] [ebp-24h]
  float v66; // [esp+F4h] [ebp-24h]
  float v67; // [esp+F8h] [ebp-20h]
  float v68; // [esp+F8h] [ebp-20h]
  float v69; // [esp+FCh] [ebp-1Ch]
  float v70; // [esp+108h] [ebp-10h] BYREF
  float v71; // [esp+10Ch] [ebp-Ch]
  float v72; // [esp+110h] [ebp-8h]
  float v73; // [esp+114h] [ebp-4h]

  v2 = a1;
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
    grim_interface_ptr,
    creature_type_texture[17 * a1],
    0);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  if ( config_fx_detail_flag0 && !perk_count_get(perk_id_monster_vision) )
  {
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      1,
      v34,
      v39,
      v44);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      v35,
      v40,
      v45);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v3 = creature_hitbox_size;
    while ( 1 )
    {
      if ( !*((_BYTE *)v3 - 16) || v3[23] != v2 )
        goto LABEL_27;
      v4 = v3[31];
      v70 = *((float *)v3 + 11);
      v71 = *((float *)v3 + 12);
      v72 = *((float *)v3 + 13);
      v73 = *((float *)v3 + 14);
      v73 = v73 * 0.40000001;
      if ( (v4 & 4) == 0 || (v4 & 0x40) != 0 )
        break;
      v5 = (int)(__int64)(*((float *)v3 + 33) + 0.5) % 16;
      if ( v5 > 7 )
        v5 = 15 - v5;
      (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(
        grim_interface_ptr,
        8,
        creature_type_base_frame[17 * a1] + v5 + 16);
      if ( *(float *)v3 < 0.0 )
      {
        v6 = *(float *)v3 * 0.1 + v73;
        if ( v6 < 0.0 )
          v6 = 0.0;
        goto LABEL_26;
      }
LABEL_25:
      v6 = v73;
LABEL_26:
      v73 = v6 * a2;
      (*(void (__thiscall **)(int, float *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &v70);
      v46 = *((float *)v3 + 7) - 1.5707964;
      (*(void (__stdcall **)(_DWORD))(*(_DWORD *)grim_interface_ptr + 252))(LODWORD(v46));
      v9 = *((float *)v3 + 9) * 0.5 + 0.69999999;
      v56 = v9;
      v64 = *(float *)&camera_offset_y + *((float *)v3 + 2);
      v54 = *(float *)&camera_offset_x + *((float *)v3 + 1) - v56;
      v55 = v64 - v9;
      v53 = *((float *)v3 + 9) * 1.0700001;
      (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
        LODWORD(v54),
        LODWORD(v55),
        LODWORD(v53),
        LODWORD(v53));
      v2 = a1;
LABEL_27:
      v3 += 38;
      if ( (int)v3 >= (int)&flt_4AA348 )
      {
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
        goto LABEL_29;
      }
    }
    if ( *(float *)v3 >= 16.0 )
    {
      HIDWORD(v7) = (__int64)(*((float *)v3 + 33) + 0.5);
      if ( (creature_type_anim_flags[68 * a1] & 1) == 0 || SHIDWORD(v7) <= 15 )
        goto LABEL_22;
      LODWORD(v7) = 31 - HIDWORD(v7);
    }
    else
    {
      if ( *(float *)v3 < 0.0 )
      {
        HIDWORD(v7) = creature_type_base_frame[17 * a1] + 15;
        v8 = *(float *)v3 * 0.5 + v73;
        v73 = v8;
        if ( v8 < 0.0 )
          v73 = 0.0;
        goto LABEL_22;
      }
      v7 = (__int64)((double)(creature_type_base_frame[17 * a1] + 15) - *(float *)v3);
    }
    HIDWORD(v7) = v7;
LABEL_22:
    if ( (v4 & 0x10) != 0 )
      HIDWORD(v7) += 32;
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 8, HIDWORD(v7));
    goto LABEL_25;
  }
LABEL_29:
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    v34,
    v39,
    v44);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    6,
    v36,
    v41,
    v47);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  if ( bonus_energizer_timer > 0.0 )
  {
    v10 = &creature_max_health;
    while ( !*((_BYTE *)v10 - 40) || *((_DWORD *)v10 + 17) != v2 )
    {
LABEL_62:
      v10 += 38;
      if ( (int)v10 >= (int)flt_4AA360 )
        goto LABEL_91;
    }
    if ( *v10 >= 500.0 )
    {
      v70 = v10[5];
      v71 = v10[6];
      v72 = v10[7];
      v73 = v10[8];
    }
    else
    {
      if ( bonus_energizer_timer >= 1.0 )
        v11 = 1.0;
      else
        v11 = bonus_energizer_timer;
      v70 = (1.0 - v11) * v10[5] + v11 * 0.5;
      v71 = (1.0 - v11) * v10[6] + v11 * 0.5;
      v72 = (1.0 - v11) * v10[7] + v11;
      v73 = (1.0 - v11) * v10[8] + v11;
    }
    v12 = *((_DWORD *)v10 + 25);
    if ( (v12 & 4) != 0 && (v12 & 0x40) == 0 )
    {
      v13 = (int)(__int64)(v10[27] + 0.5) % 16;
      if ( v13 > 7 )
        v13 = 15 - v13;
      (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(
        grim_interface_ptr,
        8,
        creature_type_base_frame[17 * a1] + v13 + 16);
      if ( *(v10 - 6) < 0.0 )
      {
        v14 = *(v10 - 6) * 0.1 + v73;
        if ( v14 < 0.0 )
          v14 = 0.0;
        goto LABEL_59;
      }
LABEL_58:
      v14 = v73;
LABEL_59:
      v73 = v14 * a2;
      (*(void (__thiscall **)(int, float *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &v70);
      v49 = v10[1] - 1.5707964;
      (*(void (__stdcall **)(_DWORD))(*(_DWORD *)grim_interface_ptr + 252))(LODWORD(v49));
      v17 = v10[3] * 0.5;
      v63 = v17;
      v69 = *(float *)&camera_offset_y + *(v10 - 4);
      v57 = *(float *)&camera_offset_x + *(v10 - 5) - v63;
      v60 = v69 - v17;
      (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
        LODWORD(v57),
        LODWORD(v60),
        *((_DWORD *)v10 + 3),
        *((_DWORD *)v10 + 3));
      if ( *(v10 - 6) < -10.0 )
      {
        v18 = *((_BYTE *)v10 + 100);
        *((_BYTE *)v10 - 40) = 0;
        if ( (v18 & 4) != 0 )
          creature_spawn_slot_owner[6 * *((_DWORD *)v10 + 20)] = 0;
      }
      goto LABEL_62;
    }
    if ( *(v10 - 6) >= 16.0 )
    {
      HIDWORD(v15) = (__int64)(v10[27] + 0.5);
      if ( (creature_type_anim_flags[68 * a1] & 1) == 0 || SHIDWORD(v15) <= 15 )
        goto LABEL_55;
      LODWORD(v15) = 31 - HIDWORD(v15);
    }
    else
    {
      if ( *(v10 - 6) < 0.0 )
      {
        HIDWORD(v15) = creature_type_base_frame[17 * a1] + 15;
        v16 = *(v10 - 6) * 0.1 + v73;
        v73 = v16;
        if ( v16 < 0.0 )
          v73 = 0.0;
        goto LABEL_55;
      }
      v15 = (__int64)((double)(creature_type_base_frame[17 * a1] + 15) - *(v10 - 6));
    }
    HIDWORD(v15) = v15;
LABEL_55:
    if ( (v12 & 0x10) != 0 )
      HIDWORD(v15) += 32;
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 260))(
      grim_interface_ptr,
      8,
      HIDWORD(v15));
    goto LABEL_58;
  }
  v19 = &creature_anim_phase;
  do
  {
    if ( !*((_BYTE *)v19 - 148) || *((_DWORD *)v19 - 10) != a1 )
      goto LABEL_90;
    v20 = *((_DWORD *)v19 - 2);
    v70 = *(v19 - 22);
    v71 = *(v19 - 21);
    v72 = *(v19 - 20);
    v73 = *(v19 - 19);
    if ( (v20 & 4) == 0 || (v20 & 0x40) != 0 )
    {
      if ( *(v19 - 33) >= 16.0 )
      {
        HIDWORD(v23) = (__int64)(*v19 + 0.5);
        if ( (creature_type_anim_flags[68 * a1] & 1) == 0 || SHIDWORD(v23) <= 15 )
          goto LABEL_83;
        LODWORD(v23) = 31 - HIDWORD(v23);
      }
      else
      {
        if ( *(v19 - 33) < 0.0 )
        {
          HIDWORD(v23) = creature_type_base_frame[17 * a1] + 15;
          v24 = *(v19 - 33) * 0.1 + v73;
          v73 = v24;
          if ( v24 < 0.0 )
            v73 = 0.0;
          goto LABEL_83;
        }
        v23 = (__int64)((double)(creature_type_base_frame[17 * a1] + 15) - *(v19 - 33));
      }
      HIDWORD(v23) = v23;
LABEL_83:
      if ( (v20 & 0x10) != 0 )
        HIDWORD(v23) += 32;
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 260))(
        grim_interface_ptr,
        8,
        HIDWORD(v23));
      goto LABEL_86;
    }
    v21 = (int)(__int64)(*v19 + 0.5) % 16;
    if ( v21 > 7 )
      v21 = 15 - v21;
    (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(
      grim_interface_ptr,
      8,
      creature_type_base_frame[17 * a1] + v21 + 16);
    if ( *(v19 - 33) < 0.0 )
    {
      v22 = *(v19 - 33) * 0.1 + v73;
      if ( v22 < 0.0 )
        v22 = 0.0;
      goto LABEL_87;
    }
LABEL_86:
    v22 = v73;
LABEL_87:
    v73 = v22 * a2;
    (*(void (__thiscall **)(int, float *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &v70);
    v50 = *(v19 - 26) - 1.5707964;
    (*(void (__stdcall **)(_DWORD))(*(_DWORD *)grim_interface_ptr + 252))(LODWORD(v50));
    v25 = *(v19 - 24) * 0.5;
    v67 = v25;
    v65 = *(float *)&camera_offset_y + *(v19 - 31);
    v58 = *(float *)&camera_offset_x + *(v19 - 32) - v67;
    v61 = v65 - v25;
    (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
      LODWORD(v58),
      LODWORD(v61),
      *((_DWORD *)v19 - 24),
      *((_DWORD *)v19 - 24));
    if ( *(v19 - 33) < -10.0 )
    {
      v26 = *((_BYTE *)v19 - 8);
      *((_BYTE *)v19 - 148) = 0;
      if ( (v26 & 4) != 0 )
        creature_spawn_slot_owner[6 * *((_DWORD *)v19 - 7)] = 0;
    }
LABEL_90:
    v19 += 38;
  }
  while ( (int)v19 < (int)flt_4AA3CC );
LABEL_91:
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  result = config_fx_toggle;
  if ( config_fx_toggle )
  {
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      2,
      v37,
      v42,
      v48);
    v70 = 1.0;
    v73 = 1.0;
    v71 = 1.0;
    v72 = 1.0;
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v28 = creature_hitbox_size;
    do
    {
      if ( *((_BYTE *)v28 - 16) && v28[23] == a1 && *((float *)v28 + 10) > 0.0 )
      {
        v29 = *((float *)v28 + 10) * 5.0;
        v73 = v29;
        if ( v29 > 1.0 )
          v73 = 1.0;
        v30 = v28[31];
        if ( (v30 & 4) == 0 || (v30 & 0x40) != 0 )
        {
          if ( *(float *)v28 >= 16.0 )
          {
            v32 = (__int64)(*((float *)v28 + 33) + 0.5);
            if ( (creature_type_anim_flags[68 * a1] & 1) != 0 && (int)v32 > 15 )
              LODWORD(v32) = 31 - v32;
            if ( (v30 & 0x10) != 0 )
              LODWORD(v32) = v32 + 32;
          }
          else if ( *(float *)v28 >= 0.0 )
          {
            v32 = (__int64)((double)(creature_type_base_frame[17 * a1] + 15) - *(float *)v28);
          }
          else
          {
            LODWORD(v32) = creature_type_base_frame[17 * a1] + 15;
          }
          HIDWORD(v32) = *(_DWORD *)grim_interface_ptr;
        }
        else
        {
          v31 = (int)(__int64)(*((float *)v28 + 33) + 0.5) % 16;
          if ( v31 > 7 )
            v31 = 15 - v31;
          HIDWORD(v32) = *(_DWORD *)grim_interface_ptr;
          LODWORD(v32) = creature_type_base_frame[17 * a1] + v31 + 16;
        }
        (*(void (__stdcall **)(int, _DWORD))(HIDWORD(v32) + 260))(8, v32);
        v73 = v73 * a2;
        (*(void (__thiscall **)(int, float *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &v70);
        v52 = *((float *)v28 + 7) - 1.5707964;
        (*(void (__stdcall **)(_DWORD))(*(_DWORD *)grim_interface_ptr + 252))(LODWORD(v52));
        v33 = *((float *)v28 + 9) * 0.5;
        v68 = v33;
        v66 = *(float *)&camera_offset_y + *((float *)v28 + 2);
        v59 = *(float *)&camera_offset_x + *((float *)v28 + 1) - v68;
        v62 = v66 - v33;
        (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
          grim_interface_ptr,
          LODWORD(v59),
          LODWORD(v62),
          v28[9],
          v28[9]);
        (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
          grim_interface_ptr,
          LODWORD(v59),
          LODWORD(v62),
          v28[9],
          v28[9]);
      }
      v28 += 38;
    }
    while ( (int)v28 < (int)&flt_4AA348 );
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    return (*(int (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
             grim_interface_ptr,
             20,
             6,
             v38,
             v43,
             v51);
  }
  return result;
}

// creature_render_all @ 0x00419680
// creature render pass: overlays + per-type draws via creature_render_type
void sub_419680()
{
  int *v0; // esi
  double v1; // st7
  double v2; // st7
  double v3; // st7
  double v4; // st7
  float *v5; // esi
  double v6; // st7
  float v7; // [esp+FCh] [ebp-20h]
  float v8; // [esp+FCh] [ebp-20h]
  float v9; // [esp+FCh] [ebp-20h]
  float v10; // [esp+FCh] [ebp-20h]
  int v11; // [esp+100h] [ebp-1Ch]
  float v12; // [esp+100h] [ebp-1Ch]
  float v13; // [esp+100h] [ebp-1Ch]
  float v14; // [esp+100h] [ebp-1Ch]
  int v15; // [esp+100h] [ebp-1Ch]
  int v16; // [esp+100h] [ebp-1Ch]
  int v17; // [esp+100h] [ebp-1Ch]
  float v18; // [esp+100h] [ebp-1Ch]
  int v19; // [esp+100h] [ebp-1Ch]
  int v20; // [esp+104h] [ebp-18h]
  int v21; // [esp+104h] [ebp-18h]
  int v22; // [esp+104h] [ebp-18h]
  int v23; // [esp+104h] [ebp-18h]
  int v24; // [esp+104h] [ebp-18h]
  int v25; // [esp+108h] [ebp-14h]
  float v26; // [esp+108h] [ebp-14h]
  float v27; // [esp+108h] [ebp-14h]
  float v28; // [esp+108h] [ebp-14h]
  int v29; // [esp+108h] [ebp-14h]
  int v30; // [esp+108h] [ebp-14h]
  int v31; // [esp+108h] [ebp-14h]
  float v32; // [esp+108h] [ebp-14h]
  int v33; // [esp+108h] [ebp-14h]
  float v34; // [esp+114h] [ebp-8h]
  int v35; // [esp+114h] [ebp-8h]
  float v36; // [esp+118h] [ebp-4h]

  v34 = ui_transition_alpha;
  if ( ui_transition_alpha > 0.0
    && game_state_id != 20
    && game_state_id != 22
    && game_state_prev != 20
    && game_state_prev != 22 )
  {
    (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 19, 5);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      v11,
      v20,
      v25);
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      particles_texture,
      0);
    effect_select_texture(16);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      0,
      0,
      0,
      1065353216);
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v0 = creature_hitbox_size;
    do
    {
      if ( *((_BYTE *)v0 - 16) )
      {
        if ( perk_count_get(perk_id_monster_vision) )
        {
          if ( *(float *)v0 < 0.0 && (v1 = (*(float *)v0 + 10.0) * 0.1, v1 <= 1.0) )
          {
            if ( v1 < 0.0 )
              v1 = 0.0;
          }
          else
          {
            v1 = 1.0;
          }
          v26 = v1 * v34;
          (*(void (__stdcall **)(int, int, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
            1065353216,
            1065353216,
            0,
            LODWORD(v26));
          v12 = *(float *)&camera_offset_y + *((float *)v0 + 2) - 45.0;
          v7 = *(float *)&camera_offset_x + *((float *)v0 + 1) - 45.0;
          (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v7),
            LODWORD(v12),
            1119092736,
            1119092736);
        }
        if ( *((_BYTE *)v0 - 7) )
        {
          if ( *(float *)v0 >= 0.0 )
            v2 = 1.0;
          else
            v2 = (*(float *)v0 + 10.0) * 0.1;
          v27 = v2 * v34;
          (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
            0,
            0,
            0,
            LODWORD(v27));
          v13 = *(float *)&camera_offset_y + *((float *)v0 + 2) - 40.0;
          v8 = *(float *)&camera_offset_x + *((float *)v0 + 1) - 40.0;
          (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v8),
            LODWORD(v13),
            1117782016,
            1117782016);
        }
        if ( (v0[31] & 1) != 0 )
        {
          if ( *(float *)v0 >= 0.0 )
            v3 = 1.0;
          else
            v3 = (*(float *)v0 + 10.0) * 0.1;
          v28 = v3 * v34;
          (*(void (__stdcall **)(int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
            1065353216,
            0,
            0,
            LODWORD(v28));
          v14 = *(float *)&camera_offset_y + *((float *)v0 + 2) - 30.0;
          v9 = *(float *)&camera_offset_x + *((float *)v0 + 1) - 30.0;
          (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v9),
            LODWORD(v14),
            1114636288,
            1114636288);
        }
      }
      v0 += 38;
    }
    while ( (int)v0 < (int)&flt_4AA348 );
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    creature_render_type(0, v34);
    creature_render_type(3, v34);
    creature_render_type(4, v34);
    creature_render_type(2, v34);
    creature_render_type(1, v34);
    if ( bonus_freeze_timer > 0.0 )
    {
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v15,
        v21,
        v29);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v16,
        v22,
        v30);
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
        grim_interface_ptr,
        particles_texture,
        0);
      effect_select_texture(14);
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        0,
        0,
        0,
        1065353216);
      (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
      v4 = 1.0;
      if ( bonus_freeze_timer < 1.0 )
      {
        v4 = bonus_freeze_timer;
        if ( bonus_freeze_timer <= 1.0 )
        {
          if ( v4 < 0.0 )
            v4 = 0.0;
        }
        else
        {
          v4 = 1.0;
        }
      }
      v36 = v4 * v34 * 0.69999999;
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v35 = 0;
      v5 = &creature_size;
      do
      {
        if ( *((_BYTE *)v5 - 52) )
        {
          (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
            grim_interface_ptr,
            1065353216,
            1065353216,
            1065353216,
            COERCE_FLOAT(LODWORD(v36)));
          v32 = (double)v35 * 0.0099999998 + *(v5 - 2);
          (*(void (__stdcall **)(_DWORD))(*(_DWORD *)grim_interface_ptr + 252))(LODWORD(v32));
          v6 = *v5 * 0.5;
          v18 = *(float *)&camera_offset_y + *(v5 - 7) - v6;
          v10 = *(float *)&camera_offset_x + *(v5 - 8) - v6;
          (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v10),
            LODWORD(v18),
            *(_DWORD *)v5,
            *(_DWORD *)v5);
        }
        v5 += 38;
        ++v35;
      }
      while ( (int)v5 < (int)flt_4AA36C );
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v17,
        v23,
        v31);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v19,
        v24,
        v33);
    }
    (*(void (__thiscall **)(int, _DWORD, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      0,
      1065353216,
      1065353216,
      1065353216);
  }
}

// ui_element_set_rect @ 0x00419BA0
// sets element quad vertices/UVs for a size and offset
float *__cdecl sub_419BA0(int a1, float a2, float a3, float *a4)
{
  double v4; // st7
  float *result; // eax
  float v6; // edx
  int v7; // edx
  double v8; // st7
  float v9; // [esp+0h] [ebp-Ch]
  float v10; // [esp+4h] [ebp-8h]
  float v11; // [esp+4h] [ebp-8h]
  float v12; // [esp+4h] [ebp-8h]
  float v13; // [esp+8h] [ebp-4h]
  float v14; // [esp+14h] [ebp+8h]
  float v15; // [esp+14h] [ebp+8h]

  v4 = 1.0 / a2;
  *(_DWORD *)a1 = 1065353216;
  *(_DWORD *)(a1 + 4) = 1065353216;
  result = (float *)(a1 + 4);
  v9 = 1.0 / a3;
  v10 = a2 - 1.0;
  *(float *)(a1 + 28) = v10;
  *(_DWORD *)(a1 + 32) = 1065353216;
  *(_DWORD *)(a1 + 84) = 1065353216;
  v14 = a3 - 1.0;
  *(float *)(a1 + 88) = v14;
  v6 = v10;
  v11 = v4;
  *(float *)(a1 + 56) = v6;
  *(float *)(a1 + 60) = v14;
  *(float *)(a1 + 20) = v11;
  *(float *)(a1 + 24) = v9;
  v15 = 1.0 - v4;
  *(float *)(a1 + 48) = v15;
  v12 = v4;
  *(float *)(a1 + 52) = v9;
  *(float *)(a1 + 104) = v12;
  v13 = 1.0 - v9;
  *(float *)(a1 + 76) = v15;
  *(float *)(a1 + 108) = v15;
  *(float *)(a1 + 80) = v13;
  v7 = 4;
  do
  {
    result[3] = NAN;
    result[1] = 0.5;
    result[2] = 1.0;
    v8 = *(result - 1) + *a4;
    result += 7;
    --v7;
    *(result - 8) = v8;
    *(result - 7) = *(result - 7) + a4[1];
  }
  while ( v7 );
  return result;
}

// ui_element_load @ 0x00419D00
// loads a UI element JAZ asset and logs failures
char __cdecl sub_419D00(int a1, const char *a2)
{
  int v2; // eax
  _BYTE v4[4]; // [esp+8h] [ebp-104h] BYREF
  char ArgList[256]; // [esp+Ch] [ebp-100h] BYREF

  strcpy(ArgList, a2);
  v4[strlen(a2)] = 0;
  if ( *(float *)(dword_480854 + 12) == 0.0 )
    console_printf((int)&console_log_queue, "Loading uiElement %s\n", ArgList);
  (*(void (__thiscall **)(int, char *, const char *))(*(_DWORD *)grim_interface_ptr + 180))(
    grim_interface_ptr,
    ArgList,
    a2);
  v2 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(grim_interface_ptr, ArgList);
  *(_DWORD *)(a1 + 224) = v2;
  if ( v2 == -1 )
    LOBYTE(v2) = console_printf((int)&console_log_queue, "! FAILED Loading uiElement %s\n", ArgList);
  return v2;
}

// ui_menu_assets_init @ 0x00419DD0
// loads menu UI elements and seeds layout copies
int sub_419DD0()
{
  float *v0; // eax
  double v1; // st7
  int v3; // [esp+8h] [ebp-8h] BYREF
  int v4; // [esp+Ch] [ebp-4h]

  ui_element_load((int)&unk_48FAC0, aUiUiSigncrimso);
  v3 = -1005560791;
  v4 = -1032323072;
  ui_element_set_rect((int)&unk_48FAC0, 573.44, 143.36, (float *)&v3);
  ui_element_load((int)&unk_48FBA8, aUiUiMenuitemJa);
  v3 = -1030750208;
  v4 = -1032847360;
  ui_element_set_rect((int)&unk_48FBA8, 512.0, 64.0, (float *)&v3);
  ui_element_load((int)&unk_48FC90, aUiUiMenupanelJ);
  v3 = 1101004800;
  v4 = -1029439488;
  ui_element_set_rect((int)&unk_48FC90, 512.0, 256.0, (float *)&v3);
  qmemcpy(&unk_48FD78, &unk_48FC90, 0xE8u);
  dword_48FE5C = 8;
  qmemcpy(&unk_48FE3C, &unk_48FDCC, 0x1Cu);
  v0 = (float *)&unk_48FD78;
  qmemcpy(&unk_48FE20, &unk_48FDB0, 0x1Cu);
  flt_48FDB4 = flt_48FDB4 - 116.0;
  flt_48FDD0 = flt_48FDD0 - 116.0;
  dword_48FDC8 = 1057095680;
  dword_48FDE4 = 1057095680;
  qmemcpy(&unk_48FDE8, &unk_48FDCC, 0x1Cu);
  qmemcpy(&unk_48FE04, &unk_48FDB0, 0x1Cu);
  flt_48FDEC = flt_48FDEC + 124.0;
  flt_48FE08 = flt_48FE08 + 124.0;
  dword_48FE00 = 1058406400;
  dword_48FE1C = 1058406400;
  flt_48FE24 = flt_48FE24 + 124.0;
  flt_48FE40 = flt_48FE40 + 124.0;
  do
  {
    v1 = *v0 - 84.0;
    v0[1] = v0[1];
    v0 += 7;
    *(v0 - 7) = v1;
  }
  while ( (int)v0 < (int)&flt_48FE58 );
  qmemcpy(&unk_48FE60, &unk_48FD78, 0xE8u);
  flt_48FED4 = flt_48FDEC - 100.0;
  flt_48FEF0 = flt_48FEF0 - 100.0;
  flt_48FF0C = flt_48FF0C - 100.0;
  flt_48FF28 = flt_48FF28 - 100.0;
  return ui_menu_layout_init();
}

// ui_render_aim_enhancement @ 0x0041A320
// renders the aim enhancement overlay (cv_aimEnhancementFade-driven)
int __cdecl sub_41A320(float *a1)
{
  int v1; // edx
  double v2; // st7
  int v3; // edx
  double v4; // st7
  int v5; // edx
  float v7; // [esp+A0h] [ebp-14h]
  float v8; // [esp+A4h] [ebp-10h]
  int v9; // [esp+A8h] [ebp-Ch]
  int v10; // [esp+ACh] [ebp-8h]

  flt_4902F0 = frame_dt + flt_4902F0;
  flt_4902F4 = frame_dt * 0.60000002 + flt_4902F4;
  (*(void (__thiscall **)(int, int, int, float, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    COERCE_FLOAT(LODWORD(v8)),
    v9,
    v10);
  (*(void (__thiscall **)(int, int, int, float, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    2,
    COERCE_FLOAT(LODWORD(v8)),
    v9,
    v10);
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
    grim_interface_ptr,
    particles_texture,
    0);
  effect_select_texture(13);
  v1 = dword_48087C;
  if ( *(float *)(dword_48087C + 12) > 1.0 )
  {
    *(_DWORD *)(dword_48087C + 12) = 1065353216;
    v1 = dword_48087C;
  }
  if ( *(float *)(v1 + 12) < 0.0 )
  {
    *(_DWORD *)(v1 + 12) = 0;
    v1 = dword_48087C;
  }
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    *(_DWORD *)(v1 + 12));
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v10 = 1115684864;
  v9 = 1115684864;
  v2 = a1[1] - 32.0;
  v8 = *(float *)&grim_interface_ptr;
  v3 = *(_DWORD *)grim_interface_ptr;
  v8 = v2;
  v7 = *a1 - 32.0;
  (*(void (__stdcall **)(float, float, int, int))(v3 + 284))(
    COERCE_FLOAT(LODWORD(v7)),
    COERCE_FLOAT(LODWORD(v8)),
    1115684864,
    1115684864);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, float, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    COERCE_FLOAT(LODWORD(v8)),
    v9,
    v10);
  (*(void (__thiscall **)(int, int, int, float, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    6,
    COERCE_FLOAT(LODWORD(v8)),
    v9,
    v10);
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_48F79C, 0);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    *(_DWORD *)(dword_48087C + 12));
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v4 = a1[1];
  v10 = 1101004800;
  v9 = 1101004800;
  v8 = *(float *)&grim_interface_ptr;
  v5 = *(_DWORD *)grim_interface_ptr;
  v8 = v4 - 10.0;
  v7 = *a1 - 10.0;
  (*(void (__stdcall **)(float, float, int, int))(v5 + 284))(
    COERCE_FLOAT(LODWORD(v7)),
    COERCE_FLOAT(LODWORD(v8)),
    1101004800,
    1101004800);
  return (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
}

// ui_elements_update_and_render @ 0x0041A530
// advances UI timeline, handles transitions, updates + renders all UI elements
int sub_41A530()
{
  int v0; // eax
  int result; // eax
  long double v2; // st6
  int *v3; // esi
  int v4; // [esp-Ch] [ebp-10h]
  int v5; // [esp-8h] [ebp-Ch]
  int v6; // [esp-4h] [ebp-8h]

  (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 21, 2);
  if ( !console_open_flag )
  {
    if ( ui_transition_direction )
      v0 = frame_dt_ms + ui_elements_timeline;
    else
      v0 = ui_elements_timeline - frame_dt_ms;
    ui_elements_timeline = v0;
  }
  if ( ui_elements_timeline < 0 )
  {
    ui_elements_timeline = 0;
    if ( demo_mode_active && !game_state_pending )
      terrain_generate_random();
    game_state_set(game_state_pending);
    game_state_pending = 25;
  }
  result = ui_elements_max_timeline();
  if ( ui_elements_timeline > result )
  {
    if ( !game_state_id && demo_mode_active )
    {
      demo_mode_active = 0;
      config_load_presets(0);
    }
    byte_487292 = 1;
    flt_487594 = cos(0.0);
    v2 = sin(0.0);
    flt_487598 = -v2;
    flt_48759C = v2;
    flt_4875A0 = flt_487594;
    result = ui_elements_max_timeline();
    ui_elements_timeline = result;
  }
  if ( game_state_id != 9 )
  {
    v3 = &ui_element_table_start;
    do
    {
      ui_element_update(*v3);
      ui_element_render(*v3--);
    }
    while ( (int)v3 >= (int)&ui_element_table_end );
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    if ( game_state_id == 10 )
      byte_47EA50 = 1;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    return (*(int (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
             grim_interface_ptr,
             24,
             1056964608,
             v4,
             v5,
             v6);
  }
  return result;
}

// ui_draw_progress_bar @ 0x0041A6D0
// draws a filled progress bar with a tinted background
int __cdecl sub_41A6D0(float *a1, int a2, float a3, float *a4)
{
  float v5; // [esp+10h] [ebp-2Ch]
  float v6; // [esp+24h] [ebp-18h] BYREF
  float v7; // [esp+28h] [ebp-14h]
  float v8[4]; // [esp+2Ch] [ebp-10h] BYREF

  if ( a3 >= 0.0 )
  {
    if ( a3 > 1.0 )
      a3 = 1.0;
  }
  else
  {
    a3 = 0.0;
  }
  v8[0] = *a4 * 0.60000002;
  v8[1] = a4[1] * 0.60000002;
  v8[2] = a4[2] * 0.60000002;
  v8[3] = a4[3] * 0.40000001;
  v6 = *a1;
  v7 = a1[1];
  (*(void (__thiscall **)(int, float *, int, int, float *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    &v6,
    a2,
    1082130432,
    v8);
  v6 = *a1 + 1.0;
  v7 = a1[1] + 1.0;
  v5 = (*(float *)&a2 - 2.0) * a3;
  return (*(int (__thiscall **)(int, float *, _DWORD, int, float *))(*(_DWORD *)grim_interface_ptr + 208))(
           grim_interface_ptr,
           &v6,
           LODWORD(v5),
           0x40000000,
           a4);
}

// sub_41A7D0 @ 0x0041A7D0
_DWORD *sub_41A7D0()
{
  _DWORD *result; // eax
  int v1; // ecx

  result = &bonus_hud_slot_y;
  v1 = 16;
  do
  {
    result[6] = 1084227584;
    *((_BYTE *)result - 4) = 0;
    *result = 0;
    result[5] = 1;
    result[4] = aEmpty;
    result[1] = 1065353216;
    result += 8;
    --v1;
  }
  while ( v1 );
  return result;
}

// sub_41A810 @ 0x0041A810
char __cdecl sub_41A810(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  char *v5; // ecx
  char *v6; // eax
  int v7; // ecx
  int v8; // esi
  _DWORD *v9; // edx
  int v10; // ecx

  v4 = 0;
  v5 = (char *)&bonus_hud_slot_active;
  while ( *v5 )
  {
    v5 += 32;
    ++v4;
    if ( (int)v5 >= (int)byte_48F788 )
      return v4;
  }
  v6 = (char *)&bonus_hud_slot_active + 32 * v4;
  *((_DWORD *)v6 + 3) = a3;
  *((_DWORD *)v6 + 6) = a2;
  v7 = config_player_count;
  *((_DWORD *)v6 + 4) = a4;
  *v6 = 1;
  *((_DWORD *)v6 + 1) = -1019740160;
  *((_DWORD *)v6 + 5) = a1;
  if ( v7 <= 1 )
    *((_DWORD *)v6 + 4) = 0;
  v8 = 0;
  v9 = &bonus_hud_slot_timer_ptr;
  do
  {
    LOBYTE(v4) = *((_BYTE *)v9 - 12);
    if ( (_BYTE)v4 )
    {
      v10 = 16;
      v4 = (int)byte_48F788;
      do
      {
        if ( *v9 == *(_DWORD *)(v4 + 12) && v8 != v10 )
          *(_BYTE *)v4 = 0;
        v4 -= 32;
        --v10;
      }
      while ( v4 >= (int)&bonus_hud_slot_active );
    }
    v9 += 8;
    ++v8;
  }
  while ( (int)v9 < (int)&dword_48F794 );
  return v4;
}

// bonus_hud_slot_update_and_render @ 0x0041A8B0
// updates bonus HUD slot animation and renders icon/timers
void __usercall sub_41A8B0(int a1@<edi>, float *a2, int a3, float a4, float a5)
{
  char *v5; // esi
  float *v6; // eax
  double v7; // st7
  int v8; // eax
  _BYTE *v9; // ecx
  bool v10; // zf
  int v11; // edx
  float v12; // ebx
  _DWORD *v13; // edi
  int v14; // eax
  float *v15; // ecx
  double v16; // st7
  float *v17; // edx
  double v18; // st7
  float *v19; // edx
  double v20; // st7
  float *v21; // eax
  double v22; // st7
  double v23; // st7
  float v24; // [esp+7Ch] [ebp-30h]
  float v25; // [esp+7Ch] [ebp-30h]
  float v26; // [esp+80h] [ebp-2Ch]
  float v27; // [esp+80h] [ebp-2Ch]
  float v28; // [esp+84h] [ebp-28h]
  float v29; // [esp+84h] [ebp-28h]
  float v30; // [esp+84h] [ebp-28h]
  float v31; // [esp+84h] [ebp-28h]
  float v32; // [esp+84h] [ebp-28h]
  int v33; // [esp+98h] [ebp-14h] BYREF
  float v34; // [esp+9Ch] [ebp-10h]
  int v35; // [esp+A0h] [ebp-Ch] BYREF
  int v36; // [esp+A4h] [ebp-8h]
  int v37; // [esp+A8h] [ebp-4h]
  float retaddr; // [esp+ACh] [ebp+0h]
  float v39; // [esp+B8h] [ebp+Ch]

  v5 = (char *)&bonus_hud_slot_active + 32 * a3;
  if ( *v5 )
  {
    if ( **((float **)v5 + 3) > 0.0 || (v6 = (float *)*((_DWORD *)v5 + 4)) != 0 && *v6 > 0.0 )
      v7 = frame_dt * 350.0 + *((float *)v5 + 1);
    else
      v7 = *((float *)v5 + 1) - frame_dt * 320.0;
    *((float *)v5 + 1) = v7;
    if ( *((float *)v5 + 1) > -2.0 )
      *((_DWORD *)v5 + 1) = -1073741824;
    if ( *((float *)v5 + 1) >= -184.0 )
    {
      v11 = *(_DWORD *)grim_interface_ptr;
      if ( *(float *)(dword_480878 + 12) == 0.0 )
      {
        (*(void (__stdcall **)(int, _DWORD, int))(v11 + 196))(dword_48F7C4, 0, a1);
        (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
        (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
          grim_interface_ptr,
          0,
          0,
          1065353216,
          1065353216);
        v39 = a5 * 0.69999999;
        v12 = v39;
        (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          COERCE_FLOAT(LODWORD(v39)));
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
        v13 = (_DWORD *)a3;
        v27 = *(float *)a3 - 11.0;
        (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
          grim_interface_ptr,
          *((_DWORD *)v5 + 1),
          LODWORD(v27),
          1127612416,
          1112801280);
      }
      else
      {
        (*(void (__stdcall **)(int, _DWORD, int))(v11 + 196))(dword_48F7C4, 0, a1);
        (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
        (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
          grim_interface_ptr,
          0,
          0,
          1065353216,
          1065353216);
        v39 = a5 * 0.69999999;
        v12 = v39;
        (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          COERCE_FLOAT(LODWORD(v39)));
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
        v13 = (_DWORD *)a3;
        v26 = *(float *)a3 + 5.0;
        v24 = *((float *)v5 + 1) - 100.0 + 4.0;
        (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
          LODWORD(v24),
          LODWORD(v26),
          1127612416,
          1104412672);
      }
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        LODWORD(a5));
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
        grim_interface_ptr,
        bonus_texture,
        0);
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 260))(
        grim_interface_ptr,
        4,
        *((_DWORD *)v5 + 6));
      v25 = *((float *)v5 + 1) - 1.0;
      (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
        LODWORD(v25),
        *v13,
        1107296256,
        1107296256);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      v14 = *((_DWORD *)v5 + 4);
      if ( *(float *)(dword_480878 + 12) == 0.0 )
      {
        v19 = (float *)*((_DWORD *)v5 + 3);
        if ( v14 )
        {
          *(float *)&v33 = *((float *)v5 + 1) + 36.0;
          v20 = *(float *)v13 + 21.0;
          v35 = 1036831949;
          v36 = 1050253722;
          v37 = 1058642330;
          v34 = v20 - 4.0;
          v30 = *v19 * 0.050000001;
          ui_draw_progress_bar((float *)&v33, 1120403456, v30, (float *)&v35);
          v21 = (float *)*((_DWORD *)v5 + 4);
          *(float *)&v33 = *((float *)v5 + 1) + 36.0;
          retaddr = v39;
          v34 = *(float *)v13 + 23.0;
          v22 = *v21 * 0.050000001;
          v35 = 1036831949;
        }
        else
        {
          retaddr = v39;
          *(float *)&v33 = *((float *)v5 + 1) + 36.0;
          v23 = *(float *)v13 + 21.0;
          v35 = 1036831949;
          v34 = v23;
          v22 = *v19 * 0.050000001;
        }
        v36 = 1050253722;
        v37 = 1058642330;
        v31 = v22;
        ui_draw_progress_bar((float *)&v33, 1120403456, v31, (float *)&v35);
        (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          COERCE_FLOAT(LODWORD(v12)));
        v32 = *((float *)v5 + 1) + 36.0;
        (*(void (__stdcall **)(_DWORD))(*(_DWORD *)grim_interface_ptr + 324))(LODWORD(v32));
        *(float *)v13 = *(float *)v13 + 52.0;
      }
      else
      {
        if ( v14 )
        {
          v15 = (float *)*((_DWORD *)v5 + 3);
          *(float *)&v33 = *((float *)v5 + 1) + 36.0;
          v16 = *(float *)v13 + 21.0;
          v35 = 1036831949;
          v36 = 1050253722;
          v37 = 1058642330;
          v34 = v16 - 4.0 - 4.0;
          v28 = *v15 * 0.050000001;
          ui_draw_progress_bar((float *)&v33, 1107296256, v28, (float *)&v35);
          v17 = (float *)*((_DWORD *)v5 + 4);
          *(float *)&v33 = *((float *)v5 + 1) + 36.0;
          v18 = *(float *)v13 + 23.0;
          retaddr = v39;
        }
        else
        {
          v17 = (float *)*((_DWORD *)v5 + 3);
          retaddr = v39;
          *(float *)&v33 = *((float *)v5 + 1) + 36.0;
          v18 = *(float *)v13 + 21.0;
        }
        v35 = 1036831949;
        v36 = 1050253722;
        v37 = 1058642330;
        v34 = v18 - 4.0;
        v29 = *v17 * 0.050000001;
        ui_draw_progress_bar((float *)&v33, 1107296256, v29, (float *)&v35);
        (*(void (__thiscall **)(int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216);
        *(float *)v13 = *(float *)v13 + 52.0;
      }
    }
    else
    {
      v8 = 15;
      if ( a3 <= 15 )
      {
        v9 = &unk_48F768;
        v10 = a3 == 15;
        do
        {
          if ( v10 )
          {
            *v5 = 0;
          }
          else if ( *v9 )
          {
            break;
          }
          --v8;
          v9 -= 32;
          v10 = a3 == v8;
        }
        while ( a3 <= v8 );
      }
      *a2 = *a2 + 52.0;
    }
  }
}

// ui_render_hud @ 0x0041AED0
// renders the in-game HUD (health, weapon icons, player UI)
int __cdecl sub_41AED0(float a1, float a2)
{
  int v2; // esi
  int v3; // eax
  int v4; // esi
  int v5; // eax
  long double v6; // st7
  long double v7; // st7
  int v8; // edx
  long double v9; // st6
  long double v10; // st7
  long double v11; // st7
  double v12; // st7
  int v13; // edx
  int v14; // ebx
  double v15; // st7
  int v16; // eax
  int v17; // eax
  int v18; // eax
  int v19; // esi
  int v20; // eax
  int v21; // edi
  int v22; // ebp
  int v23; // esi
  int v24; // edx
  int v25; // ebx
  int v26; // edx
  float v27; // edi
  int v28; // esi
  int v29; // edx
  int v30; // eax
  int *v31; // ecx
  int v32; // ebx
  double v33; // st7
  int v34; // edx
  int v35; // esi
  int v36; // eax
  int v37; // ecx
  int v38; // edx
  double v39; // st7
  int v40; // esi
  int v41; // esi
  int v42; // ebp
  int v43; // esi
  int v44; // ebp
  int v45; // esi
  int v46; // edx
  int v47; // ecx
  int v48; // esi
  int v49; // esi
  int v50; // edi
  int v51; // ecx
  int v52; // esi
  double v53; // st7
  double v55; // st6
  char v56; // c0
  double v57; // st6
  int v58; // edx
  int result; // eax
  float v60; // [esp+630h] [ebp-54h]
  float v61; // [esp+630h] [ebp-54h]
  float v62; // [esp+630h] [ebp-54h]
  float v63; // [esp+630h] [ebp-54h]
  float v64; // [esp+630h] [ebp-54h]
  float v65; // [esp+630h] [ebp-54h]
  float v66; // [esp+630h] [ebp-54h]
  int v67; // [esp+634h] [ebp-50h]
  float v68; // [esp+634h] [ebp-50h]
  float v69; // [esp+634h] [ebp-50h]
  int v70; // [esp+634h] [ebp-50h]
  float v71; // [esp+634h] [ebp-50h]
  float v72; // [esp+634h] [ebp-50h]
  float v73; // [esp+634h] [ebp-50h]
  int v74; // [esp+634h] [ebp-50h]
  float v75; // [esp+634h] [ebp-50h]
  int v76; // [esp+634h] [ebp-50h]
  int v77; // [esp+634h] [ebp-50h]
  int v78; // [esp+634h] [ebp-50h]
  int v79; // [esp+634h] [ebp-50h]
  float v80; // [esp+634h] [ebp-50h]
  float v81; // [esp+634h] [ebp-50h]
  int v82; // [esp+634h] [ebp-50h]
  int v83; // [esp+634h] [ebp-50h]
  int v84; // [esp+634h] [ebp-50h]
  float v85; // [esp+634h] [ebp-50h]
  int v86; // [esp+634h] [ebp-50h]
  float v87; // [esp+634h] [ebp-50h]
  float v88; // [esp+634h] [ebp-50h]
  int v89; // [esp+634h] [ebp-50h]
  float v90; // [esp+634h] [ebp-50h]
  float v91; // [esp+634h] [ebp-50h]
  int v92; // [esp+634h] [ebp-50h]
  int v93; // [esp+638h] [ebp-4Ch]
  float v94; // [esp+638h] [ebp-4Ch]
  int v95; // [esp+638h] [ebp-4Ch]
  float v96; // [esp+638h] [ebp-4Ch]
  char *v97; // [esp+638h] [ebp-4Ch]
  int v98; // [esp+638h] [ebp-4Ch]
  int v99; // [esp+638h] [ebp-4Ch]
  int v100; // [esp+638h] [ebp-4Ch]
  int v101; // [esp+638h] [ebp-4Ch]
  int v102; // [esp+638h] [ebp-4Ch]
  int v103; // [esp+638h] [ebp-4Ch]
  char *v104; // [esp+638h] [ebp-4Ch]
  int v105; // [esp+638h] [ebp-4Ch]
  float v106; // [esp+638h] [ebp-4Ch]
  int v107; // [esp+638h] [ebp-4Ch]
  float v108; // [esp+638h] [ebp-4Ch]
  float v109; // [esp+638h] [ebp-4Ch]
  int v110; // [esp+638h] [ebp-4Ch]
  int v111; // [esp+638h] [ebp-4Ch]
  int v112; // [esp+638h] [ebp-4Ch]
  int v113; // [esp+638h] [ebp-4Ch]
  float v114; // [esp+638h] [ebp-4Ch]
  float v115; // [esp+638h] [ebp-4Ch]
  int v116; // [esp+638h] [ebp-4Ch]
  int v117; // [esp+638h] [ebp-4Ch]
  float v118; // [esp+638h] [ebp-4Ch]
  int v119; // [esp+63Ch] [ebp-48h]
  float v120; // [esp+63Ch] [ebp-48h]
  float v121; // [esp+63Ch] [ebp-48h]
  int v122; // [esp+63Ch] [ebp-48h]
  float v123; // [esp+63Ch] [ebp-48h]
  float v124; // [esp+63Ch] [ebp-48h]
  int v125; // [esp+63Ch] [ebp-48h]
  int v126; // [esp+63Ch] [ebp-48h]
  int v127; // [esp+63Ch] [ebp-48h]
  int v128; // [esp+63Ch] [ebp-48h]
  int v129; // [esp+63Ch] [ebp-48h]
  int v130; // [esp+63Ch] [ebp-48h]
  int v131; // [esp+63Ch] [ebp-48h]
  int v132; // [esp+63Ch] [ebp-48h]
  int v133; // [esp+63Ch] [ebp-48h]
  float v134; // [esp+63Ch] [ebp-48h]
  float v135; // [esp+63Ch] [ebp-48h]
  float v136; // [esp+63Ch] [ebp-48h]
  int v137; // [esp+63Ch] [ebp-48h]
  float v138; // [esp+63Ch] [ebp-48h]
  int v139; // [esp+63Ch] [ebp-48h]
  int v140; // [esp+63Ch] [ebp-48h]
  float v141; // [esp+63Ch] [ebp-48h]
  int v142; // [esp+63Ch] [ebp-48h]
  int v143; // [esp+63Ch] [ebp-48h]
  float v144; // [esp+63Ch] [ebp-48h]
  int v145; // [esp+63Ch] [ebp-48h]
  float v146; // [esp+640h] [ebp-44h]
  int v147; // [esp+640h] [ebp-44h]
  float v148; // [esp+640h] [ebp-44h]
  int v149; // [esp+640h] [ebp-44h]
  int v150; // [esp+644h] [ebp-40h]
  int v151; // [esp+648h] [ebp-3Ch]
  float v152; // [esp+650h] [ebp-34h]
  float v153; // [esp+650h] [ebp-34h]
  float v154; // [esp+654h] [ebp-30h]
  float v155; // [esp+654h] [ebp-30h]
  float v156; // [esp+654h] [ebp-30h]
  float v157; // [esp+654h] [ebp-30h]
  float v158; // [esp+654h] [ebp-30h]
  float v159; // [esp+654h] [ebp-30h]
  float v160; // [esp+654h] [ebp-30h]
  float v161; // [esp+658h] [ebp-2Ch]
  float v162; // [esp+658h] [ebp-2Ch]
  int v163; // [esp+658h] [ebp-2Ch]
  int v164; // [esp+658h] [ebp-2Ch]
  float v165; // [esp+658h] [ebp-2Ch]
  float v166; // [esp+658h] [ebp-2Ch]
  int v167; // [esp+658h] [ebp-2Ch]
  float v168; // [esp+65Ch] [ebp-28h]
  __int64 v169; // [esp+660h] [ebp-24h] BYREF
  int v170; // [esp+668h] [ebp-1Ch]
  float v171; // [esp+66Ch] [ebp-18h]
  int v172; // [esp+670h] [ebp-14h] BYREF
  float v173; // [esp+674h] [ebp-10h]
  int v174; // [esp+678h] [ebp-Ch] BYREF
  int v175; // [esp+67Ch] [ebp-8h] BYREF
  float v176; // [esp+680h] [ebp-4h]

  if ( *(float *)(dword_480870 + 12) >= 0.0 && *(float *)(dword_480870 + 12) <= 1.0 )
    a1 = a1 * *(float *)(dword_480870 + 12);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 21, 1);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  v168 = a1 * 0.69999999;
  (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    COERCE_FLOAT(LODWORD(v168)));
  v2 = *(_DWORD *)grim_interface_ptr;
  v3 = (*(int (__thiscall **)(int, char *, _DWORD))(*(_DWORD *)grim_interface_ptr + 192))(
         grim_interface_ptr,
         aIgameui,
         0);
  (*(void (__thiscall **)(int, int))(v2 + 196))(grim_interface_ptr, v3);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    989855744,
    1015021568,
    1065320448,
    1065091072);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    grim_interface_ptr,
    0,
    0,
    1140850688,
    1115684864);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  if ( byte_4871B0 )
  {
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      2,
      v67,
      v93,
      v119);
    *(float *)&v172 = 27.0;
    if ( config_player_count == 1 )
    {
      v173 = 21.0;
      *(float *)&v175 = 27.0;
      v176 = 21.0;
    }
    else
    {
      v173 = 12.0;
      *(float *)&v175 = 27.0;
      v176 = 12.0;
    }
    v120 = a1 * 0.80000001;
    (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v120));
    v4 = *(_DWORD *)grim_interface_ptr;
    v5 = (*(int (__thiscall **)(int, char *, _DWORD))(*(_DWORD *)grim_interface_ptr + 192))(
           grim_interface_ptr,
           aIheart,
           0);
    (*(void (__thiscall **)(int, int))(v4 + 196))(grim_interface_ptr, v5);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      1023410176,
      1023410176,
      1064828928,
      1064828928);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v161 = 2.0;
    if ( config_player_count == 1 )
    {
      if ( *(float *)player_health < 30.0 )
        v161 = 5.0;
      v6 = sin(flt_47EA4C * v161);
      *(float *)&v172 = v6;
      v7 = pow(v6, 4.0) * 4.0 + 14.0;
      v8 = *(_DWORD *)grim_interface_ptr;
      v154 = v7 + v7;
      v121 = v154;
      v94 = v154;
      v9 = v176 - v7;
    }
    else
    {
      if ( *(float *)player_health < 30.0 )
        v161 = 5.0;
      v10 = sin(flt_47EA4C * v161);
      *(float *)&v172 = v10;
      v11 = (pow(v10, 4.0) * 4.0 + 14.0) * 0.5;
      v155 = v11 + v11;
      v68 = v176 - v11;
      v60 = *(float *)&v175 - v11;
      (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
        LODWORD(v60),
        LODWORD(v68),
        LODWORD(v155),
        LODWORD(v155));
      if ( player2_health >= 30.0 )
        v12 = v161;
      else
        v12 = 5.0;
      *(float *)&v172 = sin(flt_47EA4C * v12 + 1.5707964);
      v8 = *(_DWORD *)grim_interface_ptr;
      v7 = (pow(*(float *)&v172, 4.0) * 4.0 + 14.0) * 0.5;
      v156 = v7 + v7;
      v121 = v156;
      v94 = v156;
      v9 = v176 - v7 + 15.0;
    }
    v69 = v9;
    v61 = *(float *)&v175 - v7;
    (*(void (__stdcall **)(_DWORD, _DWORD, float, float))(v8 + 284))(
      LODWORD(v61),
      LODWORD(v69),
      COERCE_FLOAT(LODWORD(v94)),
      COERCE_FLOAT(LODWORD(v121)));
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  }
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    v67,
    v93,
    v119);
  if ( byte_4871B1 )
  {
    v123 = a1 * 0.80000001;
    (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v123));
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      ui_weapon_icons_texture,
      0);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v13 = *(_DWORD *)grim_interface_ptr;
    if ( config_player_count == 1 )
    {
      (*(void (__stdcall **)(int, int, int, int, float, int, int))(v13 + 264))(
        8,
        2,
        1,
        2 * effect_subrect_frame_table[31 * player_weapon_id[0]],
        COERCE_FLOAT(LODWORD(v146)),
        v150,
        v151);
      v151 = 1107296256;
      v150 = 1115684864;
      v146 = 2.0;
    }
    else
    {
      (*(void (__stdcall **)(int, int, int, int, float, int, int))(v13 + 264))(
        8,
        2,
        1,
        2 * effect_subrect_frame_table[31 * player_weapon_id[0]],
        COERCE_FLOAT(LODWORD(v146)),
        v150,
        v151);
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
        grim_interface_ptr,
        1130102784,
        1082130432,
        1107296256,
        1098907648);
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 264))(
        grim_interface_ptr,
        8,
        2,
        1,
        2 * effect_subrect_frame_table[31 * player2_weapon_id]);
      v151 = 1098907648;
      v150 = 1107296256;
      v146 = 20.0;
    }
    (*(void (__stdcall **)(int))(*(_DWORD *)grim_interface_ptr + 284))(1130102784);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
  }
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v70,
    v95,
    v122);
  if ( byte_4871B0 )
  {
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      dword_48F7C0,
      0);
    (*(void (__thiscall **)(int, float, int, int))(*(_DWORD *)grim_interface_ptr + 232))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v146)),
      v150,
      v151);
    *(float *)&v175 = 64.0;
    if ( config_player_count == 1 )
      v176 = 16.0;
    else
      v176 = 6.0;
    render_overlay_player_index = 0;
    if ( config_player_count > 0 )
    {
      *(float *)&v169 = a1 * 0.5;
      *(float *)&v172 = a1 * 0.80000001;
      v14 = v172;
      do
      {
        (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          v169);
        (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
          grim_interface_ptr,
          0,
          0,
          1065353216,
          1065353216);
        v172 = 16 * render_overlay_player_index;
        v71 = (double)(16 * render_overlay_player_index) + v176;
        (*(void (__stdcall **)(int, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
          1115684864,
          LODWORD(v71),
          1123024896,
          1091567616);
        v15 = *(float *)&player_health[216 * render_overlay_player_index] * 0.0099999998;
        v162 = v15;
        if ( v15 <= 1.0 )
        {
          if ( v162 < 0.0 )
            v162 = 0.0;
        }
        else
        {
          v162 = 1.0;
        }
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          v14);
        (*(void (__thiscall **)(int, _DWORD, _DWORD, float, int))(*(_DWORD *)grim_interface_ptr + 256))(
          grim_interface_ptr,
          0,
          0,
          COERCE_FLOAT(LODWORD(v162)),
          1065353216);
        v172 = 16 * render_overlay_player_index;
        v96 = v162 * 120.0;
        v72 = (double)(16 * render_overlay_player_index) + v176;
        (*(void (__stdcall **)(int, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 284))(
          1115684864,
          LODWORD(v72),
          LODWORD(v96),
          1091567616);
        ++render_overlay_player_index;
      }
      while ( render_overlay_player_index < config_player_count );
    }
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  }
  if ( byte_4871B1 )
  {
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    if ( config_player_count == 1 )
    {
      *(float *)&v172 = 300.0;
      v173 = 10.0;
      *(float *)&v16 = 10.0;
      *(float *)&v175 = 300.0;
    }
    else
    {
      *(float *)&v172 = 290.0;
      v173 = 4.0;
      *(float *)&v16 = 4.0;
      *(float *)&v175 = 290.0;
    }
    v176 = *(float *)&v16;
    v17 = 0;
    for ( render_overlay_player_index = 0; render_overlay_player_index < config_player_count; ++render_overlay_player_index )
    {
      v18 = weapon_ammo_class[31 * player_weapon_id[216 * v17]];
      if ( v18 == 1 )
      {
        v97 = aUiUiIndfireJaz;
        v19 = *(_DWORD *)grim_interface_ptr;
      }
      else if ( v18 )
      {
        if ( v18 == 2 )
          v97 = aUiUiIndrocketJ;
        else
          v97 = aUiUiIndelectri;
        v19 = *(_DWORD *)grim_interface_ptr;
      }
      else
      {
        v97 = aUiUiIndbulletJ;
        v19 = *(_DWORD *)grim_interface_ptr;
      }
      v20 = (*(int (__stdcall **)(char *, _DWORD))(v19 + 192))(v97, 0);
      (*(void (__thiscall **)(int, int))(v19 + 196))(grim_interface_ptr, v20);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v21 = (__int64)*(float *)&player_clip_size[216 * render_overlay_player_index];
      if ( v21 > 30 )
        v21 = 20;
      v22 = (__int64)*(float *)&player_ammo[216 * render_overlay_player_index];
      (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
        grim_interface_ptr,
        0,
        0,
        1065353216,
        1065353216);
      v23 = 0;
      if ( v21 > 0 )
      {
        v163 = 0;
        do
        {
          if ( v23 >= v22 )
            v124 = a1 * 0.30000001;
          else
            v124 = a1;
          (*(void (__stdcall **)(int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
            1065353216,
            1065353216,
            1065353216,
            COERCE_FLOAT(LODWORD(v124)));
          v24 = *(_DWORD *)grim_interface_ptr;
          v172 = 14 * render_overlay_player_index;
          v73 = (double)(14 * render_overlay_player_index) + v176;
          v62 = (double)v163 + *(float *)&v175;
          (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v24 + 284))(
            LODWORD(v62),
            LODWORD(v73),
            1086324736,
            1098907648);
          ++v23;
          v163 += 6;
        }
        while ( v23 < v21 );
      }
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      if ( v22 > v21 )
      {
        (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          COERCE_FLOAT(LODWORD(v168)));
        (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
          grim_interface_ptr,
          24,
          1056964608,
          v74,
          v98,
          v125);
        v172 = 6 * v23;
        v75 = (double)(14 * render_overlay_player_index) + v176 + 1.0;
        v63 = (double)(6 * v23) + *(float *)&v175 + 8.0;
        (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
          grim_interface_ptr,
          LODWORD(v63),
          LODWORD(v75),
          aD,
          v22 - v21);
      }
      v17 = render_overlay_player_index + 1;
    }
  }
  (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    COERCE_FLOAT(LODWORD(v168)));
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    v76,
    v99,
    v126);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v77,
    v100,
    v127);
  v25 = 78;
  v164 = 78;
  if ( !byte_4871B3 )
    goto LABEL_97;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    v78,
    v101,
    v128);
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_48F7C4, 0);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    COERCE_FLOAT(LODWORD(v168)));
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v165 = 0.0;
  if ( quest_spawn_timeline < 1000 )
  {
    v172 = 1000 - quest_spawn_timeline;
    v165 = (double)(1000 - quest_spawn_timeline) * -0.12800001;
  }
  v64 = v165 - 90.0;
  (*(void (__stdcall **)(_DWORD, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 284))(
    LODWORD(v64),
    1116078080,
    1127612416,
    1112801280,
    COERCE_FLOAT(LODWORD(v146)));
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    grim_interface_ptr,
    -1029701632,
    1121320960,
    1127612416,
    1112801280);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  v166 = a2 * 0.89999998;
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    LODWORD(v166));
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
    grim_interface_ptr,
    ui_clock_table_texture,
    0);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v26 = *(_DWORD *)grim_interface_ptr;
  v173 = v168 + 2.0;
  v27 = v173;
  (*(void (__thiscall **)(int, float, int, int, int))(v26 + 284))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v173)),
    1117519872,
    1107296256,
    1107296256);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v102,
    v129,
    v147);
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    LODWORD(v166));
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_48F7CC, 0);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v28 = *(_DWORD *)grim_interface_ptr;
  LODWORD(v173) = quest_spawn_timeline / 1000;
  v148 = (double)(quest_spawn_timeline / 1000) * 0.10471976;
  (*(void (__stdcall **)(_DWORD))(v28 + 252))(LODWORD(v148));
  (*(void (__thiscall **)(int, float, int, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v27)),
    1117519872,
    1107296256,
    1107296256);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v103,
    v130,
    v149);
  if ( quest_spawn_timeline / 1000 % 60 >= 10 )
    v104 = aDD_0;
  else
    v104 = aD0D;
  v65 = v168 + 32.0;
  (*(void (__cdecl **)(int, _DWORD, int, char *, int, int))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v65),
    1118568448,
    v104,
    quest_spawn_timeline / 1000 / 60,
    quest_spawn_timeline / 1000 % 60);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1055286886,
    v105,
    v131);
  (*(void (__cdecl **)(int, int, int, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    1099956224,
    1123287040,
    aProgress);
  if ( (byte_48F528 & 1) == 0 )
  {
    dword_4871A0 = 1045220557;
    byte_48F528 |= 1u;
    dword_4871A4 = 1061997773;
    dword_4871A8 = 1050253722;
    dword_4871AC = 1065353216;
    crt_atexit(nullsub_41);
  }
  v29 = quest_spawn_count;
  v30 = 0;
  dword_4902FC = 0;
  *(float *)&dword_4871AC = a1 * 0.80000001;
  if ( quest_spawn_count > 0 )
  {
    v31 = (int *)&unk_4857BC;
    do
    {
      v32 = *v31;
      v31 += 6;
      v30 += v32;
      --v29;
    }
    while ( v29 );
  }
  v172 = v30 + creature_spawned_count;
  *(float *)&v175 = 10.0;
  v176 = 139.0;
  flt_4902F8 = (double)creature_kill_count / (double)(v30 + creature_spawned_count);
  ui_draw_progress_bar((float *)&v175, 1116471296, flt_4902F8, (float *)&dword_4871A0);
  v25 = 158;
  v164 = 158;
  if ( dword_487244 < 500 )
  {
    v172 = 2 * dword_487244;
    v33 = (double)(2 * dword_487244) * 0.001;
    goto LABEL_73;
  }
  if ( dword_487244 < 1500 )
  {
LABEL_74:
    v152 = 1.0;
    goto LABEL_75;
  }
  if ( dword_487244 < 2000 )
  {
    v172 = 2 * dword_487244 - 3000;
    v33 = 1.0 - (double)v172 * 0.001;
LABEL_73:
    v152 = v33;
    if ( v152 <= 1.0 )
      goto LABEL_75;
    goto LABEL_74;
  }
  v152 = 0.0;
LABEL_75:
  v34 = *(_DWORD *)grim_interface_ptr;
  *(float *)&v169 = v152 * a1;
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(v34 + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    v169);
  if ( v152 >= 0.0 )
  {
    v157 = 0.80000001;
    *(float *)&v175 = COERCE_FLOAT(strlen((const char *)quest_meta_name[110 * *(_DWORD *)quest_stage_major
                                                                      - 121
                                                                      + 11 * quest_stage_minor]));
    if ( *(int *)config_screen_width <= 640 )
      v157 = 0.75;
    (*(void (__thiscall **)(int, int, float, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      COERCE_FLOAT(LODWORD(v157)),
      v78,
      v101,
      v128);
    v172 = *(_DWORD *)config_screen_width / 2;
    v35 = *(_DWORD *)grim_interface_ptr;
    v132 = quest_meta_name[110 * *(_DWORD *)quest_stage_major - 121 + 11 * quest_stage_minor];
    *(float *)&v172 = (double)(*(_DWORD *)config_screen_width / 2) - (double)v175 * v157 * 8.0;
    v175 = config_screen_height / 2 - 32;
    v106 = (float)v175;
    (*(void (__stdcall **)(int, _DWORD, int))(v35 + 316))(v172, LODWORD(v106), v132);
    v158 = v157 - 0.2;
    (*(void (__thiscall **)(int, int, float, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      COERCE_FLOAT(LODWORD(v158)),
      v79,
      v107,
      v133);
    v134 = *(float *)&v169 * 0.5;
    (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v134));
    v36 = quest_stage_minor;
    if ( quest_stage_minor > 10 )
    {
      v36 = quest_stage_minor - 10;
      ++*(_DWORD *)quest_stage_major;
      quest_stage_minor -= 10;
    }
    crt_sprintf(byte_48F788, "%d.%d", *(_DWORD *)quest_stage_major, v36);
    v37 = *(_DWORD *)grim_interface_ptr;
    v175 = config_screen_height / 2 - 32;
    v38 = v37;
    v108 = (double)v175 + v158 * 23.360001 - v158 * 16.0;
    v169 = strlen(byte_48F788);
    v80 = *(float *)&v172 - (double)v169 * v158 * 8.0 - v158 * 32.0 - 4.0;
    (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(v38 + 320))(
      grim_interface_ptr,
      LODWORD(v80),
      LODWORD(v108),
      byte_48F788);
  }
  if ( dword_487088 > 0 )
  {
    if ( dword_487088 >= 500 )
    {
      if ( dword_487088 < 1500 )
      {
        v153 = 1.0;
LABEL_96:
        (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
          grim_interface_ptr,
          24,
          1065353216,
          v78,
          v101,
          v128);
        v159 = (double)dword_487088 * 0.00039999999 * 0.13 + 0.95;
        v135 = v153 * a1;
        (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          LODWORD(v135));
        (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
          grim_interface_ptr,
          dword_48F7A0,
          0);
        (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
          grim_interface_ptr,
          0,
          0,
          1065353216,
          1065353216);
        v40 = *(_DWORD *)grim_interface_ptr;
        v136 = v159 * 32.0;
        v109 = v159 * 256.0;
        v81 = (double)(config_screen_height / 2) - v159 * 16.0;
        v175 = *(_DWORD *)config_screen_width / 2;
        v66 = (double)(*(_DWORD *)config_screen_width / 2) - v159 * 128.0;
        (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(v40 + 284))(
          LODWORD(v66),
          LODWORD(v81),
          LODWORD(v109),
          LODWORD(v136));
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
        goto LABEL_97;
      }
      if ( dword_487088 >= 2500 )
      {
LABEL_95:
        v153 = 0.0;
        goto LABEL_96;
      }
      v175 = 2000 - dword_487088;
      v39 = (double)(2000 - dword_487088) * 0.0020000001 + 1.0;
    }
    else
    {
      v39 = (double)dword_487088 * 0.0020000001;
    }
    v153 = v39;
    if ( v153 > 1.0 )
    {
      v153 = 1.0;
      goto LABEL_96;
    }
    if ( v153 >= 0.0 )
      goto LABEL_96;
    goto LABEL_95;
  }
LABEL_97:
  if ( byte_4871B4 )
  {
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      1,
      v78,
      v101,
      v128);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    v160 = a1 * 0.89999998;
    (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v160));
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      ui_clock_table_texture,
      0);
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
      grim_interface_ptr,
      1130102784,
      0x40000000,
      1107296256,
      1107296256);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      2,
      v82,
      v110,
      v137);
    (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v160));
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      dword_48F7CC,
      0);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v41 = *(_DWORD *)grim_interface_ptr;
    v175 = survival_elapsed_ms / 1000;
    v138 = (double)(survival_elapsed_ms / 1000) * 0.10471976;
    (*(void (__stdcall **)(_DWORD))(v41 + 252))(LODWORD(v138));
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
      grim_interface_ptr,
      1130102784,
      0x40000000,
      1107296256,
      1107296256);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      1056964608,
      v83,
      v111,
      v139);
    (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      COERCE_FLOAT(LODWORD(v168)));
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      1056964608,
      v84,
      v112,
      v140);
    (*(void (**)(int, int, int, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      1132396544,
      1092616192,
      aDSeconds,
      survival_elapsed_ms / 1000);
  }
  if ( byte_4871B2 )
  {
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      dword_48F7C4,
      0);
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      COERCE_FLOAT(LODWORD(v168)));
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v175 = v25 - 18;
    v85 = (float)(v25 - 18);
    (*(void (__stdcall **)(int, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
      -1031274496,
      LODWORD(v85),
      1127612416,
      1112801280);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    if ( player_experience )
    {
      if ( survival_xp_smoothed >= player_experience )
      {
        if ( survival_xp_smoothed <= player_experience )
          goto LABEL_116;
        v44 = frame_dt_ms / 2;
        if ( frame_dt_ms / 2 <= 0 )
          v44 = 1;
        v45 = abs32(survival_xp_smoothed - player_experience);
        if ( v45 > 1000 )
          v44 *= v45 / 100;
        survival_xp_smoothed -= v44;
        if ( survival_xp_smoothed >= player_experience )
          goto LABEL_116;
      }
      else
      {
        v42 = frame_dt_ms / 2;
        if ( frame_dt_ms / 2 <= 0 )
          v42 = 1;
        v43 = abs32(survival_xp_smoothed - player_experience);
        if ( v43 > 1000 )
          v42 *= v43 / 100;
        survival_xp_smoothed += v42;
        if ( survival_xp_smoothed <= player_experience )
          goto LABEL_116;
      }
      survival_xp_smoothed = player_experience;
    }
    else
    {
      survival_xp_smoothed = 0;
    }
LABEL_116:
    v141 = a1 * 0.89999998;
    (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v141));
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      1056964608,
      v86,
      v113,
      v142);
    v114 = (float)v164;
    (*(void (__cdecl **)(int, int, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      1082130432,
      LODWORD(v114),
      aXp);
    v46 = *(_DWORD *)grim_interface_ptr;
    v175 = v25 - 4;
    v87 = (float)(v25 - 4);
    (*(void (**)(int, int, _DWORD, char *, ...))(v46 + 328))(
      grim_interface_ptr,
      1104150528,
      LODWORD(v87),
      aD_0,
      survival_xp_smoothed);
    flt_496604 = a1;
    (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4965F8);
    v47 = *(_DWORD *)grim_interface_ptr;
    v175 = v25 + 1;
    v88 = (float)(v25 + 1);
    (*(void (**)(int, int, _DWORD, char *, ...))(v47 + 328))(
      grim_interface_ptr,
      1118437376,
      LODWORD(v88),
      aD_0,
      player_level);
    flt_496604 = 0.69999999;
    v175 = player_level - 1;
    v48 = 1000 - (__int64)(pow((double)(player_level - 1), 1.799999952316284) * -1000.0);
    if ( player_level == 1 )
      v48 = 0;
    v171 = a1 * 0.69999999;
    v169 = 0x3E99999A3DCCCCCDLL;
    v173 = (float)(v25 + 13);
    v170 = 1058642330;
    *(float *)&v172 = 26.0;
    v175 = 1000 - (__int64)(pow((double)player_level, 1.799999952316284) * -1000.0) - v48;
    v115 = (double)(player_experience - v48) / (double)v175;
    ui_draw_progress_bar((float *)&v172, 1113063424, v115, (float *)&v169);
    v164 = v25 + 43;
  }
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    v78,
    v101,
    v128);
  v49 = 0;
  *(float *)&v174 = (float)v164;
  do
    bonus_hud_slot_update_and_render(SLODWORD(a1), (float *)&v174, v49++, a1, v146);
  while ( v49 < 16 );
  v50 = (__int64)*(float *)&v174 + 1;
  v51 = 0;
  v167 = v50;
  render_overlay_player_index = 0;
  if ( config_player_count > 0 )
  {
    v52 = (__int64)*(float *)&v174 - 5;
    LODWORD(v169) = v52;
    do
    {
      if ( *(float *)&dword_4871D0[v51] > 0.0 )
      {
        v53 = *(float *)&dword_4871D0[v51];
        v55 = frame_dt;
        if ( v56 )
          v57 = v55 * 0.5;
        else
          v57 = v55 * 1.4;
        *(float *)&dword_4871D0[v51] = *(float *)&dword_4871D0[v51] - v57;
        if ( v53 > 1.0 )
          v53 = 2.0 - v53;
        if ( v53 < 0.0 )
          v53 = 0.0;
        v58 = *(_DWORD *)grim_interface_ptr;
        *(float *)&v172 = v53 * a1;
        v144 = *(float *)&v172 * 0.80000001;
        (*(void (__thiscall **)(int, int, int, int, _DWORD))(v58 + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          LODWORD(v144));
        (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
          grim_interface_ptr,
          dword_48F7C4,
          0);
        (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
        (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
          grim_interface_ptr,
          0,
          0,
          1065353216,
          1065353216);
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
        v175 = v52 - 12;
        v90 = (float)(v52 - 12);
        (*(void (__stdcall **)(int, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
          -1052770304,
          LODWORD(v90),
          1127612416,
          1112801280);
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
        (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
          grim_interface_ptr,
          ui_weapon_icons_texture,
          0);
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 264))(
          grim_interface_ptr,
          8,
          2,
          1,
          2 * effect_subrect_frame_table[31 * player_weapon_id[216 * render_overlay_player_index]]);
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
        v91 = (float)(int)v169;
        (*(void (__stdcall **)(int, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
          1121058816,
          LODWORD(v91),
          1114636288,
          1106247680);
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
        (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
          grim_interface_ptr,
          24,
          1056964608,
          v92,
          v117,
          v145);
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          v172);
        v118 = (float)v167;
        (*(void (__stdcall **)(int, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 324))(
          1090519040,
          LODWORD(v118),
          124 * player_weapon_id[216 * render_overlay_player_index] + 5077548);
        v51 = render_overlay_player_index;
        v50 += 32;
        v52 += 32;
        v167 = v50;
        LODWORD(v169) = v52;
      }
      render_overlay_player_index = ++v51;
    }
    while ( v51 < config_player_count );
  }
  result = (*(int (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
             grim_interface_ptr,
             21,
             2,
             v89,
             v116,
             v143);
  render_overlay_player_index = 0;
  return result;
}

// nullsub_41 @ 0x0041CA80
void __cdecl nullsub_41()
{
  ;
}

// hud_update_and_render @ 0x0041CA90
// updates HUD flags/targets and renders the HUD
char sub_41CA90()
{
  double v0; // st7
  double v1; // st7
  double v2; // st6
  char result; // al
  float v4; // [esp+Ch] [ebp-28h]
  float v5; // [esp+10h] [ebp-24h]
  int v6[3]; // [esp+14h] [ebp-20h] BYREF
  float v7; // [esp+20h] [ebp-14h]
  int v8[4]; // [esp+24h] [ebp-10h] BYREF

  v0 = (double)ui_elements_timeline / (double)(dword_48EB48 - dword_48EB4C);
  v5 = v0;
  if ( v0 <= 1.0 )
  {
    if ( v5 != 1.0 )
      goto LABEL_5;
  }
  else
  {
    v5 = 1.0;
  }
  byte_487241 = 0;
LABEL_5:
  if ( dword_487268 != -1 )
  {
    v1 = *(float *)&camera_offset_x + *((float *)&creature_pos_x + 38 * dword_487268);
    v7 = *(float *)&camera_offset_y + creature_pos_y[38 * dword_487268];
    v2 = *(float *)&creature_health[38 * dword_487268] / creature_max_health[38 * dword_487268];
    v4 = v2;
    if ( v2 <= 1.0 )
    {
      if ( v4 < 0.0 )
        v4 = 0.0;
    }
    else
    {
      v4 = 1.0;
    }
    v8[2] = 1045220557;
    v8[3] = 1060320051;
    *(float *)v8 = (1.0 - v4) * 0.89999998 + 0.1;
    *(float *)&v8[1] = v4 * 0.89999998 + 0.1;
    *(float *)v6 = v1 - 32.0;
    *(float *)&v6[1] = v7 + 32.0;
    ui_draw_progress_bar((float *)v6, 1115684864, v4, (float *)v8);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
  }
  if ( config_game_mode == 3 )
  {
    byte_4871B0 = 1;
    byte_4871B1 = 1;
    byte_4871B2 = 1;
    byte_4871B3 = 1;
  }
  else
  {
    switch ( config_game_mode )
    {
      case 1:
        byte_4871B0 = 1;
        byte_4871B1 = 1;
        byte_4871B2 = 1;
        break;
      case 2:
        byte_4871B0 = 1;
        byte_4871B1 = 0;
        byte_4871B2 = 0;
        byte_4871B3 = 0;
        byte_4871B4 = 1;
        goto LABEL_22;
      case 4:
        byte_4871B0 = 1;
        byte_4871B1 = 0;
        byte_4871B2 = 1;
        byte_4871B3 = 0;
        byte_4871B4 = 1;
        goto LABEL_22;
      default:
        byte_4871B0 = 0;
        byte_4871B1 = 0;
        byte_4871B2 = 0;
        break;
    }
    byte_4871B3 = 0;
  }
  byte_4871B4 = 0;
LABEL_22:
  result = demo_mode_active;
  if ( !demo_mode_active )
    return ui_render_hud(v5, v4);
  return result;
}

// dx_get_version @ 0x0041CCB0
// query DirectX version
int __cdecl sub_41CCB0(size_t *a1, char *Buffer, signed int BufferCount)
{
  size_t *v3; // ebx
  char *v4; // esi
  signed int v5; // ebp
  char v7; // al
  signed int v8; // edx
  int v9; // edi
  size_t v10; // ecx
  int v11; // [esp+10h] [ebp-4h] BYREF

  v3 = a1;
  if ( a1 )
    *a1 = 0;
  v4 = Buffer;
  v5 = BufferCount;
  if ( Buffer && BufferCount > 0 )
    *Buffer = 0;
  BufferCount = 0;
  v11 = 0;
  LOBYTE(Buffer) = 32;
  if ( (int)sub_41CDB0(&BufferCount, &v11, &Buffer) < 0 && (int)FUN_0041cfe0(&BufferCount, &v11, &Buffer) < 0 )
    return -2147467259;
  v7 = crt_tolower((char)Buffer);
  v8 = BufferCount;
  v9 = v11;
  LOBYTE(Buffer) = v7;
  if ( a1 )
  {
    v10 = (v11 + (BufferCount << 8)) << 8;
    if ( v7 >= 97 && v7 <= 122 )
    {
      v10 = v10 + v7 - 96;
      v3 = a1;
    }
    *v3 = v10;
  }
  if ( v4 && v5 > 0 )
  {
    if ( v7 == 32 )
    {
      crt_snprintf(v4, v5, "%d.%d", v8, v9);
      v4[v5 - 1] = 0;
      return 0;
    }
    crt_snprintf(v4, v5, "%d.%d%c", v8, v9, v7);
    v4[v5 - 1] = 0;
  }
  return 0;
}

// sub_41CDB0 @ 0x0041CDB0
int __usercall sub_41CDB0@<eax>(int a1@<esi>, LONG *a2, int a3, LONG *a4)
{
  bool v5; // [esp+43h] [ebp-39h]
  int v6; // [esp+44h] [ebp-38h] BYREF
  LPVOID ppv; // [esp+48h] [ebp-34h] BYREF
  int v8; // [esp+4Ch] [ebp-30h] BYREF
  CHAR MultiByteStr[12]; // [esp+50h] [ebp-2Ch] BYREF
  VARIANTARG pvarg; // [esp+5Ch] [ebp-20h] BYREF
  _DWORD v11[4]; // [esp+6Ch] [ebp-10h] BYREF

  ppv = 0;
  v5 = CoInitialize(0) >= 0;
  if ( CoCreateInstance(&rclsid, 0, 1u, &riid, &ppv) >= 0 )
  {
    v11[0] = 16;
    v11[1] = 111;
    v11[2] = 0;
    v11[3] = 0;
    if ( (*(int (__stdcall **)(LPVOID, _DWORD *))(*(_DWORD *)ppv + 12))(ppv, v11) < 0
      || (v8 = 0, v6 = 0, (*(int (__stdcall **)(LPVOID, int *))(*(_DWORD *)ppv + 16))(ppv, &v8) < 0) )
    {
      (*(void (__stdcall **)(LPVOID))(*(_DWORD *)ppv + 8))(ppv);
    }
    else if ( (*(int (__stdcall **)(int, wchar_t *, int *))(*(_DWORD *)v8 + 20))(v8, aDxdiagSystemin, &v6) < 0 )
    {
      (*(void (__stdcall **)(int))(*(_DWORD *)v8 + 8))(v8);
      (*(void (__stdcall **)(LPVOID))(*(_DWORD *)ppv + 8))(ppv);
    }
    else
    {
      VariantInit(&pvarg);
      if ( (*(int (__stdcall **)(int, wchar_t *, VARIANTARG *))(*(_DWORD *)v6 + 32))(v6, aDwdirectxversi, &pvarg) >= 0
        && pvarg.vt == 19
        && a2 )
      {
        *a2 = pvarg.lVal;
      }
      VariantClear(&pvarg);
      if ( (*(int (__stdcall **)(int, wchar_t *, VARIANTARG *, int))(*(_DWORD *)v6 + 32))(
             v6,
             aDwdirectxversi_0,
             &pvarg,
             a1) >= 0
        && pvarg.wReserved2 == 19 )
      {
        if ( a4 )
          *a4 = pvarg.cyVal.Hi;
        BYTE1(v6) = 1;
      }
      VariantClear((VARIANTARG *)&pvarg.decVal.Hi32);
      if ( (*(int (__stdcall **)(LPVOID, wchar_t *))(*(_DWORD *)ppv + 32))(ppv, aSzdirectxversi) >= 0 && pvarg.vt == 8 )
      {
        if ( pvarg.lVal )
        {
          WideCharToMultiByte(0, 0, pvarg.bstrVal, -1, MultiByteStr, 10, 0, 0);
          if ( a4 )
            *(_BYTE *)a4 = MultiByteStr[0];
        }
      }
      VariantClear(&pvarg);
      (*(void (__stdcall **)(int))(*(_DWORD *)v6 + 8))(v6);
      (*(void (__stdcall **)(int))(*(_DWORD *)v8 + 8))(v8);
      (*(void (__stdcall **)(LPVOID))(*(_DWORD *)ppv + 8))(ppv);
    }
  }
  if ( v5 )
    CoUninitialize();
  return -2147467259;
}

// FUN_0041cfe0 @ 0x0041CFE0
// [binja] int32_t sub_41cfe0(int32_t* arg1, int32_t* arg2, char* arg3)
int __cdecl sub_41CFE0(_DWORD *a1, _DWORD *a2, _BYTE *a3)
{
  int v3; // ebx
  __int64 v4; // rax
  _DWORD *v5; // esi
  _BYTE *v6; // edi
  __int64 v7; // rax
  __int64 v8; // rax
  __int64 v9; // rax
  __int64 v10; // rax
  _DWORD *v11; // esi
  _BYTE *v12; // edi
  __int64 v13; // rax
  __int64 v14; // rax
  __int64 v15; // rax
  __int64 v16; // rax
  __int64 v17; // rax
  unsigned int v18; // eax
  __int64 v19; // rax
  __int64 v20; // rax
  unsigned int v21; // eax
  __int64 v22; // rax
  __int64 v23; // rax
  _DWORD *v24; // esi
  _BYTE *v25; // edi
  __int64 v26; // rax
  __int64 v27; // rax
  __int64 v28; // rax
  unsigned int v29; // eax
  __int64 v30; // rax
  __int64 v31; // rax
  int v33; // [esp+8h] [ebp-408h] BYREF
  unsigned int v34; // [esp+Ch] [ebp-404h]
  CHAR tstrFilename[512]; // [esp+10h] [ebp-400h] BYREF
  CHAR Buffer[512]; // [esp+210h] [ebp-200h] BYREF

  v3 = 0;
  if ( !GetSystemDirectoryA(Buffer, 0x104u) )
    goto LABEL_160;
  Buffer[259] = 0;
  strcpy(tstrFilename, Buffer);
  strcat(tstrFilename, aDdrawDll);
  if ( FUN_0041db50(tstrFilename, &v33) >= 0 )
  {
    v4 = sub_41DC10(4, 2, 0, 95);
    if ( (int)sub_41DC50(v33, v34, v4, HIDWORD(v4)) < 0 )
    {
      v6 = a3;
      v5 = a2;
    }
    else
    {
      if ( a1 )
        *a1 = 1;
      v5 = a2;
      if ( a2 )
        *a2 = 0;
      v6 = a3;
      if ( a3 )
        *a3 = 32;
      v3 = 1;
    }
    v7 = sub_41DC10(4, 3, 0, 1096);
    if ( (int)sub_41DC50(v33, v34, v7, HIDWORD(v7)) >= 0 )
    {
      if ( a1 )
        *a1 = 2;
      if ( v5 )
        *v5 = 0;
      if ( v6 )
        *v6 = 32;
      v3 = 1;
    }
    v8 = sub_41DC10(4, 4, 0, 68);
    if ( (int)sub_41DC50(v33, v34, v8, HIDWORD(v8)) >= 0 )
    {
      if ( a1 )
        *a1 = 3;
      if ( v5 )
        *v5 = 0;
      if ( v6 )
        *v6 = 32;
      v3 = 1;
    }
  }
  strcpy(tstrFilename, Buffer);
  strcat(tstrFilename, aD3drg8xDll);
  if ( FUN_0041db50(tstrFilename, &v33) >= 0 )
  {
    v9 = sub_41DC10(4, 4, 0, 70);
    if ( (int)sub_41DC50(v33, v34, v9, HIDWORD(v9)) >= 0 )
    {
      if ( a1 )
        *a1 = 3;
      if ( a2 )
        *a2 = 0;
      if ( a3 )
        *a3 = 97;
      v3 = 1;
    }
  }
  strcpy(tstrFilename, Buffer);
  strcat(tstrFilename, aDdrawDll);
  if ( FUN_0041db50(tstrFilename, &v33) >= 0 )
  {
    v10 = sub_41DC10(4, 5, 0, 155);
    if ( (int)sub_41DC50(v33, v34, v10, HIDWORD(v10)) < 0 )
    {
      v12 = a3;
      v11 = a2;
    }
    else
    {
      if ( a1 )
        *a1 = 5;
      v11 = a2;
      if ( a2 )
        *a2 = 0;
      v12 = a3;
      if ( a3 )
        *a3 = 32;
      v3 = 1;
    }
    v13 = sub_41DC10(4, 6, 0, 318);
    if ( (int)sub_41DC50(v33, v34, v13, HIDWORD(v13)) >= 0 )
    {
      if ( a1 )
        *a1 = 6;
      if ( v11 )
        *v11 = 0;
      if ( v12 )
        *v12 = 32;
      v3 = 1;
    }
    v14 = sub_41DC10(4, 6, 0, 436);
    if ( (int)sub_41DC50(v33, v34, v14, HIDWORD(v14)) >= 0 )
    {
      if ( a1 )
        *a1 = 6;
      if ( v11 )
        *v11 = 1;
      if ( v12 )
        *v12 = 32;
      v3 = 1;
    }
  }
  strcpy(tstrFilename, Buffer);
  strcat(tstrFilename, aDplayxDll);
  if ( FUN_0041db50(tstrFilename, &v33) >= 0 )
  {
    v15 = sub_41DC10(4, 6, 3, 518);
    if ( (int)sub_41DC50(v33, v34, v15, HIDWORD(v15)) >= 0 )
    {
      if ( a1 )
        *a1 = 6;
      if ( a2 )
        *a2 = 1;
      if ( a3 )
        *a3 = 97;
      v3 = 1;
    }
  }
  strcpy(tstrFilename, Buffer);
  strcat(tstrFilename, aDdrawDll);
  if ( FUN_0041db50(tstrFilename, &v33) >= 0 )
  {
    v16 = sub_41DC10(4, 7, 0, 700);
    if ( (int)sub_41DC50(v33, v34, v16, HIDWORD(v16)) >= 0 )
    {
      if ( a1 )
        *a1 = 7;
      if ( a2 )
        *a2 = 0;
      if ( a3 )
        *a3 = 32;
      v3 = 1;
    }
  }
  strcpy(tstrFilename, Buffer);
  strcat(tstrFilename, aDinputDll);
  if ( FUN_0041db50(tstrFilename, &v33) >= 0 )
  {
    v17 = sub_41DC10(4, 7, 0, 716);
    if ( (int)sub_41DC50(v33, v34, v17, HIDWORD(v17)) >= 0 )
    {
      if ( a1 )
        *a1 = 7;
      if ( a2 )
        *a2 = 0;
      if ( a3 )
        *a3 = 97;
      v3 = 1;
    }
  }
  strcpy(tstrFilename, Buffer);
  strcat(tstrFilename, aDdrawDll);
  if ( FUN_0041db50(tstrFilename, &v33) >= 0 )
  {
    v18 = v34;
    if ( HIWORD(v34) == 4 )
    {
      v19 = sub_41DC10(4, 8, 0, 400);
      if ( (int)sub_41DC50(v33, v34, v19, HIDWORD(v19)) >= 0 )
      {
LABEL_96:
        if ( a1 )
          *a1 = 8;
        if ( a2 )
          *a2 = 0;
        if ( a3 )
          *a3 = 32;
        v3 = 1;
        goto LABEL_103;
      }
      v18 = v34;
    }
    if ( HIWORD(v18) != 5 )
      goto LABEL_103;
    v20 = sub_41DC10(5, 1, 2258, 400);
    if ( (int)sub_41DC50(v33, v34, v20, HIDWORD(v20)) < 0 )
      goto LABEL_103;
    goto LABEL_96;
  }
LABEL_103:
  strcpy(tstrFilename, Buffer);
  strcat(tstrFilename, aD3d8Dll_0);
  if ( FUN_0041db50(tstrFilename, &v33) < 0 )
    goto LABEL_130;
  v21 = v34;
  if ( HIWORD(v34) != 4 )
  {
LABEL_107:
    if ( HIWORD(v21) == 5 )
    {
      v23 = sub_41DC10(5, 1, 2600, 881);
      if ( (int)sub_41DC50(v33, v34, v23, HIDWORD(v23)) >= 0 )
        goto LABEL_109;
      v21 = v34;
    }
    v25 = a3;
    v24 = a2;
    goto LABEL_118;
  }
  v22 = sub_41DC10(4, 8, 1, 881);
  if ( (int)sub_41DC50(v33, v34, v22, HIDWORD(v22)) < 0 )
  {
    v21 = v34;
    goto LABEL_107;
  }
LABEL_109:
  if ( a1 )
    *a1 = 8;
  v24 = a2;
  if ( a2 )
    *a2 = 1;
  v25 = a3;
  if ( a3 )
    *a3 = 32;
  v21 = v34;
  v3 = 1;
LABEL_118:
  if ( HIWORD(v21) != 4 )
  {
LABEL_121:
    if ( HIWORD(v21) != 5 )
      goto LABEL_130;
    v27 = sub_41DC10(5, 1, 2600, 901);
    if ( (int)sub_41DC50(v33, v34, v27, HIDWORD(v27)) < 0 )
      goto LABEL_130;
    goto LABEL_123;
  }
  v26 = sub_41DC10(4, 8, 1, 901);
  if ( (int)sub_41DC50(v33, v34, v26, HIDWORD(v26)) < 0 )
  {
    v21 = v34;
    goto LABEL_121;
  }
LABEL_123:
  if ( a1 )
    *a1 = 8;
  if ( v24 )
    *v24 = 1;
  if ( v25 )
    *v25 = 97;
  v3 = 1;
LABEL_130:
  strcpy(tstrFilename, Buffer);
  strcat(tstrFilename, aMpg2spltAx);
  if ( FUN_0041db50(tstrFilename, &v33) >= 0 )
  {
    v28 = sub_41DC10(6, 3, 1, 885);
    if ( (int)sub_41DC50(v33, v34, v28, HIDWORD(v28)) >= 0 )
    {
      if ( a1 )
        *a1 = 8;
      if ( a2 )
        *a2 = 1;
      if ( a3 )
        *a3 = 98;
      v3 = 1;
    }
  }
  strcpy(tstrFilename, Buffer);
  strcat(tstrFilename, aDpnetDll);
  if ( FUN_0041db50(tstrFilename, &v33) >= 0 )
  {
    v29 = v34;
    if ( HIWORD(v34) == 4 )
    {
      v30 = sub_41DC10(4, 9, 0, 134);
      if ( (int)sub_41DC50(v33, v34, v30, HIDWORD(v30)) >= 0 )
      {
LABEL_145:
        if ( a1 )
          *a1 = 8;
        if ( a2 )
          *a2 = 2;
        if ( a3 )
          *a3 = 32;
        v3 = 1;
        goto LABEL_152;
      }
      v29 = v34;
    }
    if ( HIWORD(v29) != 5 )
      goto LABEL_152;
    v31 = sub_41DC10(5, 2, 3677, 134);
    if ( (int)sub_41DC50(v33, v34, v31, HIDWORD(v31)) < 0 )
      goto LABEL_152;
    goto LABEL_145;
  }
LABEL_152:
  strcpy(tstrFilename, Buffer);
  strcat(tstrFilename, aD3d9Dll);
  if ( FUN_0041db50(tstrFilename, &v33) < 0 )
  {
    if ( v3 )
      return 0;
LABEL_160:
    if ( a1 )
      *a1 = 0;
    if ( a2 )
      *a2 = 0;
    if ( a3 )
      *a3 = 32;
    return 0;
  }
  if ( a1 )
    *a1 = 9;
  if ( a2 )
    *a2 = 0;
  if ( a3 )
  {
    *a3 = 32;
    return 0;
  }
  return 0;
}

// FUN_0041db50 @ 0x0041DB50
// [binja] int32_t sub_41db50(uint32_t arg1, int32_t* arg2)
int __cdecl sub_41DB50(LPCSTR lptstrFilename, _DWORD *lpBuffer)
{
  const CHAR *v2; // edi
  _DWORD *v3; // ebx
  const CHAR *FileVersionInfoSizeA; // eax
  void *v5; // eax
  void *v6; // esi
  _DWORD *v8; // eax
  DWORD dwHandle; // [esp+Ch] [ebp-4h] BYREF

  v2 = lptstrFilename;
  if ( !lptstrFilename )
    return -2147024809;
  v3 = lpBuffer;
  if ( !lpBuffer )
    return -2147024809;
  FileVersionInfoSizeA = (const CHAR *)GetFileVersionInfoSizeA(lptstrFilename, &dwHandle);
  lptstrFilename = FileVersionInfoSizeA;
  if ( FileVersionInfoSizeA )
  {
    v5 = operator new((unsigned int)FileVersionInfoSizeA);
    v6 = v5;
    if ( !v5 )
      return -2147024882;
    if ( GetFileVersionInfoA(v2, 0, (DWORD)lptstrFilename, v5) )
    {
      lpBuffer = 0;
      if ( VerQueryValueA(v6, SubBlock, (LPVOID *)&lpBuffer, (PUINT)&lptstrFilename) )
      {
        v8 = lpBuffer;
        if ( lpBuffer )
        {
          v3[1] = lpBuffer[2];
          *v3 = v8[3];
          crt_free(v6);
          return 0;
        }
      }
    }
    crt_free(v6);
  }
  return -2147467259;
}

// sub_41DC10 @ 0x0041DC10
int __cdecl sub_41DC10(int a1, int a2, unsigned __int16 a3, unsigned __int16 a4)
{
  return a4 | (a3 << 16);
}

// sub_41DC50 @ 0x0041DC50
int __cdecl sub_41DC50(unsigned int a1, unsigned int a2, unsigned int a3, unsigned int a4)
{
  if ( a2 > a4 )
    return 1;
  if ( a2 < a4 )
    return -1;
  if ( a1 <= a3 )
    return -(a1 < a3);
  return 1;
}

// grim_load_interface @ 0x0041DC80
// load grim DLL and fetch GRIM_GetInterface
HMODULE __cdecl sub_41DC80(LPCSTR lpLibFileName)
{
  HMODULE result; // eax
  int (*GRIM__GetInterface)(void); // edx

  result = LoadLibraryA(lpLibFileName);
  dword_490304 = (int)result;
  if ( result )
  {
    GRIM__GetInterface = GetProcAddress(result, aGrimGetinterfa);
    strcpy(byte_490308, lpLibFileName);
    if ( GRIM__GetInterface )
      return (HMODULE)GRIM__GetInterface();
    else
      return 0;
  }
  return result;
}

// vorbis_mem_read @ 0x0041DCE0
// ov_open_callbacks read hook for memory-backed OGG data
unsigned int __cdecl sub_41DCE0(void *a1, int a2, int a3, int a4)
{
  int v4; // esi
  unsigned int v5; // eax
  unsigned int result; // eax

  if ( *(_DWORD *)(a4 - 4) >= *(_DWORD *)(a4 - 8) )
    *(_DWORD *)(a4 - 4) = 0;
  v4 = *(_DWORD *)(a4 - 4);
  v5 = *(_DWORD *)(a4 - 8);
  if ( v5 >= a3 * a2 + v4 )
    result = a3 * a2;
  else
    result = v5 - v4;
  qmemcpy(a1, (const void *)(a4 + v4), result);
  *(_DWORD *)(a4 - 4) += a3 * a2;
  return result;
}

// sub_41DD40 @ 0x0041DD40
int __cdecl sub_41DD40(int a1, int a2, int a3, int a4)
{
  int v5; // edx

  if ( a4 )
  {
    if ( a4 == 2 )
      v5 = *(_DWORD *)(a1 - 8) - a2;
    else
      v5 = a2 + *(_DWORD *)(a1 - 4);
    *(_DWORD *)(a1 - 4) = v5;
    return 1;
  }
  else
  {
    *(_DWORD *)(a1 - 4) = a2;
    return 1;
  }
}

// sub_41DD90 @ 0x0041DD90
int sub_41DD90()
{
  return 1;
}

// vorbis_mem_tell @ 0x0041DDA0
// ov_open_callbacks tell hook (returns current offset)
int __cdecl sub_41DDA0(int a1)
{
  return *(_DWORD *)(a1 - 4);
}

// vorbis_pcm_seek @ 0x0041DDB0
// wrapper around ov_pcm_seek for memory stream
int __thiscall sub_41DDB0(char *this, int a2)
{
  return ov_pcm_seek(this + 16, a2, 0);
}

// vorbis_mem_open @ 0x0041DDD0
// open OGG/Vorbis data from a memory buffer (sets callbacks)
char __thiscall sub_41DDD0(
        unsigned int (__cdecl **this)(void *a1, int a2, int a3, int a4),
        unsigned int (__cdecl *a2)(void *a1, int a2, int a3, int a4),
        int a3)
{
  __int64 v5; // rax

  *this = vorbis_mem_read;
  *(this + 1) = (unsigned int (__cdecl *)(void *, int, int, int))sub_41DD40;
  *(this + 2) = (unsigned int (__cdecl *)(void *, int, int, int))sub_41DD90;
  *(this + 3) = (unsigned int (__cdecl *)(void *, int, int, int))vorbis_mem_tell;
  *(this + 184) = 0;
  *(this + 187) = a2;
  *(_DWORD *)a2 = a3;
  *((_DWORD *)*(this + 187) + 1) = 0;
  if ( ov_open_callbacks((char *)*(this + 187) + 8, this + 4, 0, 0, *this, *(this + 1), *(this + 2), *(this + 3)) >= 0 )
  {
    qmemcpy(this + 188, (const void *)ov_info(this + 4, -1), 0x20u);
    v5 = 16 * ov_pcm_total(this + 4, -1) * (int)*(this + 189) / 8;
    HIDWORD(v5) = *(this + 187);
    *(this + 185) = (unsigned int (__cdecl *)(void *, int, int, int))v5;
    *(this + 186) = (unsigned int (__cdecl *)(void *, int, int, int))vorbis_mem_tell(HIDWORD(v5) + 8);
    return 1;
  }
  else
  {
    sub_461FD5(aInputDoesNotAp);
    return 0;
  }
}

// vorbis_mem_close @ 0x0041DEE0
// frees memory buffer and ov_clear
int __thiscall sub_41DEE0(LPVOID *this)
{
  crt_free(*(this + 187));
  return ov_clear(this + 4);
}

// vorbis_read_pcm16 @ 0x0041DF00
// decode PCM16 samples via ov_read
int __thiscall sub_41DF00(char *this, int a2, int a3)
{
  int result; // eax

  result = ov_read(this + 16, a2, a3, 0, 2, 1, this + 736);
  if ( result )
    return result < 0 ? 0 : result;
  return result;
}

// sub_41DF50 @ 0x0041DF50
int sub_41DF50()
{
  return 2400000;
}

// game_sequence_get @ 0x0041DF60
// returns the saved game_sequence_id
int __cdecl sub_41DF60()
{
  return *(_DWORD *)&game_sequence_id;
}

// nullsub_108 @ 0x0041E0C0
void nullsub_108()
{
  ;
}

// sub_41E120 @ 0x0041E120
int sub_41E120()
{
  dword_49100C = 1;
  dword_491008 = 0;
  dword_491004 = 0;
  dword_491000 = 0;
  return 0;
}

// sub_41E150 @ 0x0041E150
void sub_41E150()
{
  dword_4AA4D0 = 0;
  dword_4AA4D4 = 0;
}

// sub_41E180 @ 0x0041E180
void sub_41E180()
{
  dword_490F78 = 0;
  dword_490F7C = 0;
}

// sub_41E1B0 @ 0x0041E1B0
int *sub_41E1B0()
{
  int *result; // eax
  int *v1; // ebx
  int v2; // [esp+10h] [ebp-1Ch]

  result = &fx_queue_pos_x;
  v2 = 128;
  do
  {
    v1 = result + 4;
    *result = 0;
    *(result - 2) = 0;
    result[4] = 1065353216;
    *(result - 1) = 0;
    result[1] = 0;
    result[5] = 1065353216;
    result[2] = 0;
    result[3] = 0;
    result[6] = 1065353216;
    result += 10;
    v1[3] = 1065353216;
    --v2;
  }
  while ( v2 );
  return result;
}

// nullsub_109 @ 0x0041E260
void nullsub_109()
{
  ;
}

// FUN_0041e270 @ 0x0041E270
// [binja] int32_t sub_41e270(float* arg1, float* arg2)
int __cdecl sub_41E270(float *a1, float *a2)
{
  *a1 = *a1 + *a2;
  a1[1] = a2[1] + a1[1];
  return 0;
}

// player_apply_move_with_spawn_avoidance @ 0x0041E290
// applies movement delta (scaled by alternate-weapon perk) and resolves collisions with creature spawn slots
int __cdecl sub_41E290(int a1, float *a2, float *a3)
{
  float *v3; // ebx
  int *v4; // edi
  float *v5; // edx
  double v6; // st6
  double v7; // st4
  double v9; // st7
  unsigned __int8 v10; // c0
  unsigned __int8 v11; // c3
  double v12; // st5
  double v13; // st3
  double v14; // st7
  double v15; // st3
  float v17; // [esp+18h] [ebp+4h]

  v3 = (float *)((char *)&unk_4908B0 + 864 * a1);
  if ( perk_count_get(perk_id_alternate_weapon) )
  {
    *a3 = *a3 * 0.80000001;
    a3[1] = a3[1] * 0.80000001;
  }
  v4 = creature_spawn_slot_owner;
  *a2 = *a2 + *a3;
  a2[1] = a3[1] + a2[1];
  do
  {
    v5 = (float *)*v4;
    if ( *v4 )
    {
      v17 = (v5[13] + v3[13]) * 0.33333334;
      v6 = v5[6] - a2[1];
      v7 = v5[5] - *a2;
      if ( sqrt(v6 * v6 + v7 * v7) <= v17 )
      {
        *a2 = *a2 - *a3;
        a2[1] = a2[1] - a3[1];
        v9 = *a2 + *a3;
        if ( v10 | v11 )
        {
          *a2 = v9;
          a2[1] = a3[1] + a2[1];
        }
        else
        {
          *a2 = v9;
          v12 = v5[6] - a2[1];
          v13 = v5[5] - v9;
          if ( sqrt(v12 * v12 + v13 * v13) <= v17 )
          {
            *a2 = v9 - *a3;
            v14 = a3[1] + a2[1];
            a2[1] = v14;
            v15 = v5[5] - *a2;
            if ( sqrt((v5[6] - v14) * (v5[6] - v14) + v15 * v15) <= v17 )
              a2[1] = v14 - a3[1];
          }
        }
      }
    }
    v4 += 6;
  }
  while ( (int)v4 < (int)&SubKey );
  return 0;
}

// vec2_add_inplace @ 0x0041E400
// adds delta XY into pos; unused param_1 in decompile
int __cdecl sub_41E400(int a1, float *a2, float *a3)
{
  *a2 = *a2 + *a3;
  a2[1] = a3[1] + a2[1];
  return 0;
}

// sub_41E430 @ 0x0041E430
void sub_41E430()
{
  dword_490418 = 0;
  dword_49041C = 0;
}

// sub_41E460 @ 0x0041E460
_DWORD *sub_41E460()
{
  _DWORD *result; // eax
  int v1; // ecx

  result = &secondary_proj_speed;
  v1 = 64;
  do
  {
    *((_BYTE *)result - 8) = 0;
    result[5] = 1;
    *result = 0;
    result[6] = 0;
    result[8] = -100;
    result += 11;
    --v1;
  }
  while ( v1 );
  return result;
}

// sub_41E4A0 @ 0x0041E4A0
char *sub_41E4A0()
{
  char *result; // eax
  int v1; // ebx
  _DWORD *v2; // ebp

  result = &sprite_effect_pool;
  v1 = 384;
  do
  {
    v2 = result + 4;
    *result = 0;
    result += 44;
    --v1;
    *v2 = 1065353216;
    v2[1] = 1065353216;
    v2[2] = 1065353216;
    v2[3] = 1065353216;
  }
  while ( v1 );
  return result;
}

// sub_41E520 @ 0x0041E520
int sub_41E520()
{
  int *v0; // esi
  int *v1; // eax
  int v2; // eax
  int v3; // edx
  int result; // eax
  int v5; // [esp+10h] [ebp-18h]

  v0 = &particle_intensity;
  v5 = 128;
  do
  {
    v1 = v0 - 4;
    *((_BYTE *)v0 + 12) = 0;
    *((_BYTE *)v0 - 36) = 0;
    *v1 = 1065353216;
    *v0 = 1065353216;
    v1[1] = 1065353216;
    v1[2] = 1065353216;
    v1[3] = 1065353216;
    v2 = crt_rand();
    *((_BYTE *)v0 - 35) = 1;
    v3 = v2 % 628;
    v0[4] = -1;
    v0 += 14;
    result = v5 - 1;
    v5 = result;
    *((float *)v0 - 12) = (double)v3 * 0.0099999998;
  }
  while ( result );
  return result;
}

// sub_41E5D0 @ 0x0041E5D0
_DWORD *sub_41E5D0()
{
  _DWORD *result; // eax
  int v1; // ebx

  result = &unk_4908B4;
  v1 = 2;
  do
  {
    result[28] = 0;
    *result = 0;
    result[13] = 0;
    *((_BYTE *)result - 4) = 0;
    result[35] = 0;
    *((_BYTE *)result + 4) = 0;
    result[36] = 0;
    *((_BYTE *)result + 5) = 0;
    result[2] = 0;
    result[29] = -1;
    result[200] = -1082130432;
    result[198] = 0;
    result[195] = 0;
    result[39] = 0;
    result[40] = 0;
    result[41] = 0;
    result[201] = -1082130432;
    result[194] = -1;
    result[199] = 0;
    result[37] = 0;
    result[38] = 0;
    *((_BYTE *)result + 708) = 0;
    result[197] = 0;
    result[192] = 0;
    result[42] = 0;
    result[44] = 1;
    result[180] = 0;
    result[189] = 0;
    result[176] = 1106247680;
    result[190] = 0;
    result += 216;
    --v1;
  }
  while ( v1 );
  return result;
}

// sub_41E6D0 @ 0x0041E6D0
int *sub_41E6D0()
{
  int *result; // eax
  int v1; // edx

  result = &creature_phase_seed;
  v1 = 385;
  do
  {
    result[28] = 0;
    *result = 0;
    result[13] = 0;
    *((_BYTE *)result - 4) = 0;
    result[35] = 0;
    *((_BYTE *)result + 4) = 0;
    result[36] = 0;
    *((_BYTE *)result + 5) = 0;
    result[2] = 0;
    result[29] = -1;
    result += 38;
    --v1;
  }
  while ( v1 );
  return result;
}

// nullsub_110 @ 0x0041E720
void nullsub_110()
{
  ;
}

// nullsub_111 @ 0x0041E740
void nullsub_111()
{
  ;
}

// sub_41E760 @ 0x0041E760
_DWORD *sub_41E760()
{
  _DWORD *result; // eax
  int v1; // esi

  result = &projectile_type_id;
  v1 = 96;
  do
  {
    result[7] = -1;
    *((_BYTE *)result - 32) = 0;
    *result = 1;
    result[3] = 1065353216;
    result[5] = 0;
    result[6] = 1065353216;
    result += 16;
    --v1;
  }
  while ( v1 );
  return result;
}

// nullsub_112 @ 0x0041E7B0
void nullsub_112()
{
  ;
}

// nullsub_113 @ 0x0041E7D0
void nullsub_113()
{
  ;
}

// nullsub_114 @ 0x0041E7F0
void nullsub_114()
{
  ;
}

// nullsub_115 @ 0x0041E810
void nullsub_115()
{
  ;
}

// nullsub_116 @ 0x0041E830
void nullsub_116()
{
  ;
}

// fx_queue_add @ 0x0041E840
// pushes a quad entry into DAT_004aaf18 (capped at 0x80); returns 1 on success
char __cdecl sub_41E840(int a1, int *a2, int a3, int a4, int a5, _DWORD *a6)
{
  int v6; // eax
  int v7; // ecx
  _DWORD *v8; // edx
  int v9; // esi

  v6 = 10 * fx_queue_count;
  v7 = fx_queue_count + 1;
  fx_queue_pos_x[v6] = *a2;
  fx_queue_pos_y[v6] = a2[1];
  v8 = (_DWORD *)((char *)&fx_queue_color_r + v6 * 4);
  *v8 = *a6;
  v8[1] = a6[1];
  v8[2] = a6[2];
  v9 = a6[3];
  fx_queue_count = v7;
  v8[3] = v9;
  fx_queue_width[v6] = a3;
  fx_queue_height[v6] = a4;
  fx_queue_rotation[v6] = a5;
  fx_queue[v6] = a1;
  if ( v7 < 128 )
    return 1;
  fx_queue_count = 127;
  return 0;
}

// sub_41E8D0 @ 0x0041E8D0
bool sub_41E8D0()
{
  return (*(int (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 164))(grim_interface_ptr, 0) == dword_4804FC;
}

// sub_41E8F0 @ 0x0041E8F0
bool sub_41E8F0()
{
  return (*(int (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 164))(grim_interface_ptr, 0) == dword_4804F8;
}

// creature_handle_death @ 0x0041E910
// death handler: bonus spawns, split-on-death, score, and cleanup
void __cdecl sub_41E910(int a1, char a2)
{
  const void *v2; // ebx
  int v3; // eax
  int v4; // ebp
  int v5; // ebp
  int v6; // edi
  float v7; // [esp+0h] [ebp-10h]
  float v8; // [esp+0h] [ebp-10h]

  v2 = (const void *)(152 * a1 + 4833080);
  if ( (creature_flags[38 * a1] & 0x400) != 0 )
    bonus_spawn_at(152 * a1 + 4833100, SLOWORD(creature_link_index[38 * a1]), SHIWORD(creature_link_index[38 * a1]));
  v3 = survival_recent_death_count;
  if ( survival_recent_death_count < 6 )
  {
    if ( survival_recent_death_count < 3 )
    {
      LODWORD(survival_recent_death_pos_x[2 * survival_recent_death_count]) = *(&creature_pos_x + 38 * a1);
      survival_recent_death_pos_y[2 * survival_recent_death_count] = LODWORD(creature_pos_y[38 * a1]);
      v3 = survival_recent_death_count;
    }
    survival_recent_death_count = v3 + 1;
    if ( v3 == 2 )
    {
      survival_reward_fire_seen = 0;
      survival_reward_handout_enabled = 0;
    }
  }
  if ( creature_pool[152 * a1] )
  {
    if ( (creature_flags[38 * a1] & 4) != 0 )
      creature_spawn_slot_owner[6 * creature_link_index[38 * a1]] = 0;
    if ( (creature_flags[38 * a1] & 8) != 0 && *(&creature_size + 38 * a1) > 35.0 )
    {
      v4 = 152 * creature_alloc_slot();
      qmemcpy(&creature_pool[v4], v2, 0x98u);
      creature_phase_seed[v4 / 4u] = (unsigned __int8)crt_rand();
      *(float *)(v4 + 4833124) = *(&creature_heading + 38 * a1) - 1.5707964;
      *(float *)(v4 + 4833116) = creature_max_health[38 * a1] * 0.25;
      *(float *)(v4 + 4833180) = *(float *)(v4 + 4833180) * 0.66666669;
      *(float *)(v4 + 4833132) = *(float *)(v4 + 4833132) - 8.0;
      *(float *)(v4 + 4833172) = *(float *)(v4 + 4833172) + 0.1;
      *(float *)(v4 + 4833168) = *(float *)(v4 + 4833168) * 0.69999999;
      creature_hitbox_size[v4 / 4u] = 1098907648;
      v5 = 152 * creature_alloc_slot();
      qmemcpy(&creature_pool[v5], v2, 0x98u);
      creature_phase_seed[v5 / 4u] = (unsigned __int8)crt_rand();
      *(float *)(v5 + 4833124) = *(&creature_heading + 38 * a1) + 1.5707964;
      *(float *)(v5 + 4833116) = creature_max_health[38 * a1] * 0.25;
      *(float *)(v5 + 4833132) = *(float *)(v5 + 4833132) - 8.0;
      *(float *)(v5 + 4833172) = *(float *)(v5 + 4833172) + 0.1;
      *(float *)(v5 + 4833180) = *(float *)(v5 + 4833180) * 0.66666669;
      creature_hitbox_size[v5 / 4u] = 1098907648;
      *(float *)(v5 + 4833168) = *(float *)(v5 + 4833168) * 0.69999999;
      effect_spawn_burst(152 * a1 + 4833100, 8);
    }
    if ( a2 )
      *(float *)&creature_hitbox_size[38 * a1] = *(float *)&creature_hitbox_size[38 * a1] - frame_dt;
    else
      creature_pool[152 * a1] = 0;
    if ( (int)*(&player_perk_counts + perk_id_bloody_mess_quick_learner) <= 0 )
      player_experience = (__int64)((double)player_experience + creature_reward_value[38 * a1]);
    else
      player_experience += (__int64)(creature_reward_value[38 * a1] * 1.3);
    if ( bonus_double_xp_timer > 0.0 )
    {
      if ( (int)*(&player_perk_counts + perk_id_bloody_mess_quick_learner) <= 0 )
        player_experience = (__int64)((double)player_experience + creature_reward_value[38 * a1]);
      else
        player_experience += (__int64)(creature_reward_value[38 * a1] * 1.3);
    }
    if ( !bonus_spawn_guard )
      bonus_try_spawn_on_kill(152 * a1 + 4833100);
    if ( bonus_freeze_timer > 0.0 )
    {
      v6 = 8;
      do
      {
        v7 = (double)(crt_rand() % 612) * 0.0099999998;
        effect_spawn_freeze_shard(152 * a1 + 4833100, v7);
        --v6;
      }
      while ( v6 );
      v8 = (double)(crt_rand() % 612) * 0.0099999998;
      effect_spawn_freeze_shatter(152 * a1 + 4833100, v8);
      ++creature_kill_count;
      creature_pool[152 * a1] = 0;
      fx_queue_add_random(152 * a1 + 4833100);
    }
  }
}

// config_sync_from_grim @ 0x0041EC60
// syncs Grim config values into config blob and writes crimson.cfg
char sub_41EC60()
{
  int v0; // eax
  int v1; // edx
  int *v2; // ebp
  char *v3; // eax
  FILE *v4; // eax
  FILE *v5; // ebp
  char *v6; // eax
  FILE *v7; // eax
  FILE *v8; // esi
  char *v10; // [esp+30h] [ebp-494h]
  _DWORD v11[4]; // [esp+34h] [ebp-490h] BYREF
  _BYTE Buffer[4]; // [esp+44h] [ebp-480h] BYREF
  __int16 v13; // [esp+48h] [ebp-47Ch]
  char v14; // [esp+52h] [ebp-472h]
  char v15; // [esp+53h] [ebp-471h]
  char v16; // [esp+54h] [ebp-470h]
  char v17; // [esp+55h] [ebp-46Fh]
  int v18; // [esp+58h] [ebp-46Ch]
  int v19; // [esp+5Ch] [ebp-468h]
  int v20; // [esp+60h] [ebp-464h]
  int v21; // [esp+64h] [ebp-460h]
  int v22; // [esp+88h] [ebp-43Ch]
  int v23; // [esp+8Ch] [ebp-438h]
  int v24; // [esp+B0h] [ebp-414h]
  int v25; // [esp+B4h] [ebp-410h]
  _DWORD v26[2]; // [esp+B8h] [ebp-40Ch] BYREF
  char v27; // [esp+C0h] [ebp-404h]
  int v28; // [esp+C4h] [ebp-400h]
  int v29; // [esp+C8h] [ebp-3FCh]
  char v30; // [esp+CCh] [ebp-3F8h] BYREF
  char v31; // [esp+ECh] [ebp-3D8h] BYREF
  _DWORD v32[17]; // [esp+1C4h] [ebp-300h] BYREF
  int v33; // [esp+208h] [ebp-2BCh]
  int v34; // [esp+20Ch] [ebp-2B8h]
  int v35; // [esp+210h] [ebp-2B4h]
  int v36; // [esp+214h] [ebp-2B0h]
  int v37; // [esp+218h] [ebp-2ACh]
  int v38; // [esp+21Ch] [ebp-2A8h]
  int v39; // [esp+220h] [ebp-2A4h]
  int v40; // [esp+224h] [ebp-2A0h]
  int v41; // [esp+228h] [ebp-29Ch]
  int v42; // [esp+22Ch] [ebp-298h]
  int v43; // [esp+230h] [ebp-294h]
  int v44; // [esp+234h] [ebp-290h]
  int v45; // [esp+238h] [ebp-28Ch]
  int v46; // [esp+23Ch] [ebp-288h]
  int v47; // [esp+240h] [ebp-284h]
  int v48; // [esp+244h] [ebp-280h]
  int v49; // [esp+248h] [ebp-27Ch]
  int v50; // [esp+24Ch] [ebp-278h]
  int v51; // [esp+250h] [ebp-274h]
  int v52; // [esp+254h] [ebp-270h]
  int v53; // [esp+258h] [ebp-26Ch]
  int v54; // [esp+25Ch] [ebp-268h]
  int v55; // [esp+260h] [ebp-264h]
  int v56; // [esp+264h] [ebp-260h]
  int v57; // [esp+268h] [ebp-25Ch]
  int v58; // [esp+26Ch] [ebp-258h]
  int v59; // [esp+270h] [ebp-254h]
  int v60; // [esp+274h] [ebp-250h]
  int v61; // [esp+278h] [ebp-24Ch]
  int v62; // [esp+27Ch] [ebp-248h]
  int v63; // [esp+280h] [ebp-244h]
  int v64; // [esp+284h] [ebp-240h]
  int v65; // [esp+288h] [ebp-23Ch]
  int v66; // [esp+48Ch] [ebp-38h]
  int v67; // [esp+490h] [ebp-34h]
  int v68; // [esp+494h] [ebp-30h]
  char v69; // [esp+4A4h] [ebp-20h]
  int v70; // [esp+4A8h] [ebp-1Ch]
  int v71; // [esp+4ACh] [ebp-18h]
  char v72; // [esp+4B0h] [ebp-14h]
  char v73; // [esp+4B1h] [ebp-13h]
  char v74; // [esp+4B2h] [ebp-12h]
  int v75; // [esp+4B4h] [ebp-10h]
  int v76; // [esp+4B8h] [ebp-Ch]
  int v77; // [esp+4BCh] [ebp-8h]
  int v78; // [esp+4C0h] [ebp-4h]

  config_windowed = *(_BYTE *)(*(int (__thiscall **)(int, _DWORD *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                                grim_interface_ptr,
                                v11,
                                8);
  config_display_bpp = *(_DWORD *)(*(int (__thiscall **)(int, _DWORD *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                                    grim_interface_ptr,
                                    v11,
                                    43);
  *(_DWORD *)config_screen_width = *(_DWORD *)(*(int (__thiscall **)(int, _DWORD *, int))(*(_DWORD *)grim_interface_ptr
                                                                                        + 36))(
                                                grim_interface_ptr,
                                                v11,
                                                41);
  config_screen_height = *(_DWORD *)(*(int (__thiscall **)(int, _DWORD *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                                      grim_interface_ptr,
                                      v11,
                                      42);
  *(_DWORD *)config_texture_scale = *(_DWORD *)(*(int (__thiscall **)(int, _DWORD *, int))(*(_DWORD *)grim_interface_ptr
                                                                                         + 36))(
                                                 grim_interface_ptr,
                                                 v11,
                                                 89);
  byte_4807B6 = *(_BYTE *)(*(int (__thiscall **)(int, _DWORD *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                            grim_interface_ptr,
                            v11,
                            84);
  v0 = player_name_length;
  strcpy(config_player_name, highscore_active_record);
  config_player_name_length = v0;
  if ( grim_config_invoked )
  {
    v26[0] = 0;
    LOWORD(v66) = 256;
    v26[1] = 0;
    v67 = 0;
    v76 = 1056964608;
    v68 = 1;
    v77 = 257;
    v78 = 258;
    v74 = 0;
    v25 = 1065353216;
    v73 = 0;
    v27 = 0;
    v1 = 0;
    v10 = &v31;
    v2 = (int *)&v30;
    do
    {
      *v2++ = v1;
      strcpy(v10, aDefault);
      ++v1;
      v10 += 27;
    }
    while ( v1 < 8 );
    Buffer[3] = 0;
    Buffer[2] = 0;
    memset(v32, 0, 0x20u);
    strcpy((char *)v32, default_player_name);
    v29 = 1;
    v69 = 1;
    v32[14] = 32;
    v19 = 1;
    v14 = 1;
    v16 = 1;
    v17 = 1;
    v18 = 1;
    v37 = 32;
    v28 = 0;
    v75 = 5;
    Buffer[0] = 0;
    Buffer[1] = 0;
    v72 = 0;
    v32[10] = 0;
    v32[11] = 0;
    v32[12] = 9000;
    v32[13] = 27000;
    v32[9] = 100;
    v24 = 0;
    v32[15] = 800;
    v32[16] = 600;
    LOBYTE(v33) = 0;
    v15 = 0;
    v20 = 2;
    v21 = 2;
    v22 = 0;
    v23 = 0;
    v70 = 1065353216;
    v71 = 1065353216;
    v34 = 17;
    v35 = 31;
    v36 = 30;
    v38 = 256;
    v39 = 382;
    v40 = 382;
    v41 = 16;
    v42 = 18;
    v43 = 319;
    v44 = 320;
    v45 = 321;
    v46 = 339;
    v47 = 382;
    v48 = 382;
    v49 = 382;
    v50 = 200;
    v51 = 208;
    v52 = 203;
    v53 = 205;
    v54 = 157;
    v55 = 382;
    v56 = 382;
    v57 = 211;
    v58 = 209;
    v59 = 319;
    v60 = 320;
    v61 = 321;
    v62 = 339;
    v63 = 382;
    v64 = 382;
    v65 = 382;
    v13 = 257;
    v3 = game_build_path(config_filename);
    v4 = crt_fopen(v3, file_mode_read_binary);
    v5 = v4;
    if ( v4 )
    {
      crt_fseek(v4, 0, 2);
      if ( crt_ftell(v5) == 1152 )
      {
        crt_fseek(v5, 0, 0);
        crt_fread(Buffer, 0x480u, 1u, v5);
        config_fx_toggle = v72;
        strcpy((char *)&config_player_name_buf, (const char *)v26);
      }
      crt_fclose(v5);
    }
  }
  v6 = game_build_path(config_filename);
  v7 = crt_fopen(v6, file_mode_write_binary);
  v8 = v7;
  if ( v7 )
  {
    crt_fwrite(config_blob, 0x480u, 1u, v7);
    crt_fclose(v8);
  }
  return 1;
}

// config_ensure_file @ 0x0041F130
// creates crimson.cfg when missing (writes default config blob)
FILE *sub_41F130()
{
  char *v0; // eax
  FILE *v1; // eax
  FILE *result; // eax
  char *v3; // eax
  FILE *v4; // esi

  v0 = game_build_path(config_filename);
  v1 = crt_fopen(v0, file_mode_read_binary);
  if ( v1 )
    return (FILE *)crt_fclose(v1);
  config_fx_toggle = 1;
  v3 = game_build_path(config_filename);
  result = crt_fopen(v3, file_mode_write_binary);
  v4 = result;
  if ( result )
  {
    crt_fwrite(config_blob, 0x480u, 1u, result);
    return (FILE *)crt_fclose(v4);
  }
  return result;
}

// config_load_presets @ 0x0041F1A0
// loads config presets into globals
char __cdecl sub_41F1A0(char a1)
{
  char *v1; // eax
  FILE *v2; // eax
  FILE *v3; // esi
  int *v5; // ecx
  int *v6; // eax
  int v7; // edx
  int v8; // [esp-8h] [ebp-18h]
  int v9; // [esp-8h] [ebp-18h]
  int v10; // [esp-8h] [ebp-18h]
  int v11; // [esp-4h] [ebp-14h]
  int v12; // [esp-4h] [ebp-14h]
  int v13; // [esp-4h] [ebp-14h]
  int v14; // [esp-4h] [ebp-14h]
  int v15; // [esp-4h] [ebp-14h]
  int v16; // [esp-4h] [ebp-14h]
  int v17; // [esp-4h] [ebp-14h]
  int v18; // [esp+0h] [ebp-10h]
  int v19; // [esp+0h] [ebp-10h]
  int v20; // [esp+0h] [ebp-10h]
  int v21; // [esp+0h] [ebp-10h]
  int v22; // [esp+0h] [ebp-10h]
  int v23; // [esp+0h] [ebp-10h]
  int v24; // [esp+0h] [ebp-10h]
  int v25; // [esp+4h] [ebp-Ch]
  int v26; // [esp+4h] [ebp-Ch]
  int v27; // [esp+4h] [ebp-Ch]
  int v28; // [esp+4h] [ebp-Ch]
  int v29; // [esp+4h] [ebp-Ch]
  int v30; // [esp+4h] [ebp-Ch]
  int v31; // [esp+4h] [ebp-Ch]

  player_move_key_forward = 17;
  player_move_key_backward = 31;
  player_turn_key_left = 30;
  player_turn_key_right = 32;
  player_fire_key = 15;
  player_key_reserved_0 = 17;
  player_key_reserved_1 = 31;
  player_aim_key_left = 16;
  player_aim_key_right = 18;
  player_alt_move_key_forward = 200;
  player_alt_move_key_backward = 208;
  player_alt_turn_key_left = 203;
  player_alt_turn_key_right = 205;
  player_alt_fire_key = 157;
  player_alt_key_reserved_0 = 17;
  player_alt_key_reserved_1 = 31;
  player_alt_key_reserved_2 = 211;
  player_alt_key_reserved_3 = 201;
  v1 = game_build_path(config_filename);
  v2 = crt_fopen(v1, file_mode_read_binary);
  v3 = v2;
  if ( !v2 )
    return 0;
  crt_fseek(v2, 0, 2);
  if ( crt_ftell(v3) == 1152 )
  {
    crt_fseek(v3, 0, 0);
    crt_fread(config_blob, 0x480u, 1u, v3);
    crt_fclose(v3);
    v5 = &player_move_key_backward;
    v6 = &config_p1_axis_move_x;
    do
    {
      v7 = *(v6 - 12);
      v6 += 16;
      *(v5 - 1) = v7;
      *v5 = *(v6 - 27);
      v5[1] = *(v6 - 26);
      v5[2] = *(v6 - 25);
      v5[3] = *(v6 - 24);
      v5[4] = *(v6 - 23);
      v5[5] = *(v6 - 22);
      v5[6] = *(v6 - 21);
      v5[7] = *(v6 - 20);
      v5[9] = *(v6 - 19);
      v5[8] = *(v6 - 18);
      v5[11] = *(v6 - 17);
      v5[10] = *(v6 - 16);
      v5 += 216;
    }
    while ( (int)v6 < (int)dword_4805C0 );
    (*(void (__thiscall **)(int, int, _DWORD, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      89,
      *(_DWORD *)config_texture_scale,
      v11,
      v18,
      v25);
    if ( !a1 )
    {
      LOBYTE(v8) = byte_4807B6;
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        84,
        v8,
        v12,
        v19,
        v26);
      LOBYTE(v9) = config_windowed;
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        8,
        v9,
        v13,
        v20,
        v27);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        43,
        config_display_bpp,
        v14,
        v21,
        v28);
      (*(void (__thiscall **)(int, int, _DWORD, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        41,
        *(_DWORD *)config_screen_width,
        v15,
        v22,
        v29);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        42,
        config_screen_height,
        v16,
        v23,
        v30);
      LOBYTE(v10) = config_blob[0];
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        83,
        v10,
        v17,
        v24,
        v31);
    }
    strcpy(highscore_active_record, config_player_name);
    player_name_length = config_player_name_length;
    BYTE2(config_blob[0]) = 0;
    config_name_slot_selected = 0;
    return 1;
  }
  else
  {
    crt_fclose(v3);
    config_sync_from_grim();
    return 0;
  }
}

// angle_approach @ 0x0041F430
// wraps angle into [0,2pi] and steps toward target using shortest arc
double __cdecl sub_41F430(float *a1, float a2, float a3)
{
  double v4; // st7
  double v5; // st7
  double v6; // st7
  double v7; // st6
  double result; // st7
  unsigned __int8 v10; // c0
  unsigned __int8 v11; // c3
  double v12; // st6
  float v13; // [esp+0h] [ebp-4h]
  int v14; // [esp+0h] [ebp-4h]
  float v15; // [esp+8h] [ebp+4h]
  int v16; // [esp+8h] [ebp+4h]

  if ( *a1 < 0.0 )
  {
    do
    {
      v4 = *a1 + 6.2831855;
      *a1 = v4;
    }
    while ( v4 < 0.0 );
  }
  if ( *a1 > 6.2831855 )
  {
    do
    {
      v5 = *a1 - 6.2831855;
      *a1 = v5;
    }
    while ( v5 > 6.2831855 );
  }
  v15 = a2 - *a1;
  v6 = *a1;
  v16 = LODWORD(v15) & 0x7FFFFFFF;
  if ( a2 > v6 )
    v6 = a2;
  v7 = *a1;
  if ( a2 < v7 )
    v7 = a2;
  v13 = 6.2831855 - v6 + v7;
  v14 = LODWORD(v13) & 0x7FFFFFFF;
  if ( *(float *)&v16 >= (double)*(float *)&v14 )
    result = *(float *)&v14;
  else
    result = *(float *)&v16;
  if ( result > 1.0 )
    result = 1.0;
  if ( v10 | v11 )
  {
    v12 = frame_dt * result * a3;
    if ( a2 > (double)*a1 )
    {
      *a1 = v12 + *a1;
      return result;
    }
  }
  else
  {
    v12 = frame_dt * result * a3;
    if ( a2 < (double)*a1 )
    {
      *a1 = v12 + *a1;
      return result;
    }
  }
  *a1 = *a1 - v12;
  return result;
}

// sub_41F570 @ 0x0041F570
void sub_41F570()
{
  bonus_pool_sentinel = 0;
}

// bonus_alloc_slot @ 0x0041F580
// returns a free bonus slot in DAT_00482948 (or DAT_00490630 sentinel)
int *sub_41F580()
{
  int v0; // ecx
  int *v1; // eax

  v0 = 0;
  v1 = &bonus_pool;
  while ( *v1 )
  {
    v1 += 7;
    ++v0;
    if ( (int)v1 >= (int)&quest_spawn_count )
      return &bonus_pool_sentinel;
  }
  return (int *)(28 * v0 + 4729160);
}

// bonus_spawn_at @ 0x0041F5B0
// clamps position, fills bonus entry fields, and spawns pickup effect
int *__cdecl sub_41F5B0(float *a1, int a2, int a3)
{
  double v3; // st7
  double v4; // st7
  int *v6; // esi
  int v7; // ebx

  if ( *a1 < 32.0 )
    *a1 = 32.0;
  if ( a1[1] < 32.0 )
    a1[1] = 32.0;
  v3 = (double)(terrain_texture_width - 32);
  if ( v3 < *a1 )
    *a1 = v3;
  v4 = (double)(terrain_texture_height - 32);
  if ( v4 < a1[1] )
    a1[1] = v4;
  if ( config_game_mode == 2 )
    return &bonus_pool_sentinel;
  v6 = bonus_alloc_slot();
  *((_BYTE *)v6 + 4) = 0;
  v6[4] = *(_DWORD *)a1;
  v6[5] = *((_DWORD *)a1 + 1);
  v6[2] = 1092616192;
  v6[3] = 1092616192;
  *v6 = a2;
  v6[6] = a3;
  if ( a3 == -1 )
    v6[6] = bonus_meta_default_amount[5 * a2];
  effect_template_color_r = 1053609165;
  effect_template_flags = 29;
  effect_template_color_g = 1056964608;
  effect_template_color_b = 1065353216;
  effect_template_color_a = 1056964608;
  effect_template_lifetime = 1056964608;
  effect_template_half_width = 1107296256;
  effect_template_half_height = 1107296256;
  v7 = 16;
  do
  {
    *(float *)&effect_template_rotation = (double)(crt_rand() & 0x7F) * 0.049087387;
    *(float *)&effect_template_vel_x = (float)(crt_rand() % 128 - 64);
    *(float *)&effect_template_vel_y = (float)(crt_rand() % 128 - 64);
    *(float *)&effect_template_scale_step = (double)(crt_rand() % 100) * 0.0099999998 + 0.1;
    effect_spawn(0, a1);
    --v7;
  }
  while ( v7 );
  return v6;
}

// bonus_spawn_at_pos @ 0x0041F790
// allocates a bonus slot near pos, enforces spacing/edges, picks bonus type + amount
int *__cdecl sub_41F790(float *a1)
{
  int *v1; // esi
  int *v2; // ecx
  double v3; // st6
  double v4; // st5
  int v5; // eax

  if ( *a1 < 32.0
    || (double)(terrain_texture_width - 32) < *a1
    || a1[1] < 32.0
    || (double)(terrain_texture_height - 32) < a1[1]
    || config_game_mode == 2 )
  {
    return &bonus_pool_sentinel;
  }
  v1 = bonus_alloc_slot();
  v2 = &bonus_pool;
  while ( 1 )
  {
    if ( *v2 )
    {
      v3 = a1[1] - *((float *)v2 + 5);
      v4 = *a1 - *((float *)v2 + 4);
      if ( sqrt(v4 * v4 + v3 * v3) < 32.0 )
        break;
    }
    v2 += 7;
    if ( (int)v2 >= (int)&quest_spawn_count )
      goto LABEL_12;
  }
  v1 = &bonus_pool_sentinel;
LABEL_12:
  *((_BYTE *)v1 + 4) = 0;
  v1[4] = *(_DWORD *)a1;
  v1[5] = *((_DWORD *)a1 + 1);
  v1[2] = 1092616192;
  v1[3] = 1092616192;
  v5 = bonus_pick_random_type();
  *v1 = v5;
  if ( v5 == 3 )
  {
    v1[6] = weapon_pick_random_available();
    return v1;
  }
  if ( *v1 == 1 )
  {
    v1[6] = 500;
    if ( (crt_rand() & 7u) <= 2 )
    {
      v1[6] = 1000;
      return v1;
    }
  }
  else
  {
    v1[6] = bonus_meta_default_amount[5 * *v1];
  }
  return v1;
}

// bonus_try_spawn_on_kill @ 0x0041F8D0
// decides whether to drop a bonus on kill (mode/perk rules) and spawns pickup burst
int __cdecl sub_41F8D0(float *a1)
{
  int result; // eax
  float *v2; // edi
  int *v3; // esi
  int v4; // edx
  int v5; // eax
  int v6; // et2
  double v7; // st6
  double v8; // st5
  int v9; // edx
  int v10; // esi

  result = config_game_mode;
  if ( config_game_mode == 4 || demo_mode_active || config_game_mode == 2 || config_game_mode == 8 )
    return result;
  if ( (player_weapon_id[0] == 1 || player2_weapon_id == 1 && config_player_count == 2) && (crt_rand() & 3) != 3 )
  {
    v2 = a1;
    v3 = bonus_spawn_at_pos(a1);
    *v3 = 3;
    result = weapon_pick_random_available();
    v3[6] = result;
    if ( result == 1 )
    {
      result = weapon_pick_random_available();
      v3[6] = result;
    }
    v4 = 0;
    if ( *v3 != 1 )
    {
      result = (int)&bonus_pool;
      do
      {
        if ( *(_DWORD *)result == *v3 )
          ++v4;
        result += 28;
      }
      while ( result < (int)&quest_spawn_count );
      if ( v4 >= 2 )
        goto LABEL_19;
    }
    if ( v3[6] == 1 || (result = perk_count_get(perk_id_my_favourite_weapon)) != 0 )
    {
LABEL_19:
      *v3 = 0;
      return result;
    }
LABEL_36:
    if ( v3 && v3 != &bonus_pool_sentinel )
    {
      effect_template_color_r = 1053609165;
      effect_template_flags = 29;
      effect_template_color_g = 1056964608;
      effect_template_color_b = 1065353216;
      effect_template_color_a = 1056964608;
      effect_template_lifetime = 1056964608;
      effect_template_half_width = 1107296256;
      effect_template_half_height = 1107296256;
      v10 = 16;
      do
      {
        *(float *)&effect_template_rotation = (double)(crt_rand() & 0x7F) * 0.049087387;
        *(float *)&effect_template_vel_x = (float)(crt_rand() % 128 - 64);
        *(float *)&effect_template_vel_y = (float)(crt_rand() % 128 - 64);
        *(float *)&effect_template_scale_step = (double)(crt_rand() % 100) * 0.0099999998 + 0.1;
        result = effect_spawn(0, v2);
        --v10;
      }
      while ( v10 );
    }
    return result;
  }
  if ( crt_rand() % 9 == 1
    || player_weapon_id[0] == 1 && crt_rand() % 5 == 1
    || (result = perk_count_get(perk_id_bonus_magnet)) != 0
    && (v5 = crt_rand(), v6 = v5 % 10, result = v5 / 10, v6 == 2) )
  {
    v2 = a1;
    v3 = bonus_spawn_at_pos(a1);
    if ( *v3 == 3 )
    {
      v7 = a1[1] - *(float *)player_pos_y;
      v8 = *a1 - *(float *)player_pos_x;
      if ( sqrt(v8 * v8 + v7 * v7) < 56.0 )
      {
        *v3 = 1;
        v3[6] = 100;
      }
    }
    v9 = 0;
    if ( *v3 != 1 )
    {
      result = (int)&bonus_pool;
      do
      {
        if ( *(_DWORD *)result == *v3 )
          ++v9;
        result += 28;
      }
      while ( result < (int)&quest_spawn_count );
      if ( v9 >= 2 )
        goto LABEL_35;
    }
    result = player_weapon_id[0];
    if ( v3[6] == player_weapon_id[0] )
    {
LABEL_35:
      *v3 = 0;
      return result;
    }
    goto LABEL_36;
  }
  return result;
}

// fx_spawn_sprite @ 0x0041FBB0
// spawns a sprite effect entry in DAT_00496820
int __cdecl sub_41FBB0(int *a1, int *a2, int a3)
{
  int v3; // edi
  char *v4; // eax
  int v5; // esi
  int v6; // edx

  v3 = 0;
  v4 = sprite_effect_pool;
  while ( *v4 )
  {
    v4 += 44;
    ++v3;
    if ( (int)v4 >= (int)byte_49AA20 )
    {
      v3 = crt_rand() % 384;
      break;
    }
  }
  v5 = 11 * v3;
  sprite_effect_pool[v5 * 4] = 1;
  sprite_effect_color_b[v5] = 1065353216;
  sprite_effect_color_g[v5] = 1065353216;
  sprite_effect_color_r[v5] = 1065353216;
  sprite_effect_color_a[v5] = 1065353216;
  sprite_effect_pos_x[v5] = *a1;
  sprite_effect_pos_y[v5] = a1[1];
  sprite_effect_vel_x[v5] = *a2;
  sprite_effect_vel_y[v5] = a2[1];
  sprite_effect_scale[v5] = a3;
  v6 = crt_rand() % 628;
  *(float *)(v5 * 4 + 4810804) = (double)v6 * 0.0099999998;
  return v3;
}

// weapon_table_entry @ 0x0041FC60
// returns the entry base (&DAT_004d7a2c + weapon_id * 0x1f)
int __cdecl sub_41FC60(int a1)
{
  return 124 * a1 + 5077548;
}

// FUN_0041fc80 @ 0x0041FC80
// [binja] void* sub_41fc80()
char *sub_41FC80()
{
  int v0; // esi
  int v1; // eax
  double v2; // st7
  double v3; // st7
  int v4; // esi
  double v5; // st7
  int v6; // eax
  int v7; // ecx
  char *result; // eax
  int v9; // [esp+4h] [ebp-20h]
  int v10; // [esp+8h] [ebp-1Ch]
  float v11; // [esp+14h] [ebp-10h]
  float v12; // [esp+1Ch] [ebp-8h]

  if ( *(float *)(dword_480864 + 12) != 0.0 )
    console_printf((int)&console_log_queue, aResetingPlayer);
  v0 = 0;
  render_overlay_player_index = 0;
  do
  {
    dword_4AAF30 = 0;
    v1 = 216 * v0;
    *(float *)&v9 = (double)terrain_texture_width * 0.5;
    v2 = (double)terrain_texture_height;
    player_speed_bonus_timer[v1] = 0;
    player_shield_timer[v1] = 0;
    player_state_aux[v1] = 0;
    player_plaguebearer_active[v1 * 4] = 0;
    player_pos_x[v1] = v9;
    *(float *)&v10 = v2 * 0.5;
    player_pos_y[v1] = v10;
    player_health[v1] = 1120403456;
    v3 = (double)(80 * v0);
    if ( v0 % 2 )
    {
      v12 = v3;
      *(float *)&player_pos_x[216 * v0] = *(float *)&player_pos_x[216 * v0] - v12;
      *(float *)&player_pos_y[216 * v0] = *(float *)&player_pos_y[216 * v0] - v3;
    }
    else
    {
      v11 = v3;
      *(float *)&player_pos_x[216 * v0] = v11 + *(float *)&player_pos_x[216 * v0];
      *(float *)&player_pos_y[216 * v0] = v3 + *(float *)&player_pos_y[216 * v0];
    }
    v4 = render_overlay_player_index;
    v5 = (double)dword_4D7AEC;
    v6 = 216 * render_overlay_player_index;
    player_size[v6] = 1111490560;
    player_speed_multiplier[v6] = 0x40000000;
    player_level[v6] = 1;
    player_heading[v6] = 0;
    player_experience[v6] = 0;
    dword_490960[v6] = 0;
    player_spread_heat[v6] = 0;
    player_move_speed[v6] = 0;
    player_ammo[v6] = 1092616192;
    player_clip_size[v6] = 1092616192;
    player_reload_timer_max[v6] = 1065353216;
    player_reload_timer[v6] = 0;
    player_alt_weapon_id[v6] = 1;
    *(float *)(v6 * 4 + 4787088) = v5;
    player_alt_reload_active[v6 * 4] = 0;
    player_alt_ammo[v6] = player_alt_clip_size[v6];
    v7 = dword_4D7AF4;
    player_alt_reload_timer[v6] = 0;
    player_alt_shot_cooldown[v6] = 0;
    player_alt_reload_timer_max[v6] = v7;
    LOBYTE(v7) = demo_mode_active;
    player_shot_cooldown[v6] = 1061997773;
    player_weapon_id[v6] = 1;
    dword_490BA8[v6] = 0;
    player_death_timer[v6] = 16.0;
    if ( !(_BYTE)v7 )
    {
      ui_mouse_x = 320.0;
      ui_mouse_y = 140.0;
    }
    memset((char *)&player_perk_counts + v6 * 4, 0, 0x200u);
    result = &creature_collision_flag;
    do
    {
      *result = 0;
      result += 152;
    }
    while ( (int)result < (int)byte_4AA341 );
    v0 = v4 + 1;
    render_overlay_player_index = v0;
  }
  while ( v0 < 2 );
  render_overlay_player_index = 0;
  return result;
}

// effect_uv_tables_init @ 0x0041FED0
// precomputes UV grids for 2x2, 4x4, 8x8, 16x16 effect atlases
int *sub_41FED0()
{
  float *v0; // eax
  double v1; // st7
  int v2; // esi
  int *v3; // edx
  int v4; // ecx
  int *v5; // eax
  double v6; // st6
  int v7; // esi
  int *v8; // edx
  int v9; // ecx
  int *v10; // eax
  double v11; // st6
  int v12; // esi
  int *v13; // edx
  int v14; // ecx
  int *v15; // eax
  double v16; // st6
  int v17; // esi
  int *v18; // edx
  int v19; // ecx
  int *result; // eax
  double v21; // st6
  int v22; // [esp+4h] [ebp-8h]
  int v23; // [esp+4h] [ebp-8h]
  int v24; // [esp+4h] [ebp-8h]
  int v25; // [esp+4h] [ebp-8h]
  int v26; // [esp+4h] [ebp-8h]
  int v27; // [esp+8h] [ebp-4h]
  int v28; // [esp+8h] [ebp-4h]
  int v29; // [esp+8h] [ebp-4h]
  int v30; // [esp+8h] [ebp-4h]

  v22 = 0;
  v0 = (float *)&unk_490F84;
  do
  {
    v0 += 2;
    v1 = (double)v22++ * 0.0625;
    *(v0 - 3) = v1;
    *(v0 - 2) = 0.0;
  }
  while ( (int)v0 < (int)&dword_491004 );
  v2 = 0;
  v3 = &effect_uv2_v;
  v27 = 0;
  do
  {
    v4 = 0;
    v5 = v3;
    v23 = 0;
    v3 += 4;
    do
    {
      v6 = (double)v23;
      v5 += 2;
      v23 = ++v4;
      *((float *)v5 - 3) = v6 * 0.5;
      *((float *)v5 - 2) = (double)v27 * 0.5;
    }
    while ( v4 < 2 );
    v27 = ++v2;
  }
  while ( v2 < 2 );
  v7 = 0;
  v8 = &effect_uv4_v;
  v28 = 0;
  do
  {
    v9 = 0;
    v10 = v8;
    v24 = 0;
    v8 += 8;
    do
    {
      v11 = (double)v24;
      v10 += 2;
      v24 = ++v9;
      *((float *)v10 - 3) = v11 * 0.25;
      *((float *)v10 - 2) = (double)v28 * 0.25;
    }
    while ( v9 < 4 );
    v28 = ++v7;
  }
  while ( v7 < 4 );
  v12 = 0;
  v13 = &effect_uv8_v;
  v29 = 0;
  do
  {
    v14 = 0;
    v15 = v13;
    v25 = 0;
    v13 += 16;
    do
    {
      v16 = (double)v25;
      v15 += 2;
      v25 = ++v14;
      *((float *)v15 - 3) = v16 * 0.125;
      *((float *)v15 - 2) = (double)v29 * 0.125;
    }
    while ( v14 < 8 );
    v29 = ++v12;
  }
  while ( v12 < 8 );
  v17 = 0;
  v18 = &effect_uv16_v;
  v30 = 0;
  do
  {
    v19 = 0;
    result = v18;
    v26 = 0;
    v18 += 32;
    do
    {
      v21 = (double)v26;
      result += 2;
      v26 = ++v19;
      *((float *)result - 3) = v21 * 0.0625;
      *((float *)result - 2) = (double)v30 * 0.0625;
    }
    while ( v19 < 16 );
    v30 = ++v17;
  }
  while ( v17 < 16 );
  return result;
}

// creature_find_nearest @ 0x00420040
// returns nearest creature index; uses hitbox-size sentinel when exclude_id == -1
int __cdecl sub_420040(float *a1, int a2, float a3)
{
  long double v3; // st7
  int v4; // ebx
  int v6; // edx
  char *v7; // ecx
  double v8; // st5
  double v9; // st4
  long double v10; // st6
  int v13; // edx
  char *v14; // ecx
  double v15; // st5
  double v16; // st3
  long double v17; // st6
  float v18; // [esp+10h] [ebp+4h]
  int v19; // [esp+10h] [ebp+4h]

  v3 = 1000000.0;
  v4 = 0;
  if ( a2 == -1 )
  {
    v6 = 0;
    v7 = creature_pool;
    do
    {
      if ( *v7 && *((_DWORD *)v7 + 4) == 1098907648 )
      {
        v8 = a1[1] - *((float *)v7 + 6);
        v9 = *a1 - *((float *)v7 + 5);
        v10 = sqrt(v9 * v9 + v8 * v8);
        if ( v10 < v3 )
        {
          v18 = v10;
          v3 = v18;
          v4 = v6;
        }
      }
      v7 += 152;
      ++v6;
    }
    while ( (int)v7 < (int)byte_4AA338 );
    return v4;
  }
  else
  {
    v13 = 0;
    v14 = creature_pool;
    do
    {
      if ( *v14 )
      {
        if ( v13 != a2 )
        {
          v15 = a1[1] - *((float *)v14 + 6);
          v16 = *a1 - *((float *)v14 + 5);
          v17 = sqrt(v15 * v15 + v16 * v16);
          *(float *)&v19 = v17;
          if ( v17 > a3 && *(float *)&v19 < v3 )
          {
            v3 = *(float *)&v19;
            v4 = v13;
          }
        }
      }
      v14 += 152;
      ++v13;
    }
    while ( (int)v14 < (int)byte_4AA338 );
    return v4;
  }
}

// fx_spawn_particle @ 0x00420130
// spawns a fast particle entry in DAT_00493eb8
int __cdecl sub_420130(int *a1, int a2, int a3, int a4)
{
  char *v4; // eax
  int v5; // edi
  int v6; // esi
  _DWORD *v7; // ecx
  int v8; // edx

  v4 = particle_pool;
  v5 = 0;
  while ( *v4 )
  {
    v4 += 56;
    ++v5;
    if ( (int)v4 >= (int)&dword_495AB8 )
    {
      v5 = crt_rand() % 128;
      break;
    }
  }
  v6 = 56 * v5;
  particle_pool[v6] = 1;
  particle_pos_x[v6 / 4u] = *a1;
  particle_pos_y[v6 / 4u] = a1[1];
  v7 = (_DWORD *)((char *)&particle_scale_x + 56 * v5);
  *(float *)(v6 + 4800196) = cos(*(float *)&a2) * 90.0;
  *(float *)(v6 + 4800200) = sin(*(float *)&a2) * 90.0;
  particle_intensity[v6 / 4u] = a4;
  *v7 = 1065353216;
  v7[1] = 1065353216;
  v7[2] = 1065353216;
  v7[3] = 0;
  particle_angle[v6 / 4u] = a2;
  v8 = crt_rand() % 628;
  *(float *)(v6 + 4800228) = (double)v8 * 0.0099999998;
  byte_493EB9[v6] = 1;
  particle_style_id[v6] = 0;
  return v5;
}

// fx_spawn_particle_slow @ 0x00420240
// spawns a slow particle entry in DAT_00493eb8
int __cdecl sub_420240(int *a1, int a2)
{
  char *v2; // eax
  int v3; // edi
  int v4; // esi
  _DWORD *v5; // eax
  int v6; // edx

  v2 = particle_pool;
  v3 = 0;
  while ( *v2 )
  {
    v2 += 56;
    ++v3;
    if ( (int)v2 >= (int)&dword_495AB8 )
    {
      v3 = crt_rand() % 128;
      break;
    }
  }
  v4 = 56 * v3;
  particle_pool[v4] = 1;
  particle_pos_x[v4 / 4u] = *a1;
  particle_pos_y[v4 / 4u] = a1[1];
  v5 = (_DWORD *)((char *)&particle_scale_x + 56 * v3);
  *(float *)(v4 + 4800196) = cos(*(float *)&a2) * 30.0;
  *(float *)(v4 + 4800200) = sin(*(float *)&a2) * 30.0;
  particle_intensity[v4 / 4u] = 1065353216;
  *v5 = 1065353216;
  v5[1] = 1065353216;
  v5[2] = 1065353216;
  v5[3] = 0;
  particle_angle[v4 / 4u] = a2;
  v6 = crt_rand() % 628;
  *(float *)(v4 + 4800228) = (double)v6 * 0.0099999998;
  byte_493EB9[v4] = 1;
  particle_style_id[v4] = 8;
  particle_target_id[v4 / 4u] = -1;
  return v3;
}

// fx_spawn_secondary_projectile @ 0x00420360
// spawns a typed entry in DAT_00495ad8 (secondary projectile pool)
int __cdecl sub_420360(_DWORD *a1, float a2, int a3)
{
  int v3; // edi
  _BYTE *v4; // eax
  long double v5; // st7
  long double v6; // st6
  int v7; // esi
  long double v8; // st7
  float v10; // [esp+8h] [ebp-4h]
  float v11; // [esp+10h] [ebp+4h]

  v3 = 0;
  v4 = &secondary_projectile_pool;
  while ( *v4 )
  {
    v4 += 44;
    ++v3;
    if ( (int)v4 >= (int)&dword_4965D8 )
    {
      v3 = 63;
      break;
    }
  }
  v5 = a2 - 1.5707964;
  v6 = cos(v5);
  ++highscore_record_shots_fired;
  v7 = 44 * v3 + 4807384;
  *(_BYTE *)v7 = 1;
  *(_DWORD *)(v7 + 12) = *a1;
  *(_DWORD *)(v7 + 16) = a1[1];
  *(_DWORD *)(v7 + 8) = 0x40000000;
  *(float *)(v7 + 4) = a2;
  *(_DWORD *)(v7 + 32) = 0;
  *(_DWORD *)(v7 + 28) = a3;
  *(float *)(v7 + 20) = v6 * 90.0;
  v8 = sin(v5);
  *(float *)(v7 + 24) = v8 * 90.0;
  if ( a3 == 2 )
  {
    LODWORD(secondary_proj_vel_y[11 * v3 + 3]) = creature_find_nearest(
                                                   (float *)&player_aim_x[216 * render_overlay_player_index],
                                                   -1,
                                                   0.0);
    v11 = v6;
    *((float *)&secondary_proj_vel_x + 11 * v3) = v11 * 190.0;
    v10 = v8;
    secondary_proj_vel_y[11 * v3] = v10 * 190.0;
  }
  return v3;
}

// projectile_spawn @ 0x00420440
// allocates a projectile slot, initializes fields, and returns the index (overrides to type 0x2d when Fire Bullets is active)
int __cdecl sub_420440(_DWORD *a1, float a2, int a3, int a4)
{
  int v5; // ecx
  int v6; // ecx
  char *v7; // eax
  int result; // eax
  char *v9; // ecx

  if ( !bonus_spawn_guard )
  {
    v5 = highscore_record_shots_fired;
    while ( a4 == -100 || a4 == -1 || a4 == -2 || a4 == -3 )
    {
      ++v5;
      if ( a3 == 45 || *(float *)player_fire_bullets_timer <= 0.0 && player2_fire_bullets_timer <= 0.0 )
        break;
      a3 = 45;
    }
    highscore_record_shots_fired = v5;
  }
  v6 = 0;
  v7 = projectile_pool;
  while ( *v7 )
  {
    v7 += 64;
    ++v6;
    if ( (int)v7 >= (int)particle_pool )
    {
      result = 95;
      goto LABEL_16;
    }
  }
  result = v6;
LABEL_16:
  v9 = &projectile_pool[64 * result];
  *((_DWORD *)v9 + 15) = a4;
  *v9 = 1;
  *((_DWORD *)v9 + 14) = weapon_projectile_meta[31 * a3];
  *((_DWORD *)v9 + 2) = *a1;
  *((_DWORD *)v9 + 3) = a1[1];
  *((_DWORD *)v9 + 4) = *a1;
  *((_DWORD *)v9 + 5) = a1[1];
  *((float *)v9 + 1) = a2;
  *((_DWORD *)v9 + 8) = a3;
  *((_DWORD *)v9 + 9) = 1053609165;
  *((_DWORD *)v9 + 10) = 0;
  *((_DWORD *)v9 + 11) = 1065353216;
  *((float *)v9 + 6) = cos(a2) * 1.5;
  *((float *)v9 + 7) = sin(a2) * 1.5;
  switch ( a3 )
  {
    case 22:
      *((_DWORD *)v9 + 13) = 1077936128;
      *((_DWORD *)v9 + 12) = 1065353216;
      return result;
    case 21:
      *((_DWORD *)v9 + 13) = 1084227584;
      *((_DWORD *)v9 + 12) = 1065353216;
      return result;
    case 23:
    case 28:
      *((_DWORD *)v9 + 13) = 1092616192;
      break;
    default:
      *((_DWORD *)v9 + 13) = 1065353216;
      switch ( a3 )
      {
        case 6:
          *((_DWORD *)v9 + 12) = 1133903872;
          return result;
        case 45:
          *((_DWORD *)v9 + 12) = 1131413504;
          return result;
        case 25:
          *((_DWORD *)v9 + 12) = 1112014848;
          return result;
      }
      break;
  }
  *((_DWORD *)v9 + 12) = 1065353216;
  return result;
}

// projectile_reset_pools @ 0x004205D0
// clears projectile and effect pools (DAT_004926b8, DAT_00493eb8)
char *sub_4205D0()
{
  char *v0; // eax
  char *result; // eax

  v0 = projectile_pool;
  do
  {
    *v0 = 0;
    v0 += 64;
  }
  while ( (int)v0 < (int)particle_pool );
  result = particle_pool;
  do
  {
    *result = 0;
    result += 56;
  }
  while ( (int)result < (int)&dword_495AB8 );
  return result;
}

// creatures_apply_radius_damage @ 0x00420600
// applies damage to creatures within radius using FUN_004207c0
void __cdecl sub_420600(float *a1, float a2, float a3, int a4)
{
  int v4; // edi
  char *v5; // esi
  double v6; // st5
  double v7; // st7
  double v8; // st5
  int v9[2]; // [esp+10h] [ebp-8h] BYREF

  v9[0] = 0;
  v9[1] = 0;
  v4 = 0;
  v5 = creature_pool;
  do
  {
    if ( *v5 )
    {
      v6 = *((float *)v5 + 5) - *a1;
      v7 = v6 * v6;
      v8 = *((float *)v5 + 6) - a1[1];
      if ( *((float *)v5 + 13) * 0.14285715 + 3.0 > sqrt(v7 + v8 * v8) - a2 && *((float *)v5 + 4) > 5.0 )
        creature_apply_damage(v4, a3, a4, (int)v9);
    }
    v5 += 152;
    ++v4;
  }
  while ( (int)v5 < (int)byte_4AA338 );
}

// creature_find_in_radius @ 0x004206A0
// returns the first creature index in range, or -1
int __cdecl sub_4206A0(float *a1, float a2, int a3)
{
  int v3; // edx
  int v4; // ecx
  double v5; // st5
  double v6; // st7
  double v7; // st5

  v3 = a3;
  if ( a3 >= 384 )
    return -1;
  v4 = 152 * a3 + 4833080;
  while ( 1 )
  {
    if ( *(_BYTE *)v4 )
    {
      v5 = *(float *)(v4 + 20) - *a1;
      v6 = v5 * v5;
      v7 = *(float *)(v4 + 24) - a1[1];
      if ( *(float *)(v4 + 52) * 0.14285715 + 3.0 > sqrt(v6 + v7 * v7) - a2 && *(float *)(v4 + 16) > 5.0 )
        break;
    }
    v4 += 152;
    ++v3;
    if ( v4 >= (int)byte_4AA338 )
      return -1;
  }
  return v3;
}

// player_find_in_radius @ 0x00420730
// returns a player index in range, skipping owner_id (-1/-2/-3 -> player 0/1/2)
int __cdecl sub_420730(int a1, float *a2, float a3)
{
  int v3; // ecx
  float *i; // edx
  double v5; // st5
  double v6; // st7
  double v7; // st5

  v3 = 0;
  if ( config_player_count <= 0 )
    return -1;
  for ( i = (float *)player_health; ; i += 216 )
  {
    if ( v3 != -1 - a1 && *i > 0.0 )
    {
      v5 = *(i - 4) - *a2;
      v6 = v5 * v5;
      v7 = *(i - 3) - a2[1];
      if ( i[4] * 0.14285715 + 3.0 > sqrt(v6 + v7 * v7) - a3 )
        break;
    }
    if ( ++v3 >= config_player_count )
      return -1;
  }
  return v3;
}

// creature_apply_damage @ 0x004207C0
// applies damage + impulse, handles death side effects; returns 1 when killed
BOOL __cdecl sub_4207C0(int a1, float a2, int a3, float *a4)
{
  int v4; // edx
  double v5; // st7
  float *v6; // ecx
  double v7; // st7
  int v8; // edi
  int v9; // ecx
  float v11; // [esp+10h] [ebp-Ch]

  creature_hit_flash_timer[38 * a1] = 1045220557;
  if ( a3 == 1 )
  {
    if ( perk_count_get(perk_id_uranium_filled_bullets) )
      a2 = a2 + a2;
    if ( perk_count_get(perk_id_living_fortress) )
    {
      v4 = config_player_count;
      if ( config_player_count > 0 )
      {
        v5 = a2;
        v6 = (float *)&player_living_fortress_timer;
        do
        {
          if ( *(v6 - 32) > 0.0 )
            v5 = v5 * (*v6 * 0.050000001 + 1.0);
          v6 += 216;
          --v4;
        }
        while ( v4 );
        a2 = v5;
      }
    }
    if ( perk_count_get(perk_id_barrel_greaser) )
      a2 = a2 * 1.4;
    if ( perk_count_get(perk_id_doctor) )
      a2 = a2 * 1.2;
    if ( (creature_flags[38 * a1] & 4) == 0 )
    {
      v7 = (double)((crt_rand() & 0x7F) - 64) * 0.0020000001 / (*(&creature_size + 38 * a1) * 0.025);
      if ( v7 > 1.5707964 )
        v7 = 1.5707964;
      *(&creature_heading + 38 * a1) = v7 + *(&creature_heading + 38 * a1);
    }
  }
  else if ( a3 == 7 && perk_count_get(perk_id_ion_gun_master) )
  {
    a2 = a2 * 1.2;
  }
  if ( *(float *)&creature_health[38 * a1] <= 0.0 )
  {
    *(float *)&creature_hitbox_size[38 * a1] = *(float *)&creature_hitbox_size[38 * a1] - frame_dt * 15.0;
  }
  else
  {
    if ( a3 == 4 && perk_count_get(perk_id_pyromaniac) )
    {
      a2 = a2 * 1.5;
      crt_rand();
    }
    *(float *)&creature_health[38 * a1] = *(float *)&creature_health[38 * a1] - a2;
    *(float *)&creature_vel_x[38 * a1] = *(float *)&creature_vel_x[38 * a1] - *a4;
    *(float *)&creature_vel_y[38 * a1] = *(float *)&creature_vel_y[38 * a1] - a4[1];
    if ( *(float *)&creature_health[38 * a1] <= 0.0 )
    {
      *(float *)&creature_hitbox_size[38 * a1] = *(float *)&creature_hitbox_size[38 * a1] - frame_dt;
      creature_handle_death(a1, 1);
      v11 = a4[1] + a4[1];
      *(float *)&creature_vel_x[38 * a1] = *(float *)&creature_vel_x[38 * a1] - (*a4 + *a4);
      *(float *)&creature_vel_y[38 * a1] = *(float *)&creature_vel_y[38 * a1] - v11;
      if ( (creature_flags[38 * a1] & 0x10) != 0 )
      {
        effect_template_color_r = 1061997773;
        effect_template_flags = 29;
        effect_template_color_g = 1061997773;
        effect_template_color_b = 1050253722;
        effect_template_color_a = 1056964608;
        effect_template_lifetime = 1060320051;
        effect_template_half_width = 1108344832;
        effect_template_half_height = 1108344832;
        v8 = 5;
        do
        {
          *(float *)&effect_template_rotation = (double)(crt_rand() & 0x7F) * 0.049087387;
          *(float *)&effect_template_vel_x = (float)((crt_rand() & 0x7F) - 64);
          *(float *)&effect_template_vel_y = (float)((crt_rand() & 0x7F) - 64);
          *(float *)&effect_template_scale_step = (double)(crt_rand() % 140) * 0.0099999998 + 0.30000001;
          effect_spawn(0, &creature_pos_x + 38 * a1);
          --v8;
        }
        while ( v8 );
      }
      else
      {
        v9 = crt_rand() % 4;
        sfx_play_panned(
          *(&creature_type_sfx_a0 + 17 * *(&creature_type_id + 38 * a1) + v9),
          (int)(&creature_pos_x + 38 * a1),
          1.0);
      }
    }
  }
  return *(float *)&creature_health[38 * a1] <= 0.0;
}

// projectile_update @ 0x00420B90
// updates projectile movement, collisions, and hit effects
int sub_420B90()
{
  char *v0; // esi
  int v1; // eax
  double v2; // st7
  double v3; // st7
  double v4; // st7
  float *v5; // edi
  long double v6; // st7
  int v7; // ebx
  int v8; // ecx
  float v9; // ebx
  int v10; // eax
  int v11; // ebp
  int v12; // eax
  int v13; // ebx
  int v14; // ebx
  int v15; // ebx
  int v16; // ebx
  int v17; // ebp
  int v18; // eax
  int v19; // eax
  int v20; // eax
  double v21; // st7
  long double v22; // st6
  double v23; // st6
  double v24; // st4
  long double v25; // st7
  int v26; // eax
  int v27; // eax
  double v28; // st7
  int v29; // ebp
  long double v30; // st7
  double v31; // st7
  double v32; // st7
  long double v34; // st7
  unsigned __int8 v35; // c0
  unsigned __int8 v36; // c3
  long double v37; // st6
  int v38; // ecx
  int v39; // eax
  float *v40; // ebx
  int v41; // ebp
  long double v42; // st7
  double v43; // st7
  long double v44; // st6
  int v45; // eax
  int v46; // ebp
  int result; // eax
  float *v48; // esi
  double v49; // st7
  char v50; // fps^1
  bool v51; // c0
  char v52; // c2
  bool v53; // c3
  double v54; // st7
  int v55; // ebx
  float *v56; // edi
  char v57; // fps^1
  double v58; // st7
  bool v59; // c0
  char v60; // c2
  bool v61; // c3
  double v62; // st7
  double v63; // st5
  long double v64; // st6
  char v65; // fps^1
  bool v66; // c0
  char v67; // c2
  bool v68; // c3
  char v69; // fps^1
  double v70; // st7
  bool v71; // c0
  char v72; // c2
  bool v73; // c3
  float *v74; // ebx
  int v75; // eax
  double v76; // st7
  double v77; // st7
  double v78; // st7
  long double v79; // st7
  double v80; // st7
  long double v81; // st7
  long double v82; // st7
  int v83; // eax
  int v84; // ebp
  int v85; // edi
  int v86; // eax
  int v87; // eax
  int v88; // eax
  int v89; // eax
  double v90; // st7
  double v91; // st7
  int v92; // eax
  bool v93; // c0
  bool v94; // c3
  int v95; // edi
  int v96; // ebp
  double v97; // st7
  bool v98; // c0
  bool v99; // c3
  int v100; // edi
  int v101; // ebp
  double v102; // st7
  bool v103; // c0
  bool v104; // c3
  char *v105; // ebp
  int v106; // edi
  int v107; // ebp
  double v108; // st7
  int v109; // edi
  double v110; // st7
  long double v111; // st6
  char v112; // fps^1
  double v113; // st7
  bool v114; // c0
  char v115; // c2
  bool v116; // c3
  float *v117; // ecx
  double v118; // st7
  double v119; // st7
  char v120; // fps^1
  bool v121; // c0
  char v122; // c2
  bool v123; // c3
  struct _SYSTEMTIME *v124; // esi
  double v125; // st7
  double v126; // st7
  double v128; // st6
  unsigned __int8 v129; // c0
  unsigned __int8 v130; // c3
  double v131; // st7
  double v132; // st6
  double v133; // st7
  double v134; // st6
  double v135; // st7
  double v136; // st6
  double v137; // st7
  double v139; // st6
  unsigned __int8 v140; // c0
  unsigned __int8 v141; // c3
  double v142; // st7
  double v143; // st6
  double v144; // st7
  char wYear; // cl
  __int16 v146; // fps
  double v147; // st7
  bool v148; // c0
  char v149; // c2
  bool v150; // c3
  bool v151; // c0
  char v152; // c2
  bool v153; // c3
  int v154; // eax
  int v155; // eax
  int v156; // eax
  int v157; // et2
  double v158; // st7
  int v159; // eax
  int v160; // et2
  long double v161; // st7
  long double v162; // st7
  int v163; // eax
  int v164; // et2
  long double v165; // st7
  char v166; // fps^1
  double v167; // st7
  bool v168; // c0
  char v169; // c2
  bool v170; // c3
  double v171; // st7
  double v172; // st7
  float *p_wDayOfWeek; // edi
  int v174; // ebx
  float v175; // edx
  double v176; // st7
  double v177; // st7
  double v178; // st7
  float *v179; // ebp
  double v180; // st7
  double j; // st7
  double v183; // st7
  char v184; // c0
  double v185; // st7
  int v186; // eax
  double v187; // st7
  double v188; // st7
  int v189; // eax
  double v190; // st7
  float v191; // [esp+8h] [ebp-110h]
  float v192; // [esp+8h] [ebp-110h]
  float v193; // [esp+8h] [ebp-110h]
  float v194; // [esp+8h] [ebp-110h]
  int v195; // [esp+8h] [ebp-110h]
  float v196; // [esp+8h] [ebp-110h]
  float v197; // [esp+8h] [ebp-110h]
  float v198; // [esp+Ch] [ebp-10Ch]
  float v199; // [esp+Ch] [ebp-10Ch]
  float v200; // [esp+Ch] [ebp-10Ch]
  float v201; // [esp+Ch] [ebp-10Ch]
  float v202; // [esp+Ch] [ebp-10Ch]
  float v203; // [esp+Ch] [ebp-10Ch]
  int v204; // [esp+Ch] [ebp-10Ch]
  char *v205; // [esp+Ch] [ebp-10Ch]
  float v206; // [esp+Ch] [ebp-10Ch]
  float v207; // [esp+10h] [ebp-108h]
  float v208; // [esp+10h] [ebp-108h]
  float v209; // [esp+10h] [ebp-108h]
  float v210; // [esp+10h] [ebp-108h]
  float v211; // [esp+10h] [ebp-108h]
  float v212; // [esp+10h] [ebp-108h]
  float v213; // [esp+24h] [ebp-F4h]
  int v214; // [esp+24h] [ebp-F4h]
  float v215; // [esp+24h] [ebp-F4h]
  float v216; // [esp+28h] [ebp-F0h]
  int v217; // [esp+2Ch] [ebp-ECh]
  float v218; // [esp+2Ch] [ebp-ECh]
  int v219; // [esp+2Ch] [ebp-ECh]
  int v220; // [esp+2Ch] [ebp-ECh]
  int v221; // [esp+2Ch] [ebp-ECh]
  int i; // [esp+30h] [ebp-E8h]
  float v223; // [esp+30h] [ebp-E8h]
  float v224; // [esp+30h] [ebp-E8h]
  float v225; // [esp+30h] [ebp-E8h]
  int v226; // [esp+30h] [ebp-E8h]
  int v227; // [esp+34h] [ebp-E4h]
  float v228; // [esp+34h] [ebp-E4h]
  float v229; // [esp+34h] [ebp-E4h]
  float v230; // [esp+34h] [ebp-E4h]
  float v231; // [esp+34h] [ebp-E4h]
  int v232; // [esp+3Ch] [ebp-DCh]
  float v233; // [esp+3Ch] [ebp-DCh]
  int v234; // [esp+40h] [ebp-D8h]
  float v235; // [esp+40h] [ebp-D8h]
  float v236; // [esp+40h] [ebp-D8h]
  float v237; // [esp+40h] [ebp-D8h]
  float v238; // [esp+40h] [ebp-D8h]
  float v239; // [esp+40h] [ebp-D8h]
  float v240; // [esp+48h] [ebp-D0h]
  float v241; // [esp+48h] [ebp-D0h]
  int v242; // [esp+48h] [ebp-D0h]
  int v243; // [esp+48h] [ebp-D0h]
  float v244; // [esp+4Ch] [ebp-CCh] BYREF
  float v245; // [esp+50h] [ebp-C8h]
  float v246; // [esp+54h] [ebp-C4h]
  float v247; // [esp+58h] [ebp-C0h] BYREF
  float v248; // [esp+5Ch] [ebp-BCh]
  int v249; // [esp+60h] [ebp-B8h] BYREF
  float v250; // [esp+64h] [ebp-B4h]
  int v251; // [esp+68h] [ebp-B0h] BYREF
  float v252; // [esp+6Ch] [ebp-ACh]
  float v253; // [esp+70h] [ebp-A8h] BYREF
  float v254; // [esp+74h] [ebp-A4h]
  int v255; // [esp+78h] [ebp-A0h] BYREF
  float v256; // [esp+7Ch] [ebp-9Ch]
  int v257; // [esp+80h] [ebp-98h] BYREF
  float v258; // [esp+84h] [ebp-94h]
  float v259; // [esp+88h] [ebp-90h] BYREF
  float v260; // [esp+8Ch] [ebp-8Ch]
  int v261; // [esp+90h] [ebp-88h] BYREF
  float v262; // [esp+94h] [ebp-84h]
  float v263; // [esp+98h] [ebp-80h] BYREF
  float v264; // [esp+9Ch] [ebp-7Ch]
  int v265; // [esp+A0h] [ebp-78h] BYREF
  float v266; // [esp+A4h] [ebp-74h]
  float v267; // [esp+A8h] [ebp-70h] BYREF
  float v268; // [esp+ACh] [ebp-6Ch]
  float v269; // [esp+B0h] [ebp-68h]
  int v270; // [esp+B4h] [ebp-64h]
  int v271; // [esp+B8h] [ebp-60h]
  int v272; // [esp+BCh] [ebp-5Ch]
  float v273; // [esp+C0h] [ebp-58h]
  float v274; // [esp+C8h] [ebp-50h]
  float v275; // [esp+CCh] [ebp-4Ch]
  float v276; // [esp+D0h] [ebp-48h] BYREF
  float v277; // [esp+D4h] [ebp-44h]
  float v278; // [esp+D8h] [ebp-40h]
  float v279; // [esp+DCh] [ebp-3Ch]
  float v280; // [esp+E0h] [ebp-38h]
  float v281; // [esp+E4h] [ebp-34h]
  float v282; // [esp+E8h] [ebp-30h]
  float v283; // [esp+ECh] [ebp-2Ch]
  float v284; // [esp+F0h] [ebp-28h]
  float v285; // [esp+F8h] [ebp-20h] BYREF
  float v286; // [esp+FCh] [ebp-1Ch]
  float v287; // [esp+100h] [ebp-18h]
  float v288; // [esp+104h] [ebp-14h]
  _DWORD v289[4]; // [esp+108h] [ebp-10h] BYREF

  ++dword_4AAF54;
  v247 = 1.0;
  if ( perk_count_get(perk_id_ion_gun_master) )
    v247 = 1.2;
  for ( i = 0; i < 96; ++i )
  {
    v0 = &projectile_pool[64 * i];
    if ( !*v0 )
      goto LABEL_128;
    if ( *((float *)v0 + 9) <= 0.0 )
      *v0 = 0;
    if ( *((float *)v0 + 9) < 0.40000001 )
    {
      v1 = *((_DWORD *)v0 + 8);
      switch ( v1 )
      {
        case 21:
        case 22:
          if ( i == shock_chain_projectile_id )
          {
            shock_chain_projectile_id = -1;
            shock_chain_links_left = 0;
          }
          *((float *)v0 + 9) = *((float *)v0 + 9) - frame_dt;
          v4 = frame_dt;
          if ( v1 == 21 )
          {
            v198 = v4 * 100.0;
            v2 = v247 * 88.0;
          }
          else
          {
            v198 = v4 * 40.0;
            v2 = v247 * 60.0;
          }
          goto LABEL_18;
        case 23:
          *((float *)v0 + 9) = *((float *)v0 + 9) - frame_dt * 0.69999999;
          v198 = frame_dt * 300.0;
          v2 = v247 * 128.0;
LABEL_18:
          v191 = v2;
          creatures_apply_radius_damage((float *)v0 + 2, v191, v198, 7);
          goto LABEL_128;
        case 6:
          v3 = *((float *)v0 + 9) - frame_dt * 0.1;
          break;
        default:
LABEL_126:
          v3 = *((float *)v0 + 9) - frame_dt;
          break;
      }
      *((float *)v0 + 9) = v3;
      goto LABEL_128;
    }
    v5 = (float *)(v0 + 8);
    if ( *((float *)v0 + 2) < -64.0
      || *((float *)v0 + 3) < -64.0
      || (double)(terrain_texture_width + 64) < *v5
      || (double)(terrain_texture_height + 64) < *((float *)v0 + 3) )
    {
      goto LABEL_126;
    }
    v6 = *((float *)v0 + 1) - 1.5707964;
    v7 = (__int64)*((float *)v0 + 14);
    v232 = v7;
    v240 = cos(v6) * frame_dt * 20.0;
    v213 = sin(v6) * frame_dt * 20.0;
    if ( perk_count_get(perk_id_barrel_greaser) && *((int *)v0 + 15) < 0 )
    {
      v7 = (__int64)((double)v7 + (double)v7);
      v232 = v7;
    }
    v245 = 0.0;
    v244 = 0.0;
    v246 = 0.0;
    if ( v7 > 0 )
    {
      v8 = v232;
      v9 = v246;
      do
      {
        v244 = v240 * *((float *)v0 + 11) * 3.0 + v244;
        v245 = v213 * *((float *)v0 + 11) * 3.0 + v245;
        if ( sqrt(v244 * v244 + v245 * v245) >= 4.0 || LODWORD(v9) + 3 >= v8 )
        {
          FUN_0041e270((float *)v0 + 2, &v244);
          v10 = creature_find_in_radius((float *)v0 + 2, *((float *)v0 + 13), 0);
          v11 = v10;
          v217 = v10;
          if ( v10 == -1 || v10 == *((_DWORD *)v0 + 15) )
          {
            if ( i != shock_chain_projectile_id )
            {
              v45 = *((_DWORD *)v0 + 15);
              if ( v45 != -100 )
                v11 = player_find_in_radius(v45, (float *)v0 + 2, *((float *)v0 + 13));
              if ( v11 != -1 )
              {
                v46 = 3 * v11;
                *((_DWORD *)v0 + 9) = 1048576000;
                if ( *(float *)&player_shield_timer[72 * v46] <= 0.0 )
                  *(float *)&player_health[72 * v46] = *(float *)&player_health[72 * v46] - 10.0;
              }
            }
          }
          else
          {
            if ( perk_count_get(perk_id_poison_bullets) && (crt_rand() & 7) == 1 )
              creature_flags[38 * v11] |= 1u;
            v12 = *((_DWORD *)v0 + 8);
            if ( v12 == 25 )
            {
              v13 = 8;
              do
              {
                v199 = (double)(unsigned __int8)crt_rand() * 0.024543693;
                effect_spawn_blood_splatter((int)(v0 + 8), v199, 0.0);
                --v13;
              }
              while ( v13 );
            }
            else if ( v12 == 29 )
            {
              FUN_0042f3f0((int)(v0 + 8), 26.0, 3);
              v192 = *((float *)v0 + 1) - 1.0471976;
              projectile_spawn((_DWORD *)v0 + 2, v192, 29, v11);
              v193 = *((float *)v0 + 1) + 1.0471976;
              projectile_spawn((_DWORD *)v0 + 2, v193, 29, v11);
            }
            v270 = 1065353216;
            v269 = 1.0;
            effect_template_color_g = 1065353216;
            v271 = 1065353216;
            v272 = 1065353216;
            effect_template_color_r = 1065353216;
            effect_template_flags = 89;
            effect_template_color_b = 1065353216;
            effect_template_color_a = 1065353216;
            effect_template_lifetime = 1051931443;
            effect_template_age = 0;
            effect_template_half_width = 1082130432;
            effect_template_half_height = 1082130432;
            if ( !config_fx_toggle )
            {
              if ( perk_count_get(perk_id_bloody_mess_quick_learner) )
              {
                v14 = 8;
                do
                {
                  v200 = (double)((crt_rand() & 0x1F) - 16) * 0.0625 + *((float *)v0 + 1) - 1.5707964;
                  effect_spawn_blood_splatter((int)(v0 + 8), v200, 0.0);
                  --v14;
                }
                while ( v14 );
                v201 = *((float *)v0 + 1) - 1.5707964 + 3.1415927;
                effect_spawn_blood_splatter((int)(v0 + 8), v201, 0.0);
              }
              else if ( bonus_freeze_timer <= 0.0 )
              {
                v15 = 2;
                do
                {
                  v202 = *((float *)v0 + 1) - 1.5707964;
                  effect_spawn_blood_splatter((int)(v0 + 8), v202, 0.0);
                  if ( (crt_rand() & 7) == 2 )
                  {
                    v203 = *((float *)v0 + 1) - 1.5707964 + 3.1415927;
                    effect_spawn_blood_splatter((int)(v0 + 8), v203, 0.0);
                  }
                  --v15;
                }
                while ( v15 );
              }
            }
            v16 = 152 * v11;
            if ( creature_hitbox_size[38 * v11] == 1098907648 )
              ++highscore_record_shots_hit;
            if ( perk_count_get(perk_id_bloody_mess_quick_learner) )
            {
              v234 = 30;
              v17 = -30;
              do
              {
                v273 = (float)(v17 + crt_rand() % (v234 - v17));
                v18 = crt_rand();
                v285 = v273 + *(float *)(v16 + 4833100);
                v286 = (double)(v17 + v18 % (v234 - v17)) + *(float *)(v16 + 4833104);
                fx_queue_add_random(&v285);
                v284 = (float)(v17 + crt_rand() % (v234 - v17));
                v19 = crt_rand();
                v276 = v284 + *(float *)(v16 + 4833100);
                v277 = (double)(v17 + v19 % (v234 - v17)) + *(float *)(v16 + 4833104);
                fx_queue_add_random(&v276);
                v17 -= 10;
                v234 += 10;
              }
              while ( v17 > -60 );
              v11 = v217;
            }
            v20 = *((_DWORD *)v0 + 8);
            if ( v20 != 45 && v20 != 6 && v20 != 25 )
            {
              *((_DWORD *)v0 + 9) = 1048576000;
              v21 = (double)(crt_rand() & 3);
              v22 = *((float *)v0 + 1) - 1.5707964;
              *v5 = cos(v22) * v21 + *v5;
              *((float *)v0 + 3) = sin(v22) * v21 + *((float *)v0 + 3);
            }
            v23 = *((float *)v0 + 5) - *((float *)v0 + 3);
            v24 = *((float *)v0 + 4) - *v5;
            v25 = sqrt(v23 * v23 + v24 * v24);
            if ( v25 < 50.0 )
              v25 = 50.0;
            v26 = *((_DWORD *)v0 + 8);
            v235 = 100.0 / v25 * weapon_projectile_damage_scale[31 * v26] * 30.0 + 10.0;
            switch ( v26 )
            {
              case 22:
                FUN_0042f270((int)(v0 + 8), 1.5, 0.1);
                FUN_0042f540((int)(v0 + 8), 0.80000001);
                break;
              case 21:
                if ( shock_chain_links_left > 0 && i == shock_chain_projectile_id )
                {
                  --shock_chain_links_left;
                  v27 = creature_find_nearest((float *)v0 + 2, v11, 100.0);
                  bonus_spawn_guard = 1;
                  v194 = atan2(
                           creature_pos_y[38 * v27] - *(float *)(v16 + 4833104),
                           *((float *)&creature_pos_x + 38 * v27) - *(float *)(v16 + 4833100))
                       - 1.5707964
                       - 3.1415927;
                  shock_chain_projectile_id = projectile_spawn((_DWORD *)v0 + 2, v194, 21, v11);
                  bonus_spawn_guard = 0;
                }
                FUN_0042f270((int)(v0 + 8), 1.2, 0.40000001);
                FUN_0042f540((int)(v0 + 8), 1.2);
                break;
              case 23:
                FUN_0042f270((int)(v0 + 8), 1.0, 1.0);
                FUN_0042f540((int)(v0 + 8), 2.2);
                sfx_play_panned(sfx_shockwave, (int)(v0 + 8), 1.0);
                break;
              case 28:
                v28 = *(float *)(v16 + 4833132) * 0.5;
                v29 = 0;
                bonus_spawn_guard = 1;
                v227 = 0;
                v216 = v28 + 1.0;
                do
                {
                  v30 = (double)v227 * 0.52359879;
                  v228 = v30;
                  v281 = sin(v228) * v216;
                  *(float *)&v261 = cos(v30) * v216 + *v5;
                  v262 = v281 + *((float *)v0 + 3);
                  projectile_spawn(&v261, v228, 9, -100);
                  v227 = ++v29;
                }
                while ( v29 < 12 );
                bonus_spawn_guard = 0;
                sfx_play_panned(sfx_explosion_medium, (int)(v0 + 8), 1.0);
                sfx_play_panned(sfx_shockwave, (int)(v0 + 8), 1.0);
                FUN_0042f330((int)(v0 + 8), 1.5, 1065353216);
                FUN_0042f330((int)(v0 + 8), 1.0, 1065353216);
                v11 = v217;
                break;
              case 24:
                FUN_0042f080(v0 + 8);
                v31 = *(float *)(v16 + 4833132) * 0.64999998;
                *((_DWORD *)v0 + 9) = 1048576000;
                *(float *)(v16 + 4833132) = v31;
                if ( v31 < 16.0 )
                  creature_handle_death(v11, 1);
                break;
              case 19:
                v288 = v245 * 3.0;
                *(float *)(v16 + 4833100) = v244 * 3.0 + *(float *)(v16 + 4833100);
                *(float *)(v16 + 4833104) = v288 + *(float *)(v16 + 4833104);
                break;
              case 41:
                creature_collision_flag[v16] = 1;
                break;
            }
            v32 = v235 * 0.94999999;
            v236 = v32;
            if ( v32 > 0.0 && *(float *)(v16 + 4833116) > 0.0 )
            {
              v218 = *((float *)v0 + 12) - 1.0;
              *((float *)v0 + 12) = v218;
              v34 = cos(*((float *)v0 + 1) - 1.5707964);
              v37 = v34 * *((float *)v0 + 11);
              if ( v35 | v36 )
              {
                *(float *)&v257 = v37;
                v258 = v34 * *((float *)v0 + 11);
                creature_apply_damage(v11, v236, 1, (float *)&v257);
                if ( *((_DWORD *)v0 + 9) != 1048576000 )
                  *((_DWORD *)v0 + 9) = 1048576000;
              }
              else
              {
                *(float *)&v265 = v37;
                v266 = v34 * *((float *)v0 + 11);
                creature_apply_damage(v11, v218, 1, (float *)&v265);
                *((float *)v0 + 12) = *((float *)v0 + 12) - *(float *)(v16 + 4833116);
              }
            }
            if ( *((_DWORD *)v0 + 12) == 1065353216 )
            {
              v38 = *((_DWORD *)v0 + 9);
              *((_DWORD *)v0 + 12) = 0;
              if ( v38 != 1048576000 )
                *((_DWORD *)v0 + 9) = 1048576000;
            }
            creature_state_flag[v16] = 1;
            crt_rand();
            v39 = *((_DWORD *)v0 + 8);
            if ( v39 == 6 || v39 == 45 )
            {
              perk_count_get(perk_id_bloody_mess_quick_learner);
              v219 = 6;
              do
              {
                v43 = (double)(crt_rand() % 100) * 0.1;
                if ( v43 > 4.0 )
                  v43 = (double)(crt_rand() % 90 + 10) * 0.1;
                if ( v43 > 7.0 )
                  v43 = (double)(crt_rand() % 80 + 20) * 0.1;
                v44 = *((float *)v0 + 1) - 1.5707964;
                v253 = 0.0;
                v254 = 0.0;
                v238 = cos(v44) * v43 * 20.0;
                v230 = sin(v44) * v43 * 20.0;
                *(float *)&v251 = v238 + *(float *)(v16 + 4833100);
                v252 = v230 + *(float *)(v16 + 4833104);
                vec2_add_inplace(v11, (float *)&v251, &v253);
                crt_rand();
                if ( bonus_freeze_timer > 0.0 )
                {
                  *(float *)&v255 = v238 + *v5;
                  v256 = v230 + *((float *)v0 + 3);
                  v208 = (double)(crt_rand() % 100) * 0.0099999998 + *((float *)v0 + 1) - 1.5707964;
                  effect_spawn_freeze_shard((int)&v255, v208);
                }
                *(float *)&v249 = v238 + *(float *)(v16 + 4833100);
                v250 = v230 + *(float *)(v16 + 4833104);
                fx_queue_add_random(&v249);
                --v219;
              }
              while ( v219 );
            }
            else if ( bonus_freeze_timer <= 0.0 )
            {
              v40 = (float *)((char *)&creature_pos_x + v16);
              v41 = 3;
              do
              {
                v42 = (double)(crt_rand() % 20 - 10) * 0.1 + *((float *)v0 + 1) - 1.5707964;
                v237 = cos(v42) * 20.0;
                v229 = sin(v42) * 20.0;
                fx_queue_add_random(v40);
                v275 = v229 * 1.5;
                v267 = v237 * 1.5 + *v40;
                v268 = v275 + v40[1];
                fx_queue_add_random(&v267);
                v279 = v229 + v229;
                v263 = v237 + v237 + *v40;
                v264 = v279 + v40[1];
                fx_queue_add_random(&v263);
                v283 = v229 * 2.5;
                v259 = v237 * 2.5 + *v40;
                v260 = v283 + v40[1];
                fx_queue_add_random(&v259);
                --v41;
              }
              while ( v41 );
            }
            else
            {
              v207 = (double)(crt_rand() % 100) * 0.0099999998 + *((float *)v0 + 1) - 1.5707964;
              effect_spawn_freeze_shard((int)(v0 + 8), v207);
            }
            if ( demo_mode_active || byte_4CC8D4 || config_game_mode == 2 )
            {
              v204 = (int)(v0 + 8);
              if ( weapon_ammo_class[31 * *((_DWORD *)v0 + 8)] == 4 )
              {
                sfx_play_panned(sfx_shock_hit_01, v204, 1.0);
              }
              else
              {
                v195 = sfx_bullet_hit_01 + crt_rand() % 6;
                sfx_play_panned(v195, v204, 1.0);
              }
            }
            else
            {
              sfx_play_exclusive(music_track_extra_0);
            }
            if ( *((float *)v0 + 12) <= 0.0 )
              break;
            v9 = v246;
          }
          v8 = v232;
          v245 = 0.0;
          v244 = 0.0;
        }
        LODWORD(v9) += 3;
        v246 = v9;
      }
      while ( SLODWORD(v9) < v8 );
    }
LABEL_128:
    result = i + 1;
  }
  v48 = secondary_proj_vel_y;
  do
  {
    if ( !*((_BYTE *)v48 - 24) )
      goto LABEL_207;
    if ( *((_DWORD *)v48 + 1) == 3 )
    {
      camera_shake_pulses = 4;
      v49 = frame_dt * 3.0 + *(v48 - 1);
      *(v48 - 1) = v49;
      v51 = v49 < 1.0;
      v52 = 0;
      v53 = v49 == 1.0;
      BYTE1(result) = v50;
      if ( v49 > 1.0 )
      {
        v54 = *v48 * 256.0;
        memset(v289, 0, 12);
        *(float *)&v214 = v54;
        v289[3] = 1048576000;
        fx_queue_add(16, (int *)v48 - 3, v214, v214, 0, v289);
        *((_BYTE *)v48 - 24) = 0;
      }
      v55 = 0;
      v56 = creature_pos_y;
      v215 = *v48 * *(v48 - 1) * 80.0;
      do
      {
        if ( *((_BYTE *)v56 - 24) )
        {
          v58 = v56[3];
          v59 = v58 < 0.0;
          v60 = 0;
          v61 = v58 == 0.0;
          BYTE1(result) = v57;
          if ( v58 > 0.0 )
          {
            v62 = *(v56 - 1) - *(v48 - 3);
            v63 = *v56 - *(v48 - 2);
            v64 = sqrt(v63 * v63 + v62 * v62);
            v66 = v64 < v215;
            v67 = 0;
            v68 = v64 == v215;
            BYTE1(result) = v65;
            if ( v64 < v215 )
            {
              v247 = v62;
              v241 = v63;
              v248 = v241;
              j_FUN_00452f1d(&v247);
              *(float *)&v249 = v247 * 0.1;
              v250 = v248 * 0.1;
              v196 = frame_dt * *v48 * 700.0;
              result = creature_apply_damage(v55, v196, 3, (float *)&v249);
              v70 = v56[3];
              v71 = v70 < 0.0;
              v72 = 0;
              v73 = v70 == 0.0;
              BYTE1(result) = v69;
              if ( v70 <= 0.0 )
              {
                fx_queue_add_random(v56 - 1);
                fx_queue_add_random(v56 - 1);
                creature_handle_death(v55, 1);
              }
            }
          }
        }
        v56 += 38;
        ++v55;
      }
      while ( (int)v56 < (int)flt_4AA350 );
      goto LABEL_207;
    }
    v74 = v48 - 3;
    *(float *)&v255 = frame_dt * *(v48 - 1);
    v256 = frame_dt * *v48;
    FUN_0041e270(v48 - 3, (float *)&v255);
    v75 = *((_DWORD *)v48 + 1);
    if ( v75 == 1 )
    {
      if ( sqrt(*v48 * *v48 + *(v48 - 1) * *(v48 - 1)) < 500.0 )
      {
        v76 = frame_dt * 3.0;
LABEL_148:
        v77 = v76 + 1.0;
        *(v48 - 1) = v77 * *(v48 - 1);
        *v48 = v77 * *v48;
        goto LABEL_149;
      }
      goto LABEL_149;
    }
    if ( v75 == 4 )
    {
      if ( sqrt(*v48 * *v48 + *(v48 - 1) * *(v48 - 1)) < 600.0 )
      {
        v76 = frame_dt * 4.0;
        goto LABEL_148;
      }
LABEL_149:
      v78 = *(v48 - 4) - frame_dt;
      goto LABEL_156;
    }
    if ( v75 != 2 )
      goto LABEL_157;
    if ( !creature_pool[152 * *((_DWORD *)v48 + 3)] )
      *((_DWORD *)v48 + 3) = creature_find_nearest(v48 - 3, -1, 0.0);
    v79 = atan2(
            *(v48 - 2) - creature_pos_y[38 * *((_DWORD *)v48 + 3)],
            *v74 - *((float *)&creature_pos_x + 38 * *((_DWORD *)v48 + 3)))
        - 1.5707964;
    *(v48 - 5) = v79;
    *(v48 - 1) = cos(v79 - 1.5707964) * frame_dt * 800.0 + *(v48 - 1);
    *v48 = sin(*(v48 - 5) - 1.5707964) * frame_dt * 800.0 + *v48;
    if ( sqrt(*v48 * *v48 + *(v48 - 1) * *(v48 - 1)) > 350.0 )
    {
      *(v48 - 1) = *(v48 - 1) - cos(*(v48 - 5) - 1.5707964) * frame_dt * 800.0;
      *v48 = *v48 - sin(*(v48 - 5) - 1.5707964) * frame_dt * 800.0;
    }
    v78 = *(v48 - 4) - frame_dt * 0.5;
LABEL_156:
    *(v48 - 4) = v78;
LABEL_157:
    v242 = *(_DWORD *)(v48 - 1) & 0x7FFFFFFF;
    v246 = *v48;
    v80 = v48[2] - (COERCE_FLOAT(LODWORD(v246) & 0x7FFFFFFF) + *(float *)&v242) * frame_dt * 0.0099999998;
    v48[2] = v80;
    if ( v80 < 0.0 )
    {
      v81 = cos(*(v48 - 5) + 1.5707964);
      v282 = v81;
      *(float *)&v251 = v282 * 90.0;
      v252 = v81 * 90.0;
      v82 = *(v48 - 5) - 1.5707964;
      v278 = cos(v82);
      v274 = v278 * 9.0;
      v253 = *v74 - v274;
      v254 = *(v48 - 2) - sin(v82) * 9.0;
      v83 = fx_spawn_sprite((int *)&v253, &v251, 1096810496);
      v48[2] = 0.059999999;
      sprite_effect_color_a[11 * v83] = 1048576000;
    }
    result = creature_find_in_radius(v48 - 3, 8.0, 0);
    v84 = result;
    if ( result == -1 )
      goto LABEL_205;
    v85 = 152 * result;
    if ( creature_hitbox_size[38 * result] == 1098907648 )
      ++highscore_record_shots_hit;
    if ( bonus_freeze_timer <= 0.0 )
    {
      v287 = (float)(crt_rand() % 20 - 10);
      v86 = crt_rand();
      v259 = v287 + *((float *)&creature_pos_x + 38 * v84);
      v260 = (double)(v86 % 20 - 10) + creature_pos_y[38 * v84];
      fx_queue_add_random(&v259);
      v280 = (float)(crt_rand() % 20 - 10);
      v87 = crt_rand();
      v263 = v280 + *((float *)&creature_pos_x + 38 * v84);
      v264 = (double)(v87 % 20 - 10) + creature_pos_y[38 * v84];
      fx_queue_add_random(&v263);
      v284 = (float)(crt_rand() % 20 - 10);
      v88 = crt_rand();
      v267 = v284 + *((float *)&creature_pos_x + 38 * v84);
      v268 = (double)(v88 % 20 - 10) + creature_pos_y[38 * v84];
      fx_queue_add_random(&v267);
    }
    else
    {
      v220 = 4;
      do
      {
        v209 = (double)(crt_rand() % 612) * 0.0099999998;
        effect_spawn_freeze_shard((int)(v48 - 3), v209);
        --v220;
      }
      while ( v220 );
    }
    v89 = *((_DWORD *)v48 + 1);
    v233 = 150.0;
    switch ( v89 )
    {
      case 1:
        v233 = *(v48 - 4) * 50.0 + 500.0;
        if ( config_detail_preset >= 3 )
          effect_spawn_explosion_burst((int)(v48 - 3), 0.40000001);
        goto LABEL_175;
      case 2:
        v90 = *(v48 - 4) * 20.0 + 80.0;
        break;
      case 4:
        v90 = *(v48 - 4) * 20.0 + 40.0;
        break;
      default:
        goto LABEL_175;
    }
    v233 = v90;
LABEL_175:
    if ( demo_mode_active || byte_4CC8D4 || config_game_mode == 2 )
      sfx_play_panned(sfx_explosion_medium, (int)(v48 - 3), 1.0);
    else
      sfx_play_exclusive(music_track_extra_0);
    v91 = 1.0 / frame_dt;
    creature_state_flag[152 * v84] = 1;
    *(float *)&v257 = v91 * *(v48 - 1);
    v258 = v91 * *v48;
    creature_apply_damage(v84, v233, 3, (float *)&v257);
    v92 = *((_DWORD *)v48 + 1);
    switch ( v92 )
    {
      case 1:
        v93 = bonus_freeze_timer < 0.0;
        v94 = bonus_freeze_timer == 0.0;
        *((_DWORD *)v48 + 1) = 3;
        *(v48 - 1) = 0.0;
        *v48 = 1.0;
        if ( v93 || v94 )
        {
          v96 = 20;
          do
          {
            v223 = (double)(crt_rand() % 628) * 0.0099999998;
            v97 = (double)(crt_rand() % 90);
            v273 = cos(v223) * v97;
            *(float *)&v265 = v273 + *(float *)(v85 + 4833100);
            v266 = v97 * sin(v223) + *(float *)(v85 + 4833104);
            fx_queue_add_random(&v265);
            --v96;
          }
          while ( v96 );
        }
        else
        {
          v95 = 8;
          do
          {
            v210 = (double)(crt_rand() % 612) * 0.0099999998;
            effect_spawn_freeze_shard((int)(v48 - 3), v210);
            --v95;
          }
          while ( v95 );
        }
        break;
      case 2:
        v98 = bonus_freeze_timer < 0.0;
        v99 = bonus_freeze_timer == 0.0;
        *((_DWORD *)v48 + 1) = 3;
        *(v48 - 1) = 0.0;
        *v48 = 0.34999999;
        if ( v98 || v99 )
        {
          v101 = 10;
          do
          {
            v224 = (double)(crt_rand() % 628) * 0.0099999998;
            v102 = (double)(crt_rand() % 64);
            v231 = cos(v224) * v102;
            *(float *)&v261 = v231 + *(float *)(v85 + 4833100);
            v262 = v102 * sin(v224) + *(float *)(v85 + 4833104);
            fx_queue_add_random(&v261);
            --v101;
          }
          while ( v101 );
        }
        else
        {
          v100 = 8;
          do
          {
            v211 = (double)(crt_rand() % 612) * 0.0099999998;
            effect_spawn_freeze_shard((int)(v48 - 3), v211);
            --v100;
          }
          while ( v100 );
        }
        break;
      case 4:
        v103 = bonus_freeze_timer < 0.0;
        v104 = bonus_freeze_timer == 0.0;
        *((_DWORD *)v48 + 1) = 3;
        *(v48 - 1) = 0.0;
        *v48 = 0.25;
        if ( v103 || v104 )
        {
          v107 = 3;
          do
          {
            v225 = (double)(crt_rand() % 628) * 0.0099999998;
            v108 = (double)(crt_rand() % 44);
            v239 = cos(v225) * v108;
            v276 = v239 + *(float *)(v85 + 4833100);
            v277 = v108 * sin(v225) + *(float *)(v85 + 4833104);
            fx_queue_add_random(&v276);
            --v107;
          }
          while ( v107 );
        }
        else
        {
          v105 = (char *)&creature_pos_x + v85;
          v106 = 8;
          do
          {
            v212 = (double)(crt_rand() % 612) * 0.0099999998;
            effect_spawn_freeze_shard((int)v105, v212);
            --v106;
          }
          while ( v106 );
        }
        break;
    }
    v109 = 0;
    v221 = 0;
    do
    {
      v110 = (double)(crt_rand() % 800) * 0.1;
      v111 = (double)v221 * 0.62831855;
      v269 = cos(v111);
      v285 = v110 * v269;
      v286 = sin(v111) * v110;
      result = fx_spawn_sprite((int *)v48 - 3, (int *)&v285, 1096810496);
      v221 = ++v109;
      sprite_effect_color_a[11 * result] = 1052602532;
    }
    while ( v109 < 10 );
LABEL_205:
    v113 = *(v48 - 4);
    v114 = v113 < 0.0;
    v115 = 0;
    v116 = v113 == 0.0;
    BYTE1(result) = v112;
    if ( v113 <= 0.0 )
    {
      *((_DWORD *)v48 + 1) = 3;
      *(v48 - 1) = 0.0;
      *v48 = 0.5;
    }
LABEL_207:
    v48 += 11;
  }
  while ( (int)v48 < (int)flt_4965F0 );
  v117 = (float *)sprite_effect_pos_y;
  do
  {
    if ( *((_BYTE *)v117 - 28) )
    {
      v269 = frame_dt * v117[1];
      v118 = frame_dt * v117[2];
      *(v117 - 1) = v269 + *(v117 - 1);
      *v117 = v118 + *v117;
      *(v117 - 2) = frame_dt * 3.0 + *(v117 - 2);
      v119 = *(v117 - 3) - frame_dt;
      *(v117 - 3) = v119;
      v121 = v119 < 0.0;
      v122 = 0;
      v123 = v119 == 0.0;
      BYTE1(result) = v120;
      if ( v119 <= 0.0 )
        *((_BYTE *)v117 - 28) = 0;
      v117[3] = frame_dt * 60.0 + v117[3];
    }
    v117 += 11;
  }
  while ( (int)v117 < (int)flt_49AA3C );
  v226 = 0;
  v124 = (struct _SYSTEMTIME *)&particle_vel_y;
  while ( 2 )
  {
    LOBYTE(result) = v124[-1].wYear;
    if ( (_BYTE)result )
    {
      v125 = frame_dt;
      if ( LOBYTE(v124[2].wYear) == 8 )
      {
        *(float *)&v124[1].wDayOfWeek = *(float *)&v124[1].wDayOfWeek - v125 * 0.11;
        *(float *)&v124[1].wSecond = frame_dt * 5.0 + *(float *)&v124[1].wSecond;
        if ( !HIBYTE(v124[-1].wYear) )
          goto LABEL_225;
        v126 = frame_dt;
        v128 = frame_dt * *(float *)&v124[-1].wSecond;
        if ( !(v129 | v130) )
        {
          v269 = v128;
          v131 = v126 * *(float *)&v124->wYear;
          v132 = *(float *)&v124[1].wDayOfWeek;
          *(float *)&v249 = v269 * v132;
          v250 = v131 * v132;
          result = FUN_0041e270((float *)&v124[-1].wDayOfWeek, (float *)&v249);
          goto LABEL_225;
        }
        v282 = v128;
        v133 = v126 * *(float *)&v124->wYear;
        v278 = v282 * 0.55000001;
        v134 = *(float *)&v124[1].wDayOfWeek;
        v274 = v278 * v134;
        v135 = v133 * 0.55000001 * v134;
        v136 = v274;
LABEL_224:
        *(float *)&v124[-1].wDayOfWeek = v136 + *(float *)&v124[-1].wDayOfWeek;
        *(float *)&v124[-1].wHour = v135 + *(float *)&v124[-1].wHour;
      }
      else
      {
        *(float *)&v124[1].wDayOfWeek = *(float *)&v124[1].wDayOfWeek - v125 * 0.89999998;
        *(float *)&v124[1].wSecond = frame_dt + *(float *)&v124[1].wSecond;
        v137 = frame_dt;
        v139 = frame_dt * *(float *)&v124[-1].wSecond;
        if ( v140 | v141 )
        {
          v284 = v139;
          v144 = v137 * *(float *)&v124->wYear;
          v273 = v284 * 2.5;
          v259 = v273 * 0.15000001;
          v135 = v144 * 2.5 * 0.15000001;
          v136 = v259;
          goto LABEL_224;
        }
        v287 = v139;
        v142 = v137 * *(float *)&v124->wYear;
        v280 = v287 * 2.5;
        v143 = *(float *)&v124[1].wDayOfWeek;
        *(float *)&v255 = v280 * v143;
        v256 = v142 * 2.5 * v143;
        result = FUN_0041e270((float *)&v124[-1].wDayOfWeek, (float *)&v255);
      }
LABEL_225:
      wYear = v124[2].wYear;
      v147 = *(float *)&v124[1].wDayOfWeek;
      if ( wYear )
      {
        v151 = v147 < 0.80000001;
        v152 = 0;
        v153 = v147 == 0.80000001;
        BYTE1(result) = HIBYTE(v146);
        if ( v147 > 0.80000001 )
          goto LABEL_234;
        LOBYTE(v124[-1].wYear) = 0;
        LOBYTE(result) = v124[2].wYear;
        if ( (_BYTE)result == 8 )
        {
          result = *(_DWORD *)&v124[2].wDayOfWeek;
          if ( result != -1 )
          {
            v154 = 152 * result;
            if ( creature_pool[v154] )
            {
              v205 = (char *)&creature_pos_x + v154;
              v155 = crt_rand();
              sfx_play_panned(
                *(&creature_type_sfx_a0 + 17 * *(&creature_type_id + 38 * *(_DWORD *)&v124[2].wDayOfWeek) + v155 % 3),
                (int)v205,
                1.0);
            }
            creature_handle_death(*(_DWORD *)&v124[2].wDayOfWeek, 0);
          }
        }
      }
      else
      {
        v148 = v147 < 0.0;
        v149 = 0;
        v150 = v147 == 0.0;
        LOWORD(result) = v146;
        if ( v147 <= 0.0 )
        {
          LOBYTE(v124[-1].wYear) = 0;
          goto LABEL_280;
        }
LABEL_234:
        if ( HIBYTE(v124[-1].wYear) == 1 )
        {
          if ( !wYear )
          {
            v156 = crt_rand();
            v157 = v156 % 100;
            result = v156 / 100;
            v158 = (double)(v157 - 50) * 0.059999999 * *(float *)&v124[1].wDayOfWeek * frame_dt * 1.96;
            goto LABEL_240;
          }
          if ( wYear == 8 )
          {
            v159 = crt_rand();
            v160 = v159 % 100;
            result = v159 / 100;
            v161 = *(float *)&v124[1].wHour
                 - (double)(v160 - 50) * 0.059999999 * *(float *)&v124[1].wDayOfWeek * frame_dt * 1.1;
            *(float *)&v124[1].wHour = v161;
            *(float *)&v124[-1].wSecond = cos(v161) * 62.0;
            v162 = sin(*(float *)&v124[1].wHour) * 62.0;
          }
          else
          {
            v163 = crt_rand();
            v164 = v163 % 100;
            result = v163 / 100;
            v158 = (double)(v164 - 50) * 0.059999999 * *(float *)&v124[1].wDayOfWeek * frame_dt * 1.1;
LABEL_240:
            v165 = *(float *)&v124[1].wHour - v158;
            *(float *)&v124[1].wHour = v165;
            *(float *)&v124[-1].wSecond = cos(v165) * 82.0;
            v162 = sin(*(float *)&v124[1].wHour) * 82.0;
          }
          *(float *)&v124->wYear = v162;
        }
        v167 = *(float *)&v124[1].wDayOfWeek;
        v168 = v167 < 1.0;
        v169 = 0;
        v170 = v167 == 1.0;
        BYTE1(result) = v166;
        if ( v167 <= 1.0 )
          v171 = *(float *)&v124[1].wDayOfWeek;
        else
          v171 = 1.0;
        *(float *)&v124[1].wYear = v171;
        v172 = 1.0 - *(float *)&v124[1].wDayOfWeek * 0.94999999;
        *(float *)&v124->wDayOfWeek = v172;
        *(float *)&v124->wHour = v172;
        LOBYTE(result) = HIBYTE(v124[-1].wYear);
        if ( (_BYTE)result )
        {
          p_wDayOfWeek = (float *)&v124[-1].wDayOfWeek;
          v206 = *(float *)&v124[1].wDayOfWeek * 8.0;
          result = creature_find_in_radius((float *)&v124[-1].wDayOfWeek, v206, 0);
          v174 = result;
          if ( result != -1 )
          {
            HIBYTE(v124[-1].wYear) = 0;
            if ( LOBYTE(v124[2].wYear) == 8 )
            {
              result *= 152;
              v175 = creature_pos_y[38 * v174];
              *(_DWORD *)p_wDayOfWeek = *(&creature_pos_x + 38 * v174);
              p_wDayOfWeek[1] = v175;
              *(_DWORD *)&v124[-1].wSecond = 0;
              *(_DWORD *)&v124->wYear = 0;
              creature_state_flag[152 * v174] = 0;
              *(_DWORD *)&v124[2].wDayOfWeek = v174;
            }
            else
            {
              if ( *(float *)&v124[1].wHour > 6.2831855 )
              {
                do
                {
                  v176 = *(float *)&v124[1].wHour - 6.2831855;
                  *(float *)&v124[1].wHour = v176;
                }
                while ( v176 > 6.2831855 );
              }
              if ( *(float *)&v124[1].wHour < 0.0 )
              {
                do
                {
                  v177 = *(float *)&v124[1].wHour + 6.2831855;
                  *(float *)&v124[1].wHour = v177;
                }
                while ( v177 < 0.0 );
              }
              v263 = frame_dt * *(float *)&v124[-1].wSecond;
              v178 = frame_dt * *(float *)&v124->wYear;
              v267 = *p_wDayOfWeek - v263;
              v179 = (float *)(&creature_pos_x + 38 * result);
              v180 = *(float *)&v124[-1].wHour - v178;
              *(float *)&v257 = v267 - *v179;
              for ( j = atan2(v180 - v179[1], *(float *)&v257); j > 6.2831855; j = j - 6.2831855 )
                ;
              for ( ; j < 0.0; j = j + 6.2831855 )
                ;
              v183 = *(float *)&v124[1].wHour;
              if ( v184 )
                v185 = v183 - 1.2566371;
              else
                v185 = v183 + 1.2566371;
              *(float *)&v124[1].wHour = v185;
              *(float *)&v124[-1].wSecond = cos(*(float *)&v124[1].wHour) * 82.0;
              *(float *)&v124->wYear = sin(*(float *)&v124[1].wHour) * 82.0;
              v186 = crt_rand();
              creature_state_flag[152 * v174] = 1;
              *(float *)&v251 = 0.0;
              v252 = 0.0;
              v187 = (double)(v186 % 10) * 0.1;
              *(float *)&v124[-1].wSecond = v187 * *(float *)&v124[-1].wSecond;
              *(float *)&v124->wYear = v187 * *(float *)&v124->wYear;
              v197 = *(float *)&v124[1].wDayOfWeek * 10.0;
              creature_apply_damage(v174, v197, 4, (float *)&v251);
              if ( *(float *)&creature_tint_g[38 * v174]
                 + *(float *)&creature_tint_b[38 * v174]
                 + *((float *)&creature_tint_r + 38 * v174) > 1.6 )
              {
                v188 = 1.0 - *(float *)&v124[1].wDayOfWeek * 0.0099999998;
                *((float *)&creature_tint_r + 38 * v174) = v188 * *((float *)&creature_tint_r + 38 * v174);
                *(float *)&creature_tint_g[38 * v174] = v188 * *(float *)&creature_tint_g[38 * v174];
                *(float *)&creature_tint_b[38 * v174] = v188 * *(float *)&creature_tint_b[38 * v174];
                if ( *((float *)&creature_tint_r + 38 * v174) >= 0.0 )
                {
                  if ( *((float *)&creature_tint_r + 38 * v174) > 1.0 )
                    *(&creature_tint_r + 38 * v174) = 1065353216;
                }
                else
                {
                  *(&creature_tint_r + 38 * v174) = 0;
                }
                if ( *(float *)&creature_tint_g[38 * v174] >= 0.0 )
                {
                  if ( *(float *)&creature_tint_g[38 * v174] > 1.0 )
                    creature_tint_g[38 * v174] = 1065353216;
                }
                else
                {
                  creature_tint_g[38 * v174] = 0;
                }
                if ( *(float *)&creature_tint_b[38 * v174] >= 0.0 )
                {
                  if ( *(float *)&creature_tint_b[38 * v174] > 1.0 )
                    creature_tint_b[38 * v174] = 1065353216;
                }
                else
                {
                  creature_tint_b[38 * v174] = 0;
                }
                if ( *(float *)&creature_tint_a[38 * v174] >= 0.0 )
                {
                  if ( *(float *)&creature_tint_a[38 * v174] > 1.0 )
                    creature_tint_a[38 * v174] = 1065353216;
                }
                else
                {
                  creature_tint_a[38 * v174] = 0;
                }
              }
              if ( !(v226 % 3) )
              {
                v243 = crt_rand() % 60 - 30;
                v189 = crt_rand();
                v253 = (float)v243;
                v254 = (float)(v189 % 60 - 30);
                sprite_effect_color_a[11 * fx_spawn_sprite(&creature_pos_x + 38 * v174, (int *)&v253, 1095761920)] = 1060320051;
              }
              fx_queue_add_random(&creature_pos_x + 38 * v174);
              v190 = *(float *)&v124[-1].wSecond;
              result = LODWORD(frame_dt);
              v266 = *(float *)&v124->wYear;
              v262 = v266 * frame_dt;
              *v179 = v190 * frame_dt + *v179;
              v179[1] = v262 + v179[1];
            }
          }
        }
      }
    }
LABEL_280:
    v124 = (struct _SYSTEMTIME *)((char *)v124 + 56);
    ++v226;
    if ( (int)v124 < (int)&local_system_time )
      continue;
    return result;
  }
}

// projectile_render @ 0x00422C70
// renders projectiles/secondary projectiles and related beam/trail effects
char __cdecl sub_422C70(float a1, float a2, int a3, float a4)
{
  int v4; // edx
  int v5; // edx
  int v6; // edi
  float *v7; // esi
  long double v8; // st7
  float v9; // ecx
  long double v10; // st7
  long double v11; // st7
  double v12; // st6
  double v13; // st6
  int v14; // eax
  char *v15; // esi
  int v16; // eax
  int v17; // edx
  int v18; // eax
  double v19; // st7
  double v20; // st6
  float v21; // eax
  float v22; // edx
  float v23; // edi
  double v24; // st7
  float v25; // ebx
  double v26; // st6
  double v27; // st7
  double v28; // st7
  float v29; // ecx
  double v30; // st7
  double v31; // st5
  double v32; // st5
  double v33; // st7
  double v34; // st5
  double v35; // st5
  double v36; // st7
  double v37; // st5
  double v38; // st5
  double v39; // st7
  long double v40; // st7
  int v41; // eax
  int v42; // edx
  _DWORD *v43; // esi
  int v44; // eax
  double v45; // st6
  double v46; // st4
  int v47; // ebx
  long double v48; // st7
  int v49; // edx
  float v50; // edi
  double v51; // st7
  int v52; // eax
  int v53; // edx
  double v54; // st7
  int v55; // eax
  int v56; // edx
  double v57; // st6
  double v58; // st4
  int v59; // ebx
  long double v60; // st7
  int v61; // edx
  float v62; // edi
  double v63; // st7
  int v64; // eax
  double v65; // st7
  int v66; // edx
  int v67; // eax
  double v68; // st6
  double v69; // st5
  int v70; // ebx
  long double v71; // st7
  int v72; // edx
  float v73; // edi
  double v74; // st7
  int v75; // eax
  int v76; // edx
  double v77; // st7
  int v78; // eax
  double v79; // st7
  int v80; // eax
  double v81; // st6
  double v82; // st5
  int v83; // ebx
  long double v84; // st7
  int v85; // edx
  float v86; // edi
  double v87; // st7
  int v88; // eax
  double v89; // st7
  int v90; // edx
  double v91; // st6
  double v92; // st5
  int v93; // ebx
  long double v94; // st7
  int v95; // edx
  float v96; // edi
  double v97; // st7
  int v98; // eax
  double v99; // st7
  int v100; // edx
  double v101; // st7
  int v102; // edx
  double v103; // st7
  double v104; // st7
  int v105; // eax
  double v106; // st7
  float v107; // ebp
  _DWORD *v108; // ebx
  char v109; // al
  float v110; // edi
  int v111; // eax
  double v112; // st6
  double v113; // st5
  int v114; // eax
  int v115; // edx
  int v116; // edx
  double v117; // st7
  float v118; // eax
  double v119; // st6
  double v120; // st7
  int v121; // edx
  double v122; // st7
  int v123; // eax
  double v124; // st6
  double v125; // st5
  long double v126; // st7
  int v127; // eax
  double v128; // st6
  double v129; // st5
  long double v130; // st7
  int v131; // eax
  double v132; // st7
  double v133; // st7
  double v134; // st7
  int v135; // edx
  int v136; // eax
  int v137; // edx
  double v138; // st7
  int v139; // edx
  double v140; // st7
  double v141; // st7
  double v142; // st7
  double v143; // st7
  int v144; // eax
  double v145; // st7
  int v146; // edx
  int v147; // eax
  int v148; // edx
  double v149; // st7
  int v150; // eax
  float v151; // edi
  double v152; // st7
  float *v153; // ebp
  int v154; // edx
  bool v155; // zf
  int v156; // edi
  double v157; // st7
  double v158; // st7
  double v159; // st6
  int v160; // eax
  double v161; // st7
  int v162; // eax
  double v163; // st7
  int v164; // edx
  int v165; // eax
  float *v166; // esi
  double v167; // st7
  int v168; // eax
  long double v169; // st7
  int v170; // edx
  long double v171; // st7
  int v172; // eax
  long double v173; // st7
  long double v174; // st7
  int v175; // edx
  long double v176; // st7
  int v177; // eax
  double v178; // st7
  int v179; // edx
  int v180; // edx
  double v181; // st7
  char *v182; // esi
  double v183; // st7
  double v184; // st6
  int v185; // eax
  int v186; // edx
  float *v187; // esi
  int v188; // eax
  int v189; // eax
  double v190; // st7
  double v191; // st6
  int v192; // edx
  float v193; // eax
  double v194; // st7
  double v195; // st6
  float *v196; // esi
  int v197; // edx
  long double v198; // st7
  int v199; // eax
  double v200; // st6
  float *v201; // esi
  int v202; // eax
  double v203; // st7
  double v204; // st6
  int v205; // edx
  int v206; // eax
  float v207; // edx
  double v208; // st7
  double v209; // st6
  int v210; // eax
  double v211; // st7
  double v212; // st6
  int v213; // edx
  char result; // al
  float *v215; // esi
  int v216; // eax
  int v217; // eax
  long double v218; // st7
  int v219; // edx
  double v220; // st6
  float v221; // eax
  int v222; // edx
  long double v223; // st7
  int v224; // eax
  double v225; // st6
  int v226; // eax
  long double v227; // st7
  double v228; // st6
  float v229[3]; // [esp+4ACh] [ebp-1BCh] BYREF
  float v230; // [esp+4B8h] [ebp-1B0h]
  float v231; // [esp+4BCh] [ebp-1ACh]
  int v232; // [esp+4C0h] [ebp-1A8h]
  float v233; // [esp+4C4h] [ebp-1A4h]
  float v234; // [esp+4C8h] [ebp-1A0h]
  float v235; // [esp+4CCh] [ebp-19Ch]
  float v236; // [esp+4D0h] [ebp-198h]
  float v237; // [esp+4D4h] [ebp-194h]
  float v238; // [esp+4D8h] [ebp-190h]
  float v239; // [esp+4DCh] [ebp-18Ch]
  float v240; // [esp+4E0h] [ebp-188h]
  float v241; // [esp+4E4h] [ebp-184h]
  float v242; // [esp+4E8h] [ebp-180h]
  float v243; // [esp+4ECh] [ebp-17Ch]
  int v244; // [esp+4F0h] [ebp-178h]
  float v245; // [esp+4F4h] [ebp-174h]
  float v246; // [esp+4F8h] [ebp-170h]
  float v247; // [esp+4FCh] [ebp-16Ch]
  float v248; // [esp+500h] [ebp-168h]
  float v249; // [esp+504h] [ebp-164h]
  float v250; // [esp+508h] [ebp-160h]
  float v251; // [esp+50Ch] [ebp-15Ch]
  float v252; // [esp+510h] [ebp-158h] BYREF
  float v253; // [esp+514h] [ebp-154h]
  float v254; // [esp+518h] [ebp-150h]
  float v255; // [esp+51Ch] [ebp-14Ch]
  float v256; // [esp+520h] [ebp-148h]
  float v257; // [esp+524h] [ebp-144h]
  float v258; // [esp+528h] [ebp-140h]
  float v259; // [esp+52Ch] [ebp-13Ch]
  float v260; // [esp+530h] [ebp-138h]
  float v261; // [esp+534h] [ebp-134h]
  float v262; // [esp+538h] [ebp-130h]
  float v263; // [esp+53Ch] [ebp-12Ch]
  float v264; // [esp+540h] [ebp-128h]
  float v265; // [esp+544h] [ebp-124h]
  float v266; // [esp+548h] [ebp-120h]
  float v267; // [esp+54Ch] [ebp-11Ch]
  float v268; // [esp+550h] [ebp-118h]
  float v269; // [esp+554h] [ebp-114h]
  float v270; // [esp+558h] [ebp-110h]
  float v271; // [esp+55Ch] [ebp-10Ch]
  float v272; // [esp+560h] [ebp-108h]
  float v273; // [esp+564h] [ebp-104h]
  float v274; // [esp+568h] [ebp-100h]
  float v275; // [esp+56Ch] [ebp-FCh]
  float v276; // [esp+570h] [ebp-F8h]
  float v277; // [esp+574h] [ebp-F4h]
  float v278; // [esp+578h] [ebp-F0h]
  float v279; // [esp+57Ch] [ebp-ECh]
  float v280; // [esp+580h] [ebp-E8h]
  float v281; // [esp+584h] [ebp-E4h]
  float v282; // [esp+58Ch] [ebp-DCh]
  float v283; // [esp+590h] [ebp-D8h]
  float v284; // [esp+594h] [ebp-D4h]
  float v285; // [esp+598h] [ebp-D0h]
  float v286; // [esp+59Ch] [ebp-CCh]
  float v287; // [esp+5A0h] [ebp-C8h]
  float v288; // [esp+5A4h] [ebp-C4h]
  float v289; // [esp+5A8h] [ebp-C0h]
  float v290; // [esp+5ACh] [ebp-BCh]
  float v291; // [esp+5B0h] [ebp-B8h]
  float v292; // [esp+5B4h] [ebp-B4h]
  float v293; // [esp+5B8h] [ebp-B0h]
  float v294; // [esp+5BCh] [ebp-ACh]
  float v295; // [esp+5C4h] [ebp-A4h]
  float v296; // [esp+5CCh] [ebp-9Ch]
  float v297; // [esp+5D4h] [ebp-94h]
  float v298; // [esp+5DCh] [ebp-8Ch]
  float v299; // [esp+5E4h] [ebp-84h]
  float v300; // [esp+5E8h] [ebp-80h]
  float v301; // [esp+5ECh] [ebp-7Ch]
  float v302; // [esp+5F0h] [ebp-78h]
  float v303; // [esp+5F4h] [ebp-74h]
  float v304; // [esp+5F8h] [ebp-70h]
  float v305; // [esp+5FCh] [ebp-6Ch]
  float v306; // [esp+600h] [ebp-68h]
  float v307; // [esp+604h] [ebp-64h]
  float v308; // [esp+60Ch] [ebp-5Ch]
  float v309; // [esp+614h] [ebp-54h]
  float v310; // [esp+61Ch] [ebp-4Ch]
  float v311; // [esp+624h] [ebp-44h]
  float v312; // [esp+634h] [ebp-34h]
  float v313; // [esp+63Ch] [ebp-2Ch]
  float v314; // [esp+644h] [ebp-24h]
  float v315; // [esp+64Ch] [ebp-1Ch]
  float v316; // [esp+654h] [ebp-14h]
  float v317; // [esp+65Ch] [ebp-Ch]
  float v318; // [esp+664h] [ebp-4h]

  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  v4 = *(_DWORD *)grim_interface_ptr;
  v239 = a1 * 0.5;
  (*(void (__thiscall **)(int, int, _DWORD, _DWORD, float))(v4 + 276))(
    grim_interface_ptr,
    1065353216,
    0,
    0,
    COERCE_FLOAT(LODWORD(v239)));
  v5 = *(_DWORD *)grim_interface_ptr;
  v236 = a1 * 0.2;
  (*(void (__thiscall **)(int, int, _DWORD, _DWORD, _DWORD, float))(v5 + 280))(
    grim_interface_ptr,
    2,
    0,
    0,
    0,
    COERCE_FLOAT(LODWORD(v236)));
  (*(void (__thiscall **)(int, int, _DWORD, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 280))(
    grim_interface_ptr,
    3,
    0,
    0,
    0,
    COERCE_FLOAT(LODWORD(v236)));
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
    grim_interface_ptr,
    bullet_trail_texture,
    0);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1056964608);
  v6 = 0;
  if ( config_player_count > 0 )
  {
    v7 = (float *)player_aim_heading;
    do
    {
      if ( *(v7 - 183) > 0.0 )
      {
        v8 = *v7 - 1.5707964;
        v9 = *(v7 - 186);
        v248 = *(v7 - 187);
        v249 = v9;
        v243 = sin(v8);
        v265 = v243 * 512.0;
        v278 = cos(v8) * 512.0 + *(v7 - 187);
        v279 = v265 + *(v7 - 186);
        v10 = v8 - 0.150915;
        v262 = cos(v10) * 15.0;
        v248 = v248 + v262;
        v249 = v9 + sin(v10) * 15.0;
        v11 = cos(*v7) * 1.1;
        v275 = sin(*v7) * 1.1;
        v12 = v248 + *(float *)&camera_offset_x;
        v236 = v249 + *(float *)&camera_offset_y;
        v294 = v236;
        v301 = v236;
        v254 = v12 - v11;
        v255 = v236 - v275;
        v268 = v12 + v11;
        v269 = v236 + v275;
        v13 = v278 + *(float *)&camera_offset_x;
        v236 = v279 + *(float *)&camera_offset_y;
        v259 = v236;
        v247 = v236;
        v14 = (int)*(&player_perk_counts + perk_id_sharpshooter);
        v266 = v13 + v11;
        v267 = v236 + v275;
        v270 = v13 - v11;
        v271 = v236 - v275;
        if ( v14 > 0 )
        {
          (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
            grim_interface_ptr,
            20,
            2,
            LODWORD(v229[1]),
            LODWORD(v229[2]),
            COERCE_FLOAT(LODWORD(v230)));
          (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
          (*(void (__thiscall **)(int, float, float, float, float, float, float, float, float))(*(_DWORD *)grim_interface_ptr
                                                                                              + 312))(
            grim_interface_ptr,
            COERCE_FLOAT(LODWORD(v254)),
            COERCE_FLOAT(LODWORD(v255)),
            COERCE_FLOAT(LODWORD(v268)),
            COERCE_FLOAT(LODWORD(v269)),
            COERCE_FLOAT(LODWORD(v266)),
            COERCE_FLOAT(LODWORD(v267)),
            COERCE_FLOAT(LODWORD(v270)),
            COERCE_FLOAT(LODWORD(v271)));
          (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
          (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
            grim_interface_ptr,
            20,
            6,
            LODWORD(v229[1]),
            LODWORD(v229[2]),
            COERCE_FLOAT(LODWORD(v230)));
        }
      }
      ++v6;
      v7 += 216;
    }
    while ( v6 < config_player_count );
  }
  v236 = 0.0;
  (*(void (__thiscall **)(int, _DWORD, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 280))(
    grim_interface_ptr,
    0,
    1056964608,
    1056964608,
    1056964608,
    0);
  (*(void (__thiscall **)(int, int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 280))(
    grim_interface_ptr,
    1,
    1056964608,
    1056964608,
    1056964608,
    0);
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    2,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  v15 = (char *)&projectile_vel_y;
  do
  {
    if ( *(v15 - 28) )
    {
      v16 = *((_DWORD *)v15 + 1);
      if ( v16 <= 7 || v16 == 29 )
      {
        if ( !v16 )
          *(v15 - 28) = 0;
        v312 = *((float *)v15 + 2);
        if ( v312 <= 1.0 )
        {
          if ( v312 < 0.0 )
            v312 = 0.0;
        }
        else
        {
          v312 = 1.0;
        }
        v17 = *(_DWORD *)grim_interface_ptr;
        v236 = v312 * a1;
        (*(void (__thiscall **)(int, int, int, int, int, float))(v17 + 280))(
          grim_interface_ptr,
          2,
          1056964608,
          1056964608,
          1056964608,
          COERCE_FLOAT(LODWORD(v236)));
        (*(void (__thiscall **)(int, int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 280))(
          grim_interface_ptr,
          3,
          1056964608,
          1056964608,
          1056964608,
          COERCE_FLOAT(LODWORD(v236)));
        v18 = *((_DWORD *)v15 + 1);
        switch ( v18 )
        {
          case 2:
            v19 = *(float *)&camera_offset_x + *((float *)v15 - 3);
            v235 = *(float *)&camera_offset_y + *((float *)v15 - 2);
            v317 = v235;
            v20 = v19 - *((float *)v15 - 1);
            v314 = v235;
            v274 = v20;
            v21 = v274;
            v275 = v235 - *(float *)v15;
            v22 = v275;
            v278 = v19 + *((float *)v15 - 1);
            v23 = v278;
            v279 = v235 + *(float *)v15;
            v24 = *(float *)&camera_offset_x + *((float *)v15 - 5);
            v25 = v279;
            v235 = *(float *)&camera_offset_y + *((float *)v15 - 4);
            v316 = v235;
            v270 = v24 + *((float *)v15 - 1);
            v26 = v235 + *(float *)v15;
            v246 = v270;
            v271 = v26;
            v27 = v24 - *((float *)v15 - 1);
            v247 = v271;
            v315 = v235;
            v266 = v27;
            v28 = v235 - *(float *)v15;
            v258 = v266;
            v267 = v28;
            v29 = v267;
            break;
          case 1:
            v30 = *((float *)v15 - 1) * 1.2;
            v268 = v30;
            v245 = *(float *)v15 * 1.2;
            v269 = v245;
            v31 = *(float *)&camera_offset_x + *((float *)v15 - 3);
            v235 = *(float *)&camera_offset_y + *((float *)v15 - 2);
            v313 = v235;
            v318 = v235;
            v311 = v245;
            v248 = v31 - v268;
            v21 = v248;
            v249 = v235 - v245;
            v22 = v249;
            v254 = v30;
            v255 = v245;
            v283 = v31 + v254;
            v23 = v283;
            v284 = v235 + v245;
            v25 = v284;
            v32 = *(float *)&camera_offset_x + *((float *)v15 - 5);
            *(float *)&v244 = v32;
            v235 = *(float *)&camera_offset_y + *((float *)v15 - 4);
            v308 = v235;
            v291 = v32 + v30;
            v246 = v291;
            v292 = v235 + v245;
            v247 = v292;
            v309 = v245;
            v256 = *(float *)&v244 - v30;
            v310 = v235;
            v258 = v256;
            v257 = v235 - v245;
            v29 = v257;
            break;
          case 6:
            (*(void (__thiscall **)(int, int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 280))(
              grim_interface_ptr,
              2,
              1045220557,
              1056964608,
              1065353216,
              COERCE_FLOAT(LODWORD(v312)));
            (*(void (__thiscall **)(int, int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 280))(
              grim_interface_ptr,
              3,
              1045220557,
              1056964608,
              1065353216,
              COERCE_FLOAT(LODWORD(v312)));
            v33 = *((float *)v15 - 1) * 1.1;
            v289 = v33;
            v245 = *(float *)v15 * 1.1;
            v290 = v245;
            v34 = *(float *)&camera_offset_x + *((float *)v15 - 3);
            v235 = *(float *)&camera_offset_y + *((float *)v15 - 2);
            v297 = v235;
            v298 = v235;
            v296 = v245;
            v287 = v34 - v289;
            v21 = v287;
            v288 = v235 - v245;
            v22 = v288;
            v250 = v33;
            v251 = v245;
            v272 = v34 + v250;
            v23 = v272;
            v273 = v235 + v245;
            v25 = v273;
            v35 = *(float *)&camera_offset_x + *((float *)v15 - 5);
            *(float *)&v244 = v35;
            v235 = *(float *)&camera_offset_y + *((float *)v15 - 4);
            v295 = v235;
            v260 = v35 + v33;
            v246 = v260;
            v261 = v235 + v245;
            v247 = v261;
            v299 = v245;
            v305 = v235;
            v237 = *(float *)&v244 - v33;
            v258 = v237;
            v238 = v235 - v245;
            v29 = v238;
            break;
          default:
            v36 = *((float *)v15 - 1) * 0.69999999;
            v240 = v36;
            v245 = *(float *)v15 * 0.69999999;
            v241 = v245;
            v37 = *(float *)&camera_offset_x + *((float *)v15 - 3);
            v235 = *(float *)&camera_offset_y + *((float *)v15 - 2);
            v303 = v235;
            v307 = v235;
            v282 = v245;
            v300 = v37 - v240;
            v21 = v300;
            v301 = v235 - v245;
            v22 = v301;
            v293 = v36;
            v294 = v245;
            v262 = v37 + v293;
            v23 = v262;
            v263 = v235 + v245;
            v25 = v263;
            v38 = *(float *)&camera_offset_x + *((float *)v15 - 5);
            *(float *)&v244 = v38;
            v235 = *(float *)&camera_offset_y + *((float *)v15 - 4);
            v286 = v235;
            v264 = v38 + v36;
            v246 = v264;
            v265 = v235 + v245;
            v247 = v265;
            v277 = v245;
            v242 = *(float *)&v244 - v36;
            v281 = v235;
            v258 = v242;
            v243 = v235 - v245;
            v29 = v243;
            break;
        }
        (*(void (__thiscall **)(int, float, float, float, float, float, float, float, float))(*(_DWORD *)grim_interface_ptr
                                                                                            + 312))(
          grim_interface_ptr,
          COERCE_FLOAT(LODWORD(v21)),
          COERCE_FLOAT(LODWORD(v22)),
          COERCE_FLOAT(LODWORD(v23)),
          COERCE_FLOAT(LODWORD(v25)),
          COERCE_FLOAT(LODWORD(v246)),
          COERCE_FLOAT(LODWORD(v247)),
          COERCE_FLOAT(LODWORD(v258)),
          COERCE_FLOAT(LODWORD(v29)));
      }
    }
    v15 += 64;
  }
  while ( (int)v15 < (int)particle_scale_z );
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    2,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
    grim_interface_ptr,
    particles_texture,
    0);
  effect_select_texture(13);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  if ( *(float *)&player_muzzle_flash_alpha[216 * render_overlay_player_index] > 0.0 )
  {
    v39 = *(float *)&player_aim_heading[216 * render_overlay_player_index] - 1.5707964;
    v230 = *(float *)&grim_interface_ptr;
    v40 = v39 - 0.150915;
    v41 = *(_DWORD *)grim_interface_ptr;
    v242 = cos(v40) * 15.0;
    v243 = sin(v40) * 15.0;
    v230 = a1 * *(float *)&player_muzzle_flash_alpha[216 * render_overlay_player_index];
    (*(void (__stdcall **)(int, int, int, float))(v41 + 276))(
      1065353216,
      1065353216,
      1065353216,
      COERCE_FLOAT(LODWORD(v230)));
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v230 = 160.0;
    v229[2] = 160.0;
    LODWORD(v229[1]) = grim_interface_ptr;
    v42 = *(_DWORD *)grim_interface_ptr;
    v229[1] = v243 + *(float *)&player_pos_y[216 * render_overlay_player_index] + *(float *)&camera_offset_y - 80.0;
    v229[0] = v242 + *(float *)&player_pos_x[216 * render_overlay_player_index] + *(float *)&camera_offset_x - 80.0;
    (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v42 + 284))(
      LODWORD(v229[0]),
      LODWORD(v229[1]),
      1126170624,
      1126170624);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  }
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v43 = &projectile_pos_y;
  do
  {
    if ( !*((_BYTE *)v43 - 12) )
      goto LABEL_76;
    v44 = v43[5];
    if ( v44 != 9 && v44 != 11 && v44 != 26 && v44 != 24 && v44 != 28 )
      goto LABEL_76;
    if ( v43[6] != 1053609165 )
    {
      v104 = *((float *)v43 + 6) * 2.5;
      if ( v104 <= 1.0 )
      {
        if ( v104 < 0.0 )
          v104 = 0.0;
      }
      else
      {
        v104 = 1.0;
      }
      v105 = *(_DWORD *)grim_interface_ptr;
      v230 = v104 * a1;
      (*(void (__stdcall **)(int, int, int, float))(v105 + 276))(
        1065353216,
        1065353216,
        1065353216,
        COERCE_FLOAT(LODWORD(v230)));
      v106 = *(float *)&camera_offset_y + *(float *)v43;
      v230 = 56.0;
      v229[2] = 56.0;
      LODWORD(v229[1]) = grim_interface_ptr;
      v102 = *(_DWORD *)grim_interface_ptr;
      v229[1] = v106 - 28.0;
      v103 = *(float *)&camera_offset_x + *((float *)v43 - 1) - 28.0;
      goto LABEL_75;
    }
    if ( v44 != 9 )
    {
      if ( v44 == 11 )
      {
        v57 = *((float *)v43 + 2) - *(float *)v43;
        v58 = *((float *)v43 + 1) - *((float *)v43 - 1);
        v59 = (int)(__int64)sqrt(v57 * v57 + v58 * v58) / (int)(__int64)(*((float *)v43 + 8) * 2.0999999);
        if ( v59 > 3 )
          v59 = 3;
        v60 = *((float *)v43 - 2) + 1.5707964;
        v230 = *(float *)&grim_interface_ptr;
        v61 = *(_DWORD *)grim_interface_ptr;
        v250 = cos(v60) * *((float *)v43 + 8) * 2.0999999;
        v235 = sin(v60) * *((float *)v43 + 8) * 2.0999999;
        v230 = a1 * 0.40000001;
        (*(void (__stdcall **)(int, int, int, float))(v61 + 276))(
          1065353216,
          1065353216,
          1065353216,
          COERCE_FLOAT(LODWORD(v230)));
        v62 = 0.0;
        v237 = 0.0;
        if ( v59 > 0 )
        {
          do
          {
            v63 = (double)SLODWORD(v237);
            v230 = 12.0;
            v229[2] = 12.0;
            LODWORD(v229[1]) = grim_interface_ptr;
            v64 = *(_DWORD *)grim_interface_ptr;
            v229[1] = v63 * v235 + *(float *)v43 + *(float *)&camera_offset_y - 6.0;
            LODWORD(v229[0]) = grim_interface_ptr;
            v229[0] = v63 * v250 + *((float *)v43 - 1) + *(float *)&camera_offset_x - 6.0;
            (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v64 + 284))(
              LODWORD(v229[0]),
              LODWORD(v229[1]),
              1094713344,
              1094713344);
            ++LODWORD(v62);
            v237 = v62;
          }
          while ( SLODWORD(v62) < v59 );
        }
        (*(void (__thiscall **)(int, int, int, int, float, float, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          COERCE_FLOAT(LODWORD(v239)),
          COERCE_FLOAT(LODWORD(v231)),
          v232,
          COERCE_FLOAT(LODWORD(v233)));
        v65 = *(float *)&camera_offset_y + *(float *)v43;
        v233 = 16.0;
        v232 = 1098907648;
        v231 = *(float *)&grim_interface_ptr;
        v66 = *(_DWORD *)grim_interface_ptr;
        v231 = v65 - 8.0;
        v230 = *(float *)&camera_offset_x + *((float *)v43 - 1) - 8.0;
        (*(void (__stdcall **)(float, float, int, int))(v66 + 284))(
          COERCE_FLOAT(LODWORD(v230)),
          COERCE_FLOAT(LODWORD(v231)),
          1098907648,
          1098907648);
        v67 = *(_DWORD *)grim_interface_ptr;
        v233 = a4 * 0.15000001;
        v232 = 1065353216;
        v231 = 1.0;
        v230 = 1.0;
      }
      else
      {
        if ( v44 == 28 )
        {
          v68 = *((float *)v43 + 2) - *(float *)v43;
          v69 = *((float *)v43 + 1) - *((float *)v43 - 1);
          v70 = (int)(__int64)sqrt(v69 * v69 + v68 * v68) / (int)(__int64)(*((float *)v43 + 8) * 3.5);
          if ( v70 > 18 )
            v70 = 18;
          v71 = *((float *)v43 - 2) + 1.5707964;
          v72 = *(_DWORD *)grim_interface_ptr;
          v250 = cos(v71) * *((float *)v43 + 8) * 2.5999999;
          v235 = sin(v71) * *((float *)v43 + 8) * 2.5999999;
          v236 = a1 * 0.40000001;
          (*(void (__stdcall **)(int, int, int, float))(v72 + 276))(
            1065353216,
            1065353216,
            1065353216,
            COERCE_FLOAT(LODWORD(v236)));
          v73 = 0.0;
          v237 = 0.0;
          if ( v70 > 0 )
          {
            do
            {
              v74 = (double)SLODWORD(v237);
              v230 = 44.0;
              v229[2] = 44.0;
              LODWORD(v229[1]) = grim_interface_ptr;
              v75 = *(_DWORD *)grim_interface_ptr;
              v229[1] = v74 * v235 + *(float *)v43 + *(float *)&camera_offset_y - 22.0;
              LODWORD(v229[0]) = grim_interface_ptr;
              v229[0] = v74 * v250 + *((float *)v43 - 1) + *(float *)&camera_offset_x - 22.0;
              (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v75 + 284))(
                LODWORD(v229[0]),
                LODWORD(v229[1]),
                1110441984,
                1110441984);
              ++LODWORD(v73);
              v237 = v73;
            }
            while ( SLODWORD(v73) < v70 );
          }
          v76 = *(_DWORD *)grim_interface_ptr;
          v230 = a1 * 0.44999999;
          (*(void (__stdcall **)(int, int, int, float, float))(v76 + 276))(
            1065353216,
            1065353216,
            1065353216,
            COERCE_FLOAT(LODWORD(v230)),
            COERCE_FLOAT(LODWORD(v231)));
          v77 = *(float *)&camera_offset_y + *(float *)v43;
          v231 = 84.0;
          v230 = 84.0;
          LODWORD(v229[2]) = grim_interface_ptr;
          v78 = *(_DWORD *)grim_interface_ptr;
          v229[2] = v77 - 42.0;
          v229[1] = *(float *)&camera_offset_x + *((float *)v43 - 1) - 42.0;
          (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v78 + 284))(
            LODWORD(v229[1]),
            LODWORD(v229[2]),
            1118306304,
            1118306304);
          v231 = v236;
          v56 = *(_DWORD *)grim_interface_ptr;
          goto LABEL_54;
        }
        if ( v44 == 26 )
        {
          v81 = *((float *)v43 + 2) - *(float *)v43;
          v82 = *((float *)v43 + 1) - *((float *)v43 - 1);
          v83 = (int)(__int64)sqrt(v82 * v82 + v81 * v81) / (int)(__int64)(*((float *)v43 + 8) * 2.0999999);
          if ( v83 > 3 )
            v83 = 3;
          v84 = *((float *)v43 - 2) + 1.5707964;
          v230 = *(float *)&grim_interface_ptr;
          v85 = *(_DWORD *)grim_interface_ptr;
          v250 = cos(v84) * *((float *)v43 + 8) * 2.0999999;
          v235 = sin(v84) * *((float *)v43 + 8) * 2.0999999;
          v230 = a1 * 0.40000001;
          (*(void (__stdcall **)(int, int, int, float))(v85 + 276))(
            1050253722,
            1065353216,
            1050253722,
            COERCE_FLOAT(LODWORD(v230)));
          v86 = 0.0;
          v237 = 0.0;
          if ( v83 > 0 )
          {
            do
            {
              v87 = (double)SLODWORD(v237);
              v230 = 12.0;
              v229[2] = 12.0;
              LODWORD(v229[1]) = grim_interface_ptr;
              v88 = *(_DWORD *)grim_interface_ptr;
              v229[1] = v87 * v235 + *(float *)v43 + *(float *)&camera_offset_y - 6.0;
              LODWORD(v229[0]) = grim_interface_ptr;
              v229[0] = v87 * v250 + *((float *)v43 - 1) + *(float *)&camera_offset_x - 6.0;
              (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v88 + 284))(
                LODWORD(v229[0]),
                LODWORD(v229[1]),
                1094713344,
                1094713344);
              ++LODWORD(v86);
              v237 = v86;
            }
            while ( SLODWORD(v86) < v83 );
          }
          (*(void (__thiscall **)(int, int, int, int, float, float, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
            grim_interface_ptr,
            1050253722,
            1065353216,
            1050253722,
            COERCE_FLOAT(LODWORD(v239)),
            COERCE_FLOAT(LODWORD(v231)),
            v232,
            COERCE_FLOAT(LODWORD(v233)));
          v89 = *(float *)&camera_offset_y + *(float *)v43;
          v233 = 16.0;
          v232 = 1098907648;
          v231 = *(float *)&grim_interface_ptr;
          v90 = *(_DWORD *)grim_interface_ptr;
          v231 = v89 - 8.0;
          v230 = *(float *)&camera_offset_x + *((float *)v43 - 1) - 8.0;
          (*(void (__stdcall **)(float, float, int, int))(v90 + 284))(
            COERCE_FLOAT(LODWORD(v230)),
            COERCE_FLOAT(LODWORD(v231)),
            1098907648,
            1098907648);
          v67 = *(_DWORD *)grim_interface_ptr;
          v233 = a4 * 0.15000001;
          v232 = 1050253722;
          v231 = 1.0;
        }
        else
        {
          v91 = *((float *)v43 + 2) - *(float *)v43;
          v92 = *((float *)v43 + 1) - *((float *)v43 - 1);
          v93 = (int)(__int64)sqrt(v92 * v92 + v91 * v91) / (int)(__int64)(*((float *)v43 + 8) * 2.0999999);
          if ( v93 > 3 )
            v93 = 3;
          v94 = *((float *)v43 - 2) + 1.5707964;
          v230 = *(float *)&grim_interface_ptr;
          v95 = *(_DWORD *)grim_interface_ptr;
          v250 = cos(v94) * *((float *)v43 + 8) * 2.0999999;
          v235 = sin(v94) * *((float *)v43 + 8) * 2.0999999;
          v230 = a1 * 0.40000001;
          (*(void (__stdcall **)(int, int, int, float))(v95 + 276))(
            1050253722,
            1050253722,
            1065353216,
            COERCE_FLOAT(LODWORD(v230)));
          v96 = 0.0;
          v237 = 0.0;
          if ( v93 > 0 )
          {
            do
            {
              v97 = (double)SLODWORD(v237);
              v230 = 12.0;
              v229[2] = 12.0;
              LODWORD(v229[1]) = grim_interface_ptr;
              v98 = *(_DWORD *)grim_interface_ptr;
              v229[1] = v97 * v235 + *(float *)v43 + *(float *)&camera_offset_y - 6.0;
              LODWORD(v229[0]) = grim_interface_ptr;
              v229[0] = v97 * v250 + *((float *)v43 - 1) + *(float *)&camera_offset_x - 6.0;
              (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v98 + 284))(
                LODWORD(v229[0]),
                LODWORD(v229[1]),
                1094713344,
                1094713344);
              ++LODWORD(v96);
              v237 = v96;
            }
            while ( SLODWORD(v96) < v93 );
          }
          (*(void (__thiscall **)(int, int, int, int, float, float, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
            grim_interface_ptr,
            1050253722,
            1050253722,
            1065353216,
            COERCE_FLOAT(LODWORD(v239)),
            COERCE_FLOAT(LODWORD(v231)),
            v232,
            COERCE_FLOAT(LODWORD(v233)));
          v99 = *(float *)&camera_offset_y + *(float *)v43;
          v233 = 16.0;
          v232 = 1098907648;
          v231 = *(float *)&grim_interface_ptr;
          v100 = *(_DWORD *)grim_interface_ptr;
          v231 = v99 - 8.0;
          v230 = *(float *)&camera_offset_x + *((float *)v43 - 1) - 8.0;
          (*(void (__stdcall **)(float, float, int, int))(v100 + 284))(
            COERCE_FLOAT(LODWORD(v230)),
            COERCE_FLOAT(LODWORD(v231)),
            1098907648,
            1098907648);
          v67 = *(_DWORD *)grim_interface_ptr;
          v233 = a4 * 0.15000001;
          v232 = 1065353216;
          v231 = 0.30000001;
        }
        v230 = 0.30000001;
      }
      (*(void (__stdcall **)(float))(v67 + 276))(COERCE_FLOAT(LODWORD(v230)));
      if ( !config_fx_detail_flag1 )
        goto LABEL_76;
      v101 = *(float *)&camera_offset_y + *(float *)v43;
      v230 = 120.0;
      v229[2] = 120.0;
      LODWORD(v229[1]) = grim_interface_ptr;
      v102 = *(_DWORD *)grim_interface_ptr;
      v229[1] = v101 - 60.0;
      v103 = *(float *)&camera_offset_x + *((float *)v43 - 1) - 60.0;
LABEL_75:
      v229[0] = v103;
      (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, float))(v102 + 284))(
        LODWORD(v229[0]),
        LODWORD(v229[1]),
        LODWORD(v229[2]),
        COERCE_FLOAT(LODWORD(v230)));
      goto LABEL_76;
    }
    v45 = *((float *)v43 + 2) - *(float *)v43;
    v46 = *((float *)v43 + 1) - *((float *)v43 - 1);
    v47 = (int)(__int64)sqrt(v45 * v45 + v46 * v46) / (int)(__int64)(*((float *)v43 + 8) * 2.5);
    if ( v47 > 8 )
      v47 = 8;
    v48 = *((float *)v43 - 2) + 1.5707964;
    v230 = *(float *)&grim_interface_ptr;
    v49 = *(_DWORD *)grim_interface_ptr;
    v250 = cos(v48) * *((float *)v43 + 8) * 2.5;
    v235 = sin(v48) * *((float *)v43 + 8) * 2.5;
    v230 = a1 * 0.40000001;
    (*(void (__stdcall **)(int, int, int, float))(v49 + 276))(
      1065353216,
      1065353216,
      1065353216,
      COERCE_FLOAT(LODWORD(v230)));
    v50 = 0.0;
    v237 = 0.0;
    if ( v47 > 0 )
    {
      do
      {
        v51 = (double)SLODWORD(v237);
        v230 = 22.0;
        v229[2] = 22.0;
        LODWORD(v229[1]) = grim_interface_ptr;
        v52 = *(_DWORD *)grim_interface_ptr;
        v229[1] = v51 * v235 + *(float *)v43 + *(float *)&camera_offset_y - 11.0;
        LODWORD(v229[0]) = grim_interface_ptr;
        v229[0] = v51 * v250 + *((float *)v43 - 1) + *(float *)&camera_offset_x - 11.0;
        (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v52 + 284))(
          LODWORD(v229[0]),
          LODWORD(v229[1]),
          1102053376,
          1102053376);
        ++LODWORD(v50);
        v237 = v50;
      }
      while ( SLODWORD(v50) < v47 );
    }
    v53 = *(_DWORD *)grim_interface_ptr;
    v230 = a1 * 0.44999999;
    (*(void (__stdcall **)(int, int, int, float, float))(v53 + 276))(
      1065353216,
      1065353216,
      1065353216,
      COERCE_FLOAT(LODWORD(v230)),
      COERCE_FLOAT(LODWORD(v231)));
    v54 = *(float *)&camera_offset_y + *(float *)v43;
    v231 = 56.0;
    v230 = 56.0;
    LODWORD(v229[2]) = grim_interface_ptr;
    v55 = *(_DWORD *)grim_interface_ptr;
    v229[2] = v54 - 28.0;
    v229[1] = *(float *)&camera_offset_x + *((float *)v43 - 1) - 28.0;
    (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v55 + 284))(
      LODWORD(v229[1]),
      LODWORD(v229[2]),
      1113587712,
      1113587712);
    v56 = *(_DWORD *)grim_interface_ptr;
    v231 = a2 * 0.30000001;
LABEL_54:
    (*(void (__stdcall **)(int, int, int))(v56 + 276))(1065353216, 1065353216, 1065353216);
    if ( config_fx_detail_flag1 )
    {
      v79 = *(float *)&camera_offset_y + *(float *)v43;
      v230 = 256.0;
      v229[2] = 256.0;
      LODWORD(v229[1]) = grim_interface_ptr;
      v80 = *(_DWORD *)grim_interface_ptr;
      v229[1] = v79 - 128.0;
      v229[0] = *(float *)&camera_offset_x + *((float *)v43 - 1) - 128.0;
      (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v80 + 284))(
        LODWORD(v229[0]),
        LODWORD(v229[1]),
        1132462080,
        1132462080);
    }
LABEL_76:
    v43 += 16;
  }
  while ( (int)v43 < (int)&particle_vel_x );
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  v236 = 1.0;
  if ( perk_count_get(perk_id_ion_gun_master) )
    v236 = 1.2;
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
    grim_interface_ptr,
    projectile_texture,
    0);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v107 = a1;
  *(float *)&v244 = 0.0;
  v108 = &projectile_origin_y;
  while ( 2 )
  {
    v109 = *((_BYTE *)v108 - 20);
    LODWORD(v110) = v108 - 5;
    LODWORD(v245) = v108 - 5;
    if ( v109 )
    {
      v111 = v108[3];
      if ( v111 == 19 )
      {
        if ( v108[4] == 1053609165 )
        {
          v112 = *(float *)v108 - *((float *)v108 - 2);
          v113 = *((float *)v108 - 1) - *((float *)v108 - 3);
          v230 = *((float *)v108 - 4);
          v114 = *(_DWORD *)grim_interface_ptr;
          v240 = sqrt(v113 * v113 + v112 * v112) * 0.0099999998;
          (*(void (__thiscall **)(int, float))(v114 + 252))(grim_interface_ptr, COERCE_FLOAT(LODWORD(v230)));
          (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 2, 0);
          v115 = *(_DWORD *)grim_interface_ptr;
          v230 = a1 * 0.69999999;
          (*(void (__stdcall **)(int, int, int, float))(v115 + 276))(
            1036831949,
            1058642330,
            1045220557,
            COERCE_FLOAT(LODWORD(v230)));
          v116 = *(_DWORD *)grim_interface_ptr;
          v272 = v240 * 16.0;
          v117 = v240 * 8.0;
          v118 = v272;
          goto LABEL_84;
        }
        (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, *(v108 - 4));
        (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 2, 0);
        v120 = *((float *)v108 + 4) * 2.5;
        if ( v120 <= 1.0 )
        {
          if ( v120 < 0.0 )
            v120 = 0.0;
        }
        else
        {
          v120 = 1.0;
        }
        v121 = *(_DWORD *)grim_interface_ptr;
        v230 = v120 * a1;
        (*(void (__stdcall **)(int, int, int, float))(v121 + 276))(
          1065353216,
          1065353216,
          1065353216,
          COERCE_FLOAT(LODWORD(v230)));
        v122 = *(float *)&camera_offset_y + *((float *)v108 - 2);
        v230 = 56.0;
        v229[2] = 56.0;
        LODWORD(v229[1]) = grim_interface_ptr;
        v123 = *(_DWORD *)grim_interface_ptr;
        v229[1] = v122 - 28.0;
        v229[0] = *(float *)&camera_offset_x + *((float *)v108 - 3) - 28.0;
        (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v123 + 284))(
          LODWORD(v229[0]),
          LODWORD(v229[1]),
          1113587712,
          1113587712);
      }
      else
      {
        if ( v111 == 29 )
        {
          if ( v108[4] != 1053609165 )
            goto LABEL_153;
          v124 = *(float *)v108 - *((float *)v108 - 2);
          v125 = *((float *)v108 - 1) - *((float *)v108 - 3);
          v126 = sqrt(v125 * v125 + v124 * v124);
          v240 = v126;
          if ( v126 > 20.0 )
            v240 = 20.0;
          (*(void (__thiscall **)(int, _DWORD, float, int, float, float))(*(_DWORD *)grim_interface_ptr + 252))(
            grim_interface_ptr,
            *(v108 - 4),
            COERCE_FLOAT(LODWORD(v231)),
            v232,
            COERCE_FLOAT(LODWORD(v233)),
            COERCE_FLOAT(LODWORD(v234)));
          (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 4, 3);
          v234 = v107;
          v233 = 1.0;
          v232 = 1065353216;
          v127 = *(_DWORD *)grim_interface_ptr;
          v231 = 1.0;
        }
        else
        {
          if ( v111 != 25 )
          {
            if ( v111 == 22 || v111 == 21 || v111 == 23 || v111 == 45 )
            {
              if ( v108[4] == 1053609165 )
              {
                if ( v111 == 22 )
                {
                  v240 = 1.05;
                }
                else if ( v111 == 21 )
                {
                  v240 = 2.2;
                }
                else
                {
                  v240 = 0.80000001;
                  if ( v111 != 45 )
                    v240 = 3.5;
                }
                (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 2, 2);
                v132 = *((float *)v108 - 3) - *((float *)v108 - 1);
                v230 = COERCE_FLOAT(&v252);
                v268 = v132;
                v133 = *((float *)v108 - 2) - *(float *)v108;
                v252 = v268;
                v269 = v133;
                v253 = v269;
                v260 = sqrt(v268 * v268 + v269 * v269);
                j_FUN_00452f1d(&v252);
                if ( v108[3] == 45 )
                  (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
                    grim_interface_ptr,
                    1065353216,
                    1058642330,
                    1036831949,
                    COERCE_FLOAT(LODWORD(v107)));
                else
                  (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
                    grim_interface_ptr,
                    1056964608,
                    1058642330,
                    1065353216,
                    COERCE_FLOAT(LODWORD(v107)));
                (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 4, 2);
                v272 = v240 * 16.0;
                v270 = *(float *)&camera_offset_x + *((float *)v108 - 1) - v272;
                v271 = *(float *)&camera_offset_y + *(float *)v108 - v272;
                if ( v260 <= 256.0 )
                {
                  v250 = 0.0;
                  v287 = v260;
                }
                else
                {
                  v287 = 256.0;
                  v250 = v260 - 256.0;
                }
                v134 = v240 * 3.0999999;
                v237 = v134;
                if ( v134 > 9.0 )
                  v237 = 9.0;
                v291 = v250;
                if ( v250 < (double)v260 )
                {
                  v239 = v240 * 32.0;
                  do
                  {
                    if ( v108[3] == 45 )
                    {
                      v135 = *(_DWORD *)grim_interface_ptr;
                      v230 = (v250 - v291) / v287 * a1;
                      (*(void (__stdcall **)(int, int, int, float))(v135 + 276))(
                        1065353216,
                        1058642330,
                        1036831949,
                        COERCE_FLOAT(LODWORD(v230)));
                    }
                    else
                    {
                      v136 = *(_DWORD *)grim_interface_ptr;
                      v230 = (v250 - v291) / v287 * a1;
                      (*(void (__stdcall **)(int, int, int, float))(v136 + 276))(
                        1056964608,
                        1058642330,
                        1065353216,
                        COERCE_FLOAT(LODWORD(v230)));
                    }
                    v230 = v239;
                    v229[2] = v239;
                    LODWORD(v229[1]) = grim_interface_ptr;
                    v137 = *(_DWORD *)grim_interface_ptr;
                    v229[1] = v253 * v250 + v271;
                    v229[0] = v252 * v250 + v270;
                    (*(void (__stdcall **)(_DWORD, _DWORD, float, float))(v137 + 284))(
                      LODWORD(v229[0]),
                      LODWORD(v229[1]),
                      COERCE_FLOAT(LODWORD(v239)),
                      COERCE_FLOAT(LODWORD(v239)));
                    v138 = v237 + v250;
                    v250 = v138;
                  }
                  while ( v138 < v260 );
                }
                v110 = v245;
                (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(
                  grim_interface_ptr,
                  *(_DWORD *)(LODWORD(v245) + 4));
                v107 = a1;
                (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
                  grim_interface_ptr,
                  1065353216,
                  1065353216,
                  1060320051,
                  LODWORD(a1));
                v139 = *(_DWORD *)grim_interface_ptr;
                v239 = v240 * 32.0;
                v140 = *(float *)&camera_offset_y + *(float *)(LODWORD(v245) + 12);
                v230 = v239;
                v229[2] = v239;
                v229[1] = v140 - v272;
                v229[0] = *(float *)&camera_offset_x + *(float *)(LODWORD(v245) + 8) - v272;
                (*(void (__stdcall **)(_DWORD, _DWORD, float, float))(v139 + 284))(
                  LODWORD(v229[0]),
                  LODWORD(v229[1]),
                  COERCE_FLOAT(LODWORD(v239)),
                  COERCE_FLOAT(LODWORD(v239)));
              }
              else
              {
                (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(
                  grim_interface_ptr,
                  *(v108 - 4));
                (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 4, 2);
                v141 = *((float *)v108 + 4) * 2.5;
                v237 = v141;
                if ( v141 <= 1.0 )
                {
                  if ( v237 < 0.0 )
                    v237 = 0.0;
                }
                else
                {
                  v237 = 1.0;
                }
                v142 = *((float *)v108 - 3) - *((float *)v108 - 1);
                v230 = COERCE_FLOAT(&v252);
                v266 = v142;
                v143 = *((float *)v108 - 2) - *(float *)v108;
                v252 = v266;
                v267 = v143;
                v253 = v267;
                v260 = sqrt(v266 * v266 + v267 * v267);
                j_FUN_00452f1d(&v252);
                v144 = v108[3];
                if ( v144 == 22 )
                {
                  v240 = 1.05;
                }
                else if ( v144 == 21 )
                {
                  v240 = 2.2;
                }
                else
                {
                  v240 = 0.80000001;
                  if ( v144 != 45 )
                    v240 = 3.5;
                }
                (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 4, 2);
                v272 = v240 * 16.0;
                v270 = *(float *)&camera_offset_x + *((float *)v108 - 1) - v272;
                v271 = *(float *)&camera_offset_y + *(float *)v108 - v272;
                if ( v260 <= 256.0 )
                {
                  v235 = 0.0;
                  v289 = v260;
                }
                else
                {
                  v289 = 256.0;
                  v235 = v260 - 256.0;
                }
                v145 = v240 * 3.0999999;
                v256 = v145;
                if ( v145 > 9.0 )
                  v256 = 9.0;
                v283 = v235;
                if ( v235 < (double)v260 )
                {
                  v239 = v240 * 32.0;
                  do
                  {
                    if ( v108[3] == 45 )
                    {
                      v146 = *(_DWORD *)grim_interface_ptr;
                      v230 = (v235 - v283) / v289 * v237 * a1;
                      (*(void (__stdcall **)(int, int, int, float))(v146 + 276))(
                        1065353216,
                        1058642330,
                        1036831949,
                        COERCE_FLOAT(LODWORD(v230)));
                    }
                    else
                    {
                      v147 = *(_DWORD *)grim_interface_ptr;
                      v230 = (v235 - v283) / v289 * v237 * a1;
                      (*(void (__stdcall **)(int, int, int, float))(v147 + 276))(
                        1056964608,
                        1058642330,
                        1065353216,
                        COERCE_FLOAT(LODWORD(v230)));
                    }
                    v230 = v239;
                    v229[2] = v239;
                    LODWORD(v229[1]) = grim_interface_ptr;
                    v148 = *(_DWORD *)grim_interface_ptr;
                    v229[1] = v235 * v253 + v271;
                    v229[0] = v235 * v252 + v270;
                    (*(void (__stdcall **)(_DWORD, _DWORD, float, float))(v148 + 284))(
                      LODWORD(v229[0]),
                      LODWORD(v229[1]),
                      COERCE_FLOAT(LODWORD(v239)),
                      COERCE_FLOAT(LODWORD(v239)));
                    v149 = v256 + v235;
                    v235 = v149;
                  }
                  while ( v149 < v260 );
                }
                v150 = *(_DWORD *)grim_interface_ptr;
                v256 = v237 * a1;
                v151 = v256;
                (*(void (__thiscall **)(int, int, int, int, float))(v150 + 276))(
                  grim_interface_ptr,
                  1056964608,
                  1058642330,
                  1065353216,
                  COERCE_FLOAT(LODWORD(v256)));
                v152 = *(float *)&camera_offset_y + *(float *)(LODWORD(v245) + 12);
                v230 = 32.0;
                v229[2] = 32.0;
                LODWORD(v229[1]) = grim_interface_ptr;
                v153 = (float *)(LODWORD(v245) + 8);
                v154 = *(_DWORD *)grim_interface_ptr;
                v229[1] = v152 - 16.0;
                v229[0] = *(float *)&camera_offset_x + *(float *)(LODWORD(v245) + 8) - 16.0;
                (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v154 + 284))(
                  LODWORD(v229[0]),
                  LODWORD(v229[1]),
                  1107296256,
                  1107296256);
                (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
                  grim_interface_ptr,
                  1056964608,
                  1058642330,
                  1065353216,
                  COERCE_FLOAT(LODWORD(v151)));
                v155 = *(_DWORD *)(LODWORD(v245) + 32) == 45;
                v260 = v240 * v236 * 40.0;
                if ( !v155 )
                {
                  v156 = creature_find_in_radius(v153, v260, 1);
                  if ( v156 != -1 )
                  {
                    v239 = v240 * 32.0;
                    do
                    {
                      (*(void (__thiscall **)(int, _DWORD, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 268))(
                        grim_interface_ptr,
                        0,
                        1059061760,
                        0);
                      (*(void (__thiscall **)(int, int, int, int))(*(_DWORD *)grim_interface_ptr + 268))(
                        grim_interface_ptr,
                        1,
                        1059061760,
                        1048576000);
                      (*(void (__thiscall **)(int, int, int, int))(*(_DWORD *)grim_interface_ptr + 268))(
                        grim_interface_ptr,
                        2,
                        1059061760,
                        1048576000);
                      (*(void (__thiscall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 268))(
                        grim_interface_ptr,
                        3,
                        1059061760,
                        0);
                      v230 = COERCE_FLOAT(&v252);
                      v242 = *((float *)&creature_pos_x + 38 * v156) - *v153;
                      v157 = creature_pos_y[38 * v156] - *(float *)(LODWORD(v245) + 12);
                      v252 = v242;
                      v243 = v157;
                      v253 = v243;
                      j_FUN_00452f1d(&v252);
                      v256 = v252;
                      v252 = -v253;
                      v253 = v256;
                      v278 = *(float *)&camera_offset_x + *v153;
                      v279 = *(float *)&camera_offset_y + *(float *)(LODWORD(v245) + 12);
                      v158 = v252 * v240;
                      v256 = v240 * v256;
                      v277 = v256;
                      v281 = v256 * 10.0;
                      v248 = v278 - v158 * 10.0;
                      v282 = v256;
                      v249 = v279 - v281;
                      v286 = v281;
                      v254 = v278 + v158 * 10.0;
                      v255 = v281 + v279;
                      v274 = *(float *)&camera_offset_x + *((float *)&creature_pos_x + 38 * v156);
                      v159 = *(float *)&camera_offset_y + creature_pos_y[38 * v156];
                      v246 = v274;
                      v258 = v274;
                      v275 = v159;
                      v247 = v275;
                      v259 = v275;
                      v307 = v256;
                      v299 = v256;
                      v303 = v281;
                      v160 = *(_DWORD *)grim_interface_ptr;
                      v246 = v158 * 10.0 + v274;
                      v247 = v281 + v275;
                      v305 = v281;
                      v258 = v274 - v158 * 10.0;
                      v259 = v275 - v281;
                      (*(void (__thiscall **)(int, float, float, float, float, float, float, float, float))(v160 + 312))(
                        grim_interface_ptr,
                        COERCE_FLOAT(LODWORD(v248)),
                        COERCE_FLOAT(LODWORD(v249)),
                        COERCE_FLOAT(LODWORD(v254)),
                        COERCE_FLOAT(LODWORD(v255)),
                        COERCE_FLOAT(LODWORD(v246)),
                        COERCE_FLOAT(LODWORD(v247)),
                        COERCE_FLOAT(LODWORD(v258)),
                        COERCE_FLOAT(LODWORD(v259)));
                      v161 = v252 * v240;
                      v256 = v253 * v240;
                      v296 = v256;
                      v298 = v256;
                      v309 = v256;
                      v295 = v256 * 4.0;
                      v311 = v256;
                      v162 = *(_DWORD *)grim_interface_ptr;
                      v246 = v246 + v161 * 4.0;
                      v247 = v295 + v247;
                      v297 = v295;
                      v258 = v258 - v161 * 4.0;
                      v259 = v259 - v295;
                      v230 = v259;
                      v229[2] = v258;
                      v310 = v295;
                      v229[1] = v247;
                      v229[0] = v246;
                      v248 = v248 - v161 * 4.0;
                      v249 = v249 - v295;
                      v308 = v295;
                      v254 = v254 + v161 * 4.0;
                      v255 = v295 + v255;
                      (*(void (__thiscall **)(int, float, float, float, float, float, float, float, float))(v162 + 312))(
                        grim_interface_ptr,
                        COERCE_FLOAT(LODWORD(v248)),
                        COERCE_FLOAT(LODWORD(v249)),
                        COERCE_FLOAT(LODWORD(v254)),
                        COERCE_FLOAT(LODWORD(v255)),
                        COERCE_FLOAT(LODWORD(v246)),
                        COERCE_FLOAT(LODWORD(v247)),
                        COERCE_FLOAT(LODWORD(v258)),
                        COERCE_FLOAT(LODWORD(v259)));
                      (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(
                        grim_interface_ptr,
                        4,
                        2);
                      v163 = *(float *)&camera_offset_y + creature_pos_y[38 * v156];
                      v230 = v239;
                      v229[2] = v239;
                      LODWORD(v229[1]) = grim_interface_ptr;
                      v164 = *(_DWORD *)grim_interface_ptr;
                      v229[1] = v163 - v272;
                      v229[0] = *(float *)&camera_offset_x + *((float *)&creature_pos_x + 38 * v156) - v272;
                      (*(void (__stdcall **)(_DWORD, _DWORD, float, float))(v164 + 284))(
                        LODWORD(v229[0]),
                        LODWORD(v229[1]),
                        COERCE_FLOAT(LODWORD(v239)),
                        COERCE_FLOAT(LODWORD(v239)));
                      v156 = creature_find_in_radius(v153, v260, v156 + 1);
                    }
                    while ( v156 != -1 );
                  }
                }
                v107 = a1;
                v110 = v245;
              }
            }
            goto LABEL_153;
          }
          if ( v108[4] != 1053609165 )
            goto LABEL_153;
          v128 = *(float *)v108 - *((float *)v108 - 2);
          v129 = *((float *)v108 - 1) - *((float *)v108 - 3);
          v130 = sqrt(v129 * v129 + v128 * v128);
          v240 = v130;
          if ( v130 > 20.0 )
            v240 = 20.0;
          v230 = *(float *)&grim_interface_ptr;
          v131 = *(_DWORD *)grim_interface_ptr;
          v230 = (double)v244 * 0.1 - (double)quest_spawn_timeline * 0.1;
          (*(void (__thiscall **)(int, float, float, int, float, float))(v131 + 252))(
            grim_interface_ptr,
            COERCE_FLOAT(LODWORD(v230)),
            COERCE_FLOAT(LODWORD(v231)),
            v232,
            COERCE_FLOAT(LODWORD(v233)),
            COERCE_FLOAT(LODWORD(v234)));
          (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 4, 6);
          v234 = v107;
          v233 = 0.80000001;
          v232 = 1061997773;
          v127 = *(_DWORD *)grim_interface_ptr;
          v231 = 0.80000001;
        }
        (*(void (**)(void))(v127 + 276))();
        v118 = v240;
        v117 = v240 * 0.5;
        v116 = *(_DWORD *)grim_interface_ptr;
LABEL_84:
        v119 = *(float *)&camera_offset_y + *((float *)v108 - 2);
        v230 = v118;
        v229[2] = v118;
        v229[1] = v119 - v117;
        v229[0] = *(float *)&camera_offset_x + *((float *)v108 - 3) - v117;
        (*(void (__stdcall **)(_DWORD, _DWORD, float, float))(v116 + 284))(
          LODWORD(v229[0]),
          LODWORD(v229[1]),
          COERCE_FLOAT(LODWORD(v118)),
          COERCE_FLOAT(LODWORD(v118)));
      }
    }
LABEL_153:
    v108 += 16;
    ++v244;
    if ( (int)v108 < (int)particle_scale_x )
      continue;
    break;
  }
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  LODWORD(v229[0]) = 1;
  v165 = *(_DWORD *)grim_interface_ptr;
  v283 = (double)survival_elapsed_ms * 0.001 * 9.0;
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(v165 + 32))(
    grim_interface_ptr,
    19,
    1,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    6,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  *(float *)&v244 = 0.0;
  v166 = (float *)&projectile_pos_y;
  do
  {
    if ( *((_BYTE *)v166 - 12) && *((_DWORD *)v166 + 5) == 41 )
    {
      if ( *((_DWORD *)v166 + 6) == 1053609165 )
      {
        (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          COERCE_FLOAT(LODWORD(v107)));
        v167 = *(float *)&camera_offset_y + *v166;
        v230 = 60.0;
        v229[2] = 60.0;
        LODWORD(v229[1]) = grim_interface_ptr;
        v168 = *(_DWORD *)grim_interface_ptr;
        v229[1] = v167 - 30.0;
        v229[0] = *(float *)&camera_offset_x + *(v166 - 1) - 30.0;
        (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v168 + 284))(
          LODWORD(v229[0]),
          LODWORD(v229[1]),
          1114636288,
          1114636288);
        v169 = *(v166 - 2) + 1.5707964;
        v230 = 60.0;
        v229[2] = 60.0;
        LODWORD(v229[1]) = grim_interface_ptr;
        v170 = *(_DWORD *)grim_interface_ptr;
        v229[1] = sin(v169) * 15.0 + *(float *)&camera_offset_y + *v166 - 30.0;
        LODWORD(v229[0]) = grim_interface_ptr;
        v229[0] = cos(v169) * 15.0 + *(float *)&camera_offset_x + *(v166 - 1) - 30.0;
        (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v170 + 284))(
          LODWORD(v229[0]),
          LODWORD(v229[1]),
          1114636288,
          1114636288);
        v230 = 52.0;
        v229[2] = 52.0;
        LODWORD(v229[1]) = grim_interface_ptr;
        v171 = (double)v244 + v283;
        v172 = *(_DWORD *)grim_interface_ptr;
        v239 = v171;
        v173 = cos(v171);
        v229[1] = sin(v239) * 11.0 + *(float *)&camera_offset_y + *v166 - 31.0;
        v229[0] = *(float *)&camera_offset_x + *(v166 - 1) - 31.0 + v173 * v173;
        (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v172 + 284))(
          LODWORD(v229[0]),
          LODWORD(v229[1]),
          1112539136,
          1112539136);
        v174 = v239 + 2.0943952;
        v230 = 62.0;
        v229[2] = 62.0;
        LODWORD(v229[1]) = grim_interface_ptr;
        v175 = *(_DWORD *)grim_interface_ptr;
        v236 = sin(v174);
        v229[1] = *(float *)&camera_offset_y + *v166 - 31.0 + v236 * 10.0;
        LODWORD(v229[0]) = grim_interface_ptr;
        v229[0] = cos(v174) * 10.0 + *(float *)&camera_offset_x + *(v166 - 1) - 31.0;
        (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v175 + 284))(
          LODWORD(v229[0]),
          LODWORD(v229[1]),
          1115160576,
          1115160576);
        v176 = v239 + 4.1887903;
        v230 = 62.0;
        v229[2] = 62.0;
        LODWORD(v229[1]) = grim_interface_ptr;
        v177 = *(_DWORD *)grim_interface_ptr;
        v229[1] = sin(v176) * v236 + *(float *)&camera_offset_y + *v166 - 31.0;
        LODWORD(v229[0]) = grim_interface_ptr;
        v229[0] = cos(v176) * 10.0 + *(float *)&camera_offset_x + *(v166 - 1) - 31.0;
        (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(v177 + 284))(
          LODWORD(v229[0]),
          LODWORD(v229[1]),
          1115160576,
          1115160576);
      }
      else
      {
        v178 = v166[6] * 2.5;
        v237 = v178;
        if ( v178 <= 1.0 )
        {
          if ( v237 < 0.0 )
            v237 = 0.0;
        }
        else
        {
          v237 = 1.0;
        }
        v179 = *(_DWORD *)grim_interface_ptr;
        v230 = v237 * a1;
        (*(void (__stdcall **)(int, int, int, float))(v179 + 276))(
          1065353216,
          1065353216,
          1065353216,
          COERCE_FLOAT(LODWORD(v230)));
        v180 = *(_DWORD *)grim_interface_ptr;
        v236 = v237 * 40.0 + 32.0;
        v230 = v236;
        v229[2] = v236;
        v181 = v237 * 20.0 + 16.0;
        v229[1] = *(float *)&camera_offset_y + *v166 - v181;
        v229[0] = *(float *)&camera_offset_x + *(v166 - 1) - v181;
        (*(void (__stdcall **)(_DWORD, _DWORD, float, float))(v180 + 284))(
          LODWORD(v229[0]),
          LODWORD(v229[1]),
          COERCE_FLOAT(LODWORD(v236)),
          COERCE_FLOAT(LODWORD(v236)));
      }
    }
    v166 += 16;
    ++v244;
  }
  while ( (int)v166 < (int)&particle_vel_x );
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    2,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
    grim_interface_ptr,
    particles_texture,
    0);
  effect_select_texture(13);
  (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    COERCE_FLOAT(LODWORD(v107)));
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v182 = projectile_pool;
  do
  {
    if ( *v182 && *(_DWORD *)(LODWORD(v110) + 32) == 45 && *((_DWORD *)v182 + 9) == 1053609165 )
    {
      (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(
        grim_interface_ptr,
        *((_DWORD *)v182 + 1));
      v183 = *(float *)&camera_offset_x + *((float *)v182 + 2);
      v184 = *(float *)&camera_offset_y + *((float *)v182 + 3);
      v230 = 64.0;
      v229[2] = 64.0;
      v277 = v184;
      v185 = *(_DWORD *)grim_interface_ptr;
      v242 = v183 - 32.0;
      v243 = v277 - 32.0;
      (*(void (__thiscall **)(int, float, float, int, int))(v185 + 284))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v242)),
        COERCE_FLOAT(LODWORD(v243)),
        1115684864,
        1115684864);
    }
    v182 += 64;
  }
  while ( (int)v182 < (int)particle_pool );
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    6,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  v186 = *(_DWORD *)grim_interface_ptr;
  v236 = a1 * 0.89999998;
  (*(void (__thiscall **)(int, int, int, int, float))(v186 + 276))(
    grim_interface_ptr,
    1061997773,
    1061997773,
    1061997773,
    COERCE_FLOAT(LODWORD(v236)));
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_49BB30, 0);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v187 = (float *)&projectile_pos_y;
  do
  {
    if ( *((_BYTE *)v187 - 12) )
    {
      if ( *((_DWORD *)v187 + 6) == 1053609165 )
      {
        v188 = *((_DWORD *)v187 + 5);
        if ( v188 != 9 && v188 != 11 && v188 != 19 )
        {
          (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(
            grim_interface_ptr,
            *((_DWORD *)v187 - 2));
          v189 = *((_DWORD *)v187 + 5);
          if ( v189 == 1 )
          {
            v190 = *(float *)&camera_offset_x + *(v187 - 1);
            v191 = *(float *)&camera_offset_y + *v187;
            v230 = 6.0;
            v229[2] = 6.0;
            v277 = v191;
            v192 = *(_DWORD *)grim_interface_ptr;
            v242 = v190 - 3.0;
            v243 = v277 - 3.0;
            v229[1] = v243;
            v193 = v242;
          }
          else
          {
            v194 = *(float *)&camera_offset_x + *(v187 - 1);
            v195 = *(float *)&camera_offset_y + *v187;
            if ( v189 == 4 )
            {
              v281 = v195;
              v230 = 8.0;
              v192 = *(_DWORD *)grim_interface_ptr;
              v229[2] = 8.0;
              v264 = v194 - 4.0;
              v265 = v281 - 4.0;
              v229[1] = v265;
              v193 = v264;
            }
            else
            {
              v282 = v195;
              v230 = 4.0;
              v192 = *(_DWORD *)grim_interface_ptr;
              v229[2] = 4.0;
              v262 = v194 - 2.0;
              v263 = v282 - 2.0;
              v229[1] = v263;
              v193 = v262;
            }
          }
          (*(void (__stdcall **)(float, _DWORD, _DWORD, float))(v192 + 284))(
            COERCE_FLOAT(LODWORD(v193)),
            LODWORD(v229[1]),
            LODWORD(v229[2]),
            COERCE_FLOAT(LODWORD(v230)));
        }
      }
    }
    v187 += 16;
  }
  while ( (int)v187 < (int)&particle_vel_x );
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  if ( config_fx_detail_flag1 )
  {
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      5,
      LODWORD(v229[1]),
      LODWORD(v229[2]),
      COERCE_FLOAT(LODWORD(v230)));
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      2,
      LODWORD(v229[1]),
      LODWORD(v229[2]),
      COERCE_FLOAT(LODWORD(v230)));
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      particles_texture,
      0);
    effect_select_texture(13);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v196 = (float *)&secondary_proj_angle;
    do
    {
      if ( *((_BYTE *)v196 - 4) )
      {
        v197 = *(_DWORD *)grim_interface_ptr;
        v230 = a1 * 0.47999999;
        (*(void (__stdcall **)(int, int, int, float))(v197 + 276))(
          1065353216,
          1065353216,
          1065353216,
          COERCE_FLOAT(LODWORD(v230)));
        v198 = *v196 - 1.5707964;
        v230 = 140.0;
        v229[2] = 140.0;
        v199 = *(_DWORD *)grim_interface_ptr;
        v276 = cos(v198);
        v280 = v276 * 5.0;
        v200 = *(float *)&camera_offset_x + v196[2];
        v282 = *(float *)&camera_offset_y + v196[3];
        v285 = v200 - v280;
        v242 = v285 - 70.0;
        v243 = v282 - sin(v198) * 5.0 - 70.0;
        (*(void (__stdcall **)(float, float, int, int))(v199 + 284))(
          COERCE_FLOAT(LODWORD(v242)),
          COERCE_FLOAT(LODWORD(v243)),
          1124859904,
          1124859904);
      }
      v196 += 11;
    }
    while ( (int)v196 < (int)&dword_4965DC );
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      LODWORD(v229[1]),
      LODWORD(v229[2]),
      COERCE_FLOAT(LODWORD(v230)));
  }
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    6,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1061997773,
    1061997773,
    1061997773,
    COERCE_FLOAT(LODWORD(v236)));
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
    grim_interface_ptr,
    projectile_texture,
    0);
  (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 4, 3);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v201 = (float *)&secondary_proj_pos_y;
  while ( 2 )
  {
    if ( *((_BYTE *)v201 - 16) && *((_DWORD *)v201 + 3) != 3 )
    {
      (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(
        grim_interface_ptr,
        *((_DWORD *)v201 - 3));
      v202 = *((_DWORD *)v201 + 3);
      switch ( v202 )
      {
        case 1:
          v203 = *(float *)&camera_offset_x + *(v201 - 1);
          v204 = *(float *)&camera_offset_y + *v201;
          v230 = v236;
          v229[2] = 0.80000001;
          v229[1] = 0.80000001;
          v277 = v204;
          v205 = *(_DWORD *)grim_interface_ptr;
          v229[0] = 0.80000001;
          v242 = v203 - 7.0;
          v243 = v277 - 7.0;
          (*(void (__thiscall **)(int, int, int, int, float, float, int, float))(v205 + 276))(
            grim_interface_ptr,
            1061997773,
            1061997773,
            1061997773,
            COERCE_FLOAT(LODWORD(v236)),
            COERCE_FLOAT(LODWORD(v231)),
            v232,
            COERCE_FLOAT(LODWORD(v233)));
          v233 = 14.0;
          v232 = 1096810496;
          v206 = *(_DWORD *)grim_interface_ptr;
          v231 = v246;
          v207 = v245;
          goto LABEL_199;
        case 2:
          v208 = *(float *)&camera_offset_x + *(v201 - 1);
          v209 = *(float *)&camera_offset_y + *v201;
          v230 = v236;
          v229[2] = 0.80000001;
          v229[1] = 0.80000001;
          v281 = v209;
          v210 = *(_DWORD *)grim_interface_ptr;
          v229[0] = 0.80000001;
          v264 = v208 - 5.0;
          v265 = v281 - 5.0;
          (*(void (__thiscall **)(int, int, int, int, float))(v210 + 276))(
            grim_interface_ptr,
            1061997773,
            1061997773,
            1061997773,
            COERCE_FLOAT(LODWORD(v236)));
          (*(void (__thiscall **)(int, float, float, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
            grim_interface_ptr,
            COERCE_FLOAT(LODWORD(v264)),
            COERCE_FLOAT(LODWORD(v265)),
            1092616192,
            1092616192);
          break;
        case 4:
          v211 = *(float *)&camera_offset_x + *(v201 - 1);
          v212 = *(float *)&camera_offset_y + *v201;
          v230 = v236;
          v229[2] = 0.80000001;
          v229[1] = 0.80000001;
          v282 = v212;
          v213 = *(_DWORD *)grim_interface_ptr;
          v229[0] = 0.80000001;
          v262 = v211 - 4.0;
          v263 = v282 - 4.0;
          (*(void (__thiscall **)(int, int, int, int, float, float, int, float))(v213 + 276))(
            grim_interface_ptr,
            1061997773,
            1061997773,
            1061997773,
            COERCE_FLOAT(LODWORD(v236)),
            COERCE_FLOAT(LODWORD(v231)),
            v232,
            COERCE_FLOAT(LODWORD(v233)));
          v233 = 8.0;
          v232 = 1090519040;
          v206 = *(_DWORD *)grim_interface_ptr;
          v231 = v266;
          v207 = v265;
LABEL_199:
          (*(void (__stdcall **)(float))(v206 + 284))(COERCE_FLOAT(LODWORD(v207)));
          break;
      }
    }
    v201 += 11;
    if ( (int)v201 < (int)&flt_4965E8 )
      continue;
    break;
  }
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  result = config_fx_detail_flag1;
  if ( !config_fx_detail_flag1 )
    return result;
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    2,
    LODWORD(v229[1]),
    LODWORD(v229[2]),
    COERCE_FLOAT(LODWORD(v230)));
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
    grim_interface_ptr,
    particles_texture,
    0);
  effect_select_texture(13);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v215 = (float *)&secondary_proj_pos_y;
  while ( 2 )
  {
    if ( *((_BYTE *)v215 - 16) )
    {
      v216 = *((_DWORD *)v215 + 3);
      switch ( v216 )
      {
        case 4:
          v217 = *(_DWORD *)grim_interface_ptr;
          v230 = a1 * 0.15800001;
          BYTE1(v229[2]) = 0;
          HIWORD(v229[2]) = 16256;
          strcpy((char *)v229, "333?333?");
          (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, float, float, int, float))(v217 + 276))(
            LODWORD(v229[0]),
            LODWORD(v229[1]),
            LODWORD(v229[2]),
            COERCE_FLOAT(LODWORD(v230)),
            COERCE_FLOAT(LODWORD(v231)),
            v232,
            COERCE_FLOAT(LODWORD(v233)));
          v218 = *(v215 - 3) - 1.5707964;
          v233 = 30.0;
          v232 = 1106247680;
          v219 = *(_DWORD *)grim_interface_ptr;
          v279 = cos(v218);
          v282 = v279 * 9.0;
          v220 = *(float *)&camera_offset_x + *(v215 - 1);
          v285 = *(float *)&camera_offset_y + *v215;
          v288 = v220 - v282;
          v245 = v288 - 15.0;
          v246 = v285 - sin(v218) * 9.0 - 15.0;
          v231 = v246;
          v221 = v245;
          goto LABEL_210;
        case 1:
          v222 = *(_DWORD *)grim_interface_ptr;
          v230 = a1 * 0.68000001;
          (*(void (__stdcall **)(int, int, int, float))(v222 + 276))(
            1065353216,
            1065353216,
            1065353216,
            COERCE_FLOAT(LODWORD(v230)));
          v223 = *(v215 - 3) - 1.5707964;
          v230 = 60.0;
          v229[2] = 60.0;
          v224 = *(_DWORD *)grim_interface_ptr;
          v306 = cos(v223);
          v302 = v306 * 9.0;
          v225 = *(float *)&camera_offset_x + *(v215 - 1);
          v299 = *(float *)&camera_offset_y + *v215;
          v304 = v225 - v302;
          v264 = v304 - 30.0;
          v265 = v299 - sin(v223) * 9.0 - 30.0;
          (*(void (__stdcall **)(float, float, int, int))(v224 + 284))(
            COERCE_FLOAT(LODWORD(v264)),
            COERCE_FLOAT(LODWORD(v265)),
            1114636288,
            1114636288);
          break;
        case 2:
          v226 = *(_DWORD *)grim_interface_ptr;
          v230 = a1 * 0.57999998;
          (*(void (__stdcall **)(int, int, int, float, float, int, float))(v226 + 276))(
            1065353216,
            1065353216,
            1065353216,
            COERCE_FLOAT(LODWORD(v230)),
            COERCE_FLOAT(LODWORD(v231)),
            v232,
            COERCE_FLOAT(LODWORD(v233)));
          v227 = *(v215 - 3) - 1.5707964;
          v233 = 40.0;
          v232 = 1109393408;
          v219 = *(_DWORD *)grim_interface_ptr;
          v297 = cos(v227);
          v296 = v297 * 9.0;
          v228 = *(float *)&camera_offset_x + *(v215 - 1);
          v300 = *(float *)&camera_offset_y + *v215;
          v298 = v228 - v296;
          v265 = v298 - 20.0;
          v266 = v300 - sin(v227) * 9.0 - 20.0;
          v231 = v266;
          v221 = v265;
LABEL_210:
          (*(void (__stdcall **)(float))(v219 + 284))(COERCE_FLOAT(LODWORD(v221)));
          break;
      }
    }
    v215 += 11;
    if ( (int)v215 < (int)&flt_4965E8 )
      continue;
    break;
  }
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  return (*(int (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
           grim_interface_ptr,
           20,
           6,
           LODWORD(v229[1]),
           LODWORD(v229[2]),
           COERCE_FLOAT(LODWORD(v230)));
}

// sub_425D80 @ 0x00425D80
int __cdecl sub_425D80(int a1)
{
  int v1; // esi
  char *v2; // ecx
  double v3; // st6
  double v4; // st5

  v1 = 0;
  v2 = creature_pool;
  while ( 1 )
  {
    if ( *v2 )
    {
      v3 = *((float *)v2 + 6) - creature_pos_y[38 * a1];
      v4 = *((float *)v2 + 5) - *((float *)&creature_pos_x + 38 * a1);
      if ( sqrt(v4 * v4 + v3 * v3) < 45.0 )
        break;
    }
    v2 += 152;
    ++v1;
    if ( (int)v2 >= (int)byte_4AA338 )
      return 0;
  }
  if ( creature_collision_flag[152 * v1] && *(float *)&creature_health[38 * a1] < 150.0 )
    creature_collision_flag[152 * a1] = 1;
  if ( creature_collision_flag[152 * a1] )
  {
    if ( *(float *)&creature_health[38 * v1] < 150.0 )
      creature_collision_flag[152 * v1] = 1;
  }
  return v1;
}

// player_take_damage @ 0x00425E50
// applies player damage with perk modifiers, SFX, and retaliation effects
void __cdecl sub_425E50(int a1, float a2)
{
  int v2; // edi
  bool v3; // bl
  float *v4; // ebp
  int v5; // ebx
  char *v6; // esi
  double v7; // st6
  double v8; // st4
  long double v9; // st7
  int v10; // eax
  int v11; // eax
  double v12; // st7
  float v13; // [esp+0h] [ebp-28h]
  float v14; // [esp+1Ch] [ebp-Ch]
  float v15; // [esp+1Ch] [ebp-Ch]
  float v16; // [esp+1Ch] [ebp-Ch]
  int v17[2]; // [esp+20h] [ebp-8h] BYREF
  char v18; // [esp+2Ch] [ebp+4h]

  if ( perk_count_get(perk_id_death_clock) )
    return;
  if ( perk_count_get(perk_id_tough_reloader) && player_reload_active[864 * a1] )
    a2 = a2 * 0.5;
  survival_reward_damage_seen = 1;
  v14 = 1.0;
  v2 = 864 * a1;
  if ( *(float *)&player_shield_timer[216 * a1] > 0.0 )
    return;
  v3 = *(float *)player_health <= 0.0;
  if ( perk_count_get(perk_id_thick_skinned) )
    v14 = 0.66600001;
  v18 = 0;
  if ( !perk_count_get(perk_id_ninja) )
  {
    if ( perk_count_get(perk_id_dodger) && !(crt_rand() % 5) )
    {
      v18 = 1;
      goto LABEL_18;
    }
LABEL_14:
    if ( perk_count_get(perk_id_highlander) )
    {
      if ( !(crt_rand() % 10) )
        player_health[v2 / 4u] = 0;
    }
    else
    {
      *(float *)(v2 + 4786388) = *(float *)(v2 + 4786388) - v14 * a2;
    }
    goto LABEL_18;
  }
  if ( crt_rand() % 3 )
    goto LABEL_14;
  v18 = 1;
LABEL_18:
  if ( *(float *)(v2 + 4786388) >= 0.0 )
  {
    v11 = crt_rand();
    sfx_play_panned(sfx_trooper_inpain_01 + v11 % 3, (int)&player_pos_x[v2 / 4u], 1.0);
    if ( v3 )
      return;
  }
  else
  {
    *(float *)(v2 + 4786368) = *(float *)(v2 + 4786368) - frame_dt * 28.0;
    if ( v3 )
      return;
    if ( perk_count_get(perk_id_final_revenge) )
    {
      v4 = (float *)&player_pos_x[v2 / 4u];
      effect_spawn_explosion_burst((int)&player_pos_x[v2 / 4u], 1.8);
      bonus_spawn_guard = 1;
      v5 = 0;
      v6 = creature_pool;
      do
      {
        if ( *v6 )
        {
          v15 = *((float *)v6 + 5) - *v4;
          if ( COERCE_FLOAT(LODWORD(v15) & 0x7FFFFFFF) <= 512.0 )
          {
            v16 = *((float *)v6 + 6) - *(float *)(v2 + 4786376);
            if ( COERCE_FLOAT(LODWORD(v16) & 0x7FFFFFFF) <= 512.0 )
            {
              v7 = *((float *)v6 + 6) - v4[1];
              v8 = *((float *)v6 + 5) - *v4;
              v9 = 512.0 - sqrt(v7 * v7 + v8 * v8);
              if ( v9 > 0.0 )
              {
                v17[0] = 0;
                v17[1] = 0;
                v13 = v9 * 5.0;
                creature_apply_damage(v5, v13, 3, (float *)v17);
              }
            }
          }
        }
        v6 += 152;
        ++v5;
      }
      while ( (int)v6 < (int)byte_4AA338 );
      bonus_spawn_guard = 0;
      sfx_play_panned(sfx_explosion_large, (int)&player_pos_x[v2 / 4u], 1.0);
      sfx_play_panned(sfx_shockwave, (int)&player_pos_x[v2 / 4u], 1.0);
    }
    else
    {
      v10 = crt_rand() % 2;
      sfx_play_panned(sfx_trooper_die_01 + v10, (int)&player_pos_x[v2 / 4u], 1.0);
    }
  }
  if ( !v18 )
  {
    if ( !perk_count_get(perk_id_unstoppable) )
    {
      *(float *)(v2 + 4786396) = (double)(crt_rand() % 100 - 50) * 0.039999999 + *(float *)(v2 + 4786396);
      v12 = a2 * 0.0099999998 + *(float *)(v2 + 4787048);
      *(float *)(v2 + 4787048) = v12;
      if ( v12 > 0.47999999 )
        player_spread_heat[v2 / 4u] = 1056293519;
    }
    if ( *(float *)(v2 + 4786388) <= 20.0 && (crt_rand() & 7) == 3 )
      player_low_health_timer[v2 / 4u] = 0;
  }
}

// creature_update_all @ 0x00426220
// primary creature update loop: AI, movement, attacks, and animation phase
int sub_426220()
{
  int v0; // esi
  int v1; // esi
  double v2; // st7
  int v3; // eax
  int v4; // eax
  int v5; // eax
  __int16 v6; // ax
  int v7; // eax
  char v8; // bl
  unsigned int v9; // ecx
  double v10; // st6
  double v11; // st5
  double v12; // st6
  double v13; // st5
  long double v14; // st7
  double v15; // st6
  double v16; // st5
  double v17; // st7
  double v18; // st6
  int v19; // ebp
  double v20; // st7
  char v22; // c0
  double v23; // st7
  int v24; // edx
  double v25; // st7
  int v26; // eax
  int v27; // eax
  int v28; // eax
  int v29; // eax
  int v30; // eax
  int v31; // eax
  int v32; // edx
  int v33; // eax
  int v34; // ecx
  int v35; // ecx
  double v36; // st6
  double v37; // st4
  long double v38; // st5
  int v39; // eax
  int v40; // eax
  int v41; // edx
  float v42; // eax
  double v43; // st7
  float v44; // edx
  int v45; // ecx
  long double v46; // st7
  double v47; // st6
  double v48; // st4
  double v49; // st6
  double v50; // st4
  float *v51; // edx
  long double v52; // st7
  int v53; // ecx
  double v54; // st7
  long double v55; // st7
  double v56; // st7
  int v57; // ecx
  char v59; // c0
  int v60; // eax
  int v61; // edx
  long double v62; // st7
  double v63; // st7
  int v64; // eax
  double v65; // st7
  double v66; // st7
  double v67; // st6
  double v68; // st7
  double v69; // st7
  float *v70; // eax
  double v71; // st6
  double v72; // st4
  long double v73; // st7
  double v74; // st7
  double v75; // st7
  int v76; // ecx
  int v77; // eax
  float *v78; // eax
  double v79; // st7
  float *v80; // eax
  double v81; // st7
  double v83; // st7
  unsigned __int8 v84; // c0
  unsigned __int8 v85; // c3
  int v86; // eax
  double v87; // st7
  char v88; // al
  double v89; // st7
  float v90; // eax
  int v91; // ebx
  int v92; // ebx
  int v93; // ebx
  int v94; // eax
  long double v95; // st7
  int result; // eax
  int v97; // [esp-10h] [ebp-A8h]
  int v98; // [esp-10h] [ebp-A8h]
  float *v99; // [esp-4h] [ebp-9Ch]
  float *v100; // [esp-4h] [ebp-9Ch]
  float v101; // [esp+0h] [ebp-98h]
  float v102; // [esp+0h] [ebp-98h]
  float v103; // [esp+0h] [ebp-98h]
  float v104; // [esp+4h] [ebp-94h]
  float v105; // [esp+4h] [ebp-94h]
  float v106; // [esp+4h] [ebp-94h]
  float v107; // [esp+4h] [ebp-94h]
  float v108; // [esp+4h] [ebp-94h]
  float v109; // [esp+8h] [ebp-90h]
  float v110; // [esp+8h] [ebp-90h]
  int v111; // [esp+8h] [ebp-90h]
  int i; // [esp+1Ch] [ebp-7Ch]
  float v113; // [esp+20h] [ebp-78h]
  float v114; // [esp+24h] [ebp-74h]
  float v115; // [esp+24h] [ebp-74h]
  float v116; // [esp+28h] [ebp-70h]
  float v117; // [esp+2Ch] [ebp-6Ch]
  float v118; // [esp+30h] [ebp-68h]
  int v119; // [esp+38h] [ebp-60h]
  float v120; // [esp+40h] [ebp-58h] BYREF
  float v121; // [esp+44h] [ebp-54h]
  float v122[2]; // [esp+48h] [ebp-50h] BYREF
  int v123[2]; // [esp+50h] [ebp-48h] BYREF
  int v124[2]; // [esp+58h] [ebp-40h] BYREF
  int v125[2]; // [esp+60h] [ebp-38h] BYREF
  int v126[2]; // [esp+68h] [ebp-30h] BYREF
  float v127[2]; // [esp+70h] [ebp-28h] BYREF
  float v128[2]; // [esp+78h] [ebp-20h] BYREF
  int v129[2]; // [esp+80h] [ebp-18h] BYREF
  float v130; // [esp+88h] [ebp-10h]
  float v131; // [esp+90h] [ebp-8h]

  v0 = 0;
  ++creature_update_tick;
  creature_active_count = 0;
  for ( i = 0; ; v0 = i )
  {
    v1 = 19 * v0;
    if ( creature_pool[8 * v1] )
    {
      v2 = *(float *)&creature_hit_flash_timer[2 * v1];
      ++creature_active_count;
      if ( v2 > 0.0 )
        *(float *)&creature_hit_flash_timer[2 * v1] = *(float *)&creature_hit_flash_timer[2 * v1] - frame_dt;
      if ( bonus_freeze_timer <= 0.0 )
      {
        if ( *(float *)&creature_health[2 * v1] <= 0.0 && creature_hitbox_size[2 * v1] == 1098907648 )
          *(float *)&creature_hitbox_size[2 * v1] = *(float *)&creature_hitbox_size[2 * v1] - frame_dt;
        v3 = creature_flags[2 * v1];
        if ( (v3 & 2) != 0 )
        {
          v122[0] = 0.0;
          v122[1] = 0.0;
          v101 = frame_dt * 180.0;
          creature_apply_damage(i, v101, 0, v122);
        }
        else if ( (v3 & 1) != 0 )
        {
          v123[0] = 0;
          v123[1] = 0;
          v102 = frame_dt * 60.0;
          creature_apply_damage(i, v102, 0, (float *)v123);
        }
        if ( SLOBYTE(creature_flags[2 * v1]) < 0 )
        {
          v4 = creature_link_index[2 * v1];
          if ( v4 >= 0 )
          {
            v7 = v4 - frame_dt_ms;
            creature_link_index[2 * v1] = v7;
            if ( v7 <= 0 )
              creature_link_index[2 * v1] = -700 - (crt_rand() & 0x3FF);
          }
          else
          {
            v5 = frame_dt_ms + v4;
            creature_link_index[2 * v1] = v5;
            if ( v5 >= 0 )
            {
              v6 = crt_rand();
              creature_ai_mode[2 * v1] = 7;
              creature_link_index[2 * v1] = (v6 & 0x1FF) + 500;
            }
          }
        }
        if ( *(float *)&creature_health[2 * v1] <= 0.0 && creature_hitbox_size[2 * v1] == 1098907648 )
          *(float *)&creature_hitbox_size[2 * v1] = *(float *)&creature_hitbox_size[2 * v1] - frame_dt;
        v8 = creature_target_player[8 * v1];
        v9 = 864 * v8;
        v10 = *(float *)&player_pos_y[v9 / 4] - creature_pos_y[2 * v1];
        v11 = *(float *)&player_pos_x[v9 / 4] - *((float *)&creature_pos_x + 2 * v1);
        v113 = sqrt(v11 * v11 + v10 * v10);
        if ( !(creature_update_tick % 70) )
          goto LABEL_31;
        if ( config_player_count == 2 )
        {
          if ( player2_health[-216 * v8] > 0.0 )
          {
            v12 = *(float *)&player2_pos_x[v9 / 0xFFFFFFFC + 1] - creature_pos_y[2 * v1];
            v13 = *(float *)&player2_pos_x[-216 * v8] - *((float *)&creature_pos_x + 2 * v1);
            v14 = sqrt(v13 * v13 + v12 * v12);
            v117 = v14;
            if ( v14 < v113 )
            {
              v113 = v14;
              creature_target_player[8 * v1] = 1 - v8;
            }
          }
        }
        else
        {
          v15 = *(float *)player_pos_y - creature_pos_y[2 * v1];
          v16 = *(float *)player_pos_x - *((float *)&creature_pos_x + 2 * v1);
          v117 = sqrt(v16 * v16 + v15 * v15);
        }
        v8 = creature_target_player[8 * v1];
        v9 = 864 * v8;
        v17 = *(float *)player_pos_x - *((float *)&creature_pos_x + 38 * player_auto_target[v9 / 4]);
        v18 = *(float *)player_pos_y - creature_pos_y[38 * player_auto_target[v9 / 4]];
        if ( sqrt(v17 * v17 + v18 * v18) > v117 )
        {
          v19 = i;
          player_auto_target[216 * v8] = i;
        }
        else
        {
LABEL_31:
          v19 = i;
        }
        if ( *(float *)(v9 + 4786388) <= 0.0 )
          creature_target_player[8 * v1] = 1 - v8;
        if ( creature_hitbox_size[2 * v1] == 1098907648 )
        {
          if ( creature_collision_flag[8 * v1] )
          {
            v20 = *(float *)&creature_collision_timer[2 * v1] - frame_dt;
            *(float *)&creature_collision_timer[2 * v1] = v20;
            if ( v22 )
            {
              creature_state_flag[8 * v1] = 1;
              *(float *)&creature_collision_timer[2 * v1] = v20 + 0.5;
              v23 = *(float *)&creature_health[2 * v1] - 15.0;
              *(float *)&creature_health[2 * v1] = v23;
              if ( v23 < 0.0 )
              {
                ++plaguebearer_infection_count;
                creature_handle_death(v19, 1);
                v24 = crt_rand() % 2;
                sfx_play_panned(
                  *(&creature_type_sfx_b0 + 17 * *(&creature_type_id + 2 * v1) + v24),
                  8 * v1 + 4833100,
                  1.0);
              }
              fx_queue_add_random(8 * v1 + 4833100);
            }
          }
          v25 = (double)creature_phase_seed[2 * v1];
          v26 = evil_eyes_target_creature;
          creature_force_target[8 * v1] = 0;
          v116 = 1.0;
          v114 = v25 * 3.7 * 3.1415927;
          if ( v19 != v26 )
          {
            v27 = creature_ai_mode[2 * v1];
            if ( v27 )
            {
              switch ( v27 )
              {
                case 8:
                  v30 = 216 * creature_target_player[8 * v1];
                  creature_target_x[2 * v1] = cos(v114) * v113 * 0.89999998 + *(float *)&player_pos_x[v30];
                  creature_target_y[2 * v1] = sin(v114) * v113 * 0.89999998 + *(float *)(v30 * 4 + 4786376);
                  break;
                case 1:
                  v28 = 27 * creature_target_player[8 * v1];
                  if ( v113 > 800.0 )
                    goto LABEL_48;
                  v33 = 216 * creature_target_player[8 * v1];
                  creature_target_x[2 * v1] = cos(v114) * v113 * 0.55000001 + *(float *)&player_pos_x[v33];
                  creature_target_y[2 * v1] = sin(v114) * v113 * 0.55000001 + *(float *)(v33 * 4 + 4786376);
                  break;
                case 3:
                  v34 = 38 * creature_link_index[2 * v1];
                  if ( *(float *)&creature_health[v34] <= 0.0 )
                  {
                    creature_ai_mode[2 * v1] = 0;
                  }
                  else
                  {
                    creature_target_x[2 * v1] = *((float *)&creature_pos_x + 38 * creature_link_index[2 * v1])
                                              + creature_target_offset_x[2 * v1];
                    creature_target_y[2 * v1] = *(float *)(v34 * 4 + 4833104) + creature_target_offset_y[2 * v1];
                  }
                  break;
                case 5:
                  v35 = 38 * creature_link_index[2 * v1];
                  if ( *(float *)&creature_health[v35] <= 0.0 )
                  {
                    creature_ai_mode[2 * v1] = 0;
                    v124[0] = 0;
                    v124[1] = 0;
                    creature_apply_damage(i, 1000.0, 1, (float *)v124);
                  }
                  else
                  {
                    creature_target_x[2 * v1] = *((float *)&creature_pos_x + 38 * creature_link_index[2 * v1])
                                              + creature_target_offset_x[2 * v1];
                    creature_target_y[2 * v1] = *(float *)(v35 * 4 + 4833104) + creature_target_offset_y[2 * v1];
                    v36 = creature_target_y[2 * v1] - creature_pos_y[2 * v1];
                    v37 = creature_target_x[2 * v1] - *((float *)&creature_pos_x + 2 * v1);
                    v38 = sqrt(v36 * v36 + v37 * v37);
                    if ( v38 <= 64.0 )
                      v116 = v38 * 0.015625;
                  }
                  break;
              }
            }
            else
            {
              v28 = 27 * creature_target_player[8 * v1];
              if ( v113 <= 800.0 )
              {
                v29 = 216 * creature_target_player[8 * v1];
                creature_target_x[2 * v1] = cos(v114) * v113 * 0.85000002 + *(float *)&player_pos_x[v29];
                creature_target_y[2 * v1] = sin(v114) * v113 * 0.85000002 + *(float *)(v29 * 4 + 4786376);
                goto LABEL_59;
              }
LABEL_48:
              v31 = 8 * v28;
              v32 = player_pos_y[v31];
              LODWORD(creature_target_x[2 * v1]) = player_pos_x[v31];
              LODWORD(creature_target_y[2 * v1]) = v32;
            }
LABEL_59:
            v39 = creature_ai_mode[2 * v1];
            switch ( v39 )
            {
              case 4:
                if ( *(float *)&creature_health[38 * creature_link_index[2 * v1]] <= 0.0 )
                {
                  creature_ai_mode[2 * v1] = 0;
                  v125[0] = 0;
                  v125[1] = 0;
                  creature_apply_damage(i, 1000.0, 1, (float *)v125);
                }
                else
                {
                  v40 = 864 * creature_target_player[8 * v1];
                  if ( v113 <= 800.0 )
                  {
                    creature_target_x[2 * v1] = cos(v114) * v113 * 0.85000002
                                              + *(float *)&player_pos_x[216 * creature_target_player[8 * v1]];
                    creature_target_y[2 * v1] = sin(v114) * v113 * 0.85000002 + *(float *)(v40 + 4786376);
                  }
                  else
                  {
                    v41 = player_pos_y[216 * creature_target_player[8 * v1]];
                    LODWORD(creature_target_x[2 * v1]) = player_pos_x[216 * creature_target_player[8 * v1]];
                    LODWORD(creature_target_y[2 * v1]) = v41;
                  }
                }
                goto LABEL_76;
              case 7:
                if ( (creature_flags[2 * v1] & 0x80) != 0 && creature_link_index[2 * v1] > 0 )
                {
                  v42 = creature_pos_y[2 * v1];
                  LODWORD(creature_target_x[2 * v1]) = *(&creature_pos_x + 2 * v1);
                  creature_target_y[2 * v1] = v42;
LABEL_76:
                  v47 = creature_target_y[2 * v1] - creature_pos_y[2 * v1];
                  v48 = creature_target_x[2 * v1] - *((float *)&creature_pos_x + 2 * v1);
                  if ( sqrt(v47 * v47 + v48 * v48) < 40.0 )
                    creature_force_target[8 * v1] = 1;
                  v49 = creature_target_y[2 * v1] - creature_pos_y[2 * v1];
                  v50 = creature_target_x[2 * v1] - *((float *)&creature_pos_x + 2 * v1);
                  if ( sqrt(v49 * v49 + v50 * v50) > 400.0 )
                    creature_force_target[8 * v1] = 1;
                  if ( creature_force_target[8 * v1] || creature_ai_mode[2 * v1] == 2 )
                  {
                    v51 = (float *)&player_pos_x[216 * creature_target_player[8 * v1]];
                    creature_target_x[2 * v1] = *v51;
                    creature_target_y[2 * v1] = v51[1];
                  }
                  v52 = atan2(
                          creature_target_y[2 * v1] - creature_pos_y[2 * v1],
                          creature_target_x[2 * v1] - *((float *)&creature_pos_x + 2 * v1))
                      + 1.5707964;
                  *(&creature_target_heading + 2 * v1) = v52;
                  if ( bonus_energizer_timer > 0.0 && creature_max_health[2 * v1] < 500.0
                    || creature_collision_flag[8 * v1] )
                  {
                    *(&creature_target_heading + 2 * v1) = v52 + 3.1415927;
                  }
                  v53 = creature_flags[2 * v1];
                  if ( (v53 & 4) != 0 )
                  {
                    if ( *((float *)&creature_pos_x + 2 * v1) < (double)*(&creature_size + 2 * v1) )
                      *(&creature_pos_x + 2 * v1) = *((_DWORD *)&creature_size + 2 * v1);
                    if ( creature_pos_y[2 * v1] < (double)*(&creature_size + 2 * v1) )
                      creature_pos_y[2 * v1] = *(&creature_size + 2 * v1);
                    v54 = 1024.0 - *(&creature_size + 2 * v1);
                    if ( v54 < *((float *)&creature_pos_x + 2 * v1) )
                      *((float *)&creature_pos_x + 2 * v1) = v54;
                    if ( v54 < creature_pos_y[2 * v1] )
                      creature_pos_y[2 * v1] = v54;
                    if ( (v53 & 0x40) != 0 )
                    {
                      v109 = creature_move_speed[2 * v1] * 0.33333334 * 4.0;
                      angle_approach((float *)(8 * v1 + 4833124), *(&creature_target_heading + 2 * v1), v109);
                      v55 = *(&creature_heading + 2 * v1) - 1.5707964;
                      v99 = (float *)(8 * v1 + 4833108);
                      *v99 = cos(v55) * frame_dt * v116 * creature_move_speed[2 * v1] * 30.0;
                      *(float *)&creature_vel_y[2 * v1] = sin(v55)
                                                        * frame_dt
                                                        * v116
                                                        * creature_move_speed[2 * v1]
                                                        * 30.0;
                      vec2_add_inplace(i, (float *)(8 * v1 + 4833100), v99);
                    }
                    else
                    {
                      creature_vel_y[2 * v1] = 0;
                      creature_vel_x[2 * v1] = 0;
                    }
                    v56 = creature_spawn_slot_timer[6 * creature_link_index[2 * v1]] - frame_dt;
                    v57 = 24 * creature_link_index[2 * v1] + 4739024;
                    creature_spawn_slot_timer[6 * creature_link_index[2 * v1]] = v56;
                    if ( v59 )
                    {
                      v60 = *(_DWORD *)(v57 + 4);
                      v61 = *(_DWORD *)(v57 + 8);
                      *(float *)(v57 + 16) = v56 + *(float *)(v57 + 12);
                      if ( v61 > v60 )
                      {
                        *(_DWORD *)(v57 + 4) = v60 + 1;
                        creature_spawn_template(*(_DWORD *)(v57 + 20), 8 * v1 + 4833100, -1027080192);
                      }
                    }
                  }
                  else if ( creature_ai_mode[2 * v1] != 7 )
                  {
                    v110 = creature_move_speed[2 * v1] * 0.33333334 * 4.0;
                    angle_approach((float *)(8 * v1 + 4833124), *(&creature_target_heading + 2 * v1), v110);
                    v62 = *(&creature_heading + 2 * v1) - 1.5707964;
                    v100 = (float *)(8 * v1 + 4833108);
                    *v100 = cos(v62) * frame_dt * v116 * creature_move_speed[2 * v1] * 30.0;
                    *(float *)&creature_vel_y[2 * v1] = sin(v62) * frame_dt * v116 * creature_move_speed[2 * v1] * 30.0;
                    vec2_add_inplace(i, (float *)(8 * v1 + 4833100), v100);
                  }
                  if ( perk_count_get(perk_id_plaguebearer) && plaguebearer_infection_count < 60 )
                    sub_425D80(i);
                  v63 = 30.0 / *(&creature_size + 2 * v1);
                  v64 = creature_flags[2 * v1];
                  if ( (v64 & 4) == 0 || (v64 & 0x40) != 0 )
                  {
                    if ( creature_ai_mode[2 * v1] != 7 )
                    {
                      v68 = v63
                          * (*(float *)&creature_type_anim_rate[17 * *(&creature_type_id + 2 * v1)]
                           * creature_move_speed[2 * v1]
                           * frame_dt)
                          * v116
                          * 25.0
                          + creature_anim_phase[2 * v1];
                      creature_anim_phase[2 * v1] = v68;
                      if ( v68 > 31.0 )
                      {
                        do
                        {
                          v69 = creature_anim_phase[2 * v1] - 31.0;
                          creature_anim_phase[2 * v1] = v69;
                        }
                        while ( v69 > 31.0 );
                      }
                    }
                  }
                  else
                  {
                    v65 = v63
                        * (*(float *)&creature_type_anim_rate[17 * *(&creature_type_id + 2 * v1)]
                         * creature_move_speed[2 * v1]
                         * frame_dt)
                        * v116
                        * 22.0
                        + creature_anim_phase[2 * v1];
                    creature_anim_phase[2 * v1] = v65;
                    if ( v65 > 15.0 )
                    {
                      v66 = creature_anim_phase[2 * v1];
                      do
                      {
                        v67 = v66 - 15.0;
                        v66 = v67;
                      }
                      while ( v67 > 15.0 );
                      creature_anim_phase[2 * v1] = v67;
                    }
                  }
                  if ( creature_attack_cooldown[2 * v1] <= 0.0 )
                    creature_attack_cooldown[2 * v1] = 0.0;
                  else
                    creature_attack_cooldown[2 * v1] = creature_attack_cooldown[2 * v1] - frame_dt;
                  v70 = (float *)&player_pos_x[216 * creature_target_player[8 * v1]];
                  v71 = creature_pos_y[2 * v1] - v70[1];
                  v72 = *((float *)&creature_pos_x + 2 * v1) - *v70;
                  v73 = sqrt(v71 * v71 + v72 * v72);
                  v115 = v73;
                  if ( v73 < 100.0 )
                  {
                    if ( perk_count_get(perk_id_radioactive) )
                    {
                      v74 = *(float *)&creature_collision_timer[2 * v1] - frame_dt * 1.5;
                      *(float *)&creature_collision_timer[2 * v1] = v74;
                      if ( v74 < 0.0 && *(float *)&creature_health[2 * v1] > 0.0 )
                      {
                        creature_collision_timer[2 * v1] = 1056964608;
                        creature_state_flag[8 * v1] = 1;
                        v75 = *(float *)&creature_health[2 * v1] - (100.0 - v115) * 0.30000001;
                        *(float *)&creature_health[2 * v1] = v75;
                        if ( v75 < 0.0 )
                        {
                          if ( *(&creature_type_id + 2 * v1) == 1 )
                          {
                            creature_health[2 * v1] = 1065353216;
                          }
                          else
                          {
                            player_experience[0] = (__int64)((double)player_experience[0] + creature_reward_value[2 * v1]);
                            *(float *)&creature_hitbox_size[2 * v1] = *(float *)&creature_hitbox_size[2 * v1] - frame_dt;
                          }
                        }
                        fx_queue_add_random(8 * v1 + 4833100);
                      }
                    }
                  }
                  if ( v115 > 64.0 )
                  {
                    if ( (creature_flags[2 * v1] & 0x10) != 0 && creature_attack_cooldown[2 * v1] <= 0.0 )
                    {
                      projectile_spawn((_DWORD *)(8 * v1 + 4833100), *(&creature_heading + 2 * v1), 9, i);
                      v97 = sfx_shock_fire;
                      creature_attack_cooldown[2 * v1] = creature_attack_cooldown[2 * v1] + 1.0;
                      sfx_play_panned(v97, 8 * v1 + 4833100, 1.0);
                    }
                    if ( (creature_flags[2 * v1] & 0x100) != 0 && creature_attack_cooldown[2 * v1] <= 0.0 )
                    {
                      projectile_spawn(
                        (_DWORD *)(8 * v1 + 4833100),
                        *(&creature_heading + 2 * v1),
                        *(&creature_orbit_radius + 2 * v1),
                        i);
                      v119 = crt_rand() & 3;
                      v98 = sfx_plasmaminigun_fire;
                      creature_attack_cooldown[2 * v1] = (double)v119 * 0.1
                                                       + creature_orbit_angle[2 * v1]
                                                       + creature_attack_cooldown[2 * v1];
                      sfx_play_panned(v98, 8 * v1 + 4833100, 0.80000001);
                    }
                  }
                  if ( v115 < 20.0 )
                  {
                    *((float *)&creature_pos_x + 2 * v1) = *((float *)&creature_pos_x + 2 * v1)
                                                         - *(float *)&creature_vel_x[2 * v1];
                    creature_pos_y[2 * v1] = creature_pos_y[2 * v1] - *(float *)&creature_vel_y[2 * v1];
                    if ( creature_max_health[2 * v1] < 380.0 && bonus_energizer_timer > 0.0 )
                    {
                      player_experience[0] = (__int64)((double)player_experience[0] + creature_reward_value[2 * v1]);
                      effect_spawn_burst(8 * v1 + 4833100, 6);
                      sfx_play_panned(sfx_ui_bonus, 8 * v1 + 4833100, 0.80000001);
                      bonus_spawn_guard = 1;
                      creature_handle_death(i, 0);
                      bonus_spawn_guard = 0;
                    }
                  }
                  if ( *(&creature_size + 2 * v1) > 16.0 )
                  {
                    if ( v115 >= 30.0 )
                      goto LABEL_184;
                    if ( *(float *)&player_health[216 * creature_target_player[8 * v1]] > 0.0
                      && bonus_energizer_timer <= 0.0 )
                    {
                      if ( creature_attack_cooldown[2 * v1] <= 0.0 )
                      {
                        v76 = crt_rand() % 2;
                        sfx_play_panned(
                          *(&creature_type_sfx_b0 + 17 * *(&creature_type_id + 2 * v1) + v76),
                          8 * v1 + 4833100,
                          1.0);
                        if ( perk_count_get(perk_id_mr_melee) )
                        {
                          v126[0] = 0;
                          v126[1] = 0;
                          creature_apply_damage(i, 25.0, 2, (float *)v126);
                        }
                        if ( *(float *)&player_shield_timer[216 * creature_target_player[8 * v1]] <= 0.0 )
                        {
                          if ( perk_count_get(perk_id_toxic_avenger) )
                          {
                            v77 = creature_flags[2 * v1];
                            LOBYTE(v77) = v77 | 3;
                            goto LABEL_151;
                          }
                          if ( perk_count_get(perk_id_veins_of_poison) )
                          {
                            v77 = creature_flags[2 * v1];
                            LOBYTE(v77) = v77 | 1;
LABEL_151:
                            creature_flags[2 * v1] = v77;
                          }
                        }
                        player_take_damage(creature_target_player[8 * v1], *(&creature_contact_damage + 2 * v1));
                        v78 = (float *)&player_pos_x[216 * creature_target_player[8 * v1]];
                        v79 = v78[1] - creature_pos_y[2 * v1];
                        v120 = *v78 - *((float *)&creature_pos_x + 2 * v1);
                        v121 = v79;
                        j_FUN_00452f1d(&v120);
                        v80 = (float *)&player_pos_x[216 * creature_target_player[8 * v1]];
                        v81 = v121 * 3.0 + v80[1];
                        v127[0] = v120 * 3.0 + *v80;
                        v127[1] = v81;
                        fx_queue_add_random(v127);
                        creature_attack_cooldown[2 * v1] = creature_attack_cooldown[2 * v1] + 1.0;
                      }
                      if ( player_plaguebearer_active[864 * creature_target_player[8 * v1]]
                        && *(float *)&creature_health[2 * v1] < 150.0
                        && plaguebearer_infection_count < 50 )
                      {
                        creature_collision_flag[8 * v1] = 1;
                      }
                    }
                  }
                  if ( v115 < 30.0 && *(&creature_size + 2 * v1) <= 30.0 )
                  {
                    creature_health[2 * v1] = 0;
                    *(float *)&creature_hitbox_size[2 * v1] = *(float *)&creature_hitbox_size[2 * v1] - frame_dt;
                  }
                  goto LABEL_184;
                }
                if ( *((float *)&creature_orbit_radius + 2 * v1) > 0.0 && (creature_flags[2 * v1] & 0x80) == 0 )
                {
                  v43 = *((float *)&creature_orbit_radius + 2 * v1) - frame_dt;
                  v44 = creature_pos_y[2 * v1];
                  LODWORD(creature_target_x[2 * v1]) = *(&creature_pos_x + 2 * v1);
                  creature_target_y[2 * v1] = v44;
                  *((float *)&creature_orbit_radius + 2 * v1) = v43;
                  goto LABEL_76;
                }
                break;
              case 6:
                v45 = 38 * creature_link_index[2 * v1];
                if ( *(float *)&creature_health[v45] > 0.0 )
                {
                  v46 = creature_orbit_angle[2 * v1] + *(&creature_heading + 2 * v1);
                  creature_target_x[2 * v1] = cos(v46) * *((float *)&creature_orbit_radius + 2 * v1)
                                            + *((float *)&creature_pos_x + 38 * creature_link_index[2 * v1]);
                  creature_target_y[2 * v1] = sin(v46) * *((float *)&creature_orbit_radius + 2 * v1)
                                            + *(float *)(v45 * 4 + 4833104);
                  goto LABEL_76;
                }
                break;
              default:
                goto LABEL_76;
            }
            creature_ai_mode[2 * v1] = 0;
            goto LABEL_76;
          }
        }
        else
        {
          v83 = frame_dt;
          if ( v84 | v85 )
          {
            *(float *)&creature_hitbox_size[2 * v1] = *(float *)&creature_hitbox_size[2 * v1] - v83 * 20.0;
          }
          else
          {
            v118 = *(float *)&creature_hitbox_size[2 * v1] - v83 * 28.0;
            *(float *)&creature_hitbox_size[2 * v1] = v118;
            if ( v118 > 0.0 )
            {
              v94 = creature_flags[2 * v1];
              if ( (v94 & 4) == 0 || (v94 & 0x40) != 0 )
              {
                v95 = *(&creature_heading + 2 * v1) - 1.5707964;
                *(float *)&creature_vel_x[2 * v1] = cos(v95) * v118 * frame_dt * 9.0;
                *(float *)&creature_vel_y[2 * v1] = sin(v95) * v118 * frame_dt * 9.0;
                *((float *)&creature_pos_x + 2 * v1) = *((float *)&creature_pos_x + 2 * v1)
                                                     - *(float *)&creature_vel_x[2 * v1];
                creature_pos_y[2 * v1] = creature_pos_y[2 * v1] - *(float *)&creature_vel_y[2 * v1];
              }
              else
              {
                creature_vel_x[2 * v1] = 0;
                creature_vel_y[2 * v1] = 0;
              }
            }
            else
            {
              if ( config_fx_toggle )
                goto LABEL_169;
              v86 = creature_flags[2 * v1];
              if ( (v86 & 4) == 0 || (v86 & 0x40) != 0 )
              {
                v89 = *(&creature_size + 2 * v1) * 0.5;
                v90 = *(&creature_heading + 2 * v1);
                v111 = *(&creature_type_id + 2 * v1);
                v105 = *(&creature_size + 2 * v1);
                v131 = v89;
                *(float *)v129 = *((float *)&creature_pos_x + 2 * v1) - v131;
                *(float *)&v129[1] = creature_pos_y[2 * v1] - v89;
                v88 = fx_queue_add_rotated((int)v129, 8 * v1 + 4833140, v90, v105, v111);
              }
              else
              {
                v87 = *(&creature_size + 2 * v1) * 0.5;
                v104 = *(&creature_size + 2 * v1);
                v103 = *(&creature_heading + 2 * v1);
                v130 = v87;
                v128[0] = *((float *)&creature_pos_x + 2 * v1) - v130;
                v128[1] = creature_pos_y[2 * v1] - v87;
                v88 = fx_queue_add_rotated((int)v128, 8 * v1 + 4833140, v103, v104, 7);
              }
              if ( v88 )
              {
LABEL_169:
                ++creature_kill_count;
                if ( !config_fx_toggle && (creature_flags[2 * v1] & 4) != 0 )
                {
                  v91 = 8;
                  do
                  {
                    v106 = (double)(crt_rand() % 612) * 0.0099999998;
                    effect_spawn_blood_splatter(8 * v1 + 4833100, v106, 0.0);
                    --v91;
                  }
                  while ( v91 );
                  v92 = 6;
                  do
                  {
                    v107 = (double)(crt_rand() % 612) * 0.0099999998;
                    effect_spawn_blood_splatter(8 * v1 + 4833100, v107, -0.07);
                    --v92;
                  }
                  while ( v92 );
                  v93 = 5;
                  do
                  {
                    v108 = (double)(crt_rand() % 612) * 0.0099999998;
                    effect_spawn_blood_splatter(8 * v1 + 4833100, v108, -0.12);
                    --v93;
                  }
                  while ( v93 );
                }
                if ( *(float *)(dword_48085C + 12) == 0.0 )
                  creature_pool[8 * v1] = 0;
              }
              else
              {
                creature_hitbox_size[2 * v1] = 981668463;
              }
            }
          }
        }
      }
    }
LABEL_184:
    result = ++i;
    if ( i >= 384 )
      break;
  }
  return result;
}

// fx_queue_add_random @ 0x00427700
// spawns a random fx_queue_add entry (effect ids 3..7) with grayscale color/size
char __cdecl sub_427700(float *a1)
{
  char result; // al
  double v2; // st7
  int v3; // eax
  int v4; // [esp+0h] [ebp-10h]
  int v5; // [esp+4h] [ebp-Ch]
  int v6[2]; // [esp+8h] [ebp-8h] BYREF

  result = config_fx_toggle;
  if ( !config_fx_toggle )
  {
    if ( (byte_4912B0 & 1) == 0 )
    {
      qmemcpy(&fx_queue_random_color_r, "fff?fff?fff?", 12);
      byte_4912B0 |= 1u;
      fx_queue_random_color_a = 1061662228;
      crt_atexit(nullsub_42);
    }
    *(float *)&fx_queue_random_color_b = (double)(crt_rand() & 0xF) * 0.0099999998 + 0.83999997;
    fx_queue_random_color_g = fx_queue_random_color_b;
    fx_queue_random_color_r = fx_queue_random_color_b;
    *(float *)&v4 = (double)(crt_rand() % 24 - 12) + 30.0;
    *(float *)&v5 = (double)(crt_rand() % 628) * 0.0099999998;
    v2 = *(float *)&v4 * 0.5;
    *(float *)v6 = v2;
    *(float *)v6 = *a1 - *(float *)v6;
    *(float *)&v6[1] = a1[1] - v2;
    v3 = crt_rand();
    return fx_queue_add(v3 % 5 + 3, v6, v4, v4, v5, &fx_queue_random_color_r);
  }
  return result;
}

// nullsub_42 @ 0x00427830
void __cdecl nullsub_42()
{
  ;
}

// fx_queue_add_rotated @ 0x00427840
// pushes a rotated sprite into DAT_004aaf3c (capped at 0x40); returns 1 on success
char __cdecl sub_427840(int *a1, int *a2, float a3, float a4, int a5)
{
  int v5; // edx
  int *v7; // eax
  double v8; // st7

  if ( !terrain_texture_failed )
  {
    v5 = fx_queue_rotated;
    if ( fx_queue_rotated == 63 )
      return 0;
    v7 = &fx_rotated_color_r[4 * fx_queue_rotated];
    *v7 = *a2;
    v7[1] = a2[1];
    v7[2] = a2[2];
    v7[3] = a2[3];
    if ( *(float *)(dword_480860 + 12) == 0.0 )
      v8 = fx_rotated_color_a[4 * v5] * 0.80000001;
    else
      v8 = 1.0 / *(float *)(dword_480860 + 12) * fx_rotated_color_a[4 * v5];
    fx_rotated_color_a[4 * v5] = v8;
    fx_rotated_rotation[v5] = a3;
    fx_rotated_effect_id[v5] = a5;
    fx_rotated_scale[v5] = a4;
    fx_rotated_pos_x[2 * v5] = *a1;
    fx_rotated_pos_y[2 * v5] = a1[1];
    fx_queue_rotated = v5 + 1;
    if ( v5 + 1 >= 64 )
      fx_queue_rotated = 63;
  }
  return 1;
}

// fx_queue_render @ 0x00427920
// renders DAT_004aaf18/DAT_004aaf3c queues and clears them
int sub_427920()
{
  int result; // eax
  int v1; // esi
  float *v2; // ebp
  float *v3; // edi
  int v4; // eax
  int v5; // ebx
  double v6; // st7
  double v7; // st7
  double v8; // st7
  int v9; // esi
  float *v10; // ebx
  _DWORD *v11; // edi
  int v12; // eax
  int v13; // ebp
  double v14; // st7
  int v15; // edi
  int *v16; // esi
  int v17; // esi
  float *v18; // ebp
  float *v19; // edi
  int v20; // eax
  int v21; // ebx
  double v22; // st7
  double v23; // st7
  double v24; // st7
  int v25; // esi
  float *v26; // ebp
  _DWORD *v27; // edi
  int v28; // eax
  int v29; // ecx
  double v30; // st7
  float v31; // [esp+E4h] [ebp-40h]
  float v32; // [esp+E4h] [ebp-40h]
  float v33; // [esp+E4h] [ebp-40h]
  float v34; // [esp+E4h] [ebp-40h]
  float v35; // [esp+E4h] [ebp-40h]
  int v36; // [esp+E8h] [ebp-3Ch]
  int v37; // [esp+E8h] [ebp-3Ch]
  int v38; // [esp+E8h] [ebp-3Ch]
  float v39; // [esp+E8h] [ebp-3Ch]
  int v40; // [esp+E8h] [ebp-3Ch]
  float v41; // [esp+E8h] [ebp-3Ch]
  float v42; // [esp+E8h] [ebp-3Ch]
  int v43; // [esp+E8h] [ebp-3Ch]
  int v44; // [esp+E8h] [ebp-3Ch]
  float v45; // [esp+E8h] [ebp-3Ch]
  int v46; // [esp+E8h] [ebp-3Ch]
  float v47; // [esp+E8h] [ebp-3Ch]
  int v48; // [esp+ECh] [ebp-38h]
  int v49; // [esp+ECh] [ebp-38h]
  int v50; // [esp+ECh] [ebp-38h]
  float v51; // [esp+ECh] [ebp-38h]
  int v52; // [esp+ECh] [ebp-38h]
  int v53; // [esp+ECh] [ebp-38h]
  int v54; // [esp+ECh] [ebp-38h]
  int v55; // [esp+ECh] [ebp-38h]
  int v56; // [esp+F0h] [ebp-34h]
  int v57; // [esp+F0h] [ebp-34h]
  float v58; // [esp+F0h] [ebp-34h]
  float v59; // [esp+F0h] [ebp-34h]
  int v60; // [esp+F0h] [ebp-34h]
  float v61; // [esp+F0h] [ebp-34h]
  float v62; // [esp+F0h] [ebp-34h]
  int v63; // [esp+F0h] [ebp-34h]
  int v64; // [esp+F0h] [ebp-34h]
  int v65; // [esp+F0h] [ebp-34h]
  float v66; // [esp+F0h] [ebp-34h]
  float v67; // [esp+F0h] [ebp-34h]
  int v68; // [esp+F0h] [ebp-34h]
  float v69; // [esp+F0h] [ebp-34h]
  float v70; // [esp+104h] [ebp-20h]
  float v71; // [esp+108h] [ebp-1Ch]
  float v72; // [esp+108h] [ebp-1Ch]
  int v73; // [esp+10Ch] [ebp-18h]
  float v74; // [esp+10Ch] [ebp-18h]
  float v75; // [esp+10Ch] [ebp-18h]
  int v76; // [esp+110h] [ebp-14h]
  int v77; // [esp+114h] [ebp-10h]
  int v78; // [esp+114h] [ebp-10h]
  int v79; // [esp+114h] [ebp-10h]
  int v80; // [esp+118h] [ebp-Ch]
  int v81; // [esp+118h] [ebp-Ch]
  int v82; // [esp+118h] [ebp-Ch]
  int v83; // [esp+11Ch] [ebp-8h]
  int v84; // [esp+11Ch] [ebp-8h]
  int v85; // [esp+120h] [ebp-4h]
  int v86; // [esp+120h] [ebp-4h]

  result = fx_queue_rotated;
  v70 = 1.0 / *(float *)config_texture_scale;
  v71 = 1.0 / ((double)terrain_texture_width / *(float *)config_texture_scale * 0.5);
  if ( terrain_texture_failed )
  {
    if ( fx_queue_rotated > 0 )
    {
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
        grim_interface_ptr,
        bodyset_texture,
        0);
      (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 19, 1);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v37,
        v48,
        v56);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v1 = 0;
      if ( fx_queue_rotated > 0 )
      {
        v2 = (float *)fx_rotated_pos_x;
        v3 = (float *)&fx_rotated_color_b;
        do
        {
          v4 = creature_type_corpse_frame[17 * fx_rotated_effect_id[v1]];
          v5 = LODWORD(effect_uv4_v[2 * v4]);
          dword_4965D8 = effect_uv4_u[2 * v4];
          dword_4965DC = v5;
          *(float *)&v77 = *(float *)&effect_uv4_u[2 * v4] + 0.25;
          v6 = effect_uv4_v[2 * v4] + 0.25;
          dword_4965E0 = v77;
          *(float *)&v80 = v6;
          dword_4965E4 = v80;
          (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
            grim_interface_ptr,
            dword_4965D8,
            v5,
            v77,
            v80);
          v58 = v3[1] * 0.5;
          (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
            grim_interface_ptr,
            *((_DWORD *)v3 - 2),
            *((_DWORD *)v3 - 1),
            *(_DWORD *)v3,
            LODWORD(v58));
          v59 = fx_rotated_rotation[v1] - 1.5707964;
          (*(void (__stdcall **)(_DWORD))(*(_DWORD *)grim_interface_ptr + 252))(LODWORD(v59));
          *(float *)&v73 = *v2 + 2.0;
          v7 = v2[1] + 2.0;
          dword_4965D8 = v73;
          *(float *)&v76 = v7;
          v8 = fx_rotated_scale[v1] * 1.04;
          dword_4965DC = v76;
          v72 = v8;
          v39 = *(float *)&v76 + *(float *)&camera_offset_y;
          v31 = *(float *)&v73 + *(float *)&camera_offset_x;
          (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v31),
            LODWORD(v39),
            LODWORD(v72),
            LODWORD(v72));
          ++v1;
          v3 += 4;
          v2 += 2;
        }
        while ( v1 < fx_queue_rotated );
      }
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v38,
        v49,
        v57);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v40,
        v50,
        v60);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v9 = 0;
      if ( fx_queue_rotated > 0 )
      {
        v10 = (float *)fx_rotated_pos_x;
        v11 = &fx_rotated_color_b;
        do
        {
          v12 = creature_type_corpse_frame[17 * fx_rotated_effect_id[v9]];
          v13 = LODWORD(effect_uv4_v[2 * v12]);
          dword_4965D8 = effect_uv4_u[2 * v12];
          dword_4965DC = v13;
          *(float *)&v78 = *(float *)&effect_uv4_u[2 * v12] + 0.25;
          v14 = effect_uv4_v[2 * v12] + 0.25;
          dword_4965E0 = v78;
          *(float *)&v81 = v14;
          dword_4965E4 = v81;
          (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
            grim_interface_ptr,
            dword_4965D8,
            v13,
            v78,
            v81);
          (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
            grim_interface_ptr,
            *(v11 - 2),
            *(v11 - 1),
            *v11,
            v11[1]);
          v61 = fx_rotated_rotation[v9] - 1.5707964;
          (*(void (__stdcall **)(_DWORD))(*(_DWORD *)grim_interface_ptr + 252))(LODWORD(v61));
          v41 = *(float *)&camera_offset_y + v10[1];
          v32 = *(float *)&camera_offset_x + *v10;
          (*(void (__stdcall **)(_DWORD, _DWORD, float, float))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v32),
            LODWORD(v41),
            fx_rotated_scale[v9],
            fx_rotated_scale[v9]);
          ++v9;
          v11 += 4;
          v10 += 2;
        }
        while ( v9 < fx_queue_rotated );
      }
      return (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    }
  }
  else if ( fx_queue_rotated || (result = fx_queue_count) != 0 )
  {
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 48))(grim_interface_ptr, terrain_render_target);
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      particles_texture,
      0);
    if ( fx_queue_count > 0 )
    {
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
        grim_interface_ptr,
        0,
        0,
        1065353216,
        1065353216);
      v15 = 0;
      if ( fx_queue_count > 0 )
      {
        v16 = fx_queue_rotation;
        do
        {
          (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, v16 + 5);
          (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, *v16);
          effect_select_texture(*(v16 - 1));
          v62 = v70 * *((float *)v16 + 3);
          v51 = v70 * *((float *)v16 + 4);
          v42 = (*((float *)v16 + 2) - *((float *)v16 + 3) * 0.5) * v70;
          v33 = (*((float *)v16 + 1) - *((float *)v16 + 4) * 0.5) * v70;
          (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v33),
            LODWORD(v42),
            LODWORD(v51),
            LODWORD(v62));
          ++v15;
          v16 += 10;
        }
        while ( v15 < fx_queue_count );
      }
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    }
    if ( fx_queue_rotated > 0 )
    {
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
        grim_interface_ptr,
        bodyset_texture,
        0);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        1,
        v36,
        v52,
        v63);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v43,
        v53,
        v64);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v17 = 0;
      if ( fx_queue_rotated > 0 )
      {
        v18 = (float *)fx_rotated_pos_x;
        v19 = (float *)&fx_rotated_color_b;
        do
        {
          v20 = creature_type_corpse_frame[17 * fx_rotated_effect_id[v17]];
          v21 = LODWORD(effect_uv4_v[2 * v20]);
          dword_4965D8 = effect_uv4_u[2 * v20];
          dword_4965DC = v21;
          *(float *)&v83 = *(float *)&effect_uv4_u[2 * v20] + 0.25;
          v22 = effect_uv4_v[2 * v20] + 0.25;
          dword_4965E0 = v83;
          *(float *)&v85 = v22;
          dword_4965E4 = v85;
          (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
            grim_interface_ptr,
            dword_4965D8,
            v21,
            v83,
            v85);
          v66 = v19[1] * 0.5;
          (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
            grim_interface_ptr,
            *((_DWORD *)v19 - 2),
            *((_DWORD *)v19 - 1),
            *(_DWORD *)v19,
            LODWORD(v66));
          v67 = fx_rotated_rotation[v17] - 1.5707964;
          (*(void (__stdcall **)(_DWORD))(*(_DWORD *)grim_interface_ptr + 252))(LODWORD(v67));
          *(float *)&v79 = *v18 - 0.5;
          v23 = v18[1] - 0.5;
          dword_4965D8 = v79;
          *(float *)&v82 = v23;
          v24 = v70 * fx_rotated_scale[v17];
          dword_4965DC = v82;
          v74 = v24 * 1.064;
          v45 = *(float *)&v82 * v70 - v71;
          v34 = *(float *)&v79 * v70 - v71;
          (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v34),
            LODWORD(v45),
            LODWORD(v74),
            LODWORD(v74));
          ++v17;
          v19 += 4;
          v18 += 2;
        }
        while ( v17 < fx_queue_rotated );
      }
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v44,
        v54,
        v65);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v46,
        v55,
        v68);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v25 = 0;
      if ( fx_queue_rotated > 0 )
      {
        v26 = (float *)fx_rotated_pos_x;
        v27 = &fx_rotated_color_b;
        do
        {
          v28 = creature_type_corpse_frame[17 * fx_rotated_effect_id[v25]];
          v29 = LODWORD(effect_uv4_v[2 * v28]);
          dword_4965D8 = effect_uv4_u[2 * v28];
          dword_4965DC = v29;
          *(float *)&v84 = *(float *)&effect_uv4_u[2 * v28] + 0.25;
          v30 = effect_uv4_v[2 * v28] + 0.25;
          dword_4965E0 = v84;
          *(float *)&v86 = v30;
          dword_4965E4 = v86;
          (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
            grim_interface_ptr,
            dword_4965D8,
            v29,
            v84,
            v86);
          (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
            grim_interface_ptr,
            *(v27 - 2),
            *(v27 - 1),
            *v27,
            v27[1]);
          v69 = fx_rotated_rotation[v25] - 1.5707964;
          (*(void (__stdcall **)(_DWORD))(*(_DWORD *)grim_interface_ptr + 252))(LODWORD(v69));
          v75 = v70 * fx_rotated_scale[v25];
          v47 = v70 * v26[1] - v71;
          v35 = v70 * *v26 - v71;
          (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v35),
            LODWORD(v47),
            LODWORD(v75),
            LODWORD(v75));
          ++v25;
          v27 += 4;
          v26 += 2;
        }
        while ( v25 < fx_queue_rotated );
      }
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    }
    fx_queue_count = 0;
    fx_queue_rotated = 0;
    return (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 48))(grim_interface_ptr, -1);
  }
  return result;
}

// creature_alloc_slot @ 0x00428140
// finds a free creature entry in DAT_0049bf38 and seeds defaults
int sub_428140()
{
  int v0; // edi
  char *v1; // eax
  int v3; // eax

  v0 = 0;
  v1 = creature_pool;
  do
  {
    if ( !*v1 )
    {
      creature_flags[38 * v0] = 0;
      creature_phase_seed[38 * v0] = crt_rand() & 0x17F;
      v3 = creature_spawned_count + 1;
      dword_49BFAC[38 * v0] = 0;
      creature_anim_phase[38 * v0] = 0.0;
      creature_spawned_count = v3;
      return v0;
    }
    v1 += 152;
    ++v0;
  }
  while ( (int)v1 < (int)byte_4AA338 );
  if ( *(float *)(dword_480864 + 12) != 0.0 )
    console_printf((int)&console_log_queue, aNoFreeCreature);
  return 384;
}

// FUN_004281e0 @ 0x004281E0
// [binja] void* sub_4281e0()
int *sub_4281E0()
{
  int *result; // eax

  result = creature_flags;
  do
  {
    *((_BYTE *)result - 140) = 0;
    if ( (*(_BYTE *)result & 4) != 0 )
      creature_spawn_slot_owner[6 * *(result - 5)] = 0;
    result += 38;
  }
  while ( (int)result < (int)&unk_4AA3C4 );
  return result;
}

// creatures_none_active @ 0x00428210
// returns low byte 1 when no active creature entries exist (0 otherwise); sets DAT_0048700c
char sub_428210()
{
  char *v0; // eax

  v0 = creature_pool;
  while ( !*v0 )
  {
    v0 += 152;
    if ( (int)v0 >= (int)byte_4AA338 )
    {
      creatures_any_active_flag = 1;
      return 1;
    }
  }
  creatures_any_active_flag = 0;
  return 0;
}

// creature_spawn @ 0x00428240
// allocates a creature slot and seeds position, type, and tint defaults
int __cdecl sub_428240(int a1, int *a2, int a3)
{
  int v3; // edi
  int v4; // esi
  double v5; // st7
  int v6; // eax
  int *v7; // edx
  int v8; // ecx
  double v10; // st7

  v3 = creature_alloc_slot();
  v4 = 152 * v3;
  *(int *)((char *)&creature_pos_x + v4) = *(_DWORD *)a1;
  creature_pos_y[v4 / 4u] = *(float *)(a1 + 4);
  *(int *)((char *)&creature_type_id + v4) = a3;
  creature_ai_mode[v4 / 4u] = 0;
  creature_collision_flag[v4] = 0;
  creature_collision_timer[v4 / 4u] = 0;
  creature_pool[v4] = 1;
  creature_force_target[v4] = 0;
  creature_state_flag[v4] = 1;
  creature_hitbox_size[v4 / 4u] = 1098907648;
  v5 = (double)survival_elapsed_ms;
  creature_vel_x[v4 / 4u] = 0;
  creature_vel_y[v4 / 4u] = 0;
  *(float *)(v4 + 4833116) = v5 * 0.0001 + 10.0;
  *(float *)(v4 + 4833124) = (double)(crt_rand() % 314) * 0.0099999998;
  *(float *)(v4 + 4833172) = (double)survival_elapsed_ms * 0.000010000001 + 2.5;
  v6 = crt_rand();
  creature_attack_cooldown[v4 / 4u] = 0.0;
  v7 = &creature_tint_r + 38 * v3;
  *(float *)(v4 + 4833180) = (float)(v6 % 30 + 140);
  *v7 = *a2;
  v7[1] = a2[1];
  v7[2] = a2[2];
  v8 = creature_health[38 * v3];
  v7[3] = a2[3];
  v10 = (double)survival_elapsed_ms;
  *(float *)((char *)&creature_contact_damage + v4) = 4.0;
  LODWORD(creature_max_health[v4 / 4u]) = v8;
  *(float *)(v4 + 4833132) = v10 * 0.000010000001 + 47.0;
  return v3;
}

// player_render_overlays @ 0x00428390
// renders per-player overlays/indicators using DAT_004908** tables
void sub_428390()
{
  int v0; // esi
  int v1; // edx
  double v2; // st7
  double v3; // st7
  double v4; // st7
  int v5; // edx
  long double v6; // st7
  int v7; // edi
  int v8; // edx
  int *v9; // esi
  double v10; // st7
  double v11; // st7
  double v12; // st7
  int v13; // eax
  int v14; // edx
  float *v15; // edi
  double v16; // st7
  double v17; // st7
  double v18; // st7
  int v19; // edx
  double v20; // st7
  int v21; // edx
  double v22; // st7
  double v23; // st7
  int v24; // ecx
  float *v25; // ecx
  long double v26; // st7
  int v27; // edx
  long double v28; // st7
  long double v29; // st7
  long double v30; // st6
  long double v31; // st7
  double v32; // st7
  double v33; // st7
  double v34; // st7
  double v35; // st7
  int v36; // edi
  double v37; // st7
  int v38; // edi
  int *v39; // esi
  double v40; // st6
  double v41; // st4
  double v42; // st7
  double v43; // st7
  float v44; // [esp+2C4h] [ebp-4Ch]
  float v45; // [esp+2C4h] [ebp-4Ch]
  int v46; // [esp+2C4h] [ebp-4Ch]
  float v47; // [esp+2C4h] [ebp-4Ch]
  float v48; // [esp+2C4h] [ebp-4Ch]
  float v49; // [esp+2C4h] [ebp-4Ch]
  float v50; // [esp+2C4h] [ebp-4Ch]
  float v51; // [esp+2C4h] [ebp-4Ch]
  int v52; // [esp+2C8h] [ebp-48h]
  int v53; // [esp+2C8h] [ebp-48h]
  float v54; // [esp+2C8h] [ebp-48h]
  int v55; // [esp+2C8h] [ebp-48h]
  float v56; // [esp+2C8h] [ebp-48h]
  int v57; // [esp+2C8h] [ebp-48h]
  int v58; // [esp+2C8h] [ebp-48h]
  int v59; // [esp+2C8h] [ebp-48h]
  float v60; // [esp+2C8h] [ebp-48h]
  float v61; // [esp+2C8h] [ebp-48h]
  int v62; // [esp+2C8h] [ebp-48h]
  int v63; // [esp+2C8h] [ebp-48h]
  int v64; // [esp+2C8h] [ebp-48h]
  int v65; // [esp+2C8h] [ebp-48h]
  float v66; // [esp+2C8h] [ebp-48h]
  float v67; // [esp+2C8h] [ebp-48h]
  int v68; // [esp+2C8h] [ebp-48h]
  int v69; // [esp+2C8h] [ebp-48h]
  int v70; // [esp+2C8h] [ebp-48h]
  float v71; // [esp+2C8h] [ebp-48h]
  int v72; // [esp+2C8h] [ebp-48h]
  int v73; // [esp+2CCh] [ebp-44h]
  int v74; // [esp+2CCh] [ebp-44h]
  int v75; // [esp+2CCh] [ebp-44h]
  int v76; // [esp+2CCh] [ebp-44h]
  int v77; // [esp+2CCh] [ebp-44h]
  int v78; // [esp+2CCh] [ebp-44h]
  int v79; // [esp+2CCh] [ebp-44h]
  int v80; // [esp+2CCh] [ebp-44h]
  int v81; // [esp+2CCh] [ebp-44h]
  int v82; // [esp+2CCh] [ebp-44h]
  int v83; // [esp+2CCh] [ebp-44h]
  int v84; // [esp+2CCh] [ebp-44h]
  int v85; // [esp+2CCh] [ebp-44h]
  float v86; // [esp+2CCh] [ebp-44h]
  int v87; // [esp+2CCh] [ebp-44h]
  int v88; // [esp+2CCh] [ebp-44h]
  int v89; // [esp+2D0h] [ebp-40h]
  float v90; // [esp+2D0h] [ebp-40h]
  int v91; // [esp+2D0h] [ebp-40h]
  int v92; // [esp+2D0h] [ebp-40h]
  float v93; // [esp+2D0h] [ebp-40h]
  int v94; // [esp+2D0h] [ebp-40h]
  int v95; // [esp+2D0h] [ebp-40h]
  float v96; // [esp+2D0h] [ebp-40h]
  float v97; // [esp+2D0h] [ebp-40h]
  int v98; // [esp+2D0h] [ebp-40h]
  int v99; // [esp+2D0h] [ebp-40h]
  int v100; // [esp+2D0h] [ebp-40h]
  int v101; // [esp+2D0h] [ebp-40h]
  float v102; // [esp+2D0h] [ebp-40h]
  float v103; // [esp+2D0h] [ebp-40h]
  float v104; // [esp+2D0h] [ebp-40h]
  float v105; // [esp+2D0h] [ebp-40h]
  int v106; // [esp+2D0h] [ebp-40h]
  int v107; // [esp+2D0h] [ebp-40h]
  int v108; // [esp+2D0h] [ebp-40h]
  float v109; // [esp+2D0h] [ebp-40h]
  float v110; // [esp+2D0h] [ebp-40h]
  int v111; // [esp+2D0h] [ebp-40h]
  int v112; // [esp+2D0h] [ebp-40h]
  int v113; // [esp+2D0h] [ebp-40h]
  float v114; // [esp+2E4h] [ebp-2Ch]
  float v115; // [esp+2E8h] [ebp-28h]
  float v116; // [esp+2E8h] [ebp-28h]
  float v117; // [esp+2ECh] [ebp-24h]
  float v118; // [esp+2ECh] [ebp-24h]
  int v119; // [esp+2ECh] [ebp-24h]
  int v120; // [esp+2ECh] [ebp-24h]
  int v121; // [esp+2ECh] [ebp-24h]
  float v122; // [esp+2ECh] [ebp-24h]
  int v123; // [esp+2F0h] [ebp-20h]
  float v124; // [esp+2F0h] [ebp-20h]
  float v125; // [esp+2F0h] [ebp-20h]
  float v126; // [esp+2F0h] [ebp-20h]
  int v127; // [esp+2F4h] [ebp-1Ch]
  float v128; // [esp+2F4h] [ebp-1Ch]
  float v129; // [esp+2F8h] [ebp-18h]
  int v130; // [esp+2F8h] [ebp-18h]
  float v131; // [esp+2F8h] [ebp-18h]
  float v132; // [esp+2F8h] [ebp-18h]
  float v133; // [esp+2F8h] [ebp-18h]
  float v134; // [esp+2FCh] [ebp-14h]
  float v135; // [esp+2FCh] [ebp-14h]
  float v136; // [esp+2FCh] [ebp-14h]
  int v137; // [esp+2FCh] [ebp-14h]
  float v138; // [esp+2FCh] [ebp-14h]
  float v139; // [esp+2FCh] [ebp-14h]
  float v140; // [esp+2FCh] [ebp-14h]
  float v141; // [esp+2FCh] [ebp-14h]
  int v142; // [esp+300h] [ebp-10h]
  float v143; // [esp+300h] [ebp-10h]
  float v144; // [esp+300h] [ebp-10h]
  float v145; // [esp+300h] [ebp-10h]
  int v146; // [esp+304h] [ebp-Ch]
  float v147; // [esp+304h] [ebp-Ch]
  float v148; // [esp+304h] [ebp-Ch]
  float v149; // [esp+304h] [ebp-Ch]
  float v150; // [esp+308h] [ebp-8h] BYREF
  float v151; // [esp+30Ch] [ebp-4h]

  v114 = ui_transition_alpha;
  if ( !byte_48727C
    && ui_transition_alpha > 0.0
    && game_state_id != 20
    && game_state_id != 22
    && game_state_prev != 20
    && game_state_prev != 22 )
  {
    if ( perk_count_get(perk_id_radioactive) )
    {
      (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 19, 5);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        2,
        v53,
        v73,
        v89);
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
        grim_interface_ptr,
        particles_texture,
        0);
      effect_select_texture(16);
      v90 = ((sin(flt_47EA4C) + 1.0) * 0.1875 + 0.25) * v114;
      (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1050253722,
        1058642330,
        1050253722,
        LODWORD(v90));
      (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v54 = *(float *)&camera_offset_y + *(float *)&player_pos_y[216 * render_overlay_player_index] - 50.0;
      v44 = *(float *)&camera_offset_x + *(float *)&player_pos_x[216 * render_overlay_player_index] - 50.0;
      (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
        LODWORD(v44),
        LODWORD(v54),
        1120403456,
        1120403456);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    }
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      dword_48287C,
      0);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      1,
      v52,
      v74,
      v91);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      v55,
      v75,
      v92);
    if ( *(float *)&player_health[216 * render_overlay_player_index] <= 0.0 )
    {
      if ( player_death_timer[216 * render_overlay_player_index] >= 0.0 )
        v0 = (__int64)((1.0 - player_death_timer[216 * render_overlay_player_index] * 0.0625) * 20.0 + 32.0);
      else
        v0 = 52;
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v1 = LODWORD(effect_uv8_v[2 * v0]);
      dword_4965D8 = effect_uv8_u[2 * v0];
      dword_4965DC = v1;
      v150 = *(float *)&effect_uv8_u[2 * v0] + 0.125;
      v2 = effect_uv8_v[2 * v0] + 0.125;
      dword_4965E0 = LODWORD(v150);
      v151 = v2;
      dword_4965E4 = LODWORD(v151);
      (*(void (__thiscall **)(int, int, int, float, float))(*(_DWORD *)grim_interface_ptr + 256))(
        grim_interface_ptr,
        dword_4965D8,
        v1,
        COERCE_FLOAT(LODWORD(v150)),
        COERCE_FLOAT(LODWORD(v151)));
      v93 = v114 * 0.34999999;
      (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v93));
      (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 252))(
        grim_interface_ptr,
        player_aim_heading[216 * render_overlay_player_index]);
      v3 = *(float *)&player_size[216 * render_overlay_player_index] * 0.5;
      v150 = v3;
      v134 = *(float *)&camera_offset_y + *(float *)&player_pos_y[216 * render_overlay_player_index];
      *(float *)&v142 = *(float *)&camera_offset_x + *(float *)&player_pos_x[216 * render_overlay_player_index] - v150;
      dword_4965D8 = v142;
      *(float *)&v146 = v134 - v3;
      v4 = *(float *)&player_size[216 * render_overlay_player_index] * 1.03;
      dword_4965DC = v146;
      v117 = v4;
      v56 = *(float *)&v146 + 1.0;
      v45 = *(float *)&v142 + 1.0;
      (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
        LODWORD(v45),
        LODWORD(v56),
        LODWORD(v117),
        LODWORD(v117));
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v57,
        v76,
        v94);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v58,
        v77,
        v95);
      if ( config_player_count == 1 )
      {
        v96 = v114;
        v78 = 1065353216;
        v5 = *(_DWORD *)grim_interface_ptr;
        v59 = 1065353216;
      }
      else
      {
        v5 = *(_DWORD *)grim_interface_ptr;
        v96 = v114;
        if ( !render_overlay_player_index )
        {
          v78 = 1065353216;
          v59 = 1050253722;
          v46 = 1050253722;
LABEL_19:
          (*(void (__stdcall **)(int, int, int, float))(v5 + 276))(v46, v59, v78, COERCE_FLOAT(LODWORD(v96)));
          (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
          (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
            grim_interface_ptr,
            dword_4965D8,
            dword_4965DC,
            player_size[216 * render_overlay_player_index],
            player_size[216 * render_overlay_player_index]);
          (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
          return;
        }
        v78 = 1051931443;
        v59 = 1057803469;
      }
      v46 = 1065353216;
      goto LABEL_19;
    }
    v6 = *(float *)&player_aim_heading[216 * render_overlay_player_index] + 1.5707964;
    v7 = (__int64)(*((float *)&player_move_phase + 216 * render_overlay_player_index) + 0.5);
    v143 = cos(v6) * *(float *)&player_muzzle_flash_alpha[216 * render_overlay_player_index] * 12.0;
    v147 = sin(v6) * *(float *)&player_muzzle_flash_alpha[216 * render_overlay_player_index] * 12.0;
    v97 = v114 * 0.34999999;
    (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v97));
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 252))(
      grim_interface_ptr,
      player_heading[216 * render_overlay_player_index]);
    v8 = LODWORD(effect_uv8_v[2 * v7]);
    v9 = (int *)(8 * v7 + 4788240);
    dword_4965D8 = effect_uv8_u[2 * v7];
    dword_4965DC = v8;
    v150 = *(float *)&effect_uv8_u[2 * v7] + 0.125;
    v10 = effect_uv8_v[2 * v7] + 0.125;
    dword_4965E0 = LODWORD(v150);
    v151 = v10;
    dword_4965E4 = LODWORD(v151);
    (*(void (__thiscall **)(int, int, int, float, float))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      dword_4965D8,
      v8,
      COERCE_FLOAT(LODWORD(v150)),
      COERCE_FLOAT(LODWORD(v151)));
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v11 = *(float *)&player_size[216 * render_overlay_player_index] * 0.5 - 2.0;
    v150 = v11;
    v135 = *(float *)&camera_offset_y + *(float *)&player_pos_y[216 * render_overlay_player_index];
    *(float *)&v123 = *(float *)&camera_offset_x + *(float *)&player_pos_x[216 * render_overlay_player_index] - v150;
    dword_4965D8 = v123;
    *(float *)&v127 = v135 - v11;
    v12 = *(float *)&player_size[216 * render_overlay_player_index] * 1.02;
    dword_4965DC = v127;
    v129 = v12;
    v60 = *(float *)&v127 + 1.0;
    v47 = *(float *)&v123 + 1.0;
    (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
      LODWORD(v47),
      LODWORD(v60),
      LODWORD(v129),
      LODWORD(v129));
    v13 = dword_491090[2 * v7];
    v14 = dword_491094[2 * v7];
    v15 = (float *)(8 * v7 + 4788368);
    dword_4965D8 = v13;
    dword_4965DC = v14;
    v150 = *v15 + 0.125;
    v16 = v15[1] + 0.125;
    dword_4965E0 = LODWORD(v150);
    v151 = v16;
    dword_4965E4 = LODWORD(v151);
    (*(void (__thiscall **)(int, int, int, float, float))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      v13,
      v14,
      COERCE_FLOAT(LODWORD(v150)),
      COERCE_FLOAT(LODWORD(v151)));
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 252))(
      grim_interface_ptr,
      player_aim_heading[216 * render_overlay_player_index]);
    v17 = *(float *)&player_size[216 * render_overlay_player_index] * 0.5;
    v150 = v17;
    v136 = *(float *)&camera_offset_y + *(float *)&player_pos_y[216 * render_overlay_player_index];
    v150 = *(float *)&camera_offset_x + *(float *)&player_pos_x[216 * render_overlay_player_index] - v150;
    *(float *)&v130 = v150 + v143;
    dword_4965D8 = v130;
    *(float *)&v137 = v136 - v17 + v147;
    v18 = *(float *)&player_size[216 * render_overlay_player_index] * 1.03;
    dword_4965DC = v137;
    v118 = v18;
    v61 = *(float *)&v137 + 1.0;
    v48 = *(float *)&v130 + 1.0;
    (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
      LODWORD(v48),
      LODWORD(v61),
      LODWORD(v118),
      LODWORD(v118));
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      dword_48287C,
      0);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      5,
      v62,
      v79,
      v98);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      v63,
      v80,
      v99);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      COERCE_FLOAT(LODWORD(v114)));
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 252))(
      grim_interface_ptr,
      player_heading[216 * render_overlay_player_index]);
    v19 = v9[1];
    dword_4965D8 = *v9;
    dword_4965DC = v19;
    v150 = *(float *)v9 + 0.125;
    v151 = *((float *)v9 + 1) + 0.125;
    dword_4965E0 = LODWORD(v150);
    dword_4965E4 = LODWORD(v151);
    (*(void (__thiscall **)(int, int, int, float, float))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      dword_4965D8,
      v19,
      COERCE_FLOAT(LODWORD(v150)),
      COERCE_FLOAT(LODWORD(v151)));
    v20 = *(float *)&player_size[216 * render_overlay_player_index] * 0.5;
    v119 = player_size[216 * render_overlay_player_index];
    v150 = v20;
    v138 = *(float *)&camera_offset_y + *(float *)&player_pos_y[216 * render_overlay_player_index];
    v150 = *(float *)&camera_offset_x + *(float *)&player_pos_x[216 * render_overlay_player_index] - v150;
    dword_4965D8 = LODWORD(v150);
    v151 = v138 - v20;
    dword_4965DC = LODWORD(v151);
    (*(void (__thiscall **)(int, float, float, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v150)),
      COERCE_FLOAT(LODWORD(v151)),
      v119,
      v119);
    (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      COERCE_FLOAT(LODWORD(v114)));
    if ( config_player_count > 1 )
    {
      if ( render_overlay_player_index )
        (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1057803469,
          1051931443,
          COERCE_FLOAT(LODWORD(v114)));
      else
        (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1050253722,
          1050253722,
          1065353216,
          COERCE_FLOAT(LODWORD(v114)));
    }
    v21 = *((_DWORD *)v15 + 1);
    dword_4965D8 = *(_DWORD *)v15;
    dword_4965DC = v21;
    v150 = *v15 + 0.125;
    v22 = v15[1] + 0.125;
    dword_4965E0 = LODWORD(v150);
    v151 = v22;
    dword_4965E4 = LODWORD(v151);
    (*(void (__thiscall **)(int, int, int, float, float))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      dword_4965D8,
      v21,
      COERCE_FLOAT(LODWORD(v150)),
      COERCE_FLOAT(LODWORD(v151)));
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 252))(
      grim_interface_ptr,
      player_aim_heading[216 * render_overlay_player_index]);
    v23 = *(float *)&player_size[216 * render_overlay_player_index] * 0.5;
    v120 = player_size[216 * render_overlay_player_index];
    v150 = v23;
    v139 = *(float *)&camera_offset_y + *(float *)&player_pos_y[216 * render_overlay_player_index];
    v150 = *(float *)&camera_offset_x + *(float *)&player_pos_x[216 * render_overlay_player_index] - v150;
    v150 = v150 + v143;
    dword_4965D8 = LODWORD(v150);
    v151 = v139 - v23 + v147;
    dword_4965DC = LODWORD(v151);
    (*(void (__thiscall **)(int, float, float, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v150)),
      COERCE_FLOAT(LODWORD(v151)),
      v120,
      v120);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    v24 = render_overlay_player_index;
    if ( *(float *)&player_shield_timer[216 * render_overlay_player_index] > 0.0 )
    {
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v64,
        v81,
        v100);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        2,
        v65,
        v82,
        v101);
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
        grim_interface_ptr,
        particles_texture,
        0);
      effect_select_texture(2);
      v25 = (float *)&player_shield_timer[216 * render_overlay_player_index];
      v26 = (sin(flt_47EA4C) + 1.0) * 0.25 + *v25;
      if ( *v25 < 1.0 )
        v26 = v26 * *v25;
      if ( v26 > 1.0 )
        v26 = 1.0;
      v131 = v26 * v114;
      v102 = v131 * 0.40000001;
      (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1052161719,
        1060418741,
        1065353216,
        LODWORD(v102));
      v27 = *(_DWORD *)grim_interface_ptr;
      v115 = sin(flt_47EA4C * 3.0) + 17.5;
      v28 = *(float *)&player_aim_heading[216 * render_overlay_player_index] - 1.5707964;
      v150 = cos(v28) * 3.0;
      v151 = sin(v28) * 3.0;
      v103 = flt_47EA4C + flt_47EA4C;
      (*(void (__stdcall **)(_DWORD))(v27 + 252))(LODWORD(v103));
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v124 = v115 + v115;
      v66 = v151 + *(float *)&player_pos_y[216 * render_overlay_player_index] + *(float *)&camera_offset_y - v115;
      v49 = *(float *)&camera_offset_x + *(float *)&player_pos_x[216 * render_overlay_player_index] - v115 + v150;
      (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
        LODWORD(v49),
        LODWORD(v66),
        LODWORD(v124),
        LODWORD(v124));
      v104 = v131 * 0.30000001;
      (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        1052161719,
        1060418741,
        1065353216,
        LODWORD(v104));
      v116 = sin(flt_47EA4C * 3.0) * 4.0 + 24.0;
      v105 = flt_47EA4C * -2.0;
      (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, LODWORD(v105));
      v125 = v116 + v116;
      v67 = v151 + *(float *)&player_pos_y[216 * render_overlay_player_index] + *(float *)&camera_offset_y - v116;
      v50 = *(float *)&camera_offset_x + *(float *)&player_pos_x[216 * render_overlay_player_index] - v116 + v150;
      (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
        LODWORD(v50),
        LODWORD(v67),
        LODWORD(v125),
        LODWORD(v125));
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v68,
        v83,
        v106);
      v24 = render_overlay_player_index;
    }
    if ( (byte_4D7A94[124 * player_weapon_id[216 * v24]] & 8) == 0 )
    {
      v29 = *(float *)&player_aim_heading[216 * v24] + 1.5707964;
      v30 = cos(v29);
      v144 = v30 * *(float *)&player_muzzle_flash_alpha[216 * v24] * 12.0 - v30 * 21.0;
      v31 = sin(v29);
      v148 = v31 * *(float *)&player_muzzle_flash_alpha[216 * v24] * 12.0 - v31 * 21.0;
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
        grim_interface_ptr,
        dword_48F7E0,
        0);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        2,
        v64,
        v84,
        v107);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        2,
        v69,
        v85,
        v108);
      (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
        grim_interface_ptr,
        0,
        0,
        1065353216,
        1065353216);
      v32 = *(float *)&player_muzzle_flash_alpha[216 * render_overlay_player_index] * 0.80000001;
      if ( v32 > 1.0 )
        v32 = 1.0;
      v109 = v32 * v114;
      (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v109));
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 252))(
        grim_interface_ptr,
        player_aim_heading[216 * render_overlay_player_index]);
      v33 = *(float *)&player_size[216 * render_overlay_player_index];
      if ( (byte_4D7A94[124 * player_weapon_id[216 * render_overlay_player_index]] & 4) != 0 )
      {
        v34 = v33 * 0.25;
        v150 = v34;
        v140 = *(float *)&camera_offset_y + *(float *)&player_pos_y[216 * render_overlay_player_index];
        v150 = *(float *)&camera_offset_x + *(float *)&player_pos_x[216 * render_overlay_player_index] - v150;
        v150 = v150 + v144;
        dword_4965D8 = LODWORD(v150);
        v151 = v140 - v34 + v148;
        v35 = *(float *)&player_size[216 * render_overlay_player_index] * 0.5;
        dword_4965DC = LODWORD(v151);
        v36 = *(_DWORD *)grim_interface_ptr;
        v132 = v35;
        v110 = v132;
        v86 = v132;
      }
      else
      {
        v37 = v33 * 0.5;
        v121 = player_size[216 * render_overlay_player_index];
        v150 = v37;
        v110 = *(float *)&v121;
        v86 = *(float *)&v121;
        v141 = *(float *)&camera_offset_y + *(float *)&player_pos_y[216 * render_overlay_player_index];
        v150 = *(float *)&camera_offset_x + *(float *)&player_pos_x[216 * render_overlay_player_index] - v150;
        v150 = v150 + v144;
        dword_4965D8 = LODWORD(v150);
        v151 = v141 - v37 + v148;
        dword_4965DC = LODWORD(v151);
        v36 = *(_DWORD *)grim_interface_ptr;
      }
      (*(void (__stdcall **)(float, float, float, float))(v36 + 284))(
        COERCE_FLOAT(LODWORD(v150)),
        COERCE_FLOAT(LODWORD(v151)),
        COERCE_FLOAT(LODWORD(v86)),
        COERCE_FLOAT(LODWORD(v110)));
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    }
    if ( perk_count_get(dword_4C2BCC) )
    {
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v64,
        v81,
        v111);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        2,
        v70,
        v87,
        v112);
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
        grim_interface_ptr,
        projectile_texture,
        0);
      (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 4, 2);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v38 = 0;
      if ( config_player_count > 0 )
      {
        v39 = player_auto_target;
        do
        {
          if ( *((float *)v39 - 162) > 0.25 )
          {
            v40 = creature_pos_y[38 * *v39] - *((float *)v39 - 194);
            v41 = *((float *)&creature_pos_x + 38 * *v39) - *((float *)v39 - 195);
            if ( sqrt(v40 * v40 + v41 * v41) <= 80.0 )
            {
              v145 = *((float *)&creature_pos_x + 38 * *v39) - *((float *)v39 - 195);
              v42 = creature_pos_y[38 * *v39] - *((float *)v39 - 194);
              v150 = v145;
              v149 = v42;
              v151 = v149;
              v133 = sqrt(v149 * v149 + v145 * v145);
              j_FUN_00452f1d(&v150);
              v126 = *(float *)&camera_offset_x + *((float *)v39 - 195) - 16.0;
              v128 = *(float *)&camera_offset_y + *((float *)v39 - 194) - 16.0;
              (*(void (__stdcall **)(int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
                1056964608,
                1058642330,
                1065353216,
                COERCE_FLOAT(LODWORD(v114)));
              v122 = 0.0;
              if ( v133 > 0.0 )
              {
                do
                {
                  v71 = v151 * v122 + v128;
                  v51 = v150 * v122 + v126;
                  (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
                    LODWORD(v51),
                    LODWORD(v71),
                    1107296256,
                    1107296256);
                  v43 = v122 + 8.0;
                  v122 = v43;
                }
                while ( v43 < v133 );
              }
            }
          }
          ++v38;
          v39 += 216;
        }
        while ( v38 < config_player_count );
      }
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    }
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      5,
      v64,
      v81,
      v111);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      v72,
      v88,
      v113);
  }
}

// bonus_label_for_entry @ 0x00429580
// returns the label string for a bonus entry (formatting weapon/score cases)
char *__cdecl sub_429580(int *a1)
{
  int v1; // eax
  const char *v2; // eax

  v1 = *a1;
  if ( *a1 == 3 )
  {
    v2 = (const char *)weapon_table_entry(a1[6]);
    crt_sprintf(byte_49679C, "%s", v2);
    return byte_49679C;
  }
  else if ( v1 == 1 )
  {
    crt_sprintf(byte_49679C, "%s: %d", (const char *)dword_4853E4, a1[6]);
    return byte_49679C;
  }
  else
  {
    return (char *)bonus_meta_label[5 * v1];
  }
}

// bonus_render @ 0x004295F0
// renders bonus icons and labels from the pickup pool
void __usercall sub_4295F0(int a1@<edi>, int a2@<esi>)
{
  int *v2; // esi
  double v3; // st7
  double v5; // st7
  unsigned __int8 v6; // c0
  unsigned __int8 v7; // c3
  double v8; // st6
  int v9; // edi
  double v10; // st7
  double v11; // st7
  double v12; // st7
  double v13; // st7
  int v14; // ebx
  int *v15; // esi
  double v16; // st7
  double v17; // st7
  int *v18; // edi
  float *v19; // ebp
  int v20; // esi
  int *v21; // ecx
  double v22; // st6
  double v23; // st4
  char *v24; // edi
  double v25; // st7
  double v26; // st6
  int v27; // edi
  char *v28; // esi
  long double v29; // st7
  float *v30; // esi
  double v31; // st7
  char *v32; // esi
  long double v33; // st7
  long double v34; // st7
  float *v35; // esi
  double v36; // st7
  double v37; // st7
  double v38; // st7
  double v39; // st7
  float *v40; // esi
  double v41; // st7
  float v42; // [esp+2E0h] [ebp-54h]
  int v43; // [esp+2E4h] [ebp-50h]
  int v44; // [esp+2E4h] [ebp-50h]
  float v45; // [esp+2E4h] [ebp-50h]
  float v46; // [esp+2E8h] [ebp-4Ch]
  float v47; // [esp+2E8h] [ebp-4Ch]
  float v48; // [esp+2E8h] [ebp-4Ch]
  float v49; // [esp+2E8h] [ebp-4Ch]
  float v50; // [esp+2E8h] [ebp-4Ch]
  float v51; // [esp+2E8h] [ebp-4Ch]
  int v52; // [esp+2E8h] [ebp-4Ch]
  float v53; // [esp+2E8h] [ebp-4Ch]
  float v54; // [esp+2E8h] [ebp-4Ch]
  int v55; // [esp+2E8h] [ebp-4Ch]
  float v56; // [esp+2E8h] [ebp-4Ch]
  int v57; // [esp+2ECh] [ebp-48h]
  int v58; // [esp+2ECh] [ebp-48h]
  int v59; // [esp+2ECh] [ebp-48h]
  int v60; // [esp+2ECh] [ebp-48h]
  int v61; // [esp+2ECh] [ebp-48h]
  float v62; // [esp+2ECh] [ebp-48h]
  float v63; // [esp+2ECh] [ebp-48h]
  float v64; // [esp+2ECh] [ebp-48h]
  int v65; // [esp+2ECh] [ebp-48h]
  int v66; // [esp+2ECh] [ebp-48h]
  int v67; // [esp+2ECh] [ebp-48h]
  float v68; // [esp+2ECh] [ebp-48h]
  int v69; // [esp+2ECh] [ebp-48h]
  int v70; // [esp+2ECh] [ebp-48h]
  float v71; // [esp+2ECh] [ebp-48h]
  float v72; // [esp+2ECh] [ebp-48h]
  int v73; // [esp+2ECh] [ebp-48h]
  int v74; // [esp+2ECh] [ebp-48h]
  int v75; // [esp+2ECh] [ebp-48h]
  float v76; // [esp+2ECh] [ebp-48h]
  float v77; // [esp+2ECh] [ebp-48h]
  int v78; // [esp+2ECh] [ebp-48h]
  float v79; // [esp+2ECh] [ebp-48h]
  int v80; // [esp+2F0h] [ebp-44h]
  int v81; // [esp+2F0h] [ebp-44h]
  int v82; // [esp+2F0h] [ebp-44h]
  int v83; // [esp+2F0h] [ebp-44h]
  int v84; // [esp+2F0h] [ebp-44h]
  float v85; // [esp+2F0h] [ebp-44h]
  int v86; // [esp+2F0h] [ebp-44h]
  int v87; // [esp+2F0h] [ebp-44h]
  int v88; // [esp+2F0h] [ebp-44h]
  int v89; // [esp+2F0h] [ebp-44h]
  int v90; // [esp+2F0h] [ebp-44h]
  float v91; // [esp+2F0h] [ebp-44h]
  int v92; // [esp+2F0h] [ebp-44h]
  int v93; // [esp+2F0h] [ebp-44h]
  int v94; // [esp+2F4h] [ebp-40h]
  int v95; // [esp+2F4h] [ebp-40h]
  int v96; // [esp+2F4h] [ebp-40h]
  int v97; // [esp+2F4h] [ebp-40h]
  float v98; // [esp+2F4h] [ebp-40h]
  int v99; // [esp+2F4h] [ebp-40h]
  float v100; // [esp+2F4h] [ebp-40h]
  int v101; // [esp+2F4h] [ebp-40h]
  int v102; // [esp+2F4h] [ebp-40h]
  int v103; // [esp+2F4h] [ebp-40h]
  int v104; // [esp+2F4h] [ebp-40h]
  int v105; // [esp+2F4h] [ebp-40h]
  float v106; // [esp+2F4h] [ebp-40h]
  int v107; // [esp+2F4h] [ebp-40h]
  int v108; // [esp+2F4h] [ebp-40h]
  float v109; // [esp+2F4h] [ebp-40h]
  float v110; // [esp+2F4h] [ebp-40h]
  int v111; // [esp+308h] [ebp-2Ch]
  int v112; // [esp+308h] [ebp-2Ch]
  float v113; // [esp+30Ch] [ebp-28h]
  float v114; // [esp+30Ch] [ebp-28h]
  float v115; // [esp+30Ch] [ebp-28h]
  float v116; // [esp+310h] [ebp-24h]
  float v117; // [esp+310h] [ebp-24h]
  float v118; // [esp+310h] [ebp-24h]
  float v119; // [esp+310h] [ebp-24h]
  float v120; // [esp+310h] [ebp-24h]
  float v121; // [esp+310h] [ebp-24h]
  float v122; // [esp+310h] [ebp-24h]
  float v123; // [esp+310h] [ebp-24h]
  float v124; // [esp+310h] [ebp-24h]
  float v125; // [esp+314h] [ebp-20h]
  float v126; // [esp+314h] [ebp-20h]
  float v127; // [esp+314h] [ebp-20h]
  int *v128; // [esp+314h] [ebp-20h]
  float v129; // [esp+318h] [ebp-1Ch]
  float v130; // [esp+318h] [ebp-1Ch]
  float v131; // [esp+318h] [ebp-1Ch]
  float v132; // [esp+31Ch] [ebp-18h] BYREF
  float v133; // [esp+320h] [ebp-14h]
  float v134; // [esp+324h] [ebp-10h]
  float v135; // [esp+328h] [ebp-Ch]
  int v136; // [esp+32Ch] [ebp-8h]
  int v137; // [esp+330h] [ebp-4h]
  int retaddr; // [esp+334h] [ebp+0h]

  v132 = 0.47;
  v133 = 1.0;
  if ( ui_transition_alpha > 0.0
    && game_state_id != 20
    && game_state_id != 22
    && game_state_prev != 20
    && game_state_prev != 22 )
  {
    flt_4AAF5C = frame_dt * 1.3 + flt_4AAF5C;
    (*(void (__thiscall **)(int, int, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      particles_texture,
      0,
      a1,
      a2);
    effect_select_texture(16);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      5,
      v57,
      v80,
      v94);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      2,
      v58,
      v81,
      v95);
    v136 = 1060320051;
    v132 = 0.69999999;
    v137 = 1061997773;
    v135 = 1.0;
    v133 = 0.80000001;
    v134 = 1.0;
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      5,
      v59,
      v82,
      v96);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      v60,
      v83,
      v97);
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      bonus_texture,
      0);
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    v136 = 1065353216;
    v137 = 1065353216;
    retaddr = 1065353216;
    v132 = 1.0;
    v133 = 1.0;
    v134 = 1.0;
    v135 = 1.0;
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v111 = 0;
    v2 = bonus_time_left;
    do
    {
      if ( *(v2 - 2) )
      {
        v3 = 1.0;
        if ( *(float *)v2 < 2.0 )
        {
          v5 = *(float *)v2;
          if ( v6 | v7 )
            v3 = v5 * 0.5;
          else
            v3 = v5 * 0.25;
        }
        v8 = *((float *)v2 + 1) - *(float *)v2;
        if ( v8 < 0.5 )
        {
          v125 = v8;
          v3 = v125 + v125;
        }
        v135 = v3 * 0.89999998 * v113;
        if ( v132 >= 0.0 )
        {
          if ( v132 > 1.0 )
            v132 = 1.0;
        }
        else
        {
          v132 = 0.0;
        }
        if ( v133 >= 0.0 )
        {
          if ( v133 > 1.0 )
            v133 = 1.0;
        }
        else
        {
          v133 = 0.0;
        }
        if ( v134 >= 0.0 )
        {
          if ( v134 > 1.0 )
            v134 = 1.0;
        }
        else
        {
          v134 = 0.0;
        }
        if ( v135 >= 0.0 )
        {
          if ( v135 > 1.0 )
            v135 = 1.0;
        }
        else
        {
          v135 = 0.0;
        }
        (*(void (__thiscall **)(int, float *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &v132);
        (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
        (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 4, 0);
        v62 = *(float *)&camera_offset_y + *((float *)v2 + 3) - 16.0;
        v46 = *(float *)&camera_offset_x + *((float *)v2 + 2) - 16.0;
        (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
          LODWORD(v46),
          LODWORD(v62),
          1107296256,
          1107296256);
        v9 = bonus_meta_icon_id[5 * *(v2 - 2)];
        if ( v9 >= 0 )
        {
          if ( *(float *)v2 >= 0.5 )
          {
            v11 = *((float *)v2 + 1) - *(float *)v2;
            if ( v11 >= 0.5 )
              v10 = 1.0;
            else
              v10 = v11 + v11;
          }
          else
          {
            v10 = *(float *)v2 + *(float *)v2;
          }
          v135 = v113;
          v116 = v10 * v113;
          if ( v132 >= 0.0 )
          {
            if ( v132 > 1.0 )
              v132 = 1.0;
          }
          else
          {
            v132 = 0.0;
          }
          if ( v133 >= 0.0 )
          {
            if ( v133 > 1.0 )
              v133 = 1.0;
          }
          else
          {
            v133 = 0.0;
          }
          if ( v134 >= 0.0 )
          {
            if ( v134 > 1.0 )
              v134 = 1.0;
          }
          else
          {
            v134 = 0.0;
          }
          if ( v113 > 1.0 )
            v135 = 1.0;
          (*(void (__thiscall **)(int, float *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &v132);
          v12 = (double)v111;
          v126 = v12;
          v117 = (pow(sin(v12 + flt_4AAF5C), 2.0) * 0.25 + 0.75) * v116;
          (*(void (__thiscall **)(int, float *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &v132);
          v98 = sin(v126 - (double)survival_elapsed_ms * 0.003) * 0.2;
          (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, LODWORD(v98));
          if ( *(v2 - 2) == 1 && v2[4] == 1000 )
            (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 4, v9 + 1);
          else
            (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(grim_interface_ptr, 4, v9);
          v129 = v117 * 32.0;
          v13 = v117 * 16.0;
          v63 = *(float *)&camera_offset_y + *((float *)v2 + 3) - v13;
          v47 = *(float *)&camera_offset_x + *((float *)v2 + 2) - v13;
          (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v47),
            LODWORD(v63),
            LODWORD(v129),
            LODWORD(v129));
        }
      }
      v2 += 7;
      ++v111;
    }
    while ( (int)v2 < (int)&highscore_table );
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    v14 = 0;
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      ui_weapon_icons_texture,
      0);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v112 = 0;
    v15 = bonus_time_left;
    do
    {
      if ( *(v15 - 2) == 3 )
      {
        if ( *(float *)v15 >= 0.5 )
        {
          v17 = *((float *)v15 + 1) - *(float *)v15;
          if ( v17 >= 0.5 )
            v16 = 1.0;
          else
            v16 = v17 + v17;
        }
        else
        {
          v16 = *(float *)v15 + *(float *)v15;
        }
        v118 = v16 * v113;
        v135 = v118;
        (*(void (__thiscall **)(int, float *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &v132);
        v119 = (pow(sin(flt_4AAF5C), 2.0) * 0.25 + 0.75) * v118;
        (*(void (__thiscall **)(int, float *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &v132);
        v100 = sin((double)v112 - (double)survival_elapsed_ms * 0.003);
        (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, LODWORD(v100));
        (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 264))(
          grim_interface_ptr,
          8,
          2,
          1,
          2 * effect_subrect_frame_table[31 * v15[4]]);
        v127 = v119 * 30.0;
        v85 = v119 * 60.0;
        v64 = *(float *)&camera_offset_y + *((float *)v15 + 3) - v119 * 15.0;
        v48 = *(float *)&camera_offset_x + *((float *)v15 + 2) - v127;
        (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
          LODWORD(v48),
          LODWORD(v64),
          LODWORD(v85),
          LODWORD(v127));
      }
      v15 += 7;
      ++v112;
    }
    while ( (int)v15 < (int)&highscore_table );
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      1056964608,
      v61,
      v84,
      v99);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    if ( config_player_count > 0 )
    {
      v18 = dword_4AAF60;
      v19 = (float *)player_aim_x;
      v128 = dword_4AAF60;
      while ( 1 )
      {
        if ( *(v19 - 11) > 0.0 )
        {
          v20 = 0;
          v21 = bonus_pool;
          while ( 1 )
          {
            if ( *v21 )
            {
              v22 = v19[1] - *((float *)v21 + 5);
              v23 = *v19 - *((float *)v21 + 4);
              if ( sqrt(v22 * v22 + v23 * v23) < 24.0 )
                break;
            }
            v21 += 7;
            ++v20;
            if ( (int)v21 >= (int)&quest_spawn_count )
            {
              *v18 = 0;
              goto LABEL_73;
            }
          }
          if ( game_state_id == 9 )
            *v18 += frame_dt_ms;
          v24 = bonus_label_for_entry((int *)(28 * v20 + 4729160));
          v120 = *(float *)&camera_offset_x + *v19 + 16.0;
          v114 = *(float *)&camera_offset_y + v19[1] - 7.0;
          v25 = (double)(*(int (__stdcall **)(char *))(*(_DWORD *)grim_interface_ptr + 332))(v24);
          v26 = (double)*(int *)config_screen_width;
          if ( v25 + v120 > v26 )
            v120 = v26 - v25;
          (*(void (__thiscall **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 324))(
            grim_interface_ptr,
            COERCE_FLOAT(LODWORD(v120)),
            COERCE_FLOAT(LODWORD(v114)),
            v24);
          v18 = v128;
LABEL_73:
          if ( *v18 > 650 && perk_count_get(perk_id_telekinetic) && !bonus_state[28 * v20] )
            break;
        }
        ++v14;
        v19 += 216;
        v128 = ++v18;
        if ( v14 >= config_player_count )
          goto LABEL_84;
      }
      bonus_apply(v14, (float *)&bonus_pool[7 * v20]);
      bonus_state[28 * v20] = 1;
      bonus_time_left[7 * v20] = 1056964608;
      dword_4AAF60[v14] = 0;
    }
LABEL_84:
    if ( config_fx_detail_flag1 )
    {
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v65,
        v86,
        v101);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        2,
        v66,
        v87,
        v102);
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
        grim_interface_ptr,
        particles_texture,
        0);
      effect_select_texture(13);
      (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        1032134328);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v27 = 0;
      v28 = particle_style_id;
      do
      {
        if ( *(v28 - 48) && !(v27 % 2) && *v28 != 8 )
        {
          v29 = (sin((1.0 - *((float *)v28 - 3)) * 1.5707964) + 0.1) * 55.0 + 4.0;
          if ( v29 < 16.0 )
            v29 = 16.0;
          v130 = v29 + v29;
          v68 = *(float *)&camera_offset_y + *((float *)v28 - 10) - v29;
          v49 = *(float *)&camera_offset_x + *((float *)v28 - 11) - v29;
          (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v49),
            LODWORD(v68),
            LODWORD(v130),
            LODWORD(v130));
        }
        v28 += 56;
        ++v27;
      }
      while ( (int)v28 < (int)secondary_proj_pos_y );
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v67,
        v88,
        v103);
    }
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      5,
      v65,
      v86,
      v101);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      2,
      v69,
      v89,
      v104);
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      particles_texture,
      0);
    effect_select_texture(12);
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v30 = (float *)&particle_spin;
    do
    {
      if ( *((_BYTE *)v30 - 44) && *((_BYTE *)v30 + 4) != 8 )
      {
        (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, *(_DWORD *)v30);
        (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          *((_DWORD *)v30 - 6),
          *((_DWORD *)v30 - 5),
          *((_DWORD *)v30 - 4),
          *((_DWORD *)v30 - 3));
        v31 = sin((1.0 - *(v30 - 2)) * 1.5707964) * 24.0;
        if ( *((_BYTE *)v30 + 4) == 1 )
          v31 = v31 * 0.80000001;
        if ( v31 < 2.0 )
          v31 = 2.0;
        v131 = v31 + v31;
        v71 = *(float *)&camera_offset_y + *(v30 - 9) - v31;
        v50 = *(float *)&camera_offset_x + *(v30 - 10) - v31;
        (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
          LODWORD(v50),
          LODWORD(v71),
          LODWORD(v131),
          LODWORD(v131));
      }
      v30 += 14;
    }
    while ( (int)v30 < (int)&secondary_proj_pos_x );
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    effect_select_texture(2);
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v32 = particle_style_id;
    do
    {
      if ( *(v32 - 48) && *v32 == 8 )
      {
        (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          *((_DWORD *)v32 - 4));
        v33 = sin(*((float *)v32 - 1)) * 3.0;
        v121 = 15.0 - v33;
        v34 = (v33 + 15.0) * *((float *)v32 - 7) * 7.0;
        v122 = v121 * *((float *)v32 - 7) * 7.0;
        v106 = v34 + v34;
        v91 = v122 + v122;
        v72 = *(float *)&camera_offset_y + *((float *)v32 - 10) - v34;
        v51 = *(float *)&camera_offset_x + *((float *)v32 - 11) - v122;
        (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
          LODWORD(v51),
          LODWORD(v72),
          LODWORD(v91),
          LODWORD(v106));
      }
      v32 += 56;
    }
    while ( (int)v32 < (int)secondary_proj_pos_y );
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      6,
      v70,
      v90,
      v105);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      19,
      5,
      v73,
      v92,
      v107);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      20,
      2,
      v74,
      v93,
      v108);
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v35 = (float *)&secondary_proj_vel_x;
    do
    {
      if ( *((_BYTE *)v35 - 20) && *((_DWORD *)v35 + 2) == 3 )
      {
        v109 = 1.0 - *v35;
        (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
          1065353216,
          1058642330,
          1036831949,
          LODWORD(v109));
        v36 = v35[1] * *v35 * 64.0;
        v123 = v36;
        v37 = v36 * 0.5;
        v76 = *(float *)&camera_offset_y + *(v35 - 1) - v37;
        v53 = *(float *)&camera_offset_x + *(v35 - 2) - v37;
        (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
          LODWORD(v53),
          LODWORD(v76),
          LODWORD(v123),
          LODWORD(v123));
        v110 = (1.0 - *v35) * 0.30000001;
        (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1058642330,
          1036831949,
          LODWORD(v110));
        v38 = v35[1] * *v35 * 200.0;
        v124 = v38;
        v39 = v38 * 0.5;
        v77 = *(float *)&camera_offset_y + *(v35 - 1) - v39;
        v54 = *(float *)&camera_offset_x + *(v35 - 2) - v39;
        (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 284))(
          LODWORD(v54),
          LODWORD(v77),
          LODWORD(v124),
          LODWORD(v124));
      }
      v35 += 11;
    }
    while ( (int)v35 < (int)&flt_4965EC );
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 20, 6);
    if ( config_fx_detail_flag2 )
    {
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v43,
        v52,
        v75);
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        20,
        6,
        v44,
        v55,
        v78);
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
        grim_interface_ptr,
        particles_texture,
        0);
      v79 = flt_49124C + 0.25;
      v56 = flt_491248 + 0.25;
      (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 256))(
        LODWORD(flt_491248),
        LODWORD(flt_49124C),
        LODWORD(v56),
        LODWORD(v79));
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v40 = (float *)sprite_effect_scale;
      do
      {
        if ( *((_BYTE *)v40 - 40) )
        {
          v115 = *v40;
          (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(
            grim_interface_ptr,
            *((_DWORD *)v40 - 5));
          (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
            grim_interface_ptr,
            *((_DWORD *)v40 - 9),
            *((_DWORD *)v40 - 8),
            *((_DWORD *)v40 - 7),
            *((_DWORD *)v40 - 6));
          v41 = v115 * 0.5;
          v45 = *(float *)&camera_offset_y + *(v40 - 3) - v41;
          v42 = *(float *)&camera_offset_x + *(v40 - 4) - v41;
          (*(void (__stdcall **)(_DWORD, _DWORD, float, float))(*(_DWORD *)grim_interface_ptr + 284))(
            LODWORD(v42),
            LODWORD(v45),
            COERCE_FLOAT(LODWORD(v115)),
            COERCE_FLOAT(LODWORD(v115)));
        }
        v40 += 11;
      }
      while ( (int)v40 < (int)flt_49AA48 );
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    }
    effects_render();
  }
}

// audio_resume_all @ 0x0042A5F0
// resume active audio channels
char sub_42A5F0()
{
  audio_resume_channels();
  if ( *(float *)(dword_480864 + 12) != 0.0 )
    console_printf((int)&console_log_queue, aRestored);
  audio_suspend_flag = 0;
  return 1;
}

// audio_suspend_all @ 0x0042A630
// suspend active audio channels
char sub_42A630()
{
  audio_suspend_channels();
  if ( *(float *)(dword_480864 + 12) != 0.0 )
    console_printf((int)&console_log_queue, aSuspended);
  audio_suspend_flag = 1;
  return 1;
}

// texture_get_or_load @ 0x0042A670
// lookup texture handle; load if missing (name + path)
int __cdecl sub_42A670(int a1, const char *ArgList)
{
  int result; // eax

  result = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 192))(grim_interface_ptr, a1);
  if ( result == -1 )
  {
    if ( (*(unsigned __int8 (__thiscall **)(int, int, const char *))(*(_DWORD *)grim_interface_ptr + 180))(
           grim_interface_ptr,
           a1,
           ArgList) )
    {
      if ( *(float *)(dword_480854 + 12) == 0.0 )
        console_printf((int)&console_log_queue, "...loading texture '%s' ok\n", ArgList);
      return (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 192))(grim_interface_ptr, a1);
    }
    else
    {
      console_printf((int)&console_log_queue, "...loading texture '%s' failed\n", ArgList);
      return -1;
    }
  }
  return result;
}

// texture_get_or_load_alt @ 0x0042A700
// duplicate of texture_get_or_load (callers are mostly .jaz assets)
int __cdecl sub_42A700(const char *ArgList)
{
  int result; // eax

  result = (*(int (__thiscall **)(int, const char *))(*(_DWORD *)grim_interface_ptr + 192))(grim_interface_ptr, ArgList);
  if ( result == -1 )
  {
    if ( (*(unsigned __int8 (__thiscall **)(int, const char *, const char *))(*(_DWORD *)grim_interface_ptr + 180))(
           grim_interface_ptr,
           ArgList,
           ArgList) )
    {
      if ( *(float *)(dword_480854 + 12) == 0.0 )
        console_printf((int)&console_log_queue, "...loading texture '%s' ok\n", ArgList);
      return (*(int (__thiscall **)(int, const char *))(*(_DWORD *)grim_interface_ptr + 192))(
               grim_interface_ptr,
               ArgList);
    }
    else
    {
      console_printf((int)&console_log_queue, "...loading texture '%s' failed\n", ArgList);
      return -1;
    }
  }
  return result;
}

// console_cmd_load_texture @ 0x0042A780
// console command handler for loadtexture; calls texture_get_or_load(name, path)
char console_cmd_load_texture()
{
  char *v1; // eax
  char *v2; // [esp-4h] [ebp-4h]

  if ( FUN_00401150() != 2 )
    return console_printf((int)&console_log_queue, aLoadtextureTex);
  v2 = FUN_00401120(2);
  v1 = FUN_00401120(2);
  return texture_get_or_load((int)v1, v2);
}

// console_cmd_set_resource_paq @ 0x0042A7C0
// console command handler for setresourcepaq; validates file and updates Grim config id 0x10
char sub_42A7C0()
{
  char *v1; // eax
  FILE *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax

  if ( FUN_00401150() != 2 )
    return console_printf((int)&console_log_queue, aSetresourcepaq_0);
  v1 = FUN_00401120(1);
  v2 = crt_fopen(v1, file_mode_read_binary);
  if ( v2 )
  {
    crt_fclose(v2);
    v4 = FUN_00401120(1);
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 16);
    v5 = FUN_00401120(1);
    return console_printf((int)&console_log_queue, "Set resource paq to '%s'\n", v5);
  }
  else
  {
    v3 = FUN_00401120(1);
    return console_printf((int)&console_log_queue, "File '%s' not found.\n", v3);
  }
}

// console_cmd_tell_time_survived @ 0x0042A860
// console command handler for telltimesurvived; prints survived time in seconds
char console_cmd_tell_time_survived()
{
  return console_printf(
           (int)&console_log_queue,
           "Survived: %i seconds.\n",
           (unsigned int)(__int64)((double)survival_elapsed_ms * 0.001));
}

// console_cmd_open_url @ 0x0042A890
// console command handler for openurl; converts to wide and calls HlinkNavigateString
char sub_42A890()
{
  char *v1; // eax
  char *v2; // eax
  WCHAR WideCharStr[260]; // [esp+0h] [ebp-208h] BYREF

  if ( FUN_00401150() != 2 )
    return console_printf((int)&console_log_queue, aOpenurlUrl);
  v1 = FUN_00401120(1);
  MultiByteToWideChar(0, 0, v1, -1, WideCharStr, 260);
  if ( HlinkNavigateString(0, WideCharStr) < 0 )
    return console_printf((int)&console_log_queue, aFailedToLaunch_0);
  v2 = FUN_00401120(1);
  return console_printf((int)&console_log_queue, "Launching web browser (%s)..\n", v2);
}

// console_cmd_snd_freq_adjustment @ 0x0042A930
// console command handler for sndfreqadjustment; toggles DAT_004807a8 and prints status
char sub_42A930()
{
  bool v0; // zf

  v0 = byte_4807A8 != 0;
  byte_4807A8 = byte_4807A8 == 0;
  if ( v0 )
    return console_printf((int)&console_log_queue, aSoundFrequency_0);
  else
    return console_printf((int)&console_log_queue, aSoundFrequency);
}

// reg_read_dword_default @ 0x0042A980
// reads a registry DWORD or writes fallback to output
int __cdecl sub_42A980(HKEY hKey, LPCSTR lpValueName, BYTE *Type, int a4)
{
  BYTE *v4; // esi
  DWORD cbData; // [esp+4h] [ebp-4h] BYREF

  v4 = Type;
  cbData = 4;
  if ( RegQueryValueExA(hKey, lpValueName, 0, (LPDWORD)&Type, Type, &cbData) )
    *(_DWORD *)v4 = a4;
  return 0;
}

// reg_write_dword @ 0x0042A9C0
// writes a registry DWORD
unsigned int sub_42A9C0(HKEY hKey, LPCSTR lpValueName, ...)
{
  va_list va; // [esp+Ch] [ebp+Ch] BYREF

  va_start(va, lpValueName);
  return RegSetValueExA(hKey, lpValueName, 0, 4u, (const BYTE *)va, 4u) != 0 ? 0x80004005 : 0;
}

// init_audio_and_terrain @ 0x0042A9F0
// sound init + terrain texture setup
char sub_42A9F0()
{
  char ArgLista[4]; // [esp+18h] [ebp-4h]

  console_printf((int)&console_log_queue, aInitGrimSucces);
  console_printf((int)&console_log_queue, asc_4711C0);
  console_printf((int)&console_log_queue, asc_4740FC);
  console_printf((int)&console_log_queue, aSoundInit);
  console_printf((int)&console_log_queue, asc_4740FC);
  if ( byte_4AAEEA )
    console_printf((int)&console_log_queue, aNoSoundsSelect);
  else
    byte_4AAEEA = (unsigned __int8)sfx_system_init() == 0;
  console_printf((int)&console_log_queue, asc_4711C0);
  terrain_texture_width = 1024;
  terrain_texture_height = 1024;
  if ( *(float *)config_texture_scale >= 0.5 )
  {
    if ( *(float *)config_texture_scale > 4.0 )
      *(_DWORD *)config_texture_scale = 1082130432;
  }
  else
  {
    *(_DWORD *)config_texture_scale = 1056964608;
  }
  if ( terrain_texture_failed )
    goto LABEL_14;
  if ( !(*(unsigned __int8 (__thiscall **)(int, char *, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 172))(
          grim_interface_ptr,
          aGround,
          (__int64)(1024.0 / *(float *)config_texture_scale),
          (__int64)(1024.0 / *(float *)config_texture_scale)) )
  {
    *(_DWORD *)ArgLista = *(_DWORD *)config_texture_scale;
    *(float *)config_texture_scale = *(float *)config_texture_scale + *(float *)config_texture_scale;
    if ( (*(unsigned __int8 (__fastcall **)(int, _DWORD, char *, _DWORD, _DWORD))(*(_DWORD *)grim_interface_ptr + 172))(
           grim_interface_ptr,
           (unsigned __int64)(__int64)((double)terrain_texture_width / *(float *)config_texture_scale) >> 32,
           aGround,
           (__int64)((double)terrain_texture_width / *(float *)config_texture_scale),
           (__int64)((double)terrain_texture_height / *(float *)config_texture_scale)) )
    {
      console_printf((int)&console_log_queue, aCreatedTerrain);
    }
    else
    {
      *(_DWORD *)config_texture_scale = *(_DWORD *)ArgLista;
      terrain_texture_failed = 1;
      console_printf((int)&console_log_queue, aFailedToCreate);
      console_printf((int)&console_log_queue, aEnteringSafemo);
    }
  }
  if ( terrain_texture_failed )
LABEL_14:
    console_printf((int)&console_log_queue, aRunningInSafem);
  return console_flush_log(&console_log_queue, (int)console_log_filename);
}

// load_textures_step @ 0x0042ABD0
// stage-based texture loading (advances DAT_004aaf88)
BOOL sub_42ABD0()
{
  if ( !dword_4AAF88 )
  {
    texture_get_or_load((int)aGrimFont2, aLoadSmallwhite);
    texture_get_or_load((int)aTrooper, aGameTrooperJaz);
    texture_get_or_load((int)aZombie, aGameZombieJaz);
    texture_get_or_load((int)aSpiderSp1, aGameSpiderSp1J);
    texture_get_or_load((int)aSpiderSp2, aGameSpiderSp2J);
    texture_get_or_load((int)aAlien, aGameAlienJaz);
    texture_get_or_load((int)aLizard, aGameLizardJaz);
  }
  if ( dword_4AAF88 == 1 )
  {
    dword_48F7D8 = texture_get_or_load((int)aArrow, aLoadArrowTga);
    texture_get_or_load((int)aBulletI, aLoadBullet16Tg);
    bullet_trail_texture = texture_get_or_load((int)aBullettrail, aLoadBullettrai);
    texture_get_or_load((int)aBodyset, aGameBodysetJaz);
    bodyset_texture = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                        grim_interface_ptr,
                        aBodyset);
    projectile_texture = texture_get_or_load((int)aProjs, aGameProjsJaz);
  }
  if ( dword_4AAF88 == 2 )
  {
    texture_get_or_load((int)aUiIconaim, aUiUiIconaimJaz);
    texture_get_or_load((int)aUiButtonsm, aUiUiButton64x3);
    texture_get_or_load((int)aUiButtonmd, aUiUiButton128x);
    texture_get_or_load((int)aUiCheckon, aUiUiCheckonJaz);
    texture_get_or_load((int)aUiCheckoff, aUiUiCheckoffJa);
    texture_get_or_load((int)aUiRectoff, aUiUiRectoffJaz);
    texture_get_or_load((int)aUiRecton, aUiUiRectonJaz);
    texture_get_or_load((int)aBonuses, aGameBonusesJaz);
  }
  if ( dword_4AAF88 == 3 )
  {
    texture_get_or_load_alt(aUiUiIndbulletJ);
    texture_get_or_load_alt(aUiUiIndrocketJ);
    texture_get_or_load_alt(aUiUiIndelectri);
    texture_get_or_load_alt(aUiUiIndfireJaz);
    bonus_texture = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                      grim_interface_ptr,
                      aBonuses);
    particles_texture = texture_get_or_load_alt(aGameParticlesJ);
  }
  if ( dword_4AAF88 == 4 )
  {
    dword_48F7C0 = texture_get_or_load_alt(aUiUiIndlifeJaz);
    dword_48F7C4 = texture_get_or_load_alt(aUiUiIndpanelJa);
    dword_48F7BC = texture_get_or_load_alt(aUiUiArrowJaz);
    dword_48F798 = texture_get_or_load_alt(aUiUiCursorJaz);
    dword_48F79C = texture_get_or_load_alt(aUiUiAimJaz);
  }
  if ( dword_4AAF88 == 5 )
  {
    if ( terrain_texture_failed )
    {
      dword_48F548[0] = texture_get_or_load_alt(aTerFbQ1Jaz);
      dword_48F54C = texture_get_or_load_alt(aTerFbQ2Jaz);
      dword_48F550 = texture_get_or_load_alt(aTerFbQ3Jaz);
      dword_48F554 = texture_get_or_load_alt(aTerFbQ4Jaz);
      terrain_render_target = dword_48F548[0];
    }
    else
    {
      dword_48F548[0] = texture_get_or_load_alt(aTerTerQ1BaseJa);
      dword_48F54C = texture_get_or_load_alt(aTerTerQ1Tex1Ja);
      dword_48F550 = texture_get_or_load_alt(aTerTerQ2BaseJa);
      dword_48F554 = texture_get_or_load_alt(aTerTerQ2Tex1Ja);
      dword_48F558 = texture_get_or_load_alt(aTerTerQ3BaseJa);
      dword_48F55C = texture_get_or_load_alt(aTerTerQ3Tex1Ja);
      dword_48F560 = texture_get_or_load_alt(aTerTerQ4BaseJa);
      dword_48F564 = texture_get_or_load_alt(aTerTerQ4Tex1Ja);
    }
  }
  if ( dword_4AAF88 == 6 )
  {
    dword_48F7A0 = texture_get_or_load_alt(aUiUiTextlevcom);
    dword_48F7A4 = texture_get_or_load_alt(aUiUiTextquestJ);
    dword_48F7A8 = texture_get_or_load_alt(aUiUiNum1Jaz);
    dword_48F7AC = texture_get_or_load_alt(aUiUiNum2Jaz);
    dword_48F7B0 = texture_get_or_load_alt(aUiUiNum3Jaz);
    dword_48F7B4 = texture_get_or_load_alt(aUiUiNum4Jaz);
    dword_48F7B8 = texture_get_or_load_alt(aUiUiNum5Jaz);
  }
  if ( dword_4AAF88 == 7 )
  {
    ui_weapon_icons_texture = texture_get_or_load((int)aUiWicons, aUiUiWiconsJaz);
    texture_get_or_load((int)aIgameui, aUiUiGametopJaz);
    texture_get_or_load((int)aIheart, aUiUiLifeheartJ);
    ui_clock_table_texture = texture_get_or_load_alt(aUiUiClocktable);
    dword_48F7CC = texture_get_or_load_alt(aUiUiClockpoint);
  }
  if ( dword_4AAF88 == 8 )
  {
    dword_48F7E0 = texture_get_or_load_alt(aGameMuzzleflas);
    texture_get_or_load((int)aUiDropon, aUiUiDropdownon);
    texture_get_or_load((int)aUiDropoff, aUiUiDropdownof);
    if ( !terrain_texture_failed )
      terrain_render_target = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                                grim_interface_ptr,
                                aGround);
  }
  if ( dword_4AAF88 == 9 )
  {
    game_state_id = 0;
    dword_49BB30 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                     grim_interface_ptr,
                     aBulletI);
    dword_496698 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                     grim_interface_ptr,
                     aAim64);
    byte_4AAF86 = 1;
  }
  dword_473A5C = 11;
  ++dword_4AAF88;
  console_flush_log(&console_log_queue, (int)console_log_filename);
  return dword_4AAF88 >= 11;
}

// game_startup_init_prelude @ 0x0042B090
// prelude called by game_startup_init; handles core init, dates, registry time, and terrain reset
LSTATUS sub_42B090()
{
  LSTATUS result; // eax
  int v1; // [esp+40h] [ebp-20h]
  int v2; // [esp+44h] [ebp-1Ch]
  int v3; // [esp+44h] [ebp-1Ch]
  int v4; // [esp+44h] [ebp-1Ch]
  int v5; // [esp+48h] [ebp-18h]
  int v6; // [esp+48h] [ebp-18h]
  int v7; // [esp+48h] [ebp-18h]
  int v8; // [esp+4Ch] [ebp-14h]
  int v9; // [esp+4Ch] [ebp-14h]
  HKEY phkResult; // [esp+50h] [ebp-10h] BYREF
  DWORD Type; // [esp+54h] [ebp-Ch] BYREF
  LARGE_INTEGER PerformanceCount; // [esp+58h] [ebp-8h] BYREF

  dword_4AAEE4 = (int)strdup_malloc(szPassword);
  (*(void (__thiscall **)(int, int, char))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 18, 1);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    v2,
    v5,
    v8);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    6,
    v3,
    v6,
    v9);
  effect_uv_tables_init();
  console_flush_log(&console_log_queue, (int)console_log_filename);
  console_printf((int)&console_log_queue, aEnteringCrimso);
  perks_init_database();
  weapon_table_init();
  game_core_init();
  GetLocalTime(&local_system_time);
  if ( local_system_time.wMonth == 9 )
  {
    if ( local_system_time.wDay != 12 )
      goto LABEL_10;
    goto LABEL_9;
  }
  if ( local_system_time.wMonth != 11 )
  {
    if ( local_system_time.wMonth != 12 || local_system_time.wDay != 18 )
      goto LABEL_10;
    goto LABEL_9;
  }
  if ( local_system_time.wDay == 8 )
  {
LABEL_9:
    byte_4AAED8 = 1;
    texture_get_or_load((int)aBalloon, aBalloonTga);
  }
LABEL_10:
  byte_4AAED8 = 0;
  console_printf((int)&console_log_queue, aUnloadedResour);
  (*(void (__thiscall **)(int, int, int, int, int, CHAR *))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    16,
    v1,
    v4,
    v7,
    szPassword);
  PerformanceCount.QuadPart = local_system_time.wMilliseconds;
  QueryPerformanceCounter(&PerformanceCount);
  crt_srand(PerformanceCount.LowPart);
  gameplay_reset_state();
  byte_4AAED9 = 1;
  terrain_generate_random();
  byte_4AAED9 = 0;
  result = RegCreateKeyExA(HKEY_CURRENT_USER, aSoftware10tons, 0, 0, 0, 0xF003Fu, 0, &phkResult, 0);
  if ( !result )
  {
    reg_read_dword_default(phkResult, aTimeplayed, (BYTE *)&Type, 0);
    *(_DWORD *)&dword_48718C = Type;
    return RegCloseKey(phkResult);
  }
  return result;
}

// sub_42B250 @ 0x0042B250
void __cdecl __noreturn sub_42B250()
{
  char v0; // cl

  console_printf((int)&console_log_queue, aBeginthreadSou);
  audio_init_music();
  audio_init_sfx(v0);
  byte_4AAF85 = 1;
  byte_4AAF8C = 1;
  console_printf((int)&console_log_queue, aEndthreadSound);
  crt_endthread();
}

// game_startup_init @ 0x0042B290
// startup init: logs, builds perks/weapons, seeds UI/effects, loads registry time; triggers intro music then switches to crimson_theme
bool __usercall sub_42B290@<al>(int a1@<edi>, int a2@<esi>)
{
  double v2; // st7
  char v3; // cl
  __int64 v4; // rax
  int v5; // esi
  double v6; // st7
  int v8; // esi
  int v9; // eax
  int v10; // esi
  int v11; // eax
  std::codecvt_base *v12; // ecx
  int v13; // eax
  unsigned __int8 v15; // c0
  unsigned __int8 v16; // c3
  double v17; // st7
  double v18; // st7
  unsigned __int8 v20; // c0
  unsigned __int8 v21; // c3
  double v22; // st7
  __int64 v23; // rax
  int v24; // esi
  double v25; // st7
  double v26; // st7
  int v27; // esi
  int v28; // eax
  int v29; // esi
  int v30; // eax
  double v31; // st7
  int v32; // esi
  int v33; // eax
  int v34; // esi
  int v35; // eax
  int v36; // esi
  int v37; // eax
  __int64 v38; // rax
  int v39; // esi
  double v40; // st7
  float v41; // [esp+ECh] [ebp-2Ch]
  float v42; // [esp+ECh] [ebp-2Ch]
  int v43; // [esp+F0h] [ebp-28h]
  float v44; // [esp+F0h] [ebp-28h]
  float v45; // [esp+F0h] [ebp-28h]
  float v46; // [esp+F0h] [ebp-28h]
  float v47; // [esp+F0h] [ebp-28h]
  float v48; // [esp+F0h] [ebp-28h]
  float v49; // [esp+F0h] [ebp-28h]
  float v50; // [esp+F0h] [ebp-28h]
  float v51; // [esp+F0h] [ebp-28h]
  int v52; // [esp+F4h] [ebp-24h]
  float v53; // [esp+F4h] [ebp-24h]
  int v54; // [esp+F4h] [ebp-24h]
  int v55; // [esp+F4h] [ebp-24h]
  float v56; // [esp+F4h] [ebp-24h]
  int v57; // [esp+F4h] [ebp-24h]
  float v58; // [esp+F4h] [ebp-24h]
  float v59; // [esp+F4h] [ebp-24h]
  float v60; // [esp+F4h] [ebp-24h]
  int v61; // [esp+F4h] [ebp-24h]
  float v62; // [esp+F4h] [ebp-24h]
  int v63; // [esp+F8h] [ebp-20h]
  char *v64; // [esp+F8h] [ebp-20h]
  int v65; // [esp+F8h] [ebp-20h]
  int v66; // [esp+F8h] [ebp-20h]
  char *v67; // [esp+F8h] [ebp-20h]
  int v68; // [esp+F8h] [ebp-20h]
  int v69; // [esp+F8h] [ebp-20h]
  float v70; // [esp+F8h] [ebp-20h]
  char *v71; // [esp+F8h] [ebp-20h]
  int v72; // [esp+FCh] [ebp-1Ch]
  int v73; // [esp+FCh] [ebp-1Ch]
  int v74; // [esp+FCh] [ebp-1Ch]
  float v75; // [esp+FCh] [ebp-1Ch]
  float v76; // [esp+FCh] [ebp-1Ch]
  float v77; // [esp+FCh] [ebp-1Ch]
  int v78; // [esp+FCh] [ebp-1Ch]
  int v79; // [esp+FCh] [ebp-1Ch]
  int v80; // [esp+FCh] [ebp-1Ch]
  float v81; // [esp+FCh] [ebp-1Ch]
  int v82; // [esp+FCh] [ebp-1Ch]
  float v83; // [esp+100h] [ebp-18h]
  int v84; // [esp+104h] [ebp-14h]
  float v85; // [esp+108h] [ebp-10h]
  float v86; // [esp+10Ch] [ebp-Ch]
  float v87[2]; // [esp+110h] [ebp-8h] BYREF
  int retaddr; // [esp+118h] [ebp+0h]

  v2 = ((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 60))(grim_interface_ptr);
  frame_dt = v2;
  if ( v2 > 0.1 )
    frame_dt = 0.1;
  if ( byte_473A60 )
    byte_473A60 = 0;
  v3 = byte_4AAF9C;
  if ( !byte_4AAF9C )
  {
    load_textures_step();
    v3 = byte_4AAF9C;
  }
  if ( byte_473A60 || !byte_4AAF86 )
  {
    if ( !v3 )
      goto LABEL_96;
  }
  else
  {
    texture_get_or_load((int)aSplashreflexiv, aLoadSplashrefl);
    texture_get_or_load((int)aSplash10tons, aLoadSplash10to);
    game_startup_init_prelude();
    crt_beginthread((_beginthread_proc_type)sub_42B250, 0, 0);
    byte_4AAF86 = 0;
    byte_4AAF9C = 1;
    if ( flt_4AAF90 > 0.5 )
      flt_4AAF90 = 0.5;
  }
  if ( !byte_4AAF8C || !byte_4AAF9D )
  {
    if ( byte_4AAF8C )
    {
      v26 = flt_4AAF90 - frame_dt;
      flt_4AAF90 = v26;
      if ( v26 < 0.0 )
      {
        flt_4AAF90 = 0.0;
        byte_4AAF9D = 1;
        v27 = *(_DWORD *)grim_interface_ptr;
        v28 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(grim_interface_ptr, aLoading);
        (*(void (__thiscall **)(int, int))(v27 + 188))(grim_interface_ptr, v28);
        v29 = *(_DWORD *)grim_interface_ptr;
        v30 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(grim_interface_ptr, aLogoEsrb);
        (*(void (__thiscall **)(int, int))(v29 + 188))(grim_interface_ptr, v30);
      }
      goto LABEL_97;
    }
LABEL_96:
    flt_4AAF90 = flt_4AAF90 + frame_dt;
LABEL_97:
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 44))(
      grim_interface_ptr,
      0,
      0,
      0,
      1065353216);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      1,
      v57,
      v68,
      v79);
    v31 = flt_4AAF90 + flt_4AAF90;
    v86 = v31;
    if ( v31 <= 1.0 )
    {
      if ( v86 < 0.0 )
        v86 = 0.0;
    }
    else
    {
      v86 = 1.0;
    }
    (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      COERCE_FLOAT(LODWORD(v86)));
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    v32 = *(_DWORD *)grim_interface_ptr;
    v33 = (*(int (__thiscall **)(int, char *, _DWORD))(*(_DWORD *)grim_interface_ptr + 192))(
            grim_interface_ptr,
            aLogoEsrb,
            0);
    (*(void (__thiscall **)(int, int))(v32 + 196))(grim_interface_ptr, v33);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v58 = flt_471144 - 128.0 - 1.0;
    v46 = screen_width_f - 256.0 - 1.0;
    (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
      LODWORD(v46),
      LODWORD(v58),
      1132462080,
      1124073472);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    v34 = *(_DWORD *)grim_interface_ptr;
    v35 = (*(int (__thiscall **)(int, char *, _DWORD))(*(_DWORD *)grim_interface_ptr + 192))(
            grim_interface_ptr,
            aLoading,
            0);
    (*(void (__thiscall **)(int, int))(v34 + 196))(grim_interface_ptr, v35);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v59 = flt_471144 * 0.5 + 16.0;
    v47 = screen_width_f * 0.5 + 128.0;
    (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
      LODWORD(v47),
      LODWORD(v59),
      1124073472,
      1107296256);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v36 = *(_DWORD *)grim_interface_ptr;
    v37 = (*(int (__thiscall **)(int, char *, _DWORD))(*(_DWORD *)grim_interface_ptr + 192))(
            grim_interface_ptr,
            aClLogo,
            0);
    (*(void (__thiscall **)(int, int))(v36 + 196))(grim_interface_ptr, v37);
    v60 = flt_471144 * 0.5 - 32.0;
    v48 = screen_width_f * 0.5 - 256.0;
    (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
      LODWORD(v48),
      LODWORD(v60),
      1140850688,
      1115684864);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      COERCE_FLOAT(LODWORD(v86)));
    if ( *(float *)(dword_480854 + 12) == 0.0 )
    {
      v81 = v86 * 0.69999999;
      (*(void (__stdcall **)(int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v81));
      v49 = flt_471144 * 0.5 + 32.0;
      v41 = screen_width_f * 0.5 - 246.0;
      (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v41),
        LODWORD(v49),
        aGrimGfxDD,
        dword_4AAF88,
        dword_473A5C - 1);
      v50 = flt_471144 * 0.5 + 45.0;
      v42 = screen_width_f * 0.5 - 246.0;
      (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v42),
        LODWORD(v50),
        aGrimSfxDD,
        dword_4CC8D8,
        81);
    }
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      2,
      v61,
      v69,
      v80);
    flt_496604 = v86 * 0.69999999;
    (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4965F8);
    v87[0] = -4.0;
    v87[1] = flt_471144 * 0.5 - 68.0;
    v70 = screen_width_f + 8.0;
    (*(void (__thiscall **)(int, float *, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 212))(
      grim_interface_ptr,
      v87,
      LODWORD(v70),
      1124073472);
    console_update((int)&console_log_queue, SLODWORD(v86), v36);
    FUN_00401dd0((int)&console_log_queue);
    if ( *(float *)(dword_480868 + 12) != 0.0 )
    {
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        1058642330);
      v38 = (__int64)((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 64))(grim_interface_ptr);
      v39 = *(_DWORD *)grim_interface_ptr;
      if ( (int)v38 < 400 )
      {
        v82 = (__int64)((double (*)(void))*(_DWORD *)(v39 + 64))();
        v71 = aD_0;
        LODWORD(v87[0]) = *(_DWORD *)config_screen_width - 45;
        v62 = (float)(config_screen_height - 24);
        v40 = (double)(*(_DWORD *)config_screen_width - 45);
      }
      else
      {
        v82 = (__int64)((double (*)(void))*(_DWORD *)(v39 + 64))();
        v71 = a400;
        LODWORD(v87[0]) = *(_DWORD *)config_screen_width - 51;
        v62 = (float)(config_screen_height - 24);
        v40 = (double)(*(_DWORD *)config_screen_width - 51);
      }
      v51 = v40;
      (*(void (__cdecl **)(int, _DWORD, float, char *, int))(v39 + 328))(
        grim_interface_ptr,
        LODWORD(v51),
        COERCE_FLOAT(LODWORD(v62)),
        v71,
        v82);
    }
    Sleep(0x32u);
    return 1;
  }
  if ( dword_4AAF98 >= 5 )
  {
    if ( flt_4AAF90 > 14.0 )
    {
      (*(void (__thiscall **)(int, int, int, int, int, char (__usercall *)@<al>(int@<edi>, int@<esi>)))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        45,
        v43,
        v52,
        v63,
        console_hotkey_update);
      v8 = *(_DWORD *)grim_interface_ptr;
      v9 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
             grim_interface_ptr,
             aSplashreflexiv);
      (*(void (__thiscall **)(int, int))(v8 + 188))(grim_interface_ptr, v9);
      v10 = *(_DWORD *)grim_interface_ptr;
      v11 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
              grim_interface_ptr,
              aSplash10tons);
      (*(void (__thiscall **)(int, int))(v10 + 188))(grim_interface_ptr, v11);
      sfx_mute_all(music_track_intro_id);
      if ( game_is_full_version(v12) )
      {
        sfx_play_exclusive(music_track_crimson_theme_id);
      }
      else
      {
        sfx_play_exclusive(music_track_crimsonquest_id);
        demo_mode_start();
      }
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 44))(
        grim_interface_ptr,
        0,
        0,
        0,
        1065353216);
      return 1;
    }
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 1)
      || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 57)
      || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 28)
      || (unsigned __int8)input_primary_just_pressed()
      || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 92))(grim_interface_ptr, 1) )
    {
      byte_4AAF94 = 1;
      goto LABEL_88;
    }
    if ( byte_4AAED9 )
      goto LABEL_88;
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 41) )
      console_set_open(&console_log_queue, console_open_flag == 0);
    dword_47EA48 = LODWORD(frame_dt);
    flt_47EA4C = flt_47EA4C + frame_dt;
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 44))(
      grim_interface_ptr,
      0,
      0,
      0,
      1065353216);
    if ( !byte_4AAF85 )
    {
LABEL_82:
      console_update((int)&console_log_queue, a1, a2);
      FUN_00401dd0((int)&console_log_queue);
      if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 16)
        && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 56) )
      {
        return 0;
      }
      if ( byte_47EA50 )
        return 0;
LABEL_88:
      if ( *(float *)(dword_480868 + 12) != 0.0 )
      {
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          1058642330);
        v23 = (__int64)((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 64))(grim_interface_ptr);
        v24 = *(_DWORD *)grim_interface_ptr;
        if ( (int)v23 < 400 )
        {
          v78 = (__int64)((double (*)(void))*(_DWORD *)(v24 + 64))();
          v67 = aD_0;
          LODWORD(v87[0]) = *(_DWORD *)config_screen_width - 45;
          v56 = (float)(config_screen_height - 24);
          v25 = (double)(*(_DWORD *)config_screen_width - 45);
        }
        else
        {
          v78 = (__int64)((double (*)(void))*(_DWORD *)(v24 + 64))();
          v67 = a400;
          LODWORD(v87[0]) = *(_DWORD *)config_screen_width - 51;
          v56 = (float)(config_screen_height - 24);
          v25 = (double)(*(_DWORD *)config_screen_width - 51);
        }
        v45 = v25;
        (*(void (__cdecl **)(int, _DWORD, float, char *, int))(v24 + 328))(
          grim_interface_ptr,
          LODWORD(v45),
          COERCE_FLOAT(LODWORD(v56)),
          v67,
          v78);
        return 1;
      }
      return 1;
    }
    if ( !(unsigned __int8)sfx_is_unmuted(music_track_intro_id) )
      sfx_play_exclusive(music_track_intro_id);
    flt_4AAF90 = frame_dt * 1.1 + flt_4AAF90;
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      1,
      v54,
      v65,
      v73);
    flt_4AAF90 = flt_4AAF90 - 2.0;
    if ( byte_4AAF94 )
    {
      if ( flt_4AAF90 >= 1.0 && (flt_4AAF90 < 5.0 || flt_4AAF90 >= 7.0 && flt_4AAF90 < 11.0) )
        flt_4AAF90 = frame_dt * 4.0 + flt_4AAF90;
      else
        flt_4AAF90 = 16.0;
    }
    a2 = 64;
    (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
      grim_interface_ptr,
      0,
      0,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
    if ( flt_4AAF90 <= 1.0 || flt_4AAF90 >= 5.0 )
    {
      if ( flt_4AAF90 <= 6.0 )
        goto LABEL_54;
      v13 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
              grim_interface_ptr,
              aSplashreflexiv);
      a2 = 256;
    }
    else
    {
      a2 = 128;
      v13 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
              grim_interface_ptr,
              aSplash10tons);
    }
    if ( v13 >= 0 )
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, v13, 0);
LABEL_54:
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    if ( v15 | v16 )
    {
      if ( flt_4AAF90 < 2.0 )
      {
        if ( flt_4AAF90 < 4.0 )
          goto LABEL_67;
        goto LABEL_61;
      }
    }
    else if ( flt_4AAF90 < 2.0 )
    {
      v75 = flt_4AAF90 - 1.0;
      (*(void (__stdcall **)(int, int, int, _DWORD, float, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v75),
        COERCE_FLOAT(LODWORD(v83)),
        v84,
        COERCE_FLOAT(LODWORD(v85)));
      v85 = (float)retaddr;
      a1 = *(_DWORD *)grim_interface_ptr;
      v84 = 1140850688;
      v83 = (float)(config_screen_height / 2 - a2 / 2);
      v17 = (double)(*(_DWORD *)config_screen_width / 2 - 256);
LABEL_80:
      v77 = v17;
      (*(void (__stdcall **)(_DWORD))(a1 + 284))(LODWORD(v77));
      goto LABEL_81;
    }
    if ( flt_4AAF90 < 4.0 )
    {
LABEL_59:
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        1065353216);
      v85 = (float)retaddr;
      a1 = *(_DWORD *)grim_interface_ptr;
      v84 = 1140850688;
      v83 = (float)(config_screen_height / 2 - a2 / 2);
      v17 = (double)(*(_DWORD *)config_screen_width / 2 - 256);
      goto LABEL_80;
    }
LABEL_61:
    if ( flt_4AAF90 < 5.0 )
    {
      v18 = 1.0 - (flt_4AAF90 - 4.0);
      v87[0] = v18;
      if ( v18 >= 0.0 )
      {
        if ( v87[0] > 1.0 )
          v87[0] = 1.0;
      }
      else
      {
        v87[0] = 0.0;
      }
      (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v87[0]));
      v85 = (float)retaddr;
      a1 = *(_DWORD *)grim_interface_ptr;
      v84 = 1140850688;
      v83 = (float)(config_screen_height / 2 - a2 / 2);
      v17 = (double)(*(_DWORD *)config_screen_width / 2 - 256);
      goto LABEL_80;
    }
LABEL_67:
    if ( v20 | v21 )
    {
      if ( flt_4AAF90 < 8.0 )
      {
        if ( flt_4AAF90 < 10.0 )
          goto LABEL_81;
        goto LABEL_74;
      }
    }
    else if ( flt_4AAF90 < 8.0 )
    {
      v76 = flt_4AAF90 - 6.0 - 1.0;
      (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v76));
      v85 = (float)retaddr;
      a1 = *(_DWORD *)grim_interface_ptr;
      v84 = 1140850688;
      v83 = (float)(config_screen_height / 2 - a2 / 2);
      v17 = (double)(*(_DWORD *)config_screen_width / 2 - 256);
      goto LABEL_80;
    }
    if ( flt_4AAF90 < 10.0 )
      goto LABEL_59;
LABEL_74:
    if ( flt_4AAF90 < 11.0 )
    {
      v22 = 1.0 - (flt_4AAF90 - 6.0 - 4.0);
      v87[0] = v22;
      if ( v22 >= 0.0 )
      {
        if ( v87[0] > 1.0 )
          v87[0] = 1.0;
      }
      else
      {
        v87[0] = 0.0;
      }
      (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v87[0]));
      (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v87[0]));
      v85 = (float)retaddr;
      a1 = *(_DWORD *)grim_interface_ptr;
      v84 = 1140850688;
      v83 = (float)(config_screen_height / 2 - a2 / 2);
      v17 = (double)(*(_DWORD *)config_screen_width / 2 - 256);
      goto LABEL_80;
    }
LABEL_81:
    flt_4AAF90 = flt_4AAF90 + 2.0;
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      2,
      v55,
      v66,
      v74);
    (*(void (__thiscall **)(int, float, int, float))(*(_DWORD *)grim_interface_ptr + 240))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v83)),
      v84,
      COERCE_FLOAT(LODWORD(v85)));
    audio_update();
    goto LABEL_82;
  }
  ++dword_4AAF98;
  Sleep(5u);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 44))(
    grim_interface_ptr,
    0,
    0,
    0,
    1065353216);
  audio_update();
  console_update((int)&console_log_queue, a1, a2);
  FUN_00401dd0((int)&console_log_queue);
  if ( *(float *)(dword_480868 + 12) != 0.0 )
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1058642330);
    v4 = (__int64)((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 64))(grim_interface_ptr);
    v5 = *(_DWORD *)grim_interface_ptr;
    if ( (int)v4 < 400 )
    {
      v72 = (__int64)((double (*)(void))*(_DWORD *)(v5 + 64))();
      v64 = aD_0;
      LODWORD(v87[0]) = *(_DWORD *)config_screen_width - 45;
      v53 = (float)(config_screen_height - 24);
      v6 = (double)(*(_DWORD *)config_screen_width - 45);
    }
    else
    {
      v72 = (__int64)((double (*)(void))*(_DWORD *)(v5 + 64))();
      v64 = a400;
      LODWORD(v87[0]) = *(_DWORD *)config_screen_width - 51;
      v53 = (float)(config_screen_height - 24);
      v6 = (double)(*(_DWORD *)config_screen_width - 51);
    }
    v44 = v6;
    (*(void (__cdecl **)(int, _DWORD, float, char *, int))(v5 + 328))(
      grim_interface_ptr,
      LODWORD(v44),
      COERCE_FLOAT(LODWORD(v53)),
      v64,
      v72);
  }
  return (!(*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 16)
       || !(*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 56))
      && byte_47EA50 == 0;
}

// console_cmd_snd_add_game_tune @ 0x0042C360
// console command handler for snd_addGameTune; loads music\%s and queues the track
char sub_42C360()
{
  int v0; // eax
  char *v1; // eax
  char Buffer[1024]; // [esp+0h] [ebp-400h] BYREF

  if ( FUN_00401150() == 2 )
  {
    v1 = FUN_00401120(1);
    crt_sprintf(Buffer, "music\\%s", v1);
    v0 = music_load_track((size_t)Buffer);
    if ( v0 >= 0 )
      LOBYTE(v0) = music_queue_track(v0);
  }
  else
  {
    LOBYTE(v0) = console_printf((int)&console_log_queue, aSndAddgametune_0);
  }
  return v0;
}

// console_cmd_set_gamma_ramp @ 0x0042C3D0
// console command handler for setGammaRamp; parses float and calls grim_set_config_var(0x1c)
char sub_42C3D0()
{
  char *v2; // eax
  float v3; // [esp+1Ch] [ebp-4h]

  if ( FUN_00401150() == 2 )
  {
    v2 = FUN_00401120(1);
    v3 = crt_atof_l(v2);
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 28, LODWORD(v3));
    return console_printf((int)&console_log_queue, "Gamma ramp regenerated and multiplied with %f\n", v3);
  }
  else
  {
    console_printf((int)&console_log_queue, aSetgammarampSc);
    return console_printf((int)&console_log_queue, aCommandAdjusts);
  }
}

// crimsonland_main @ 0x0042C450
// primary game init/run/shutdown sequence
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
  __time32_t v4; // eax
  int v6; // esi
  char v7; // al
  int v8; // eax
  const CHAR *v9; // eax
  int v10; // edx
  int *v11; // ecx
  int *v12; // eax
  int v13; // edx
  int v14; // [esp+180h] [ebp-440h]
  int v15; // [esp+180h] [ebp-440h]
  int v16; // [esp+180h] [ebp-440h]
  int v17; // [esp+180h] [ebp-440h]
  int v18; // [esp+180h] [ebp-440h]
  int v19; // [esp+180h] [ebp-440h]
  int v20; // [esp+180h] [ebp-440h]
  int v21; // [esp+180h] [ebp-440h]
  int v22; // [esp+180h] [ebp-440h]
  int v23; // [esp+180h] [ebp-440h]
  int v24; // [esp+180h] [ebp-440h]
  int v25; // [esp+180h] [ebp-440h]
  int v26; // [esp+184h] [ebp-43Ch]
  int v27; // [esp+184h] [ebp-43Ch]
  int v28; // [esp+184h] [ebp-43Ch]
  int v29; // [esp+184h] [ebp-43Ch]
  int v30; // [esp+184h] [ebp-43Ch]
  int v31; // [esp+184h] [ebp-43Ch]
  int v32; // [esp+184h] [ebp-43Ch]
  int v33; // [esp+184h] [ebp-43Ch]
  int v34; // [esp+184h] [ebp-43Ch]
  int v35; // [esp+184h] [ebp-43Ch]
  int v36; // [esp+184h] [ebp-43Ch]
  int v37; // [esp+184h] [ebp-43Ch]
  int v38; // [esp+184h] [ebp-43Ch]
  int v39; // [esp+184h] [ebp-43Ch]
  int v40; // [esp+184h] [ebp-43Ch]
  int v41; // [esp+188h] [ebp-438h]
  int v42; // [esp+188h] [ebp-438h]
  int v43; // [esp+188h] [ebp-438h]
  int v44; // [esp+188h] [ebp-438h]
  int v45; // [esp+188h] [ebp-438h]
  int v46; // [esp+188h] [ebp-438h]
  int v47; // [esp+188h] [ebp-438h]
  int v48; // [esp+188h] [ebp-438h]
  int v49; // [esp+188h] [ebp-438h]
  int v50; // [esp+188h] [ebp-438h]
  int v51; // [esp+188h] [ebp-438h]
  int v52; // [esp+188h] [ebp-438h]
  int v53; // [esp+188h] [ebp-438h]
  int v54; // [esp+188h] [ebp-438h]
  int v55; // [esp+188h] [ebp-438h]
  int v56; // [esp+18Ch] [ebp-434h]
  int v57; // [esp+18Ch] [ebp-434h]
  int v58; // [esp+18Ch] [ebp-434h]
  int v59; // [esp+18Ch] [ebp-434h]
  int v60; // [esp+18Ch] [ebp-434h]
  int v61; // [esp+18Ch] [ebp-434h]
  int v62; // [esp+18Ch] [ebp-434h]
  int v63; // [esp+18Ch] [ebp-434h]
  int v64; // [esp+18Ch] [ebp-434h]
  int v65; // [esp+18Ch] [ebp-434h]
  HKEY phkResult; // [esp+19Ch] [ebp-424h] BYREF
  int v67; // [esp+1A0h] [ebp-420h] BYREF
  char v68[16]; // [esp+1A4h] [ebp-41Ch] BYREF
  char Buffer[12]; // [esp+1B4h] [ebp-40Ch] BYREF
  WCHAR WideCharStr[512]; // [esp+1C0h] [ebp-400h] BYREF

  v4 = FUN_004623b2(0);
  crt_srand(v4);
  v67 = 0;
  if ( dx_get_version((size_t *)&v67, Buffer, 10) < 0 )
  {
    if ( MessageBoxA(0, aUnknownDirectx, szAgent, 4u) == 7 )
      return 0;
  }
  else if ( (unsigned int)v67 < 0x80100 )
  {
    if ( MessageBoxA(0, Text, szAgent, 0x23u) == 6 )
    {
      MultiByteToWideChar(0, 0, MultiByteStr, -1, WideCharStr, 260);
      if ( HlinkNavigateString(0, WideCharStr) < 0 )
      {
        MessageBoxA(0, aFailedToLaunch, szAgent, 0);
        return 0;
      }
    }
    return 0;
  }
  crt_getcwd(game_base_path, 259);
  GetCommandLineA();
  dword_473A64 = 123;
  v6 = Direct3DCreate8(220);
  console_printf((int)&console_log_queue, aCrimsonland_0);
  console_printf((int)&console_log_queue, asc_474D54);
  console_printf((int)&console_log_queue, asc_4711C0);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  if ( !v6 )
  {
    MessageBoxA(0, aDirectx81NotDe, szAgent, 0);
    return 0;
  }
  (*(void (__stdcall **)(int))(*(_DWORD *)v6 + 8))(v6);
  console_printf((int)&console_log_queue, "Game base path: '%s'\n", game_base_path);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  config_ensure_file();
  console_register_command((char **)&console_log_queue, aSetgammaramp, (int)console_cmd_set_gamma_ramp);
  console_register_command((char **)&console_log_queue, aSndAddgametune, (int)console_cmd_snd_add_game_tune);
  console_register_command((char **)&console_log_queue, aGenerateterrai, (int)console_cmd_generate_terrain);
  console_register_command((char **)&console_log_queue, aTelltimesurviv, (int)console_cmd_tell_time_survived);
  console_register_command((char **)&console_log_queue, aSetresourcepaq, (int)console_cmd_set_resource_paq);
  console_register_command((char **)&console_log_queue, aLoadtexture, (int)console_cmd_load_texture);
  console_register_command((char **)&console_log_queue, aOpenurl, (int)console_cmd_open_url);
  console_register_command((char **)&console_log_queue, aSndfreqadjustm, (int)console_cmd_snd_freq_adjustment);
  memset(&SubKey, 0, 0xFCu);
  unk_4853CC = 0;
  unk_4853CE = 0;
  qmemcpy(&SubKey, "Software\\Sock", 13);
  grim_interface_ptr = (int)grim_load_interface(aGrimGrsystemCR);
  console_printf((int)&console_log_queue, asc_4740FC);
  console_printf((int)&console_log_queue, aGrim2dApi);
  console_printf((int)&console_log_queue, asc_4740FC);
  console_printf((int)&console_log_queue, aInitiatingGrim);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  qmemcpy(&byte_4852DD, "etPlugins\\Default\\", 18);
  if ( !grim_interface_ptr )
  {
    console_printf((int)&console_log_queue, aDevDllNotFound);
    grim_interface_ptr = (int)grim_load_interface(aGrimDll);
  }
  console_flush_log(&console_log_queue, (int)console_log_filename);
  if ( !grim_interface_ptr )
  {
    MessageBoxA(0, aGrimDllIsCorru, aGrim, 0);
    return 0;
  }
  console_printf((int)&console_log_queue, aInterfaceCreat);
  console_printf((int)&console_log_queue, aRegisteringCor);
  register_core_cvars();
  if ( dword_473A64 != 123 )
    grim_interface_ptr = 0;
  console_flush_log(&console_log_queue, (int)console_log_filename);
  console_printf((int)&console_log_queue, aLoadingConfigP);
  config_load_presets(0);
  game_load_status();
  game_sequence_load();
  console_flush_log(&console_log_queue, (int)console_log_filename);
  console_printf((int)&console_log_queue, aInvokingGrimCo);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  v7 = (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 16))(grim_interface_ptr);
  grim_config_invoked = 1;
  if ( !v7 )
  {
    config_sync_from_grim();
    grim_config_invoked = 0;
    (**(void (__thiscall ***)(int))grim_interface_ptr)(grim_interface_ptr);
    return 0;
  }
  config_sync_from_grim();
  grim_config_invoked = 0;
  config_load_presets(1);
  console_printf((int)&console_log_queue, aSettingSystemS);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  terrain_texture_failed = *(_BYTE *)(*(int (__thiscall **)(int, char *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                                       grim_interface_ptr,
                                       v68,
                                       84);
  byte_4AAEEA = *(_BYTE *)(*(int (__thiscall **)(int, char *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                            grim_interface_ptr,
                            v68,
                            83);
  *(_DWORD *)config_texture_scale = *(_DWORD *)(*(int (__thiscall **)(int, char *, int))(*(_DWORD *)grim_interface_ptr
                                                                                       + 36))(
                                                 grim_interface_ptr,
                                                 v68,
                                                 89);
  if ( *(float *)config_texture_scale != 0.5
    && *(float *)config_texture_scale != 1.0
    && *(float *)config_texture_scale != 2.0
    && *(float *)config_texture_scale != 4.0 )
  {
    *(_DWORD *)config_texture_scale = 1065353216;
  }
  LOBYTE(config_blob[0]) = byte_4AAEEA;
  config_windowed = *(_BYTE *)(*(int (__thiscall **)(int, char *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                                grim_interface_ptr,
                                v68,
                                8);
  if ( terrain_texture_failed )
    console_printf((int)&console_log_queue, aUsingSafemodeF);
  else
    console_printf((int)&console_log_queue, aUsingPrimaryBa);
  if ( !grim_interface_ptr )
    console_printf((int)&console_log_queue, aUsingDeveloper);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  (*(void (__thiscall **)(int, int, int, int, int, bool (__usercall *)@<al>(int@<edi>, int@<esi>)))(*(_DWORD *)grim_interface_ptr
                                                                                                  + 32))(
    grim_interface_ptr,
    45,
    v14,
    v26,
    v41,
    game_startup_init);
  (*(void (__thiscall **)(int, int, int, int, int, char (*)()))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    5,
    v15,
    v27,
    v42,
    audio_suspend_all);
  (*(void (__thiscall **)(int, int, int, int, int, char (*)()))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    6,
    v16,
    v28,
    v43,
    audio_resume_all);
  LOBYTE(v17) = 1;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    66,
    v17,
    v29,
    v44,
    v56);
  console_printf((int)&console_log_queue, aSettingSystemS);
  (*(void (__thiscall **)(int, int, int, int, int, CHAR *))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    7,
    v18,
    v30,
    v45,
    szAgent);
  *(_DWORD *)config_screen_width = *(_DWORD *)(*(int (__thiscall **)(int, char *, int))(*(_DWORD *)grim_interface_ptr
                                                                                      + 36))(
                                                grim_interface_ptr,
                                                v68,
                                                41);
  v8 = *(_DWORD *)(*(int (__thiscall **)(int, char *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                    grim_interface_ptr,
                    v68,
                    42);
  config_screen_height = v8;
  if ( config_windowed )
    console_printf(
      (int)&console_log_queue,
      "...selected windowed mode, window size %dx%d",
      *(_DWORD *)config_screen_width,
      v8);
  else
    console_printf(
      (int)&console_log_queue,
      "...selected fullscreen mode %dx%dx%d",
      *(_DWORD *)config_screen_width,
      v8,
      config_display_bpp);
  byte_4AAEDA = BYTE1(config_blob[0]);
  LOBYTE(v19) = 1;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    11,
    v19,
    v31,
    v46,
    v57);
  console_printf((int)&console_log_queue, aUsingKeyboard);
  LOBYTE(v20) = 1;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    12,
    v20,
    v32,
    v47,
    v58);
  console_printf((int)&console_log_queue, aUsingMouse);
  LOBYTE(v21) = 1;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    14,
    v21,
    v33,
    v48,
    v59);
  console_printf((int)&console_log_queue, aUsingJoystick);
  console_printf((int)&console_log_queue, aInitiatingGrim_0);
  if ( !(*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 20))(grim_interface_ptr) )
  {
    console_printf((int)&console_log_queue, aCriticalFailur);
    v9 = (const CHAR *)(*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 40))(grim_interface_ptr);
    MessageBoxA(0, v9, aCrimsonland_1, 0);
    (**(void (__thiscall ***)(int))grim_interface_ptr)(grim_interface_ptr);
    return 0;
  }
  console_exec_line((char *)&console_log_queue, (int)aExecAutoexecTx);
  LOBYTE(v22) = 1;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    18,
    v22,
    v34,
    v49,
    v60);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    v35,
    v50,
    v61);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    6,
    v36,
    v51,
    v62);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1065353216,
    v37,
    v52,
    v63);
  screen_width_f = (float)*(int *)config_screen_width;
  flt_471144 = (float)config_screen_height;
  *((float *)console_register_cvar((char ***)&console_log_queue, aVWidth, a800) + 3) = (float)*(int *)config_screen_width;
  *((float *)console_register_cvar((char ***)&console_log_queue, aVHeight, a600) + 3) = (float)config_screen_height;
  init_audio_and_terrain();
  (*(void (__thiscall **)(int, int, int, int, int, char *))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    16,
    v23,
    v38,
    v53,
    aCrimsonPaq);
  console_printf((int)&console_log_queue, aSetResourcePaq);
  texture_get_or_load((int)aBackplasma, aLoadBackplasma);
  texture_get_or_load((int)aMockup, aLoadMockupJaz);
  texture_get_or_load((int)aLogoEsrb, aLoadEsrbMature);
  texture_get_or_load((int)aLoading, aLoadLoadingJaz);
  texture_get_or_load((int)aClLogo, aLoadLogoCrimso);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 44))(
    grim_interface_ptr,
    0,
    0,
    0,
    1065353216);
  LOBYTE(v24) = 1;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    54,
    v24,
    v39,
    v54,
    v64);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 44))(
    grim_interface_ptr,
    0,
    0,
    0,
    1065353216);
  LOBYTE(v25) = 1;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    54,
    v25,
    v40,
    v55,
    v65);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 44))(
    grim_interface_ptr,
    0,
    0,
    0,
    1065353216);
  v10 = dword_473A30;
  key_char_count = 0;
  memset(&key_char_buffer, 0, dword_473A30);
  (*(void (__thiscall **)(int, void *, int *, int))(*(_DWORD *)grim_interface_ptr + 84))(
    grim_interface_ptr,
    &key_char_buffer,
    &key_char_count,
    v10);
  config_sync_from_grim();
  v11 = &player_move_key_backward;
  v12 = &config_p1_axis_move_x;
  do
  {
    v13 = *(v12 - 12);
    v12 += 16;
    *(v11 - 1) = v13;
    *v11 = *(v12 - 27);
    v11[1] = *(v12 - 26);
    v11[2] = *(v12 - 25);
    v11[3] = *(v12 - 24);
    v11[4] = *(v12 - 23);
    v11[5] = *(v12 - 22);
    v11[6] = *(v12 - 21);
    v11[7] = *(v12 - 20);
    v11[9] = *(v12 - 19);
    v11[8] = *(v12 - 18);
    v11[11] = *(v12 - 17);
    v11[10] = *(v12 - 16);
    v11 += 216;
  }
  while ( (int)v12 < (int)dword_4805C0 );
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 28))(grim_interface_ptr);
  if ( RegCreateKeyExA(HKEY_CURRENT_USER, aSoftware10tons, 0, 0, 0, 0xF003Fu, 0, &phkResult, 0) )
  {
    console_printf((int)&console_log_queue, aKameliWasNotHa);
  }
  else
  {
    reg_write_dword(phkResult, aTimeplayed, *(_DWORD *)&dword_48718C);
    RegCloseKey(phkResult);
  }
  game_save_status();
  console_printf((int)&console_log_queue, aLeavingCrimson);
  if ( dword_4AAEE4 )
    crt_free((LPVOID)dword_4AAEE4);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  audio_shutdown_all();
  console_printf((int)&console_log_queue, aShutdownGrim);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 24))(grim_interface_ptr);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  (**(void (__thiscall ***)(int))grim_interface_ptr)(grim_interface_ptr);
  console_printf((int)&console_log_queue, aWavingTheGrimR);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  if ( !dword_4D11F0 && byte_4D11F8 && lpMultiByteStr )
  {
    Sleep(0xC8u);
    memset(WideCharStr, 0, sizeof(WideCharStr));
    MultiByteToWideChar(0, 1u, lpMultiByteStr, strlen(lpMultiByteStr), WideCharStr, 511);
    if ( HlinkNavigateString(0, WideCharStr) < 0 )
      console_printf((int)&console_log_queue, "Failed to open browser at '%s'.\n", lpMultiByteStr);
    byte_4D11F8 = 0;
  }
  console_flush_log(&console_log_queue, (int)console_log_filename);
  return 0;
}

// sub_42D0E0 @ 0x0042D0E0
void __cdecl __noreturn sub_42D0E0()
{
  unsigned __int8 *v0; // ebp
  DWORD v1; // ebx
  std::codecvt_base *v2; // ecx
  std::codecvt_base *v3; // ecx
  char *v4; // edi
  char v5; // al
  bool v6; // cc
  void *v7; // esi
  void *v8; // edx
  void *v9; // eax
  BOOL v10; // edi
  BOOL v11; // eax
  DWORD v12; // ecx
  DWORD v13; // esi
  BOOL v14; // eax
  DWORD LastError; // eax
  signed int v16; // edi
  char *v17; // ebx
  int v18; // [esp-8h] [ebp-178h]
  DWORD v19; // [esp-4h] [ebp-174h]
  char v20; // [esp+13h] [ebp-15Dh]
  unsigned __int8 *v21; // [esp+14h] [ebp-15Ch]
  HINTERNET v22; // [esp+14h] [ebp-15Ch]
  DWORD dwError; // [esp+18h] [ebp-158h] BYREF
  HINTERNET hFile; // [esp+1Ch] [ebp-154h]
  DWORD dwNumberOfBytesRead; // [esp+20h] [ebp-150h] BYREF
  int v26; // [esp+24h] [ebp-14Ch]
  DWORD dwHeadersLength; // [esp+28h] [ebp-148h] BYREF
  HINTERNET hInternet; // [esp+2Ch] [ebp-144h]
  int v29; // [esp+30h] [ebp-140h]
  CHAR szServerName[64]; // [esp+34h] [ebp-13Ch] BYREF
  LPCSTR lpszAcceptTypes[11]; // [esp+74h] [ebp-FCh] BYREF
  _DWORD v32[18]; // [esp+A0h] [ebp-D0h] BYREF
  _BYTE v33[64]; // [esp+E8h] [ebp-88h] BYREF
  _BYTE v34[72]; // [esp+128h] [ebp-48h] BYREF

  console_printf((int)&console_log_queue, aBeginthreadHig);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  qmemcpy(v34, highscore_active_record, sizeof(v34));
  dword_4D11F0 = 1;
  v20 = 0;
  hInternet = 0;
  hFile = 0;
  dwNumberOfBytesRead = 0;
  lpszAcceptTypes[0] = aImageGif;
  lpszAcceptTypes[1] = aImageXXbitmap;
  lpszAcceptTypes[2] = aImageJpeg;
  lpszAcceptTypes[3] = aImagePjpeg;
  lpszAcceptTypes[4] = aApplicationVnd;
  lpszAcceptTypes[5] = aApplicationVnd_0;
  lpszAcceptTypes[6] = aApplicationMsw;
  lpszAcceptTypes[7] = aApplicationXCo;
  lpszAcceptTypes[8] = aApplicationOct;
  lpszAcceptTypes[9] = asc_475278;
  lpszAcceptTypes[10] = 0;
  dwHeadersLength = strlen(szHeaders);
  v0 = (unsigned __int8 *)operator new(0x8000u);
  BYTE2(config_blob[0]) = 0;
  config_score_load_gate = 0;
  j_highscore_load_table();
  config_score_load_gate = 1;
  memset(v0, 0, 0x8000u);
  *v0 = 66;
  v0[1] = 72;
  v0[2] = -13;
  v0[3] = -123;
  if ( config_name_slot_selected )
    v0[4] = 1;
  else
    v0[4] = 0;
  if ( !game_is_full_version(0) )
    v0[4] = 0;
  v0[5] = 0;
  if ( config_hardcore )
    v0[6] = 5;
  else
    v0[6] = config_game_mode;
  v0[7] = quest_stage_major[0];
  v0[8] = quest_stage_minor;
  v0[9] = config_player_count;
  strcpy((char *)v0 + 10, &config_saved_name_0[27 * config_name_slot_selected]);
  memset(v32, 0, sizeof(v32));
  v1 = strlen((const char *)v0 + 10) + 11;
  strcpy((char *)v32, default_player_name);
  LOBYTE(v32[17]) = 0;
  HIWORD(v32[17]) = -132;
  LOBYTE(v26) = 0;
  v32[14] = crt_rand() & 0xFEE050F;
  if ( game_is_full_version(v2) )
  {
    v29 = 0;
    if ( (int)dword_4C395C > 0 )
    {
      v4 = &byte_482B54;
      v21 = &v0[v1];
      dwError = (DWORD)&byte_482B54;
      do
      {
        v5 = *v4;
        if ( !*v4 || (v5 & 2) != 0 || (v5 & 1) == 0 )
        {
          if ( (unsigned __int8)sub_43AA60(v4 - 68) )
          {
            FUN_0043aa90(v4 - 68, v33);
            qmemcpy(v21, v33, 0x40u);
            v4 = (char *)dwError;
            v1 += 64;
            v21 += 64;
            LOBYTE(v26) = v26 + 1;
          }
          else
          {
            console_printf((int)&console_log_queue, aDetectedAPoten);
          }
        }
        v3 = dword_4C395C;
        v4 += 72;
        v6 = ++v29 < (int)dword_4C395C;
        dwError = (DWORD)v4;
      }
      while ( v6 );
    }
  }
  if ( game_is_full_version(v3) )
    v0[5] = v26;
  v7 = InternetOpenA(szAgent, 0, 0, 0, 0);
  v22 = v7;
  if ( !v7 )
  {
    console_printf((int)&console_log_queue, aOnlineScoresIn);
    goto LABEL_45;
  }
  memset(szServerName, 0, sizeof(szServerName));
  qmemcpy(szServerName, "scores.crimsonland.com", 22);
  v8 = InternetConnectA(v7, szServerName, 0x50u, szUserName, szPassword, 3u, 0x44000000u, 0x1289u);
  memset(szServerName, 0, sizeof(szServerName));
  hInternet = v8;
  qmemcpy(szServerName, "/scoring_v2_7.php", 17);
  if ( v8 )
  {
    v9 = HttpOpenRequestA(v8, szVerb, szServerName, szVersion, szReferrer, lpszAcceptTypes, 0x4000000u, 0x1289u);
    hFile = v9;
    if ( v9 )
    {
      v10 = HttpSendRequestA(v9, szHeaders, dwHeadersLength, v0, v1);
      console_printf((int)&console_log_queue, "<-- Sending %d scores in %d bytes.\n", (unsigned __int8)v26, v1);
      if ( !v10 )
      {
        console_printf((int)&console_log_queue, aOnlineScoresHt);
        goto LABEL_45;
      }
      memset(v0, 0, 0x8000u);
      v11 = InternetReadFile(hFile, v0, 0x400u, &dwNumberOfBytesRead);
      v12 = dwNumberOfBytesRead;
      v13 = dwNumberOfBytesRead;
      if ( !v11 )
      {
LABEL_31:
        console_printf((int)&console_log_queue, aOnlineScoresIn_0);
        LastError = GetLastError();
        console_printf((int)&console_log_queue, "Reason: %d\n", LastError);
        dwHeadersLength = 0x8000;
        InternetGetLastResponseInfoA(&dwError, (LPSTR)v0, &dwHeadersLength);
        console_printf((int)&console_log_queue, "Or: %s\n", v0);
LABEL_32:
        v7 = v22;
        goto LABEL_45;
      }
      while ( (int)(v13 + 1024) <= 0x8000 )
      {
        if ( !v12 )
          goto LABEL_34;
        v14 = InternetReadFile(hFile, &v0[v13], 0x400u, &dwNumberOfBytesRead);
        v12 = dwNumberOfBytesRead;
        v13 += dwNumberOfBytesRead;
        if ( !v14 )
          goto LABEL_31;
      }
      console_printf((int)&console_log_queue, aWarningReceivi);
LABEL_34:
      console_printf((int)&console_log_queue, aOnlineScoresBe);
      if ( *v0 == 21 )
      {
        v18 = v0[2];
        v16 = v0[1] + v18;
        console_printf((int)&console_log_queue, "<-- %d scores (%d+%d) received in %d bytes.\n", v16, v0[1], v18, v13);
        if ( v13 - 3 != 68 * v16 )
        {
          console_printf(
            (int)&console_log_queue,
            "! Invalid number of bytes received (%d should be %d).\n",
            v13 - 3,
            68 * v16);
          v0[512] = 0;
          console_printf((int)&console_log_queue, "->%s<-\n", v0);
          goto LABEL_32;
        }
        console_printf((int)&console_log_queue, aSavingScores);
        if ( v16 > 0 )
        {
          v17 = (char *)(v0 + 3);
          dwError = v16;
          do
          {
            qmemcpy(v32, v17, 0x44u);
            LOBYTE(v32[17]) = 1;
            BYTE1(v32[17]) = config_hardcore != 0 ? 0x75 : 0;
            highscore_save_record(v32);
            v17 += 68;
            --dwError;
          }
          while ( dwError );
        }
      }
      else
      {
        v0[512] = 0;
        console_printf((int)&console_log_queue, "invalid feedback (%d bytes).\n", v13);
        console_printf((int)&console_log_queue, "<-- (%d %d)\n", *v0, v0[1]);
        console_printf((int)&console_log_queue, "->%s<-\n", (const char *)v0);
      }
      console_printf((int)&console_log_queue, aOnlineScoresSc);
      v7 = v22;
      v20 = 1;
    }
    else
    {
      console_printf((int)&console_log_queue, aOnlineScoresHt_0);
    }
  }
  else
  {
    console_printf((int)&console_log_queue, aOnlineScoresIn_1);
  }
LABEL_45:
  console_printf((int)&console_log_queue, aOnlineScoresCl);
  crt_free(v0);
  if ( hFile )
    InternetCloseHandle(hFile);
  if ( hInternet )
    InternetCloseHandle(hInternet);
  if ( v7 )
    InternetCloseHandle(v7);
  j_highscore_load_table();
  qmemcpy(highscore_active_record, v34, 0x48u);
  if ( v20 )
  {
    if ( byte_4D11F9 )
      v19 = 20;
    else
      v19 = 300;
    Sleep(v19);
    dword_4D11F0 = 5;
    if ( byte_4D11F9 )
      Sleep(0x14u);
    else
      Sleep(0x12Cu);
    dword_4D11F0 = 0;
  }
  else
  {
    if ( byte_4D11F9 )
      Sleep(0x14u);
    else
      Sleep(0x12Cu);
    dword_4D11F0 = 6;
  }
  console_printf((int)&console_log_queue, aEndthreadHighS);
  crt_endthread();
}

// sub_42D8A0 @ 0x0042D8A0
void __cdecl __noreturn sub_42D8A0()
{
  void *v0; // ebx
  char *v1; // ebp
  void *v2; // edx
  void *v3; // eax
  BOOL v4; // esi
  BOOL v5; // eax
  DWORD v6; // ecx
  DWORD v7; // esi
  BOOL v8; // eax
  DWORD LastError; // eax
  const char *v10; // esi
  const char *v11; // edi
  char *v12; // eax
  char *v13; // eax
  char *v14; // eax
  char *v15; // eax
  char v16; // [esp+13h] [ebp-8Dh]
  DWORD dwNumberOfBytesRead; // [esp+14h] [ebp-8Ch] BYREF
  DWORD dwHeadersLength; // [esp+18h] [ebp-88h] BYREF
  HINTERNET hInternet; // [esp+1Ch] [ebp-84h]
  HINTERNET v20; // [esp+20h] [ebp-80h]
  char ArgList[4]; // [esp+24h] [ebp-7Ch] BYREF
  int v22; // [esp+28h] [ebp-78h] BYREF
  int v23; // [esp+2Ch] [ebp-74h] BYREF
  CHAR szServerName[64]; // [esp+30h] [ebp-70h] BYREF
  LPCSTR lpszAcceptTypes[11]; // [esp+70h] [ebp-30h] BYREF
  DWORD dwError; // [esp+9Ch] [ebp-4h] BYREF

  dword_4D11F0 = 1;
  console_printf((int)&console_log_queue, aBeginthreadVer);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  v0 = 0;
  v16 = 0;
  v20 = 0;
  dwNumberOfBytesRead = 0;
  lpszAcceptTypes[0] = aImageGif;
  lpszAcceptTypes[1] = aImageXXbitmap;
  lpszAcceptTypes[2] = aImageJpeg;
  lpszAcceptTypes[3] = aImagePjpeg;
  lpszAcceptTypes[4] = aApplicationVnd;
  lpszAcceptTypes[5] = aApplicationVnd_0;
  lpszAcceptTypes[6] = aApplicationMsw;
  lpszAcceptTypes[7] = aApplicationXCo;
  lpszAcceptTypes[8] = aApplicationOct;
  lpszAcceptTypes[9] = asc_475278;
  lpszAcceptTypes[10] = 0;
  dwHeadersLength = strlen(szHeaders);
  v1 = (char *)operator new(0x8000u);
  memset(v1, 0, 0x8000u);
  hInternet = InternetOpenA(szAgent, 0, 0, 0, 0);
  if ( hInternet )
  {
    memset(szServerName, 0, sizeof(szServerName));
    strcpy(szServerName, aWwwCrimsonland);
    v2 = InternetConnectA(hInternet, szServerName, 0x50u, szUserName, szPassword, 3u, 0x44000000u, 0x1289u);
    memset(szServerName, 0, sizeof(szServerName));
    v20 = v2;
    qmemcpy(szServerName, "/ra_version.php", 15);
    if ( v2 )
    {
      v3 = HttpOpenRequestA(v2, szVerb, szServerName, szVersion, szReferrer, lpszAcceptTypes, 0x4000000u, 0x1289u);
      v0 = v3;
      if ( v3 )
      {
        v4 = HttpSendRequestA(v3, szHeaders, dwHeadersLength, v1, 0);
        console_printf((int)&console_log_queue, aConnectingServ_0);
        if ( v4 )
        {
          console_printf((int)&console_log_queue, aReceivingData);
          memset(v1, 0, 0x8000u);
          v5 = InternetReadFile(v0, v1, 0x400u, &dwNumberOfBytesRead);
          v6 = dwNumberOfBytesRead;
          v7 = dwNumberOfBytesRead;
          if ( v5 )
          {
            while ( (int)(v7 + 1024) <= 0x8000 )
            {
              if ( !v6 )
                goto LABEL_13;
              v8 = InternetReadFile(v0, &v1[v7], 0x400u, &dwNumberOfBytesRead);
              v6 = dwNumberOfBytesRead;
              v7 += dwNumberOfBytesRead;
              if ( !v8 )
                goto LABEL_11;
            }
            console_printf((int)&console_log_queue, aWarningReceivi);
LABEL_13:
            console_printf((int)&console_log_queue, aVersionCheckBe);
            console_flush_log(&console_log_queue, (int)console_log_filename);
            if ( strstr(v1, SubStr) == v1 )
            {
              console_printf((int)&console_log_queue, aDataSeemsOk);
              v10 = 0;
              v11 = 0;
              v12 = strchr(v1, 34);
              if ( v12 )
              {
                v10 = v12 + 1;
                v13 = strchr(v12 + 1, 34);
                if ( v13 )
                {
                  *v13 = 0;
                  v14 = strchr(v13 + 1, 67);
                  if ( v14 )
                  {
                    v11 = v14;
                    v15 = strchr(v14, 60);
                    if ( v15 )
                    {
                      *v15 = 0;
                      v16 = 1;
                      lpMultiByteStr = strdup_malloc(v10);
                      FUN_00462ba0(v11, "Crimsonland %d.%d.%d<", ArgList, &v22, &v23);
                      if ( *(int *)ArgList > 1 || v22 > 9 || v23 > 94 )
                        console_printf(
                          (int)&console_log_queue,
                          "There is a newer version available. (v%d.%d.%d)\n",
                          *(_DWORD *)ArgList,
                          v22,
                          v23);
                      else
                        lpMultiByteStr = 0;
                    }
                  }
                }
              }
              console_flush_log(&console_log_queue, (int)console_log_filename);
              console_printf((int)&console_log_queue, "Link: '%s'\n", v10);
              console_printf((int)&console_log_queue, "Newest Version: '%s'\n", v11);
              console_printf((int)&console_log_queue, "Local Version: '%s'\n", aCrimsonland199);
            }
            else
            {
              console_printf((int)&console_log_queue, aDataNotOk, v1);
              console_printf((int)&console_log_queue, "Received: '%s'\n", v1);
            }
            console_flush_log(&console_log_queue, (int)console_log_filename);
          }
          else
          {
LABEL_11:
            console_printf((int)&console_log_queue, aVersionCheckIn_0);
            LastError = GetLastError();
            console_printf((int)&console_log_queue, "Reason: %d\n", LastError);
            dwHeadersLength = 0x8000;
            InternetGetLastResponseInfoA(&dwError, v1, &dwHeadersLength);
            console_printf((int)&console_log_queue, "Or: %s\n", v1);
          }
        }
        else
        {
          console_printf((int)&console_log_queue, aVersionCheckHt);
        }
      }
      else
      {
        console_printf((int)&console_log_queue, aVersionCheckHt_0);
      }
    }
    else
    {
      console_printf((int)&console_log_queue, aVersionCheckIn_1);
    }
  }
  else
  {
    console_printf((int)&console_log_queue, aVersionCheckIn);
  }
  console_printf((int)&console_log_queue, aVersionCheckCl);
  crt_free(v1);
  if ( v0 )
    InternetCloseHandle(v0);
  if ( v20 )
    InternetCloseHandle(v20);
  if ( hInternet )
    InternetCloseHandle(hInternet);
  Sleep(0x12Cu);
  if ( v16 )
  {
    dword_4D11F0 = 5;
    Sleep(0x12Cu);
    dword_4D11F0 = 0;
    byte_4D11F8 = 1;
  }
  else
  {
    dword_4D11F0 = 6;
    byte_4D11F8 = 0;
  }
  console_printf((int)&console_log_queue, aEndthreadVersi);
  console_flush_log(&console_log_queue, (int)console_log_filename);
  crt_endthread();
}

// sub_42DE10 @ 0x0042DE10
int sub_42DE10()
{
  char *v0; // esi
  int v1; // edi
  int result; // eax

  v0 = (char *)&effect_pool_quad_data;
  v1 = 512;
  do
  {
    result = FUN_004010f0((int)v0, 28, 4, (int (__thiscall *)(int))Iostream_init::Iostream_init);
    v0 += 188;
    --v1;
  }
  while ( v1 );
  return result;
}

// nullsub_117 @ 0x0042DE50
void nullsub_117()
{
  ;
}

// nullsub_118 @ 0x0042DE70
void nullsub_118()
{
  ;
}

// effect_init_entry @ 0x0042DE80
// initializes an effect entry to default values
_DWORD *__cdecl sub_42DE80(_DWORD *a1)
{
  _DWORD *result; // eax
  int v2; // ecx

  a1[11] = 0;
  a1[9] = 0;
  a1[5] = 0;
  a1[12] = 1065353216;
  a1[13] = 1065353216;
  a1[6] = 1065353216;
  a1[14] = 1065353216;
  a1[15] = 1065353216;
  result = a1 + 20;
  v2 = 4;
  do
  {
    result[2] = -1;
    *result = 1056964608;
    result[1] = 1065353216;
    result += 7;
    --v2;
  }
  while ( v2 );
  return result;
}

// effect_defaults_reset @ 0x0042DF10
// resets global effect template values
_DWORD *sub_42DF10()
{
  _DWORD *v0; // esi
  _DWORD *result; // eax

  effect_template_color_r = 1065353216;
  effect_template_color_g = 1065353216;
  effect_template_color_b = 1065353216;
  effect_template_color_a = 1065353216;
  dword_4AB1B0 = 0;
  effect_template_flags = 1;
  effect_template_rotation = 0;
  effect_template_scale = 1065353216;
  effect_template_age = 0;
  effect_template_lifetime = 1056964608;
  effect_template_half_height = 1107296256;
  effect_template_half_width = 1107296256;
  dword_4AB1B4 = 0;
  effect_template_rotation_step = 1.0;
  effect_template_scale_step = 1065353216;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  dword_4AB268 = 0;
  dword_4AB3E8 = (int)&unk_4AB3EC;
  effect_init_entry(effect_pool_pos_x);
  v0 = &unk_4AB4A4;
  do
  {
    *v0 = v0 + 1;
    effect_init_entry(v0 - 46);
    v0 += 47;
  }
  while ( (int)v0 < (int)&dword_4C2B2C );
  dword_4C2A70 = (int)&unk_4C2A74;
  result = effect_init_entry(dword_4C29B8);
  effect_free_list_head = (int)effect_pool_pos_x;
  dword_4C2B34 = 0;
  return result;
}

// effect_free @ 0x0042E080
// returns an effect entry to the free list
int __cdecl sub_42E080(int a1)
{
  *(_DWORD *)(a1 + 184) = effect_free_list_head;
  *(_DWORD *)(a1 + 44) = 0;
  effect_free_list_head = a1;
  return a1;
}

// effect_select_texture @ 0x0042E0A0
// selects effect texture page based on effect id
int __cdecl sub_42E0A0(int a1)
{
  int v1; // ecx
  int result; // eax

  v1 = effect_id_size_code[2 * a1];
  result = effect_id_frame[2 * a1];
  switch ( v1 )
  {
    case 16:
      return (*(int (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(
               grim_interface_ptr,
               16,
               effect_id_frame[2 * a1]);
    case 32:
      return (*(int (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(
               grim_interface_ptr,
               8,
               effect_id_frame[2 * a1]);
    case 64:
      return (*(int (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(
               grim_interface_ptr,
               4,
               effect_id_frame[2 * a1]);
    case 128:
      return (*(int (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 260))(
               grim_interface_ptr,
               2,
               effect_id_frame[2 * a1]);
  }
  return result;
}

// effect_spawn @ 0x0042E120
// allocates an effect entry and assigns quad UVs
_DWORD *__cdecl sub_42E120(int a1, _DWORD *a2)
{
  _DWORD *result; // eax
  int v4; // ebp
  int v5; // edx
  double v6; // st7
  double v7; // st7
  int v8; // ecx
  double v9; // st7
  double v10; // st7
  int v11; // ecx
  double v12; // st7
  double v13; // st7
  int v14; // ecx
  double v15; // st7
  double v16; // st7
  int v17; // ecx
  float v18; // [esp+0h] [ebp-10h]
  float v19; // [esp+0h] [ebp-10h]
  float v20; // [esp+0h] [ebp-10h]
  float v21; // [esp+0h] [ebp-10h]
  float v22; // [esp+0h] [ebp-10h]
  float v23; // [esp+0h] [ebp-10h]
  float v24; // [esp+0h] [ebp-10h]
  float v25; // [esp+0h] [ebp-10h]
  float v26; // [esp+0h] [ebp-10h]
  float v27; // [esp+0h] [ebp-10h]
  float v28; // [esp+0h] [ebp-10h]
  float v29; // [esp+0h] [ebp-10h]
  float v30; // [esp+0h] [ebp-10h]
  float v31; // [esp+0h] [ebp-10h]
  float v32; // [esp+0h] [ebp-10h]
  float v33; // [esp+0h] [ebp-10h]
  float v34; // [esp+4h] [ebp-Ch]
  float v35; // [esp+4h] [ebp-Ch]
  float v36; // [esp+4h] [ebp-Ch]
  float v37; // [esp+4h] [ebp-Ch]
  float v38; // [esp+4h] [ebp-Ch]
  float v39; // [esp+4h] [ebp-Ch]
  float v40; // [esp+4h] [ebp-Ch]
  float v41; // [esp+4h] [ebp-Ch]
  float v42; // [esp+4h] [ebp-Ch]
  float v43; // [esp+4h] [ebp-Ch]
  float v44; // [esp+4h] [ebp-Ch]
  float v45; // [esp+4h] [ebp-Ch]
  float v46; // [esp+4h] [ebp-Ch]
  float v47; // [esp+4h] [ebp-Ch]
  float v48; // [esp+4h] [ebp-Ch]
  float v49; // [esp+4h] [ebp-Ch]
  float v50; // [esp+4h] [ebp-Ch]
  float v51; // [esp+4h] [ebp-Ch]
  float v52; // [esp+4h] [ebp-Ch]
  float v53; // [esp+4h] [ebp-Ch]
  float v54; // [esp+4h] [ebp-Ch]
  float v55; // [esp+4h] [ebp-Ch]
  float v56; // [esp+4h] [ebp-Ch]
  float v57; // [esp+4h] [ebp-Ch]

  if ( config_detail_preset <= 2 && (dword_4C2B38++ & 1) != 0 )
    return &unk_4AB270;
  result = (_DWORD *)effect_free_list_head;
  v4 = effect_id_size_code[2 * a1];
  v5 = effect_id_frame[2 * a1];
  if ( *(_DWORD *)(effect_free_list_head + 184) )
    effect_free_list_head = *(_DWORD *)(effect_free_list_head + 184);
  else
    result = &unk_4AB270;
  qmemcpy(result + 3, &effect_template_vel_x, 0x3Cu);
  *result = *a2;
  result[1] = a2[1];
  *((_BYTE *)result + 8) = a1;
  switch ( v4 )
  {
    case 16:
      result[23] = effect_uv16_u[2 * v5];
      result[24] = LODWORD(effect_uv16_v[2 * v5]);
      v18 = -*(float *)&effect_template_half_width;
      v34 = -*(float *)&effect_template_half_height;
      *((float *)result + 18) = v18;
      *((float *)result + 19) = v34;
      v19 = effect_uv_step_16 + *(float *)&effect_uv16_u[2 * v5];
      v35 = effect_uv16_v[2 * v5];
      *((float *)result + 30) = v19;
      *((float *)result + 31) = v35;
      v36 = -*(float *)&effect_template_half_height;
      result[25] = effect_template_half_width;
      *((float *)result + 26) = v36;
      v20 = effect_uv_step_16 + *(float *)&effect_uv16_u[2 * v5];
      v6 = effect_uv_step_16 + effect_uv16_v[2 * v5];
      *((float *)result + 37) = v20;
      v37 = v6;
      *((float *)result + 38) = v37;
      v38 = *(float *)&effect_template_half_height;
      result[32] = effect_template_half_width;
      *((float *)result + 33) = v38;
      v7 = effect_uv_step_16 + effect_uv16_v[2 * v5];
      *((float *)result + 44) = *(float *)&effect_uv16_u[2 * v5];
      v39 = v7;
      *((float *)result + 45) = v39;
      v21 = -*(float *)&effect_template_half_width;
      v8 = effect_template_half_height;
      *((float *)result + 39) = v21;
      result[40] = v8;
      break;
    case 32:
      result[23] = effect_uv8_u[2 * v5];
      result[24] = LODWORD(effect_uv8_v[2 * v5]);
      v22 = -*(float *)&effect_template_half_width;
      v40 = -*(float *)&effect_template_half_height;
      *((float *)result + 18) = v22;
      *((float *)result + 19) = v40;
      v23 = effect_uv_step_8 + *(float *)&effect_uv8_u[2 * v5];
      v41 = effect_uv8_v[2 * v5];
      *((float *)result + 30) = v23;
      *((float *)result + 31) = v41;
      v42 = -*(float *)&effect_template_half_height;
      result[25] = effect_template_half_width;
      *((float *)result + 26) = v42;
      v24 = effect_uv_step_8 + *(float *)&effect_uv8_u[2 * v5];
      v9 = effect_uv_step_8 + effect_uv8_v[2 * v5];
      *((float *)result + 37) = v24;
      v43 = v9;
      *((float *)result + 38) = v43;
      v44 = *(float *)&effect_template_half_height;
      result[32] = effect_template_half_width;
      *((float *)result + 33) = v44;
      v10 = effect_uv_step_8 + effect_uv8_v[2 * v5];
      *((float *)result + 44) = *(float *)&effect_uv8_u[2 * v5];
      v45 = v10;
      *((float *)result + 45) = v45;
      v25 = -*(float *)&effect_template_half_width;
      v11 = effect_template_half_height;
      *((float *)result + 39) = v25;
      result[40] = v11;
      break;
    case 64:
      result[23] = effect_uv4_u[2 * v5];
      result[24] = LODWORD(effect_uv4_v[2 * v5]);
      v26 = -*(float *)&effect_template_half_width;
      v46 = -*(float *)&effect_template_half_height;
      *((float *)result + 18) = v26;
      *((float *)result + 19) = v46;
      v27 = effect_uv_step_4 + *(float *)&effect_uv4_u[2 * v5];
      v47 = effect_uv4_v[2 * v5];
      *((float *)result + 30) = v27;
      *((float *)result + 31) = v47;
      v48 = -*(float *)&effect_template_half_height;
      result[25] = effect_template_half_width;
      *((float *)result + 26) = v48;
      v28 = effect_uv_step_4 + *(float *)&effect_uv4_u[2 * v5];
      v12 = effect_uv_step_4 + effect_uv4_v[2 * v5];
      *((float *)result + 37) = v28;
      v49 = v12;
      *((float *)result + 38) = v49;
      v50 = *(float *)&effect_template_half_height;
      result[32] = effect_template_half_width;
      *((float *)result + 33) = v50;
      v13 = effect_uv_step_4 + effect_uv4_v[2 * v5];
      *((float *)result + 44) = *(float *)&effect_uv4_u[2 * v5];
      v51 = v13;
      *((float *)result + 45) = v51;
      v29 = -*(float *)&effect_template_half_width;
      v14 = effect_template_half_height;
      *((float *)result + 39) = v29;
      result[40] = v14;
      break;
    case 128:
      result[23] = effect_uv2_u[2 * v5];
      result[24] = effect_uv2_v[2 * v5];
      v30 = -*(float *)&effect_template_half_width;
      v52 = -*(float *)&effect_template_half_height;
      *((float *)result + 18) = v30;
      *((float *)result + 19) = v52;
      v31 = effect_uv_step_2 + *(float *)&effect_uv2_u[2 * v5];
      v53 = *(float *)&effect_uv2_v[2 * v5];
      *((float *)result + 30) = v31;
      *((float *)result + 31) = v53;
      v54 = -*(float *)&effect_template_half_height;
      result[25] = effect_template_half_width;
      *((float *)result + 26) = v54;
      v32 = effect_uv_step_2 + *(float *)&effect_uv2_u[2 * v5];
      v15 = effect_uv_step_2 + *(float *)&effect_uv2_v[2 * v5];
      *((float *)result + 37) = v32;
      v55 = v15;
      *((float *)result + 38) = v55;
      v56 = *(float *)&effect_template_half_height;
      result[32] = effect_template_half_width;
      *((float *)result + 33) = v56;
      v16 = effect_uv_step_2 + *(float *)&effect_uv2_v[2 * v5];
      *((float *)result + 44) = *(float *)&effect_uv2_u[2 * v5];
      v57 = v16;
      *((float *)result + 45) = v57;
      v33 = -*(float *)&effect_template_half_width;
      v17 = effect_template_half_height;
      *((float *)result + 39) = v33;
      result[40] = v17;
      break;
  }
  return result;
}

// effects_update @ 0x0042E710
// ticks active effects and frees expired entries
void sub_42E710()
{
  int *v0; // esi
  int v1; // ecx
  double v2; // st7
  int v3; // [esp+0h] [ebp-20h]
  int v4; // [esp+4h] [ebp-1Ch]
  float v5; // [esp+14h] [ebp-Ch]
  float v6; // [esp+18h] [ebp-8h]

  v0 = (int *)&effect_pool_age;
  do
  {
    v1 = v0[2];
    if ( v1 )
    {
      v5 = frame_dt + *(float *)v0;
      *(float *)v0 = v5;
      if ( v5 < (double)*((float *)v0 + 1) )
      {
        if ( v5 >= 0.0 )
        {
          v6 = frame_dt * *((float *)v0 - 6);
          v2 = frame_dt * *((float *)v0 - 5);
          *((float *)v0 - 9) = v6 + *((float *)v0 - 9);
          *((float *)v0 - 8) = v2 + *((float *)v0 - 8);
          if ( (v1 & 4) != 0 )
            *((float *)v0 - 4) = frame_dt * *((float *)v0 + 7) + *((float *)v0 - 4);
          if ( (v1 & 8) != 0 )
            *((float *)v0 - 3) = frame_dt * *((float *)v0 + 8) + *((float *)v0 - 3);
          if ( (v1 & 0x10) != 0 )
            *((float *)v0 + 6) = 1.0 - v5 / *((float *)v0 + 1);
        }
      }
      else
      {
        if ( (v1 & 0x80u) != 0 )
        {
          if ( (v1 & 0x100) != 0 )
            v0[6] = 1051931443;
          else
            v0[6] = 1061997773;
          *(float *)&v4 = *((float *)v0 - 1) + *((float *)v0 - 1);
          *(float *)&v3 = *((float *)v0 - 2) + *((float *)v0 - 2);
          fx_queue_add(*((unsigned __int8 *)v0 - 28), v0 - 9, v3, v4, *(v0 - 4), v0 + 3);
        }
        effect_free((int)(v0 - 9));
      }
    }
    v0 += 47;
  }
  while ( (int)v0 < (int)&perk_id_long_distance_runner );
}

// effects_render @ 0x0042E820
// renders active effects (rotated quads)
int sub_42E820()
{
  float *v0; // esi
  int v1; // ecx
  long double v2; // st7
  long double v3; // st6
  double v4; // st7
  float *v5; // esi
  int v6; // ecx
  long double v7; // st7
  long double v8; // st6
  double v9; // st7
  int v11; // [esp+48h] [ebp-34h]
  int v12; // [esp+48h] [ebp-34h]
  int v13; // [esp+48h] [ebp-34h]
  int v14; // [esp+4Ch] [ebp-30h]
  int v15; // [esp+4Ch] [ebp-30h]
  int v16; // [esp+4Ch] [ebp-30h]
  int v17; // [esp+50h] [ebp-2Ch]
  int v18; // [esp+50h] [ebp-2Ch]
  int v19; // [esp+50h] [ebp-2Ch]
  int v20; // [esp+58h] [ebp-24h]
  int v21; // [esp+58h] [ebp-24h]
  int v22; // [esp+5Ch] [ebp-20h] BYREF
  float v23; // [esp+60h] [ebp-1Ch]
  float v24; // [esp+64h] [ebp-18h] BYREF
  float v25; // [esp+68h] [ebp-14h]
  float v26; // [esp+6Ch] [ebp-10h] BYREF
  float v27; // [esp+70h] [ebp-Ch]
  float v28; // [esp+74h] [ebp-8h]
  float v29; // [esp+78h] [ebp-4h]

  (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 19, 5);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    6,
    v11,
    v14,
    v17);
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
    grim_interface_ptr,
    particles_texture,
    0);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v0 = (float *)&effect_pool_color_g;
  do
  {
    v1 = *((_DWORD *)v0 - 2);
    if ( v1 && *(v0 - 4) >= 0.0 && (v1 & 0x40) != 0 )
    {
      v23 = *(v0 - 8);
      v2 = cos(v23);
      v26 = v2;
      v3 = sin(v23);
      v27 = -v3;
      v28 = v3;
      v26 = v26 * *(v0 - 7);
      v27 = v27 * *(v0 - 7);
      v28 = v28 * *(v0 - 7);
      v29 = v2 * *(v0 - 7);
      HIBYTE(v20) = (__int64)(v0[2] * 255.0);
      BYTE2(v20) = (__int64)(*(v0 - 1) * 255.0);
      BYTE1(v20) = (__int64)(*v0 * 255.0);
      v4 = *(float *)&camera_offset_x + *(v0 - 13);
      LOBYTE(v20) = (__int64)(v0[1] * 255.0);
      v22 = v20;
      v24 = v4;
      v25 = *(float *)&camera_offset_y + *(v0 - 12);
      (*(void (__thiscall **)(int, float *, int, float *, float *, int *))(*(_DWORD *)grim_interface_ptr + 308))(
        grim_interface_ptr,
        v0 + 5,
        4,
        &v24,
        &v26,
        &v22);
    }
    v0 += 47;
  }
  while ( (int)v0 < (int)&perk_id_pyrokinetic );
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    2,
    v12,
    v15,
    v18);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v5 = (float *)&effect_pool_color_g;
  do
  {
    v6 = *((_DWORD *)v5 - 2);
    if ( v6 && *(v5 - 4) >= 0.0 && (v6 & 0x40) == 0 )
    {
      v23 = *(v5 - 8);
      v7 = cos(v23);
      v26 = v7;
      v8 = sin(v23);
      v27 = -v8;
      v28 = v8;
      v26 = v26 * *(v5 - 7);
      v27 = v27 * *(v5 - 7);
      v28 = v28 * *(v5 - 7);
      v29 = v7 * *(v5 - 7);
      HIBYTE(v21) = (__int64)(v5[2] * 255.0);
      BYTE2(v21) = (__int64)(*(v5 - 1) * 255.0);
      BYTE1(v21) = (__int64)(*v5 * 255.0);
      v9 = *(float *)&camera_offset_x + *(v5 - 13);
      LOBYTE(v21) = (__int64)(v5[1] * 255.0);
      v22 = v21;
      v24 = v9;
      v25 = *(float *)&camera_offset_y + *(v5 - 12);
      (*(void (__thiscall **)(int, float *, int, float *, float *, int *))(*(_DWORD *)grim_interface_ptr + 308))(
        grim_interface_ptr,
        v5 + 5,
        4,
        &v24,
        &v26,
        &v22);
    }
    v5 += 47;
  }
  while ( (int)v5 < (int)&perk_id_pyrokinetic );
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  return (*(int (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
           grim_interface_ptr,
           20,
           6,
           v13,
           v16,
           v19);
}

// effect_spawn_blood_splatter @ 0x0042EB10
// spawns blood splatter particles (effect id 7)
unsigned __int8 __cdecl sub_42EB10(_DWORD *a1, float a2, int a3)
{
  unsigned __int8 result; // al
  long double v4; // st7
  int v5; // edi
  char v6; // al
  float v7; // [esp+0h] [ebp-18h]
  float v8; // [esp+4h] [ebp-14h]
  float v9; // [esp+20h] [ebp+8h]

  result = config_fx_toggle;
  if ( !config_fx_toggle )
  {
    *(float *)&effect_template_lifetime = 0.25 - *(float *)&a3;
    v4 = a2 + 3.1415927;
    effect_template_color_r = 1065353216;
    effect_template_color_g = 1065353216;
    effect_template_flags = 201;
    effect_template_color_b = 1065353216;
    effect_template_color_a = 1056964608;
    effect_template_scale_step = 0;
    effect_template_age = a3;
    v5 = 2;
    v7 = cos(v4);
    v8 = sin(v4);
    do
    {
      v9 = v4;
      *(float *)&effect_template_rotation = (double)((crt_rand() & 0x3F) - 32) * 0.1 + v9;
      *(float *)&effect_template_half_width = (float)((crt_rand() & 7) + 1);
      effect_template_half_height = effect_template_half_width;
      *(float *)&effect_template_vel_x = (double)((crt_rand() & 0x3F) + 100) * v7;
      v6 = crt_rand();
      effect_template_rotation_step = 0.0;
      *(float *)&effect_template_vel_y = (double)((v6 & 0x3F) + 100) * v8;
      *(float *)&effect_template_scale_step = (double)(crt_rand() & 0x7F) * 0.029999999 + 0.1;
      result = (unsigned __int8)effect_spawn(7, a1);
      --v5;
    }
    while ( v5 );
  }
  return result;
}

// effect_spawn_freeze_shard @ 0x0042EC80
// spawns a random freeze shard effect (ids 8..10) around the given angle
_DWORD *__cdecl sub_42EC80(_DWORD *a1, float a2)
{
  char v2; // al
  int v3; // eax
  float v5; // [esp+1Ch] [ebp+8h]

  effect_template_color_r = 1065353216;
  effect_template_flags = 461;
  effect_template_color_g = 1065353216;
  effect_template_color_b = 1065353216;
  effect_template_color_a = 1056964608;
  v2 = crt_rand();
  effect_template_age = 0;
  effect_template_half_width = 1090519040;
  effect_template_half_height = 1090519040;
  *(float *)&effect_template_lifetime = (double)(v2 & 0xF) * 0.0099999998 + 0.2;
  v5 = a2 + 3.1415927;
  *(float *)&effect_template_rotation = (double)(crt_rand() % 100) * 0.0099999998 + v5;
  *(float *)&effect_template_half_width = (float)(crt_rand() % 5 + 7);
  effect_template_half_height = effect_template_half_width;
  *(float *)&effect_template_vel_x = cos(v5) * 114.0;
  *(float *)&effect_template_vel_y = sin(v5) * 114.0;
  effect_template_rotation_step = ((double)(crt_rand() % 20) * 0.1 - 1.0) * 4.0;
  *(float *)&effect_template_scale_step = (double)-(crt_rand() & 0xF) * 0.1;
  v3 = crt_rand();
  return effect_spawn(v3 % 3 + 8, a1);
}

// effect_spawn_freeze_shatter @ 0x0042EE00
// four-way shatter burst (id 0xe) plus extra freeze shards
_DWORD *__cdecl sub_42EE00(_DWORD *a1, float a2)
{
  int v2; // esi
  long double v3; // st7
  int v4; // esi
  _DWORD *result; // eax
  float v6; // [esp+0h] [ebp-20h]
  int v7; // [esp+Ch] [ebp-14h]

  effect_template_color_r = 1065353216;
  v2 = 0;
  effect_template_flags = 93;
  effect_template_color_g = 1065353216;
  effect_template_color_b = 1065353216;
  effect_template_color_a = 1056964608;
  effect_template_age = 0;
  effect_template_lifetime = 1066192077;
  effect_template_scale_step = 0;
  v7 = 0;
  do
  {
    v3 = (double)v7 * 1.5707964 + a2;
    *(float *)&effect_template_rotation = v3;
    *(float *)&effect_template_vel_x = cos(v3) * 42.0;
    *(float *)&effect_template_vel_y = sin(*(float *)&effect_template_rotation) * 42.0;
    *(float *)&effect_template_half_width = (float)(crt_rand() % 10 + 18);
    effect_template_half_height = effect_template_half_width;
    effect_template_rotation_step = ((double)(crt_rand() % 20) * 0.1 - 1.0) * 1.9;
    effect_spawn(14, a1);
    v7 = ++v2;
  }
  while ( v2 < 4 );
  v4 = 4;
  do
  {
    v6 = (double)(crt_rand() % 612) * 0.0099999998;
    result = effect_spawn_freeze_shard(a1, v6);
    --v4;
  }
  while ( v4 );
  return result;
}

// effect_spawn_burst @ 0x0042EF60
// generic burst loop for effect id 0
int __cdecl sub_42EF60(_DWORD *a1, int a2)
{
  int v2; // esi
  int result; // eax

  v2 = a2;
  effect_template_color_r = 1053609165;
  result = 1056964608;
  effect_template_flags = 29;
  effect_template_color_g = 1056964608;
  effect_template_color_b = 1065353216;
  effect_template_color_a = 1056964608;
  effect_template_age = 0;
  effect_template_lifetime = 1056964608;
  effect_template_half_width = 1107296256;
  effect_template_half_height = 1107296256;
  if ( a2 > 0 )
  {
    do
    {
      *(float *)&effect_template_rotation = (double)(crt_rand() & 0x7F) * 0.049087387;
      *(float *)&effect_template_vel_x = (float)((crt_rand() & 0x7F) - 64);
      *(float *)&effect_template_vel_y = (float)((crt_rand() & 0x7F) - 64);
      *(float *)&effect_template_scale_step = (double)(crt_rand() % 100) * 0.0099999998 + 0.1;
      result = (int)effect_spawn(0, a1);
      --v2;
    }
    while ( v2 );
  }
  return result;
}

// FUN_0042f080 @ 0x0042F080
// [binja] void* sub_42f080(float* arg1)
_DWORD *__cdecl sub_42F080(_DWORD *a1)
{
  int v1; // esi
  _DWORD *result; // eax

  effect_template_color_r = 1050253722;
  effect_template_flags = 25;
  effect_template_color_g = 1058642330;
  effect_template_color_b = 1063675494;
  effect_template_color_a = 1065353216;
  effect_template_age = 0;
  effect_template_lifetime = 1050253722;
  effect_template_half_width = 1108344832;
  effect_template_half_height = 1108344832;
  effect_template_rotation = 0;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  effect_template_scale_step = -1065353216;
  effect_spawn(1, a1);
  effect_template_color_b = 1065353216;
  effect_template_color_r = 1053609165;
  effect_template_flags = 29;
  effect_template_color_g = 1056964608;
  effect_template_color_a = 1056964608;
  effect_template_age = 0;
  effect_template_lifetime = 1050253722;
  effect_template_half_width = 1107296256;
  effect_template_half_height = 1107296256;
  v1 = 4;
  if ( config_detail_preset < 3 )
    v1 = 2;
  do
  {
    *(float *)&effect_template_rotation = (double)(crt_rand() & 0x7F) * 0.049087387;
    *(float *)&effect_template_vel_x = (double)((crt_rand() & 0x7F) - 64) * 1.4;
    *(float *)&effect_template_vel_y = (double)((crt_rand() & 0x7F) - 64) * 1.4;
    *(float *)&effect_template_scale_step = (double)(crt_rand() % 100) * 0.0099999998 + 0.1;
    result = effect_spawn(0, a1);
    --v1;
  }
  while ( v1 );
  return result;
}

// FUN_0042f270 @ 0x0042F270
// [binja] void* sub_42f270(float* arg1, float arg2, float arg3)
_DWORD *__cdecl sub_42F270(_DWORD *a1, float a2, float a3)
{
  effect_template_color_g = 1058642330;
  *(float *)&effect_template_lifetime = a3 * 0.80000001;
  effect_template_color_r = 1058642330;
  *(float *)&effect_template_scale_step = a2 * 45.0;
  effect_template_flags = 25;
  effect_template_color_b = 1063675494;
  effect_template_color_a = 1065353216;
  effect_template_age = 0;
  effect_template_half_width = 1082130432;
  effect_template_half_height = 1082130432;
  effect_template_rotation = 0;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  return effect_spawn(1, a1);
}

// FUN_0042f330 @ 0x0042F330
// [binja] void* sub_42f330(float* arg1, float arg2, int32_t arg3)
_DWORD *__cdecl sub_42F330(_DWORD *a1, float a2, int a3)
{
  *(float *)&effect_template_scale_step = a2 * 45.0;
  effect_template_color_b = 1050253722;
  effect_template_color_r = 1063675494;
  effect_template_color_g = 1058642330;
  effect_template_flags = 25;
  effect_template_color_a = 1065353216;
  effect_template_age = 1036831949;
  effect_template_lifetime = a3;
  effect_template_half_width = 1082130432;
  effect_template_half_height = 1082130432;
  effect_template_rotation = 0;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  return effect_spawn(1, a1);
}

// FUN_0042f3f0 @ 0x0042F3F0
// [binja] void* sub_42f3f0(float* arg1, float arg2, float arg3)
int __cdecl sub_42F3F0(float *a1, float a2, int a3)
{
  int v3; // edi
  int result; // eax
  double v5; // st7
  float v6; // [esp+4h] [ebp-10h] BYREF
  float v7; // [esp+8h] [ebp-Ch]
  int v8; // [esp+Ch] [ebp-8h]
  int v9; // [esp+10h] [ebp-4h]
  float v10; // [esp+20h] [ebp+Ch]

  v6 = 1.0;
  v3 = a3;
  v7 = 0.89999998;
  v8 = 1036831949;
  v9 = 1065353216;
  effect_template_color_r = 1065353216;
  result = 1065353216;
  effect_template_flags = 25;
  effect_template_color_g = 1063675494;
  effect_template_color_b = 1036831949;
  effect_template_color_a = 1065353216;
  effect_template_half_width = 1082130432;
  effect_template_half_height = 1082130432;
  effect_template_rotation = 0;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  effect_template_scale_step = 1113325568;
  if ( a3 > 0 )
  {
    do
    {
      v10 = (double)(crt_rand() & 0x1FF) * 0.001953125 * 6.2831855;
      v5 = (double)(crt_rand() % (__int64)a2);
      v6 = cos(v10) * v5 + *a1;
      v7 = sin(v10) * v5 + a1[1];
      *(float *)&effect_template_age = (double)-(unsigned __int8)crt_rand() * 0.0012000001;
      *(float *)&effect_template_lifetime = 0.1 - *(float *)&effect_template_age;
      result = (int)effect_spawn(0, &v6);
      --v3;
    }
    while ( v3 );
  }
  return result;
}

// FUN_0042f540 @ 0x0042F540
// [binja] int32_t sub_42f540(int32_t arg1, float arg2)
int __cdecl sub_42F540(_DWORD *a1, float a2)
{
  double v2; // st7
  __int64 v3; // rax
  int v4; // esi
  float v6; // [esp+18h] [ebp+8h]

  effect_template_color_r = 1053609165;
  v6 = a2 * 0.80000001;
  v2 = v6 * 0.69999999;
  effect_template_color_a = 1056964608;
  effect_template_flags = 29;
  effect_template_color_g = 1056964608;
  *(float *)&effect_template_lifetime = v2;
  effect_template_color_b = 1065353216;
  effect_template_age = 0;
  if ( v2 > 1.1 )
    effect_template_lifetime = 1066192077;
  *(float *)&effect_template_half_width = v6 * 32.0;
  effect_template_half_height = effect_template_half_width;
  v3 = (__int64)(v6 * 5.0);
  if ( config_detail_preset < 3 )
    LODWORD(v3) = (int)v3 / 2;
  if ( (int)v3 > 0 )
  {
    v4 = v3;
    do
    {
      *(float *)&effect_template_rotation = (double)(crt_rand() & 0x7F) * 0.049087387;
      *(float *)&effect_template_vel_x = (double)((crt_rand() & 0x7F) - 64) * v6 * 1.4;
      *(float *)&effect_template_vel_y = (double)((crt_rand() & 0x7F) - 64) * v6 * 1.4;
      *(float *)&effect_template_scale_step = ((double)(crt_rand() % 100) * 0.0099999998 + 0.1) * v6;
      LODWORD(v3) = effect_spawn(0, a1);
      --v4;
    }
    while ( v4 );
  }
  return v3;
}

// effect_spawn_explosion_burst @ 0x0042F6C0
// spawns explosion burst and shockwave particles
_DWORD *__cdecl sub_42F6C0(_DWORD *a1, float a2)
{
  int v3; // edi
  double v4; // st7
  int v5; // eax
  _DWORD *result; // eax
  int v7; // edi
  int v8; // [esp+0h] [ebp-14h]
  int v9; // [esp+18h] [ebp+4h]

  *(float *)&effect_template_scale_step = a2 * 25.0;
  effect_template_color_r = 1058642330;
  effect_template_flags = 25;
  effect_template_color_g = 1058642330;
  effect_template_color_b = 1058642330;
  effect_template_color_a = 1065353216;
  effect_template_lifetime = 1051931443;
  effect_template_age = -1110651699;
  effect_template_half_width = 1107296256;
  effect_template_half_height = 1107296256;
  effect_template_rotation = 0;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  effect_spawn(1, a1);
  effect_template_color_b = 1036831949;
  effect_template_color_r = 1036831949;
  effect_template_flags = 93;
  effect_template_color_g = 1036831949;
  effect_template_color_a = 1065353216;
  effect_template_rotation = 0;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  if ( config_detail_preset > 3 )
  {
    v3 = 0;
    v9 = 0;
    do
    {
      effect_template_half_width = 1107296256;
      effect_template_half_height = 1107296256;
      v4 = (double)v9 * 0.2;
      *(float *)&effect_template_age = v4 - 0.5;
      *(float *)&effect_template_lifetime = v4 + 0.60000002;
      v5 = crt_rand();
      effect_template_rotation_step = 1.4;
      *(float *)&v8 = a2 * 5.0;
      effect_template_scale_step = v8;
      *(float *)&effect_template_rotation = (double)(v5 % 614) * 0.02;
      effect_spawn(17, a1);
      v9 = ++v3;
    }
    while ( v3 < 2 );
  }
  *(float *)&effect_template_scale_step = a2 * 45.0;
  effect_template_color_r = 1065353216;
  effect_template_flags = 25;
  effect_template_color_g = 1065353216;
  effect_template_color_b = 1065353216;
  effect_template_color_a = 1065353216;
  effect_template_age = 0;
  effect_template_lifetime = 1050253722;
  effect_template_half_width = 1107296256;
  effect_template_half_height = 1107296256;
  effect_template_rotation = 0;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  effect_spawn(0, a1);
  effect_template_color_b = 1065353216;
  result = (_DWORD *)config_detail_preset;
  effect_template_color_r = 1065353216;
  effect_template_flags = 29;
  effect_template_color_g = 1065353216;
  effect_template_color_a = 1065353216;
  effect_template_lifetime = 1060320051;
  effect_template_age = 0;
  effect_template_half_width = 1107296256;
  effect_template_half_height = 1107296256;
  if ( config_detail_preset >= 2 )
    v7 = (config_detail_preset >= 4) + 3;
  else
    v7 = 1;
  if ( v7 > 0 )
  {
    do
    {
      *(float *)&effect_template_rotation = (double)(crt_rand() % 314) * 0.02;
      *(float *)&effect_template_vel_x = (float)(2 * (crt_rand() & 0x3F) - 64);
      *(float *)&effect_template_vel_y = (float)(2 * (crt_rand() & 0x3F) - 64);
      *(float *)&effect_template_scale_step = (double)(((unsigned __int8)crt_rand() - 3) & 7) * a2;
      effect_template_rotation_step = (float)(((unsigned __int8)crt_rand() + 3) & 7);
      result = effect_spawn(12, a1);
      --v7;
    }
    while ( v7 );
  }
  return result;
}

// sub_42FA90 @ 0x0042FA90
// [binja] int32_t sub_42fae0()
int sub_42FA90()
{
  FUN_0042faa0();
  return crt_atexit(sub_42FAF0);
}

// FUN_0042faa0 @ 0x0042FAA0
// [binja] int32_t sub_42faa0()
void sub_42FAA0()
{
  crt_ehvec_ctor(perk_name_table, 0x14u, 128, sub_42FAC0, (void (__thiscall *)(void *))FUN_00412410);
}

// sub_42FAC0 @ 0x0042FAC0
void __thiscall sub_42FAC0(_DWORD *this)
{
  *(this + 2) = 3;
  *(this + 4) = -1;
  *this = 0;
  *(this + 1) = 0;
  *((_BYTE *)this + 12) = 0;
}

// sub_42FAF0 @ 0x0042FAF0
void __cdecl sub_42FAF0()
{
  crt_ehvec_dtor(perk_name_table, 0x14u, 128, (void (__thiscall *)(void *))FUN_00412410);
}

// perk_can_offer @ 0x0042FB10
// returns nonzero when perk is eligible for selection
char __cdecl sub_42FB10(int a1)
{
  int v1; // eax
  std::codecvt_base *v3; // ecx

  if ( (config_game_mode != 3
     || !config_hardcore
     || quest_stage_minor != 10
     || *(_DWORD *)quest_stage_major != 2
     || a1 != perk_id_poison_bullets && a1 != perk_id_veins_of_poison && a1 != perk_id_plaguebearer)
    && (config_player_count != 2 || (perk_flags_table[20 * a1] & 2) != 0)
    && (config_game_mode != 3 || (perk_flags_table[20 * a1] & 1) != 0) )
  {
    v1 = perk_prereq_table[5 * a1];
    if ( v1 == -1 )
      return 1;
    v3 = *(&player_perk_counts + v1);
    if ( (int)v3 > 0 )
      return 1;
    game_is_full_version(v3);
  }
  return 0;
}

// perk_select_random @ 0x0042FBD0
// randomly selects an eligible perk index
int sub_42FBD0()
{
  int v0; // edi
  int v1; // esi

  v0 = 1;
  while ( 1 )
  {
    v1 = crt_rand() % dword_4C2C38 + 1;
    if ( perk_available_table[20 * v1] )
    {
      if ( perk_can_offer(v1) )
        break;
    }
    if ( ++v0 > 1000 )
    {
      console_printf((int)&console_log_queue, aPerkRandomizer_0);
      return perk_id_instant_winner;
    }
  }
  return v1;
}

// perks_rebuild_available @ 0x0042FC30
// rebuilds perk availability/unlock flags
int sub_42FC30()
{
  int v0; // ecx
  char *v1; // eax
  int v2; // edi
  _BYTE *v3; // eax
  int v4; // esi
  int v5; // edx
  int v6; // eax
  int result; // eax
  int v8; // ecx
  int *v9; // edx
  int v10; // eax

  v0 = dword_4C2C38 + 1;
  if ( dword_4C2C38 + 1 > 0 )
  {
    v1 = perk_available_table;
    do
    {
      *v1 = 0;
      v1 += 20;
      --v0;
    }
    while ( v0 );
  }
  v2 = 5 * perk_id_antiperk;
  v3 = &unk_4C2C60;
  perk_available_table[20 * perk_id_antiperk] = 0;
  do
  {
    *v3 = 1;
    v3 += 20;
  }
  while ( (int)v3 < (int)byte_4C2E7C );
  v4 = quest_unlock_index;
  v5 = 5 * perk_id_living_fortress;
  v6 = perk_id_fire_caugh;
  perk_available_table[20 * perk_id_man_bomb] = 1;
  perk_available_table[4 * v5] = 1;
  perk_available_table[20 * v6] = 1;
  result = perk_id_tough_reloader;
  perk_available_table[20 * perk_id_tough_reloader] = 1;
  v8 = 0;
  if ( v4 > 0 )
  {
    v9 = quest_unlock_perk_id;
    do
    {
      if ( (int)v9 >= (int)&dword_484FE8 )
        break;
      v10 = *v9;
      ++v8;
      v9 += 11;
      result = 5 * v10;
      perk_available_table[4 * result] = 1;
    }
    while ( v8 < v4 );
  }
  perk_available_table[4 * v2] = 0;
  return result;
}

// perk_count_get @ 0x0042FCF0
// returns perk count from DAT_00490968
int __cdecl sub_42FCF0(int a1)
{
  return (int)*(&player_perk_counts + a1);
}

// sub_42FD00 @ 0x0042FD00
char *__cdecl sub_42FD00(const char *a1, int a2)
{
  unsigned int v2; // kr08_4
  char *v3; // ebx
  int v4; // edi
  signed int i; // esi
  char v6; // al
  _BYTE v8[2]; // [esp+12h] [ebp-2h] BYREF

  v2 = strlen(a1) + 1;
  v8[1] = 0;
  v3 = (char *)operator new(v2);
  strcpy(v3, a1);
  v4 = a2;
  for ( i = 0; i < (int)(v2 - 1); ++i )
  {
    v8[0] = v3[i];
    v4 -= (*(int (__thiscall **)(int, _BYTE *))(*(_DWORD *)grim_interface_ptr + 332))(grim_interface_ptr, v8);
    if ( v4 < 0 )
    {
      do
        v6 = v3[--i];
      while ( v6 != 32 );
      v4 = a2;
      v3[i] = 10;
    }
  }
  return v3;
}

// perks_init_database @ 0x0042FD90
// builds the perk table (ids, names, descriptions)
int sub_42FD90()
{
  char *v0; // eax
  int v1; // ecx
  int v2; // edx
  int v3; // eax

  perk_id_antiperk = 0;
  perk_name_table[0] = (int)sub_42FD00(aAntiperk, 256);
  perk_desc_table[0] = (int)sub_42FD00(aYouShouldnTBeS, 256);
  perk_id_bloody_mess_quick_learner = 1;
  dword_4C3640 = (int)sub_42FD00(aBloodyMess, 256);
  dword_4C3648 = (int)sub_42FD00(aMoreTheMerrier, 256);
  dword_4C3644 = (int)sub_42FD00(aQuickLearner, 256);
  v0 = sub_42FD00(aYouLearnThings, 256);
  dword_4C364C = (int)v0;
  if ( config_fx_toggle )
  {
    v1 = 5 * perk_id_bloody_mess_quick_learner;
    perk_name_table[v1] = dword_4C3644;
    perk_desc_table[v1] = (int)v0;
  }
  else
  {
    v2 = dword_4C3648;
    v3 = 5 * perk_id_bloody_mess_quick_learner;
    perk_name_table[v3] = dword_4C3640;
    perk_desc_table[v3] = v2;
  }
  perk_id_sharpshooter = 2;
  dword_4C2C68 = (int)sub_42FD00(aSharpshooter, 256);
  dword_4C2C6C = (int)sub_42FD00(aMiraculouslyYo, 256);
  perk_id_fastloader = 3;
  dword_4C2C7C = (int)sub_42FD00(aFastloader, 256);
  dword_4C2C80 = (int)sub_42FD00(aManYouSureKnow, 256);
  perk_id_lean_mean_exp_machine = 4;
  dword_4C2C90 = (int)sub_42FD00(aLeanMeanExpMac, 256);
  dword_4C2C94 = (int)sub_42FD00(aWhyKillForExpe, 256);
  perk_id_long_distance_runner = 5;
  dword_4C2CA4 = (int)sub_42FD00(aLongDistanceRu, 256);
  dword_4C2CA8 = (int)sub_42FD00(aYouMoveLikeATr, 256);
  perk_id_pyrokinetic = 6;
  dword_4C2CB8 = (int)sub_42FD00(aPyrokinetic, 256);
  dword_4C2CBC = (int)sub_42FD00(aYouSeeFlamesEv, 256);
  perk_id_instant_winner = 7;
  dword_4C2CCC = (int)sub_42FD00(aInstantWinner, 256);
  dword_4C2CD0 = (int)sub_42FD00(a2500Experience, 256);
  dword_4C2CD4 |= 4u;
  perk_id_grim_deal = 8;
  dword_4C2CE8 = 0;
  dword_4C2CE0 = (int)sub_42FD00(aGrimDeal, 256);
  dword_4C2CE4 = (int)sub_42FD00(aILlMakeYouADea, 256);
  perk_id_alternate_weapon = 9;
  dword_4C2CFC = 1;
  dword_4C2CF4 = (int)sub_42FD00(aAlternateWeapo, 256);
  dword_4C2CF8 = (int)sub_42FD00(aEverFanciedAbo, 256);
  perk_id_plaguebearer = 10;
  dword_4C2D08 = (int)sub_42FD00(aPlaguebearer, 256);
  dword_4C2D0C = (int)sub_42FD00(aYouCarryAHorri, 256);
  perk_id_evil_eyes = 11;
  dword_4C2D1C = (int)sub_42FD00(aEvilEyes, 256);
  dword_4C2D20 = (int)sub_42FD00(aNoLivingNorDea, 256);
  perk_id_ammo_maniac = 12;
  dword_4C2D30 = (int)sub_42FD00(aAmmoManiac, 256);
  dword_4C2D34 = (int)sub_42FD00(aYouSqueezeAndY, 256);
  perk_id_radioactive = 13;
  dword_4C2D44 = (int)sub_42FD00(aRadioactive, 256);
  dword_4C2D48 = (int)sub_42FD00(aYouAreTheRadio, 256);
  perk_id_fastshot = 14;
  dword_4C2D58 = (int)sub_42FD00(aFastshot, 256);
  dword_4C2D5C = (int)sub_42FD00(aFunnyHowYouMak, 256);
  perk_id_fatal_lottery = 15;
  dword_4C2D74 = 4;
  dword_4C2D6C = (int)sub_42FD00(aFatalLottery, 256);
  dword_4C2D70 = (int)sub_42FD00(aFiftyFiftyChan, 256);
  perk_id_random_weapon = 16;
  dword_4C2D88 = 5;
  dword_4C2D80 = (int)sub_42FD00(aRandomWeapon, 256);
  dword_4C2D84 = (int)sub_42FD00(aHereHaveThisWe, 256);
  perk_id_mr_melee = 17;
  dword_4C2D94 = (int)sub_42FD00(aMrMelee, 256);
  dword_4C2D98 = (int)sub_42FD00(aYouMasterTheAr, 256);
  perk_id_anxious_loader = 18;
  dword_4C2DA8 = (int)sub_42FD00(aAnxiousLoader, 256);
  dword_4C2DAC = (int)sub_42FD00(aWhenYouCanTSta, 256);
  perk_id_final_revenge = 19;
  dword_4C2DC4 = 0;
  dword_4C2DBC = (int)sub_42FD00(aFinalRevenge, 256);
  dword_4C2DC0 = (int)sub_42FD00(aPickThisAndYou, 256);
  perk_id_telekinetic = 20;
  dword_4C2DD0 = (int)sub_42FD00(aTelekinetic, 256);
  dword_4C2DD4 = (int)sub_42FD00(aPickingUpBonus, 256);
  perk_id_perk_expert = 21;
  dword_4C2DE4 = (int)sub_42FD00(aPerkExpert, 256);
  dword_4C2DE8 = (int)sub_42FD00(aYouSureKnowHow, 256);
  perk_id_unstoppable = 22;
  dword_4C2DF8 = (int)sub_42FD00(aUnstoppable, 256);
  dword_4C2DFC = (int)sub_42FD00(aMonstersCanTSl, 256);
  perk_id_regression_bullets = 23;
  dword_4C2E0C = (int)sub_42FD00(aRegressionBull, 256);
  dword_4C2E10 = (int)sub_42FD00(aAttemptToShoot, 256);
  perk_id_infernal_contract = 24;
  dword_4C2E20 = (int)sub_42FD00(aInfernalContra, 256);
  dword_4C2E24 = (int)sub_42FD00(aInExchangeForY, 256);
  perk_id_poison_bullets = 25;
  dword_4C2E34 = (int)sub_42FD00(aPoisonBullets, 256);
  dword_4C2E38 = (int)sub_42FD00(aYouTendToExpli, 256);
  perk_id_dodger = 26;
  dword_4C2E48 = (int)sub_42FD00(aDodger, 256);
  dword_4C2E4C = (int)sub_42FD00(aItSeemsSoStupi, 256);
  perk_id_bonus_magnet = 27;
  dword_4C2E5C = (int)sub_42FD00(aBonusMagnet, 256);
  dword_4C2E60 = (int)sub_42FD00(aYouSomehowSeem, 256);
  perk_id_uranium_filled_bullets = 28;
  dword_4C2E70 = (int)sub_42FD00(aUraniumFilledB, 256);
  dword_4C2E74 = (int)sub_42FD00(aYourBulletsHav, 256);
  perk_id_doctor = 29;
  dword_4C2E84 = (int)sub_42FD00(aDoctor, 256);
  dword_4C2E88 = (int)sub_42FD00(aWithASingleGla, 256);
  perk_id_monster_vision = 30;
  dword_4C2E98 = (int)sub_42FD00(aMonsterVision, 256);
  dword_4C2E9C = (int)sub_42FD00(aWithYourNewlyE, 256);
  perk_id_hot_tempered = 31;
  dword_4C2EAC = (int)sub_42FD00(aHotTempered, 256);
  dword_4C2EB0 = (int)sub_42FD00(aItLiterallyBoi, 256);
  perk_id_bonus_economist = 32;
  dword_4C2EC0 = (int)sub_42FD00(aBonusEconomist, 256);
  dword_4C2EC4 = (int)sub_42FD00(aYourBonusPower, 256);
  dword_4C2BCC = 0;
  perk_id_thick_skinned = 33;
  dword_4C2ED4 = (int)sub_42FD00(aThickSkinned, 256);
  dword_4C2ED8 = (int)sub_42FD00(aTrade13OfYourH, 256);
  perk_id_barrel_greaser = 34;
  dword_4C2EE8 = (int)sub_42FD00(aBarrelGreaser, 256);
  dword_4C2EEC = (int)sub_42FD00(aAfterStudyingA, 256);
  perk_id_ammunition_within = 35;
  dword_4C2EFC = (int)sub_42FD00(aAmmunitionWith, 256);
  dword_4C2F00 = (int)sub_42FD00(aEmptyClipDoesn, 256);
  perk_id_veins_of_poison = 36;
  dword_4C2F10 = (int)sub_42FD00(aVeinsOfPoison, 256);
  dword_4C2F14 = (int)sub_42FD00(aAStrongPoisonR, 256);
  perk_id_toxic_avenger = 37;
  dword_4C2F24 = (int)sub_42FD00(aToxicAvenger, 256);
  dword_4C2F28 = (int)sub_42FD00(aYouStartedOutJ, 256);
  perk_id_regeneration = 38;
  dword_4C2F34 = perk_id_veins_of_poison;
  dword_4C2F38 = (int)sub_42FD00(aRegeneration, 256);
  dword_4C2F3C = (int)sub_42FD00(aYourHealthRepl, 256);
  perk_id_pyromaniac = 39;
  dword_4C2F4C = (int)sub_42FD00(aPyromaniac, 256);
  dword_4C2F50 = (int)sub_42FD00(aYouJustEnjoyUs, 256);
  perk_id_ninja = 40;
  dword_4C2F60 = (int)sub_42FD00(aNinja, 256);
  dword_4C2F64 = (int)sub_42FD00(aYouVeTakenYour, 256);
  dword_4C2F70 = perk_id_dodger;
  perk_id_highlander = 41;
  dword_4C2F7C = 0;
  dword_4C2F74 = (int)sub_42FD00(aHighlander, 256);
  dword_4C2F78 = (int)sub_42FD00(aYouAreImmortal, 256);
  perk_id_jinxed = 42;
  dword_4C2F88 = (int)sub_42FD00(aJinxed, 256);
  dword_4C2F8C = (int)sub_42FD00(aThingsHappenNe, 256);
  perk_id_perk_master = 43;
  dword_4C2F9C = (int)sub_42FD00(aPerkMaster, 256);
  dword_4C2FA0 = (int)sub_42FD00(aBeingThePerkEx, 256);
  dword_4C2FAC = perk_id_perk_expert;
  perk_id_reflex_boosted = 44;
  dword_4C2FB0 = (int)sub_42FD00(aReflexBoosted, 256);
  dword_4C2FB4 = (int)sub_42FD00(aToYouTheWorldS, 256);
  perk_id_greater_regeneration = 45;
  dword_4C2FC4 = (int)sub_42FD00(aGreaterRegener, 256);
  dword_4C2FC8 = (int)sub_42FD00(aYourHealthRepl_0, 256);
  perk_id_breathing_room = 46;
  dword_4C2FD4 = perk_id_regeneration;
  dword_4C2FE0 = 2;
  dword_4C2FD8 = (int)sub_42FD00(aBreathingRoom, 256);
  dword_4C2FDC = (int)sub_42FD00(aTrade23rdsOfYo, 256);
  perk_id_death_clock = 47;
  dword_4C2FEC = (int)sub_42FD00(aDeathClock, 256);
  dword_4C2FF0 = (int)sub_42FD00(aYouDieExactlyI, 256);
  perk_id_my_favourite_weapon = 48;
  dword_4C3000 = (int)sub_42FD00(aMyFavouriteWea, 256);
  dword_4C3004 = (int)sub_42FD00(aYouVeGrownVery, 256);
  perk_id_bandage = 49;
  dword_4C3014 = (int)sub_42FD00(aBandage, 256);
  dword_4C3018 = (int)sub_42FD00(aHereEatThisBan, 256);
  perk_id_angry_reloader = 50;
  dword_4C3028 = (int)sub_42FD00(aAngryReloader, 256);
  dword_4C302C = (int)sub_42FD00(aYouHateItWhenY, 256);
  perk_id_ion_gun_master = 51;
  dword_4C303C = (int)sub_42FD00(aIonGunMaster, 256);
  dword_4C3040 = (int)sub_42FD00(aYouReGoodWithI, 256);
  perk_id_stationary_reloader = 52;
  dword_4C3050 = (int)sub_42FD00(aStationaryRelo, 256);
  dword_4C3054 = (int)sub_42FD00(aItSIncrediblyH, 256);
  perk_id_man_bomb = 53;
  dword_4C3064 = (int)sub_42FD00(aManBomb, 256);
  dword_4C3068 = (int)sub_42FD00(aYouHaveTheAbil, 256);
  perk_id_fire_caugh = 54;
  dword_4C3078 = (int)sub_42FD00(aFireCaugh, 256);
  dword_4C307C = (int)sub_42FD00(aYouHaveAFireba, 256);
  perk_id_living_fortress = 55;
  dword_4C308C = (int)sub_42FD00(aLivingFortress, 256);
  dword_4C3090 = (int)sub_42FD00(aItComesATimeIn, 256);
  perk_id_tough_reloader = 56;
  dword_4C30A0 = (int)sub_42FD00(aToughReloader, 256);
  dword_4C30A4 = (int)sub_42FD00(aDamageReceived, 256);
  perk_id_lifeline_50_50 = 57;
  dword_4C30B4 = (int)sub_42FD00(aLifeline5050, 256);
  dword_4C30B8 = (int)sub_42FD00(aTheComputerRem, 256);
  dword_4C2C38 = 57;
  dword_4C2B8C = 58;
  return perks_rebuild_available();
}

// FUN_00430a20 @ 0x00430A20
// [binja] int32_t sub_430a20(int32_t* arg1, int32_t arg2, int32_t arg3, char* arg4)
int __cdecl sub_430A20(int a1, int a2, int a3, char *Source)
{
  int result; // eax
  int v5; // ecx

  if ( *(_DWORD *)(a1 + 12) )
  {
    crt_free(*(LPVOID *)(a1 + 12));
    console_printf((int)&console_log_queue, aQuestOverwritt);
  }
  *(_DWORD *)(a1 + 12) = strdup_malloc(Source);
  result = a2;
  *(_DWORD *)(a1 + 32) = perk_id_antiperk;
  v5 = 2 * a2 - 2;
  *(_DWORD *)(a1 + 36) = 0;
  *(_DWORD *)a1 = a2;
  *(_DWORD *)(a1 + 4) = a3;
  *(_DWORD *)(a1 + 16) = v5;
  if ( a3 <= 5 )
  {
    *(_DWORD *)(a1 + 20) = 2 * a2 - 1;
    *(_DWORD *)(a1 + 24) = v5;
  }
  else
  {
    *(_DWORD *)(a1 + 20) = v5;
    *(_DWORD *)(a1 + 24) = 2 * a2 - 1;
  }
  if ( a2 >= 5 )
  {
    *(_DWORD *)(a1 + 16) = a3 % 4;
    *(_DWORD *)(a1 + 20) = 1;
    *(_DWORD *)(a1 + 24) = 3;
    *(_DWORD *)(a1 + 28) = 5;
  }
  quest_meta_cursor = a1;
  return result;
}

// sub_430AD0 @ 0x00430AD0
int sub_430AD0()
{
  int result; // eax
  int *v1; // ecx

  result = 0;
  v1 = creature_spawn_slot_owner;
  while ( *v1 )
  {
    v1 += 6;
    ++result;
    if ( (int)v1 >= (int)&SubKey )
      return 31;
  }
  return result;
}

// creature_spawn_template @ 0x00430AF0
// spawns creature(s) from template id; heading -100 uses a random heading
char *__cdecl sub_430AF0(int a1, float *a2, float a3)
{
  int v3; // ebp
  char *v5; // esi
  int v6; // ecx
  int v7; // eax
  long double v8; // st7
  int v9; // ecx
  int v10; // eax
  long double v11; // st7
  double v12; // st7
  int v13; // eax
  long double v14; // st7
  long double v15; // st7
  _DWORD *v16; // edx
  int v17; // eax
  int v18; // eax
  double v19; // st7
  int v21; // kr00_4
  double v22; // st7
  long double v23; // st7
  long double v24; // st7
  _DWORD *v25; // edx
  int v26; // eax
  double v27; // st7
  int v28; // eax
  double v29; // st7
  int v30; // eax
  double v31; // st7
  int v32; // eax
  double v33; // st7
  int v34; // ecx
  int v35; // eax
  double v36; // st7
  int v37; // eax
  char **v38; // eax
  int v39; // eax
  char **v40; // eax
  int v41; // eax
  char **v42; // eax
  int v43; // eax
  char **v44; // eax
  long double v45; // st7
  int v46; // eax
  char **v47; // eax
  int v48; // eax
  char **v49; // eax
  int v50; // eax
  char **v51; // eax
  int v52; // eax
  char **v53; // eax
  int v54; // eax
  double v55; // st7
  double v56; // st7
  int v57; // eax
  double v58; // st7
  double v59; // st7
  double v60; // st7
  int v61; // eax
  int v62; // eax
  double v63; // st7
  double v64; // st7
  int v65; // eax
  double v66; // st7
  double v67; // st7
  int v68; // eax
  int v69; // eax
  double v70; // st7
  int v71; // eax
  int v72; // eax
  double v73; // st7
  int v74; // eax
  int v75; // eax
  double v76; // st7
  int v77; // eax
  double v78; // st7
  int v79; // eax
  double v80; // st7
  int v81; // eax
  double v82; // st7
  int v83; // eax
  double v84; // st7
  int v85; // eax
  int v86; // eax
  double v87; // st7
  int v88; // eax
  double v89; // st7
  double v90; // st7
  double v91; // st7
  char *v92; // edx
  int v93; // eax
  char *v94; // edx
  double v95; // st7
  double v96; // st7
  int v97; // eax
  char **v98; // eax
  double v99; // st7
  double v100; // st7
  int v101; // [esp+10h] [ebp-48h]
  int k; // [esp+10h] [ebp-48h]
  int n; // [esp+10h] [ebp-48h]
  int jj; // [esp+10h] [ebp-48h]
  int mm; // [esp+10h] [ebp-48h]
  int i1; // [esp+10h] [ebp-48h]
  int v107; // [esp+18h] [ebp-40h]
  float v108; // [esp+18h] [ebp-40h]
  float v109; // [esp+18h] [ebp-40h]
  float v110; // [esp+18h] [ebp-40h]
  float v111; // [esp+18h] [ebp-40h]
  float v112; // [esp+18h] [ebp-40h]
  float v113; // [esp+18h] [ebp-40h]
  float v114; // [esp+1Ch] [ebp-3Ch]
  float v115; // [esp+20h] [ebp-38h]
  float v116; // [esp+24h] [ebp-34h]
  float v117; // [esp+28h] [ebp-30h]
  float v118; // [esp+28h] [ebp-30h]
  float v119; // [esp+28h] [ebp-30h]
  float v120; // [esp+28h] [ebp-30h]
  float v121; // [esp+28h] [ebp-30h]
  float v122; // [esp+28h] [ebp-30h]
  float v123; // [esp+28h] [ebp-30h]
  float v124; // [esp+2Ch] [ebp-2Ch]
  float v125; // [esp+2Ch] [ebp-2Ch]
  float v126; // [esp+2Ch] [ebp-2Ch]
  float v127; // [esp+2Ch] [ebp-2Ch]
  float v128; // [esp+2Ch] [ebp-2Ch]
  float v129; // [esp+2Ch] [ebp-2Ch]
  float v130; // [esp+2Ch] [ebp-2Ch]
  float v131; // [esp+2Ch] [ebp-2Ch]
  float v132; // [esp+30h] [ebp-28h]
  float v133; // [esp+30h] [ebp-28h]
  float v134; // [esp+38h] [ebp-20h]
  float v135; // [esp+38h] [ebp-20h]
  float v136; // [esp+3Ch] [ebp-1Ch]
  float v137; // [esp+3Ch] [ebp-1Ch]
  int i; // [esp+60h] [ebp+8h]
  int j; // [esp+60h] [ebp+8h]
  int v140; // [esp+60h] [ebp+8h]
  int v141; // [esp+60h] [ebp+8h]
  int m; // [esp+60h] [ebp+8h]
  int ii; // [esp+60h] [ebp+8h]
  int kk; // [esp+60h] [ebp+8h]
  int nn; // [esp+60h] [ebp+8h]
  int i2; // [esp+60h] [ebp+8h]
  int v147; // [esp+60h] [ebp+8h]

  v3 = creature_alloc_slot();
  if ( a3 == -100.0 )
    a3 = (double)(crt_rand() % 628) * 0.0099999998;
  v107 = 38 * v3;
  v5 = &creature_pool[152 * v3];
  *((_DWORD *)v5 + 36) = 0;
  *((float *)v5 + 5) = *a2;
  v6 = *((_DWORD *)a2 + 1);
  *((_DWORD *)v5 + 7) = 0;
  *((_DWORD *)v5 + 6) = v6;
  v5[9] = 0;
  *((_DWORD *)v5 + 3) = 0;
  *v5 = 1;
  v5[76] = 0;
  v5[8] = 1;
  *((_DWORD *)v5 + 4) = 1098907648;
  *((_DWORD *)v5 + 8) = 0;
  v7 = crt_rand();
  *((_DWORD *)v5 + 24) = 0;
  *((float *)v5 + 11) = (double)(v7 % 314) * 0.0099999998;
  if ( a1 == 18 )
  {
    *((_DWORD *)v5 + 15) = 1059481190;
    *((_DWORD *)v5 + 27) = 2;
    *((_DWORD *)v5 + 16) = 1062836634;
    *((_DWORD *)v5 + 9) = 1128792064;
    *((_DWORD *)v5 + 23) = 1074580685;
    *((_DWORD *)v5 + 17) = 1064849900;
    *((_DWORD *)v5 + 25) = 1142292480;
    *((_DWORD *)v5 + 13) = 1113325568;
    *((_DWORD *)v5 + 18) = 1065353216;
    *((_DWORD *)v5 + 22) = 1096810496;
    *((_DWORD *)v5 + 10) = 1128792064;
    for ( i = 0; i < 8; ++i )
    {
      v8 = (double)i * 0.78539819;
      v5 = (char *)(152 * creature_alloc_slot() + 4833080);
      *((_DWORD *)v5 + 36) = 3;
      *((_DWORD *)v5 + 30) = v3;
      *((float *)v5 + 31) = cos(v8) * 100.0;
      *((float *)v5 + 32) = sin(v8) * 100.0;
      *((float *)v5 + 5) = *a2;
      *((float *)v5 + 6) = a2[1];
      *((_DWORD *)v5 + 7) = 0;
      *((_DWORD *)v5 + 8) = 0;
      v5[9] = 0;
      *((_DWORD *)v5 + 15) = 1050924811;
      *((_DWORD *)v5 + 9) = 1109393408;
      *((_DWORD *)v5 + 10) = 1109393408;
      *((_DWORD *)v5 + 16) = 1058441004;
      *((_DWORD *)v5 + 17) = 1054481580;
      *((_DWORD *)v5 + 3) = 0;
      *v5 = 1;
      v5[8] = 1;
      *((_DWORD *)v5 + 4) = 1098907648;
      *((_DWORD *)v5 + 24) = 0;
      *((_DWORD *)v5 + 27) = 2;
      *((_DWORD *)v5 + 23) = 1075419546;
      *((_DWORD *)v5 + 25) = 1114636288;
      *((_DWORD *)v5 + 18) = 1065353216;
      *((_DWORD *)v5 + 13) = 1112014848;
      *((_DWORD *)v5 + 22) = 1082130432;
    }
    goto LABEL_15;
  }
  v9 = a1;
  switch ( a1 )
  {
    case 25:
      *((_DWORD *)v5 + 15) = 1064514355;
      *((_DWORD *)v5 + 27) = 2;
      *((_DWORD *)v5 + 16) = 1057803469;
      *((_DWORD *)v5 + 9) = 1112014848;
      *((_DWORD *)v5 + 23) = 1081291571;
      *((_DWORD *)v5 + 17) = 1052602532;
      *((_DWORD *)v5 + 25) = 1133903872;
      *((_DWORD *)v5 + 13) = 1113325568;
      *((_DWORD *)v5 + 18) = 1065353216;
      *((_DWORD *)v5 + 22) = 1109393408;
      *((_DWORD *)v5 + 10) = 1112014848;
      for ( j = 0; j < 5; ++j )
      {
        v10 = creature_alloc_slot();
        v11 = (double)j * 1.2566371;
        v5 = (char *)(152 * v10 + 4833080);
        *((_DWORD *)v5 + 36) = 5;
        *((_DWORD *)v5 + 30) = v3;
        *((float *)v5 + 31) = cos(v11) * 110.0;
        *((float *)v5 + 32) = sin(v11) * 110.0;
        v108 = creature_target_offset_x[38 * v10] + *a2;
        v12 = creature_target_offset_y[38 * v10] + a2[1];
        *((_DWORD *)v5 + 7) = 0;
        *((float *)v5 + 5) = v108;
        v114 = v12;
        *((_DWORD *)v5 + 8) = 0;
        *((float *)v5 + 6) = v114;
        *((_DWORD *)v5 + 9) = 1130102784;
        *((_DWORD *)v5 + 10) = 1130102784;
        *((_DWORD *)v5 + 15) = 1060529766;
        *((_DWORD *)v5 + 16) = 1054028596;
        v5[9] = 0;
        *((_DWORD *)v5 + 17) = 1049498747;
        *((_DWORD *)v5 + 3) = 0;
        *v5 = 1;
        v5[8] = 1;
        *((_DWORD *)v5 + 4) = 1098907648;
        *((_DWORD *)v5 + 24) = 0;
        *((_DWORD *)v5 + 27) = 2;
        *((_DWORD *)v5 + 23) = 1081291571;
        *((_DWORD *)v5 + 25) = 1114636288;
        *((_DWORD *)v5 + 18) = 1058642330;
        *((_DWORD *)v5 + 13) = 1112014848;
        *((_DWORD *)v5 + 22) = 1108082688;
      }
      break;
    case 17:
      *((_DWORD *)v5 + 27) = 1;
      *((float *)v5 + 5) = *a2;
      *((float *)v5 + 6) = a2[1];
      *((_DWORD *)v5 + 36) = 1;
      *((_DWORD *)v5 + 15) = 1065185444;
      *((_DWORD *)v5 + 16) = 1065185444;
      *((_DWORD *)v5 + 9) = 1153138688;
      *((_DWORD *)v5 + 23) = 1074161254;
      *((_DWORD *)v5 + 17) = 1045891645;
      *((_DWORD *)v5 + 25) = 1148846080;
      *((_DWORD *)v5 + 13) = 1116340224;
      *((_DWORD *)v5 + 18) = 1065353216;
      *((_DWORD *)v5 + 22) = 1125515264;
      *((_DWORD *)v5 + 10) = 1153138688;
      v101 = 2;
      v140 = -256;
      do
      {
        v13 = creature_alloc_slot();
        creature_target_offset_x[38 * v13] = (float)v140;
        v5 = (char *)(152 * v13 + 4833080);
        v14 = (double)v101 * 0.39269909;
        *((_DWORD *)v5 + 36) = 3;
        *((_DWORD *)v5 + 30) = v3;
        *((_DWORD *)v5 + 32) = -1015021568;
        v132 = cos(v14);
        v134 = v132 * 256.0;
        v115 = v134 + *a2;
        v15 = sin(v14) * 256.0 + a2[1];
        *((float *)v5 + 5) = v115;
        *((_DWORD *)v5 + 7) = 0;
        v16 = (_DWORD *)(152 * v13 + 4833140);
        v116 = v15;
        *v16 = 1058642330;
        *((float *)v5 + 6) = v116;
        v16[1] = 1058642330;
        *((_DWORD *)v5 + 8) = 0;
        v16[2] = 1050589266;
        *((_DWORD *)v5 + 9) = 1114636288;
        *((_DWORD *)v5 + 25) = 1114636288;
        *((_DWORD *)v5 + 10) = 1114636288;
        v16[3] = 1065353216;
        v5[9] = 0;
        *((_DWORD *)v5 + 3) = 0;
        *v5 = 1;
        v5[8] = 1;
        *((_DWORD *)v5 + 4) = 1098907648;
        *((_DWORD *)v5 + 24) = 0;
        *((_DWORD *)v5 + 27) = 1;
        *((_DWORD *)v5 + 23) = 1075419546;
        *((_DWORD *)v5 + 13) = 1112014848;
        *((_DWORD *)v5 + 22) = 1096810496;
        v3 = v13;
        v140 += 64;
        v101 += 2;
      }
      while ( v140 < 0 );
LABEL_14:
      creature_link_index[v107] = v13;
      break;
    case 19:
      *((_DWORD *)v5 + 27) = 2;
      v21 = terrain_texture_height;
      *((_DWORD *)v5 + 36) = 2;
      *((_DWORD *)v5 + 5) = -1054867456;
      v124 = (float)(v21 / 2);
      *((_DWORD *)v5 + 15) = 1058642330;
      *((float *)v5 + 6) = v124;
      *((_DWORD *)v5 + 16) = 1061997773;
      *((_DWORD *)v5 + 17) = 1063843267;
      *((_DWORD *)v5 + 9) = 1128792064;
      *((_DWORD *)v5 + 23) = 0x40000000;
      *((_DWORD *)v5 + 25) = 1142292480;
      *((_DWORD *)v5 + 18) = 1065353216;
      *((_DWORD *)v5 + 13) = 1109393408;
      *((_DWORD *)v5 + 22) = 1101004800;
      v141 = 2;
      v136 = sin(0.0);
      v137 = v136 * 256.0;
      v117 = cos(0.0) * 256.0 + *a2;
      v22 = v137 + a2[1];
      *((_DWORD *)v5 + 10) = 1128792064;
      *((float *)v5 + 5) = v117;
      *((_DWORD *)v5 + 36) = 6;
      v125 = v22;
      *((float *)v5 + 6) = v125;
      do
      {
        v13 = creature_alloc_slot();
        v23 = (double)v141 * 0.34906587;
        v5 = (char *)(152 * v13 + 4833080);
        *((_DWORD *)v5 + 36) = 6;
        *((_DWORD *)v5 + 30) = v3;
        *((_DWORD *)v5 + 33) = 1078530011;
        *((_DWORD *)v5 + 34) = 1092616192;
        v135 = cos(v23);
        v133 = v135 * 256.0;
        v118 = v133 + *a2;
        v24 = sin(v23) * 256.0 + a2[1];
        *((float *)v5 + 5) = v118;
        *((_DWORD *)v5 + 7) = 0;
        v126 = v24;
        *((_DWORD *)v5 + 9) = 1114636288;
        *((float *)v5 + 6) = v126;
        *((_DWORD *)v5 + 8) = 0;
        v25 = (_DWORD *)(152 * v13 + 4833140);
        *((_DWORD *)v5 + 25) = 1114636288;
        *((_DWORD *)v5 + 10) = 1114636288;
        *v25 = 1053609165;
        v25[1] = 1060320051;
        v5[9] = 0;
        v25[2] = 1038174126;
        *((_DWORD *)v5 + 3) = 0;
        *v5 = 1;
        v25[3] = 1065353216;
        v5[8] = 1;
        *((_DWORD *)v5 + 4) = 1098907648;
        *((_DWORD *)v5 + 24) = 0;
        *((_DWORD *)v5 + 27) = 2;
        *((_DWORD *)v5 + 23) = 0x40000000;
        *((_DWORD *)v5 + 13) = 1112014848;
        *((_DWORD *)v5 + 22) = 1082130432;
        v3 = v13;
        v141 += 2;
      }
      while ( v141 < 22 );
      goto LABEL_14;
    case 20:
      *((_DWORD *)v5 + 27) = 2;
      *((float *)v5 + 5) = *a2;
      *((float *)v5 + 6) = a2[1];
      *((_DWORD *)v5 + 36) = 2;
      *((_DWORD *)v5 + 15) = 1060320051;
      *((_DWORD *)v5 + 16) = 1061997773;
      *((_DWORD *)v5 + 9) = 1153138688;
      *((_DWORD *)v5 + 23) = 0x40000000;
      *((_DWORD *)v5 + 17) = 1050589266;
      *((_DWORD *)v5 + 25) = 1142292480;
      *((_DWORD *)v5 + 13) = 1112014848;
      *((_DWORD *)v5 + 18) = 1065353216;
      *((_DWORD *)v5 + 22) = 1109393408;
      *((float *)v5 + 5) = *a2;
      *((float *)v5 + 6) = a2[1];
      *((_DWORD *)v5 + 10) = 1153138688;
      for ( k = 0; k > -576; k -= 64 )
      {
        for ( m = 128; m <= 256; m += 64 )
        {
          v26 = 19 * creature_alloc_slot();
          creature_target_offset_y[2 * v26] = (float)m;
          v5 = (char *)(8 * v26 + 4833080);
          *((_DWORD *)v5 + 36) = 5;
          *((_DWORD *)v5 + 11) = 0;
          *((_DWORD *)v5 + 37) = 0;
          *((_DWORD *)v5 + 30) = v3;
          v109 = (float)k;
          *((float *)v5 + 31) = v109;
          v119 = *a2 + creature_target_offset_x[2 * v26];
          v27 = creature_target_offset_y[2 * v26] + a2[1];
          *((_DWORD *)v5 + 7) = 0;
          *((float *)v5 + 5) = v119;
          v127 = v27;
          *((_DWORD *)v5 + 8) = 0;
          *((float *)v5 + 6) = v127;
          *((_DWORD *)v5 + 15) = 1053609165;
          *((_DWORD *)v5 + 9) = 1109393408;
          *((_DWORD *)v5 + 10) = 1109393408;
          *((_DWORD *)v5 + 16) = 1060320051;
          *((_DWORD *)v5 + 17) = 1038174126;
          v5[9] = 0;
          *((_DWORD *)v5 + 3) = 0;
          *v5 = 1;
          v5[8] = 1;
          *((_DWORD *)v5 + 4) = 1098907648;
          *((_DWORD *)v5 + 24) = 0;
          *((_DWORD *)v5 + 27) = 2;
          *((_DWORD *)v5 + 23) = 0x40000000;
          *((_DWORD *)v5 + 25) = 1114636288;
          *((_DWORD *)v5 + 18) = 1065353216;
          *((_DWORD *)v5 + 13) = 1112014848;
          *((_DWORD *)v5 + 22) = 1082130432;
        }
      }
      break;
    case 21:
      *((_DWORD *)v5 + 27) = 2;
      *((float *)v5 + 5) = *a2;
      *((float *)v5 + 6) = a2[1];
      *((_DWORD *)v5 + 36) = 2;
      *((_DWORD *)v5 + 15) = 1065353216;
      *((_DWORD *)v5 + 16) = 1065353216;
      *((_DWORD *)v5 + 9) = 1153138688;
      *((_DWORD *)v5 + 23) = 0x40000000;
      *((_DWORD *)v5 + 17) = 1065353216;
      *((_DWORD *)v5 + 25) = 1142292480;
      *((_DWORD *)v5 + 13) = 1114636288;
      *((_DWORD *)v5 + 18) = 1065353216;
      *((_DWORD *)v5 + 22) = 1109393408;
      *((float *)v5 + 5) = *a2;
      *((float *)v5 + 6) = a2[1];
      *((_DWORD *)v5 + 10) = 1153138688;
      for ( n = 0; n > -576; n -= 64 )
      {
        for ( ii = 128; ii <= 256; ii += 64 )
        {
          v28 = creature_alloc_slot();
          creature_target_offset_y[38 * v28] = (float)ii;
          v5 = (char *)(152 * v28 + 4833080);
          *((_DWORD *)v5 + 36) = 4;
          *((_DWORD *)v5 + 11) = 0;
          *((_DWORD *)v5 + 37) = 0;
          *((_DWORD *)v5 + 30) = v3;
          v110 = (float)n;
          *((float *)v5 + 31) = v110;
          v120 = *a2 + creature_target_offset_x[38 * v28];
          v29 = creature_target_offset_y[38 * v28] + a2[1];
          *((_DWORD *)v5 + 7) = 0;
          *((float *)v5 + 5) = v120;
          v128 = v29;
          *((_DWORD *)v5 + 8) = 0;
          *((float *)v5 + 6) = v128;
          *((_DWORD *)v5 + 9) = 1109393408;
          *((_DWORD *)v5 + 10) = 1109393408;
          *((_DWORD *)v5 + 15) = 1053609165;
          *((_DWORD *)v5 + 16) = 1060320051;
          v5[9] = 0;
          *((_DWORD *)v5 + 17) = 1038174126;
          *((_DWORD *)v5 + 3) = 0;
          *v5 = 1;
          v5[8] = 1;
          *((_DWORD *)v5 + 4) = 1098907648;
          *((_DWORD *)v5 + 24) = 0;
          *((_DWORD *)v5 + 27) = 2;
          *((_DWORD *)v5 + 23) = 0x40000000;
          *((_DWORD *)v5 + 25) = 1114636288;
          *((_DWORD *)v5 + 18) = 1065353216;
          *((_DWORD *)v5 + 13) = 1112014848;
          *((_DWORD *)v5 + 22) = 1082130432;
        }
      }
      break;
    case 23:
      *((_DWORD *)v5 + 27) = 3;
      *((float *)v5 + 5) = *a2;
      *((float *)v5 + 6) = a2[1];
      *((_DWORD *)v5 + 15) = 1065353216;
      *((_DWORD *)v5 + 16) = 1065353216;
      *((_DWORD *)v5 + 36) = 2;
      *((_DWORD *)v5 + 9) = 1153138688;
      *((_DWORD *)v5 + 17) = 1065353216;
      *((_DWORD *)v5 + 23) = 0x40000000;
      *((_DWORD *)v5 + 25) = 1142292480;
      *((_DWORD *)v5 + 18) = 1065353216;
      *((_DWORD *)v5 + 13) = 1114636288;
      *((_DWORD *)v5 + 22) = 1109393408;
      *((float *)v5 + 5) = *a2;
      *((float *)v5 + 6) = a2[1];
      *((_DWORD *)v5 + 10) = 1153138688;
      for ( jj = 0; jj > -576; jj -= 64 )
      {
        for ( kk = 128; kk <= 256; kk += 64 )
        {
          v30 = creature_alloc_slot();
          creature_target_offset_y[38 * v30] = (float)kk;
          v5 = (char *)(152 * v30 + 4833080);
          *((_DWORD *)v5 + 36) = 4;
          *((_DWORD *)v5 + 11) = 0;
          *((_DWORD *)v5 + 37) = 0;
          *((_DWORD *)v5 + 30) = v3;
          v111 = (float)jj;
          *((float *)v5 + 31) = v111;
          v121 = creature_target_offset_x[38 * v30] + *a2;
          v31 = creature_target_offset_y[38 * v30] + a2[1];
          *((_DWORD *)v5 + 7) = 0;
          *((float *)v5 + 5) = v121;
          v129 = v31;
          *((_DWORD *)v5 + 8) = 0;
          *((float *)v5 + 6) = v129;
          *((_DWORD *)v5 + 9) = 1109393408;
          *((_DWORD *)v5 + 10) = 1109393408;
          *((_DWORD *)v5 + 15) = 1053609165;
          *((_DWORD *)v5 + 16) = 1060320051;
          v5[9] = 0;
          *((_DWORD *)v5 + 17) = 1038174126;
          *((_DWORD *)v5 + 3) = 0;
          *v5 = 1;
          v5[8] = 1;
          *((_DWORD *)v5 + 4) = 1098907648;
          *((_DWORD *)v5 + 24) = 0;
          *((_DWORD *)v5 + 27) = 3;
          *((_DWORD *)v5 + 23) = 0x40000000;
          *((_DWORD *)v5 + 25) = 1114636288;
          *((_DWORD *)v5 + 18) = 1065353216;
          *((_DWORD *)v5 + 13) = 1112014848;
          *((_DWORD *)v5 + 22) = 1082130432;
        }
      }
      break;
    case 22:
      *((_DWORD *)v5 + 27) = 1;
      *((float *)v5 + 5) = *a2;
      *((float *)v5 + 6) = a2[1];
      *((_DWORD *)v5 + 15) = 1065353216;
      *((_DWORD *)v5 + 16) = 1065353216;
      *((_DWORD *)v5 + 36) = 2;
      *((_DWORD *)v5 + 9) = 1153138688;
      *((_DWORD *)v5 + 17) = 1065353216;
      *((_DWORD *)v5 + 23) = 0x40000000;
      *((_DWORD *)v5 + 25) = 1142292480;
      *((_DWORD *)v5 + 18) = 1065353216;
      *((_DWORD *)v5 + 13) = 1115684864;
      *((_DWORD *)v5 + 22) = 1109393408;
      *((float *)v5 + 5) = *a2;
      *((float *)v5 + 6) = a2[1];
      *((_DWORD *)v5 + 10) = 1153138688;
      for ( mm = 0; mm > -576; mm -= 64 )
      {
        for ( nn = 128; nn <= 256; nn += 64 )
        {
          v32 = creature_alloc_slot();
          creature_target_offset_y[38 * v32] = (float)nn;
          v5 = (char *)(152 * v32 + 4833080);
          *((_DWORD *)v5 + 36) = 4;
          *((_DWORD *)v5 + 11) = 0;
          *((_DWORD *)v5 + 37) = 0;
          *((_DWORD *)v5 + 30) = v3;
          v112 = (float)mm;
          *((float *)v5 + 31) = v112;
          v122 = creature_target_offset_x[38 * v32] + *a2;
          v33 = creature_target_offset_y[38 * v32] + a2[1];
          *((_DWORD *)v5 + 7) = 0;
          *((float *)v5 + 5) = v122;
          v130 = v33;
          *((_DWORD *)v5 + 8) = 0;
          *((float *)v5 + 6) = v130;
          *((_DWORD *)v5 + 9) = 1109393408;
          *((_DWORD *)v5 + 10) = 1109393408;
          *((_DWORD *)v5 + 15) = 1053609165;
          *((_DWORD *)v5 + 16) = 1060320051;
          v5[9] = 0;
          *((_DWORD *)v5 + 17) = 1038174126;
          *((_DWORD *)v5 + 3) = 0;
          *v5 = 1;
          v5[8] = 1;
          *((_DWORD *)v5 + 4) = 1098907648;
          *((_DWORD *)v5 + 24) = 0;
          *((_DWORD *)v5 + 27) = 1;
          *((_DWORD *)v5 + 23) = 0x40000000;
          *((_DWORD *)v5 + 25) = 1114636288;
          *((_DWORD *)v5 + 18) = 1065353216;
          *((_DWORD *)v5 + 13) = 1114636288;
          *((_DWORD *)v5 + 22) = 1082130432;
        }
      }
      break;
    case 15:
      *((_DWORD *)v5 + 27) = 2;
      *((float *)v5 + 5) = *a2;
      *((float *)v5 + 6) = a2[1];
      *((_DWORD *)v5 + 27) = 2;
      *((_DWORD *)v5 + 15) = 1059732848;
      *((_DWORD *)v5 + 16) = 1053105848;
      *((_DWORD *)v5 + 36) = 0;
      *((_DWORD *)v5 + 9) = 1101004800;
      *((_DWORD *)v5 + 17) = 1048877990;
      *((_DWORD *)v5 + 23) = 1077516698;
      *((_DWORD *)v5 + 25) = 1114636288;
      *((_DWORD *)v5 + 18) = 1057971241;
      *((_DWORD *)v5 + 13) = 1112014848;
      *((_DWORD *)v5 + 22) = 1108082688;
      *((_DWORD *)v5 + 10) = 1101004800;
      break;
    default:
      switch ( a1 )
      {
        case 24:
          *((_DWORD *)v5 + 27) = 2;
          *((float *)v5 + 5) = *a2;
          v34 = *((_DWORD *)a2 + 1);
          *((_DWORD *)v5 + 36) = 2;
          *((_DWORD *)v5 + 15) = 1060320051;
          *((_DWORD *)v5 + 6) = v34;
          *((_DWORD *)v5 + 16) = 1061997773;
          *((_DWORD *)v5 + 9) = 1140457472;
          *((_DWORD *)v5 + 23) = 0x40000000;
          *((_DWORD *)v5 + 17) = 1050589266;
          *((_DWORD *)v5 + 25) = 1142292480;
          *((_DWORD *)v5 + 18) = 1065353216;
          *((_DWORD *)v5 + 13) = 1109393408;
          *((_DWORD *)v5 + 22) = 1109393408;
          *((float *)v5 + 5) = *a2;
          *((float *)v5 + 6) = a2[1];
          *((_DWORD *)v5 + 10) = 1140457472;
          for ( i1 = 0; i1 > -576; i1 -= 64 )
          {
            for ( i2 = 128; i2 <= 256; i2 += 64 )
            {
              v35 = creature_alloc_slot();
              creature_target_offset_y[38 * v35] = (float)i2;
              v5 = (char *)(152 * v35 + 4833080);
              *((_DWORD *)v5 + 36) = 3;
              *((_DWORD *)v5 + 11) = 0;
              *((_DWORD *)v5 + 37) = 0;
              *((_DWORD *)v5 + 30) = v3;
              v113 = (float)i1;
              *((float *)v5 + 31) = v113;
              v123 = creature_target_offset_x[38 * v35] + *a2;
              v36 = creature_target_offset_y[38 * v35] + a2[1];
              *((_DWORD *)v5 + 7) = 0;
              *((float *)v5 + 5) = v123;
              v131 = v36;
              *((_DWORD *)v5 + 8) = 0;
              *((float *)v5 + 6) = v131;
              *((_DWORD *)v5 + 9) = 1132593152;
              *((_DWORD *)v5 + 10) = 1132593152;
              *((_DWORD *)v5 + 15) = 1060529766;
              *((_DWORD *)v5 + 16) = 1054028596;
              v5[9] = 0;
              *((_DWORD *)v5 + 17) = 1049498747;
              *((_DWORD *)v5 + 3) = 0;
              *v5 = 1;
              v5[8] = 1;
              *((_DWORD *)v5 + 4) = 1098907648;
              *((_DWORD *)v5 + 24) = 0;
              *((_DWORD *)v5 + 27) = 2;
              *((_DWORD *)v5 + 23) = 1081291571;
              *((_DWORD *)v5 + 25) = 1114636288;
              *((_DWORD *)v5 + 18) = 1058642330;
              *((_DWORD *)v5 + 13) = 1112014848;
              *((_DWORD *)v5 + 22) = 1108082688;
            }
          }
          goto LABEL_16;
        case 1:
          *((_DWORD *)v5 + 27) = 4;
          *((_DWORD *)v5 + 35) = 8;
          *((_DWORD *)v5 + 13) = 1117782016;
          *((_DWORD *)v5 + 9) = 1137180672;
          *((_DWORD *)v5 + 23) = 0x40000000;
          *((_DWORD *)v5 + 25) = 1148846080;
          *((_DWORD *)v5 + 18) = 1065353216;
          *((_DWORD *)v5 + 15) = 1061997773;
          *((_DWORD *)v5 + 16) = 1060320051;
          *((_DWORD *)v5 + 17) = 1053609165;
          *((_DWORD *)v5 + 22) = 1099431936;
          goto LABEL_17;
        case 10:
          *((_DWORD *)v5 + 27) = 2;
          *((_DWORD *)v5 + 35) = 4;
          v37 = sub_430AD0();
          *((_DWORD *)v5 + 30) = v37;
          v38 = (char **)(24 * v37 + 4739024);
          v38[4] = (char *)0x40000000;
          v38[1] = 0;
          v38[2] = (char *)100;
          v38[3] = (char *)1084227584;
          v38[5] = (char *)50;
          *v38 = v5;
          *((_DWORD *)v5 + 13) = 1113325568;
          *((_DWORD *)v5 + 9) = 1148846080;
          *((_DWORD *)v5 + 23) = 1069547520;
          *((_DWORD *)v5 + 25) = 1161527296;
          *((_DWORD *)v5 + 18) = 1065353216;
          *((_DWORD *)v5 + 15) = 1061997773;
          *((_DWORD *)v5 + 16) = 1060320051;
          *((_DWORD *)v5 + 17) = 1053609165;
          *((_DWORD *)v5 + 22) = 0;
          goto LABEL_16;
        case 11:
          *((_DWORD *)v5 + 27) = 2;
          *((_DWORD *)v5 + 35) = 4;
          v39 = sub_430AD0();
          *((_DWORD *)v5 + 30) = v39;
          v40 = (char **)(24 * v39 + 4739024);
          v40[4] = (char *)0x40000000;
          v40[1] = 0;
          v40[2] = (char *)100;
          v40[3] = (char *)1086324736;
          v40[5] = (char *)60;
          *v40 = v5;
          *((_DWORD *)v5 + 13) = 1115815936;
          *((_DWORD *)v5 + 9) = 1163575296;
          *((_DWORD *)v5 + 23) = 1069547520;
          *((_DWORD *)v5 + 25) = 1167867904;
          *((_DWORD *)v5 + 18) = 1065353216;
          *((_DWORD *)v5 + 15) = 1063675494;
          *((_DWORD *)v5 + 16) = 1036831949;
          *((_DWORD *)v5 + 17) = 1036831949;
          *((_DWORD *)v5 + 22) = 0;
          goto LABEL_16;
        case 16:
          *((_DWORD *)v5 + 27) = 2;
          *((_DWORD *)v5 + 35) = 4;
          v41 = sub_430AD0();
          *((_DWORD *)v5 + 30) = v41;
          v42 = (char **)(24 * v41 + 4739024);
          v42[4] = (char *)1069547520;
          v42[1] = 0;
          v42[2] = (char *)100;
          v42[3] = (char *)1075000115;
          v42[5] = (char *)50;
          *v42 = v5;
          *((_DWORD *)v5 + 13) = 1107296256;
          *((_DWORD *)v5 + 9) = 1112014848;
          *((_DWORD *)v5 + 23) = 1077097267;
          *((_DWORD *)v5 + 25) = 1145569280;
          break;
        case 14:
          *((_DWORD *)v5 + 27) = 2;
          *((_DWORD *)v5 + 35) = 4;
          v43 = sub_430AD0();
          *((_DWORD *)v5 + 30) = v43;
          v147 = 0;
          v44 = (char **)(24 * v43 + 4739024);
          v44[4] = (char *)1069547520;
          v44[1] = 0;
          v44[2] = (char *)64;
          v44[3] = (char *)1065772646;
          v44[5] = (char *)28;
          *v44 = v5;
          *((_DWORD *)v5 + 13) = 1107296256;
          *((_DWORD *)v5 + 9) = 1112014848;
          *((_DWORD *)v5 + 23) = 1077097267;
          *((_DWORD *)v5 + 25) = 1167867904;
          *((_DWORD *)v5 + 18) = 1065353216;
          *((_DWORD *)v5 + 15) = 1063675494;
          *((_DWORD *)v5 + 16) = 1061997773;
          *((_DWORD *)v5 + 17) = 1053609165;
          *((_DWORD *)v5 + 22) = 0;
          do
          {
            v45 = (double)v147 * 0.2617994;
            v5 = (char *)(152 * creature_alloc_slot() + 4833080);
            *((_DWORD *)v5 + 36) = 3;
            *((_DWORD *)v5 + 11) = 0;
            *((_DWORD *)v5 + 37) = 0;
            *((_DWORD *)v5 + 30) = v3;
            *((float *)v5 + 31) = cos(v45) * 100.0;
            *((float *)v5 + 32) = sin(v45) * 100.0;
            *((float *)v5 + 5) = *a2;
            *((float *)v5 + 6) = a2[1];
            *((_DWORD *)v5 + 7) = 0;
            *((_DWORD *)v5 + 8) = 0;
            v5[9] = 0;
            *((_DWORD *)v5 + 15) = 1065353216;
            *((_DWORD *)v5 + 9) = 1109393408;
            *((_DWORD *)v5 + 10) = 1109393408;
            *((_DWORD *)v5 + 16) = 1050253722;
            *((_DWORD *)v5 + 17) = 1050253722;
            *((_DWORD *)v5 + 3) = 0;
            *v5 = 1;
            v5[8] = 1;
            *((_DWORD *)v5 + 4) = 1098907648;
            *((_DWORD *)v5 + 24) = 0;
            *((_DWORD *)v5 + 27) = 2;
            *((_DWORD *)v5 + 23) = 1082130432;
            *((_DWORD *)v5 + 25) = 1135542272;
            *((_DWORD *)v5 + 18) = 1065353216;
            *((_DWORD *)v5 + 13) = 1108082688;
            *((_DWORD *)v5 + 22) = 1106247680;
            ++v147;
          }
          while ( v147 < 24 );
          goto LABEL_16;
        case 12:
          *((_DWORD *)v5 + 27) = 2;
          *((_DWORD *)v5 + 35) = 4;
          v46 = sub_430AD0();
          *((_DWORD *)v5 + 30) = v46;
          v47 = (char **)(24 * v46 + 4739024);
          v47[4] = (char *)1069547520;
          v47[1] = 0;
          v47[2] = (char *)100;
          v47[3] = (char *)0x40000000;
          v47[5] = (char *)49;
          *v47 = v5;
          *((_DWORD *)v5 + 13) = 1107296256;
          *((_DWORD *)v5 + 9) = 1112014848;
          *((_DWORD *)v5 + 23) = 1077097267;
          *((_DWORD *)v5 + 25) = 1148846080;
          break;
        case 13:
          *((_DWORD *)v5 + 27) = 2;
          *((_DWORD *)v5 + 35) = 4;
          v48 = sub_430AD0();
          *((_DWORD *)v5 + 30) = v48;
          v49 = (char **)(24 * v48 + 4739024);
          v49[4] = (char *)0x40000000;
          v49[1] = 0;
          v49[2] = (char *)100;
          v49[3] = (char *)1086324736;
          v49[5] = (char *)49;
          *v49 = v5;
          *((_DWORD *)v5 + 13) = 1107296256;
          *((_DWORD *)v5 + 9) = 1112014848;
          *((_DWORD *)v5 + 23) = 1067869798;
          *((_DWORD *)v5 + 25) = 1148846080;
          break;
        default:
          switch ( a1 )
          {
            case 9:
              *((_DWORD *)v5 + 27) = 2;
              *((_DWORD *)v5 + 35) = 4;
              v50 = sub_430AD0();
              *((_DWORD *)v5 + 30) = v50;
              v51 = (char **)(24 * v50 + 4739024);
              v51[4] = (char *)1065353216;
              v51[1] = 0;
              v51[2] = (char *)16;
              v51[3] = (char *)0x40000000;
              v51[5] = (char *)29;
              *v51 = v5;
              *((_DWORD *)v5 + 13) = 1109393408;
              *((_DWORD *)v5 + 9) = 1138819072;
              *((_DWORD *)v5 + 23) = 0x40000000;
              *((_DWORD *)v5 + 25) = 1148846080;
              *((_DWORD *)v5 + 18) = 1065353216;
              *((_DWORD *)v5 + 15) = 1065353216;
              *((_DWORD *)v5 + 16) = 1065353216;
              *((_DWORD *)v5 + 17) = 1065353216;
              *((_DWORD *)v5 + 22) = 0;
              goto LABEL_16;
            case 7:
              *((_DWORD *)v5 + 27) = 2;
              *((_DWORD *)v5 + 35) = 4;
              v52 = sub_430AD0();
              *((_DWORD *)v5 + 30) = v52;
              v53 = (char **)(24 * v52 + 4739024);
              v53[4] = (char *)1065353216;
              v53[1] = 0;
              v53[2] = (char *)100;
              v53[3] = (char *)1074580685;
              break;
            case 8:
              *((_DWORD *)v5 + 27) = 2;
              *((_DWORD *)v5 + 35) = 4;
              v54 = sub_430AD0();
              *((_DWORD *)v5 + 30) = v54;
              v53 = (char **)(24 * v54 + 4739024);
              v53[4] = (char *)1065353216;
              v53[1] = 0;
              v53[2] = (char *)100;
              v53[3] = (char *)1077097267;
              break;
            default:
              switch ( a1 )
              {
                case 26:
                  *((_DWORD *)v5 + 27) = 2;
                  *((_DWORD *)v5 + 13) = 1112014848;
                  *((_DWORD *)v5 + 36) = 1;
                  *((_DWORD *)v5 + 9) = 1112014848;
                  *((_DWORD *)v5 + 23) = 1075419546;
                  *((_DWORD *)v5 + 25) = 1123680256;
                  *((_DWORD *)v5 + 18) = 1065353216;
                  v55 = (double)(crt_rand() % 40);
                  break;
                case 27:
                  *((_DWORD *)v5 + 27) = 3;
                  *((_DWORD *)v5 + 13) = 1112014848;
                  *((_DWORD *)v5 + 36) = 1;
                  *((_DWORD *)v5 + 9) = 1109393408;
                  *((_DWORD *)v5 + 23) = 1075419546;
                  *((_DWORD *)v5 + 25) = 1123680256;
                  *((_DWORD *)v5 + 18) = 1065353216;
                  v55 = (double)(crt_rand() % 40);
                  break;
                case 28:
                  *((_DWORD *)v5 + 27) = 1;
                  *((_DWORD *)v5 + 13) = 1112014848;
                  *((_DWORD *)v5 + 36) = 1;
                  *((_DWORD *)v5 + 9) = 1112014848;
                  *((_DWORD *)v5 + 23) = 1075419546;
                  *((_DWORD *)v5 + 25) = 1123680256;
                  *((_DWORD *)v5 + 18) = 1065353216;
                  v55 = (double)(crt_rand() % 40);
                  break;
                default:
                  switch ( a1 )
                  {
                    case 'A':
                      *((_DWORD *)v5 + 27) = 0;
                      v57 = crt_rand();
                      *((_DWORD *)v5 + 18) = 1065353216;
                      v58 = (double)(v57 % 30 + 40);
                      *((float *)v5 + 13) = v58;
                      *((float *)v5 + 9) = v58 * 1.1428572 + 10.0;
                      *((float *)v5 + 23) = v58 * 0.0024999999 + 0.89999998;
                      *((float *)v5 + 25) = v58 + v58 + 50.0;
                      v59 = (double)(crt_rand() % 40) * 0.0099999998 + 0.60000002;
                      *((float *)v5 + 15) = v59;
                      *((float *)v5 + 16) = v59;
                      *((float *)v5 + 17) = v59;
                      *((float *)v5 + 22) = (double)(crt_rand() % 10) + 4.0;
                      goto LABEL_16;
                    case '1':
                      *((_DWORD *)v5 + 27) = 1;
                      v60 = (double)(crt_rand() % 30 + 40);
                      *((float *)v5 + 13) = v60;
                      *((float *)v5 + 9) = v60 * 1.1428572 + 10.0;
                      v61 = crt_rand();
                      *((_DWORD *)v5 + 18) = 1065353216;
                      *((float *)v5 + 23) = (double)(v61 % 18) * 0.1 + 1.1;
                      *((float *)v5 + 25) = *((float *)v5 + 13) + *((float *)v5 + 13) + 50.0;
                      v62 = crt_rand();
                      *((_DWORD *)v5 + 17) = 1052938076;
                      v63 = (double)(v62 % 30) * 0.0099999998 + 0.60000002;
                      *((float *)v5 + 15) = v63;
                      *((float *)v5 + 16) = v63;
                      break;
                    case '2':
                      *((_DWORD *)v5 + 27) = 3;
                      v64 = (double)(crt_rand() % 25 + 40);
                      *((float *)v5 + 13) = v64;
                      *((float *)v5 + 9) = v64 + 10.0;
                      v65 = crt_rand();
                      *((_DWORD *)v5 + 18) = 1065353216;
                      *((float *)v5 + 23) = (double)(v65 % 17) * 0.1 + 1.1;
                      *((float *)v5 + 25) = *((float *)v5 + 13) + *((float *)v5 + 13) + 50.0;
                      v66 = (double)(crt_rand() % 40) * 0.0099999998 + 0.60000002;
                      *((float *)v5 + 15) = v66;
                      *((float *)v5 + 16) = v66;
                      *((float *)v5 + 17) = v66;
                      break;
                    default:
                      switch ( a1 )
                      {
                        case 51:
                          *((_DWORD *)v5 + 27) = 3;
                          v67 = (double)(crt_rand() % 15 + 45);
                          *((float *)v5 + 13) = v67;
                          *((float *)v5 + 9) = v67 * 1.1428572 + 20.0;
                          v68 = crt_rand();
                          *((_DWORD *)v5 + 18) = 1065353216;
                          *((float *)v5 + 23) = (double)(v68 % 18) * 0.1 + 1.1;
                          *((float *)v5 + 25) = *((float *)v5 + 13) + *((float *)v5 + 13) + 50.0;
                          v69 = crt_rand();
                          *((_DWORD *)v5 + 16) = 1056964608;
                          *((_DWORD *)v5 + 17) = 1056964608;
                          *((float *)v5 + 15) = (double)(v69 % 40) * 0.0099999998 + 0.60000002;
                          *((float *)v5 + 22) = (double)(crt_rand() % 10) + 4.0;
                          goto LABEL_16;
                        case 52:
                          *((_DWORD *)v5 + 27) = 3;
                          v70 = (double)(crt_rand() % 20 + 40);
                          *((float *)v5 + 13) = v70;
                          *((float *)v5 + 9) = v70 * 1.1428572 + 20.0;
                          v71 = crt_rand();
                          *((_DWORD *)v5 + 18) = 1065353216;
                          *((float *)v5 + 23) = (double)(v71 % 18) * 0.1 + 1.1;
                          *((float *)v5 + 25) = *((float *)v5 + 13) + *((float *)v5 + 13) + 50.0;
                          v72 = crt_rand();
                          *((_DWORD *)v5 + 15) = 1056964608;
                          *((_DWORD *)v5 + 17) = 1056964608;
                          *((float *)v5 + 16) = (double)(v72 % 40) * 0.0099999998 + 0.60000002;
                          *((float *)v5 + 22) = (double)(crt_rand() % 10) + 4.0;
                          goto LABEL_16;
                        case 32:
                          *((_DWORD *)v5 + 27) = 2;
                          v73 = (double)(crt_rand() % 30 + 40);
                          *((float *)v5 + 13) = v73;
                          *((float *)v5 + 9) = v73 * 1.1428572 + 20.0;
                          v74 = crt_rand();
                          *((_DWORD *)v5 + 18) = 1065353216;
                          *((_DWORD *)v5 + 15) = 1050253722;
                          *((float *)v5 + 23) = (double)(v74 % 18) * 0.1 + 1.1;
                          *((float *)v5 + 25) = *((float *)v5 + 13) + *((float *)v5 + 13) + 50.0;
                          v75 = crt_rand();
                          *((_DWORD *)v5 + 17) = 1050253722;
                          *((float *)v5 + 16) = (double)(v75 % 40) * 0.0099999998 + 0.60000002;
                          *((float *)v5 + 22) = (double)(crt_rand() % 10) + 4.0;
                          goto LABEL_16;
                        case 3:
                          *((_DWORD *)v5 + 27) = 3;
                          v76 = (double)(crt_rand() % 15 + 38);
                          *((float *)v5 + 13) = v76;
                          *((float *)v5 + 9) = v76 * 1.1428572 + 20.0;
                          v77 = crt_rand();
                          *((_DWORD *)v5 + 18) = 1065353216;
                          *((_DWORD *)v5 + 15) = 1058642330;
                          *((_DWORD *)v5 + 16) = 1058642330;
                          *((float *)v5 + 23) = (double)(v77 % 18) * 0.1 + 1.1;
                          *((float *)v5 + 25) = *((float *)v5 + 13) + *((float *)v5 + 13) + 50.0;
                          *((float *)v5 + 17) = (double)(crt_rand() % 25) * 0.0099999998 + 0.80000001;
                          if ( *((float *)v5 + 15) >= 0.0 )
                          {
                            if ( *((float *)v5 + 15) > 1.0 )
                              *((_DWORD *)v5 + 15) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 15) = 0;
                          }
                          if ( *((float *)v5 + 16) >= 0.0 )
                          {
                            if ( *((float *)v5 + 16) > 1.0 )
                              *((_DWORD *)v5 + 16) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 16) = 0;
                          }
                          if ( *((float *)v5 + 17) >= 0.0 )
                          {
                            if ( *((float *)v5 + 17) > 1.0 )
                              *((_DWORD *)v5 + 17) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 17) = 0;
                          }
                          if ( *((float *)v5 + 18) >= 0.0 )
                          {
                            if ( *((float *)v5 + 18) > 1.0 )
                              *((_DWORD *)v5 + 18) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 18) = 0;
                          }
                          break;
                        case 5:
                          *((_DWORD *)v5 + 27) = 4;
                          v78 = (double)(crt_rand() % 15 + 38);
                          *((float *)v5 + 13) = v78;
                          *((float *)v5 + 9) = v78 * 1.1428572 + 20.0;
                          v79 = crt_rand();
                          *((_DWORD *)v5 + 18) = 1065353216;
                          *((_DWORD *)v5 + 15) = 1058642330;
                          *((_DWORD *)v5 + 16) = 1058642330;
                          *((float *)v5 + 23) = (double)(v79 % 18) * 0.1 + 1.1;
                          *((float *)v5 + 25) = *((float *)v5 + 13) + *((float *)v5 + 13) + 50.0;
                          *((float *)v5 + 17) = (double)(crt_rand() % 25) * 0.0099999998 + 0.80000001;
                          if ( *((float *)v5 + 15) >= 0.0 )
                          {
                            if ( *((float *)v5 + 15) > 1.0 )
                              *((_DWORD *)v5 + 15) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 15) = 0;
                          }
                          if ( *((float *)v5 + 16) >= 0.0 )
                          {
                            if ( *((float *)v5 + 16) > 1.0 )
                              *((_DWORD *)v5 + 16) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 16) = 0;
                          }
                          if ( *((float *)v5 + 17) >= 0.0 )
                          {
                            if ( *((float *)v5 + 17) > 1.0 )
                              *((_DWORD *)v5 + 17) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 17) = 0;
                          }
                          if ( *((float *)v5 + 18) >= 0.0 )
                          {
                            if ( *((float *)v5 + 18) > 1.0 )
                              *((_DWORD *)v5 + 18) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 18) = 0;
                          }
                          break;
                        case 4:
                          *((_DWORD *)v5 + 27) = 1;
                          v80 = (double)(crt_rand() % 15 + 38);
                          *((float *)v5 + 13) = v80;
                          *((float *)v5 + 9) = v80 * 1.1428572 + 20.0;
                          v81 = crt_rand();
                          *((_DWORD *)v5 + 18) = 1065353216;
                          *((_DWORD *)v5 + 15) = 1059816735;
                          *((_DWORD *)v5 + 16) = 1059816735;
                          *((_DWORD *)v5 + 17) = 1065353216;
                          *((float *)v5 + 23) = (double)(v81 % 18) * 0.1 + 1.1;
                          *((float *)v5 + 25) = *((float *)v5 + 13) + *((float *)v5 + 13) + 50.0;
                          *((float *)v5 + 22) = (double)(crt_rand() % 10) + 4.0;
                          goto LABEL_16;
                        case 6:
                          *((_DWORD *)v5 + 27) = 2;
                          v82 = (double)(crt_rand() % 15 + 38);
                          *((float *)v5 + 13) = v82;
                          *((float *)v5 + 9) = v82 * 1.1428572 + 20.0;
                          v83 = crt_rand();
                          *((_DWORD *)v5 + 18) = 1065353216;
                          *((_DWORD *)v5 + 15) = 1058642330;
                          *((_DWORD *)v5 + 16) = 1058642330;
                          *((float *)v5 + 23) = (double)(v83 % 18) * 0.1 + 1.1;
                          *((float *)v5 + 25) = *((float *)v5 + 13) + *((float *)v5 + 13) + 50.0;
                          *((float *)v5 + 17) = (double)(crt_rand() % 25) * 0.0099999998 + 0.80000001;
                          if ( *((float *)v5 + 15) >= 0.0 )
                          {
                            if ( *((float *)v5 + 15) > 1.0 )
                              *((_DWORD *)v5 + 15) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 15) = 0;
                          }
                          if ( *((float *)v5 + 16) >= 0.0 )
                          {
                            if ( *((float *)v5 + 16) > 1.0 )
                              *((_DWORD *)v5 + 16) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 16) = 0;
                          }
                          if ( *((float *)v5 + 17) >= 0.0 )
                          {
                            if ( *((float *)v5 + 17) > 1.0 )
                              *((_DWORD *)v5 + 17) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 17) = 0;
                          }
                          if ( *((float *)v5 + 18) >= 0.0 )
                          {
                            if ( *((float *)v5 + 18) > 1.0 )
                              *((_DWORD *)v5 + 18) = 1065353216;
                          }
                          else
                          {
                            *((_DWORD *)v5 + 18) = 0;
                          }
                          break;
                        default:
                          switch ( a1 )
                          {
                            case 53:
                              *((_DWORD *)v5 + 27) = 4;
                              v84 = (double)(crt_rand() % 10 + 30);
                              *((float *)v5 + 13) = v84;
                              *((float *)v5 + 9) = v84 * 1.1428572 + 20.0;
                              v85 = crt_rand();
                              *((_DWORD *)v5 + 18) = 1065353216;
                              *((_DWORD *)v5 + 17) = 1061997773;
                              *((float *)v5 + 23) = (double)(v85 % 18) * 0.1 + 1.1;
                              *((float *)v5 + 25) = *((float *)v5 + 13) + *((float *)v5 + 13) + 50.0;
                              v86 = crt_rand();
                              *((_DWORD *)v5 + 15) = 1061997773;
                              *((float *)v5 + 16) = (double)(v86 % 20) * 0.0099999998 + 0.80000001;
                              *((float *)v5 + 22) = (double)(crt_rand() % 10) + 4.0;
                              goto LABEL_16;
                            case 46:
                              *((_DWORD *)v5 + 27) = 1;
                              v87 = (double)(crt_rand() % 30 + 40);
                              *((float *)v5 + 13) = v87;
                              *((float *)v5 + 9) = v87 * 1.1428572 + 20.0;
                              v88 = crt_rand();
                              *((_DWORD *)v5 + 18) = 1065353216;
                              *((float *)v5 + 23) = (double)(v88 % 18) * 0.1 + 1.1;
                              *((float *)v5 + 25) = *((float *)v5 + 13) + *((float *)v5 + 13) + 50.0;
                              *((float *)v5 + 15) = (double)(crt_rand() % 40) * 0.0099999998 + 0.60000002;
                              *((float *)v5 + 16) = (double)(crt_rand() % 40) * 0.0099999998 + 0.60000002;
                              *((float *)v5 + 17) = (double)(crt_rand() % 40) * 0.0099999998 + 0.60000002;
                              *((float *)v5 + 22) = (double)(crt_rand() % 10) + 4.0;
                              goto LABEL_16;
                            case 54:
                              *((_DWORD *)v5 + 27) = 2;
                              *((_DWORD *)v5 + 13) = 1112014848;
                              *((_DWORD *)v5 + 36) = 7;
                              *((_DWORD *)v5 + 34) = 1069547520;
                              *((_DWORD *)v5 + 9) = 1092616192;
                              *((_DWORD *)v5 + 23) = 1072064102;
                              *((_DWORD *)v5 + 25) = 1125515264;
                              *((_DWORD *)v5 + 18) = 1065353216;
                              *((float *)v5 + 16) = (double)(crt_rand() % 5) * 0.0099999998 + 0.64999998;
                              *((_DWORD *)v5 + 15) = 1059481190;
                              *((_DWORD *)v5 + 17) = 1064514355;
                              *((_DWORD *)v5 + 22) = 1109393408;
                              goto LABEL_16;
                            case 29:
                              *((_DWORD *)v5 + 27) = 2;
                              v89 = (double)(crt_rand() % 20 + 35);
                              *((float *)v5 + 13) = v89;
                              *((float *)v5 + 9) = v89 * 1.1428572 + 10.0;
                              *((float *)v5 + 23) = (double)(crt_rand() % 15) * 0.1 + 1.1;
                              *((float *)v5 + 25) = (float)(crt_rand() % 100 + 50);
                              *((_DWORD *)v5 + 18) = 1065353216;
                              *((float *)v5 + 15) = (double)(crt_rand() % 50) * 0.001 + 0.60000002;
                              *((float *)v5 + 16) = (double)(crt_rand() % 50) * 0.0099999998 + 0.5;
                              *((float *)v5 + 17) = (double)(crt_rand() % 50) * 0.001 + 0.60000002;
                              *((float *)v5 + 22) = (double)(crt_rand() % 10) + 4.0;
                              goto LABEL_16;
                            case 30:
                              *((_DWORD *)v5 + 27) = 2;
                              v90 = (double)(crt_rand() % 30 + 35);
                              *((float *)v5 + 13) = v90;
                              *((float *)v5 + 9) = v90 * 2.2857144 + 10.0;
                              *((float *)v5 + 23) = (double)(crt_rand() % 17) * 0.1 + 1.5;
                              *((float *)v5 + 25) = (float)(crt_rand() % 200 + 50);
                              *((_DWORD *)v5 + 18) = 1065353216;
                              *((float *)v5 + 15) = (double)(crt_rand() % 50) * 0.001 + 0.60000002;
                              *((float *)v5 + 16) = (double)(crt_rand() % 50) * 0.001 + 0.60000002;
                              *((float *)v5 + 17) = (double)(crt_rand() % 50) * 0.0099999998 + 0.5;
                              *((float *)v5 + 22) = (double)(crt_rand() % 30) + 4.0;
                              goto LABEL_16;
                            case 31:
                              *((_DWORD *)v5 + 27) = 2;
                              v91 = (double)(crt_rand() % 30 + 45);
                              *((float *)v5 + 13) = v91;
                              *((float *)v5 + 9) = v91 * 3.7142856 + 30.0;
                              *((float *)v5 + 23) = (double)(crt_rand() % 21) * 0.1 + 1.6;
                              *((float *)v5 + 25) = (float)(crt_rand() % 200 + 80);
                              *((_DWORD *)v5 + 18) = 1065353216;
                              *((float *)v5 + 15) = (double)(crt_rand() % 50) * 0.0099999998 + 0.5;
                              *((float *)v5 + 16) = (double)(crt_rand() % 50) * 0.001 + 0.60000002;
                              *((float *)v5 + 17) = (double)(crt_rand() % 50) * 0.001 + 0.60000002;
                              *((float *)v5 + 22) = (double)(crt_rand() % 35) + 8.0;
                              goto LABEL_16;
                            case 36:
                              *((_DWORD *)v5 + 27) = 2;
                              *((_DWORD *)v5 + 9) = 1101004800;
                              *((_DWORD *)v5 + 23) = 0x40000000;
                              *((_DWORD *)v5 + 25) = 1121714176;
                              *((_DWORD *)v5 + 15) = 1036831949;
                              *((_DWORD *)v5 + 16) = 1060320051;
                              *((_DWORD *)v5 + 17) = 1038174126;
                              *((_DWORD *)v5 + 18) = 1065353216;
                              *((_DWORD *)v5 + 13) = 1112014848;
                              *((_DWORD *)v5 + 22) = 1082130432;
                              goto LABEL_17;
                            case 37:
                              *((_DWORD *)v5 + 27) = 2;
                              *((_DWORD *)v5 + 9) = 1103626240;
                              *((_DWORD *)v5 + 23) = 1075838976;
                              *((_DWORD *)v5 + 25) = 1123680256;
                              *((_DWORD *)v5 + 15) = 1036831949;
                              *((_DWORD *)v5 + 16) = 1061997773;
                              *((_DWORD *)v5 + 17) = 1038174126;
                              *((_DWORD *)v5 + 18) = 1065353216;
                              *((_DWORD *)v5 + 13) = 1106247680;
                              *((_DWORD *)v5 + 22) = 1077936128;
                              goto LABEL_17;
                            case 38:
                              *((_DWORD *)v5 + 27) = 2;
                              *((_DWORD *)v5 + 9) = 1112014848;
                              *((_DWORD *)v5 + 23) = 1074580685;
                              *((_DWORD *)v5 + 25) = 1123680256;
                              *((_DWORD *)v5 + 15) = 1058642330;
                              *((_DWORD *)v5 + 16) = 1061997773;
                              *((_DWORD *)v5 + 17) = 1058642330;
                              *((_DWORD *)v5 + 18) = 1065353216;
                              *((_DWORD *)v5 + 13) = 1110704128;
                              *((_DWORD *)v5 + 22) = 1092616192;
                              goto LABEL_17;
                            case 39:
                              *((_DWORD *)v5 + 27) = 2;
                              *((_DWORD *)v5 + 9) = 1112014848;
                              *((_DWORD *)v5 + 23) = 1074161254;
                              *((_DWORD *)v5 + 35) = 1024;
                              *((_DWORD *)v5 + 25) = 1123680256;
                              *((_DWORD *)v5 + 15) = 1065353216;
                              *((_DWORD *)v5 + 16) = 1061997773;
                              *((_DWORD *)v5 + 17) = 1036831949;
                              *((_DWORD *)v5 + 18) = 1065353216;
                              *((_WORD *)v5 + 60) = 3;
                              *((_WORD *)v5 + 61) = 5;
                              *((_DWORD *)v5 + 13) = 1110704128;
                              *((_DWORD *)v5 + 22) = 1092616192;
                              goto LABEL_17;
                            case 33:
                              *((_DWORD *)v5 + 27) = 2;
                              *((_DWORD *)v5 + 9) = 1112801280;
                              v92 = v5 + 60;
                              *((_DWORD *)v5 + 23) = 1071225242;
                              *((_DWORD *)v5 + 25) = 1123024896;
                              *((_DWORD *)v5 + 15) = 1060320051;
                              *((_DWORD *)v5 + 16) = 1036831949;
                              *((_DWORD *)v5 + 17) = 1057132380;
                              v93 = 1056964608;
                              break;
                            case 34:
                              *((_DWORD *)v5 + 27) = 2;
                              *((_DWORD *)v5 + 9) = 1103626240;
                              *((_DWORD *)v5 + 23) = 1071225242;
                              *((_DWORD *)v5 + 25) = 1125515264;
                              *((_DWORD *)v5 + 15) = 1036831949;
                              *((_DWORD *)v5 + 16) = 1060320051;
                              *((_DWORD *)v5 + 17) = 1057132380;
                              *((_DWORD *)v5 + 18) = 1028443341;
                              *((_DWORD *)v5 + 13) = 1112014848;
                              *((_DWORD *)v5 + 22) = 1090519040;
                              goto LABEL_17;
                            case 35:
                              *((_DWORD *)v5 + 27) = 2;
                              *((_DWORD *)v5 + 9) = 1084227584;
                              *((_DWORD *)v5 + 23) = 1071225242;
                              *((_DWORD *)v5 + 25) = 1127481344;
                              *((_DWORD *)v5 + 15) = 1036831949;
                              *((_DWORD *)v5 + 16) = 1060320051;
                              *((_DWORD *)v5 + 17) = 1057132380;
                              *((_DWORD *)v5 + 18) = 1025758986;
                              *((_DWORD *)v5 + 13) = 1110704128;
                              *((_DWORD *)v5 + 22) = 1090519040;
                              goto LABEL_17;
                            case 40:
                              *((_DWORD *)v5 + 27) = 2;
                              *((_DWORD *)v5 + 9) = 1112014848;
                              v92 = v5 + 60;
                              *((_DWORD *)v5 + 23) = 1071225242;
                              *((_DWORD *)v5 + 25) = 1125515264;
                              *((_DWORD *)v5 + 15) = 1060320051;
                              *((_DWORD *)v5 + 16) = 1036831949;
                              *((_DWORD *)v5 + 17) = 1057132380;
                              v93 = 1065353216;
                              break;
                            default:
                              switch ( a1 )
                              {
                                case 41:
                                  *((_DWORD *)v5 + 27) = 2;
                                  *((_DWORD *)v5 + 9) = 1145569280;
                                  *((_DWORD *)v5 + 23) = 1075838976;
                                  *((_DWORD *)v5 + 25) = 1138819072;
                                  *((_DWORD *)v5 + 15) = 1061997773;
                                  *((_DWORD *)v5 + 16) = 1061997773;
                                  *((_DWORD *)v5 + 17) = 1061997773;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1116471296;
                                  *((_DWORD *)v5 + 22) = 1101004800;
                                  goto LABEL_17;
                                case 42:
                                  *((_DWORD *)v5 + 27) = 2;
                                  *((_DWORD *)v5 + 9) = 1112014848;
                                  *((_DWORD *)v5 + 23) = 1078355558;
                                  *((_DWORD *)v5 + 25) = 1133903872;
                                  *((_DWORD *)v5 + 15) = 1050253722;
                                  *((_DWORD *)v5 + 16) = 1050253722;
                                  *((_DWORD *)v5 + 17) = 1050253722;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1114636288;
                                  *((_DWORD *)v5 + 22) = 1090519040;
                                  goto LABEL_17;
                                case 43:
                                  *((_DWORD *)v5 + 27) = 2;
                                  *((_DWORD *)v5 + 9) = 1106247680;
                                  v94 = v5 + 60;
                                  *((_DWORD *)v5 + 23) = 1080452710;
                                  *((_DWORD *)v5 + 25) = 1138819072;
                                  *((_DWORD *)v5 + 15) = 1065353216;
                                  *((_DWORD *)v5 + 16) = 1050253722;
                                  *((_DWORD *)v5 + 17) = 1050253722;
                                  break;
                                case 44:
                                  *((_DWORD *)v5 + 27) = 2;
                                  *((_DWORD *)v5 + 9) = 1164804096;
                                  *((_DWORD *)v5 + 23) = 0x40000000;
                                  *((_DWORD *)v5 + 25) = 1153138688;
                                  *((_DWORD *)v5 + 15) = 1062836634;
                                  *((_DWORD *)v5 + 16) = 1045220557;
                                  *((_DWORD *)v5 + 17) = 1045220557;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1117782016;
                                  *((_DWORD *)v5 + 22) = 1109393408;
                                  goto LABEL_17;
                                case 45:
                                  *((_DWORD *)v5 + 27) = 2;
                                  *((_DWORD *)v5 + 9) = 1110704128;
                                  *((_DWORD *)v5 + 23) = 1078355558;
                                  *((_DWORD *)v5 + 25) = 1128792064;
                                  *((_DWORD *)v5 + 15) = 0;
                                  *((_DWORD *)v5 + 16) = 1063675494;
                                  *((_DWORD *)v5 + 17) = 1061997773;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1108869120;
                                  *((_DWORD *)v5 + 22) = 1077936128;
                                  *((_DWORD *)v5 + 36) = 2;
                                  goto LABEL_17;
                                case 47:
                                  *((_DWORD *)v5 + 27) = 1;
                                  *((_DWORD *)v5 + 9) = 1101004800;
                                  *((_DWORD *)v5 + 23) = 1075838976;
                                  *((_DWORD *)v5 + 25) = 1125515264;
                                  *((_DWORD *)v5 + 15) = 1061997773;
                                  *((_DWORD *)v5 + 16) = 1061997773;
                                  *((_DWORD *)v5 + 17) = 1061997773;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1110704128;
                                  *((_DWORD *)v5 + 22) = 1082130432;
                                  goto LABEL_17;
                                case 48:
                                  *((_DWORD *)v5 + 27) = 1;
                                  *((_DWORD *)v5 + 9) = 1148846080;
                                  *((_DWORD *)v5 + 23) = 0x40000000;
                                  *((_DWORD *)v5 + 25) = 1137180672;
                                  *((_DWORD *)v5 + 15) = 1063675494;
                                  *((_DWORD *)v5 + 16) = 1061997773;
                                  *((_DWORD *)v5 + 17) = 1036831949;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1115815936;
                                  *((_DWORD *)v5 + 22) = 1092616192;
                                  goto LABEL_17;
                                case 59:
                                  *((_DWORD *)v5 + 27) = 3;
                                  *((_DWORD *)v5 + 9) = 1150681088;
                                  *((_DWORD *)v5 + 23) = 0x40000000;
                                  *((_DWORD *)v5 + 25) = 1165623296;
                                  *((_DWORD *)v5 + 15) = 1063675494;
                                  *((_DWORD *)v5 + 16) = 0;
                                  *((_DWORD *)v5 + 17) = 0;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1116471296;
                                  *((_DWORD *)v5 + 22) = 1101004800;
                                  goto LABEL_17;
                                case 60:
                                  *((_DWORD *)v5 + 27) = 3;
                                  *((_DWORD *)v5 + 35) = 256;
                                  *((_DWORD *)v5 + 33) = 1053609165;
                                  *((_DWORD *)v5 + 34) = 26;
                                  *((_DWORD *)v5 + 9) = 1128792064;
                                  *((_DWORD *)v5 + 23) = 0x40000000;
                                  *((_DWORD *)v5 + 25) = 1128792064;
                                  *((_DWORD *)v5 + 15) = 1063675494;
                                  *((_DWORD *)v5 + 16) = 1036831949;
                                  *((_DWORD *)v5 + 17) = 1036831949;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1109393408;
                                  *((_DWORD *)v5 + 22) = 1101004800;
                                  *((_DWORD *)v5 + 36) = 2;
                                  goto LABEL_17;
                                case 61:
                                  *((_DWORD *)v5 + 27) = 3;
                                  *((_DWORD *)v5 + 9) = 1116471296;
                                  *((_DWORD *)v5 + 23) = 1076258406;
                                  *((_DWORD *)v5 + 25) = 1123024896;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  v95 = (double)(crt_rand() % 20) * 0.0099999998 + 0.80000001;
                                  *((float *)v5 + 15) = v95;
                                  *((float *)v5 + 17) = v95;
                                  *((float *)v5 + 16) = v95;
                                  v96 = (double)(crt_rand() % 7 + 45);
                                  *((float *)v5 + 13) = v96;
                                  *((float *)v5 + 22) = v96 * 0.22;
                                  goto LABEL_16;
                                case 62:
                                  *((_DWORD *)v5 + 27) = 3;
                                  *((_DWORD *)v5 + 9) = 1148846080;
                                  *((_DWORD *)v5 + 23) = 1077097267;
                                  *((_DWORD *)v5 + 25) = 1140457472;
                                  *((_DWORD *)v5 + 15) = 1065353216;
                                  *((_DWORD *)v5 + 16) = 1065353216;
                                  *((_DWORD *)v5 + 17) = 1065353216;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1115684864;
                                  *((_DWORD *)v5 + 22) = 1109393408;
                                  goto LABEL_17;
                                case 0:
                                  *((_DWORD *)v5 + 27) = 0;
                                  *((_DWORD *)v5 + 35) = 68;
                                  *((_DWORD *)v5 + 9) = 1174720512;
                                  *((_DWORD *)v5 + 23) = 1067869798;
                                  *((_DWORD *)v5 + 25) = 1171144704;
                                  *((_DWORD *)v5 + 15) = 1058642330;
                                  *((_DWORD *)v5 + 16) = 1058642330;
                                  *((_DWORD *)v5 + 17) = 1065353216;
                                  *((_DWORD *)v5 + 18) = 1061997773;
                                  *((_DWORD *)v5 + 13) = 1115684864;
                                  *((_DWORD *)v5 + 22) = 1112014848;
                                  v97 = sub_430AD0();
                                  *((_DWORD *)v5 + 30) = v97;
                                  v98 = (char **)(24 * v97 + 4739024);
                                  v98[4] = (char *)1065353216;
                                  v98[1] = 0;
                                  v98[2] = (char *)812;
                                  v98[3] = (char *)1060320051;
                                  v98[5] = (char *)65;
                                  *v98 = v5;
                                  goto LABEL_16;
                                case 56:
                                  *((_DWORD *)v5 + 27) = 3;
                                  *((_DWORD *)v5 + 35) = 128;
                                  *((_DWORD *)v5 + 30) = 0;
                                  *((_DWORD *)v5 + 9) = 1112014848;
                                  *((_DWORD *)v5 + 23) = 1083808154;
                                  *((_DWORD *)v5 + 25) = 1138262016;
                                  *((_DWORD *)v5 + 15) = 1065353216;
                                  *((_DWORD *)v5 + 16) = 1061158912;
                                  *((_DWORD *)v5 + 17) = 1036831949;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((float *)v5 + 13) = (float)(crt_rand() % 4 + 41);
                                  *((_DWORD *)v5 + 22) = 1092616192;
                                  goto LABEL_16;
                                case 55:
                                  *((_DWORD *)v5 + 27) = 4;
                                  *((_DWORD *)v5 + 35) = 256;
                                  *((_DWORD *)v5 + 30) = 0;
                                  *((_DWORD *)v5 + 9) = 1112014848;
                                  *((_DWORD *)v5 + 23) = 1078774989;
                                  *((_DWORD *)v5 + 25) = 1138262016;
                                  *((_DWORD *)v5 + 15) = 1065353216;
                                  *((_DWORD *)v5 + 16) = 1061158912;
                                  *((_DWORD *)v5 + 17) = 1036831949;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((float *)v5 + 13) = (float)(crt_rand() % 4 + 41);
                                  *((_DWORD *)v5 + 22) = 1092616192;
                                  goto LABEL_16;
                                case 57:
                                  *((_DWORD *)v5 + 27) = 3;
                                  *((_DWORD *)v5 + 35) = 128;
                                  *((_DWORD *)v5 + 30) = 0;
                                  *((_DWORD *)v5 + 9) = 1082130432;
                                  *((_DWORD *)v5 + 23) = 1083808154;
                                  *((_DWORD *)v5 + 25) = 1112014848;
                                  *((_DWORD *)v5 + 15) = 1061997773;
                                  *((_DWORD *)v5 + 16) = 1059481190;
                                  *((_DWORD *)v5 + 17) = 1036831949;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((float *)v5 + 13) = (float)(crt_rand() % 4 + 26);
                                  *((_DWORD *)v5 + 22) = 1092616192;
                                  goto LABEL_16;
                                case 58:
                                  *((_DWORD *)v5 + 27) = 3;
                                  *((_DWORD *)v5 + 35) = 16;
                                  *((_DWORD *)v5 + 33) = 1063675494;
                                  *((_DWORD *)v5 + 34) = 9;
                                  *((_DWORD *)v5 + 9) = 1166843904;
                                  *((_DWORD *)v5 + 23) = 0x40000000;
                                  *((_DWORD *)v5 + 25) = 1166843904;
                                  *((_DWORD *)v5 + 15) = 1065353216;
                                  *((_DWORD *)v5 + 16) = 1065353216;
                                  *((_DWORD *)v5 + 17) = 1065353216;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1115684864;
                                  *((_DWORD *)v5 + 22) = 1112014848;
                                  goto LABEL_17;
                                case 63:
                                  *((_DWORD *)v5 + 27) = 3;
                                  *((_DWORD *)v5 + 9) = 1128792064;
                                  v94 = v5 + 60;
                                  *((_DWORD *)v5 + 23) = 1075000115;
                                  *((_DWORD *)v5 + 25) = 1129447424;
                                  *((_DWORD *)v5 + 15) = 1060320051;
                                  *((_DWORD *)v5 + 16) = 1053609165;
                                  *((_DWORD *)v5 + 17) = 1036831949;
                                  break;
                                case 64:
                                  *((_DWORD *)v5 + 27) = 3;
                                  *((_DWORD *)v5 + 9) = 1116471296;
                                  *((_DWORD *)v5 + 23) = 1074580685;
                                  *((_DWORD *)v5 + 25) = 1126170624;
                                  *((_DWORD *)v5 + 15) = 1056964608;
                                  *((_DWORD *)v5 + 16) = 1058642330;
                                  *((_DWORD *)v5 + 17) = 1063675494;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1110704128;
                                  *((_DWORD *)v5 + 22) = 1084227584;
                                  goto LABEL_17;
                                case 66:
                                  *((_DWORD *)v5 + 27) = 0;
                                  *((_DWORD *)v5 + 9) = 1128792064;
                                  *((_DWORD *)v5 + 23) = 1071225242;
                                  *((_DWORD *)v5 + 25) = 1126170624;
                                  strcpy(v5 + 60, "fff?fff?fff?");
                                  v5[73] = 0;
                                  *((_WORD *)v5 + 37) = 16256;
                                  *((_DWORD *)v5 + 13) = 1110704128;
                                  *((_DWORD *)v5 + 22) = 1097859072;
                                  goto LABEL_17;
                                case 67:
                                  *((_DWORD *)v5 + 27) = 0;
                                  *((_DWORD *)v5 + 9) = 1157234688;
                                  *((_DWORD *)v5 + 23) = 1074161254;
                                  *((_DWORD *)v5 + 25) = 1139146752;
                                  *((_DWORD *)v5 + 15) = 1045220557;
                                  *((_DWORD *)v5 + 16) = 1058642330;
                                  *((_DWORD *)v5 + 17) = 1036831949;
                                  *((_DWORD *)v5 + 18) = 1065353216;
                                  *((_DWORD *)v5 + 13) = 1116471296;
                                  *((_DWORD *)v5 + 22) = 1097859072;
                                  goto LABEL_16;
                                default:
                                  goto LABEL_15;
                              }
                              *((_DWORD *)v94 + 3) = 1065353216;
                              *((_DWORD *)v5 + 13) = 1108082688;
                              *((_DWORD *)v5 + 22) = 1101004800;
                              goto LABEL_17;
                          }
                          *((_DWORD *)v92 + 3) = v93;
                          *((_DWORD *)v5 + 13) = 1113325568;
                          *((_DWORD *)v5 + 22) = 1090519040;
                          goto LABEL_17;
                      }
                      *((float *)v5 + 22) = (double)(crt_rand() % 10) + 4.0;
                      goto LABEL_16;
                  }
                  *((float *)v5 + 22) = *((float *)v5 + 13) * 0.14 + 4.0;
                  goto LABEL_16;
              }
              v56 = v55 * 0.0099999998 + 0.5;
              *((float *)v5 + 15) = v56;
              *((float *)v5 + 16) = v56;
              *((_DWORD *)v5 + 17) = 1065353216;
              *((_DWORD *)v5 + 22) = 1084227584;
              goto LABEL_16;
          }
          v53[5] = (char *)29;
          *v53 = v5;
          *((_DWORD *)v5 + 13) = 1112014848;
          *((_DWORD *)v5 + 9) = 1148846080;
          *((_DWORD *)v5 + 23) = 0x40000000;
          *((_DWORD *)v5 + 25) = 1161527296;
          *((_DWORD *)v5 + 18) = 1065353216;
          *((_DWORD *)v5 + 15) = 1065353216;
          *((_DWORD *)v5 + 16) = 1065353216;
          *((_DWORD *)v5 + 17) = 1065353216;
          *((_DWORD *)v5 + 22) = 0;
          goto LABEL_16;
      }
      *((_DWORD *)v5 + 18) = 1065353216;
      *((_DWORD *)v5 + 15) = 1063675494;
      *((_DWORD *)v5 + 16) = 1061997773;
      *((_DWORD *)v5 + 17) = 1053609165;
      *((_DWORD *)v5 + 22) = 0;
      goto LABEL_16;
  }
LABEL_15:
  *((_DWORD *)v5 + 27) = 2;
  *((_DWORD *)v5 + 9) = 1101004800;
  console_printf((int)&console_log_queue, aUnhandledCreat);
LABEL_16:
  v9 = a1;
LABEL_17:
  if ( !demo_mode_active
    && *((float *)v5 + 5) > 0.0
    && (double)terrain_texture_width > *((float *)v5 + 5)
    && *((float *)v5 + 6) > 0.0
    && (double)terrain_texture_height > *((float *)v5 + 6) )
  {
    effect_spawn_burst((_DWORD *)v5 + 5, 8);
    v9 = a1;
  }
  *((_DWORD *)v5 + 10) = *((_DWORD *)v5 + 9);
  v17 = *((_DWORD *)v5 + 35);
  if ( (v17 & 0x10) == 0 && *((_DWORD *)v5 + 27) == 3 && (v17 & 0x80u) == 0 )
  {
    LOBYTE(v17) = v17 | 0x80;
    *((_DWORD *)v5 + 35) = v17;
    *((_DWORD *)v5 + 30) = 0;
    *((float *)v5 + 23) = *((float *)v5 + 23) * 1.2;
  }
  if ( v9 == 56 && config_hardcore )
    *((float *)v5 + 23) = *((float *)v5 + 23) * 0.69999999;
  *((float *)v5 + 11) = a3;
  if ( config_hardcore
    || (v5[140] & 4) != 0
    && (creature_spawn_slot_interval[6 * *((_DWORD *)v5 + 30)] = creature_spawn_slot_interval[6 * *((_DWORD *)v5 + 30)]
                                                               + 0.2,
        config_hardcore) )
  {
    dword_487194 = 0;
    *((float *)v5 + 23) = *((float *)v5 + 23) * 1.05;
    *((float *)v5 + 22) = *((float *)v5 + 22) * 1.4;
    *((float *)v5 + 9) = *((float *)v5 + 9) * 1.2;
    if ( (v5[140] & 4) != 0 )
    {
      v18 = *((_DWORD *)v5 + 30);
      v19 = creature_spawn_slot_interval[6 * v18] - 0.2;
      creature_spawn_slot_interval[6 * v18] = v19;
      if ( v19 < 0.1 )
      {
        creature_spawn_slot_interval[6 * v18] = 0.1;
        return v5;
      }
    }
  }
  else if ( dword_487194 > 0 )
  {
    switch ( dword_487194 )
    {
      case 1:
        *((float *)v5 + 25) = *((float *)v5 + 25) * 0.89999998;
        *((float *)v5 + 23) = *((float *)v5 + 23) * 0.94999999;
        *((float *)v5 + 22) = *((float *)v5 + 22) * 0.94999999;
        v99 = *((float *)v5 + 9) * 0.94999999;
        break;
      case 2:
        *((float *)v5 + 25) = *((float *)v5 + 25) * 0.85000002;
        *((float *)v5 + 23) = *((float *)v5 + 23) * 0.89999998;
        *((float *)v5 + 22) = *((float *)v5 + 22) * 0.89999998;
        v99 = *((float *)v5 + 9) * 0.89999998;
        break;
      case 3:
        *((float *)v5 + 25) = *((float *)v5 + 25) * 0.85000002;
        *((float *)v5 + 23) = *((float *)v5 + 23) * 0.80000001;
        *((float *)v5 + 22) = *((float *)v5 + 22) * 0.80000001;
        v99 = *((float *)v5 + 9) * 0.80000001;
        break;
      case 4:
        *((float *)v5 + 25) = *((float *)v5 + 25) * 0.80000001;
        *((float *)v5 + 23) = *((float *)v5 + 23) * 0.69999999;
        *((float *)v5 + 22) = *((float *)v5 + 22) * 0.69999999;
        v99 = *((float *)v5 + 9) * 0.69999999;
        break;
      default:
        *((float *)v5 + 25) = *((float *)v5 + 25) * 0.80000001;
        *((float *)v5 + 23) = *((float *)v5 + 23) * 0.60000002;
        *((float *)v5 + 22) = *((float *)v5 + 22) * 0.5;
        v99 = *((float *)v5 + 9) * 0.5;
        break;
    }
    *((float *)v5 + 9) = v99;
    if ( (v5[140] & 4) != 0 )
    {
      v100 = (double)dword_487194 * 0.34999999;
      if ( v100 > 3.0 )
        v100 = 3.0;
      creature_spawn_slot_interval[6 * *((_DWORD *)v5 + 30)] = v100
                                                             + creature_spawn_slot_interval[6 * *((_DWORD *)v5 + 30)];
    }
  }
  return v5;
}

// quest_spawn_table_empty @ 0x00434220
// returns 1 when the quest spawn table has no pending entries
char sub_434220()
{
  int v0; // eax
  int *i; // ecx

  v0 = quest_spawn_count - 1;
  if ( quest_spawn_count - 1 < 0 )
    return 1;
  for ( i = (int *)(24 * v0 + 4741052); *i <= 0; i -= 6 )
  {
    if ( --v0 < 0 )
      return 1;
  }
  return 0;
}

// quest_spawn_timeline_update @ 0x00434250
// updates quest spawn entries based on the quest timer
void sub_434250()
{
  int v0; // esi
  int v1; // edi
  int v2; // ebx
  int v3; // ebp
  _DWORD *i; // eax
  int j; // esi
  int v6; // edx
  float v7; // [esp-4h] [ebp-30h]
  int v8; // [esp+10h] [ebp-1Ch]
  float v9; // [esp+14h] [ebp-18h]
  float v10; // [esp+18h] [ebp-14h]
  float v11[2]; // [esp+24h] [ebp-8h] BYREF

  if ( creatures_any_active_flag )
    v0 = frame_dt_ms + dword_4C3654;
  else
    v0 = 0;
  v1 = quest_spawn_count;
  v2 = 0;
  v3 = 0;
  dword_4C3654 = v0;
  if ( quest_spawn_count > 0 )
  {
    for ( i = &unk_4857B8;
          (int)i[1] <= 0
       || *i >= quest_spawn_timeline && (!creatures_any_active_flag || v0 <= 3000 || quest_spawn_timeline <= 1700);
          i += 6 )
    {
      if ( ++v3 >= quest_spawn_count )
        return;
    }
    for ( j = 24 * v3 + 4741032; ; j += 24 )
    {
      v9 = 0.0;
      v10 = 0.0;
      if ( *(int *)(j + 20) > 0 )
      {
        v8 = 0;
        do
        {
          if ( *(float *)j < 0.0 || (double)terrain_texture_width < *(float *)j )
          {
            v10 = (float)v8;
            if ( (v2 & 1) != 0 )
              v10 = -v10;
          }
          else
          {
            v9 = (float)v8;
            if ( (v2 & 1) != 0 )
              v9 = -v9;
          }
          v6 = *(_DWORD *)(j + 12);
          v7 = *(float *)(j + 8);
          v11[0] = v9 + *(float *)j;
          v11[1] = v10 + *(float *)(j + 4);
          creature_spawn_template(v6, v11, v7);
          ++v2;
          v8 += 40;
        }
        while ( v2 < *(_DWORD *)(j + 20) );
        v1 = quest_spawn_count;
      }
      v2 = 0;
      *(_DWORD *)(j + 20) = 0;
      creatures_any_active_flag = 0;
      if ( v3 >= v1 - 1 || *(_DWORD *)(j + 16) != *(_DWORD *)(j + 40) )
        break;
      ++v3;
    }
  }
}

// quest_database_advance_slot @ 0x004343C0
// advances quest database tier/index (wraps every 10)
int *__cdecl sub_4343C0(_DWORD *a1, int *a2)
{
  int *result; // eax
  int v3; // ecx
  bool v4; // sf

  result = a2;
  v3 = *a2 + 1;
  v4 = *a2 - 9 < 0;
  *a2 = v3;
  if ( v4 == __OFSUB__(v3, 10) )
  {
    ++*a1;
    *a2 = 0;
  }
  return result;
}

// quest_build_fallback @ 0x004343E0
// fills a default quest spawn table when no quest builder is present
_DWORD *__cdecl sub_4343E0(int a1, _DWORD *a2)
{
  double v2; // st7
  double v3; // st7
  float v5; // [esp+4h] [ebp-4h]
  float v6; // [esp+4h] [ebp-4h]

  console_printf((int)&console_log_queue, aGeneratingAFal);
  v2 = (double)terrain_texture_height * 0.5;
  *(_DWORD *)a1 = -1035468800;
  v5 = v2;
  *(float *)(a1 + 4) = v5;
  *(_DWORD *)(a1 + 12) = 64;
  *(_DWORD *)(a1 + 16) = 500;
  *(_DWORD *)(a1 + 20) = 10;
  v3 = (double)terrain_texture_height;
  *(_DWORD *)(a1 + 24) = -1035468800;
  v6 = v3 * 0.5;
  *(float *)(a1 + 28) = v6;
  *(_DWORD *)(a1 + 36) = 64;
  *(_DWORD *)(a1 + 40) = 5000;
  *(_DWORD *)(a1 + 44) = 20;
  *a2 = 2;
  return a2;
}

// quest_build_nagolipoli @ 0x00434480
// quest builder for Tier 5 Quest 9 (Nagolipoli)
_DWORD *__cdecl sub_434480(int a1, _DWORD *a2)
{
  int v2; // esi
  int v3; // eax
  double v4; // st7
  long double v5; // st7
  int v6; // eax
  int v7; // edx
  int v8; // esi
  int v9; // eax
  double v10; // st7
  long double v11; // st7
  int v12; // ebx
  _DWORD *v13; // ecx
  int i; // edi
  int v15; // eax
  _DWORD *v16; // ecx
  int v18; // ecx
  int v19; // eax
  int v20; // esi
  int v21; // ecx
  int v22; // eax
  int v23; // esi
  int v24; // eax
  double v25; // st7
  _DWORD *v26; // eax
  int v27; // ecx
  int v28; // esi
  int v29; // eax
  _DWORD *v30; // eax
  _DWORD *v31; // eax
  _DWORD *v32; // eax
  int v34; // [esp+10h] [ebp-20h]
  int v35; // [esp+10h] [ebp-20h]
  int v36; // [esp+10h] [ebp-20h]
  int v37; // [esp+10h] [ebp-20h]
  int v38; // [esp+18h] [ebp-18h]
  float v39; // [esp+2Ch] [ebp-4h]
  float v40; // [esp+2Ch] [ebp-4h]
  int v41; // [esp+34h] [ebp+4h]

  v2 = 0;
  v34 = 0;
  v3 = a1 + 4;
  do
  {
    v4 = (double)v34;
    ++v2;
    v3 += 24;
    v34 = v2;
    v5 = v4 * 0.78539819;
    *(float *)(v3 - 28) = cos(v5) * 128.0;
    *(float *)(v3 - 24) = sin(v5) * 128.0;
    *(float *)(v3 - 28) = *(float *)(v3 - 28) + 512.0;
    *(float *)(v3 - 24) = *(float *)(v3 - 24) + 512.0;
    *(_DWORD *)(v3 - 16) = 64;
    *(float *)(v3 - 20) = v5;
    *(_DWORD *)(v3 - 12) = 2000;
    *(_DWORD *)(v3 - 8) = 1;
  }
  while ( v2 < 8 );
  v6 = 3 * v2;
  v7 = 0;
  v35 = 0;
  v8 = v2 + 12;
  v9 = a1 + 8 * v6 + 4;
  do
  {
    v10 = (double)v35;
    v9 += 24;
    v35 = ++v7;
    v11 = v10 * 0.52359879;
    *(float *)(v9 - 28) = cos(v11) * 178.0;
    *(float *)(v9 - 24) = sin(v11) * 178.0;
    *(float *)(v9 - 28) = *(float *)(v9 - 28) + 512.0;
    *(float *)(v9 - 24) = *(float *)(v9 - 24) + 512.0;
    *(_DWORD *)(v9 - 16) = 64;
    *(float *)(v9 - 20) = v11;
    *(_DWORD *)(v9 - 12) = 8000;
    *(_DWORD *)(v9 - 8) = 1;
  }
  while ( v7 < 12 );
  v12 = 0;
  v13 = (_DWORD *)(a1 + 24 * v8);
  for ( i = 13000; i < 38600; i += 800 )
  {
    *v13 = -1031798784;
    v13[1] = -1031798784;
    v13[3] = 28;
    v13[2] = 1065749138;
    v15 = v12 / 8 + 1;
    v13[4] = i;
    v13[5] = v15;
    v16 = v13 + 6;
    *v16 = 1149763584;
    v16[1] = -1031798784;
    v16[3] = 28;
    v16[2] = -1081734510;
    v16[4] = i;
    v16[5] = v15;
    v16 += 6;
    *v16 = -1031798784;
    v16[1] = 1149763584;
    v16[3] = 28;
    v16[2] = -1081734510;
    v16[4] = i;
    v16[5] = v15;
    v16 += 6;
    v8 += 4;
    *v16 = 1149763584;
    v16[1] = 1149763584;
    v16[3] = 28;
    v16[2] = 1081824210;
    v16[4] = i;
    v16[5] = v15;
    v13 = v16 + 6;
    ++v12;
  }
  v36 = 0;
  v18 = 160 * (5 * v12 + 150);
  v19 = a1 + 24 * v8 + 8;
  v20 = v8 + 6;
  do
  {
    *(_DWORD *)(v19 - 8) = 1115684864;
    v19 += 24;
    v39 = (double)v36 * 85.333336 + 256.0;
    *(float *)(v19 - 28) = v39;
    *(_DWORD *)(v19 - 20) = 10;
    *(_DWORD *)(v19 - 24) = 0;
    *(_DWORD *)(v19 - 16) = v18;
    *(_DWORD *)(v19 - 12) = 1;
    v18 += 100;
    ++v36;
  }
  while ( v36 < 6 );
  v21 = 0;
  v37 = 0;
  v38 = 800 * v12;
  v41 = 800 * v12 + 25000;
  v22 = 3 * v20;
  v23 = v20 + 6;
  v24 = a1 + 8 * v22 + 8;
  do
  {
    v25 = (double)v37;
    *(_DWORD *)(v24 - 8) = 1148190720;
    v24 += 24;
    v37 = ++v21;
    v40 = v25 * 85.333336 + 256.0;
    *(float *)(v24 - 28) = v40;
    *(_DWORD *)(v24 - 20) = 10;
    *(_DWORD *)(v24 - 24) = 0;
    *(_DWORD *)(v24 - 16) = v41;
    *(_DWORD *)(v24 - 12) = 1;
    v41 += 100;
  }
  while ( v21 < 6 );
  v26 = (_DWORD *)(a1 + 24 * v23);
  *v26 = 1140850688;
  v26[1] = 1132462080;
  v26[3] = 11;
  v26[2] = 1078530011;
  v27 = 160 * (5 * v12 + 175);
  v28 = v23 + 1;
  v26[4] = v27;
  v26[5] = 1;
  v29 = 3 * v28++;
  v30 = (_DWORD *)(a1 + 8 * v29);
  *v30 = 1140850688;
  v30[1] = 1145044992;
  v30[3] = 11;
  v30[2] = 1078530011;
  v30[4] = v27;
  v30[5] = 1;
  v31 = (_DWORD *)(a1 + 24 * v28);
  *v31 = 1140850688;
  v31[1] = 1149763584;
  v31[3] = 28;
  v31[2] = 1081824210;
  ++v28;
  v31[4] = v38 + 28500;
  v31[5] = 8;
  v32 = (_DWORD *)(a1 + 24 * v28);
  *v32 = 1140850688;
  v32[1] = -1031798784;
  v32[3] = 28;
  v32[2] = 1081824210;
  v32[4] = v38 + 28500;
  v32[5] = 8;
  *a2 = v28 + 1;
  return a2;
}

// quest_build_monster_blues @ 0x00434860
// quest builder for Tier 5 Quest 8 (Monster Blues)
_DWORD *__cdecl sub_434860(int a1, _DWORD *a2)
{
  double v2; // st7
  double v3; // st7
  int v4; // esi
  int v5; // edi
  _DWORD *v6; // ecx
  int v7; // eax
  float v9; // [esp+Ch] [ebp-4h]
  float v10; // [esp+Ch] [ebp-4h]

  v2 = (double)terrain_texture_height * 0.5;
  *(_DWORD *)a1 = -1035468800;
  v9 = v2;
  *(float *)(a1 + 4) = v9;
  *(_DWORD *)(a1 + 12) = 4;
  *(_DWORD *)(a1 + 16) = 500;
  *(_DWORD *)(a1 + 20) = 10;
  v3 = (double)terrain_texture_height;
  *(_DWORD *)(a1 + 24) = 1149648896;
  v10 = v3 * 0.5;
  *(float *)(a1 + 28) = v10;
  *(_DWORD *)(a1 + 36) = 6;
  *(_DWORD *)(a1 + 40) = 7500;
  *(_DWORD *)(a1 + 44) = 10;
  *(_DWORD *)(a1 + 48) = 1140850688;
  *(_DWORD *)(a1 + 52) = 1149763584;
  *(_DWORD *)(a1 + 60) = 3;
  *(_DWORD *)(a1 + 64) = 17500;
  *(_DWORD *)(a1 + 68) = 12;
  *(_DWORD *)(a1 + 72) = 1140850688;
  *(_DWORD *)(a1 + 76) = -1031798784;
  *(_DWORD *)(a1 + 84) = 3;
  *(_DWORD *)(a1 + 88) = 17500;
  *(_DWORD *)(a1 + 92) = 12;
  v4 = 0;
  v5 = 27500;
  v6 = (_DWORD *)(a1 + 108);
  do
  {
    *(v6 - 3) = -1031798784;
    *(v6 - 2) = 1140850688;
    if ( v4 % 4 )
      *v6 = v4 % 4 != 1 ? 5 : 3;
    else
      *v6 = 6;
    v6[1] = v5;
    v5 += 900;
    v6 += 6;
    v7 = v4 / 8 + 2;
    ++v4;
    *(v6 - 4) = v7;
  }
  while ( v4 < 64 );
  *a2 = 68;
  return a2;
}

// quest_build_the_gathering @ 0x004349C0
// quest builder for Tier 5 Quest 10 (The Gathering)
_DWORD *__cdecl sub_4349C0(_DWORD *a1, _DWORD *a2)
{
  *a1 = 1132462080;
  a1[1] = 1140850688;
  a1[3] = 1;
  a1[4] = 500;
  a1[5] = 1;
  a1[6] = 1145044992;
  a1[7] = 1140850688;
  a1[9] = 1;
  a1[10] = 9500;
  a1[11] = 2;
  a1[12] = 1132462080;
  a1[13] = 1140850688;
  a1[15] = 58;
  a1[16] = 15500;
  a1[17] = 2;
  a1[18] = 1145044992;
  a1[19] = 1140850688;
  a1[21] = 58;
  a1[22] = 24500;
  a1[23] = 2;
  a1[24] = 1132462080;
  a1[25] = 1140850688;
  a1[27] = 0;
  a1[28] = 30500;
  a1[29] = 2;
  a1[30] = 1145044992;
  a1[31] = 1140850688;
  a1[33] = 0;
  a1[34] = 39500;
  a1[35] = 2;
  a1[36] = 1115684864;
  a1[37] = 1115684864;
  a1[39] = 60;
  a1[40] = 54500;
  a1[41] = 2;
  a1[42] = 1148190720;
  a1[43] = 1115684864;
  a1[45] = 60;
  a1[46] = 54500;
  a1[47] = 1;
  a1[48] = 1115684864;
  a1[49] = 1148190720;
  a1[51] = 60;
  a1[52] = 54500;
  a1[53] = 2;
  a1[54] = 1148190720;
  a1[55] = 1148190720;
  a1[57] = 60;
  a1[58] = 54500;
  a1[59] = 1;
  a1[60] = -1023410176;
  a1[61] = 1140850688;
  a1[63] = 58;
  a1[64] = 90500;
  a1[65] = 6;
  a1[66] = 1150287872;
  a1[67] = 1140850688;
  a1[69] = 1;
  a1[70] = 99500;
  a1[71] = 4;
  a1[72] = 1150287872;
  a1[73] = 1140850688;
  a1[75] = 1;
  a1[76] = 109500;
  a1[77] = 2;
  *a2 = 13;
  return a1;
}

// quest_build_army_of_three @ 0x00434CA0
// quest builder for Tier 5 Quest 7 (Army of Three)
_DWORD *__cdecl sub_434CA0(_DWORD *a1, _DWORD *a2)
{
  *a1 = -1031798784;
  a1[1] = 1132462080;
  a1[3] = 21;
  a1[4] = 500;
  a1[5] = 1;
  a1[6] = -1031798784;
  a1[7] = 1140850688;
  a1[9] = 21;
  a1[10] = 5500;
  a1[11] = 1;
  a1[12] = -1031798784;
  a1[13] = 1145044992;
  a1[15] = 21;
  a1[16] = 15000;
  a1[17] = 1;
  a1[18] = -1031798784;
  a1[19] = 1145044992;
  a1[21] = 23;
  a1[22] = 19500;
  a1[23] = 1;
  a1[24] = -1031798784;
  a1[25] = 1140850688;
  a1[27] = 23;
  a1[28] = 22500;
  a1[29] = 1;
  a1[30] = -1031798784;
  a1[31] = 1132462080;
  a1[33] = 23;
  a1[34] = 26500;
  a1[35] = 1;
  a1[36] = -1031798784;
  a1[37] = 1132462080;
  a1[39] = 22;
  a1[40] = 35500;
  a1[41] = 1;
  a1[42] = -1031798784;
  a1[43] = 1140850688;
  a1[45] = 22;
  a1[46] = 39500;
  a1[47] = 1;
  a1[48] = -1031798784;
  a1[49] = 1145044992;
  a1[51] = 22;
  a1[52] = 42500;
  a1[53] = 1;
  a1[54] = 1140850688;
  a1[55] = 1150287872;
  a1[57] = 21;
  a1[58] = 52500;
  a1[59] = 3;
  a1[60] = 1140850688;
  a1[61] = -1015021568;
  a1[63] = 23;
  a1[64] = 56500;
  a1[65] = 3;
  *a2 = 11;
  return a1;
}

// quest_build_knee_deep_in_the_dead @ 0x00434F00
// quest builder for Tier 5 Quest 5 (Knee-deep in the Dead)
int *__cdecl sub_434F00(int a1, int *a2)
{
  double v2; // st7
  int v3; // ebp
  int v4; // esi
  int v5; // eax
  int i; // ecx
  double v7; // st7
  double v8; // st7
  double v9; // st7
  double v10; // st7
  double v11; // st7
  double v12; // st7
  float v14; // [esp+14h] [ebp-2Ch]
  float v15; // [esp+14h] [ebp-2Ch]
  float v16; // [esp+1Ch] [ebp-24h]
  float v17; // [esp+24h] [ebp-1Ch]
  float v18; // [esp+2Ch] [ebp-14h]
  float v19; // [esp+34h] [ebp-Ch]
  float v20; // [esp+3Ch] [ebp-4h]

  v2 = (double)terrain_texture_height * 0.5;
  *(_DWORD *)a1 = -1035468800;
  v14 = v2;
  *(float *)(a1 + 4) = v14;
  *(_DWORD *)(a1 + 12) = 67;
  *(_DWORD *)(a1 + 16) = 100;
  *(_DWORD *)(a1 + 20) = 1;
  v3 = 0;
  v4 = 1;
  v5 = a1 + 24;
  for ( i = 500; i < 96500; i += 1500 )
  {
    if ( !(v3 % 8) )
    {
      v7 = (double)terrain_texture_height;
      *(_DWORD *)v5 = -1035468800;
      ++v4;
      v5 += 24;
      v15 = v7 * 0.5;
      *(float *)(v5 - 20) = v15;
      *(_DWORD *)(v5 - 12) = 67;
      *(_DWORD *)(v5 - 8) = i - 2;
      *(_DWORD *)(v5 - 4) = 1;
    }
    v8 = (double)terrain_texture_height;
    *(_DWORD *)v5 = -1035468800;
    v16 = v8 * 0.5;
    *(float *)(v5 + 4) = v16;
    *(_DWORD *)(v5 + 12) = 65;
    *(_DWORD *)(v5 + 16) = i;
    *(_DWORD *)(v5 + 20) = (v3 > 32) + 1;
    ++v4;
    v5 += 24;
    if ( i > 12500 )
    {
      v9 = (double)terrain_texture_height;
      *(_DWORD *)v5 = -1035468800;
      ++v4;
      v5 += 24;
      v17 = v9 * 0.5 + 158.0;
      *(float *)(v5 - 20) = v17;
      *(_DWORD *)(v5 - 12) = 65;
      *(_DWORD *)(v5 - 8) = i + 500;
      *(_DWORD *)(v5 - 4) = 1;
    }
    if ( i > 24500 )
    {
      v10 = (double)terrain_texture_height;
      *(_DWORD *)v5 = -1035468800;
      ++v4;
      v5 += 24;
      v18 = v10 * 0.5 - 158.0;
      *(float *)(v5 - 20) = v18;
      *(_DWORD *)(v5 - 12) = 65;
      *(_DWORD *)(v5 - 8) = i + 1000;
      *(_DWORD *)(v5 - 4) = 1;
    }
    if ( i > 36500 )
    {
      v11 = (double)terrain_texture_height;
      *(_DWORD *)v5 = -1035468800;
      ++v4;
      v5 += 24;
      v19 = v11 * 0.5 - 258.0;
      *(float *)(v5 - 20) = v19;
      *(_DWORD *)(v5 - 12) = 66;
      *(_DWORD *)(v5 - 8) = i + 1300;
      *(_DWORD *)(v5 - 4) = 1;
    }
    if ( i > 48500 )
    {
      v12 = (double)terrain_texture_height;
      *(_DWORD *)v5 = -1035468800;
      ++v4;
      v5 += 24;
      v20 = v12 * 0.5 + 258.0;
      *(float *)(v5 - 20) = v20;
      *(_DWORD *)(v5 - 12) = 66;
      *(_DWORD *)(v5 - 8) = i + 300;
      *(_DWORD *)(v5 - 4) = 1;
    }
    ++v3;
  }
  *a2 = v4;
  return a2;
}

// quest_build_the_gang_wars @ 0x00435120
// quest builder for Tier 5 Quest 4 (The Gang Wars)
_DWORD *__cdecl sub_435120(int a1, _DWORD *a2)
{
  double v2; // st7
  double v3; // st7
  int v4; // esi
  int v5; // eax
  int v6; // edx
  double v7; // st7
  int v8; // edx
  int v9; // eax
  double v10; // st7
  float v12; // [esp+14h] [ebp-4h]
  float v13; // [esp+14h] [ebp-4h]
  float v14; // [esp+14h] [ebp-4h]
  float v15; // [esp+14h] [ebp-4h]

  v2 = (double)terrain_texture_height * 0.5;
  *(_DWORD *)a1 = -1021968384;
  v12 = v2;
  *(float *)(a1 + 4) = v12;
  *(_DWORD *)(a1 + 12) = 18;
  *(_DWORD *)(a1 + 16) = 100;
  *(_DWORD *)(a1 + 20) = 1;
  v3 = (double)terrain_texture_height;
  *(_DWORD *)(a1 + 24) = 1150468096;
  v4 = 10;
  v13 = v3 * 0.5;
  *(float *)(a1 + 28) = v13;
  *(_DWORD *)(a1 + 36) = 18;
  *(_DWORD *)(a1 + 40) = 2500;
  *(_DWORD *)(a1 + 44) = 1;
  v5 = a1 + 64;
  v6 = 5500;
  do
  {
    v7 = (double)terrain_texture_height;
    *(_DWORD *)(v5 - 16) = 1150468096;
    v5 += 24;
    v14 = v7 * 0.5;
    *(float *)(v5 - 36) = v14;
    *(_DWORD *)(v5 - 28) = 18;
    *(_DWORD *)(v5 - 24) = v6;
    *(_DWORD *)(v5 - 20) = 2;
    v6 += 4000;
    --v4;
  }
  while ( v4 );
  *(_DWORD *)(a1 + 288) = 1140850688;
  *(_DWORD *)(a1 + 292) = 1150287872;
  *(_DWORD *)(a1 + 300) = 19;
  *(_DWORD *)(a1 + 304) = 50500;
  *(_DWORD *)(a1 + 308) = 1;
  v8 = 59500;
  v9 = a1 + 328;
  do
  {
    v10 = (double)terrain_texture_height;
    *(_DWORD *)(v9 - 16) = -1021968384;
    v9 += 24;
    v15 = v10 * 0.5;
    *(float *)(v9 - 36) = v15;
    *(_DWORD *)(v9 - 28) = 18;
    *(_DWORD *)(v9 - 24) = v8;
    *(_DWORD *)(v9 - 20) = 2;
    v8 += 4000;
  }
  while ( v8 < 99500 );
  *(_DWORD *)(a1 + 552) = 1140850688;
  *(_DWORD *)(a1 + 556) = 1150287872;
  *(_DWORD *)(a1 + 564) = 19;
  *(_DWORD *)(a1 + 568) = 107500;
  *(_DWORD *)(a1 + 572) = 3;
  *a2 = 24;
  return a2;
}

// quest_build_the_fortress @ 0x004352D0
// quest builder for Tier 5 Quest 3 (The Fortress)
int *__cdecl sub_4352D0(int a1, int *a2)
{
  double v2; // st7
  int v4; // ecx
  int v5; // eax
  int v6; // edx
  int v7; // ebp
  int v8; // ecx
  int v9; // esi
  int *result; // eax
  float v11; // [esp+14h] [ebp-Ch]
  float v12; // [esp+14h] [ebp-Ch]
  float v13; // [esp+18h] [ebp-8h]
  float v14; // [esp+1Ch] [ebp-4h]
  int v15; // [esp+24h] [ebp+4h]
  int v16; // [esp+24h] [ebp+4h]

  v2 = (double)terrain_texture_height * 0.5;
  *(_DWORD *)a1 = -1035468800;
  v11 = v2;
  v15 = 512;
  *(float *)(a1 + 4) = v11;
  *(_DWORD *)(a1 + 12) = 64;
  *(_DWORD *)(a1 + 16) = 100;
  *(_DWORD *)(a1 + 20) = 6;
  v4 = 1100;
  v5 = a1 + 40;
  v6 = 8;
  do
  {
    *(_DWORD *)(v5 - 16) = 1145044992;
    v5 += 24;
    v12 = (double)v15 * 0.125 + 256.0;
    *(float *)(v5 - 36) = v12;
    *(_DWORD *)(v5 - 28) = 9;
    *(_DWORD *)(v5 - 24) = v4;
    *(_DWORD *)(v5 - 20) = 1;
    v4 += 600;
    v15 += 512;
  }
  while ( v4 < 5300 );
  *(_DWORD *)(a1 + 192) = 1124073472;
  *(_DWORD *)(a1 + 196) = 1140850688;
  *(_DWORD *)(a1 + 204) = 14;
  v7 = 384;
  *(_DWORD *)(a1 + 208) = 6500;
  *(_DWORD *)(a1 + 212) = 1;
  v16 = 384;
  do
  {
    v8 = 1;
    v9 = 600 * v6 + 5500;
    result = (int *)(a1 + 24 * v6 + 16);
    do
    {
      if ( v8 != 1 || v7 != 1152 && v7 != 1536 )
      {
        ++v6;
        v13 = (double)v16 * 0.16666667 + 256.0;
        *((float *)result - 4) = v13;
        v14 = 512.0 - (double)(384 * v8) * 0.16666667;
        *((float *)result - 3) = v14;
        v7 = v16;
        *(result - 1) = 10;
        *result = v9;
        result[1] = 1;
        v9 += 600;
        result += 6;
      }
      ++v8;
    }
    while ( v8 <= 6 );
    v7 += 384;
    v16 = v7;
  }
  while ( v7 <= 2304 );
  *a2 = v6;
  return result;
}

// quest_build_cross_fire @ 0x00435480
// quest builder for Tier 5 Quest 6 (Cross Fire)
_DWORD *__cdecl sub_435480(int a1, _DWORD *a2)
{
  double v2; // st7
  float v4; // [esp+8h] [ebp-4h]

  v2 = (double)terrain_texture_height * 0.5;
  *(_DWORD *)a1 = 1149648896;
  v4 = v2;
  *(float *)(a1 + 4) = v4;
  *(_DWORD *)(a1 + 12) = 64;
  *(_DWORD *)(a1 + 16) = 100;
  *(_DWORD *)(a1 + 20) = 6;
  *(_DWORD *)(a1 + 24) = -1038090240;
  *(_DWORD *)(a1 + 28) = 1140850688;
  *(_DWORD *)(a1 + 36) = 60;
  *(_DWORD *)(a1 + 40) = 5500;
  *(_DWORD *)(a1 + 44) = 4;
  *(_DWORD *)(a1 + 48) = -1038090240;
  *(_DWORD *)(a1 + 52) = 1140850688;
  *(_DWORD *)(a1 + 60) = 60;
  *(_DWORD *)(a1 + 64) = 15500;
  *(_DWORD *)(a1 + 68) = 6;
  *(_DWORD *)(a1 + 72) = 1140850688;
  *(_DWORD *)(a1 + 76) = 1140850688;
  *(_DWORD *)(a1 + 84) = 1;
  *(_DWORD *)(a1 + 88) = 18500;
  *(_DWORD *)(a1 + 92) = 2;
  *(_DWORD *)(a1 + 96) = -1027080192;
  *(_DWORD *)(a1 + 100) = 1140850688;
  *(_DWORD *)(a1 + 108) = 60;
  *(_DWORD *)(a1 + 112) = 25500;
  *(_DWORD *)(a1 + 116) = 8;
  *(_DWORD *)(a1 + 120) = 1140850688;
  *(_DWORD *)(a1 + 124) = 1150287872;
  *(_DWORD *)(a1 + 132) = 64;
  *(_DWORD *)(a1 + 136) = 26000;
  *(_DWORD *)(a1 + 140) = 6;
  *(_DWORD *)(a1 + 144) = 1140850688;
  *(_DWORD *)(a1 + 148) = -1023410176;
  *(_DWORD *)(a1 + 156) = 64;
  *(_DWORD *)(a1 + 160) = 26000;
  *(_DWORD *)(a1 + 164) = 6;
  *a2 = 7;
  return a2;
}

// quest_build_the_beating @ 0x00435610
// quest builder for Tier 5 Quest 1 (The Beating)
int __cdecl sub_435610(int a1, _DWORD *a2)
{
  int v3; // ebx
  double v4; // st7
  int v5; // edi
  int v6; // ebp
  int v7; // ecx
  int v8; // eax
  double v9; // st7
  double v10; // st7
  int v11; // ebx
  int v12; // edi
  int v13; // ecx
  double v14; // st7
  int v15; // ebx
  int v16; // edi
  int v17; // ecx
  double v18; // st7
  int v19; // ebx
  int v20; // edi
  int v21; // ecx
  int result; // eax
  float v23; // [esp+10h] [ebp-10h]
  float v24; // [esp+10h] [ebp-10h]
  float v25; // [esp+10h] [ebp-10h]
  float v26; // [esp+14h] [ebp-Ch]
  float v27; // [esp+14h] [ebp-Ch]
  float v28; // [esp+14h] [ebp-Ch]
  float v29; // [esp+14h] [ebp-Ch]
  float v30; // [esp+18h] [ebp-8h]
  float v31; // [esp+18h] [ebp-8h]
  float v32; // [esp+1Ch] [ebp-4h]
  float v33; // [esp+1Ch] [ebp-4h]
  int v34; // [esp+24h] [ebp+4h]
  int v35; // [esp+24h] [ebp+4h]
  int v36; // [esp+24h] [ebp+4h]
  int v37; // [esp+24h] [ebp+4h]

  *(_DWORD *)a1 = 1132462080;
  *(_DWORD *)(a1 + 4) = 1132462080;
  *(_DWORD *)(a1 + 12) = 39;
  *(_DWORD *)(a1 + 16) = 500;
  *(_DWORD *)(a1 + 20) = 1;
  v3 = 10000;
  v23 = (float)(terrain_texture_width + 32);
  v4 = (double)(terrain_texture_height / 2);
  *(float *)(a1 + 24) = v23;
  v5 = 64;
  v6 = 8;
  v26 = v4;
  *(float *)(a1 + 28) = v26;
  *(_DWORD *)(a1 + 36) = 41;
  *(_DWORD *)(a1 + 40) = 8000;
  *(_DWORD *)(a1 + 44) = 3;
  v7 = a1 + 64;
  do
  {
    v7 += 24;
    v8 = v5 + terrain_texture_width;
    v5 += 32;
    v24 = (float)v8;
    v9 = (double)(terrain_texture_height / 2);
    *(float *)(v7 - 40) = v24;
    v27 = v9;
    *(float *)(v7 - 36) = v27;
    *(_DWORD *)(v7 - 28) = 37;
    *(_DWORD *)(v7 - 24) = v3;
    *(_DWORD *)(v7 - 20) = 8;
    v3 += 100;
    --v6;
  }
  while ( v6 );
  v34 = terrain_texture_height / 2;
  *(_DWORD *)(a1 + 240) = -1040187392;
  v10 = (double)v34;
  v11 = -64;
  v12 = 20000;
  v13 = a1 + 280;
  v35 = -64;
  v28 = v10;
  *(float *)(a1 + 244) = v28;
  *(_DWORD *)(a1 + 252) = 41;
  *(_DWORD *)(a1 + 256) = 18000;
  *(_DWORD *)(a1 + 260) = 3;
  do
  {
    v11 -= 32;
    v25 = (float)v35;
    v13 += 24;
    v14 = (double)(terrain_texture_height / 2);
    *(float *)(v13 - 40) = v25;
    v35 = v11;
    v29 = v14;
    *(float *)(v13 - 36) = v29;
    *(_DWORD *)(v13 - 28) = 37;
    *(_DWORD *)(v13 - 24) = v12;
    *(_DWORD *)(v13 - 20) = 8;
    v12 += 100;
  }
  while ( v11 > -320 );
  v15 = -64;
  v16 = 40000;
  v17 = a1 + 472;
  v36 = -64;
  do
  {
    v15 -= 42;
    v17 += 24;
    v30 = (float)(terrain_texture_width / 2);
    v18 = (double)v36;
    v36 = v15;
    *(float *)(v17 - 40) = v30;
    v32 = v18;
    *(float *)(v17 - 36) = v32;
    *(_DWORD *)(v17 - 28) = 15;
    *(_DWORD *)(v17 - 24) = v16;
    *(_DWORD *)(v17 - 20) = 4;
    v16 += 100;
  }
  while ( v15 > -316 );
  v19 = 0;
  v20 = 40000;
  v21 = a1 + 616;
  do
  {
    v21 += 24;
    v37 = v19 + terrain_texture_width + 44;
    v19 += 32;
    v31 = (float)(terrain_texture_width / 2);
    *(float *)(v21 - 40) = v31;
    v33 = (float)v37;
    result = LODWORD(v33);
    *(float *)(v21 - 36) = v33;
    *(_DWORD *)(v21 - 28) = 18;
    *(_DWORD *)(v21 - 24) = v20;
    *(_DWORD *)(v21 - 20) = 2;
    v20 += 100;
  }
  while ( v20 < 40600 );
  *a2 = 31;
  return result;
}

// quest_build_the_spanking_of_the_dead @ 0x004358A0
// quest builder for Tier 5 Quest 2 (The Spanking Of The Dead)
_DWORD *__cdecl sub_4358A0(_DWORD *a1, _DWORD *a2)
{
  int v3; // esi
  int v4; // edx
  float *v5; // ecx
  double v6; // st7
  long double v7; // st7
  double v8; // st6
  double v9; // st6
  float v11; // [esp+Ch] [ebp-8h]
  float v12; // [esp+10h] [ebp-4h]
  int v13; // [esp+18h] [ebp+4h]
  float v14; // [esp+18h] [ebp+4h]

  *a1 = 1132462080;
  a1[1] = 1140850688;
  a1[3] = 39;
  a1[4] = 500;
  a1[5] = 1;
  a1[6] = 1145044992;
  a1[7] = 1140850688;
  a1[9] = 39;
  v3 = 0;
  a1[10] = 500;
  a1[11] = 1;
  v13 = 0;
  v4 = 5000;
  v5 = (float *)(a1 + 15);
  do
  {
    v6 = (double)v13;
    v5 += 6;
    ++v3;
    v14 = v6;
    v7 = v6 * 0.33333334;
    v8 = v14 * 3.8;
    v13 = v3;
    v9 = 512.0 - v8;
    v11 = cos(v7) * v9 + 512.0;
    *(v5 - 9) = v11;
    v12 = sin(v7) * v9 + 512.0;
    *(v5 - 8) = v12;
    *(v5 - 7) = v7;
    *((_DWORD *)v5 - 6) = 65;
    *((_DWORD *)v5 - 5) = v4;
    *((_DWORD *)v5 - 4) = 1;
    v4 += 300;
  }
  while ( v4 < 43400 );
  a1[780] = 1151336448;
  a1[781] = 1140850688;
  a1[783] = 66;
  a1[784] = 300 * v3 + 10000;
  a1[785] = 16;
  a1[786] = -1015021568;
  a1[787] = 1140850688;
  a1[789] = 66;
  a1[790] = 300 * v3 + 20000;
  a1[791] = 16;
  *a2 = 132;
  return a2;
}

// quest_build_hidden_evil @ 0x00435A30
// quest builder for Tier 3 Quest 4 (Hidden Evil)
int __cdecl sub_435A30(int a1, _DWORD *a2)
{
  double v2; // st7
  double v3; // st7
  double v4; // st7
  double v5; // st7
  double v6; // st7
  float v8; // [esp+4h] [ebp-8h]
  float v9; // [esp+4h] [ebp-8h]
  float v10; // [esp+4h] [ebp-8h]
  float v11; // [esp+4h] [ebp-8h]
  float v12; // [esp+4h] [ebp-8h]
  float v13; // [esp+8h] [ebp-4h]
  float v14; // [esp+8h] [ebp-4h]
  float v15; // [esp+8h] [ebp-4h]
  float v16; // [esp+8h] [ebp-4h]
  float v17; // [esp+8h] [ebp-4h]

  v8 = (float)(terrain_texture_width / 2);
  v2 = (double)(terrain_texture_height + 64);
  *(float *)a1 = v8;
  v13 = v2;
  *(float *)(a1 + 4) = v13;
  *(_DWORD *)(a1 + 12) = 33;
  *(_DWORD *)(a1 + 16) = 500;
  *(_DWORD *)(a1 + 20) = 50;
  v9 = (float)(terrain_texture_width / 2);
  v3 = (double)(terrain_texture_height + 64);
  *(float *)(a1 + 24) = v9;
  v14 = v3;
  *(float *)(a1 + 28) = v14;
  *(_DWORD *)(a1 + 36) = 34;
  *(_DWORD *)(a1 + 40) = 15000;
  *(_DWORD *)(a1 + 44) = 30;
  v10 = (float)(terrain_texture_width / 2);
  v4 = (double)(terrain_texture_height + 64);
  *(float *)(a1 + 48) = v10;
  v15 = v4;
  *(float *)(a1 + 52) = v15;
  *(_DWORD *)(a1 + 60) = 35;
  *(_DWORD *)(a1 + 64) = 25000;
  *(_DWORD *)(a1 + 68) = 20;
  v11 = (float)(terrain_texture_width / 2);
  v5 = (double)(terrain_texture_height + 64);
  *(float *)(a1 + 72) = v11;
  v16 = v5;
  *(float *)(a1 + 76) = v16;
  *(_DWORD *)(a1 + 84) = 35;
  *(_DWORD *)(a1 + 88) = 30000;
  *(_DWORD *)(a1 + 92) = 30;
  v12 = (float)(terrain_texture_width / 2);
  v6 = (double)(terrain_texture_height + 64);
  *(float *)(a1 + 96) = v12;
  v17 = v6;
  *(float *)(a1 + 100) = v17;
  *(_DWORD *)(a1 + 108) = 34;
  *(_DWORD *)(a1 + 112) = 35000;
  *(_DWORD *)(a1 + 116) = 30;
  *a2 = 5;
  return LODWORD(v17);
}

// quest_build_land_hostile @ 0x00435BD0
// quest builder for Tier 1 Quest 1 (Land Hostile)
_DWORD *__cdecl sub_435BD0(int a1, _DWORD *a2)
{
  double v2; // st7
  float v4; // [esp+4h] [ebp-8h]
  float v5; // [esp+8h] [ebp-4h]

  v4 = (float)(terrain_texture_width / 2);
  v2 = (double)(terrain_texture_height + 64);
  *(float *)a1 = v4;
  v5 = v2;
  *(float *)(a1 + 4) = v5;
  *(_DWORD *)(a1 + 12) = 38;
  *(_DWORD *)(a1 + 16) = 500;
  *(_DWORD *)(a1 + 20) = 1;
  *(_DWORD *)(a1 + 24) = -1031798784;
  *(_DWORD *)(a1 + 28) = 1149763584;
  *(_DWORD *)(a1 + 36) = 38;
  *(_DWORD *)(a1 + 40) = 2500;
  *(_DWORD *)(a1 + 44) = 2;
  *(_DWORD *)(a1 + 48) = -1031798784;
  *(_DWORD *)(a1 + 52) = -1031798784;
  *(_DWORD *)(a1 + 60) = 38;
  *(_DWORD *)(a1 + 64) = 6500;
  *(_DWORD *)(a1 + 68) = 3;
  *(_DWORD *)(a1 + 72) = 1149763584;
  *(_DWORD *)(a1 + 76) = -1031798784;
  *(_DWORD *)(a1 + 84) = 38;
  *(_DWORD *)(a1 + 88) = 11500;
  *(_DWORD *)(a1 + 92) = 4;
  *a2 = 4;
  return a2;
}

// quest_build_minor_alien_breach @ 0x00435CC0
// quest builder for Tier 1 Quest 2 (Minor Alien Breach)
int __cdecl sub_435CC0(_DWORD *a1, int *a2)
{
  int v2; // edi
  int v3; // ebx
  float *v4; // ecx
  double v5; // st7
  int result; // eax
  int v7; // esi
  double v8; // st7
  double v9; // st7
  int v10; // eax
  float v11; // [esp+10h] [ebp-20h]
  float v12; // [esp+14h] [ebp-1Ch]
  float v13; // [esp+18h] [ebp-18h]
  float v14; // [esp+1Ch] [ebp-14h]
  float v15; // [esp+20h] [ebp-10h]
  float v16; // [esp+24h] [ebp-Ch]
  float v17; // [esp+2Ch] [ebp-4h]

  *a1 = 1132462080;
  a1[1] = 1132462080;
  a1[3] = 38;
  v2 = 2;
  a1[4] = 1000;
  a1[5] = 2;
  a1[6] = 1132462080;
  a1[7] = 1124073472;
  a1[9] = 38;
  a1[10] = 1700;
  a1[11] = 2;
  v3 = 2;
  v4 = (float *)(a1 + 12);
  do
  {
    v4 += 6;
    v11 = (float)(terrain_texture_width + 64);
    v5 = (double)(terrain_texture_height / 2);
    *(v4 - 6) = v11;
    v12 = v5;
    *(v4 - 5) = v12;
    *((_DWORD *)v4 - 3) = 38;
    result = 5 * (5 * v3 - 10);
    v7 = 720 * (5 * v3 - 10);
    *((_DWORD *)v4 - 2) = v7;
    *((_DWORD *)v4 - 1) = 1;
    ++v2;
    if ( v3 > 6 )
    {
      ++v2;
      v13 = (float)(terrain_texture_width + 64);
      result = LODWORD(v13);
      v8 = (double)(terrain_texture_height / 2 - 256);
      *v4 = v13;
      v4 += 6;
      v14 = v8;
      *(v4 - 5) = v14;
      *((_DWORD *)v4 - 3) = 38;
      *((_DWORD *)v4 - 2) = v7;
      *((_DWORD *)v4 - 1) = 1;
    }
    if ( v3 == 13 )
    {
      ++v2;
      v4 += 6;
      v15 = (float)(terrain_texture_width / 2);
      v9 = (double)(terrain_texture_height + 64);
      *(v4 - 6) = v15;
      v16 = v9;
      *(v4 - 5) = v16;
      *((_DWORD *)v4 - 3) = 41;
      *((_DWORD *)v4 - 2) = 39600;
      *((_DWORD *)v4 - 1) = 1;
    }
    else if ( v3 <= 10 )
    {
      goto LABEL_8;
    }
    v10 = terrain_texture_height / 2 + 256;
    *v4 = -64.0;
    ++v2;
    v4 += 6;
    v17 = (float)v10;
    result = LODWORD(v17);
    *(v4 - 5) = v17;
    *((_DWORD *)v4 - 3) = 38;
    *((_DWORD *)v4 - 2) = v7;
    *((_DWORD *)v4 - 1) = 1;
LABEL_8:
    ++v3;
  }
  while ( v3 <= 17 );
  *a2 = v2;
  return result;
}

// quest_build_alien_squads @ 0x00435EA0
// quest builder for Tier 1 Quest 8 (Alien Squads)
int *__cdecl sub_435EA0(_DWORD *a1, int *a2)
{
  int v2; // edx
  _DWORD *v3; // eax
  int i; // ecx
  _DWORD *v5; // eax

  *a1 = -1015021568;
  a1[1] = 1132462080;
  a1[3] = 18;
  a1[4] = 1500;
  a1[5] = 1;
  a1[6] = -1015021568;
  a1[7] = 1145044992;
  a1[9] = 18;
  a1[10] = 2500;
  a1[11] = 1;
  a1[12] = 1145044992;
  a1[13] = -1015021568;
  a1[15] = 18;
  a1[16] = 5500;
  a1[17] = 1;
  a1[18] = 1145044992;
  a1[19] = 1151336448;
  a1[21] = 18;
  a1[22] = 8500;
  a1[23] = 1;
  a1[24] = 1151336448;
  a1[25] = 1151336448;
  a1[27] = 18;
  a1[28] = 14500;
  a1[29] = 1;
  a1[30] = 1151336448;
  a1[31] = 1145044992;
  a1[33] = 18;
  a1[34] = 18500;
  a1[35] = 1;
  a1[36] = -1015021568;
  a1[37] = 1132462080;
  a1[39] = 18;
  a1[40] = 25000;
  a1[41] = 1;
  a1[42] = -1015021568;
  a1[43] = 1145044992;
  a1[45] = 18;
  a1[46] = 30000;
  a1[47] = 1;
  v2 = 8;
  v3 = a1 + 48;
  for ( i = 36200; i < 83000; i += 1800 )
  {
    *v3 = -1031798784;
    v3[1] = -1031798784;
    v3[3] = 38;
    v3[4] = i - 400;
    v3[5] = 1;
    v5 = v3 + 6;
    v2 += 2;
    *v5 = 1149763584;
    v5[1] = 1149763584;
    v5[3] = 38;
    v5[4] = i;
    v5[5] = 1;
    v3 = v5 + 6;
  }
  *a2 = v2;
  return a2;
}

// quest_build_zombie_masters @ 0x004360A0
// quest builder for Tier 3 Quest 10 (Zombie Masters)
_DWORD *__cdecl sub_4360A0(_DWORD *a1, _DWORD *a2)
{
  *a1 = 1132462080;
  a1[1] = 1132462080;
  a1[3] = 0;
  a1[4] = 1000;
  a1[5] = config_player_count;
  a1[6] = 1140850688;
  a1[7] = 1132462080;
  a1[9] = 0;
  a1[10] = 6000;
  a1[11] = 1;
  a1[12] = 1145044992;
  a1[13] = 1132462080;
  a1[15] = 0;
  a1[16] = 14000;
  a1[17] = config_player_count;
  a1[18] = 1145044992;
  a1[19] = 1145044992;
  a1[21] = 0;
  a1[22] = 18000;
  a1[23] = 1;
  *a2 = 4;
  return a2;
}

// quest_build_8_legged_terror @ 0x00436120
// quest builder for Tier 1 Quest 10 (8-legged Terror)
_DWORD *__cdecl sub_436120(int a1, int *a2)
{
  int v2; // edx
  _DWORD *result; // eax
  int i; // ecx
  _DWORD *v5; // eax

  *(float *)a1 = (float)(terrain_texture_width - 256);
  v2 = 1;
  result = (_DWORD *)(a1 + 24);
  *(float *)(a1 + 4) = (float)(terrain_texture_width / 2);
  *(_DWORD *)(a1 + 12) = 58;
  *(_DWORD *)(a1 + 16) = 1000;
  *(_DWORD *)(a1 + 20) = 1;
  for ( i = 6000; i < 36800; i += 2200 )
  {
    *result = -1043857408;
    result[1] = -1043857408;
    result[3] = 61;
    result[4] = i;
    result[5] = config_player_count;
    v5 = result + 6;
    *v5 = 1149444096;
    v5[1] = -1043857408;
    v5[3] = 61;
    v5[4] = i;
    v5[5] = 1;
    v5 += 6;
    *v5 = -1043857408;
    v5[1] = 1149444096;
    v5[3] = 61;
    v5[4] = i;
    v5[5] = config_player_count;
    v5 += 6;
    v2 += 4;
    *v5 = 1149444096;
    v5[1] = 1149444096;
    v5[3] = 61;
    v5[4] = i;
    v5[5] = 1;
    result = v5 + 6;
  }
  *a2 = v2;
  return result;
}

// quest_build_ghost_patrols @ 0x00436200
// quest builder for Tier 2 Quest 9 (Ghost Patrols)
int __cdecl sub_436200(int a1, _DWORD *a2)
{
  int v2; // ebx
  int v3; // esi
  int v4; // edi
  int result; // eax

  v2 = 2500;
  v3 = a1 + 36;
  *(float *)a1 = (float)(terrain_texture_width + 128);
  v4 = 0;
  *(float *)(a1 + 4) = (float)(terrain_texture_width / 2);
  *(_DWORD *)(a1 + 12) = 43;
  *(_DWORD *)(a1 + 16) = 1500;
  *(_DWORD *)(a1 + 20) = 2;
  do
  {
    if ( v4 % 2 )
      *(_DWORD *)(v3 - 12) = 1150287872;
    else
      *(_DWORD *)(v3 - 12) = -1023410176;
    v3 += 24;
    ++v4;
    *(float *)(v3 - 32) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v3 - 24) = 25;
    *(_DWORD *)(v3 - 20) = v2;
    *(_DWORD *)(v3 - 16) = 1;
    v2 += 2500;
  }
  while ( v2 < 32500 );
  *(_DWORD *)(a1 + 312) = -1014759424;
  *(float *)(a1 + 316) = (float)(terrain_texture_width / 2);
  *(_DWORD *)(a1 + 324) = 43;
  *(_DWORD *)(a1 + 328) = 2500 * v4 - 2500;
  *(_DWORD *)(a1 + 332) = 1;
  *(_DWORD *)(a1 + 336) = -1023410176;
  *(float *)(a1 + 340) = (float)(terrain_texture_width / 2);
  *(_DWORD *)(a1 + 348) = 24;
  result = 500 * (5 * v4 + 15);
  *(_DWORD *)(a1 + 352) = result;
  *(_DWORD *)(a1 + 356) = 1;
  *a2 = 15;
  return result;
}

// quest_build_the_random_factor @ 0x00436350
// quest builder for Tier 1 Quest 6 (The Random Factor)
int __cdecl sub_436350(int a1, _DWORD *a2)
{
  int v2; // esi
  int i; // edi
  int v4; // ecx
  int v5; // esi
  int v6; // ecx
  int v7; // eax
  int result; // eax
  int v9; // et2
  int v10; // ecx

  v2 = 0;
  for ( i = 1500; i < 101500; i += 10000 )
  {
    v4 = a1 + 24 * v2;
    *(float *)v4 = (float)(terrain_texture_width + 64);
    v5 = v2 + 1;
    *(float *)(v4 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v4 + 12) = 29;
    *(_DWORD *)(v4 + 16) = i;
    *(_DWORD *)(v4 + 20) = 2 * config_player_count + 4;
    v6 = a1 + 24 * v5;
    *(_DWORD *)v6 = -1031798784;
    v2 = v5 + 1;
    *(float *)(v6 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v6 + 12) = 29;
    *(_DWORD *)(v6 + 16) = i + 200;
    *(_DWORD *)(v6 + 20) = 6;
    v7 = crt_rand();
    v9 = v7 % 5;
    result = v7 / 5;
    if ( v9 == 3 )
    {
      v10 = a1 + 24 * v2++;
      *(float *)v10 = (float)(terrain_texture_width / 2);
      *(_DWORD *)(v10 + 4) = 1149763584;
      *(_DWORD *)(v10 + 12) = 41;
      *(_DWORD *)(v10 + 16) = i;
      result = config_player_count;
      *(_DWORD *)(v10 + 20) = config_player_count;
    }
  }
  *a2 = v2;
  return result;
}

// quest_build_spider_wave_syndrome @ 0x00436440
// quest builder for Tier 1 Quest 7 (Spider Wave Syndrome)
int __cdecl sub_436440(int a1, _DWORD *a2)
{
  int v2; // esi
  int i; // edi
  int v4; // ecx
  int result; // eax

  v2 = 0;
  for ( i = 1500; i < 100500; i += 5500 )
  {
    v4 = a1 + 24 * v2;
    *(_DWORD *)v4 = -1031798784;
    ++v2;
    *(float *)(v4 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v4 + 12) = 64;
    *(_DWORD *)(v4 + 16) = i;
    result = 2 * config_player_count + 6;
    *(_DWORD *)(v4 + 20) = result;
  }
  *a2 = v2;
  return result;
}

// quest_build_nesting_grounds @ 0x004364A0
// quest builder for Tier 1 Quest 9 (Nesting Grounds)
_DWORD *__cdecl sub_4364A0(int a1, _DWORD *a2)
{
  *(float *)a1 = (float)(terrain_texture_width / 2);
  *(float *)(a1 + 4) = (float)(terrain_texture_height + 64);
  *(_DWORD *)(a1 + 12) = 29;
  *(_DWORD *)(a1 + 16) = 1500;
  *(_DWORD *)(a1 + 20) = 2 * config_player_count + 6;
  *(_DWORD *)(a1 + 24) = 1132462080;
  *(_DWORD *)(a1 + 28) = 1132462080;
  *(_DWORD *)(a1 + 36) = 9;
  *(_DWORD *)(a1 + 40) = 8000;
  *(_DWORD *)(a1 + 44) = 1;
  *(_DWORD *)(a1 + 48) = 1140850688;
  *(_DWORD *)(a1 + 52) = 1140850688;
  *(_DWORD *)(a1 + 60) = 9;
  *(_DWORD *)(a1 + 64) = 13000;
  *(_DWORD *)(a1 + 68) = 1;
  *(_DWORD *)(a1 + 72) = 1145044992;
  *(_DWORD *)(a1 + 76) = 1145044992;
  *(_DWORD *)(a1 + 84) = 9;
  *(_DWORD *)(a1 + 88) = 18000;
  *(_DWORD *)(a1 + 92) = 1;
  *(float *)(a1 + 96) = (float)(terrain_texture_width / 2);
  *(float *)(a1 + 100) = (float)(terrain_texture_height + 64);
  *(_DWORD *)(a1 + 108) = 29;
  *(_DWORD *)(a1 + 112) = 25000;
  *(_DWORD *)(a1 + 116) = 2 * config_player_count + 6;
  *(float *)(a1 + 120) = (float)(terrain_texture_width / 2);
  *(float *)(a1 + 124) = (float)(terrain_texture_height + 64);
  *(_DWORD *)(a1 + 132) = 29;
  *(_DWORD *)(a1 + 136) = 39000;
  *(_DWORD *)(a1 + 140) = 3 * config_player_count + 3;
  *(_DWORD *)(a1 + 144) = 1136656384;
  *(_DWORD *)(a1 + 148) = 1140850688;
  *(_DWORD *)(a1 + 156) = 9;
  *(_DWORD *)(a1 + 160) = 41100;
  *(_DWORD *)(a1 + 164) = 1;
  *(_DWORD *)(a1 + 168) = 1142947840;
  *(_DWORD *)(a1 + 172) = 1140850688;
  *(_DWORD *)(a1 + 180) = 9;
  *(_DWORD *)(a1 + 184) = 42100;
  *(_DWORD *)(a1 + 188) = 1;
  *(_DWORD *)(a1 + 192) = 1140850688;
  *(_DWORD *)(a1 + 196) = 1142947840;
  *(_DWORD *)(a1 + 204) = 9;
  *(_DWORD *)(a1 + 208) = 43100;
  *(_DWORD *)(a1 + 212) = 1;
  *(_DWORD *)(a1 + 216) = 1140850688;
  *(_DWORD *)(a1 + 220) = 1140850688;
  *(_DWORD *)(a1 + 228) = 8;
  *(_DWORD *)(a1 + 232) = 44100;
  *(_DWORD *)(a1 + 236) = 1;
  *(float *)(a1 + 240) = (float)(terrain_texture_width / 2);
  *(float *)(a1 + 244) = (float)(terrain_texture_height + 64);
  *(_DWORD *)(a1 + 252) = 30;
  *(_DWORD *)(a1 + 256) = 50000;
  *(_DWORD *)(a1 + 260) = 2 * config_player_count + 5;
  *(float *)(a1 + 264) = (float)(terrain_texture_width / 2);
  *(float *)(a1 + 268) = (float)(terrain_texture_height + 64);
  *(_DWORD *)(a1 + 276) = 31;
  *(_DWORD *)(a1 + 280) = 55000;
  *(_DWORD *)(a1 + 284) = 2 * config_player_count + 2;
  *a2 = 12;
  return a2;
}

// quest_build_alien_dens @ 0x00436720
// quest builder for Tier 1 Quest 5 (Alien Dens)
_DWORD *__cdecl sub_436720(_DWORD *a1, _DWORD *a2)
{
  *a1 = 1132462080;
  a1[1] = 1132462080;
  a1[3] = 8;
  a1[4] = 1500;
  a1[5] = 1;
  a1[6] = 1145044992;
  a1[7] = 1145044992;
  a1[9] = 8;
  a1[10] = 1500;
  a1[11] = 1;
  a1[12] = 1140850688;
  a1[13] = 1140850688;
  a1[15] = 8;
  a1[16] = 23500;
  a1[17] = config_player_count;
  a1[18] = 1132462080;
  a1[19] = 1145044992;
  a1[21] = 8;
  a1[22] = 38500;
  a1[23] = 1;
  a1[24] = 1145044992;
  a1[25] = 1132462080;
  a1[27] = 8;
  a1[28] = 38500;
  a1[29] = 1;
  *a2 = 5;
  return a2;
}

// quest_build_arachnoid_farm @ 0x00436820
// quest builder for Tier 2 Quest 3 (Arachnoid Farm)
int __cdecl sub_436820(int a1, int *a2)
{
  int v2; // edx
  int v3; // ecx
  int v4; // esi
  int v5; // eax
  double v6; // st7
  int v7; // edi
  int v8; // esi
  int v9; // eax
  double v10; // st7
  int v11; // esi
  int v12; // edx
  int result; // eax
  double v14; // st7
  int v15; // [esp+10h] [ebp-Ch]
  int v16; // [esp+10h] [ebp-Ch]
  int v17; // [esp+10h] [ebp-Ch]
  float v18; // [esp+14h] [ebp-8h]
  float v19; // [esp+14h] [ebp-8h]
  float v20; // [esp+14h] [ebp-8h]

  v2 = config_player_count;
  v3 = 0;
  v15 = 0;
  if ( config_player_count + 4 > 0 )
  {
    v4 = 500;
    v5 = a1 + 16;
    do
    {
      v6 = (double)v15;
      ++v3;
      v5 += 24;
      v15 = v3;
      v18 = v6 * 102.4 + 256.0;
      *(float *)(v5 - 40) = v18;
      *(_DWORD *)(v5 - 36) = 1132462080;
      *(_DWORD *)(v5 - 28) = 10;
      *(_DWORD *)(v5 - 24) = v4;
      *(_DWORD *)(v5 - 20) = 1;
      v2 = config_player_count;
      v4 += 500;
    }
    while ( v3 < config_player_count + 4 );
  }
  v7 = 0;
  v16 = 0;
  if ( v2 + 4 > 0 )
  {
    v8 = 10500;
    v9 = a1 + 24 * v3 + 16;
    do
    {
      ++v3;
      v9 += 24;
      ++v7;
      v10 = (double)v16 * 102.4;
      v16 = v7;
      v19 = v10 + 256.0;
      *(float *)(v9 - 40) = v19;
      *(_DWORD *)(v9 - 36) = 1145044992;
      *(_DWORD *)(v9 - 28) = 10;
      *(_DWORD *)(v9 - 24) = v8;
      *(_DWORD *)(v9 - 20) = 1;
      v2 = config_player_count;
      v8 += 500;
    }
    while ( v7 < config_player_count + 4 );
  }
  v11 = 0;
  v17 = 0;
  if ( v2 + 7 <= 0 )
  {
    *a2 = v3;
    return (int)a2;
  }
  else
  {
    v12 = 40500;
    result = a1 + 24 * v3 + 16;
    do
    {
      ++v3;
      result += 24;
      ++v11;
      v14 = (double)v17 * 64.0;
      v17 = v11;
      v20 = v14 + 256.0;
      *(float *)(result - 40) = v20;
      *(_DWORD *)(result - 36) = 1140850688;
      *(_DWORD *)(result - 28) = 16;
      *(_DWORD *)(result - 24) = v12;
      *(_DWORD *)(result - 20) = 1;
      v12 += 3500;
    }
    while ( v11 < config_player_count + 7 );
    *a2 = v3;
  }
  return result;
}

// quest_build_gauntlet @ 0x004369A0
// quest builder for Tier 4 Quest 7 (Gauntlet)
char __cdecl sub_4369A0(int a1, int *a2)
{
  int v2; // edx
  int v3; // esi
  int v4; // ecx
  int v5; // edi
  int v6; // eax
  double v7; // st7
  int v8; // edi
  int v9; // ebx
  int v10; // ecx
  int v11; // ecx
  int v12; // ebx
  int v13; // edi
  int v14; // eax
  double v15; // st7
  char result; // al
  int v17; // [esp+4h] [ebp-8h]
  int v18; // [esp+8h] [ebp-4h]
  int v19; // [esp+8h] [ebp-4h]
  int v20; // [esp+10h] [ebp+4h]

  v2 = config_player_count;
  v3 = 0;
  v17 = 0;
  if ( config_hardcore )
  {
    v2 = config_player_count + 4;
    config_player_count += 4;
  }
  v4 = a1;
  v18 = v2 + 9;
  if ( v2 + 9 > 0 )
  {
    v5 = 0;
    v6 = a1 + 12;
    do
    {
      v6 += 24;
      v7 = (double)v17 * 6.2831855;
      *(float *)(v6 - 36) = cos(v7 / (double)v18) * 158.0 + 512.0;
      v17 = ++v3;
      *(float *)(v6 - 32) = sin(v7 / (double)(config_player_count + 9)) * 158.0 + 512.0;
      *(_DWORD *)(v6 - 24) = 10;
      *(_DWORD *)(v6 - 20) = v5;
      *(_DWORD *)(v6 - 16) = 1;
      v2 = config_player_count;
      v5 += 200;
      v18 = config_player_count + 9;
    }
    while ( v3 < config_player_count + 9 );
  }
  if ( v2 + 9 > 0 )
  {
    v8 = 2;
    v9 = 4000;
    v10 = a1 + 24 * v3;
    do
    {
      v11 = v10 + 72;
      *(float *)(v11 - 72) = (float)(terrain_texture_width + 64);
      v10 = v11 + 24;
      *(float *)(v10 - 92) = (float)(terrain_texture_width / 2);
      *(_DWORD *)(v10 - 84) = 65;
      *(_DWORD *)(v10 - 80) = v9;
      *(_DWORD *)(v10 - 76) = v8;
      *(_DWORD *)(v10 - 72) = -1031798784;
      *(float *)(v10 - 68) = (float)(terrain_texture_width / 2);
      *(_DWORD *)(v10 - 60) = 65;
      *(_DWORD *)(v10 - 56) = v9;
      *(_DWORD *)(v10 - 52) = v8;
      *(float *)(v10 - 48) = (float)(terrain_texture_width / 2);
      *(float *)(v10 - 44) = (float)(terrain_texture_width + 64);
      *(_DWORD *)(v10 - 36) = 65;
      *(_DWORD *)(v10 - 32) = v9;
      *(_DWORD *)(v10 - 28) = v8;
      v3 += 4;
      *(float *)(v10 - 24) = (float)(terrain_texture_width / 2);
      *(_DWORD *)(v10 - 20) = -1031798784;
      *(_DWORD *)(v10 - 12) = 65;
      *(_DWORD *)(v10 - 8) = v9;
      *(_DWORD *)(v10 - 4) = v8;
      v2 = config_player_count;
      v9 += 5500;
      ++v8;
    }
    while ( v8 - 2 < config_player_count + 9 );
    v4 = a1;
  }
  v12 = 0;
  v20 = 0;
  v19 = v2 + 17;
  if ( v2 + 17 > 0 )
  {
    v13 = 42500;
    v14 = v4 + 24 * v3 + 12;
    do
    {
      v14 += 24;
      v15 = (double)v20 * 6.2831855;
      *(float *)(v14 - 36) = cos(v15 / (double)v19) * 258.0 + 512.0;
      ++v3;
      v20 = ++v12;
      *(float *)(v14 - 32) = sin(v15 / (double)(config_player_count + 17)) * 258.0 + 512.0;
      *(_DWORD *)(v14 - 24) = 10;
      *(_DWORD *)(v14 - 20) = v13;
      *(_DWORD *)(v14 - 16) = 1;
      v2 = config_player_count;
      v13 += 500;
      v19 = config_player_count + 17;
    }
    while ( v12 < config_player_count + 17 );
  }
  result = config_hardcore;
  if ( config_hardcore )
    config_player_count = v2 - 4;
  else
    result = (char)a2;
  *a2 = v3;
  return result;
}

// quest_build_syntax_terror @ 0x00436C10
// quest builder for Tier 4 Quest 8 (Syntax Terror)
int __cdecl sub_436C10(int a1, _DWORD *a2)
{
  int v2; // ebp
  int result; // eax
  int v4; // ecx
  int v5; // edi
  int v6; // edx
  int v7; // esi
  int v8; // edx
  int v9; // ebx
  int v10; // ecx
  int v11; // eax
  int v12; // [esp+4h] [ebp-1Ch]
  int v13; // [esp+8h] [ebp-18h]
  int v14; // [esp+Ch] [ebp-14h]
  int v15; // [esp+10h] [ebp-10h]
  int v16; // [esp+14h] [ebp-Ch]
  int v17; // [esp+18h] [ebp-8h]
  int v18; // [esp+1Ch] [ebp-4h]

  v2 = 0;
  v12 = 0;
  if ( config_hardcore )
    config_player_count += 4;
  result = config_player_count;
  v4 = 0;
  v5 = 1500;
  v6 = 5321;
  v13 = 0;
  v15 = 1500;
  v14 = 5321;
  do
  {
    v7 = 0;
    if ( result + 9 > 0 )
    {
      v8 = v4 * v6;
      v16 = v8;
      v9 = 1221;
      v18 = v4 * (76 * v4 * v4 + 27);
      v10 = a1 + 24 * v2 + 12;
      while ( 1 )
      {
        v10 += 24;
        v11 = v9;
        v9 += 21;
        *(float *)(v10 - 36) = (float)((v8 + v7 * (76 * v7 * v7 + 236)) % 896 + 64);
        v2 = v12 + 1;
        v17 = (v18 + v7 * v11) % 896 + 64;
        ++v7;
        ++v12;
        *(float *)(v10 - 32) = (float)v17;
        *(_DWORD *)(v10 - 24) = 7;
        *(_DWORD *)(v10 - 20) = v5;
        *(_DWORD *)(v10 - 16) = 1;
        result = config_player_count;
        v5 += 300;
        if ( v7 >= config_player_count + 9 )
          break;
        v8 = v16;
      }
      v6 = v14;
      v4 = v13;
    }
    v6 += 53;
    ++v4;
    v5 = v15 + 30000;
    v13 = v4;
    v14 = v6;
    v15 += 30000;
  }
  while ( v6 < 5533 );
  if ( config_hardcore )
  {
    config_player_count = result - 4;
    result = (int)a2;
  }
  *a2 = v2;
  return result;
}

// quest_build_spider_spawns @ 0x00436D70
// quest builder for Tier 2 Quest 2 (Spider Spawns)
_DWORD *__cdecl sub_436D70(_DWORD *a1, _DWORD *a2)
{
  *a1 = 1124073472;
  a1[1] = 1124073472;
  a1[3] = 16;
  a1[4] = 1500;
  a1[5] = 1;
  a1[6] = 1147142144;
  a1[7] = 1147142144;
  a1[9] = 16;
  a1[10] = 1500;
  a1[11] = 1;
  a1[12] = 1147142144;
  a1[13] = 1124073472;
  a1[15] = 16;
  a1[16] = 1500;
  a1[17] = 1;
  a1[18] = 1124073472;
  a1[19] = 1147142144;
  a1[21] = 16;
  a1[22] = 1500;
  a1[23] = 1;
  a1[24] = -1031798784;
  a1[25] = 1140850688;
  a1[27] = 56;
  a1[28] = 3000;
  a1[29] = 2;
  a1[30] = 1140850688;
  a1[31] = 1140850688;
  a1[33] = 10;
  a1[34] = 18000;
  a1[35] = 1;
  a1[36] = 1138753536;
  a1[37] = 1138753536;
  a1[39] = 16;
  a1[40] = 20500;
  a1[41] = 1;
  a1[42] = 1141899264;
  a1[43] = 1138753536;
  a1[45] = 16;
  a1[46] = 26000;
  a1[47] = 1;
  a1[48] = 1149763584;
  a1[49] = 1140850688;
  a1[51] = 56;
  a1[52] = 21000;
  a1[53] = 2;
  a1[54] = 1141899264;
  a1[55] = 1141899264;
  a1[57] = 16;
  a1[58] = 31500;
  a1[59] = 1;
  a1[60] = 1138753536;
  a1[61] = 1141899264;
  a1[63] = 16;
  a1[64] = 22000;
  a1[65] = 1;
  *a2 = 11;
  return a2;
}

// quest_build_two_fronts @ 0x00436EE0
// quest builder for Tier 2 Quest 4 (Two Fronts)
_DWORD *__cdecl sub_436EE0(_DWORD *a1, _DWORD *a2)
{
  int v3; // ebx
  int i; // esi
  int v5; // edi
  _DWORD *v6; // ecx
  _DWORD *v7; // ecx

  v3 = 0;
  for ( i = 0; i < 40; ++i )
  {
    a1 += 12;
    *((float *)a1 - 12) = (float)(terrain_texture_width + 64);
    *((float *)a1 - 11) = (float)(terrain_texture_width / 2);
    *(a1 - 9) = 26;
    *(a1 - 8) = 2000 * i + 1000;
    *(a1 - 7) = 1;
    *(a1 - 6) = -1031798784;
    *((float *)a1 - 5) = (float)(terrain_texture_width / 2);
    *(a1 - 3) = 27;
    *(a1 - 2) = 400 * (5 * i + 5);
    *(a1 - 1) = 1;
    v3 += 2;
    if ( i == 10 || i == 20 )
    {
      *a1 = 1132462080;
      v5 = 2000 * i + 2500;
      a1[1] = 1132462080;
      a1[3] = 10;
      a1[4] = v5;
      a1[5] = 1;
      v6 = a1 + 6;
      *v6 = 1145044992;
      v6[1] = 1145044992;
      v6[3] = 7;
      v6[4] = v5;
      v6[5] = 1;
      v3 += 2;
      a1 = v6 + 6;
    }
    if ( i == 30 )
    {
      *a1 = 1145044992;
      a1[1] = 1132462080;
      a1[3] = 10;
      a1[4] = 62500;
      a1[5] = 1;
      v7 = a1 + 6;
      *v7 = 1132462080;
      v7[1] = 1145044992;
      v7[3] = 7;
      v7[4] = 62500;
      v7[5] = 1;
      v3 += 2;
      a1 = v7 + 6;
    }
  }
  *a2 = v3;
  return a2;
}

// quest_build_survival_of_the_fastest @ 0x00437060
// quest builder for Tier 2 Quest 7 (Survival Of The Fastest)
int __cdecl sub_437060(float *a1, _DWORD *a2)
{
  int v3; // ecx
  int v4; // edx
  float *v5; // eax
  double v6; // st7
  int v7; // esi
  float *v8; // edx
  int v9; // esi
  float *v10; // edx
  int v11; // esi
  float *v12; // edx
  int v13; // ebp
  float *v14; // edx
  double v15; // st7
  int v17; // [esp+10h] [ebp-Ch]
  int v18; // [esp+10h] [ebp-Ch]
  int v19; // [esp+10h] [ebp-Ch]
  int v20; // [esp+10h] [ebp-Ch]
  int v21; // [esp+10h] [ebp-Ch]
  float v22; // [esp+14h] [ebp-8h]
  float v23; // [esp+14h] [ebp-8h]
  float v24; // [esp+14h] [ebp-8h]
  float v25; // [esp+18h] [ebp-4h]
  float v26; // [esp+18h] [ebp-4h]
  int v27; // [esp+20h] [ebp+4h]
  int v28; // [esp+20h] [ebp+4h]
  int v29; // [esp+20h] [ebp+4h]
  int v30; // [esp+20h] [ebp+4h]

  v3 = 256;
  v4 = 500;
  v17 = 256;
  v5 = a1 + 4;
  do
  {
    v6 = (double)v17;
    v3 += 72;
    v5 += 6;
    v17 = v3;
    v22 = v6;
    *(v5 - 10) = v22;
    *(v5 - 9) = 256.0;
    *((_DWORD *)v5 - 7) = 16;
    *((_DWORD *)v5 - 6) = v4;
    *((_DWORD *)v5 - 5) = 1;
    v4 += 900;
  }
  while ( v3 < 688 );
  v7 = 256;
  v18 = 5900;
  v27 = 256;
  v8 = a1 + 40;
  do
  {
    v7 += 72;
    *(v8 - 4) = 688.0;
    v8 += 6;
    v25 = (float)v27;
    v27 = v7;
    *(v8 - 9) = v25;
    *((_DWORD *)v8 - 7) = 16;
    *((_DWORD *)v8 - 6) = v18;
    *((_DWORD *)v8 - 5) = 1;
    v18 += 900;
  }
  while ( v7 < 688 );
  v28 = 688;
  v9 = 4;
  v19 = 11300;
  v10 = a1 + 76;
  do
  {
    v10 += 6;
    v23 = (float)v28;
    *(v10 - 10) = v23;
    *(v10 - 9) = 688.0;
    *((_DWORD *)v10 - 7) = 16;
    *((_DWORD *)v10 - 6) = v19;
    *((_DWORD *)v10 - 5) = 1;
    v28 -= 72;
    --v9;
    v19 += 900;
  }
  while ( v9 );
  v29 = 688;
  v11 = 4;
  v20 = 14900;
  v12 = a1 + 100;
  do
  {
    *(v12 - 4) = 400.0;
    v12 += 6;
    v26 = (float)v29;
    *(v12 - 9) = v26;
    *((_DWORD *)v12 - 7) = 16;
    *((_DWORD *)v12 - 6) = v20;
    *((_DWORD *)v12 - 5) = 1;
    v29 -= 72;
    --v11;
    v20 += 900;
  }
  while ( v11 );
  v21 = 18500;
  v13 = 400;
  v30 = 400;
  v14 = a1 + 124;
  do
  {
    v15 = (double)v30;
    v13 += 72;
    v14 += 6;
    v30 = v13;
    v24 = v15;
    *(v14 - 10) = v24;
    *(v14 - 9) = 400.0;
    *((_DWORD *)v14 - 7) = 16;
    *((_DWORD *)v14 - 6) = v21;
    *((_DWORD *)v14 - 5) = 1;
    v21 += 900;
  }
  while ( v13 < 544 );
  a1[132] = 128.0;
  a1[133] = 128.0;
  *((_DWORD *)a1 + 135) = 16;
  *((_DWORD *)a1 + 136) = 22300;
  *((_DWORD *)a1 + 137) = 1;
  a1[138] = 896.0;
  a1[139] = 128.0;
  *((_DWORD *)a1 + 141) = 7;
  *((_DWORD *)a1 + 142) = 22300;
  *((_DWORD *)a1 + 143) = 1;
  a1[144] = 128.0;
  a1[145] = 896.0;
  *((_DWORD *)a1 + 147) = 7;
  *((_DWORD *)a1 + 148) = 24300;
  *((_DWORD *)a1 + 149) = 1;
  a1[150] = 896.0;
  a1[151] = 896.0;
  *((_DWORD *)a1 + 153) = 16;
  *((_DWORD *)a1 + 154) = 24300;
  *((_DWORD *)a1 + 155) = 1;
  *a2 = 26;
  return 26;
}

// quest_build_spideroids @ 0x004373C0
// quest builder for Tier 2 Quest 10 (Spideroids)
int *__cdecl sub_4373C0(int *a1, int *a2)
{
  int *result; // eax
  int v3; // esi
  int *v4; // eax

  result = a1;
  *a1 = 1149763584;
  a1[1] = 1140850688;
  a1[3] = 1;
  a1[4] = 1000;
  a1[5] = 1;
  a1[6] = -1031798784;
  a1[7] = 1140850688;
  a1[9] = 1;
  a1[10] = 3000;
  a1[11] = 1;
  a1[12] = 1149763584;
  a1[13] = 1132462080;
  a1[15] = 1;
  a1[16] = 6000;
  a1[17] = 1;
  v3 = 3;
  if ( config_hardcore )
  {
    a1[18] = 1149763584;
    a1[19] = 1144946688;
    a1[21] = 1;
    a1[22] = 9000;
    a1[23] = 1;
    a1[24] = 1140850688;
    a1[25] = 1149763584;
    a1[27] = 1;
    a1[28] = 9000;
    a1[29] = 1;
    v3 = 5;
  }
  if ( config_player_count >= 2 || config_hardcore )
  {
    v4 = &a1[6 * v3];
    *v4 = -1031798784;
    v4[1] = 1144946688;
    v4[3] = 1;
    v4[4] = 9000;
    v4[5] = 1;
    *a2 = v3 + 1;
    return a2;
  }
  else
  {
    *a2 = v3;
  }
  return result;
}

// quest_build_evil_zombies_at_large @ 0x004374A0
// quest builder for Tier 2 Quest 6 (Evil Zombies At Large)
int __cdecl sub_4374A0(int a1, _DWORD *a2)
{
  int v3; // ebx
  int v4; // esi
  int v5; // edi
  int result; // eax

  v3 = 0;
  v4 = 4;
  v5 = 1500;
  do
  {
    a1 += 96;
    *(float *)(a1 - 96) = (float)(terrain_texture_width + 64);
    *(float *)(a1 - 92) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(a1 - 84) = 65;
    *(_DWORD *)(a1 - 80) = v5;
    *(_DWORD *)(a1 - 76) = v4;
    *(_DWORD *)(a1 - 72) = -1031798784;
    *(float *)(a1 - 68) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(a1 - 60) = 65;
    *(_DWORD *)(a1 - 56) = v5;
    *(_DWORD *)(a1 - 52) = v4;
    *(float *)(a1 - 48) = (float)(terrain_texture_width / 2);
    *(float *)(a1 - 44) = (float)(terrain_texture_width + 64);
    *(_DWORD *)(a1 - 36) = 65;
    *(_DWORD *)(a1 - 32) = v5;
    *(_DWORD *)(a1 - 28) = v4;
    v3 += 4;
    *(float *)(a1 - 24) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(a1 - 20) = -1031798784;
    *(_DWORD *)(a1 - 12) = 65;
    *(_DWORD *)(a1 - 8) = v5;
    *(_DWORD *)(a1 - 4) = v4;
    v5 += 5500;
    result = ++v4 - 4;
  }
  while ( v4 - 4 < 10 );
  *a2 = v3;
  return result;
}

// quest_build_everred_pastures @ 0x004375A0
// quest builder for Tier 2 Quest 1 (Everred Pastures)
_DWORD *__cdecl sub_4375A0(int a1, _DWORD *a2)
{
  int v3; // ebx
  int v4; // ebp
  int v5; // edi
  int v6; // ecx
  int v7; // esi
  int v8; // ecx

  v3 = 0;
  v4 = 0;
  do
  {
    v5 = v4 + 1;
    v6 = a1 + 72;
    *(float *)(v6 - 72) = (float)(terrain_texture_width + 64);
    a1 = v6 + 24;
    *(float *)(a1 - 92) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(a1 - 84) = 50;
    v7 = 13000 * v4 + 1500;
    *(_DWORD *)(a1 - 80) = v7;
    *(_DWORD *)(a1 - 76) = v4 + 1;
    *(_DWORD *)(a1 - 72) = -1031798784;
    *(float *)(a1 - 68) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(a1 - 60) = 51;
    *(_DWORD *)(a1 - 56) = v7;
    *(_DWORD *)(a1 - 52) = v4 + 1;
    *(float *)(a1 - 48) = (float)(terrain_texture_width / 2);
    *(float *)(a1 - 44) = (float)(terrain_texture_width + 64);
    *(_DWORD *)(a1 - 36) = 52;
    *(_DWORD *)(a1 - 32) = v7;
    *(_DWORD *)(a1 - 28) = v4 + 1;
    v3 += 4;
    *(float *)(a1 - 24) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(a1 - 20) = -1031798784;
    *(_DWORD *)(a1 - 12) = 53;
    *(_DWORD *)(a1 - 8) = v7;
    *(_DWORD *)(a1 - 4) = v4 + 1;
    if ( v4 == 3 )
    {
      v8 = a1 + 24;
      *(float *)(v8 - 24) = (float)(terrain_texture_width / 2);
      *(_DWORD *)(v8 - 20) = -1031798784;
      *(_DWORD *)(v8 - 12) = 27;
      *(_DWORD *)(v8 - 8) = 40500;
      *(_DWORD *)(v8 - 4) = 8;
      v3 += 2;
      a1 = v8 + 24;
      *(float *)(a1 - 24) = (float)(terrain_texture_width / 2);
      *(_DWORD *)(a1 - 20) = 1149763584;
      *(_DWORD *)(a1 - 12) = 27;
      *(_DWORD *)(a1 - 8) = 40500;
      *(_DWORD *)(a1 - 4) = 8;
    }
    ++v4;
  }
  while ( v5 < 8 );
  *a2 = v3;
  return a2;
}

// quest_build_lizard_kings @ 0x00437710
// quest builder for Tier 3 Quest 2 (Lizard Kings)
_DWORD *__cdecl sub_437710(_DWORD *a1, _DWORD *a2)
{
  int v3; // ecx
  int v4; // edx
  float *v5; // eax
  double v6; // st7
  int v8; // [esp+14h] [ebp+4h]

  *a1 = 1150287872;
  a1[1] = 1140850688;
  v3 = 1500;
  a1[3] = 17;
  a1[4] = 1500;
  a1[5] = 1;
  a1[6] = -1023410176;
  a1[7] = 1140850688;
  a1[9] = 17;
  a1[10] = 1500;
  a1[11] = 1;
  a1[12] = 1150287872;
  a1[13] = 1147142144;
  a1[15] = 17;
  a1[16] = 1500;
  v4 = 0;
  a1[17] = 1;
  v8 = 0;
  v5 = (float *)(a1 + 21);
  do
  {
    v6 = (double)v8;
    v5 += 6;
    *(v5 - 9) = cos(v6 * 0.34906587) * 256.0 + 512.0;
    *(v5 - 8) = sin(v6 * 0.34906587) * 256.0 + 512.0;
    *((_DWORD *)v5 - 6) = 49;
    *((_DWORD *)v5 - 5) = v3;
    *((_DWORD *)v5 - 4) = 1;
    v3 += 900;
    v8 = ++v4;
    *(v5 - 7) = v6 * -0.34906587;
  }
  while ( v4 < 28 );
  *a2 = 31;
  return a2;
}

// quest_build_sweep_stakes @ 0x00437810
// quest builder for Tier 2 Quest 5 (Sweep Stakes)
_DWORD *__cdecl sub_437810(int a1, _DWORD *a2)
{
  int v2; // esi
  int v3; // edi
  int v4; // eax
  int v5; // ecx
  double v6; // st7
  int v7; // eax
  long double v8; // st7
  long double v9; // st7
  double v10; // st6
  int v11; // eax
  int v13; // [esp+10h] [ebp-18h]
  float v14; // [esp+14h] [ebp-14h]
  float v15; // [esp+18h] [ebp-10h]
  float v16; // [esp+1Ch] [ebp-Ch]
  float v17; // [esp+20h] [ebp-8h]
  int v18; // [esp+2Ch] [ebp+4h]

  v2 = 2000;
  v3 = 2000;
  v18 = a1 + 16;
  do
  {
    v4 = crt_rand();
    v5 = 84;
    v6 = (double)(v4 % 612);
    v7 = v18;
    v13 = 84;
    v18 += 96;
    v8 = v6 * 0.0099999998;
    v14 = cos(v8);
    v9 = sin(v8);
    do
    {
      v10 = (double)v13;
      v5 += 42;
      v7 += 24;
      v13 = v5;
      v17 = v10 * v14;
      v15 = v17 + 512.0;
      *(float *)(v7 - 40) = v15;
      v16 = v10 * v9 + 512.0;
      *(float *)(v7 - 36) = v16;
      *(_DWORD *)(v7 - 28) = 54;
      *(_DWORD *)(v7 - 24) = v2;
      *(_DWORD *)(v7 - 20) = 1;
      *(float *)(v7 - 32) = atan2(*(float *)(v7 - 36) - 512.0, *(float *)(v7 - 40) - 512.0) - 1.5707964;
    }
    while ( v5 < 252 );
    v11 = v3;
    v3 -= 80;
    v2 += v11;
  }
  while ( v3 > 720 );
  *a2 = 64;
  return a2;
}

// quest_build_deja_vu @ 0x00437920
// quest builder for Tier 3 Quest 9 (Deja vu)
_DWORD *__cdecl sub_437920(int a1, _DWORD *a2)
{
  int v2; // esi
  int v3; // ebp
  int v4; // edx
  int v5; // ecx
  int v6; // eax
  long double v7; // st7
  long double v8; // st7
  double v9; // st6
  int v11; // [esp+10h] [ebp-18h]
  float v12; // [esp+14h] [ebp-14h]
  float v13; // [esp+18h] [ebp-10h]
  float v14; // [esp+1Ch] [ebp-Ch]
  float v15; // [esp+20h] [ebp-8h]
  int v16; // [esp+2Ch] [ebp+4h]

  v2 = 2000;
  v11 = 2000;
  v3 = a1 + 16;
  do
  {
    v4 = crt_rand() % 612;
    v5 = 84;
    v6 = v3;
    v3 += 96;
    v16 = 84;
    v7 = (double)v4 * 0.0099999998;
    v12 = cos(v7);
    v8 = sin(v7);
    do
    {
      v9 = (double)v16;
      v5 += 42;
      v6 += 24;
      v16 = v5;
      v15 = v9 * v12;
      v13 = v15 + 512.0;
      *(float *)(v6 - 40) = v13;
      v14 = v9 * v8 + 512.0;
      *(float *)(v6 - 36) = v14;
      *(_DWORD *)(v6 - 28) = 13;
      *(_DWORD *)(v6 - 24) = v2;
      *(_DWORD *)(v6 - 20) = 1;
    }
    while ( v5 < 252 );
    v2 += v11;
    v11 -= 80;
  }
  while ( v11 > 560 );
  *a2 = 72;
  return a2;
}

// quest_build_target_practice @ 0x00437A00
// quest builder for Tier 1 Quest 3 (Target Practice)
int __cdecl sub_437A00(int a1, _DWORD *a2)
{
  int v2; // ebx
  int v3; // edi
  int v4; // esi
  double v5; // st7
  int result; // eax
  float v7; // [esp+10h] [ebp-10h]
  float v8; // [esp+14h] [ebp-Ch]
  float v9; // [esp+18h] [ebp-8h]
  float v10; // [esp+24h] [ebp+4h]

  v2 = 2000;
  v3 = 2000;
  v4 = a1 + 16;
  do
  {
    v10 = (double)(crt_rand() % 612) * 0.0099999998;
    v4 += 24;
    v5 = (double)(32 * (crt_rand() % 8 + 2));
    v9 = cos(v10) * v5;
    v7 = v9 + 512.0;
    *(float *)(v4 - 40) = v7;
    v8 = v5 * sin(v10) + 512.0;
    *(float *)(v4 - 36) = v8;
    *(_DWORD *)(v4 - 28) = 54;
    *(_DWORD *)(v4 - 24) = v2;
    *(_DWORD *)(v4 - 20) = 1;
    result = v3;
    *(float *)(v4 - 32) = atan2(*(float *)(v4 - 36) - 512.0, *(float *)(v4 - 40) - 512.0) - 1.5707964;
    if ( v3 < 1100 )
      result = 1100;
    v3 -= 50;
    v2 += result;
  }
  while ( v3 > 500 );
  *a2 = 30;
  return result;
}

// quest_build_major_alien_breach @ 0x00437AF0
// quest builder for Tier 4 Quest 1 (Major Alien Breach)
_DWORD *__cdecl sub_437AF0(_DWORD *a1, _DWORD *a2)
{
  int v3; // edx
  int v4; // ecx
  int i; // esi
  _DWORD *v6; // eax

  v3 = 0;
  v4 = 4000;
  for ( i = 0; i < 1500; i += 15 )
  {
    *a1 = 1149763584;
    a1[1] = 1140850688;
    a1[3] = 32;
    a1[4] = v4;
    a1[5] = 2;
    v6 = a1 + 6;
    v3 += 2;
    *v6 = 1140850688;
    v6[1] = -1031798784;
    v6[3] = 32;
    v6[4] = v4;
    v6[5] = 2;
    v4 += 2000 - i;
    a1 = v6 + 6;
    if ( v4 < 1000 )
      v4 = 1000;
  }
  *a2 = v3;
  return a2;
}

// quest_build_land_of_lizards @ 0x00437BA0
// quest builder for Tier 2 Quest 8 (Land Of Lizards)
_DWORD *__cdecl sub_437BA0(_DWORD *a1, _DWORD *a2)
{
  *a1 = 1132462080;
  a1[1] = 1132462080;
  a1[3] = 14;
  a1[4] = 2000;
  a1[5] = 1;
  a1[6] = 1145044992;
  a1[7] = 1132462080;
  a1[9] = 14;
  a1[10] = 12000;
  a1[11] = 1;
  a1[12] = 1132462080;
  a1[13] = 1145044992;
  a1[15] = 14;
  a1[16] = 22000;
  a1[17] = 1;
  a1[18] = 1145044992;
  a1[19] = 1145044992;
  a1[21] = 14;
  a1[22] = 32000;
  a1[23] = 1;
  *a2 = 4;
  return a2;
}

// quest_build_the_lizquidation @ 0x00437C70
// quest builder for Tier 3 Quest 6 (The Lizquidation)
int __cdecl sub_437C70(int a1, _DWORD *a2)
{
  int v2; // ecx
  int i; // edi
  int v4; // ebx
  int v5; // esi
  int v6; // ecx
  int v7; // esi
  int result; // eax
  int v9; // esi

  v2 = 0;
  for ( i = 0; i < 10; ++i )
  {
    v4 = 8000 * i + 1500;
    v5 = a1 + 24 * v2;
    *(float *)v5 = (float)(terrain_texture_width + 64);
    v6 = v2 + 1;
    *(float *)(v5 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v5 + 12) = 46;
    *(_DWORD *)(v5 + 16) = v4;
    *(_DWORD *)(v5 + 20) = i + 6;
    v7 = a1 + 24 * v6;
    *(_DWORD *)v7 = -1031798784;
    result = terrain_texture_width / 2;
    v2 = v6 + 1;
    *(float *)(v7 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v7 + 12) = 46;
    *(_DWORD *)(v7 + 16) = v4;
    *(_DWORD *)(v7 + 20) = i + 6;
    if ( i == 4 )
    {
      v9 = a1 + 24 * v2;
      *(float *)v9 = (float)(terrain_texture_width + 128);
      result = terrain_texture_width / 2;
      ++v2;
      *(float *)(v9 + 4) = (float)(terrain_texture_width / 2);
      *(_DWORD *)(v9 + 12) = 43;
      *(_DWORD *)(v9 + 16) = 1500;
      *(_DWORD *)(v9 + 20) = 2;
    }
  }
  *a2 = v2;
  return result;
}

// quest_build_zombie_time @ 0x00437D70
// quest builder for Tier 4 Quest 2 (Zombie Time)
int __cdecl sub_437D70(int a1, _DWORD *a2)
{
  int v2; // esi
  int i; // edi
  int v4; // ecx
  int v5; // esi
  int v6; // ecx
  int result; // eax

  v2 = 0;
  for ( i = 1500; i < 97500; i += 8000 )
  {
    v4 = a1 + 24 * v2;
    *(float *)v4 = (float)(terrain_texture_width + 64);
    v5 = v2 + 1;
    *(float *)(v4 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v4 + 12) = 65;
    *(_DWORD *)(v4 + 16) = i;
    *(_DWORD *)(v4 + 20) = 8;
    v6 = a1 + 24 * v5;
    *(_DWORD *)v6 = -1031798784;
    result = terrain_texture_width / 2;
    v2 = v5 + 1;
    *(float *)(v6 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v6 + 12) = 65;
    *(_DWORD *)(v6 + 16) = i;
    *(_DWORD *)(v6 + 20) = 8;
  }
  *a2 = v2;
  return result;
}

// quest_build_frontline_assault @ 0x00437E10
// quest builder for Tier 1 Quest 4 (Frontline Assault)
int __cdecl sub_437E10(_DWORD *a1, _DWORD *a2)
{
  int v3; // esi
  int v4; // edi
  int i; // ebx
  int result; // eax
  bool v7; // zf
  _DWORD *v8; // ecx

  v3 = 0;
  v4 = 2500;
  for ( i = 2; i < 22; ++i )
  {
    *(float *)a1 = (float)(terrain_texture_width / 2);
    a1[1] = 1149763584;
    if ( i > 4 )
    {
      if ( i < 10 )
        a1[3] = 26;
      else
        a1[3] = 38;
    }
    else
    {
      a1[3] = 38;
    }
    a1 += 6;
    result = v4 * i - 5000;
    ++v3;
    *(a1 - 2) = result;
    *(a1 - 1) = 1;
    if ( i > 4 )
    {
      *a1 = -1031798784;
      a1[1] = -1031798784;
      a1[3] = 38;
      a1[4] = result;
      a1[5] = 1;
      ++v3;
      a1 += 6;
    }
    v7 = i == 10;
    if ( i > 10 )
    {
      *a1 = 1149763584;
      a1[1] = -1031798784;
      a1[3] = 38;
      a1[4] = result;
      a1[5] = 1;
      ++v3;
      a1 += 6;
      v7 = i == 10;
    }
    if ( v7 )
    {
      *a1 = 1149763584;
      a1[1] = 1140850688;
      result = 2 * (5 * v4 - 2500);
      a1[3] = 41;
      a1[4] = result;
      a1[5] = 1;
      v8 = a1 + 6;
      *v8 = -1031798784;
      v8[1] = 1140850688;
      v8[3] = 41;
      v8[4] = result;
      v8[5] = 1;
      v3 += 2;
      a1 = v8 + 6;
    }
    v4 -= 50;
    if ( v4 < 1800 )
      v4 = 1800;
  }
  *a2 = v3;
  return result;
}

// quest_build_the_collaboration @ 0x00437F30
// quest builder for Tier 4 Quest 4 (The Collaboration)
_DWORD *__cdecl sub_437F30(int a1, _DWORD *a2)
{
  int v2; // esi
  int i; // edi
  int v4; // ebx
  int v5; // ecx
  int v6; // esi
  int v7; // ecx
  int v8; // ecx
  int v9; // ecx
  _DWORD *result; // eax
  int v11; // [esp+10h] [ebp-4h]

  v2 = 0;
  v11 = 0;
  for ( i = 1500; i < 177500; i += 11000 )
  {
    v4 = (__int64)((double)v11 * 0.80000001 + 7.0);
    v5 = a1 + 24 * v2;
    *(float *)v5 = (float)(terrain_texture_width + 64);
    v6 = v2 + 1;
    *(float *)(v5 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v5 + 12) = 26;
    *(_DWORD *)(v5 + 16) = i;
    *(_DWORD *)(v5 + 20) = v4;
    v7 = a1 + 24 * v6;
    *(float *)(v7 + 4) = (float)(terrain_texture_width + 64);
    ++v6;
    *(float *)v7 = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v7 + 12) = 27;
    *(_DWORD *)(v7 + 16) = i;
    *(_DWORD *)(v7 + 20) = v4;
    v8 = a1 + 24 * v6;
    *(_DWORD *)v8 = -1031798784;
    ++v6;
    *(float *)(v8 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v8 + 12) = 28;
    *(_DWORD *)(v8 + 16) = i;
    *(_DWORD *)(v8 + 20) = v4;
    v9 = 3 * v6;
    v2 = v6 + 1;
    result = (_DWORD *)(a1 + 8 * v9);
    ++v11;
    *result = 1140850688;
    result[1] = -1031798784;
    result[3] = 65;
    result[4] = i;
    result[5] = v4;
  }
  *a2 = v2;
  return result;
}

// quest_build_the_blighting @ 0x00438050
// quest builder for Tier 3 Quest 1 (The Blighting)
int __cdecl sub_438050(int a1, int *a2)
{
  int v2; // ebx
  int v3; // ebp
  int v4; // edi
  int v5; // esi
  int v6; // ecx
  int v7; // eax
  int result; // eax
  int v9; // edx
  double v10; // st7
  int v11; // [esp+8h] [ebp-8h]

  *(float *)a1 = (float)(terrain_texture_width + 128);
  v2 = 26;
  *(float *)(a1 + 4) = (float)(terrain_texture_width / 2);
  *(_DWORD *)(a1 + 12) = 43;
  *(_DWORD *)(a1 + 16) = 1500;
  *(_DWORD *)(a1 + 20) = 2;
  *(_DWORD *)(a1 + 24) = -1023410176;
  *(float *)(a1 + 28) = (float)(terrain_texture_width / 2);
  *(_DWORD *)(a1 + 36) = 43;
  *(_DWORD *)(a1 + 40) = 1500;
  *(_DWORD *)(a1 + 44) = 2;
  *(_DWORD *)(a1 + 52) = 1124073472;
  *(_DWORD *)(a1 + 48) = 1147142144;
  *(_DWORD *)(a1 + 60) = 7;
  *(_DWORD *)(a1 + 64) = 2000;
  *(_DWORD *)(a1 + 68) = 1;
  *(_DWORD *)(a1 + 76) = 1124073472;
  *(_DWORD *)(a1 + 72) = 1124073472;
  *(_DWORD *)(a1 + 84) = 7;
  *(_DWORD *)(a1 + 88) = 2000;
  *(_DWORD *)(a1 + 92) = 1;
  *(_DWORD *)(a1 + 100) = 1147142144;
  *(_DWORD *)(a1 + 96) = 1124073472;
  *(_DWORD *)(a1 + 108) = 7;
  *(_DWORD *)(a1 + 112) = 2000;
  *(_DWORD *)(a1 + 116) = 1;
  *(_DWORD *)(a1 + 124) = 1147142144;
  *(_DWORD *)(a1 + 120) = 1147142144;
  *(_DWORD *)(a1 + 132) = 7;
  *(_DWORD *)(a1 + 136) = 2000;
  *(_DWORD *)(a1 + 140) = 1;
  v3 = 0;
  v4 = 6;
  v5 = 4000;
  v11 = 0;
  v6 = a1 + 144;
  do
  {
    v7 = v3 % 2;
    if ( v3 == 2 || v3 == 4 )
    {
      *(_DWORD *)v6 = -1023410176;
      ++v4;
      v6 += 24;
      *(float *)(v6 - 20) = (float)(terrain_texture_width / 2);
      *(_DWORD *)(v6 - 12) = 43;
      *(_DWORD *)(v6 - 8) = v5;
      *(_DWORD *)(v6 - 4) = 4;
    }
    if ( v3 == 3 || v3 == 5 )
    {
      *(_DWORD *)v6 = 1150287872;
      ++v4;
      v6 += 24;
      *(float *)(v6 - 20) = (float)(terrain_texture_width / 2);
      *(_DWORD *)(v6 - 12) = 43;
      *(_DWORD *)(v6 - 8) = v5;
      *(_DWORD *)(v6 - 4) = 4;
    }
    if ( v7 )
    {
      if ( v7 == 1 )
        v2 = 28;
    }
    else
    {
      v2 = 26;
    }
    result = v3 / 5;
    v9 = v3 % 5;
    if ( v3 % 5 )
    {
      if ( v9 == 1 )
      {
        *(_DWORD *)v6 = -1031798784;
        result = terrain_texture_width / 2;
        *(float *)(v6 + 4) = (float)(terrain_texture_width / 2);
      }
      else
      {
        if ( v9 == 2 )
        {
          *(float *)(v6 + 4) = (float)(terrain_texture_width + 64);
          result = terrain_texture_width / 2;
          v10 = (double)(terrain_texture_width / 2);
        }
        else
        {
          if ( v9 != 3 )
            goto LABEL_22;
          *(_DWORD *)(v6 + 4) = -1031798784;
          result = terrain_texture_width / 2;
          v10 = (double)(terrain_texture_width / 2);
        }
        *(float *)v6 = v10;
      }
    }
    else
    {
      *(float *)v6 = (float)(terrain_texture_width + 64);
      result = terrain_texture_width / 2;
      *(float *)(v6 + 4) = (float)(terrain_texture_width / 2);
    }
    *(_DWORD *)(v6 + 12) = v2;
    *(_DWORD *)(v6 + 16) = v5;
    *(_DWORD *)(v6 + 20) = 12;
    ++v4;
    v6 += 24;
    v5 += 15000;
LABEL_22:
    v5 += 1000;
    v3 = ++v11;
  }
  while ( v11 < 8 );
  *a2 = v4;
  return result;
}

// quest_build_the_annihilation @ 0x004382C0
// quest builder for Tier 4 Quest 9 (The Annihilation)
_DWORD *__cdecl sub_4382C0(int a1, _DWORD *a2)
{
  int v2; // esi
  int v3; // ebx
  int v4; // edi
  float *v5; // ecx
  char v6; // bl
  int v7; // edi
  int v8; // esi
  float *v9; // ecx

  v2 = 500;
  *(_DWORD *)a1 = 1124073472;
  v3 = 0;
  v4 = 0;
  v5 = (float *)(a1 + 36);
  *(float *)(a1 + 4) = (float)(terrain_texture_width / 2);
  *(_DWORD *)(a1 + 12) = 43;
  *(_DWORD *)(a1 + 16) = 500;
  *(_DWORD *)(a1 + 20) = 2;
  do
  {
    *(v5 - 2) = (float)(v4 / 12 + 128);
    if ( (v3 & 1) != 0 )
      *(v5 - 3) = 896.0;
    else
      *(v5 - 3) = 832.0;
    *(_DWORD *)v5 = 7;
    *((_DWORD *)v5 + 1) = v2;
    *((_DWORD *)v5 + 2) = 1;
    v2 += 500;
    v4 += 768;
    v5 += 6;
    ++v3;
  }
  while ( v3 < 12 );
  v6 = 0;
  v7 = 0;
  v8 = 45000;
  v9 = (float *)(a1 + 324);
  do
  {
    *(v9 - 2) = (float)(v7 / 12 + 128);
    if ( (v6 & 1) != 0 )
      *(v9 - 3) = 832.0;
    else
      *(v9 - 3) = 896.0;
    *(_DWORD *)v9 = 7;
    *((_DWORD *)v9 + 1) = v8;
    *((_DWORD *)v9 + 2) = 1;
    v9 += 6;
    v8 += 300;
    ++v6;
    v7 += 768;
  }
  while ( v8 < 48600 );
  *a2 = 25;
  return a2;
}

// quest_build_the_massacre @ 0x004383E0
// quest builder for Tier 4 Quest 5 (The Massacre)
int __cdecl sub_4383E0(float *a1, _DWORD *a2)
{
  int v3; // ebp
  int v4; // ebx
  int i; // edi
  int v6; // esi
  int v7; // edx
  int result; // eax
  bool v9; // zf
  signed int v10; // ebx

  v3 = 0;
  v4 = 0;
  for ( i = 1500; i < 91500; i += 5000 )
  {
    v6 = v4 + 1;
    a1 += 6;
    *(a1 - 6) = (float)(terrain_texture_width + 64);
    v7 = v4 + 3;
    result = terrain_texture_width / 2;
    ++v3;
    v10 = v4 & 0x80000001;
    v9 = v10 == 0;
    *(a1 - 5) = (float)(terrain_texture_width / 2);
    *((_DWORD *)a1 - 3) = 65;
    *((_DWORD *)a1 - 2) = i;
    *((_DWORD *)a1 - 1) = v7;
    if ( v10 < 0 )
      v9 = (((_BYTE)v10 - 1) | 0xFFFFFFFE) == -1;
    if ( v9 )
    {
      *a1 = (float)(terrain_texture_width + 128);
      result = terrain_texture_width / 2;
      ++v3;
      a1 += 6;
      *(a1 - 5) = (float)(terrain_texture_width / 2);
      *((_DWORD *)a1 - 3) = 43;
      *((_DWORD *)a1 - 2) = i;
      *((_DWORD *)a1 - 1) = v6;
    }
    v4 = v6;
  }
  *a2 = v3;
  return result;
}

// quest_build_the_killing @ 0x004384A0
// quest builder for Tier 3 Quest 3 (The Killing)
_DWORD *__cdecl sub_4384A0(int a1, _DWORD *a2)
{
  int v3; // ebx
  int v4; // edi
  int v5; // ebp
  int v6; // edx
  int v7; // edx
  double v8; // st7
  int v9; // esi
  int i; // [esp+10h] [ebp-4h]

  v3 = 0;
  v4 = 2000;
  v5 = 26;
  for ( i = 0; i < 10; ++i )
  {
    crt_rand();
    v6 = i % 3;
    if ( i % 3 )
    {
      if ( v6 == 1 )
      {
        v5 = 27;
      }
      else if ( v6 == 2 )
      {
        v5 = 28;
      }
    }
    else
    {
      v5 = 26;
    }
    crt_rand();
    v7 = i % 5;
    if ( !(i % 5) )
    {
      *(float *)a1 = (float)(terrain_texture_width + 64);
      v8 = (double)(terrain_texture_width / 2);
LABEL_12:
      *(float *)(a1 + 4) = v8;
      *(_DWORD *)(a1 + 12) = v5;
      *(_DWORD *)(a1 + 16) = v4;
      *(_DWORD *)(a1 + 20) = 12;
      goto LABEL_19;
    }
    switch ( v7 )
    {
      case 1:
        *(_DWORD *)a1 = -1031798784;
        v8 = (double)(terrain_texture_width / 2);
        goto LABEL_12;
      case 2:
        *(float *)(a1 + 4) = (float)(terrain_texture_width + 64);
        *(float *)a1 = (float)(terrain_texture_width / 2);
        *(_DWORD *)(a1 + 12) = v5;
        *(_DWORD *)(a1 + 16) = v4;
        *(_DWORD *)(a1 + 20) = 12;
        break;
      case 3:
        *(_DWORD *)(a1 + 4) = -1031798784;
        *(float *)a1 = (float)(terrain_texture_width / 2);
        *(_DWORD *)(a1 + 12) = v5;
        *(_DWORD *)(a1 + 16) = v4;
        *(_DWORD *)(a1 + 20) = 12;
        break;
      case 4:
        *(float *)(a1 + 4) = (float)(crt_rand() % 768 + 128);
        v9 = a1 + 24;
        *(float *)(v9 - 24) = (float)(crt_rand() % 768 + 128);
        *(_DWORD *)(v9 - 12) = 7;
        *(_DWORD *)(v9 - 8) = v4;
        *(_DWORD *)(v9 - 4) = 3;
        *(float *)(v9 + 4) = (float)(crt_rand() % 768 + 128);
        a1 = v9 + 24;
        v3 += 2;
        *(float *)(a1 - 24) = (float)(crt_rand() % 768 + 128);
        *(_DWORD *)(a1 - 12) = 7;
        *(_DWORD *)(a1 - 8) = v4 + 1000;
        *(_DWORD *)(a1 - 4) = 3;
        *(float *)(a1 + 4) = (float)(crt_rand() % 768 + 128);
        *(float *)a1 = (float)(crt_rand() % 768 + 128);
        *(_DWORD *)(a1 + 12) = 7;
        *(_DWORD *)(a1 + 16) = v4 + 2000;
        *(_DWORD *)(a1 + 20) = 3;
        break;
      default:
        goto LABEL_20;
    }
LABEL_19:
    ++v3;
    a1 += 24;
    v4 += 5000;
LABEL_20:
    v4 += 1000;
  }
  *a2 = v3;
  return a2;
}

// quest_build_lizard_zombie_pact @ 0x00438700
// quest builder for Tier 4 Quest 3 (Lizard Zombie Pact)
int __cdecl sub_438700(int a1, _DWORD *a2)
{
  int v3; // ecx
  int v4; // edi
  int v5; // ebx
  int v6; // esi
  int v7; // ecx
  int v8; // esi
  int result; // eax
  int v10; // esi
  int v11; // edx
  int v12; // edi
  int v13; // ecx
  double v14; // st7
  int v15; // eax
  int v16; // [esp+10h] [ebp-4h]
  int v17; // [esp+18h] [ebp+4h]

  v3 = 0;
  v4 = 0;
  v5 = 1500;
  v16 = 0;
  do
  {
    v6 = a1 + 24 * v3;
    *(float *)v6 = (float)(terrain_texture_width + 64);
    v7 = v3 + 1;
    *(float *)(v6 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v6 + 12) = 65;
    *(_DWORD *)(v6 + 16) = v5;
    *(_DWORD *)(v6 + 20) = 6;
    v8 = a1 + 24 * v7;
    *(_DWORD *)v8 = -1031798784;
    *(float *)(v8 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v8 + 12) = 65;
    *(_DWORD *)(v8 + 16) = v5;
    *(_DWORD *)(v8 + 20) = 6;
    result = v4 / 5;
    v3 = v7 + 1;
    if ( !(v4 % 5) )
    {
      v10 = a1 + 24 * v3;
      *(_DWORD *)v10 = 1135738880;
      v11 = v4 / 5;
      v12 = 180 * (v4 / 5);
      v13 = v3 + 1;
      v14 = (double)(v12 + 256);
      v17 = v12 + 384;
      v4 = v16;
      *(float *)(v10 + 4) = v14;
      *(_DWORD *)(v10 + 12) = 12;
      *(_DWORD *)(v10 + 16) = v5;
      *(_DWORD *)(v10 + 20) = v11 + 1;
      v15 = 3 * v13;
      v3 = v13 + 1;
      result = a1 + 8 * v15;
      *(_DWORD *)result = 1135738880;
      *(float *)(result + 4) = (float)v17;
      *(_DWORD *)(result + 12) = 12;
      *(_DWORD *)(result + 16) = v5;
      *(_DWORD *)(result + 20) = v11 + 2;
    }
    v5 += 7000;
    v16 = ++v4;
  }
  while ( v5 < 113500 );
  *a2 = v3;
  return result;
}

// quest_build_lizard_raze @ 0x00438840
// quest builder for Tier 3 Quest 8 (Lizard Raze)
_DWORD *__cdecl sub_438840(int a1, _DWORD *a2)
{
  int v2; // ecx
  int i; // edi
  int v4; // esi
  int v5; // ecx
  int v6; // esi
  int v7; // edx
  int v8; // ecx
  _DWORD *v9; // eax
  int v10; // eax
  _DWORD *v11; // eax
  _DWORD *result; // eax

  v2 = 0;
  for ( i = 1500; i < 91500; i += 6000 )
  {
    v4 = a1 + 24 * v2;
    *(float *)v4 = (float)(terrain_texture_width + 64);
    v5 = v2 + 1;
    *(float *)(v4 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v4 + 12) = 46;
    *(_DWORD *)(v4 + 16) = i;
    *(_DWORD *)(v4 + 20) = 6;
    v6 = a1 + 24 * v5;
    *(_DWORD *)v6 = -1031798784;
    v2 = v5 + 1;
    *(float *)(v6 + 4) = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v6 + 12) = 46;
    *(_DWORD *)(v6 + 16) = i;
    *(_DWORD *)(v6 + 20) = 6;
  }
  v7 = 3 * v2;
  v8 = v2 + 1;
  v9 = (_DWORD *)(a1 + 8 * v7);
  *v9 = 1124073472;
  v9[1] = 1132462080;
  v9[3] = 12;
  v9[4] = 10000;
  v9[5] = 1;
  v10 = 3 * v8++;
  v11 = (_DWORD *)(a1 + 8 * v10);
  *v11 = 1124073472;
  v11[1] = 1136656384;
  v11[3] = 12;
  v11[4] = 10000;
  v11[5] = 1;
  result = (_DWORD *)(a1 + 24 * v8);
  *result = 1124073472;
  result[1] = 1140850688;
  result[3] = 12;
  result[4] = 10000;
  result[5] = 1;
  *a2 = v8 + 1;
  return result;
}

// quest_build_surrounded_by_reptiles @ 0x00438940
// quest builder for Tier 3 Quest 5 (Surrounded By Reptiles)
_DWORD *__cdecl sub_438940(float *a1, _DWORD *a2)
{
  float *v2; // eax
  int v3; // ecx
  int i; // edx
  double v5; // st7
  float *v6; // eax
  int j; // edx
  double v8; // st7
  int v10; // [esp+Ch] [ebp-4h]
  int v11; // [esp+Ch] [ebp-4h]

  v2 = a1;
  v3 = 0;
  v10 = 0;
  for ( i = 1000; i < 5000; i += 800 )
  {
    *v2 = 256.0;
    v3 += 2;
    v2 += 12;
    v5 = (double)v10 * 0.2 + 256.0;
    v10 += 512;
    *(v2 - 11) = v5;
    *((_DWORD *)v2 - 9) = 13;
    *((_DWORD *)v2 - 8) = i;
    *((_DWORD *)v2 - 7) = 1;
    *(v2 - 6) = 768.0;
    *(v2 - 5) = v5;
    *((_DWORD *)v2 - 3) = 13;
    *((_DWORD *)v2 - 2) = i;
    *((_DWORD *)v2 - 1) = 1;
  }
  v11 = 0;
  v6 = &a1[6 * v3];
  for ( j = 8000; j < 12000; j += 800 )
  {
    v6[1] = 256.0;
    v3 += 2;
    v6 += 12;
    v8 = (double)v11 * 0.2 + 256.0;
    v11 += 512;
    *(v6 - 12) = v8;
    *((_DWORD *)v6 - 9) = 13;
    *((_DWORD *)v6 - 8) = j;
    *((_DWORD *)v6 - 7) = 1;
    *(v6 - 5) = 768.0;
    *(v6 - 6) = v8;
    *((_DWORD *)v6 - 3) = 13;
    *((_DWORD *)v6 - 2) = j;
    *((_DWORD *)v6 - 1) = 1;
  }
  *a2 = v3;
  return a2;
}

// quest_build_the_unblitzkrieg @ 0x00438A40
// quest builder for Tier 4 Quest 6 (The Unblitzkrieg)
_DWORD *__cdecl sub_438A40(int a1, _DWORD *a2)
{
  int v2; // ecx
  int v3; // edi
  int v4; // ebp
  int v5; // esi
  double v6; // st7
  int v7; // eax
  int v8; // edx
  int v9; // ebp
  int v10; // edi
  int v11; // esi
  int v12; // eax
  int v13; // edi
  int v14; // ebp
  _DWORD *v15; // eax
  int v16; // eax
  int v17; // edi
  int v18; // esi
  int v19; // eax
  int v20; // ebp
  int v21; // edi
  int v22; // esi
  int v23; // eax
  int v24; // ebp
  int v25; // edi
  int v26; // esi
  int v27; // eax
  int v28; // ebp
  int v29; // edi
  int v30; // esi
  int v31; // eax
  int v32; // ebp
  int v33; // edi
  int v34; // esi
  int v35; // eax
  int v36; // ebp
  int v37; // edi
  int v38; // esi
  int v40; // [esp+10h] [ebp-8h]
  int v41; // [esp+10h] [ebp-8h]
  int v42; // [esp+10h] [ebp-8h]
  int v43; // [esp+10h] [ebp-8h]
  int v44; // [esp+10h] [ebp-8h]
  int v45; // [esp+10h] [ebp-8h]
  int v46; // [esp+10h] [ebp-8h]

  v2 = 500;
  v3 = 0;
  v4 = 0;
  v5 = a1 + 12;
  do
  {
    *(_DWORD *)(v5 - 12) = 1145962496;
    v6 = (double)(v4 / 10 + 200);
    v4 += 624;
    *(float *)(v5 - 8) = v6;
    v5 += 24;
    v7 = (v3++ & 1) != 0 ? 13 : 7;
    *(_DWORD *)(v5 - 24) = v7;
    *(_DWORD *)(v5 - 20) = v2;
    *(_DWORD *)(v5 - 16) = 1;
    v2 += 1800;
  }
  while ( v4 < 6240 );
  v8 = 3 * v3;
  v9 = 0;
  v10 = v3 + 10;
  v40 = 0;
  v11 = a1 + 8 * v8 + 12;
  do
  {
    *(float *)(v11 - 12) = (float)(824 - v9 / 10);
    *(_DWORD *)(v11 - 8) = 1145962496;
    v11 += 24;
    v9 += 624;
    *(_DWORD *)(v11 - 24) = (v40 & 1) != 0 ? 13 : 7;
    *(_DWORD *)(v11 - 20) = v2;
    *(_DWORD *)(v11 - 16) = 1;
    v2 += 1500;
    ++v40;
  }
  while ( v9 < 6240 );
  v12 = 3 * v10;
  v13 = v10 + 1;
  v14 = 0;
  v15 = (_DWORD *)(a1 + 8 * v12);
  v41 = 0;
  *v15 = 1140850688;
  v15[1] = 1140850688;
  v15[4] = v2;
  v15[3] = 7;
  v15[5] = 1;
  v16 = 3 * v13;
  v17 = v13 + 10;
  v18 = a1 + 8 * v16 + 12;
  do
  {
    *(_DWORD *)(v18 - 12) = 1128792064;
    *(float *)(v18 - 8) = (float)(824 - v14 / 10);
    v18 += 24;
    v14 += 624;
    *(_DWORD *)(v18 - 24) = (v41 & 1) != 0 ? 13 : 7;
    *(_DWORD *)(v18 - 20) = v2;
    *(_DWORD *)(v18 - 16) = 1;
    v2 += 1200;
    ++v41;
  }
  while ( v14 < 6240 );
  v19 = 3 * v17;
  v20 = 0;
  v21 = v17 + 10;
  v42 = 0;
  v22 = a1 + 8 * v19 + 12;
  do
  {
    *(float *)(v22 - 12) = (float)(v20 / 10 + 200);
    *(_DWORD *)(v22 - 8) = 1128792064;
    v22 += 24;
    v20 += 624;
    *(_DWORD *)(v22 - 24) = (v42 & 1) != 0 ? 13 : 7;
    *(_DWORD *)(v22 - 20) = v2;
    *(_DWORD *)(v22 - 16) = 1;
    v2 += 800;
    ++v42;
  }
  while ( v20 < 6240 );
  v23 = 3 * v21;
  v24 = 0;
  v25 = v21 + 10;
  v43 = 0;
  v26 = a1 + 8 * v23 + 12;
  do
  {
    *(_DWORD *)(v26 - 12) = 1145962496;
    *(float *)(v26 - 8) = (float)(v24 / 10 + 200);
    v26 += 24;
    v24 += 624;
    *(_DWORD *)(v26 - 24) = (v43 & 1) != 0 ? 13 : 7;
    *(_DWORD *)(v26 - 20) = v2;
    *(_DWORD *)(v26 - 16) = 1;
    v2 += 800;
    ++v43;
  }
  while ( v24 < 6240 );
  v27 = 3 * v25;
  v28 = 0;
  v29 = v25 + 10;
  v44 = 0;
  v30 = a1 + 8 * v27 + 12;
  do
  {
    *(float *)(v30 - 12) = (float)(824 - v28 / 10);
    *(_DWORD *)(v30 - 8) = 1145962496;
    v30 += 24;
    v28 += 624;
    *(_DWORD *)(v30 - 24) = (v44 & 1) != 0 ? 13 : 7;
    *(_DWORD *)(v30 - 20) = v2;
    *(_DWORD *)(v30 - 16) = 1;
    v2 += 700;
    ++v44;
  }
  while ( v28 < 6240 );
  v31 = 3 * v29;
  v32 = 0;
  v33 = v29 + 10;
  v45 = 0;
  v34 = a1 + 8 * v31 + 12;
  do
  {
    *(_DWORD *)(v34 - 12) = 1128792064;
    *(float *)(v34 - 8) = (float)(824 - v32 / 10);
    v34 += 24;
    v32 += 624;
    *(_DWORD *)(v34 - 24) = (v45 & 1) != 0 ? 13 : 7;
    *(_DWORD *)(v34 - 20) = v2;
    *(_DWORD *)(v34 - 16) = 1;
    v2 += 700;
    ++v45;
  }
  while ( v32 < 6240 );
  v35 = 3 * v33;
  v36 = 0;
  v37 = v33 + 10;
  v46 = 0;
  v38 = a1 + 8 * v35 + 12;
  do
  {
    *(float *)(v38 - 12) = (float)(v36 / 10 + 200);
    *(_DWORD *)(v38 - 8) = 1128792064;
    v38 += 24;
    v36 += 624;
    *(_DWORD *)(v38 - 24) = (v46 & 1) != 0 ? 13 : 7;
    *(_DWORD *)(v38 - 20) = v2;
    *(_DWORD *)(v38 - 16) = 1;
    v2 += 800;
    ++v46;
  }
  while ( v36 < 6240 );
  *a2 = v37;
  return a2;
}

// quest_build_the_end_of_all @ 0x00438E10
// quest builder for Tier 4 Quest 10 (The End of All)
int *__cdecl sub_438E10(float *a1, int *a2)
{
  int v3; // esi
  int v4; // edx
  float *v5; // ecx
  double v6; // st7
  long double v7; // st7
  int v8; // edi
  int v9; // ecx
  int v10; // esi
  int v11; // edx
  float *v12; // ecx
  char v13; // dl
  double v14; // st7
  int v15; // edx
  float *v16; // ecx
  int v17; // edi
  double v18; // st7
  long double v19; // st7
  int v20; // edx
  float *v21; // ecx
  double v22; // st7
  long double v23; // st7
  int v24; // ecx
  char v25; // dl
  int v26; // esi
  int v27; // eax
  int v28; // edi
  double v29; // st7
  int v31; // [esp+10h] [ebp+4h]
  int v32; // [esp+10h] [ebp+4h]
  int v33; // [esp+10h] [ebp+4h]
  int v34; // [esp+10h] [ebp+4h]
  int v35; // [esp+10h] [ebp+4h]

  *a1 = 128.0;
  a1[1] = 128.0;
  *((_DWORD *)a1 + 3) = 60;
  *((_DWORD *)a1 + 4) = 3000;
  *((_DWORD *)a1 + 5) = 1;
  a1[6] = 896.0;
  a1[7] = 128.0;
  *((_DWORD *)a1 + 9) = 60;
  *((_DWORD *)a1 + 10) = 6000;
  *((_DWORD *)a1 + 11) = 1;
  a1[12] = 128.0;
  a1[13] = 896.0;
  *((_DWORD *)a1 + 15) = 60;
  *((_DWORD *)a1 + 16) = 9000;
  *((_DWORD *)a1 + 17) = 1;
  a1[18] = 896.0;
  a1[19] = 896.0;
  *((_DWORD *)a1 + 21) = 60;
  v3 = 0;
  *((_DWORD *)a1 + 22) = 12000;
  *((_DWORD *)a1 + 23) = 1;
  v31 = 0;
  v4 = 13000;
  v5 = a1 + 27;
  do
  {
    v6 = (double)v31;
    v5 += 6;
    v31 = ++v3;
    v7 = v6 * 1.0471976;
    *(v5 - 9) = cos(v7) * 80.0 + 512.0;
    *(v5 - 8) = sin(v7) * 80.0 + 512.0;
    *((_DWORD *)v5 - 6) = 7;
    *((_DWORD *)v5 - 5) = v4;
    *((_DWORD *)v5 - 4) = 1;
    v4 += 300;
  }
  while ( v4 < 14800 );
  v8 = 18000;
  a1[60] = 512.0;
  a1[61] = 512.0;
  v9 = 3 * v3;
  *((_DWORD *)a1 + 63) = 11;
  v10 = 256;
  v32 = 256;
  v11 = 100 * v9 + 13000;
  v12 = a1 + 69;
  *((_DWORD *)a1 + 64) = v11;
  *((_DWORD *)a1 + 65) = 1;
  v13 = 0;
  do
  {
    if ( (v13 & 1) != 0 )
      *(v12 - 3) = 1152.0;
    else
      *(v12 - 3) = -128.0;
    v14 = (double)v32;
    v12 += 6;
    v10 += 128;
    ++v13;
    v32 = v10;
    *(v12 - 8) = v14;
    *((_DWORD *)v12 - 6) = 60;
    *((_DWORD *)v12 - 5) = v8;
    *((_DWORD *)v12 - 4) = 2;
    v8 += 1000;
  }
  while ( v10 < 768 );
  v15 = 43000;
  v33 = 0;
  v16 = a1 + 93;
  v17 = 21;
  do
  {
    v16 += 6;
    v18 = (double)v33++ * 1.0471976;
    v19 = v18 + 0.52359879;
    *(v16 - 9) = cos(v19) * 80.0 + 512.0;
    *(v16 - 8) = sin(v19) * 80.0 + 512.0;
    *((_DWORD *)v16 - 6) = 7;
    *((_DWORD *)v16 - 5) = v15;
    *((_DWORD *)v16 - 4) = 1;
    v15 += 300;
  }
  while ( v15 < 44800 );
  if ( config_hardcore )
  {
    v34 = 0;
    v20 = 62800;
    v21 = a1 + 129;
    v17 = 33;
    do
    {
      v21 += 6;
      v22 = (double)v34++ + 1.0;
      v23 = v22 * 0.52359879;
      *(v21 - 9) = cos(v23) * 180.0 + 512.0;
      *(v21 - 8) = sin(v23) * 180.0 + 512.0;
      *((_DWORD *)v21 - 6) = 7;
      *((_DWORD *)v21 - 5) = v20;
      *((_DWORD *)v21 - 4) = 1;
      v20 += 500;
    }
    while ( v20 < 68800 );
  }
  v24 = 256;
  v25 = 0;
  v26 = 48000;
  v27 = (int)&a1[6 * v17 + 3];
  v35 = 256;
  v28 = v17 + 4;
  do
  {
    if ( (v25 & 1) != 0 )
      *(_DWORD *)(v27 - 12) = 1150287872;
    else
      *(_DWORD *)(v27 - 12) = -1023410176;
    v29 = (double)v35;
    v27 += 24;
    v24 += 128;
    ++v25;
    v35 = v24;
    *(float *)(v27 - 32) = v29;
    *(_DWORD *)(v27 - 24) = 60;
    *(_DWORD *)(v27 - 20) = v26;
    *(_DWORD *)(v27 - 16) = 2;
    v26 += 1000;
  }
  while ( v24 < 768 );
  *a2 = v28;
  return a2;
}

// quest_build_spiders_inc @ 0x004390D0
// quest builder for Tier 3 Quest 7 (Spiders Inc.)
int __cdecl sub_4390D0(int a1, int *a2)
{
  int v3; // ebx
  int v4; // esi
  int v5; // ebp
  int v6; // edi
  int v7; // esi
  int v8; // edi
  int result; // eax
  int v10; // [esp+10h] [ebp+4h]

  *(float *)(a1 + 4) = (float)(terrain_texture_width + 64);
  *(float *)a1 = (float)(terrain_texture_width / 2);
  *(_DWORD *)(a1 + 12) = 56;
  *(_DWORD *)(a1 + 16) = 500;
  *(_DWORD *)(a1 + 20) = 1;
  *(float *)(a1 + 28) = (float)(terrain_texture_width + 64);
  *(float *)(a1 + 24) = (float)(terrain_texture_width / 2 + 64);
  *(_DWORD *)(a1 + 36) = 56;
  *(_DWORD *)(a1 + 40) = 500;
  *(_DWORD *)(a1 + 44) = 1;
  *(_DWORD *)(a1 + 52) = -1031798784;
  v3 = 17000;
  v10 = 0;
  *(float *)(a1 + 48) = (float)(terrain_texture_width / 2);
  *(_DWORD *)(a1 + 60) = 64;
  *(_DWORD *)(a1 + 64) = 500;
  *(_DWORD *)(a1 + 68) = 4;
  v4 = 3;
  do
  {
    v5 = v10 / 2 + 3;
    v6 = a1 + 24 * v4;
    *(float *)(v6 + 4) = (float)(terrain_texture_width + 64);
    v7 = v4 + 1;
    *(float *)v6 = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v6 + 12) = 56;
    *(_DWORD *)(v6 + 16) = v3;
    *(_DWORD *)(v6 + 20) = v5;
    v8 = a1 + 24 * v7;
    *(_DWORD *)(v8 + 4) = -1031798784;
    result = terrain_texture_width / 2;
    v4 = v7 + 1;
    *(float *)v8 = (float)(terrain_texture_width / 2);
    *(_DWORD *)(v8 + 12) = 56;
    *(_DWORD *)(v8 + 16) = v3;
    *(_DWORD *)(v8 + 20) = v5;
    v3 += 6000;
    ++v10;
  }
  while ( v3 < 107000 );
  *a2 = v4;
  return result;
}

// quest_database_init @ 0x00439230
// builds the quest metadata table and registers quest builders
int sub_439230()
{
  int v1; // [esp+10h] [ebp-8h] BYREF
  int v2; // [esp+14h] [ebp-4h] BYREF

  v1 = 0;
  v2 = 0;
  FUN_00430a20((int)&quest_selected_meta, 1, 1, aLandHostile);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 120000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_land_hostile;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aMinorAlienBrea);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 120000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_minor_alien_breach;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTargetPractice);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 65000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_target_practice;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aFrontlineAssau);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_frontline_assault;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aAlienDens);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 180000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_alien_dens;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheRandomFacto);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_random_factor;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aSpiderWaveSynd);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 240000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_spider_wave_syndrome;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aAlienSquads);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 180000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_alien_squads;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aNestingGrounds);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 240000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_nesting_grounds;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, a8LeggedTerror);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 240000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_8_legged_terror;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aEverredPasture);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_everred_pastures;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aSpiderSpawns);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_spider_spawns;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aArachnoidFarm);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 240000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_arachnoid_farm;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTwoFronts);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 240000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_two_fronts;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aSweepStakes);
  *(_DWORD *)(quest_meta_cursor + 40) = 6;
  *(_DWORD *)(quest_meta_cursor + 8) = 35000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_sweep_stakes;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aEvilZombiesAtL);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 180000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_evil_zombies_at_large;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aSurvivalOfTheF);
  *(_DWORD *)(quest_meta_cursor + 40) = 5;
  *(_DWORD *)(quest_meta_cursor + 8) = 120000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_survival_of_the_fastest;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aLandOfLizards);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 180000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_land_of_lizards;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aGhostPatrols);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 180000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_ghost_patrols;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aSpideroids);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 360000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_spideroids;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheBlighting);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_blighting;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aLizardKings);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 180000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_lizard_kings;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheKilling);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_killing;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aHiddenEvil);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_hidden_evil;
  quest_monster_vision_meta = quest_meta_cursor;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aSurroundedByRe);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_surrounded_by_reptiles;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheLizquidatio);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_lizquidation;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aSpidersInc);
  *(_DWORD *)(quest_meta_cursor + 40) = 11;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_spiders_inc;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aLizardRaze);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_lizard_raze;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aDejaVu);
  *(_DWORD *)(quest_meta_cursor + 40) = 6;
  *(_DWORD *)(quest_meta_cursor + 8) = 120000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_deja_vu;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aZombieMasters);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_zombie_masters;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aMajorAlienBrea);
  *(_DWORD *)(quest_meta_cursor + 40) = 18;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_major_alien_breach;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aZombieTime);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_zombie_time;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aLizardZombiePa);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_lizard_zombie_pact;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheCollaborati);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 360000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_collaboration;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheMassacre);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_massacre;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheUnblitzkrie);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 600000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_unblitzkrieg;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aGauntlet);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_gauntlet;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aSyntaxTerror);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_syntax_terror;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheAnnihilatio);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 300000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_annihilation;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheEndOfAll);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 480000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_end_of_all;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheBeating);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 480000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_beating;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheSpankingOfT);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 480000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_spanking_of_the_dead;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheFortress);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 480000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_fortress;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheGangWars);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 480000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_gang_wars;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aKneeDeepInTheD);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 480000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_knee_deep_in_the_dead;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aCrossFire);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 480000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_cross_fire;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aArmyOfThree);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 480000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_army_of_three;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aMonsterBlues);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 480000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_monster_blues;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aNagolipoli);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 480000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_nagolipoli;
  quest_database_advance_slot(&v2, &v1);
  FUN_00430a20(44 * (v1 + 10 * v2) + 4736816, v2 + 1, v1 + 1, aTheGathering);
  *(_DWORD *)(quest_meta_cursor + 40) = 1;
  *(_DWORD *)(quest_meta_cursor + 8) = 480000;
  *(_DWORD *)(quest_meta_cursor + 28) = quest_build_the_gathering;
  quest_database_advance_slot(&v2, &v1);
  quest_unlock_weapon_id[0] = 2;
  dword_484780 = 3;
  dword_4847AC = 0;
  dword_4847D8 = 8;
  dword_484804 = 0;
  dword_484830 = 5;
  dword_48485C = 0;
  dword_484888 = 6;
  dword_4848B4 = 0;
  dword_4848E0 = 12;
  dword_48490C = 0;
  dword_484938 = 9;
  dword_484964 = 0;
  dword_484990 = 21;
  dword_4849BC = 0;
  dword_4849E8 = 7;
  dword_484A14 = 0;
  dword_484A40 = 4;
  dword_484A6C = 0;
  dword_484A98 = 11;
  dword_484AC4 = 0;
  dword_484AF0 = 10;
  dword_484B1C = 0;
  dword_484B48 = 13;
  dword_484B74 = 0;
  dword_484BA0 = 15;
  dword_484BCC = 0;
  dword_484BF8 = 18;
  dword_484C24 = 0;
  dword_484C50 = 20;
  dword_484C7C = 0;
  dword_484CA8 = 19;
  dword_484CD4 = 0;
  dword_484D00 = 14;
  dword_484D2C = 0;
  dword_484D58 = 17;
  dword_484D84 = 0;
  dword_484DB0 = 22;
  dword_484DDC = 0;
  dword_484E08 = 23;
  quest_unlock_perk_id[0] = perk_id_antiperk;
  dword_48477C = perk_id_antiperk;
  dword_4847A8 = 28;
  dword_4847D4 = perk_id_antiperk;
  dword_484800 = 29;
  dword_48482C = perk_id_antiperk;
  dword_484858 = 30;
  dword_484884 = perk_id_antiperk;
  dword_4848B0 = 31;
  dword_4848DC = perk_id_antiperk;
  dword_484908 = 32;
  dword_484934 = perk_id_antiperk;
  dword_484960 = 33;
  dword_48498C = perk_id_antiperk;
  dword_4849B8 = 34;
  dword_4849E4 = perk_id_antiperk;
  dword_484A10 = 35;
  dword_484A3C = perk_id_antiperk;
  dword_484A68 = 36;
  dword_484A94 = perk_id_antiperk;
  dword_484AC0 = 37;
  dword_484AEC = perk_id_antiperk;
  dword_484B18 = 38;
  dword_484B44 = perk_id_antiperk;
  dword_484B70 = 39;
  dword_484B9C = perk_id_antiperk;
  dword_484BC8 = 40;
  dword_484BF4 = perk_id_antiperk;
  dword_484C20 = 41;
  dword_484C4C = perk_id_antiperk;
  dword_484C78 = 42;
  dword_484CA4 = perk_id_antiperk;
  dword_484CD0 = 43;
  dword_484CFC = perk_id_antiperk;
  dword_484D28 = 44;
  dword_484D54 = perk_id_antiperk;
  dword_484D80 = 45;
  dword_484DAC = perk_id_antiperk;
  dword_484DD8 = 46;
  dword_484E04 = perk_id_antiperk;
  dword_484E34 = 31;
  dword_484E30 = perk_id_antiperk;
  dword_484E60 = 0;
  dword_484E5C = 47;
  dword_484E8C = 0;
  dword_484E88 = 48;
  dword_484EB8 = 30;
  dword_484EB4 = perk_id_antiperk;
  dword_484EE4 = 0;
  dword_484EE0 = 49;
  dword_484F10 = 0;
  dword_484F0C = 50;
  dword_484F3C = 0;
  dword_484F38 = perk_id_antiperk;
  dword_484F68 = 0;
  dword_484F64 = 51;
  dword_484F94 = 0;
  dword_484F90 = 52;
  dword_484FC0 = 28;
  dword_484FBC = perk_id_antiperk;
  return perk_id_antiperk;
}

// quest_start_selected @ 0x0043A790
// resets quest state, selects quest metadata, and runs its builder
int *__cdecl sub_43A790(int ArgList, int a2)
{
  int v2; // esi
  int (__cdecl *v3)(void *, int *); // ebp
  int *result; // eax
  int v5; // edi
  int v6; // ebp
  int v7; // edx
  int v8; // esi
  int v9; // ecx
  int v10; // esi
  float v11; // [esp+10h] [ebp-8h]
  float v12; // [esp+14h] [ebp-4h]

  FUN_004281e0();
  quest_spawn_count = 0;
  quest_spawn_timeline = 0;
  dword_487244 = 0;
  fx_queue_rotated = 0;
  fx_queue_count = 0;
  highscore_full_version_marker = 0;
  survival_elapsed_ms = 0;
  highscore_score_xp = 0;
  highscore_record_quest_minor = 0;
  highscore_record_quest_major = 0;
  highscore_record_game_mode = 0;
  highscore_record_weapon_id = 0;
  creature_kill_count = 0;
  highscore_record_shots_hit = 0;
  highscore_record_shots_fired = 0;
  byte_487081 = 0;
  highscore_year_offset = 0;
  highscore_month = 0;
  highscore_day = 0;
  highscore_flags = 0;
  dword_487078 = crt_rand() & 0xFEE050F;
  projectile_reset_pools();
  v11 = (double)terrain_texture_width * 0.5;
  *(float *)player_pos_x = v11;
  v12 = (double)terrain_texture_height * 0.5;
  *(float *)player_pos_y = v12;
  v2 = 11 * (a2 + 10 * ArgList - 11);
  terrain_generate((char *)&quest_selected_meta + v2 * 4);
  weapon_assign_player(0, quest_start_weapon_id[v2]);
  weapon_assign_player(1, quest_start_weapon_id[v2]);
  console_printf((int)&console_log_queue, "Setup tier %d quest %d.\n", ArgList, a2);
  v3 = *(int (__cdecl **)(void *, int *))((char *)&quest_selected_meta + v2 * 4 + 28);
  if ( v3 )
    result = (int *)v3(&quest_spawn_table, &quest_spawn_count);
  else
    result = quest_build_fallback((int)&quest_spawn_table, &quest_spawn_count);
  v5 = 0;
  v6 = 0;
  dword_486FD4 = 0;
  dword_487030 = 0;
  if ( quest_spawn_count > 0 )
  {
    result = (int *)&unk_4857BC;
    v7 = quest_spawn_count;
    do
    {
      if ( config_hardcore )
      {
        v8 = *result;
        if ( *result > 1 )
        {
          v9 = *(result - 2);
          if ( v9 != 60 )
          {
            if ( v9 == 43 )
              v10 = v8 + 2;
            else
              v10 = v8 + 8;
            *result = v10;
          }
        }
      }
      v5 += *result;
      if ( v6 < *(result - 1) )
        v6 = *(result - 1);
      result += 6;
      --v7;
    }
    while ( v7 );
    dword_487030 = v6;
    dword_486FD4 = v5;
  }
  return result;
}

// highscore_date_checksum @ 0x0043A950
// computes a week-of-year style checksum for high score validation
int __cdecl sub_43A950(int a1, int a2, int a3)
{
  int v3; // edx
  int v4; // ecx
  int v5; // edi
  int v6; // ecx

  v3 = (14 - a2) / 12;
  v4 = a1 - v3 + 4800;
  v5 = 365 * v4 + v4 / 400 + (153 * (a2 + 12 * v3) - 457) / 5 - v4 / 100;
  v6 = (v4 / 4 + v5 + a3 - 32045 - (v4 / 4 + v5 + a3 - 32045) % 7 + 31741) % 146097 % 36524 % 1461;
  return (v6 / 1460 + (v6 - v6 / 1460) % 365) / 7 + 1;
}

// sub_43AA60 @ 0x0043AA60
char __thiscall sub_43AA60(std::codecvt_base *this)
{
  if ( !game_is_full_version(this) )
    console_printf((int)&console_log_queue, aPotentiallyIll);
  return 1;
}

// FUN_0043aa90 @ 0x0043AA90
// [binja] void* sub_43aa90(void* arg1, void* arg2)
char *__cdecl sub_43AA90(int a1, int a2)
{
  char *result; // eax

  result = strcpy((char *)a2, (const char *)a1);
  *(_DWORD *)(a2 + 32) = *(_DWORD *)(a1 + 32);
  *(_DWORD *)(a2 + 36) = *(_DWORD *)(a1 + 36);
  *(_BYTE *)(a2 + 40) = *(_BYTE *)(a1 + 40);
  *(_BYTE *)(a2 + 41) = *(_BYTE *)(a1 + 41);
  *(_BYTE *)(a2 + 42) = *(_BYTE *)(a1 + 42);
  *(_BYTE *)(a2 + 43) = *(_BYTE *)(a1 + 43);
  *(_DWORD *)(a2 + 44) = *(_DWORD *)(a1 + 44);
  *(_DWORD *)(a2 + 52) = *(_DWORD *)(a1 + 52);
  *(_DWORD *)(a2 + 48) = *(_DWORD *)(a1 + 48);
  *(_DWORD *)(a2 + 56) = *(_DWORD *)(a1 + 56);
  *(_DWORD *)(a2 + 60) = 0;
  return result;
}

// highscore_read_record @ 0x0043AB10
// reads and validates a high score record from a file
char *__cdecl sub_43AB10(char *Buffer, FILE *Stream)
{
  int v2; // ebp
  unsigned int i; // ecx
  char *v5; // ecx
  int v6; // edi
  int v7; // [esp+Ch] [ebp-4h] BYREF

  v2 = 0;
  v7 = 0;
  crt_fread(Buffer, 0x48u, 1u, Stream);
  if ( (Stream->_flag & 0x10) != 0 )
    return 0;
  crt_fread(&v7, 4u, 1u, Stream);
  for ( i = 0; i < 0x48; ++i )
    Buffer[i] += -6 - i * (5 * i + 1);
  v5 = Buffer;
  v6 = 72;
  do
  {
    v2 += 7 * *v5 * (_DWORD)&v5[3 - (_DWORD)Buffer];
    ++v5;
    --v6;
  }
  while ( v6 );
  if ( v7 == v2 )
    return Buffer;
  Buffer[31] = 0;
  console_printf((int)&console_log_queue, "WARN: checksum failure on score by %s\n", Buffer);
  return 0;
}

// highscore_record_equals @ 0x0043ABD0
// compares high score record metadata and name for equality
bool __cdecl sub_43ABD0(int a1, int a2)
{
  if ( *(_DWORD *)(a1 + 36) != *(_DWORD *)(a2 + 36) )
    return 0;
  if ( *(_DWORD *)(a1 + 32) != *(_DWORD *)(a2 + 32) )
    return 0;
  if ( *(_BYTE *)(a1 + 40) != *(_BYTE *)(a2 + 40) )
    return 0;
  if ( *(_DWORD *)(a1 + 52) != *(_DWORD *)(a2 + 52) )
    return 0;
  if ( *(_DWORD *)(a1 + 48) != *(_DWORD *)(a2 + 48) )
    return 0;
  if ( *(_DWORD *)(a1 + 44) == *(_DWORD *)(a2 + 44) )
    return strcmp((const char *)a1, (const char *)a2) == 0;
  return 0;
}

// highscore_update_record @ 0x0043AC70
// updates a matching record in the high score file when allowed
char __cdecl sub_43AC70(char *FileName, int a2)
{
  FILE *v2; // eax
  FILE *v3; // esi
  _DWORD Buffer[18]; // [esp+8h] [ebp-48h] BYREF

  memset(Buffer, 0, sizeof(Buffer));
  strcpy((char *)Buffer, default_player_name);
  LOBYTE(Buffer[17]) = 0;
  HIWORD(Buffer[17]) = -132;
  Buffer[14] = crt_rand() & 0xFEE050F;
  v2 = crt_fopen(FileName, aRB);
  v3 = v2;
  if ( !v2 )
    return 0;
  if ( (v2->_flag & 0x10) != 0 )
  {
LABEL_6:
    crt_fflush(v3);
    crt_fclose(v3);
    return 0;
  }
  while ( !highscore_read_record((char *)Buffer, v3) || !highscore_record_equals(a2, (int)Buffer) )
  {
    if ( (v3->_flag & 0x10) != 0 )
      goto LABEL_6;
  }
  if ( (Buffer[17] & 2) != 0 )
  {
    crt_fclose(v3);
    return 1;
  }
  else
  {
    if ( !LOBYTE(Buffer[17]) )
      *(_BYTE *)(a2 + 68) = 2;
    crt_fseek(v3, -76, 1);
    highscore_write_record(a2, v3);
    crt_fflush(v3);
    crt_fclose(v3);
    return 1;
  }
}

// highscore_write_record @ 0x0043AD70
// writes a high score record with date + checksum
int __cdecl sub_43AD70(_BYTE *a1, FILE *Stream)
{
  int v2; // edi
  unsigned int i; // ecx
  unsigned int j; // ecx
  int v6; // [esp+8h] [ebp-4Ch] BYREF
  _DWORD Buffer[18]; // [esp+Ch] [ebp-48h] BYREF

  v6 = 0;
  GetLocalTime(&local_system_time);
  memset(Buffer, 0, sizeof(Buffer));
  strcpy((char *)Buffer, default_player_name);
  LOBYTE(Buffer[17]) = 0;
  HIWORD(Buffer[17]) = -132;
  Buffer[14] = crt_rand() & 0xFEE050F;
  if ( !a1[64] )
  {
    a1[64] = local_system_time.wDay;
    a1[66] = local_system_time.wMonth;
    a1[67] = LOBYTE(local_system_time.wYear) + 48;
    a1[65] = highscore_date_checksum(local_system_time.wYear, local_system_time.wMonth, local_system_time.wDay);
  }
  qmemcpy(Buffer, a1, sizeof(Buffer));
  v2 = v6;
  for ( i = 0; i < 0x48; ++i )
    v2 += 7 * *((char *)Buffer + i) * ((_DWORD)Buffer + i + 3 - (_DWORD)Buffer);
  v6 = v2;
  for ( j = 0; j < 0x48; ++j )
    *((_BYTE *)Buffer + j) += j * (5 * j + 1) + 6;
  crt_fwrite(Buffer, 0x48u, 1u, Stream);
  return crt_fwrite(&v6, 4u, 1u, Stream);
}

// CompareFunction @ 0x0043AEB0
int __cdecl CompareFunction(_DWORD *a1, _DWORD *a2)
{
  int v2; // eax
  int v3; // ecx

  v2 = a1[9];
  v3 = a2[9];
  if ( v2 <= v3 )
    return v2 < v3;
  else
    return -1;
}

// sub_43AED0 @ 0x0043AED0
int __cdecl sub_43AED0(int a1, int a2)
{
  int v2; // eax
  int v3; // ecx

  v2 = *(_DWORD *)(a1 + 32);
  v3 = *(_DWORD *)(a2 + 32);
  if ( v2 <= v3 )
    return v2 < v3;
  else
    return -1;
}

// sub_43AEF0 @ 0x0043AEF0
int __cdecl sub_43AEF0(int a1, int a2)
{
  int v2; // ecx
  int v4; // eax

  v2 = *(_DWORD *)(a1 + 32);
  if ( !v2 )
    return 1;
  v4 = *(_DWORD *)(a2 + 32);
  if ( !v4 )
    return -1;
  if ( v2 <= v4 )
    return (v2 >= v4) - 1;
  return 1;
}

// highscore_find_name_entry @ 0x0043AF30
// finds a matching name entry in the loaded high score table
int __cdecl sub_43AF30(const char *a1, int a2)
{
  int v2; // ebp
  const char *i; // edi

  v2 = 0;
  if ( a2 <= 0 )
    return 0;
  for ( i = (const char *)&highscore_table; strcmp(a1, i); i += 72 )
  {
    if ( ++v2 >= a2 )
      return 0;
  }
  return 72 * v2 + 4729616;
}

// highscore_load_table @ 0x0043AFA0
// loads, filters, and sorts the high score table
char sub_43AFA0()
{
  const char *v0; // ebx
  _BYTE *v1; // ebp
  int v2; // ebp
  FILE *v3; // eax
  FILE *v4; // ebx
  int v5; // ecx
  void *v6; // eax
  int *v7; // edi
  int *v8; // eax
  int *v9; // eax
  int v10; // edx
  std::codecvt_base *v11; // esi
  int v12; // edx
  int v13; // ecx
  int v14; // edx
  int v15; // ebp
  char *v16; // edi
  char *v17; // ecx
  std::codecvt_base *v18; // edx
  int v20; // [esp+10h] [ebp-58h]
  int v21; // [esp+14h] [ebp-54h]
  int v22; // [esp+18h] [ebp-50h]
  int v23; // [esp+1Ch] [ebp-4Ch]
  int v24; // [esp+1Ch] [ebp-4Ch]
  _DWORD Buffer[18]; // [esp+20h] [ebp-48h] BYREF

  memset(Buffer, 0, sizeof(Buffer));
  strcpy((char *)Buffer, default_player_name);
  LOBYTE(Buffer[17]) = 0;
  HIWORD(Buffer[17]) = -132;
  Buffer[14] = crt_rand() & 0xFEE050F;
  v0 = (const char *)highscore_build_path();
  dword_4C395C = 0;
  v1 = &unk_482B56;
  do
  {
    memset(v1 - 70, 0, 0x48u);
    strcpy(v1 - 70, default_player_name);
    *(v1 - 2) = 0;
    *v1 = 124;
    v1[1] = -1;
    *(_DWORD *)(v1 - 14) = crt_rand() & 0xFEE050F;
    v1 += 72;
  }
  while ( (int)v1 < (int)byte_484776 );
  v2 = 0;
  v3 = crt_fopen(v0, file_mode_read_binary);
  v4 = v3;
  if ( v3 )
  {
    v23 = highscore_date_checksum(local_system_time.wYear, local_system_time.wMonth, local_system_time.wDay);
    while ( (v4->_flag & 0x10) == 0 )
    {
      if ( !highscore_read_record((char *)Buffer, v4) )
        continue;
      v5 = config_game_mode;
      if ( LOBYTE(Buffer[10]) != config_game_mode )
        continue;
      if ( config_game_mode == 3 )
      {
        if ( config_hardcore )
        {
          if ( BYTE1(Buffer[17]) != 117 )
            continue;
        }
        else if ( BYTE1(Buffer[17]) )
        {
          continue;
        }
      }
      if ( !config_score_load_gate && (Buffer[17] & 1) != 0 && (Buffer[17] & 2) == 0 )
        continue;
      if ( BYTE2(config_blob[0]) == 3 )
      {
        if ( local_system_time.wDay != LOBYTE(Buffer[16])
          || local_system_time.wYear - 2000 != HIBYTE(Buffer[16])
          || local_system_time.wMonth != BYTE2(Buffer[16]) )
        {
          continue;
        }
      }
      else if ( BYTE2(config_blob[0]) == 2 )
      {
        if ( v23 != BYTE1(Buffer[16]) || local_system_time.wYear != HIBYTE(Buffer[16]) + 2000 )
          continue;
      }
      else if ( BYTE2(config_blob[0]) == 1
             && (local_system_time.wMonth != BYTE2(Buffer[16]) || local_system_time.wYear - 2000 != HIBYTE(Buffer[16])) )
      {
        continue;
      }
      if ( HIBYTE(config_blob[0]) != 1 )
        goto LABEL_31;
      v6 = (void *)highscore_find_name_entry((const char *)Buffer, v2);
      if ( !v6 )
      {
        v5 = config_game_mode;
LABEL_31:
        if ( v2 == 99 )
        {
          v7 = &highscore_table;
          if ( v5 == 2 )
          {
            v8 = (int *)&unk_482B58;
            do
            {
              if ( v8[8] < v7[8] )
                v7 = v8;
              v8 += 18;
            }
            while ( (int)v8 < (int)quest_selected_meta );
          }
          else
          {
            v9 = (int *)&unk_482B58;
            if ( v5 == 3 )
            {
              do
              {
                if ( v9[8] > v7[8] )
                  v7 = v9;
                v9 += 18;
              }
              while ( (int)v9 < (int)quest_selected_meta );
            }
            else
            {
              do
              {
                if ( v9[9] < v7[9] )
                  v7 = v9;
                v9 += 18;
              }
              while ( (int)v9 < (int)quest_selected_meta );
            }
          }
          qmemcpy(v7, Buffer, 0x48u);
        }
        else
        {
          v10 = 9 * v2++;
          dword_4C395C = (std::codecvt_base *)v2;
          qmemcpy((void *)(8 * v10 + 4729616), Buffer, 0x48u);
        }
        continue;
      }
      qmemcpy(v6, Buffer, 0x48u);
    }
    crt_fclose(v4);
    if ( (int)dword_4C395C > 100 )
      dword_4C395C = (std::codecvt_base *)100;
    if ( config_game_mode == 2 )
    {
      crt_qsort(&highscore_table, 0x64u, 0x48u, (_CoreCrtNonSecureSearchSortCompareFunction)sub_43AED0);
    }
    else if ( config_game_mode == 3 )
    {
      crt_qsort(&highscore_table, 0x64u, 0x48u, (_CoreCrtNonSecureSearchSortCompareFunction)sub_43AEF0);
    }
    else
    {
      crt_qsort(&highscore_table, 0x64u, 0x48u, (_CoreCrtNonSecureSearchSortCompareFunction)CompareFunction);
    }
    LOBYTE(v3) = config_name_slot_selected;
    if ( config_name_slot_selected )
    {
      LOBYTE(v3) = (_BYTE)dword_4C395C;
      if ( (int)dword_4C395C > 0 )
      {
        v17 = byte_482B54;
        v18 = dword_4C395C;
        do
        {
          LOBYTE(v3) = *v17;
          if ( (*v17 & 1) != 0 )
          {
            LOBYTE(v3) = (unsigned __int8)v3 | 4;
            *v17 = (char)v3;
          }
          v17 += 72;
          v18 = (std::codecvt_base *)((char *)v18 - 1);
        }
        while ( v18 );
      }
    }
    else
    {
      v11 = dword_4C395C;
      v12 = 0;
      v24 = 0;
      if ( (int)dword_4C395C > 0 )
      {
        v13 = 0;
        v22 = 0;
        while ( 1 )
        {
          LOBYTE(v3) = byte_482B54[v13];
          v21 = v12;
          if ( ((unsigned __int8)v3 & 4) == 0 && ((unsigned __int8)v3 & 1) != 0 )
            break;
LABEL_72:
          ++v12;
          v13 += 72;
          v24 = v12;
          v22 = v13;
          if ( v12 >= (int)v11 )
            return (char)v3;
        }
        v14 = 0;
        v20 = v13;
        v15 = 0;
        while ( 1 )
        {
          v16 = (char *)&highscore_table + v15;
          if ( (byte_482B54[v15] & 1) != 0
            && !strcmp((const char *)&highscore_table + v13, (const char *)&highscore_table + v15) )
          {
            if ( byte_482B38[v20] == 2 )
            {
              if ( *(int *)((char *)&dword_482B30 + v20) >= *((_DWORD *)v16 + 8) )
                goto LABEL_70;
            }
            else if ( *(int *)((char *)&dword_482B34 + v20) >= *((_DWORD *)v16 + 9) )
            {
              goto LABEL_70;
            }
            v21 = v14;
            v20 = v15;
          }
LABEL_70:
          v11 = dword_4C395C;
          ++v14;
          v15 += 72;
          if ( v14 >= (int)dword_4C395C )
          {
            v12 = v24;
            LOBYTE(v3) = 9 * v21;
            byte_482B54[72 * v21] |= 4u;
            v13 = v22;
            goto LABEL_72;
          }
          v13 = v22;
        }
      }
    }
  }
  return (char)v3;
}

// highscore_save_record @ 0x0043B450
// saves a high score record (updates or appends)
char __cdecl sub_43B450(int a1)
{
  char *v1; // ebx
  char result; // al
  signed int i; // ecx
  FILE *v4; // eax
  FILE *v5; // edi

  v1 = (char *)highscore_build_path();
  if ( !a1 )
    return console_printf((int)&console_log_queue, aUnexpectedScIs);
  for ( i = strlen((const char *)a1) - 1; i > 0; --i )
  {
    if ( *(_BYTE *)(i + a1) != 32 )
      break;
    *(_BYTE *)(i + a1) = 0;
  }
  CreateDirectoryA(PathName, 0);
  if ( !byte_4871C9 )
    highscore_record_init();
  if ( (*(_BYTE *)(a1 + 68) & 1) == 0 || (result = highscore_update_record(v1, a1)) == 0 )
  {
    v4 = crt_fopen(v1, aAb);
    v5 = v4;
    if ( v4 )
    {
      highscore_write_record((_BYTE *)a1, v4);
      return crt_fclose(v5);
    }
    else
    {
      return console_printf((int)&console_log_queue, aUnableToSaveSc);
    }
  }
  return result;
}

// highscore_save_active @ 0x0043B510
// saves the active high score record
char sub_43B510()
{
  return highscore_save_record((int)highscore_active_record);
}

// highscore_rank_index @ 0x0043B520
// returns the insert index for the current run in the high score table
std::codecvt_base *sub_43B520()
{
  std::codecvt_base *v0; // ecx
  std::codecvt_base *result; // eax
  int *i; // edx
  int *j; // edx
  int *k; // edx

  if ( config_game_mode == 2 )
  {
    v0 = dword_4C395C;
    result = 0;
    if ( (int)dword_4C395C > 0 )
    {
      for ( i = &dword_482B30; survival_elapsed_ms <= *i; i += 18 )
      {
        result = (std::codecvt_base *)((char *)result + 1);
        if ( (int)result >= (int)dword_4C395C )
          return dword_4C395C;
      }
      return result;
    }
    return v0;
  }
  if ( config_game_mode == 3 )
  {
    v0 = dword_4C395C;
    result = 0;
    if ( (int)dword_4C395C <= 0 )
      return v0;
    for ( j = &dword_482B30; survival_elapsed_ms >= *j; j += 18 )
    {
      result = (std::codecvt_base *)((char *)result + 1);
      if ( (int)result >= (int)dword_4C395C )
        return dword_4C395C;
    }
  }
  else
  {
    v0 = dword_4C395C;
    result = 0;
    if ( (int)dword_4C395C <= 0 )
      return v0;
    for ( k = &dword_482B34; highscore_score_xp <= *k; k += 18 )
    {
      result = (std::codecvt_base *)((char *)result + 1);
      if ( (int)result >= (int)dword_4C395C )
        return v0;
    }
  }
  return result;
}

// highscore_build_path @ 0x0043B5B0
// builds the high score filename for the current mode
char *sub_43B5B0()
{
  unsigned int v0; // kr04_4

  if ( !byte_4C3960 )
  {
    crt_getcwd(byte_4C375C, 511);
    byte_4C395B = 0;
    byte_4C3960 = 1;
  }
  switch ( config_game_mode )
  {
    case 2:
      crt_sprintf(&byte_4C36DC, "%s\\scores5\\rush.hi", byte_4C375C);
      break;
    case 1:
      crt_sprintf(&byte_4C36DC, "%s\\scores5\\survival.hi", byte_4C375C);
      break;
    case 3:
      if ( config_hardcore )
        crt_sprintf(
          &byte_4C36DC,
          "%s\\scores5\\quest%d_%d.hi",
          byte_4C375C,
          *(_DWORD *)quest_stage_major,
          quest_stage_minor);
      else
        crt_sprintf(
          &byte_4C36DC,
          "%s\\scores5\\questhc%d_%d.hi",
          byte_4C375C,
          *(_DWORD *)quest_stage_major,
          quest_stage_minor);
      break;
    default:
      crt_sprintf(&byte_4C36DC, "scores5\\unknown.hi");
      break;
  }
  if ( config_player_count == 2 )
  {
    v0 = strlen(&byte_4C36DC) + 1;
    *(&byte_4C36DC + v0 - 4) = 95;
    *(&byte_4C36DC + v0 - 3) = 50;
    *(&byte_4C36DC + v0 - 2) = 46;
    *(&byte_4C36DC + v0 - 1) = 104;
    *(&byte_4C36DC + v0) = 105;
    byte_4C36DD[v0] = 0;
  }
  if ( config_name_slot_selected )
  {
    crt_sprintf(byte_4C365C, "%s%s", &byte_4C36DC, &config_saved_name_0[27 * config_name_slot_selected]);
    console_printf((int)&console_log_queue, "Opening named cache '%s'\n", byte_4C365C);
    return byte_4C365C;
  }
  else
  {
    if ( *(float *)(dword_480864 + 12) != 0.0 )
      console_printf((int)&console_log_queue, "Opening '%s'\n", &byte_4C36DC);
    return &byte_4C36DC;
  }
}

// highscore_record_init @ 0x0043B750
// fills the active high score record metadata for the current run
int sub_43B750()
{
  char v0; // bl
  int v1; // eax
  int v2; // edx

  v0 = 1;
  v1 = 1;
  v2 = 1;
  do
  {
    if ( dword_48708C[v1] > dword_48708C[v2] )
    {
      v0 = v1;
      v2 = v1;
    }
    ++v1;
  }
  while ( v1 < 64 );
  highscore_record_weapon_id = v0;
  if ( highscore_record_shots_hit > highscore_record_shots_fired )
    highscore_record_shots_hit = highscore_record_shots_fired;
  highscore_record_game_mode = config_game_mode;
  highscore_record_quest_major = quest_stage_major[0];
  highscore_record_quest_minor = quest_stage_minor;
  highscore_flags = 0;
  dword_487078 = crt_rand() % 0x10000000 + 784;
  highscore_full_version_marker = config_hardcore != 0 ? 0x75 : 0;
  return config_hardcore != 0 ? 0x75 : 0;
}

// FUN_0043b810 @ 0x0043B810
// [binja] void* __fastcall sub_43b810(void* arg1)
_DWORD *__thiscall sub_43B810(_DWORD *this)
{
  _DWORD *result; // eax
  int v2; // esi
  _DWORD *v3; // ecx

  result = this;
  v2 = 16;
  *(this + 32) = 0;
  *(this + 31) = 0;
  *(this + 30) = 0;
  *(this + 29) = 0;
  *(this + 5) = 0;
  *(this + 6) = 0;
  *(this + 7) = 0;
  *(this + 8) = -1082130432;
  v3 = this + 24;
  do
  {
    *v3-- = 0;
    --v2;
  }
  while ( v2 );
  return result;
}

// buffer_reader_init @ 0x0043B850
// initializes the buffer reader cursor and length
int __cdecl sub_43B850(int a1, int a2)
{
  dword_4C3C70 = a1;
  dword_4C3C74 = a2;
  dword_4C3C78 = 0;
  return a1;
}

// buffer_reader_seek @ 0x0043B870
// sets the buffer reader cursor
int __cdecl sub_43B870(int a1)
{
  dword_4C3C78 = a1;
  return a1;
}

// buffer_reader_read_u16 @ 0x0043B880
// reads a little-endian u16 from the buffer
__int16 sub_43B880()
{
  __int16 result; // ax

  result = *(_WORD *)(dword_4C3C78 + dword_4C3C70);
  dword_4C3C78 += 2;
  return result;
}

// buffer_reader_read_u32 @ 0x0043B8A0
// reads a little-endian u32 from the buffer
int sub_43B8A0()
{
  int result; // eax

  result = *(_DWORD *)(dword_4C3C78 + dword_4C3C70);
  dword_4C3C78 += 4;
  return result;
}

// buffer_reader_skip @ 0x0043B8C0
// advances the buffer reader cursor
int __cdecl sub_43B8C0(int a1)
{
  dword_4C3C78 += a1;
  return a1;
}

// buffer_reader_find_tag @ 0x0043B8E0
// searches the buffer for a tag and updates the cursor
char __cdecl sub_43B8E0(int a1, int a2)
{
  int v2; // edi
  int i; // eax

  v2 = 0;
  if ( dword_4C3C74 <= 0 )
    return 0;
  while ( 1 )
  {
    for ( i = 0; i < a2; ++i )
    {
      if ( *(_BYTE *)(dword_4C3C70 + v2 + i) != *(_BYTE *)(i + a1) )
        break;
    }
    if ( i == a2 )
      break;
    if ( ++v2 >= dword_4C3C74 )
      return 0;
  }
  dword_4C3C78 = a2 + v2;
  return 1;
}

// resource_pack_read_cstring @ 0x0043B940
// reads a NUL-terminated pack entry name into DAT_004c3a68
unsigned int __cdecl sub_43B940(FILE *Stream)
{
  int i; // edi
  int v2; // eax

  for ( i = 0; (Stream->_flag & 0x10) == 0; byte_4C3A68[i++] = v2 )
  {
    v2 = crt_getc(Stream);
    if ( !v2 )
      break;
  }
  byte_4C3A68[i] = 0;
  return ((unsigned int)~Stream->_flag >> 4) & 1;
}

// resource_pack_set @ 0x0043B980
// validates and sets the active resource pack path
char __cdecl sub_43B980(char *FileName)
{
  FILE *v1; // edx

  v1 = crt_fopen(FileName, file_mode_read_binary);
  if ( v1 )
  {
    strcpy(&byte_4C3968, FileName);
    byte_4C3C6C = 1;
    crt_fclose(v1);
    return 1;
  }
  else
  {
    byte_4C3968 = 0;
    byte_4C3C6C = 0;
    return 0;
  }
}

// resource_open_read @ 0x0043B9E0
// opens a resource from the active pack or filesystem and returns its size
char __cdecl sub_43B9E0(char *String2, int *Offset)
{
  int *v2; // ebx
  FILE *v3; // eax
  FILE *v5; // esi
  FILE *v6; // eax

  v2 = Offset;
  if ( byte_4C3C6C )
  {
    v3 = crt_fopen(&byte_4C3968, file_mode_read_binary);
    Stream = v3;
    if ( !v3 )
      return 0;
    v5 = v3;
    crt_fseek(v3, 4, 0);
    while ( (unsigned __int8)resource_pack_read_cstring(v5) )
    {
      crt_fread(&Offset, 4u, 1u, v5);
      *v2 = (int)Offset;
      if ( !_strcmpi(byte_4C3A68, String2) )
        return 1;
      crt_fseek(v5, (int)Offset, 1);
    }
    crt_fclose(v5);
  }
  v6 = crt_fopen(String2, file_mode_read_binary);
  Stream = v6;
  if ( !v6 )
    return 0;
  crt_fseek(v6, 0, 2);
  *v2 = crt_ftell(Stream);
  crt_fseek(Stream, 0, 0);
  return 1;
}

// resource_close @ 0x0043BAD0
// closes the current resource file handle
FILE *sub_43BAD0()
{
  FILE *result; // eax

  result = Stream;
  if ( Stream )
    return (FILE *)crt_fclose(Stream);
  return result;
}

// dsound_init @ 0x0043BAF0
// initializes DirectSound and the primary buffer
char __cdecl sub_43BAF0(HWND a1, DWORD a2, __int16 a3, int a4, unsigned __int16 a5)
{
  int v6; // [esp+28h] [ebp-3Ch] BYREF
  _WORD v7[2]; // [esp+2Ch] [ebp-38h] BYREF
  int v8; // [esp+30h] [ebp-34h]
  int v9; // [esp+34h] [ebp-30h]
  unsigned __int16 v10; // [esp+38h] [ebp-2Ch]
  unsigned __int16 v11; // [esp+3Ah] [ebp-2Ah]
  __int16 v12; // [esp+3Ch] [ebp-28h]
  _DWORD v13[9]; // [esp+40h] [ebp-24h] BYREF

  if ( ppDS8 )
    ppDS8->lpVtbl->Release(ppDS8);
  ppDS8 = 0;
  if ( DirectSoundCreate8(0, &ppDS8, 0) < 0 )
    return 0;
  if ( ppDS8->lpVtbl->SetCooperativeLevel(ppDS8, a1, a2) < 0 )
    return 0;
  memset(v13, 0, sizeof(v13));
  v6 = 0;
  v13[0] = 36;
  v13[1] = 1;
  v13[2] = 0;
  v13[4] = 0;
  if ( ppDS8->lpVtbl->CreateSoundBuffer(ppDS8, (LPCDSBUFFERDESC)v13, (LPDIRECTSOUNDBUFFER *)&v6, 0) < 0 )
    return 0;
  v7[0] = 1;
  v7[1] = a3;
  v11 = a5;
  v10 = a3 * (a5 >> 3);
  v12 = 0;
  v8 = a4;
  v9 = a4 * v10;
  if ( (*(int (__stdcall **)(int, _WORD *))(*(_DWORD *)v6 + 56))(v6, v7) < 0 )
    return 0;
  if ( v6 )
    (*(void (__stdcall **)(int))(*(_DWORD *)v6 + 8))(v6);
  return 1;
}

// dsound_restore_buffer @ 0x0043BC40
// restores a lost DirectSound buffer
char __cdecl sub_43BC40(int a1)
{
  int v1; // esi
  int v2; // eax

  v1 = a1;
  if ( !a1 || (*(int (__stdcall **)(int, int *))(*(_DWORD *)a1 + 36))(a1, &a1) < 0 || (a1 & 2) == 0 )
    return 0;
  do
  {
    while ( 1 )
    {
      v2 = (*(int (__stdcall **)(int))(*(_DWORD *)v1 + 80))(v1);
      if ( v2 != -2005401450 )
        break;
      Sleep(0xAu);
    }
  }
  while ( v2 );
  OutputDebugStringA(OutputString);
  return 1;
}

// resource_read_alloc @ 0x0043BCA0
// reads a resource into a newly allocated buffer
char __cdecl sub_43BCA0(char *String2, _DWORD *a2, int *Offset)
{
  char result; // al
  FILE *v4; // ebx
  void *v5; // esi

  result = resource_open_read(String2, Offset);
  if ( result )
  {
    v4 = Stream;
    v5 = operator new(*Offset);
    crt_fread(v5, *Offset, 1u, v4);
    resource_close();
    *a2 = v5;
    return 1;
  }
  return result;
}

// sfx_entry_load_ogg @ 0x0043BCF0
// loads an OGG sample into an sfx entry
char __cdecl sub_43BCF0(int a1, char *String2)
{
  char result; // al
  FILE *v3; // edi
  char *v4; // esi
  unsigned __int16 v5; // ax
  int v6; // ecx
  int v7; // eax
  unsigned int v8; // eax
  void *v9; // eax
  int v10; // edi
  int i; // eax
  unsigned int v12; // [esp-4h] [ebp-320h]
  size_t ElementSize; // [esp+8h] [ebp-314h] BYREF
  LPVOID v14[185]; // [esp+Ch] [ebp-310h] BYREF
  unsigned int v15; // [esp+2F0h] [ebp-2Ch]
  int v16; // [esp+300h] [ebp-1Ch]
  int v17; // [esp+304h] [ebp-18h]

  result = resource_open_read(String2, (int *)&ElementSize);
  if ( result )
  {
    v3 = Stream;
    v4 = (char *)operator new(ElementSize + 8);
    crt_fread(v4 + 8, ElementSize, 1u, v3);
    resource_close();
    result = vorbis_mem_open(
               (unsigned int (__cdecl **)(void *, int, int, int))v14,
               (unsigned int (__cdecl *)(void *, int, int, int))v4,
               ElementSize);
    if ( result )
    {
      *(_DWORD *)a1 = 0;
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      *(_DWORD *)(a1 + 12) = 0;
      *(_WORD *)(a1 + 16) = 0;
      v5 = v16;
      *(_WORD *)(a1 + 2) = v16;
      v6 = v17;
      *(_WORD *)a1 = 1;
      v7 = 16 * v5 / 8;
      *(_WORD *)(a1 + 12) = v7;
      *(_DWORD *)(a1 + 8) = v6 * (unsigned __int16)v7;
      v8 = v15;
      v12 = v15;
      *(_DWORD *)(a1 + 4) = v6;
      *(_WORD *)(a1 + 14) = 16;
      *(_WORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 24) = v8;
      v9 = operator new(v12);
      v10 = *(_DWORD *)(a1 + 24);
      *(_DWORD *)(a1 + 20) = v9;
      for ( i = 1; v10; v10 -= i )
      {
        if ( !i )
          break;
        i = vorbis_read_pcm16((char *)v14, *(_DWORD *)(a1 + 20) + *(_DWORD *)(a1 + 24) - v10, v10);
      }
      vorbis_mem_close(v14);
      return (unsigned __int8)sfx_entry_create_buffers(a1) != 0;
    }
  }
  return result;
}

// sfx_entry_seek @ 0x0043BE20
// seeks streaming sfx data and resets playback cursors
int __cdecl sub_43BE20(int a1, int a2)
{
  int result; // eax

  if ( *(_DWORD *)(a1 + 116) )
  {
    (*(void (__stdcall **)(_DWORD, int))(**(_DWORD **)(a1 + 36) + 52))(*(_DWORD *)(a1 + 36), a2);
    result = vorbis_pcm_seek(*(char **)(a1 + 116), a2);
    *(_DWORD *)(a1 + 28) = 0;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 124) = 0;
    *(_DWORD *)(a1 + 128) = 0;
  }
  return result;
}

// sfx_entry_start_playback @ 0x0043BE60
// selects a voice/buffer and starts playback
int __cdecl sub_43BE60(int a1)
{
  int v1; // edi
  _DWORD *v3; // ebp
  int v4; // esi

  v1 = a1;
  if ( !a1 )
    return -1;
  v3 = (_DWORD *)(a1 + 36);
  if ( dsound_restore_buffer(*(_DWORD *)(a1 + 36)) )
  {
    if ( *(_DWORD *)(v1 + 116) )
    {
LABEL_7:
      sfx_entry_seek(v1, 0);
      music_stream_fill(v1);
      music_stream_fill(v1);
      music_stream_fill(v1);
      (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, int))(*(_DWORD *)*v3 + 48))(*v3, 0, 0, 1);
      return 0;
    }
    sfx_entry_upload_buffer(v1);
  }
  if ( *(_DWORD *)(v1 + 116) )
    goto LABEL_7;
  v4 = 0;
  while ( 1 )
  {
    if ( *v3 )
    {
      (*(void (__stdcall **)(_DWORD, int *))(*(_DWORD *)*v3 + 36))(*v3, &a1);
      if ( (a1 & 1) == 0 )
        break;
    }
    ++v4;
    ++v3;
    if ( v4 >= 16 )
    {
      v4 = crt_rand() % 16;
      (*(void (__stdcall **)(_DWORD))(**(_DWORD **)(v1 + 4 * v4 + 36) + 72))(*(_DWORD *)(v1 + 4 * v4 + 36));
      break;
    }
  }
  (*(void (__stdcall **)(_DWORD, int))(**(_DWORD **)(v1 + 4 * v4 + 36) + 68))(
    *(_DWORD *)(v1 + 4 * v4 + 36),
    sfx_rate_scale);
  (*(void (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(**(_DWORD **)(v1 + 4 * v4 + 36) + 48))(
    *(_DWORD *)(v1 + 4 * v4 + 36),
    0,
    0,
    0);
  return v4;
}

// sfx_entry_resume @ 0x0043BF40
// restarts playback for a streaming entry
int __cdecl sub_43BF40(int a1)
{
  int result; // eax

  result = a1;
  if ( *(_DWORD *)(a1 + 116) )
    return (*(int (__stdcall **)(_DWORD, _DWORD, _DWORD, int))(**(_DWORD **)(a1 + 36) + 48))(
             *(_DWORD *)(a1 + 36),
             0,
             0,
             1);
  return result;
}

// sfx_entry_stop @ 0x0043BF60
// stops playback for all voices
int __cdecl sub_43BF60(int a1)
{
  int result; // eax
  int *v2; // esi
  int v3; // edi

  result = a1;
  if ( a1 )
  {
    if ( *(_DWORD *)(a1 + 116) )
    {
      result = *(_DWORD *)(a1 + 36);
      if ( result )
        return (*(int (__stdcall **)(int))(*(_DWORD *)result + 72))(result);
    }
    else
    {
      v2 = (int *)(a1 + 36);
      v3 = 16;
      do
      {
        result = *v2;
        if ( *v2 )
          result = (*(int (__stdcall **)(int))(*(_DWORD *)result + 72))(*v2);
        ++v2;
        --v3;
      }
      while ( v3 );
    }
  }
  return result;
}

// sfx_entry_set_volume @ 0x0043BFA0
// sets the volume for active voices
void __cdecl sub_43BFA0(int a1, float a2)
{
  int v2; // ebx
  _DWORD *v3; // edi
  float v4; // [esp+Ch] [ebp+8h]

  v4 = (a2 + 2.0) * 0.33333334;
  if ( !*(_DWORD *)(a1 + 116) || *(float *)(a1 + 32) != v4 )
  {
    v2 = 0;
    *(float *)(a1 + 32) = v4;
    v3 = (_DWORD *)(a1 + 36);
    do
    {
      if ( *v3 )
      {
        (*(void (__stdcall **)(_DWORD, _DWORD))(*(_DWORD *)*v3 + 60))(*v3, (__int64)((1.0 - v4) * -10000.0));
        if ( *(_DWORD *)(a1 + 116) )
          break;
      }
      ++v2;
      ++v3;
    }
    while ( v2 < 16 );
  }
}

// sfx_entry_load_wav @ 0x0043C020
// loads a WAV sample into an sfx entry
char __cdecl sub_43C020(int a1, char *String2)
{
  char result; // al
  int Offset; // [esp+4h] [ebp-4h] BYREF

  result = resource_read_alloc(String2, &String2, &Offset);
  if ( result )
  {
    if ( (unsigned __int8)wav_parse_into_entry(a1, String2, Offset) )
    {
      crt_free(String2);
      return (unsigned __int8)sfx_entry_create_buffers(a1) != 0;
    }
    else
    {
      crt_free(String2);
      return 0;
    }
  }
  return result;
}

// sfx_release_entry @ 0x0043C090
// frees a sound entry (sample/voices)
int __cdecl sub_43C090(int a1)
{
  LPVOID *v1; // ecx
  int v2; // eax
  void *v3; // edx
  int result; // eax
  _DWORD *v5; // esi
  int v6; // ebx

  v1 = *(LPVOID **)(a1 + 116);
  if ( v1 )
  {
    vorbis_mem_close(v1);
    crt_free(*(LPVOID *)(a1 + 116));
    v2 = *(_DWORD *)(a1 + 36);
    *(_DWORD *)(a1 + 116) = 0;
    if ( v2 )
      (*(void (__stdcall **)(int))(*(_DWORD *)v2 + 8))(v2);
    v3 = *(void **)(a1 + 20);
    *(_DWORD *)(a1 + 36) = 0;
    result = crt_free(v3);
    *(_DWORD *)(a1 + 20) = 0;
  }
  else
  {
    v5 = (_DWORD *)(a1 + 96);
    v6 = 16;
    do
    {
      if ( *v5 )
        (*(void (__stdcall **)(_DWORD))(*(_DWORD *)*v5 + 8))(*v5);
      *v5-- = 0;
      --v6;
    }
    while ( v6 );
    result = crt_free(*(LPVOID *)(a1 + 20));
    *(_DWORD *)(a1 + 20) = 0;
  }
  return result;
}

// wav_parse_into_entry @ 0x0043C110
// parses WAV data into an entry and copies PCM
char __cdecl sub_43C110(int a1, int a2, int a3)
{
  char result; // al
  unsigned __int16 v4; // cx
  unsigned __int16 v5; // ax
  int v6; // eax
  unsigned int v7; // ebx
  void *v8; // eax

  *(_DWORD *)a1 = 0;
  *(_DWORD *)(a1 + 4) = 0;
  *(_DWORD *)(a1 + 8) = 0;
  *(_DWORD *)(a1 + 12) = 0;
  *(_WORD *)(a1 + 16) = 0;
  *(_WORD *)a1 = 1;
  *(_WORD *)(a1 + 2) = 1;
  *(_WORD *)(a1 + 14) = 16;
  *(_DWORD *)(a1 + 4) = 22050;
  *(_WORD *)(a1 + 12) = 2;
  *(_WORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 8) = 44100;
  buffer_reader_init(a2, a3);
  buffer_reader_seek(0);
  result = buffer_reader_find_tag((int)aFmt, 4);
  if ( result )
  {
    buffer_reader_skip(4);
    buffer_reader_skip(2);
    *(_WORD *)(a1 + 2) = buffer_reader_read_u16();
    *(_DWORD *)(a1 + 4) = buffer_reader_read_u32();
    buffer_reader_skip(6);
    v4 = buffer_reader_read_u16();
    v5 = *(_WORD *)(a1 + 2);
    *(_WORD *)(a1 + 14) = v4;
    *(_WORD *)(a1 + 16) = 0;
    v6 = v4 * v5 / 8;
    *(_WORD *)(a1 + 12) = v6;
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 4) * (unsigned __int16)v6;
    buffer_reader_find_tag((int)aData, 4);
    v7 = buffer_reader_read_u32();
    *(_DWORD *)(a1 + 24) = v7;
    v8 = operator new(v7);
    *(_DWORD *)(a1 + 20) = v8;
    qmemcpy(v8, (const void *)(dword_4C3C78 + a2), v7);
    return 1;
  }
  return result;
}

// sfx_entry_upload_buffer @ 0x0043C230
// uploads PCM data into a DirectSound buffer
char __cdecl sub_43C230(int a1)
{
  int v1; // ebx
  char result; // al
  int v3; // [esp+20h] [ebp-4h] BYREF

  v1 = a1;
  if ( (*(int (__stdcall **)(_DWORD, _DWORD, _DWORD, int *, int *, _DWORD, _DWORD, _DWORD))(**(_DWORD **)(a1 + 36) + 44))(
         *(_DWORD *)(a1 + 36),
         0,
         *(_DWORD *)(a1 + 24),
         &a1,
         &v3,
         0,
         0,
         0) != -2005401450
    || (result = dsound_restore_buffer(*(_DWORD *)(v1 + 36))) != 0 )
  {
    qmemcpy((void *)a1, *(const void **)(v1 + 20), *(_DWORD *)(v1 + 24));
    (*(void (__stdcall **)(_DWORD, int, int, _DWORD, _DWORD))(**(_DWORD **)(v1 + 36) + 76))(
      *(_DWORD *)(v1 + 36),
      a1,
      v3,
      0,
      0);
    return 1;
  }
  return result;
}

// sfx_entry_create_buffers @ 0x0043C2B0
// creates DirectSound buffers for an sfx entry
char __cdecl sub_43C2B0(int a1)
{
  int v2; // edi
  LPDIRECTSOUNDBUFFER *v3; // esi
  int v4; // esi
  _DWORD *v5; // edi
  _DWORD v6[9]; // [esp+10h] [ebp-24h] BYREF

  memset(v6, 0, sizeof(v6));
  v6[2] = *(_DWORD *)(a1 + 24);
  memset(&v6[5], 0, 16);
  v6[0] = 36;
  v6[1] = 32992;
  v6[4] = a1;
  if ( ppDS8->lpVtbl->CreateSoundBuffer(ppDS8, (LPCDSBUFFERDESC)v6, (LPDIRECTSOUNDBUFFER *)(a1 + 36), 0) < 0 )
    return 0;
  v2 = 1;
  v3 = (LPDIRECTSOUNDBUFFER *)(a1 + 40);
  do
  {
    if ( ppDS8->lpVtbl->DuplicateSoundBuffer(ppDS8, *(LPDIRECTSOUNDBUFFER *)(a1 + 36), v3) < 0 )
    {
      OutputDebugStringA(aSndFailedToDup);
      return 0;
    }
    ++v2;
    ++v3;
  }
  while ( v2 < 16 );
  sfx_entry_upload_buffer(a1);
  v4 = 0;
  v5 = (_DWORD *)(a1 + 36);
  do
  {
    *(_BYTE *)(v4 + a1 + 100) = 0;
    (*(void (__stdcall **)(_DWORD))(*(_DWORD *)*v5 + 72))(*v5);
    (*(void (__stdcall **)(_DWORD, _DWORD))(*(_DWORD *)*v5 + 52))(*v5, 0);
    ++v4;
    ++v5;
  }
  while ( v4 < 16 );
  return 1;
}

// music_entry_load_ogg @ 0x0043C3A0
// loads an OGG stream into a music entry
char __cdecl sub_43C3A0(int a1, char *ElementSize)
{
  char result; // al
  FILE *v3; // esi
  char *v4; // edi
  unsigned int (__cdecl **v5)(void *, int, int, int); // eax
  char *v6; // edx
  int v7; // eax
  unsigned __int16 v8; // dx
  int v9; // eax
  void *v10; // edi
  unsigned int v11; // edx
  int v12; // eax
  _DWORD v13[9]; // [esp+8h] [ebp-24h] BYREF

  result = resource_open_read(ElementSize, (int *)&ElementSize);
  if ( result )
  {
    v3 = Stream;
    v4 = (char *)operator new((unsigned int)(ElementSize + 8));
    crt_fread(v4 + 8, (size_t)ElementSize, 1u, v3);
    resource_close();
    v5 = (unsigned int (__cdecl **)(void *, int, int, int))operator new(0x310u);
    v6 = ElementSize;
    *(_DWORD *)(a1 + 116) = v5;
    result = vorbis_mem_open(v5, (unsigned int (__cdecl *)(void *, int, int, int))v4, (int)v6);
    if ( result )
    {
      *(_DWORD *)a1 = 0;
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      *(_DWORD *)(a1 + 12) = 0;
      *(_WORD *)(a1 + 16) = 0;
      v7 = *(_DWORD *)(a1 + 116);
      *(_WORD *)a1 = 1;
      v8 = *(_WORD *)(v7 + 756);
      *(_WORD *)(a1 + 2) = v8;
      *(_DWORD *)(a1 + 4) = *(_DWORD *)(v7 + 760);
      *(_WORD *)(a1 + 14) = 16;
      *(_WORD *)(a1 + 16) = 0;
      *(_WORD *)(a1 + 12) = 16 * v8 / 8;
      v9 = *(_DWORD *)(a1 + 4) * (unsigned __int16)(16 * v8 / 8);
      *(_DWORD *)(a1 + 8) = v9;
      *(_DWORD *)(a1 + 24) = 2 * v9;
      v10 = operator new(2 * v9);
      v11 = *(_DWORD *)(a1 + 24);
      *(_DWORD *)(a1 + 20) = v10;
      memset(v10, 0, v11);
      memset(v13, 0, sizeof(v13));
      v12 = *(_DWORD *)(a1 + 24);
      memset(&v13[5], 0, 16);
      v13[2] = v12;
      v13[0] = 36;
      v13[1] = 98496;
      v13[4] = a1;
      if ( ppDS8->lpVtbl->CreateSoundBuffer(ppDS8, (LPCDSBUFFERDESC)v13, (LPDIRECTSOUNDBUFFER *)(a1 + 36), 0) >= 0 )
      {
        *(_DWORD *)(a1 + 128) = 0;
        return 1;
      }
      else
      {
        return 0;
      }
    }
  }
  return result;
}

// music_stream_update @ 0x0043C520
// updates streaming cursor and refills if needed
int __cdecl sub_43C520(unsigned int a1)
{
  _DWORD *v1; // esi
  int result; // eax
  unsigned int v3; // edx
  unsigned int v4; // eax
  int v5; // edx
  int v6; // edx
  unsigned int v7; // ecx
  int v8; // eax

  v1 = (_DWORD *)a1;
  result = (*(int (__stdcall **)(_DWORD, unsigned int *, _DWORD))(**(_DWORD **)(a1 + 36) + 16))(
             *(_DWORD *)(a1 + 36),
             &a1,
             0);
  if ( result >= 0 )
  {
    v3 = v1[30];
    if ( a1 >= v3 )
      v4 = a1 - v3;
    else
      v4 = a1 + v1[6] - v3;
    v5 = v1[31];
    v1[30] = a1;
    v6 = v4 + v5;
    v7 = v4 + v1[32];
    v8 = v1[6];
    v1[31] = v6;
    v1[32] = v7;
    result = v8 / 4;
    if ( v7 > result )
    {
      v1[32] = v7 - result;
      return music_stream_fill(v1);
    }
  }
  return result;
}

// music_stream_fill @ 0x0043C590
// decodes and writes the next music stream chunk
char __cdecl sub_43C590(_DWORD *a1)
{
  _DWORD *v1; // edi
  int v2; // eax
  int v3; // ecx
  _DWORD *v5; // eax
  int v6; // esi
  int v7; // eax
  int v8; // [esp+24h] [ebp-Ch] BYREF
  int v9; // [esp+28h] [ebp-8h] BYREF
  _BYTE v10[4]; // [esp+2Ch] [ebp-4h] BYREF

  v1 = a1;
  v2 = a1[6];
  v3 = a1[9];
  v8 = 0;
  v9 = 0;
  if ( (*(int (__stdcall **)(int, _DWORD, int, int *, _DWORD **, int *, _BYTE *, _DWORD))(*(_DWORD *)v3 + 44))(
         v3,
         a1[7],
         v2 / 4,
         &v8,
         &a1,
         &v9,
         v10,
         0) >= 0 )
  {
    if ( v9 )
    {
      OutputDebugStringA(aSndSomehowData);
      return 0;
    }
    v5 = a1;
    v6 = (int)a1;
    while ( 1 )
    {
      v7 = vorbis_read_pcm16((char *)v1[29], (int)v5 + v8 - v6, v6);
      if ( v7 <= 0 )
        v7 = vorbis_read_pcm16((char *)v1[29], (int)a1 + v8 - v6, v6);
      v6 -= v7;
      if ( v6 <= 0 || !v7 )
        break;
      v5 = a1;
    }
    (*(void (__stdcall **)(_DWORD, int, _DWORD *, _DWORD, _DWORD))(*(_DWORD *)v1[9] + 76))(v1[9], v8, a1, 0, 0);
    v1[7] = ((int)a1 + v1[7]) % v1[6];
  }
  return 0;
}

// sub_43C680 @ 0x0043C680
_DWORD *sub_43C680()
{
  int *v0; // esi
  int v1; // edi
  _DWORD *result; // eax

  v0 = &sfx_entry_table;
  v1 = 128;
  do
  {
    result = FUN_0043b810(v0);
    v0 += 33;
    --v1;
  }
  while ( v1 );
  return result;
}

// sub_43C6B0 @ 0x0043C6B0
int sub_43C6B0()
{
  memset(&sfx_trooper_inpain_01, 0, 0x14Cu);
  return 0;
}

// sub_43C6E0 @ 0x0043C6E0
_DWORD *sub_43C6E0()
{
  int *v0; // esi
  int v1; // edi
  _DWORD *result; // eax

  v0 = &music_entry_table;
  v1 = 128;
  do
  {
    result = FUN_0043b810(v0);
    v0 += 33;
    --v1;
  }
  while ( v1 );
  return result;
}

// sfx_release_sample @ 0x0043C700
// releases an sfx sample by id
char __cdecl sub_43C700(unsigned int a1)
{
  if ( a1 >= 0x80 || !sfx_entry_table_state[33 * a1] )
    return 0;
  sfx_release_entry((int)(&sfx_entry_table + 33 * a1));
  return 1;
}

// sfx_load_sample @ 0x0043C740
// loads an sfx sample and returns its id
int __cdecl sub_43C740(char *Str)
{
  int v2; // ebp
  int *v3; // eax
  char *v4; // edi
  char Buffer[128]; // [esp+8h] [ebp-80h] BYREF

  if ( LOBYTE(config_blob[0]) )
    return 1;
  v2 = 0;
  v3 = sfx_entry_table_state;
  while ( *v3 )
  {
    v3 += 33;
    ++v2;
    if ( (int)v3 >= (int)dword_4CC6E4 )
      return -1;
  }
  if ( v2 == -1 )
    return -1;
  v4 = Str;
  if ( !strcmp(Str, aOgg) )
  {
    console_printf((int)&console_log_queue, "Warning: sample '%s' not accepted.\n", Str);
    v4 = aTrooperInpain0;
  }
  if ( strstr(v4, aOgg) )
  {
    if ( byte_4CC8D5 )
      crt_sprintf(Buffer, "%s", v4);
    else
      crt_sprintf(Buffer, "sfx\\%s", v4);
    if ( !sfx_entry_load_ogg(132 * v2 + 5014736, Buffer) )
    {
      console_printf((int)&console_log_queue, "...loading ogg sample '%s' failed\n", v4);
      return -1;
    }
  }
  else if ( !sfx_entry_load_wav(132 * v2 + 5014736, v4) )
  {
    console_printf((int)&console_log_queue, "...loading wav sample '%s' failed\n", v4);
    return -1;
  }
  if ( *(float *)(dword_480854 + 12) == 0.0 )
    console_printf((int)&console_log_queue, "SFX Sample %d <- '%s' ok\n", v2, v4);
  ++dword_4CC8D8;
  return v2;
}

// music_load_track @ 0x0043C8D0
// loads a music track and returns its id
int __cdecl sub_43C8D0(char *ElementSize)
{
  int v1; // esi
  _DWORD *v2; // eax

  v1 = 0;
  ++dword_4CC8D8;
  v2 = &unk_4C42C4;
  while ( *(v2 - 24) || *v2 )
  {
    v2 += 33;
    ++v1;
    if ( (int)v2 >= (int)dword_4C84C4 )
      return -1;
  }
  if ( v1 == -1 )
    return -1;
  if ( music_entry_load_ogg(132 * v1 + 4997712, ElementSize) )
    console_printf((int)&console_log_queue, "SFX Tune %d <- '%s' ok\n", v1, ElementSize);
  else
    console_printf((int)&console_log_queue, "SFX Tune %d <- '%s' FAILED\n", v1, ElementSize);
  return v1;
}

// music_queue_track @ 0x0043C960
// queues a music track id
int __cdecl sub_43C960(int a1)
{
  int v1; // eax
  int result; // eax

  if ( a1 >= 0 )
  {
    v1 = dword_4CC8D0;
    music_playlist[dword_4CC8D0] = a1;
    result = v1 + 1;
    dword_4CC8D0 = result;
  }
  return result;
}

// music_release_track @ 0x0043C980
// releases a music track by id
char __cdecl sub_43C980(unsigned int a1)
{
  if ( a1 >= 0x80 || !dword_4C4264[33 * a1] )
    return 0;
  sfx_release_entry((int)(&music_entry_table + 33 * a1));
  return 1;
}

// audio_init_music @ 0x0043C9C0
// loads music pack and registers music track ids
char sub_43C9C0()
{
  char result; // al

  result = config_blob[0];
  if ( !LOBYTE(config_blob[0]) )
  {
    result = BYTE1(config_blob[0]);
    if ( !BYTE1(config_blob[0]) )
    {
      memset(&sfx_mute_flags, 1u, 0x80u);
      memset(sfx_volume_table, 0, 0x200u);
      byte_4CC8D5 = resource_pack_set(aMusicPaq);
      if ( byte_4CC8D5 )
        console_printf((int)&console_log_queue, aSetSoundResour);
      else
        console_printf((int)&console_log_queue, aResourcePaqMus);
      music_track_intro_id = music_load_track(aMusicIntroOgg);
      music_track_shortie_monk_id = music_load_track(aMusicShortieMo);
      console_exec_line((char *)&console_log_queue, (int)aExecMusicGameT);
      music_track_crimson_theme_id = music_load_track(aMusicCrimsonTh);
      music_track_crimsonquest_id = music_load_track(aMusicCrimsonqu);
      music_track_extra_0 = music_track_crimsonquest_id + 1;
      music_track_extra_1 = music_track_crimsonquest_id + 2;
      sfx_unmuted_flag = 1;
      return music_track_crimsonquest_id + 2;
    }
  }
  return result;
}

// audio_init_sfx @ 0x0043CAA0
// loads sfx pack and registers sound effect ids
char sub_43CAA0()
{
  char result; // al
  DWORD Time; // edi
  DWORD v3; // eax
  int v4; // edx
  int *v5; // ecx

  result = config_blob[0];
  if ( !LOBYTE(config_blob[0]) )
  {
    byte_4CC8D5 = resource_pack_set(aSfxPaq);
    if ( byte_4CC8D5 )
      console_printf((int)&console_log_queue, aSetSoundResour_0);
    else
      console_printf((int)&console_log_queue, aFailedToSetSou);
    Time = timeGetTime();
    sfx_trooper_inpain_01 = sfx_load_sample(aTrooperInpain0);
    sfx_trooper_inpain_02 = sfx_load_sample(aTrooperInpain0_0);
    sfx_trooper_inpain_03 = sfx_load_sample(aTrooperInpain0_1);
    sfx_trooper_die_01 = sfx_load_sample(aTrooperDie01Og);
    sfx_trooper_die_02 = sfx_load_sample(aTrooperDie02Og);
    sfx_trooper_die_03 = sfx_load_sample(aTrooperDie03Og);
    sfx_zombie_die_01 = sfx_load_sample(aZombieDie01Ogg);
    sfx_zombie_die_02 = sfx_load_sample(aZombieDie02Ogg);
    sfx_zombie_die_03 = sfx_load_sample(aZombieDie03Ogg);
    sfx_zombie_die_04 = sfx_load_sample(aZombieDie04Ogg);
    sfx_zombie_attack_01 = sfx_load_sample(aZombieAttack01);
    sfx_zombie_attack_02 = sfx_load_sample(aZombieAttack02);
    sfx_alien_die_01 = sfx_load_sample(aAlienDie01Ogg);
    sfx_alien_die_02 = sfx_load_sample(aAlienDie02Ogg);
    sfx_alien_die_03 = sfx_load_sample(aAlienDie03Ogg);
    sfx_alien_die_04 = sfx_load_sample(aAlienDie04Ogg);
    sfx_alien_attack_01 = sfx_load_sample(aAlienAttack01O);
    sfx_alien_attack_02 = sfx_load_sample(aAlienAttack02O);
    sfx_lizard_die_01 = sfx_load_sample(aLizardDie01Ogg);
    sfx_lizard_die_02 = sfx_load_sample(aLizardDie02Ogg);
    sfx_lizard_die_03 = sfx_load_sample(aLizardDie03Ogg);
    sfx_lizard_die_04 = sfx_load_sample(aLizardDie04Ogg);
    sfx_lizard_attack_01 = sfx_load_sample(aLizardAttack01);
    sfx_lizard_attack_02 = sfx_load_sample(aLizardAttack02);
    sfx_spider_die_01 = sfx_load_sample(aSpiderDie01Ogg);
    sfx_spider_die_02 = sfx_load_sample(aSpiderDie02Ogg);
    sfx_spider_die_03 = sfx_load_sample(aSpiderDie03Ogg);
    sfx_spider_die_04 = sfx_load_sample(aSpiderDie04Ogg);
    sfx_spider_attack_01 = sfx_load_sample(aSpiderAttack01);
    sfx_spider_attack_02 = sfx_load_sample(aSpiderAttack02);
    sfx_pistol_fire = sfx_load_sample(aPistolFireOgg);
    sfx_pistol_reload = sfx_load_sample(aPistolReloadOg);
    sfx_shotgun_fire = sfx_load_sample(aShotgunFireOgg);
    sfx_shotgun_reload = sfx_load_sample(aShotgunReloadO);
    sfx_autorifle_fire = sfx_load_sample(aAutorifleFireO);
    sfx_autorifle_reload = sfx_load_sample(aAutorifleReloa);
    sfx_gauss_fire = sfx_load_sample(aGaussFireOgg);
    sfx_hrpm_fire = sfx_load_sample(aHrpmFireOgg);
    sfx_shock_fire = sfx_load_sample(aShockFireOgg);
    sfx_plasmaminigun_fire = sfx_load_sample(aPlasmaminigunF);
    sfx_plasmashotgun_fire = sfx_load_sample(aPlasmashotgunF);
    sfx_pulse_fire = sfx_load_sample(aPulseFireOgg);
    sfx_flamer_fire_01 = sfx_load_sample(aFlamerFire01Og);
    sfx_flamer_fire_02 = sfx_load_sample(aFlamerFire02Og);
    sfx_shock_reload = sfx_load_sample(aShockReloadOgg);
    sfx_shock_fire_alt = sfx_load_sample(aShockFireOgg);
    sfx_shockminigun_fire = sfx_load_sample(aShockminigunFi);
    sfx_rocket_fire = sfx_load_sample(aRocketFireOgg);
    sfx_rocketmini_fire = sfx_load_sample(aRocketminiFire);
    sfx_autorifle_reload_alt = sfx_load_sample(aAutorifleReloa);
    sfx_bullet_hit_01 = sfx_load_sample(aBulletHit01Ogg);
    sfx_bullet_hit_02 = sfx_load_sample(aBulletHit02Ogg);
    sfx_bullet_hit_03 = sfx_load_sample(aBulletHit03Ogg);
    sfx_bullet_hit_04 = sfx_load_sample(aBulletHit04Ogg);
    sfx_bullet_hit_05 = sfx_load_sample(aBulletHit05Ogg);
    sfx_bullet_hit_06 = sfx_load_sample(aBulletHit06Ogg);
    sfx_shock_hit_01 = sfx_load_sample(aShockHit01Ogg);
    sfx_explosion_small = sfx_load_sample(aExplosionSmall);
    sfx_explosion_medium = sfx_load_sample(aExplosionMediu);
    sfx_explosion_large = sfx_load_sample(aExplosionLarge);
    sfx_shockwave = sfx_load_sample(aShockwaveOgg);
    sfx_questhit = sfx_load_sample(aQuesthitOgg);
    sfx_ui_bonus = sfx_load_sample(aUiBonusOgg);
    sfx_trooper_inpain_01_alias_0 = sfx_trooper_inpain_01;
    sfx_trooper_inpain_01_alias_1 = sfx_trooper_inpain_01;
    sfx_trooper_inpain_01_alias_2 = sfx_trooper_inpain_01;
    sfx_ui_buttonclick = sfx_load_sample(aUiButtonclickO);
    sfx_ui_panelclick = sfx_load_sample(aUiPanelclickOg);
    sfx_ui_levelup = sfx_load_sample(aUiLevelupOgg);
    sfx_ui_typeclick_01 = sfx_load_sample(aUiTypeclick01O);
    sfx_ui_typeclick_02 = sfx_load_sample(aUiTypeclick02O);
    sfx_ui_typeenter = sfx_load_sample(aUiTypeenterOgg);
    sfx_ui_clink_01 = sfx_load_sample(aUiClink01Ogg);
    sfx_bloodspill_01 = sfx_load_sample(aBloodspill01Og);
    sfx_bloodspill_02 = sfx_load_sample(aBloodspill02Og);
    v3 = timeGetTime();
    v4 = 0;
    v5 = sfx_entry_table_state;
    do
    {
      if ( !*v5 )
        break;
      v5 += 33;
      ++v4;
    }
    while ( (int)v5 < (int)dword_4CC6E4 );
    return console_printf(
             (int)&console_log_queue,
             "%d samples loaded to sound library in %.2f seconds.\n",
             v4,
             (double)(int)(v3 - Time) * 0.001);
  }
  return result;
}

// sfx_system_init @ 0x0043CF90
// initializes the Grim SFX system and clears per-sfx state
char sub_43CF90()
{
  HWND ForegroundWindow; // eax

  if ( LOBYTE(config_blob[0]) )
    return 1;
  console_printf((int)&console_log_queue, aInitializingGr);
  ForegroundWindow = GetForegroundWindow();
  if ( dsound_init(ForegroundWindow, 2u, 2, 44100, 0x10u) )
  {
    console_printf((int)&console_log_queue, aInit44100Hz16B);
    console_printf((int)&console_log_queue, aUsingDirectsou);
    console_printf((int)&console_log_queue, aUsingDefaultSp);
    console_printf((int)&console_log_queue, aSayingHelloToT);
    memset(&sfx_cooldown_table, 0, 0x200u);
    memset(&sfx_voice_table, 0, 0x80u);
    console_printf((int)&console_log_queue, aInitGrimSfxDon);
    return 1;
  }
  else
  {
    console_printf((int)&console_log_queue, aFailedUnableTo);
    LOWORD(config_blob[0]) = 257;
    return 0;
  }
}

// sfx_release_all @ 0x0043D070
// releases all loaded sfx samples
char sub_43D070()
{
  char result; // al
  int *v1; // esi

  result = config_blob[0];
  if ( !LOBYTE(config_blob[0]) )
  {
    v1 = &sfx_entry_table;
    do
    {
      sfx_release_entry((int)v1);
      v1 += 33;
    }
    while ( (int)v1 < (int)music_playlist );
    console_printf((int)&console_log_queue, aSfxShutdown);
    console_printf((int)&console_log_queue, aSfxReleased);
    return console_flush_log(&console_log_queue, (int)console_log_filename);
  }
  return result;
}

// music_release_all @ 0x0043D0D0
// releases all loaded music tracks
char sub_43D0D0()
{
  char result; // al
  int *v1; // esi

  result = sfx_unmuted_flag;
  if ( sfx_unmuted_flag )
  {
    v1 = &music_entry_table;
    do
    {
      sfx_release_entry((int)v1);
      v1 += 33;
    }
    while ( (int)v1 < (int)sfx_mute_flags );
    return console_flush_log(&console_log_queue, (int)console_log_filename);
  }
  return result;
}

// audio_shutdown_all @ 0x0043D110
// shuts down sfx + music systems
LPDIRECTSOUND8 sub_43D110()
{
  LPDIRECTSOUND8 result; // eax

  sfx_release_all();
  music_release_all();
  result = ppDS8;
  if ( ppDS8 )
    result = (LPDIRECTSOUND8)ppDS8->lpVtbl->Release(ppDS8);
  ppDS8 = 0;
  return result;
}

// sfx_play @ 0x0043D120
// plays a sound effect with centered pan
int __cdecl sub_43D120(int a1, float a2)
{
  int *v3; // edi
  int v4; // [esp+4h] [ebp-10h]
  float v5; // [esp+8h] [ebp-Ch]

  if ( !sfx_entry_table_state[33 * a1] )
    return -1;
  if ( LOBYTE(config_blob[0]) )
    return -1;
  if ( sfx_cooldown_table[a1] > 0.0 )
    return -1;
  if ( demo_mode_active )
    a2 = a2 * 0.69999999;
  if ( bonus_reflex_boost_timer <= 0.0 )
  {
    sfx_rate_scale = 44100;
  }
  else if ( bonus_reflex_boost_timer <= 1.0 )
  {
    if ( bonus_reflex_boost_timer < 1.0 )
      sfx_rate_scale = (__int64)((1.0 - bonus_reflex_boost_timer + 1.0) * 22050.0);
  }
  else
  {
    sfx_rate_scale = 22050;
  }
  if ( a1 == sfx_flamer_fire_01 || a1 == sfx_flamer_fire_02 )
    sfx_cooldown_table[a1] = 0.44;
  else
    sfx_cooldown_table[a1] = 0.050000001;
  v3 = &sfx_entry_table + 33 * a1;
  v4 = dword_4C84F4[32 * a1 + sfx_entry_start_playback((int)v3) + a1];
  (*(void (__stdcall **)(int, _DWORD))(*(_DWORD *)v4 + 64))(v4, 0);
  v5 = config_sfx_volume * a2;
  sfx_entry_set_volume((int)v3, v5);
  return a1;
}

// sfx_play_panned @ 0x0043D260
// plays a sound effect with computed pan
int __cdecl sub_43D260(int a1, float *a2, float a3)
{
  __int64 v4; // rax
  int v5; // ebx
  int *v6; // edi
  int v7; // [esp+4h] [ebp-14h]
  float v8; // [esp+8h] [ebp-10h]

  if ( !sfx_entry_table_state[33 * a1] )
    return -1;
  if ( LOBYTE(config_blob[0]) )
    return -1;
  if ( sfx_cooldown_table[a1] > 0.0 )
    return -1;
  if ( bonus_reflex_boost_timer <= 0.0 )
  {
    sfx_rate_scale = 44100;
  }
  else if ( bonus_reflex_boost_timer <= 1.0 )
  {
    if ( bonus_reflex_boost_timer < 1.0 )
      sfx_rate_scale = (__int64)((1.0 - bonus_reflex_boost_timer + 1.0) * 22050.0);
  }
  else
  {
    sfx_rate_scale = 22050;
  }
  if ( demo_mode_active )
    a3 = a3 * 0.69999999;
  if ( a1 == sfx_flamer_fire_01 || a1 == sfx_flamer_fire_02 )
    sfx_cooldown_table[a1] = 0.44;
  else
    sfx_cooldown_table[a1] = 0.050000001;
  v4 = (__int64)(((*(float *)&camera_offset_x + *a2) / (double)*(int *)config_screen_width - 0.5) * 1700.0);
  v5 = v4;
  if ( (int)v4 >= -10000 )
  {
    if ( (int)v4 > 10000 )
      v5 = 10000;
  }
  else
  {
    v5 = -10000;
  }
  v6 = &sfx_entry_table + 33 * a1;
  v7 = dword_4C84F4[32 * a1 + sfx_entry_start_playback((int)v6) + a1];
  (*(void (__stdcall **)(int, int))(*(_DWORD *)v7 + 64))(v7, v5);
  v8 = config_sfx_volume * a3;
  sfx_entry_set_volume((int)v6, v8);
  return a1;
}

// audio_update @ 0x0043D3F0
// updates sfx cooldowns, music streams, and mute fades
char sub_43D3F0()
{
  char result; // al
  float *v1; // ecx
  int *v2; // esi

  result = config_blob[0];
  if ( !LOBYTE(config_blob[0]) )
  {
    v1 = sfx_cooldown_table;
    do
    {
      if ( *v1 > 0.0 )
        *v1 = *v1 - *(float *)&dword_47EA48;
      ++v1;
    }
    while ( (int)v1 < (int)sfx_voice_table );
    result = sfx_unmuted_flag;
    if ( sfx_unmuted_flag )
    {
      v2 = &music_entry_table;
      do
      {
        if ( v2[29] )
          music_stream_update((unsigned int)v2);
        v2 += 33;
      }
      while ( (int)v2 < (int)sfx_mute_flags );
      return sfx_update_mute_fades();
    }
  }
  return result;
}

// sfx_play_exclusive @ 0x0043D460
// mutes other sfx ids and ensures the chosen id is audible
void __cdecl sub_43D460(int a1)
{
  int v1; // edi
  int v2; // et2
  int i; // esi
  double v4; // st7

  if ( sfx_unmuted_flag && !LOWORD(config_blob[0]) )
  {
    v1 = a1;
    if ( !byte_4824D1 )
    {
      if ( a1 == music_track_extra_0 )
      {
        if ( byte_4CC8D4 || !dword_4CC8D0 )
          return;
        v2 = crt_rand() % dword_4CC8D0;
        byte_4CC8D4 = 1;
        v1 = music_playlist[v2];
      }
      else
      {
        byte_4CC8D4 = 0;
      }
    }
    for ( i = 0; i < 128; ++i )
    {
      if ( i != v1 && (unsigned __int8)sfx_is_unmuted(i) )
        sfx_mute_all(i);
    }
    if ( sfx_volume_table[v1] <= 0.0 )
    {
      sfx_entry_start_playback(132 * v1 + 4997712);
      sfx_entry_set_volume(132 * v1 + 4997712, config_music_volume);
      v4 = config_music_volume;
      sfx_mute_flags[v1] = 0;
      sfx_volume_table[v1] = v4;
    }
  }
}

// sfx_mute_all @ 0x0043D550
// mutes all unmuted sfx ids (recursive)
char __cdecl sub_43D550(int a1)
{
  char result; // al
  int i; // esi

  result = sfx_unmuted_flag;
  if ( sfx_unmuted_flag )
  {
    result = BYTE1(config_blob[0]);
    if ( !BYTE1(config_blob[0]) )
    {
      result = config_blob[0];
      if ( !LOBYTE(config_blob[0]) )
      {
        byte_4CC8D4 = 0;
        for ( i = 0; i < 128; ++i )
        {
          if ( i != a1 )
          {
            result = sfx_is_unmuted(i);
            if ( result )
              result = sfx_mute_all(i);
          }
        }
        sfx_mute_flags[a1] = 1;
      }
    }
  }
  return result;
}

// sfx_update_mute_fades @ 0x0043D5B0
// ramps volume up/down based on mute flags
void sub_43D5B0()
{
  int v0; // ebp
  float *v1; // edi
  int *v2; // esi
  float v3; // eax
  float v4; // edx
  float v5; // [esp+8h] [ebp-8h]
  float v6; // [esp+8h] [ebp-8h]
  _BYTE v7[4]; // [esp+Ch] [ebp-4h] BYREF

  if ( !audio_suspend_flag && sfx_unmuted_flag )
  {
    v0 = 0;
    v1 = sfx_volume_table;
    v2 = &music_entry_table;
    do
    {
      if ( v2[29] )
      {
        if ( config_music_volume > 0.0 )
        {
          if ( sfx_mute_flags[v0] )
            goto LABEL_11;
          (*(void (__stdcall **)(int, _BYTE *))(*(_DWORD *)v2[9] + 36))(v2[9], v7);
          if ( (v7[0] & 1) == 0 )
          {
            console_printf((int)&console_log_queue, aSndDetectedUns);
            sfx_entry_resume((int)v2);
          }
        }
        else
        {
          (*(void (__stdcall **)(int))(*(_DWORD *)v2[9] + 72))(v2[9]);
        }
        if ( sfx_mute_flags[v0] )
        {
LABEL_11:
          if ( *v1 > 0.0 )
          {
            v5 = *v1 - frame_dt * 0.5;
            *v1 = v5;
            if ( v5 > 0.0 )
              sfx_entry_set_volume((int)v2, v5);
            else
              sfx_entry_stop((int)v2);
          }
          if ( *v1 < 0.0 )
            *v1 = 0.0;
          goto LABEL_24;
        }
        if ( *v1 >= (double)config_music_volume )
        {
          if ( *v1 > (double)config_music_volume )
          {
            v4 = config_music_volume;
            *v1 = config_music_volume;
            v3 = v4;
            goto LABEL_23;
          }
        }
        else
        {
          v6 = frame_dt + *v1;
          *v1 = v6;
          if ( v6 >= (double)config_music_volume )
          {
            v3 = config_music_volume;
LABEL_23:
            sfx_entry_set_volume((int)v2, v3);
            goto LABEL_24;
          }
          sfx_entry_set_volume((int)v2, v6);
        }
      }
LABEL_24:
      v2 += 33;
      ++v0;
      ++v1;
    }
    while ( (int)v2 < (int)sfx_mute_flags );
  }
}

// audio_suspend_channels @ 0x0043D730
// iterates channels and suspends playback
char sub_43D730()
{
  char result; // al
  int *v1; // esi

  result = sfx_unmuted_flag;
  if ( sfx_unmuted_flag )
  {
    result = BYTE1(config_blob[0]);
    if ( !BYTE1(config_blob[0]) )
    {
      result = config_blob[0];
      if ( !LOBYTE(config_blob[0]) )
      {
        v1 = &music_entry_table;
        do
        {
          result = sfx_entry_stop((int)v1);
          v1 += 33;
        }
        while ( (int)v1 < (int)sfx_mute_flags );
      }
    }
  }
  return result;
}

// audio_resume_channels @ 0x0043D770
// iterates channels and resumes playback
char sub_43D770()
{
  char result; // al
  int v1; // edi
  int *v2; // esi

  result = sfx_unmuted_flag;
  if ( sfx_unmuted_flag )
  {
    result = BYTE1(config_blob[0]);
    if ( !BYTE1(config_blob[0]) )
    {
      result = config_blob[0];
      if ( !LOBYTE(config_blob[0]) )
      {
        v1 = 0;
        v2 = &music_entry_table;
        do
        {
          result = sfx_mute_flags[v1];
          if ( !result )
            result = sfx_entry_resume((int)v2);
          v2 += 33;
          ++v1;
        }
        while ( (int)v2 < (int)sfx_mute_flags );
      }
    }
  }
  return result;
}

// sfx_is_unmuted @ 0x0043D7C0
// returns nonzero when sfx id is not muted
bool __cdecl sub_43D7C0(int a1)
{
  return sfx_unmuted_flag && sfx_mute_flags[a1] == 0;
}

// ui_focus_set @ 0x0043D7E0
// sets the active focus candidate; optionally resets the focus timer
int __cdecl sub_43D7E0(int a1, char a2)
{
  int result; // eax
  int *i; // ecx

  result = dword_4D11E4;
  if ( ui_focus_candidates[dword_4D11E4] != a1 )
  {
    if ( a2 )
      dword_4D11EC = 1000;
    result = 0;
    if ( dword_4D11E0 > 0 )
    {
      for ( i = ui_focus_candidates; *i != a1; ++i )
      {
        if ( ++result >= dword_4D11E0 )
          return result;
      }
      dword_4D11E4 = result;
    }
  }
  return result;
}

// ui_focus_update @ 0x0043D830
// handles menu focus navigation and returns 1 when the given id is focused
bool __cdecl sub_43D830(int a1)
{
  bool v1; // bl
  int v2; // eax
  int v3; // ecx
  int v5; // eax

  v1 = a1 == ui_focus_candidates[dword_4D11E4];
  if ( dword_4D11E8 == dword_480848 )
  {
    v5 = dword_4D11E0;
    if ( dword_4D11E0 >= 32 )
      v5 = 31;
    ui_focus_candidates[v5] = a1;
    dword_4D11E0 = v5 + 1;
    return v1;
  }
  else
  {
    dword_4D11EC -= frame_dt_ms;
    if ( dword_4D11EC < 0 )
      dword_4D11EC = 0;
    if ( !byte_4871CA
      && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 15) )
    {
      if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 42)
        || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 54) )
      {
        v2 = dword_4D11E4 - 1;
      }
      else
      {
        v2 = dword_4D11E4 + 1;
      }
      dword_4D11E4 = v2;
      dword_4D11EC = 1000;
    }
    v3 = dword_4D11E4;
    if ( dword_4D11E4 < 0 )
    {
      v3 = dword_4D11E0 - 1;
      dword_4D11E4 = dword_4D11E0 - 1;
    }
    if ( v3 > dword_4D11E0 - 1 )
      dword_4D11E4 = 0;
    dword_4D11E8 = dword_480848;
    ui_focus_candidates[0] = a1;
    dword_4D11E0 = 1;
    return v1;
  }
}

// ui_focus_draw @ 0x0043D940
// draws the focus highlight for the active menu item
int __cdecl sub_43D940(float *a1)
{
  float v2[2]; // [esp+0h] [ebp-18h] BYREF
  _DWORD v3[4]; // [esp+8h] [ebp-10h] BYREF

  v3[0] = 1061997773;
  v3[1] = 1061997773;
  v3[2] = 1058642330;
  *(float *)&v3[3] = (double)dword_4D11EC * 0.00080000004;
  v2[0] = *a1;
  v2[1] = a1[1] + 4.0;
  return (*(int (__thiscall **)(int, float *, int, int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 208))(
           grim_interface_ptr,
           v2,
           1086324736,
           1086324736,
           v3);
}

// FUN_0043d9b0 @ 0x0043D9B0
// [binja] int32_t sub_43d9b0(int32_t* arg1, int32_t arg2)
int __cdecl sub_43D9B0(int a1, int a2)
{
  bool v3; // bl
  int v4; // eax
  double v5; // st6
  int v6; // ebp
  int v7; // eax
  int v8; // ebx
  __int64 v10; // rax
  int v11; // ecx
  int v12; // eax
  int v13; // eax
  int v14; // edi
  int result; // eax
  int v16; // edi
  float v17; // [esp+60h] [ebp-30h]
  float v18; // [esp+60h] [ebp-30h]
  float v19; // [esp+80h] [ebp-10h] BYREF
  float v20; // [esp+84h] [ebp-Ch]
  float v21; // [esp+88h] [ebp-8h]
  char v22; // [esp+98h] [ebp+8h]
  int v23; // [esp+98h] [ebp+8h]
  int v24; // [esp+98h] [ebp+8h]

  v3 = ui_focus_update(a2);
  v22 = 0;
  LODWORD(v19) = 8 * *(_DWORD *)(a2 + 4);
  v4 = LODWORD(v19);
  v5 = *(float *)a1 - 3.0;
  v6 = *(_DWORD *)(a1 + 4);
  v21 = *(float *)a1;
  v19 = v5;
  v20 = *(float *)(a1 + 4) - 1.0;
  if ( ui_mouse_inside_rect(&v19, 18, (__int64)((double)v4 + 6.0)) )
  {
    v22 = 1;
    ui_focus_set(a2, 0);
  }
  if ( v3 )
  {
    v19 = *(float *)a1 - 16.0;
    v20 = *(float *)(a1 + 4);
    ui_focus_draw(&v19);
    if ( *(_BYTE *)(a2 + 12) )
    {
      if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 205) )
      {
        v7 = *(_DWORD *)(a2 + 4);
        v8 = *(_DWORD *)a2 + 1;
        *(_DWORD *)a2 = v8;
        if ( v8 > v7 )
          *(_DWORD *)a2 = v7;
      }
      if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 203) )
      {
        if ( --*(_DWORD *)a2 < 0 )
          *(_DWORD *)a2 = 0;
      }
    }
  }
  if ( v22 && (unsigned __int8)input_primary_is_down() && *(_BYTE *)(a2 + 12) )
  {
    v10 = (__int64)((ui_mouse_x - *(float *)a1) * 0.125);
    v11 = *(_DWORD *)(a2 + 8);
    *(_DWORD *)a2 = v10;
    if ( (int)v10 < v11 )
      *(_DWORD *)a2 = v11;
    v12 = *(_DWORD *)(a2 + 4);
    if ( *(_DWORD *)a2 > v12 )
      *(_DWORD *)a2 = v12;
  }
  if ( dword_478668 == -1 )
    dword_478668 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                     grim_interface_ptr,
                     aUiRecton);
  v13 = dword_47866C;
  if ( dword_47866C == -1 )
  {
    v13 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(grim_interface_ptr, aUiRectoff);
    dword_47866C = v13;
  }
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, v13, 0);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1056964608);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  v14 = 0;
  if ( *(int *)(a2 + 4) > 0 )
  {
    v23 = 0;
    do
    {
      v17 = (double)v23 + v21;
      (*(void (__stdcall **)(_DWORD, int, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
        LODWORD(v17),
        v6,
        1090519040,
        1098907648);
      ++v14;
      v23 += 8;
    }
    while ( v14 < *(_DWORD *)(a2 + 4) );
  }
  result = (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  if ( *(int *)a2 > 0 )
  {
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      dword_478668,
      0);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    v16 = 0;
    if ( *(int *)a2 > 0 )
    {
      v24 = 0;
      do
      {
        v18 = (double)v24 + v21;
        (*(void (__stdcall **)(_DWORD, int, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
          LODWORD(v18),
          v6,
          1090519040,
          1098907648);
        ++v16;
        v24 += 8;
      }
      while ( v16 < *(_DWORD *)a2 );
    }
    return (*(int (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  }
  return result;
}

// ui_checkbox_update @ 0x0043DC80
// draws a checkbox widget, handles hover/focus, toggles on click
char __cdecl sub_43DC80(float *a1, int a2)
{
  int v3; // eax
  int v4; // eax
  float *v5; // edi
  int v6; // ebp
  int v7; // eax
  int v8; // esi
  int v10; // [esp+90h] [ebp-24h]
  int v11; // [esp+90h] [ebp-24h]
  int v12; // [esp+90h] [ebp-24h]
  float v13; // [esp+90h] [ebp-24h]
  int v14; // [esp+94h] [ebp-20h]
  int v15; // [esp+94h] [ebp-20h]
  int v16; // [esp+94h] [ebp-20h]
  float v17; // [esp+94h] [ebp-20h]
  char *v18; // [esp+98h] [ebp-1Ch]
  int v19; // [esp+98h] [ebp-1Ch]
  int v20; // [esp+98h] [ebp-1Ch]
  int v21; // [esp+98h] [ebp-1Ch]
  char v22; // [esp+ABh] [ebp-9h]
  float v23[2]; // [esp+ACh] [ebp-8h] BYREF
  bool v24; // [esp+BCh] [ebp+8h]

  v22 = 0;
  v24 = ui_focus_update(a2);
  v3 = *(_DWORD *)(a2 + 4);
  *(_BYTE *)(a2 + 2) = 0;
  if ( v3 )
  {
    v4 = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 332))(grim_interface_ptr, v3);
    v5 = a1;
    if ( !ui_mouse_inside_rect(a1, 16, v4 + 22) )
      goto LABEL_6;
  }
  else
  {
    v5 = a1;
    if ( !ui_mouse_inside_rect(a1, 16, 16) )
      goto LABEL_6;
  }
  *(_BYTE *)(a2 + 2) = 1;
LABEL_6:
  if ( *(_BYTE *)(a2 + 1) )
    *(_BYTE *)(a2 + 2) = 0;
  if ( *(_BYTE *)(a2 + 2) )
    ui_focus_set(a2, 0);
  if ( v24 )
  {
    v23[0] = *v5 - 16.0;
    v23[1] = v5[1];
    ui_focus_draw(v23);
  }
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  v6 = *(_DWORD *)grim_interface_ptr;
  if ( *(_BYTE *)a2 )
    v18 = aUiCheckon;
  else
    v18 = aUiCheckoff;
  v7 = (*(int (__stdcall **)(char *))(v6 + 192))(v18);
  (*(void (__thiscall **)(int, int))(v6 + 196))(grim_interface_ptr, v7);
  if ( !byte_4871CA
    && (v24
     && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28)
     || *(_BYTE *)(a2 + 2) && (unsigned __int8)input_primary_just_pressed(0)) )
  {
    v22 = 1;
    *(_BYTE *)a2 = *(_BYTE *)a2 == 0;
  }
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    v10,
    v14,
    v19);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    grim_interface_ptr,
    *(_DWORD *)v5,
    *((_DWORD *)v5 + 1),
    1098907648,
    1098907648);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v11,
    v15,
    v20);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v12,
    v16,
    v21);
  if ( *(_BYTE *)(a2 + 2) )
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
  else
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
  v8 = *(_DWORD *)(a2 + 4);
  if ( v8 )
  {
    v17 = v5[1] + 1.0;
    v13 = *v5 + 22.0;
    (*(void (__stdcall **)(_DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 324))(LODWORD(v13), LODWORD(v17), v8);
  }
  return v22;
}

// ui_scrollbar_update @ 0x0043DEF0
// updates and renders a scroll bar (wheel, drag, key input)
int __cdecl sub_43DEF0(float *a1, int a2)
{
  double v4; // st7
  double v5; // st7
  double v6; // st7
  double v7; // st7
  int v8; // edi
  int v9; // ebp
  double v10; // st7
  double v11; // st6
  double v12; // st7
  float v13; // eax
  int result; // eax
  int v15; // esi
  int v16; // ebp
  signed int v17; // esi
  signed int v18; // edi
  char v19; // al
  int v20; // esi
  int v21; // ecx
  bool v22; // cc
  float v23; // [esp+70h] [ebp-5Ch]
  float v24; // [esp+74h] [ebp-58h]
  float v25; // [esp+74h] [ebp-58h]
  float v26; // [esp+74h] [ebp-58h]
  float v27; // [esp+74h] [ebp-58h]
  float v28; // [esp+8Ch] [ebp-40h]
  _DWORD *v29; // [esp+8Ch] [ebp-40h]
  int v30; // [esp+90h] [ebp-3Ch]
  int v31; // [esp+94h] [ebp-38h]
  int v32; // [esp+98h] [ebp-34h]
  int v33; // [esp+9Ch] [ebp-30h] BYREF
  float v34; // [esp+A0h] [ebp-2Ch]
  int v35; // [esp+A4h] [ebp-28h]
  int v36; // [esp+A8h] [ebp-24h]
  float v37; // [esp+ACh] [ebp-20h] BYREF
  float v38; // [esp+B0h] [ebp-1Ch]
  float v39; // [esp+B4h] [ebp-18h] BYREF
  float v40; // [esp+B8h] [ebp-14h]
  int v41; // [esp+BCh] [ebp-10h] BYREF
  int v42; // [esp+C0h] [ebp-Ch]
  float v43; // [esp+C4h] [ebp-8h]
  int v44; // [esp+C8h] [ebp-4h]
  bool v45; // [esp+D0h] [ebp+4h]
  int v46; // [esp+D0h] [ebp+4h]
  float v47; // [esp+D0h] [ebp+4h]
  int v48; // [esp+D0h] [ebp+4h]
  int v49; // [esp+D0h] [ebp+4h]
  float v50; // [esp+D0h] [ebp+4h]
  int v51; // [esp+D0h] [ebp+4h]
  float v52; // [esp+D4h] [ebp+8h]
  int v53; // [esp+D4h] [ebp+8h]

  *a1 = (float)(__int64)*a1;
  a1[1] = (float)(__int64)a1[1];
  *(_DWORD *)(a2 + 4) = -1;
  v45 = ui_focus_update(a2);
  if ( v45 )
  {
    *(float *)&v33 = *a1 - 16.0;
    v34 = a1[1];
    ui_focus_draw((float *)&v33);
  }
  v4 = (double)(16 * *(_DWORD *)(a2 + 12) + 4);
  *(float *)&v33 = 1.0;
  v34 = 1.0;
  v35 = 1065353216;
  v36 = 1065353216;
  v52 = v4;
  (*(void (__thiscall **)(int, float *, int, float, int *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    a1,
    1132068864,
    COERCE_FLOAT(LODWORD(v52)),
    &v33);
  v5 = *a1 + 1.0;
  v41 = 0;
  *(float *)&v33 = v5;
  v6 = a1[1] + 1.0;
  v42 = 0;
  v43 = 0.0;
  v44 = 1065353216;
  v34 = v6;
  v28 = v52 - 2.0;
  (*(void (__thiscall **)(int, int *, int, float, int *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    &v33,
    1131937792,
    COERCE_FLOAT(LODWORD(v28)),
    &v41);
  if ( *(_DWORD *)(a2 + 52) > *(_DWORD *)(a2 + 12) )
  {
    v7 = *a1 + 240.0;
    v41 = 1065353216;
    *(float *)&v33 = v7;
    v34 = a1[1];
    v42 = 1065353216;
    v43 = 1.0;
    v44 = 1061997773;
    (*(void (__thiscall **)(int, int *, int, float, int *))(*(_DWORD *)grim_interface_ptr + 208))(
      grim_interface_ptr,
      &v33,
      1065353216,
      COERCE_FLOAT(LODWORD(v52)),
      &v41);
  }
  if ( ((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 96))(grim_interface_ptr) > 0.0 )
    *(float *)a2 = *(float *)a2 - 1.0;
  if ( ((double (__thiscall *)(int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 96))(grim_interface_ptr) < 0.0 )
    *(float *)a2 = *(float *)a2 + 1.0;
  if ( v45 )
  {
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 200) )
      *(float *)a2 = *(float *)a2 - 1.0;
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 208) )
      *(float *)a2 = *(float *)a2 + 1.0;
  }
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 201) )
    *(float *)a2 = *(float *)a2 - (double)(*(_DWORD *)(a2 + 12) - 1);
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 209) )
    *(float *)a2 = (double)(*(_DWORD *)(a2 + 12) - 1) + *(float *)a2;
  v9 = *(_DWORD *)(a2 + 12);
  v46 = *(_DWORD *)(a2 + 52);
  v8 = v46;
  v10 = (double)(v46 - v9);
  if ( v10 < *(float *)a2 )
    *(float *)a2 = v10;
  if ( *(float *)a2 < 0.0 )
    *(_DWORD *)a2 = 0;
  v32 = (__int64)*(float *)a2;
  v11 = (double)v9 / (double)v46 * v28;
  v47 = v11;
  if ( v11 > v28 )
    v47 = v52 - 3.0;
  v39 = *a1 + 241.0;
  v40 = (v52 - 3.0 - v47) / v10 * (double)v32 + 1.0 + a1[1];
  if ( v8 > v9 )
  {
    v41 = 1065353216;
    v42 = 1065353216;
    v43 = 1.0;
    v44 = 1061997773;
    v24 = v47 + 1.0;
    (*(void (__thiscall **)(int, float *, int, _DWORD, int *))(*(_DWORD *)grim_interface_ptr + 208))(
      grim_interface_ptr,
      &v39,
      1090519040,
      LODWORD(v24),
      &v41);
    *(float *)&v33 = *a1 + 240.0;
    v34 = a1[1];
    if ( ui_mouse_inside_rect((float *)&v33, (__int64)v52, 10) )
    {
      *(float *)&v33 = v39 + 1.0;
      v41 = 1045220557;
      v42 = 1053609165;
      v43 = 0.80000001;
      v44 = 1065353216;
      v34 = v40 + 1.0;
      v25 = v47 - 1.0;
      (*(void (__thiscall **)(int, int *, int, _DWORD, int *))(*(_DWORD *)grim_interface_ptr + 208))(
        grim_interface_ptr,
        &v33,
        1086324736,
        LODWORD(v25),
        &v41);
      byte_4D11FA = 1;
      if ( (unsigned __int8)input_primary_just_pressed() )
      {
        if ( ui_mouse_inside_rect(&v39, (__int64)v47, 8) )
          flt_4D11FC = ui_mouse_y - a1[1] - *(float *)a2 / (double)*(int *)(a2 + 52) * v52;
        else
          flt_4D11FC = 0.0;
      }
    }
    else
    {
      *(float *)&v33 = v39 + 1.0;
      v41 = 1036831949;
      v42 = 1045220557;
      v43 = 0.40000001;
      v44 = 1065353216;
      v34 = v40 + 1.0;
      v26 = v47 - 1.0;
      (*(void (__thiscall **)(int, int *, int, _DWORD, int *))(*(_DWORD *)grim_interface_ptr + 208))(
        grim_interface_ptr,
        &v33,
        1086324736,
        LODWORD(v26),
        &v41);
      if ( !(unsigned __int8)input_primary_is_down() )
      {
        byte_4D11FA = 0;
        goto LABEL_35;
      }
    }
    if ( byte_4D11FA && (unsigned __int8)input_primary_is_down() )
    {
      v48 = *(_DWORD *)(a2 + 52);
      v12 = (ui_mouse_y - a1[1] - flt_4D11FC) / v52 * (double)v48;
      v49 = v48 - *(_DWORD *)(a2 + 12);
      *(float *)a2 = v12;
      v50 = (float)v49;
      if ( v12 > v50 )
        *(float *)a2 = v50;
      if ( *(float *)a2 < 0.0 )
        *(_DWORD *)a2 = 0;
    }
  }
LABEL_35:
  v13 = a1[1];
  v37 = *a1;
  v38 = v13;
  result = *(_DWORD *)(a2 + 12);
  v30 = 0;
  v37 = v37 - 2.0;
  if ( result > 0 )
  {
    v15 = v32;
    v31 = 4 * v32;
    while ( 1 )
    {
      result = *(_DWORD *)(a2 + 52);
      if ( v30 >= result )
        break;
      if ( ui_mouse_inside_rect(&v37, 17, 240) )
      {
        v51 = 1065353216;
        *(_DWORD *)(a2 + 4) = v15;
        if ( (unsigned __int8)input_primary_just_pressed() )
          *(_DWORD *)(a2 + 8) = v15;
      }
      else
      {
        v51 = 1063675494;
        if ( *(_DWORD *)(a2 + 8) != v15 )
          v51 = 1060320051;
      }
      v16 = *(_DWORD *)(*(_DWORD *)(a2 + 48) + v31);
      if ( *(_BYTE *)v16 == 92 )
      {
        if ( *(_BYTE *)(v16 + 1) == 103 )
        {
          (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
            grim_interface_ptr,
            1060320051,
            1065353216,
            1060320051,
            v51);
          v16 += 2;
        }
      }
      else
      {
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          v51);
      }
      v17 = 0;
      v53 = 0;
      v18 = strlen((const char *)v16) + 1;
      if ( v18 > 0 )
      {
        v29 = (_DWORD *)(a2 + 16);
        do
        {
          v19 = *(_BYTE *)(v17 + v16);
          if ( v19 == 9 || !v19 )
          {
            *(_BYTE *)(v17 + v16) = 0;
            v33 = v53 * *v29;
            v27 = v38 + 2.0;
            v23 = (double)v33 + v37 + 8.0;
            (*(void (__stdcall **)(_DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 324))(
              LODWORD(v23),
              LODWORD(v27),
              v16);
            v20 = v17 + 1;
            ++v53;
            v16 += v20;
            v18 -= v20;
            ++v29;
            v17 = 0;
          }
          ++v17;
        }
        while ( v17 < v18 );
      }
      v21 = *(_DWORD *)(a2 + 12);
      result = v30 + 1;
      v38 = v38 + 16.0;
      v22 = ++v30 < v21;
      v31 += 4;
      ++v32;
      if ( !v22 )
        break;
      v15 = v32;
    }
  }
  return result;
}

// ui_menu_item_update @ 0x0043E5E0
// draws a text menu item, updates hover/press state, and returns 1 when activated
char __usercall sub_43E5E0@<al>(int a1@<esi>, float *a2, int a3, float a4, int a5, int a6)
{
  _DWORD *v6; // edi
  bool v7; // bl
  float *v8; // esi
  double v9; // st7
  bool v10; // al
  float v13[2]; // [esp+8h] [ebp-8h] BYREF

  v6 = (_DWORD *)a3;
  v7 = ui_focus_update(a3);
  if ( (byte_4CC910 & 1) == 0 )
  {
    dword_4CCD40 = 1049398413;
    byte_4CC910 |= 1u;
    dword_4CCD44 = 1060418741;
    dword_4CCD48 = 1064366321;
    dword_4CCD4C = 1058642330;
    crt_atexit(nullsub_44);
  }
  if ( (byte_4CC910 & 2) == 0 )
  {
    dword_4D0E28 = 1049398413;
    byte_4CC910 |= 2u;
    dword_4D0E2C = 1060418741;
    dword_4D0E30 = 1064366321;
    dword_4D0E34 = 1065353216;
    crt_atexit(nullsub_43);
  }
  v8 = a2;
  if ( v7 )
  {
    v13[0] = *a2 - 16.0;
    v13[1] = a2[1];
    ui_focus_draw(v13);
  }
  v9 = (double)(*(int (__thiscall **)(int, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 332))(
                 grim_interface_ptr,
                 *v6,
                 a1);
  a4 = v9;
  if ( v9 <= 0.0 )
    a4 = 8.0;
  v10 = ui_mouse_inside_rect(v8, 16, (__int64)a4);
  *((_BYTE *)v6 + 4) = v10;
  if ( v10 )
  {
    ui_focus_set((int)v6, 0);
    (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4D0E28);
  }
  else
  {
    (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4CCD40);
  }
  (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    *(_DWORD *)v8,
    *((_DWORD *)v8 + 1),
    aS_0,
    *v6);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  a2 = *(float **)v8;
  *(float *)&a3 = v8[1] + 13.0;
  (*(void (__thiscall **)(int, float **, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
    grim_interface_ptr,
    &a2,
    a6,
    1065353216);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  if ( *((_BYTE *)v6 + 6) )
    *((_BYTE *)v6 + 5) = v7
                      && ((*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(
                            grim_interface_ptr,
                            28)
                       || *((_BYTE *)v6 + 4) && (unsigned __int8)input_primary_just_pressed());
  else
    *((_BYTE *)v6 + 5) = 0;
  if ( *((_BYTE *)v6 + 5) )
    sfx_play(sfx_ui_buttonclick, 1.0);
  return *((_BYTE *)v6 + 5);
}

// nullsub_43 @ 0x0043E810
void __cdecl nullsub_43()
{
  ;
}

// nullsub_44 @ 0x0043E820
void __cdecl nullsub_44()
{
  ;
}

// ui_button_update @ 0x0043E830
// draws a UI button, updates hover/press state, and returns 1 when activated
char __cdecl sub_43E830(float *a1, int a2)
{
  int v2; // esi
  int v4; // eax
  int v5; // eax
  int v6; // eax
  float v7; // eax
  double v8; // st7
  double v9; // st7
  int v10; // eax
  int v11; // edx
  int v12; // ebp
  float v14; // [esp+ACh] [ebp-38h]
  float v15; // [esp+B0h] [ebp-34h]
  int v16; // [esp+B0h] [ebp-34h]
  int v17; // [esp+B0h] [ebp-34h]
  int v18; // [esp+B0h] [ebp-34h]
  int v19; // [esp+B4h] [ebp-30h]
  int v20; // [esp+B4h] [ebp-30h]
  int v21; // [esp+B4h] [ebp-30h]
  float v22; // [esp+B4h] [ebp-30h]
  int v23; // [esp+B8h] [ebp-2Ch]
  int v24; // [esp+B8h] [ebp-2Ch]
  int v25; // [esp+B8h] [ebp-2Ch]
  float v26; // [esp+B8h] [ebp-2Ch]
  int v27; // [esp+BCh] [ebp-28h]
  int v28; // [esp+BCh] [ebp-28h]
  float v29; // [esp+C8h] [ebp-1Ch]
  int v30; // [esp+CCh] [ebp-18h] BYREF
  float v31; // [esp+D0h] [ebp-14h]
  float v32; // [esp+D4h] [ebp-10h] BYREF
  float v33; // [esp+D8h] [ebp-Ch]
  float v34; // [esp+DCh] [ebp-8h]
  float v35; // [esp+E0h] [ebp-4h]
  float v36; // [esp+E8h] [ebp+4h]
  int v37; // [esp+E8h] [ebp+4h]

  v2 = a2;
  LOBYTE(a2) = ui_focus_update(a2);
  if ( (_BYTE)a2 )
  {
    *(float *)&v30 = *a1 - 16.0;
    v31 = a1[1];
    ui_focus_draw((float *)&v30);
  }
  v29 = (float)(*(int (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 332))(
                 grim_interface_ptr,
                 *(_DWORD *)v2);
  if ( dword_478670 == -1 )
    dword_478670 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                     grim_interface_ptr,
                     aUiButtonsm);
  if ( dword_478674 == -1 )
    dword_478674 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 192))(
                     grim_interface_ptr,
                     aUiButtonmd);
  if ( v29 < 40.0 || (v36 = 145.0, *(_BYTE *)(v2 + 20)) )
    v36 = 82.0;
  if ( *(_BYTE *)(v2 + 21) )
    v36 = 145.0;
  a1[1] = a1[1] + 2.0;
  *(_BYTE *)(v2 + 4) = ui_mouse_inside_rect(a1, 28, (__int64)v36);
  a1[1] = a1[1] - 2.0;
  if ( *(_BYTE *)(v2 + 4) )
    ui_focus_set(v2, 0);
  if ( *(_BYTE *)(v2 + 6) && (*(_BYTE *)(v2 + 4) || (_BYTE)a2 && dword_4D11EC > 800) )
    v4 = 6 * frame_dt_ms + *(_DWORD *)(v2 + 8);
  else
    v4 = -4 * frame_dt_ms + *(_DWORD *)(v2 + 8);
  *(_DWORD *)(v2 + 8) = v4;
  v5 = *(_DWORD *)(v2 + 12);
  if ( v5 > 0 )
    *(_DWORD *)(v2 + 12) = v5 - 6 * frame_dt_ms;
  if ( *(int *)(v2 + 12) < 0 )
    *(_DWORD *)(v2 + 12) = 0;
  v6 = *(_DWORD *)(v2 + 8);
  if ( v6 >= 0 )
  {
    if ( v6 > 1000 )
      *(_DWORD *)(v2 + 8) = 1000;
  }
  else
  {
    *(_DWORD *)(v2 + 8) = 0;
  }
  v7 = *(float *)(v2 + 12);
  v32 = 0.5;
  v33 = 0.5;
  v34 = 0.69999999;
  v35 = 0.0;
  *(float *)&v30 = v7;
  if ( SLODWORD(v7) > 0 )
  {
    v8 = (double)v30;
    v32 = v8 * 0.00050000002 + 0.5;
    v33 = v32;
    v9 = v8 * 0.00070000003 + 0.69999999;
    v34 = v9;
    if ( v32 > 1.0 )
      v32 = 1.0;
    if ( v33 > 1.0 )
      v33 = 1.0;
    if ( v9 > 1.0 )
      v34 = 1.0;
  }
  v30 = *(int *)(v2 + 8);
  if ( v30 > 0 )
  {
    v35 = (double)v30 * 0.001 * *(float *)(v2 + 16);
    *(float *)&v30 = *a1 + 12.0;
    v31 = a1[1] + 5.0;
    v15 = v36 - 24.0;
    (*(void (__thiscall **)(int, int *, _DWORD, int, float *))(*(_DWORD *)grim_interface_ptr + 208))(
      grim_interface_ptr,
      &v30,
      LODWORD(v15),
      1102053376,
      &v32);
  }
  if ( v29 < 40.0 || *(_BYTE *)(v2 + 20) )
  {
    v10 = dword_478670;
    v11 = *(_DWORD *)grim_interface_ptr;
  }
  else
  {
    v10 = dword_478674;
    v11 = *(_DWORD *)grim_interface_ptr;
  }
  (*(void (__stdcall **)(int, _DWORD))(v11 + 196))(v10, 0);
  if ( *(_BYTE *)(v2 + 21) )
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      dword_478674,
      0);
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    *(_DWORD *)(v2 + 16));
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    v16,
    v19,
    v23);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, float, int))(*(_DWORD *)grim_interface_ptr + 284))(
    grim_interface_ptr,
    *(_DWORD *)a1,
    *((_DWORD *)a1 + 1),
    COERCE_FLOAT(LODWORD(v36)),
    1107296256);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v17,
    v20,
    v24);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v18,
    v21,
    v25);
  if ( *(_BYTE *)(v2 + 4) )
    v26 = *(float *)(v2 + 16);
  else
    v26 = *(float *)(v2 + 16) * 0.69999999;
  (*(void (__stdcall **)(int, int, int, float, int))(*(_DWORD *)grim_interface_ptr + 276))(
    1065353216,
    1065353216,
    1065353216,
    COERCE_FLOAT(LODWORD(v26)),
    v27);
  v28 = *(_DWORD *)v2;
  v12 = *(_DWORD *)grim_interface_ptr;
  v22 = a1[1] + 10.0;
  v31 = *(float *)&a2 * 0.5 + *a1;
  v37 = (*(int (**)(int, _DWORD, char *, ...))(v12 + 332))(v28, LODWORD(v22), aS_0, v28) / 2;
  v14 = *(float *)&v30 - (double)v37 + 1.0;
  (*(void (__cdecl **)(int, _DWORD))(v12 + 328))(grim_interface_ptr, LODWORD(v14));
  if ( *(_BYTE *)(v2 + 6) )
    *(_BYTE *)(v2 + 5) = (_BYTE)a2
                      && ((*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(
                            grim_interface_ptr,
                            28)
                       || *(_BYTE *)(v2 + 4) && (unsigned __int8)input_primary_just_pressed());
  else
    *(_BYTE *)(v2 + 5) = 0;
  if ( *(_BYTE *)(v2 + 5) )
  {
    *(_DWORD *)(v2 + 12) = 1000;
    sfx_play(sfx_ui_buttonclick, 1.0);
  }
  return *(_BYTE *)(v2 + 5);
}

// ui_text_input_update @ 0x0043ECF0
// updates a text input field: focus, input polling, sfx, and rendering
char __cdecl sub_43ECF0(float *a1, _DWORD *a2)
{
  bool v3; // al
  double v4; // st7
  bool v5; // bl
  int v7; // ebx
  int v8; // eax
  double v9; // st7
  int v10; // ebp
  float v12; // [esp+60h] [ebp-3Ch]
  float v13; // [esp+64h] [ebp-38h]
  int v14; // [esp+64h] [ebp-38h]
  float v15; // [esp+64h] [ebp-38h]
  int v16; // [esp+68h] [ebp-34h]
  int v17; // [esp+6Ch] [ebp-30h]
  char v18; // [esp+83h] [ebp-19h]
  float v19; // [esp+84h] [ebp-18h] BYREF
  float v20; // [esp+88h] [ebp-14h]
  _DWORD v21[4]; // [esp+8Ch] [ebp-10h] BYREF
  int v22; // [esp+A0h] [ebp+4h]
  float v23; // [esp+A4h] [ebp+8h]
  float v24; // [esp+A4h] [ebp+8h]
  int v25; // [esp+A4h] [ebp+8h]

  v18 = 0;
  v3 = ui_focus_update((int)a2);
  v4 = (double)(int)a2[3];
  v5 = v3;
  v23 = v4;
  if ( ui_mouse_inside_rect(a1, 18, (__int64)v4) )
    ui_focus_set((int)a2, 0);
  if ( v5 )
  {
    v19 = *a1 - 16.0;
    v20 = a1[1];
    ui_focus_draw(&v19);
  }
  *(_BYTE *)(*a2 + a2[1] + 1) = 0;
  v7 = console_input_poll();
  if ( v7 == 13 )
  {
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28);
    (*(void (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 156);
    sfx_play(sfx_ui_typeenter, 1.0);
    v18 = 1;
  }
  else
  {
    (*(void (__thiscall **)(int, _DWORD, _DWORD *, _DWORD))(*(_DWORD *)grim_interface_ptr + 84))(
      grim_interface_ptr,
      *a2,
      a2 + 1,
      a2[2]);
    if ( v7 )
    {
      v8 = crt_rand() % 2;
      sfx_play(sfx_ui_typeclick_01 + v8, 1.0);
    }
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, float *, float, int))(*(_DWORD *)grim_interface_ptr + 212))(
    grim_interface_ptr,
    a1,
    COERCE_FLOAT(LODWORD(v23)),
    1099956224);
  v19 = *a1 + 1.0;
  v9 = a1[1] + 1.0;
  memset(v21, 0, 12);
  v20 = v9;
  v21[3] = 1065353216;
  v13 = v23 - 2.0;
  (*(void (__thiscall **)(int, float *, _DWORD, int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    &v19,
    LODWORD(v13),
    1098907648,
    v21);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v14,
    v16,
    v17);
  v10 = 0;
  v24 = v23 - 8.0 - 2.0;
  while ( 1 )
  {
    v22 = (*(int (__stdcall **)(int))(*(_DWORD *)grim_interface_ptr + 332))(v10 + *a2);
    if ( (double)v22 <= v24 )
      break;
    ++v10;
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1061997773);
  v15 = a1[1] + 2.0;
  v12 = *a1 + 4.0;
  (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v12),
    LODWORD(v15),
    aS_0,
    v10 + *a2);
  v25 = 1065353216;
  if ( sin(flt_47EA4C * 4.0) > 0.0 )
    v25 = 1053609165;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    v25);
  v19 = (double)v22 + *a1 + 4.0;
  v20 = a1[1] + 2.0;
  (*(void (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
    grim_interface_ptr,
    &v19,
    1065353216,
    1096810496);
  return v18;
}

// ui_list_widget_update @ 0x0043EFC0
// draws a list widget and updates selection/hover state
int __cdecl sub_43EFC0(float *a1, int a2)
{
  int v3; // ebp
  bool v4; // bl
  int v5; // edi
  int v6; // eax
  int v8; // eax
  int v9; // ebx
  int v10; // eax
  double v11; // st7
  int v12; // ebp
  double v13; // st7
  int v14; // eax
  int v15; // ebp
  int v17; // ebp
  int v18; // ebx
  float v19; // [esp+E0h] [ebp-3Ch]
  float v20; // [esp+E0h] [ebp-3Ch]
  float v21; // [esp+E0h] [ebp-3Ch]
  float v22; // [esp+E4h] [ebp-38h]
  int v23; // [esp+E4h] [ebp-38h]
  int v24; // [esp+E4h] [ebp-38h]
  float v25; // [esp+E4h] [ebp-38h]
  float v26; // [esp+E4h] [ebp-38h]
  float v27; // [esp+E8h] [ebp-34h]
  char *v28; // [esp+E8h] [ebp-34h]
  int v29; // [esp+E8h] [ebp-34h]
  int v30; // [esp+E8h] [ebp-34h]
  int v31; // [esp+ECh] [ebp-30h]
  int v32; // [esp+ECh] [ebp-30h]
  float v33; // [esp+100h] [ebp-1Ch]
  float v34; // [esp+104h] [ebp-18h] BYREF
  float v35; // [esp+108h] [ebp-14h]
  float v36; // [esp+10Ch] [ebp-10h] BYREF
  float v37; // [esp+110h] [ebp-Ch]
  int v38; // [esp+114h] [ebp-8h]
  int v39; // [esp+118h] [ebp-4h]
  float v40; // [esp+120h] [ebp+4h]
  int v41; // [esp+120h] [ebp+4h]
  bool i; // [esp+124h] [ebp+8h]

  v3 = 0;
  v4 = ui_focus_update(a2);
  v5 = 0;
  for ( i = v4; v5 < *(_DWORD *)(a2 + 16); ++v5 )
  {
    v6 = (*(int (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 332))(
           grim_interface_ptr,
           *(_DWORD *)(*(_DWORD *)(a2 + 12) + 4 * v5));
    if ( v6 > v3 )
      v3 = v6;
  }
  if ( *(_BYTE *)a2 )
  {
    if ( *(int *)(a2 + 4) <= 0 )
    {
      v33 = 16.0;
      *(_BYTE *)(a2 + 20) = 0;
      v40 = (float)(v3 + 48);
    }
    else
    {
      v40 = (float)(v3 + 48);
      v33 = (float)(16 * *(_DWORD *)(a2 + 16) + 24);
      *(_BYTE *)(a2 + 20) = ui_mouse_inside_rect(a1, (__int64)v33, (__int64)v40);
    }
  }
  else
  {
    v33 = 16.0;
    *(_BYTE *)(a2 + 20) = 0;
    *(_DWORD *)(a2 + 4) = 0;
    v40 = (float)(v3 + 48);
  }
  if ( *(_BYTE *)(a2 + 20) )
    ui_focus_set(a2, 0);
  if ( v4 )
  {
    v34 = *a1 - 16.0;
    v35 = a1[1];
    ui_focus_draw(&v34);
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 200) )
    {
      if ( *(_DWORD *)(a2 + 4) )
      {
        v8 = *(_DWORD *)(a2 + 24) - 1;
        *(_DWORD *)(a2 + 24) = v8;
        if ( v8 < 0 )
          *(_DWORD *)(a2 + 24) = 0;
      }
      else
      {
        *(_DWORD *)(a2 + 4) = 1;
      }
    }
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 208) )
    {
      if ( *(_DWORD *)(a2 + 4) )
      {
        v9 = *(_DWORD *)(a2 + 24) + 1;
        v10 = *(_DWORD *)(a2 + 16) - 1;
        *(_DWORD *)(a2 + 24) = v9;
        if ( v9 > v10 )
          *(_DWORD *)(a2 + 24) = v10;
      }
      else
      {
        *(_DWORD *)(a2 + 4) = 1;
      }
    }
  }
  v36 = 1.0;
  v37 = 1.0;
  v38 = 1065353216;
  v39 = 1065353216;
  (*(void (__thiscall **)(int, float *, float, float, float *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    a1,
    COERCE_FLOAT(LODWORD(v40)),
    COERCE_FLOAT(LODWORD(v33)),
    &v36);
  v34 = *a1 + 1.0;
  v11 = a1[1] + 1.0;
  v36 = 0.0;
  v37 = 0.0;
  v38 = 0;
  v39 = 1065353216;
  v35 = v11;
  v27 = v33 - 2.0;
  v22 = v40 - 2.0;
  (*(void (__stdcall **)(float *, _DWORD, _DWORD, float *))(*(_DWORD *)grim_interface_ptr + 208))(
    &v34,
    LODWORD(v22),
    LODWORD(v27),
    &v36);
  if ( *(int *)(a2 + 4) > 0 || *(_BYTE *)(a2 + 20) )
  {
    v34 = *a1;
    v13 = a1[1] + 15.0;
    v36 = 1.0;
    v35 = v13;
    v37 = 1.0;
    v38 = 1065353216;
    v39 = 1056964608;
    (*(void (__thiscall **)(int, float *, float, int, float *))(*(_DWORD *)grim_interface_ptr + 208))(
      grim_interface_ptr,
      &v34,
      COERCE_FLOAT(LODWORD(v40)),
      1065353216,
      &v36);
    v28 = aUiDropon;
    v12 = *(_DWORD *)grim_interface_ptr;
  }
  else
  {
    v28 = aUiDropoff;
    v12 = *(_DWORD *)grim_interface_ptr;
  }
  v14 = (*(int (__stdcall **)(char *, _DWORD))(v12 + 192))(v28, 0);
  (*(void (__thiscall **)(int, int))(v12 + 196))(grim_interface_ptr, v14);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    v23,
    v29,
    v31);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v19 = v40 + *a1 - 16.0 - 1.0;
  (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    LODWORD(v19),
    *((_DWORD *)a1 + 1),
    1098907648,
    1098907648);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v24,
    v30,
    v32);
  v15 = -2;
  if ( *(_BYTE *)a2 && FUN_00403430(a1, 14, (__int64)v40) )
  {
    v15 = -1;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1064514355);
  }
  else
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1061158912);
  }
  v25 = a1[1] + 1.0;
  v20 = *a1 + 4.0;
  (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v20),
    LODWORD(v25),
    aS_0,
    *(_DWORD *)(*(_DWORD *)(a2 + 12) + 4 * *(_DWORD *)(a2 + 8)));
  if ( *(int *)(a2 + 4) <= 0 )
    return v15;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1060320051);
  v17 = 0;
  if ( *(int *)(a2 + 16) > 0 )
  {
    v18 = 0;
    LODWORD(v34) = (__int64)v40;
    v41 = 0;
    do
    {
      v36 = *a1;
      v37 = (double)(v18 + 16) + a1[1];
      if ( FUN_00403430(&v36, 14, SLODWORD(v34)) )
      {
        *(_DWORD *)(a2 + 24) = v17;
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          1064514355);
      }
      else
      {
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          1058642330);
      }
      if ( i && *(_DWORD *)(a2 + 24) == v17 )
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          1064682127);
      v26 = (double)v41 + a1[1] + 17.0;
      v21 = *a1 + 4.0;
      (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v21),
        LODWORD(v26),
        aS_0,
        *(_DWORD *)(*(_DWORD *)(a2 + 12) + 4 * v17++));
      v18 += 16;
      v41 = v18;
    }
    while ( v17 < *(_DWORD *)(a2 + 16) );
  }
  if ( !*(_BYTE *)(a2 + 20) && !i )
    *(_DWORD *)(a2 + 4) = 0;
  return *(_DWORD *)(a2 + 24);
}

// sub_43F550 @ 0x0043F550
void sub_43F550()
{
  int v0; // esi
  char *v1; // eax
  int v2; // eax
  int v3; // edx
  double v4; // st7
  int v5; // edi
  int v6; // esi
  int v7; // edi
  int v8; // ebp
  float v9; // [esp+A8h] [ebp-40h]
  float v10; // [esp+A8h] [ebp-40h]
  float v11; // [esp+ACh] [ebp-3Ch]
  float v12; // [esp+ACh] [ebp-3Ch]
  float v13; // [esp+B0h] [ebp-38h]
  int v14; // [esp+B4h] [ebp-34h]
  float v15; // [esp+B4h] [ebp-34h]
  int v16; // [esp+B4h] [ebp-34h]
  int v17; // [esp+B4h] [ebp-34h]
  float v18; // [esp+B4h] [ebp-34h]
  float v19; // [esp+B4h] [ebp-34h]
  float v20; // [esp+B4h] [ebp-34h]
  float v21; // [esp+B4h] [ebp-34h]
  int v22; // [esp+B8h] [ebp-30h]
  int v23; // [esp+B8h] [ebp-30h]
  int v24; // [esp+B8h] [ebp-30h]
  float v25; // [esp+B8h] [ebp-30h]
  float v26; // [esp+B8h] [ebp-30h]
  float v27; // [esp+B8h] [ebp-30h]
  float v28; // [esp+B8h] [ebp-30h]
  int v29; // [esp+BCh] [ebp-2Ch]
  int v30; // [esp+BCh] [ebp-2Ch]
  int v31; // [esp+BCh] [ebp-2Ch]
  char *v32; // [esp+BCh] [ebp-2Ch]
  float v33; // [esp+BCh] [ebp-2Ch]
  float v34; // [esp+D0h] [ebp-18h]
  int v35; // [esp+D0h] [ebp-18h]
  float v36; // [esp+D4h] [ebp-14h]
  float v37; // [esp+D8h] [ebp-10h] BYREF
  float v38; // [esp+DCh] [ebp-Ch]
  float v39; // [esp+E4h] [ebp-4h]

  if ( (byte_4D0F20 & 1) == 0 )
  {
    byte_4CC91E = 1;
    byte_4D0F20 |= 1u;
    byte_4CC92D = 0;
    byte_4CC92C = 0;
    dword_4CC928 = 1065353216;
    dword_4CC924 = 0;
    dword_4CC918 = 0;
    byte_4CC91C = 0;
    byte_4CC91D = 0;
    dword_4CC920 = 0;
    crt_atexit(nullsub_52);
  }
  dword_4CC918 = (int)aHighScores;
  if ( (byte_4D0F20 & 2) == 0 )
  {
    byte_4D0F46 = 1;
    byte_4D0F20 |= 2u;
    byte_4D0F55 = 0;
    byte_4D0F54 = 0;
    dword_4D0F50 = 1065353216;
    dword_4D0F4C = 0;
    dword_4D0F40 = 0;
    byte_4D0F44 = 0;
    byte_4D0F45 = 0;
    dword_4D0F48 = 0;
    crt_atexit(nullsub_51);
  }
  dword_4D0F40 = (int)aWeapons;
  if ( (byte_4D0F20 & 4) == 0 )
  {
    byte_4CC8FE = 1;
    byte_4D0F20 |= 4u;
    byte_4CC90D = 0;
    byte_4CC90C = 0;
    dword_4CC908 = 1065353216;
    dword_4CC904 = 0;
    dword_4CC8F8 = 0;
    byte_4CC8FC = 0;
    byte_4CC8FD = 0;
    dword_4CC900 = 0;
    crt_atexit(nullsub_50);
  }
  dword_4CC8F8 = (int)aPerks;
  if ( (byte_4D0F20 & 8) == 0 )
  {
    byte_4D0EBE = 1;
    byte_4D0F20 |= 8u;
    byte_4D0ECD = 0;
    byte_4D0ECC = 0;
    dword_4D0EC8 = 1065353216;
    dword_4D0EC4 = 0;
    dword_4D0EB8 = 0;
    byte_4D0EBC = 0;
    byte_4D0EBD = 0;
    dword_4D0EC0 = 0;
    crt_atexit(nullsub_49);
  }
  dword_4D0EB8 = (int)aCredits_0;
  if ( (byte_4D0F20 & 0x10) == 0 )
  {
    byte_4D0F66 = 1;
    byte_4D0F20 |= 0x10u;
    byte_4D0F75 = 0;
    byte_4D0F74 = 0;
    dword_4D0F70 = 1065353216;
    dword_4D0F6C = 0;
    dword_4D0F60 = 0;
    byte_4D0F64 = 0;
    byte_4D0F65 = 0;
    dword_4D0F68 = 0;
    crt_atexit(nullsub_48);
  }
  dword_4D0F60 = (int)aTypOShooter_0;
  if ( (byte_4D0F20 & 0x20) == 0 )
  {
    byte_4CCD56 = 1;
    byte_4D0F20 |= 0x20u;
    byte_4CCD65 = 0;
    byte_4CCD64 = 0;
    dword_4CCD60 = 1065353216;
    dword_4CCD5C = 0;
    dword_4CCD50 = 0;
    byte_4CCD54 = 0;
    byte_4CCD55 = 0;
    dword_4CCD58 = 0;
    crt_atexit(nullsub_47);
  }
  dword_4CCD50 = (int)aMods_0;
  if ( (byte_4D0F20 & 0x40) == 0 )
  {
    byte_4D11CE = 1;
    byte_4D0F20 |= 0x40u;
    byte_4D11DD = 0;
    byte_4D11DC = 0;
    dword_4D11D8 = 1065353216;
    dword_4D11D4 = 0;
    dword_4D11C8 = 0;
    byte_4D11CC = 0;
    byte_4D11CD = 0;
    dword_4D11D0 = 0;
    crt_atexit(nullsub_46);
  }
  dword_4D11C8 = (int)aCheckForUpdate;
  if ( byte_4D0F20 >= 0 )
  {
    byte_4CCCC6 = 1;
    byte_4D0F20 |= 0x80u;
    byte_4CCCD5 = 0;
    byte_4CCCD4 = 0;
    dword_4CCCD0 = 1065353216;
    dword_4CCCCC = 0;
    dword_4CCCC0 = 0;
    byte_4CCCC4 = 0;
    byte_4CCCC5 = 0;
    dword_4CCCC8 = 0;
    crt_atexit(nullsub_45);
  }
  dword_4CCCC0 = (int)aBack_0;
  if ( !dword_4D11F0 || dword_4D11F0 == 6 )
  {
    byte_4CCCC6 = 1;
    byte_4D11CE = 1;
    byte_4CCD56 = 1;
    byte_4D0EBE = 1;
    byte_4D0F46 = 1;
    byte_4CC91E = 1;
  }
  else
  {
    byte_4CCCC6 = 0;
    byte_4D11CE = 0;
    byte_4CCD56 = 0;
    byte_4D0EBE = 0;
    byte_4D0F46 = 0;
    byte_4CC91E = 0;
  }
  v39 = flt_48E83C + flt_48E860;
  v34 = flt_48E85C + flt_48E838 + 300.0;
  v36 = v39 + 40.0;
  v38 = v36;
  v37 = flt_48E828 - 110.0 + v34 + 52.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v38 = v36 + 16.0;
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_48F7F4, 0);
  (*(void (__thiscall **)(int, _DWORD, int, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    1052770304,
    1065353216,
    1056964608);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    v14,
    v22,
    v29);
  v15 = v38 - 4.0;
  v13 = v37 + 64.0 - 16.0;
  (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    LODWORD(v13),
    LODWORD(v15),
    1124073472,
    1107296256);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v16,
    v23,
    v30);
  v38 = v38 + 48.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1047233823);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1054615798,
    v17,
    v24,
    v31);
  v0 = *(_DWORD *)&game_sequence_id / 1000 / 60;
  v35 = v0 / 60;
  v11 = v38 + 230.0;
  v9 = v37 - 38.0;
  (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v9),
    LODWORD(v11),
    aPlayedForDHour,
    v0 / 60,
    v0 % 60,
    *(_DWORD *)&game_sequence_id / 1000 - 60 * (v0 % 60));
  if ( !dword_4D11F0 )
  {
    if ( !byte_4D11F8 || lpMultiByteStr )
    {
      if ( dword_4D11D0 <= 0 )
        goto LABEL_35;
      v33 = (double)dword_4D11D0 * 0.001;
      (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        LODWORD(v33));
      v28 = v38 + 186.0;
      v20 = v37 - 38.0;
      (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v20),
        LODWORD(v28),
        aConnectTheInte);
      v2 = grim_interface_ptr;
      v3 = *(_DWORD *)grim_interface_ptr;
      v32 = aForNewCrimsonl;
      v27 = v38 + 200.0;
      v4 = v37 - 38.0;
    }
    else
    {
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1056964608,
        1058642330,
        1065353216,
        1061997773);
      v26 = v38 + 186.0;
      v19 = v37 - 40.0;
      (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v19),
        LODWORD(v26),
        aYouVeGotTheNew);
      v2 = grim_interface_ptr;
      v3 = *(_DWORD *)grim_interface_ptr;
      v32 = aOfCrimsonland;
      v27 = v38 + 200.0;
      v4 = v37 - 40.0;
    }
    v21 = v4;
    (*(void (__cdecl **)(int, _DWORD, float, char *))(v3 + 328))(v2, LODWORD(v21), COERCE_FLOAT(LODWORD(v27)), v32);
    goto LABEL_35;
  }
  Sleep(0xAu);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v1 = szPassword;
  switch ( dword_4D11F0 )
  {
    case 1:
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1045220557,
        1065353216,
        1045220557,
        1061997773);
      v1 = aConnectingServ;
      break;
    case 5:
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1053609165,
        1065353216,
        1053609165,
        1061997773);
      v1 = aDone;
      break;
    case 6:
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1036831949,
        1036831949,
        1061997773);
      v1 = aFailed;
      break;
  }
  v25 = v38 + 186.0;
  v18 = v37 - 38.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v18),
    LODWORD(v25),
    v1);
LABEL_35:
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v5 = *(_DWORD *)&dword_48718C / 1000 / 60;
  v6 = v5 / 60;
  v7 = v5 % 60;
  v8 = *(_DWORD *)&dword_48718C / 1000 - 60 * v7;
  if ( v6 != v35
    && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(grim_interface_ptr, 59) )
  {
    v12 = v38 + 230.0 - 15.0;
    v10 = v37 - 38.0;
    (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      LODWORD(v10),
      LODWORD(v12),
      aTotalDh,
      v6,
      v7,
      v8);
  }
  v37 = v37 + 28.0;
  ui_button_update(&v37, (int)&dword_4CC918);
  v38 = v38 + 34.0;
  ui_button_update(&v37, (int)&dword_4D0F40);
  v38 = v38 + 34.0;
  ui_button_update(&v37, (int)&dword_4CC8F8);
  v38 = v38 + 34.0;
  ui_button_update(&v37, (int)&dword_4D0EB8);
  v37 = v37 + 124.0;
  v38 = v38 + 34.0 + 34.0 + 16.0;
  ui_button_update(&v37, (int)&dword_4CCCC0);
  v38 = v38 + 34.0;
  if ( byte_4CC91D )
  {
    ui_transition_direction = 0;
    game_state_pending = 14;
    if ( *(int *)quest_stage_major >= 1 )
    {
      if ( *(int *)quest_stage_major > 4 )
        *(_DWORD *)quest_stage_major = 4;
    }
    else
    {
      *(_DWORD *)quest_stage_major = 1;
    }
    if ( quest_stage_minor >= 1 )
    {
      if ( quest_stage_minor > 10 )
        quest_stage_minor = 10;
      j_highscore_load_table();
    }
    else
    {
      quest_stage_minor = 1;
      j_highscore_load_table();
    }
  }
  if ( byte_4D0F45 )
  {
    ui_transition_direction = 0;
    game_state_pending = 15;
  }
  if ( byte_4CC8FD )
  {
    ui_transition_direction = 0;
    game_state_pending = 16;
  }
  if ( byte_4D0F65 )
  {
    render_pass_mode = 0;
    byte_487292 = 0;
    ui_transition_direction = 0;
    game_state_pending = 18;
    config_game_mode = 4;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    byte_48702C = 1;
  }
  if ( byte_4D0EBD )
  {
    ui_transition_direction = 0;
    game_state_pending = 17;
  }
  if ( byte_4D11CD )
  {
    dword_4D11F0 = 1;
    crt_beginthread((_beginthread_proc_type)sub_42D8A0, 0, 0);
  }
  if ( byte_4CCCC5 )
  {
    ui_transition_direction = 0;
    game_state_pending = 0;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    sfx_play_exclusive(music_track_crimson_theme_id);
  }
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 1) )
  {
    ui_transition_direction = 0;
    game_state_pending = 0;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    sfx_play_exclusive(music_track_crimson_theme_id);
  }
  if ( !ui_transition_direction )
    byte_4D11F8 = 0;
}

// nullsub_45 @ 0x00440090
void __cdecl nullsub_45()
{
  ;
}

// nullsub_46 @ 0x004400A0
void __cdecl nullsub_46()
{
  ;
}

// nullsub_47 @ 0x004400B0
void __cdecl nullsub_47()
{
  ;
}

// nullsub_48 @ 0x004400C0
void __cdecl nullsub_48()
{
  ;
}

// nullsub_49 @ 0x004400D0
void __cdecl nullsub_49()
{
  ;
}

// nullsub_50 @ 0x004400E0
void __cdecl nullsub_50()
{
  ;
}

// nullsub_51 @ 0x004400F0
void __cdecl nullsub_51()
{
  ;
}

// nullsub_52 @ 0x00440100
void __cdecl nullsub_52()
{
  ;
}

// sub_440110 @ 0x00440110
int sub_440110()
{
  int v0; // edi
  int v1; // edx
  int v2; // esi
  char *v3; // eax
  int v4; // esi
  char **v5; // ecx
  char *v6; // eax
  int v7; // edx
  int v8; // ecx
  char *v9; // eax
  int v10; // ebp
  bool v11; // zf
  int v12; // ecx
  int result; // eax
  float v14; // [esp+108h] [ebp-138h]
  float v15; // [esp+10Ch] [ebp-134h]
  int v16; // [esp+10Ch] [ebp-134h]
  int v17; // [esp+10Ch] [ebp-134h]
  float v18; // [esp+10Ch] [ebp-134h]
  int v19; // [esp+10Ch] [ebp-134h]
  int v20; // [esp+10Ch] [ebp-134h]
  float v21; // [esp+10Ch] [ebp-134h]
  float v22; // [esp+10Ch] [ebp-134h]
  float v23; // [esp+110h] [ebp-130h]
  int v24; // [esp+110h] [ebp-130h]
  int v25; // [esp+110h] [ebp-130h]
  int v26; // [esp+110h] [ebp-130h]
  int v27; // [esp+110h] [ebp-130h]
  int v28; // [esp+114h] [ebp-12Ch]
  int v29; // [esp+114h] [ebp-12Ch]
  int v30; // [esp+114h] [ebp-12Ch]
  int v31; // [esp+114h] [ebp-12Ch]
  float v32; // [esp+128h] [ebp-118h] BYREF
  float v33; // [esp+12Ch] [ebp-114h]
  int v34; // [esp+130h] [ebp-110h] BYREF
  float v35; // [esp+134h] [ebp-10Ch]
  int v36; // [esp+138h] [ebp-108h] BYREF
  float v37; // [esp+13Ch] [ebp-104h]
  _BYTE v38[256]; // [esp+140h] [ebp-100h] BYREF

  v33 = flt_489DFC + flt_489E20;
  v0 = -1;
  *(float *)&v34 = flt_489E1C + flt_489DF8 + 300.0;
  v35 = v33 + 40.0;
  v33 = v35 + 10.0;
  v32 = *(float *)&v34 + flt_489DE8 + 44.0 - 110.0 - 32.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  *(float *)&v34 = COERCE_FLOAT(
                     (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 332))(
                       grim_interface_ptr,
                       aUnlockedWeapon));
  v1 = *(_DWORD *)grim_interface_ptr;
  v36 = v34 / 2;
  v15 = v32 + 132.0 - (double)(v34 / 2);
  (*(void (__stdcall **)(_DWORD, float, char *))(v1 + 324))(LODWORD(v15), COERCE_FLOAT(LODWORD(v33)), aUnlockedWeapon);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1056964608);
  *(float *)&v36 = (double)(132 - v34 / 2) + v32;
  v37 = v33 + 13.0;
  v23 = (float)v34;
  (*(void (__stdcall **)(int *, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 212))(&v36, LODWORD(v23), 1065353216);
  v2 = 0;
  v3 = &byte_4D7AE8;
  do
  {
    if ( *v3 )
      ++v2;
    v3 += 124;
  }
  while ( (int)v3 < (int)byte_4D996C );
  v33 = v33 + 20.0 + 10.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1060320051);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v16,
    v24,
    v28);
  v14 = v32 + 8.0;
  (*(void (**)(int, _DWORD, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v14),
    COERCE_FLOAT(LODWORD(v33)),
    aDWeaponsInData,
    v2);
  v33 = v33 + 20.0 + 8.0;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 200) )
  {
    ui_mouse_blocked = 1;
    --dword_4D1200;
  }
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 208) )
  {
    ui_mouse_blocked = 1;
    ++dword_4D1200;
  }
  if ( dword_4D1200 >= 0 )
  {
    if ( dword_4D1200 > 1 )
      dword_4D1200 = 1;
  }
  else
  {
    dword_4D1200 = 0;
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v17,
    v25,
    v29);
  v32 = v32 + 10.0;
  v18 = v32 - 2.0;
  (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v18),
    COERCE_FLOAT(LODWORD(v33)),
    aWeapon);
  v4 = 0;
  v5 = (char **)v38;
  v6 = (char *)&byte_4D7AA8;
  v33 = v33 + 16.0 + 4.0;
  do
  {
    if ( v6[64] )
    {
      *v5 = v6;
      ++v4;
      ++v5;
    }
    v6 += 124;
  }
  while ( (int)v6 < (int)byte_4D992C );
  if ( (byte_4CCC51 & 1) == 0 )
  {
    dword_4CCC68 = 0;
    byte_4CCC51 |= 1u;
    dword_4CCC6C = 0;
    crt_atexit(nullsub_54);
  }
  dword_4CCC88 = (int)v38;
  dword_4CCC8C = v4;
  dword_4CCC64 = 10;
  ui_scrollbar_update(&v32, (int)&unk_4CCC58);
  if ( dword_4CCC5C != -1 )
  {
    v7 = 0;
    v8 = 1;
    v9 = &byte_4D7AE8;
    while ( 1 )
    {
      if ( *v9 )
      {
        v10 = v7++;
        if ( v10 == dword_4CCC5C )
          break;
      }
      v9 += 124;
      ++v8;
      if ( (int)v9 >= (int)byte_4D996C )
        goto LABEL_26;
    }
    v0 = v8;
  }
LABEL_26:
  v37 = flt_489DFC + flt_489E20;
  *(float *)&v34 = flt_489E1C + flt_489DF8 + 300.0;
  v35 = v37 + 40.0;
  v33 = v35 + 265.0;
  v32 = *(float *)&v34 + flt_489DE8 + 44.0 - 110.0 - 10.0;
  if ( (byte_4CCC51 & 2) == 0 )
  {
    byte_4CCC51 |= 2u;
    byte_4CC8E6 = 1;
    byte_4CC8F5 = 0;
    byte_4CC8F4 = 0;
    dword_4CC8F0 = 1065353216;
    dword_4CC8EC = 0;
    dword_4CC8E0 = 0;
    byte_4CC8E4 = 0;
    byte_4CC8E5 = 0;
    dword_4CC8E8 = 0;
    crt_atexit(nullsub_53);
  }
  dword_4CC8E0 = (int)aBack_0;
  *(float *)&v34 = v32 + 144.0;
  v35 = v33 + 8.0;
  if ( ui_button_update((float *)&v34, (int)&dword_4CC8E0) )
  {
    ui_transition_direction = 0;
    game_state_pending = 4;
  }
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v19,
    v26,
    v30);
  v37 = flt_48A114 + flt_48A138;
  *(float *)&v34 = flt_48A134 + flt_48A110 + 300.0;
  v35 = v37 + 40.0;
  v33 = v35 + 10.0;
  v32 = flt_48A100 - 16.0 + *(float *)&v34 - 240.0 - 10.0;
  if ( *(int *)config_screen_width <= 640 )
    v32 = v32 + 20.0;
  if ( v0 != -1 )
  {
    v32 = v32 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      1054615798,
      v20,
      v27,
      v31);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1053609165);
    v21 = v33 - 18.0;
    (*(void (__cdecl **)(int))(*(_DWORD *)grim_interface_ptr + 328))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, _DWORD, char *, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      1056964608,
      LODWORD(v21),
      aWepnoD,
      v0);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    (*(void (**)(int, float, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v32)),
      COERCE_FLOAT(LODWORD(v33)),
      aS_0,
      (char *)&weapon_table + 124 * v0);
    v32 = v32 + 32.0;
    v33 = v33 + 22.0 + 26.0;
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      ui_weapon_icons_texture,
      0);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 264))(
      grim_interface_ptr,
      8,
      2,
      1,
      2 * effect_subrect_frame_table[31 * v0]);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v22 = v33 - 16.0;
    (*(void (__stdcall **)(float, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
      COERCE_FLOAT(LODWORD(v32)),
      LODWORD(v22),
      1115684864,
      1107296256);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    v11 = weapon_ammo_class[31 * v0] == 1;
    v33 = v33 + 30.0;
    v32 = v32 - 16.0;
    if ( v11 )
      (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v32)),
        COERCE_FLOAT(LODWORD(v33)),
        aFirerateNA);
    else
      (*(void (**)(int, float, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v32)),
        COERCE_FLOAT(LODWORD(v33)),
        aFirerateDRpm,
        (unsigned int)(__int64)(60.0 / *(float *)&dword_4D7A74[31 * v0]));
    v33 = v33 + 18.0;
    (*(void (**)(int, float, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v32)),
      COERCE_FLOAT(LODWORD(v33)),
      aReloadTime1fSe,
      flt_4D7A78[31 * v0]);
    v12 = dword_4D7A70[31 * v0];
    v33 = v33 + 18.0;
    (*(void (**)(int, float, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v32)),
      COERCE_FLOAT(LODWORD(v33)),
      aClipSizeD,
      v12);
    v33 = v33 + 18.0;
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  result = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 1);
  if ( (_BYTE)result )
  {
    ui_transition_direction = 0;
    game_state_pending = 4;
  }
  return result;
}

// nullsub_53 @ 0x00440940
void __cdecl nullsub_53()
{
  ;
}

// nullsub_54 @ 0x00440950
void __cdecl nullsub_54()
{
  ;
}

// sub_440960 @ 0x00440960
int sub_440960()
{
  int v0; // edi
  int v1; // edx
  int v2; // esi
  _BYTE *v3; // eax
  int v4; // esi
  int *v5; // ecx
  int *v6; // eax
  int v7; // edx
  int v8; // ecx
  char *v9; // eax
  int v10; // ebp
  int v11; // esi
  int v12; // edx
  int v13; // eax
  int v14; // edi
  bool v15; // zf
  int result; // eax
  float v17; // [esp+12Ch] [ebp-238h]
  float v18; // [esp+12Ch] [ebp-238h]
  float v19; // [esp+130h] [ebp-234h]
  int v20; // [esp+130h] [ebp-234h]
  int v21; // [esp+130h] [ebp-234h]
  float v22; // [esp+130h] [ebp-234h]
  int v23; // [esp+130h] [ebp-234h]
  float v24; // [esp+130h] [ebp-234h]
  float v25; // [esp+130h] [ebp-234h]
  float v26; // [esp+130h] [ebp-234h]
  float v27; // [esp+134h] [ebp-230h]
  int v28; // [esp+134h] [ebp-230h]
  int v29; // [esp+134h] [ebp-230h]
  int v30; // [esp+134h] [ebp-230h]
  float v31; // [esp+134h] [ebp-230h]
  int v32; // [esp+138h] [ebp-22Ch]
  int v33; // [esp+138h] [ebp-22Ch]
  int v34; // [esp+138h] [ebp-22Ch]
  float v35; // [esp+14Ch] [ebp-218h] BYREF
  float v36; // [esp+150h] [ebp-214h]
  int v37; // [esp+154h] [ebp-210h] BYREF
  float v38; // [esp+158h] [ebp-20Ch]
  int v39; // [esp+15Ch] [ebp-208h] BYREF
  float v40; // [esp+160h] [ebp-204h]
  _BYTE v41[512]; // [esp+164h] [ebp-200h] BYREF

  v36 = flt_489DFC + flt_489E20;
  v0 = -1;
  *(float *)&v37 = flt_489E1C + flt_489DF8 + 300.0;
  v38 = v36 + 40.0;
  v36 = v38 + 10.0;
  v35 = *(float *)&v37 + flt_489DE8 + 44.0 - 110.0 - 32.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  *(float *)&v37 = COERCE_FLOAT(
                     (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 332))(
                       grim_interface_ptr,
                       aUnlockedPerksD));
  v1 = *(_DWORD *)grim_interface_ptr;
  v39 = v37 / 2;
  v19 = v35 + 132.0 - (double)(v37 / 2);
  (*(void (__stdcall **)(_DWORD, float, char *))(v1 + 324))(LODWORD(v19), COERCE_FLOAT(LODWORD(v36)), aUnlockedPerksD);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1056964608);
  *(float *)&v39 = (double)(132 - v37 / 2) + v35;
  v40 = v36 + 13.0;
  v27 = (float)v37;
  (*(void (__stdcall **)(int *, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 212))(&v39, LODWORD(v27), 1065353216);
  v2 = 0;
  v3 = &unk_4C2C60;
  do
  {
    if ( *v3 )
      ++v2;
    v3 += 20;
  }
  while ( (int)v3 < (int)&dword_4C364C );
  v36 = v36 + 20.0 + 8.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1060320051);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v20,
    v28,
    v32);
  v17 = v35 + 8.0;
  (*(void (**)(int, _DWORD, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v17),
    COERCE_FLOAT(LODWORD(v36)),
    aDPerksInDataba,
    v2);
  v36 = v36 + 20.0 + 8.0;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 200) )
  {
    ui_mouse_blocked = 1;
    --dword_4D1204;
  }
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 208) )
  {
    ui_mouse_blocked = 1;
    ++dword_4D1204;
  }
  if ( dword_4D1204 >= 0 )
  {
    if ( dword_4D1204 > 1 )
      dword_4D1204 = 1;
  }
  else
  {
    dword_4D1204 = 0;
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v21,
    v29,
    v33);
  v35 = v35 + 10.0;
  v22 = v35 - 2.0;
  (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v22),
    COERCE_FLOAT(LODWORD(v36)),
    aPerks_0);
  v4 = 0;
  v5 = (int *)v41;
  v6 = perk_name_table;
  v36 = v36 + 16.0 + 4.0;
  do
  {
    if ( *((_BYTE *)v6 + 12) )
    {
      ++v4;
      *v5++ = *v6;
    }
    v6 += 5;
  }
  while ( (int)v6 < (int)&dword_4C3640 );
  if ( (byte_4CCC50 & 1) == 0 )
  {
    dword_4CCBA8 = 0;
    byte_4CCC50 |= 1u;
    dword_4CCBAC = 0;
    crt_atexit(nullsub_56);
  }
  dword_4CCBC8 = (int)v41;
  dword_4CCBCC = v4;
  dword_4CCBA4 = 10;
  ui_scrollbar_update(&v35, (int)&unk_4CCB98);
  if ( dword_4CCB9C != -1 )
  {
    v7 = 0;
    v8 = 0;
    v9 = perk_available_table;
    while ( 1 )
    {
      if ( *v9 )
      {
        v10 = v7++;
        if ( v10 == dword_4CCB9C )
          break;
      }
      v9 += 20;
      ++v8;
      if ( (int)v9 >= (int)&dword_4C364C )
        goto LABEL_26;
    }
    v0 = v8;
  }
LABEL_26:
  v40 = flt_489DFC + flt_489E20;
  *(float *)&v37 = flt_489E1C + flt_489DF8 + 300.0;
  v38 = v40 + 40.0;
  v36 = v38 + 275.0;
  v35 = *(float *)&v37 + flt_489DE8 + 44.0 - 110.0 - 10.0;
  if ( (byte_4CCC50 & 2) == 0 )
  {
    byte_4CCB86 = 1;
    byte_4CCC50 |= 2u;
    byte_4CCB95 = 0;
    byte_4CCB94 = 0;
    dword_4CCB90 = 1065353216;
    dword_4CCB8C = 0;
    dword_4CCB80 = 0;
    byte_4CCB84 = 0;
    byte_4CCB85 = 0;
    dword_4CCB88 = 0;
    crt_atexit(nullsub_55);
  }
  dword_4CCB80 = (int)aBack_0;
  *(float *)&v37 = v35 + 132.0;
  v38 = v36;
  if ( ui_button_update((float *)&v37, (int)&dword_4CCB80) )
  {
    ui_transition_direction = 0;
    game_state_pending = 4;
  }
  v40 = flt_48A114 + flt_48A138;
  *(float *)&v37 = flt_48A134 + flt_48A110 + 300.0;
  v38 = v40 + 40.0;
  v36 = v38 + 10.0;
  v35 = flt_48A100 - 16.0 + *(float *)&v37 - 240.0 - 10.0;
  if ( *(int *)config_screen_width <= 640 )
    v35 = v35 - 10.0;
  if ( v0 != -1 )
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      1054615798,
      v23,
      v30,
      v34);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1053609165);
    v24 = v36 - 18.0;
    (*(void (__cdecl **)(int))(*(_DWORD *)grim_interface_ptr + 328))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, _DWORD, char *, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      1056964608,
      LODWORD(v24),
      aPerknoD,
      v0);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    v11 = 5 * v0;
    *(float *)&v39 = COERCE_FLOAT(
                       (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 332))(
                         grim_interface_ptr,
                         perk_name_table[5 * v0]));
    v12 = *(_DWORD *)grim_interface_ptr;
    v13 = perk_name_table[5 * v0];
    v14 = v39 / 2;
    v37 = v39 / 2;
    v25 = v35 + 128.0 - (double)(v39 / 2);
    (*(void (__stdcall **)(_DWORD, float, int))(v12 + 324))(LODWORD(v25), COERCE_FLOAT(LODWORD(v36)), v13);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1056964608);
    *(float *)&v37 = (double)(128 - v14) + v35;
    v38 = v36 + 13.0;
    v31 = (float)v39;
    (*(void (__thiscall **)(int, int *, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 212))(
      grim_interface_ptr,
      &v37,
      LODWORD(v31),
      1065353216);
    v15 = perk_prereq_table[v11] == -1;
    v36 = v36 + 22.0;
    if ( !v15 )
    {
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1061997773,
        1061997773,
        1061997773);
      v18 = v35 + 16.0;
      (*(void (**)(int, _DWORD, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v18),
        COERCE_FLOAT(LODWORD(v36)),
        aRequiresS,
        perk_name_table[5 * perk_prereq_table[v11]]);
      v36 = v36 + 18.0;
    }
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    v26 = v35 + 16.0;
    (*(void (__stdcall **)(_DWORD, float, int))(*(_DWORD *)grim_interface_ptr + 324))(
      LODWORD(v26),
      COERCE_FLOAT(LODWORD(v36)),
      perk_desc_table[v11]);
    v36 = v36 + 22.0;
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28)
    && !dword_4D1204 )
  {
    ui_transition_direction = 0;
    game_state_pending = 4;
  }
  result = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 1);
  if ( (_BYTE)result )
  {
    ui_transition_direction = 0;
    game_state_pending = 4;
  }
  return result;
}

// nullsub_55 @ 0x00441180
void __cdecl nullsub_55()
{
  ;
}

// nullsub_56 @ 0x00441190
void __cdecl nullsub_56()
{
  ;
}

// nullsub_119 @ 0x004411B0
void nullsub_119()
{
  ;
}

// sub_4411C0 @ 0x004411C0
int __cdecl sub_4411C0(float *a1)
{
  int result; // eax

  (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4CCCA8);
  *a1 = *a1 - 16.0;
  result = (*(int (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
             grim_interface_ptr,
             a1,
             1128267776,
             1065353216);
  *a1 = *a1 + 16.0;
  a1[1] = a1[1] + 4.0;
  return result;
}

// sub_441220 @ 0x00441220
int __cdecl sub_441220(float *a1)
{
  int result; // eax

  (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4CCCA8);
  *a1 = *a1 - 16.0;
  result = (*(int (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
             grim_interface_ptr,
             a1,
             1065353216,
             1111490560);
  *a1 = *a1 + 16.0;
  return result;
}

// sub_441270 @ 0x00441270
char *__cdecl sub_441270(int a1, int a2, int a3)
{
  const char *v4; // [esp-8h] [ebp-8h]
  int v5; // [esp-4h] [ebp-4h]

  switch ( a2 )
  {
    case 1:
      v5 = a3;
      v4 = aJan;
      goto LABEL_15;
    case 2:
      crt_sprintf(byte_4D0E38, "%d. %s %d", a1, aFeb, a3);
      return byte_4D0E38;
    case 3:
      crt_sprintf(byte_4D0E38, "%d. %s %d", a1, aMar, a3);
      return byte_4D0E38;
    case 4:
      v5 = a3;
      v4 = aApr;
      goto LABEL_15;
    case 5:
      crt_sprintf(byte_4D0E38, "%d. %s %d", a1, aMay, a3);
      return byte_4D0E38;
    case 6:
      crt_sprintf(byte_4D0E38, "%d. %s %d", a1, aJun, a3);
      return byte_4D0E38;
    case 7:
      v5 = a3;
      v4 = aJul;
      goto LABEL_15;
    case 8:
      crt_sprintf(byte_4D0E38, "%d. %s %d", a1, aAug, a3);
      return byte_4D0E38;
    case 9:
      crt_sprintf(byte_4D0E38, "%d. %s %d", a1, aSep, a3);
      return byte_4D0E38;
    case 10:
      v5 = a3;
      v4 = aOct;
      goto LABEL_15;
    case 11:
      crt_sprintf(byte_4D0E38, "%d. %s %d", a1, aNov, a3);
      return byte_4D0E38;
    case 12:
      crt_sprintf(byte_4D0E38, "%d. %s %d", a1, aDec, a3);
      return byte_4D0E38;
    default:
      v5 = a3;
      v4 = asc_478884;
LABEL_15:
      crt_sprintf(byte_4D0E38, "%d. %s %d", a1, v4, v5);
      return byte_4D0E38;
  }
}

// ui_text_input_render @ 0x004413A0
// renders a text input field (focus, text, and caret)
void __usercall sub_4413A0(
        int a1@<ebx>,
        int a2@<ebp>,
        int a3@<edi>,
        float a4@<esi>,
        int a5,
        int a6,
        float a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12)
{
  int v12; // esi
  int v13; // eax
  float *v14; // ebx
  int v15; // ebp
  int v16; // edx
  char v17; // al
  int v18; // edx
  int v19; // edi
  int v20; // ecx
  int v21; // eax
  int v22; // ecx
  int v23; // eax
  int v24; // ecx
  int v25; // edi
  float v26; // ecx
  int v27; // ebp
  int v28; // ecx
  int v29; // edx
  char *v30; // eax
  int v31; // edx
  int v32; // ebx
  int v33; // edi
  char v34; // al
  int v35; // edx
  int v36; // eax
  int v37; // edi
  char *v38; // eax
  int v39; // eax
  int v40; // edi
  int v41; // eax
  int v42; // ecx
  int v43; // eax
  int v44; // edi
  int v45; // eax
  int v46; // ebx
  double v47; // st7
  int v48; // edx
  int v49; // edi
  int v50; // ecx
  int v51; // ebx
  __int64 v52; // rax
  double v53; // st7
  int v54; // eax
  double v55; // st7
  int v56; // edx
  int v57; // ecx
  int v58; // ebx
  double v59; // st7
  float v60[3]; // [esp+150h] [ebp-34h] BYREF
  float v61; // [esp+15Ch] [ebp-28h]
  float v62[3]; // [esp+160h] [ebp-24h] BYREF
  float v63; // [esp+16Ch] [ebp-18h]
  float v64; // [esp+170h] [ebp-14h]
  float v65; // [esp+174h] [ebp-10h] BYREF
  int v66; // [esp+178h] [ebp-Ch]
  int v67; // [esp+180h] [ebp-4h]
  float retaddr; // [esp+184h] [ebp+0h] BYREF
  int v69; // [esp+188h] [ebp+4h]
  float v70; // [esp+188h] [ebp+4h]
  float v71; // [esp+188h] [ebp+4h]
  int v72; // [esp+188h] [ebp+4h]

  flt_496604 = 0.69999999;
  dword_4CCCA8 = dword_4965F8;
  dword_4CCCAC = dword_4965FC;
  v64 = a7 * 0.69999999;
  v62[1] = a4;
  v12 = a6;
  dword_4CCCB0 = dword_496600;
  *(float *)&dword_4CCCB4 = v64;
  *(float *)&v13 = COERCE_FLOAT(
                     (*(int (__thiscall **)(int, int, int, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 332))(
                       grim_interface_ptr,
                       a6,
                       a3,
                       LODWORD(v62[1]),
                       a2,
                       a1));
  v14 = (float *)a9;
  v15 = a11;
  a10 = v13;
  v69 = *(int *)(a9 + 4);
  retaddr = *(float *)a9 + 4.0;
  if ( game_state_id != 7 && game_state_id != 8 && game_state_id != 12 )
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      a11);
    (*(void (__thiscall **)(int, float, int, int))(*(_DWORD *)grim_interface_ptr + 324))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(retaddr)),
      v69,
      v12);
    (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4CCCA8);
    *(float *)&a6 = retaddr;
    v63 = 1.0;
    LODWORD(v62[2]) = grim_interface_ptr;
    a7 = *(float *)&v69 + 13.0;
    v16 = *(_DWORD *)grim_interface_ptr;
    v62[2] = (float)a10;
    (*(void (__thiscall **)(int, int *, _DWORD, int))(v16 + 212))(grim_interface_ptr, &a6, LODWORD(v62[2]), 1065353216);
    v17 = *(_BYTE *)(v12 + 68);
    if ( (v17 & 2) != 0 )
    {
      v18 = *(_DWORD *)grim_interface_ptr;
      *(float *)&a10 = *(float *)&a11 * 0.80000001;
      v19 = a10;
      (*(void (__thiscall **)(int, int, int, int, int))(v18 + 276))(
        grim_interface_ptr,
        1061997773,
        1061997773,
        1061997773,
        a10);
      v20 = *(_DWORD *)grim_interface_ptr;
      v62[2] = *(float *)&v69 + 14.0;
      (*(void (__cdecl **)(int, float, _DWORD, char *))(v20 + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(retaddr)),
        LODWORD(v62[2]),
        aInternetScoreO);
      v21 = *(_DWORD *)grim_interface_ptr;
      v63 = *(float *)&a11 * 0.5;
      (*(void (__thiscall **)(int, int, int, int, float))(v21 + 276))(
        grim_interface_ptr,
        1056964608,
        1056964608,
        1056964608,
        COERCE_FLOAT(LODWORD(v63)));
      v22 = *(_DWORD *)grim_interface_ptr;
      v63 = *(float *)(v12 + 56);
      v62[1] = *(float *)&v69 - 12.0;
      v62[0] = retaddr + 94.0;
      (*(void (**)(int, _DWORD, _DWORD, char *, ...))(v22 + 328))(
        grim_interface_ptr,
        LODWORD(v62[0]),
        LODWORD(v62[1]),
        aUniD,
        v63);
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1061997773,
        1061997773,
        1061997773,
        v19);
    }
    else
    {
      *(float *)&a10 = *(float *)&a11 * 0.80000001;
      v19 = a10;
      if ( (v17 & 1) != 0 )
      {
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1060320051,
          1065353216,
          1060320051,
          a10);
        v23 = grim_interface_ptr;
        v63 = COERCE_FLOAT(aScoreFromTheIn);
      }
      else
      {
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1061997773,
          1061997773,
          1061997773,
          a10);
        v23 = grim_interface_ptr;
        v63 = COERCE_FLOAT(aLocalScore);
      }
      v24 = *(_DWORD *)grim_interface_ptr;
      v62[2] = *(float *)&v69 + 14.0;
      (*(void (__cdecl **)(int, float, _DWORD, float))(v24 + 328))(
        v23,
        COERCE_FLOAT(LODWORD(retaddr)),
        LODWORD(v62[2]),
        COERCE_FLOAT(LODWORD(v63)));
    }
    qmemcpy(v62, "fff?fff?fff?", sizeof(v62));
    v70 = *(float *)&v69 + 15.0;
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      LODWORD(v62[0]),
      LODWORD(v62[1]),
      LODWORD(v62[2]),
      v19);
    v25 = *(_DWORD *)grim_interface_ptr;
    v63 = COERCE_FLOAT(
            sub_441270(
              *(unsigned __int8 *)(v12 + 64),
              *(unsigned __int8 *)(v12 + 66),
              *(unsigned __int8 *)(v12 + 67) + 2000));
    v62[2] = v26;
    v27 = *(_DWORD *)grim_interface_ptr;
    v62[2] = v70 + 13.0;
    v28 = *(unsigned __int8 *)(v12 + 66);
    LODWORD(v62[1]) = *(unsigned __int8 *)(v12 + 67) + 2000;
    v29 = *(unsigned __int8 *)(v12 + 64);
    *(float *)&a9 = retaddr + 192.0 - 32.0 - 8.0;
    v30 = sub_441270(v29, v28, SLODWORD(v62[1]));
    a12 = (*(int (__thiscall **)(int, char *, _DWORD, float))(v27 + 332))(
            grim_interface_ptr,
            v30,
            LODWORD(v62[2]),
            COERCE_FLOAT(LODWORD(v63)))
        / 2;
    v63 = *(float *)&a11 - (double)a12;
    (*(void (__thiscall **)(int, float))(v25 + 324))(grim_interface_ptr, COERCE_FLOAT(LODWORD(v63)));
    v63 = COERCE_FLOAT(&retaddr);
    v71 = v70 + 13.0;
    retaddr = *v14 + 16.0;
    sub_4411C0(&retaddr);
    v15 = a11;
    *(float *)&v69 = v71 + 14.0;
  }
  v31 = *(_DWORD *)grim_interface_ptr;
  *(float *)&a10 = *(float *)&a11 * 0.80000001;
  v32 = a10;
  qmemcpy(v62, "fff?fff?fff?", sizeof(v62));
  (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(v31 + 276))(
    grim_interface_ptr,
    LODWORD(v62[0]),
    LODWORD(v62[1]),
    LODWORD(v62[2]),
    a10);
  v33 = *(_DWORD *)grim_interface_ptr;
  *(float *)&a9 = retaddr + 32.0;
  a12 = (*(int (__thiscall **)(int, char *, int, char *))(v33 + 332))(grim_interface_ptr, aScore, v69, aScore) / 2;
  v63 = *(float *)&a11 - (double)a12;
  (*(void (__thiscall **)(int, float))(v33 + 324))(grim_interface_ptr, COERCE_FLOAT(LODWORD(v63)));
  v34 = *(_BYTE *)(v12 + 40);
  if ( v34 == 2 || v34 == 3 )
    crt_sprintf(byte_4D0DA0, "%.2f secs", (double)*(int *)(v12 + 32) * 0.001);
  else
    crt_sprintf(byte_4D0DA0, "%d", *(_DWORD *)(v12 + 36));
  v63 = *(float *)&v15;
  BYTE1(v62[2]) = 0;
  HIWORD(v62[2]) = 16256;
  v35 = *(_DWORD *)grim_interface_ptr;
  strcpy((char *)v62, "fff?fff?");
  (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(v35 + 276))(
    grim_interface_ptr,
    LODWORD(v62[0]),
    LODWORD(v62[1]),
    LODWORD(v62[2]),
    v15);
  v36 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 332))(grim_interface_ptr, byte_4D0DA0);
  v63 = COERCE_FLOAT(byte_4D0DA0);
  LODWORD(v62[2]) = grim_interface_ptr;
  v37 = *(_DWORD *)grim_interface_ptr;
  v62[2] = *(float *)&v69 + 15.0;
  a10 = v36 / 2;
  v62[1] = retaddr + 32.0 - (double)(v36 / 2);
  (*(void (__stdcall **)(_DWORD, _DWORD, char *))(v37 + 324))(LODWORD(v62[1]), LODWORD(v62[2]), byte_4D0DA0);
  if ( game_state_id != 12 )
  {
    v38 = sub_406180(a12);
    crt_sprintf(byte_4D0DA0, "Rank: %s", v38);
    v39 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 332))(grim_interface_ptr, byte_4D0DA0);
    v63 = *(float *)&v32;
    v40 = v39;
    v41 = *(_DWORD *)grim_interface_ptr;
    qmemcpy(v62, "fff?fff?fff?", sizeof(v62));
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(v41 + 276))(
      grim_interface_ptr,
      LODWORD(v62[0]),
      LODWORD(v62[1]),
      LODWORD(v62[2]),
      v32);
    v63 = COERCE_FLOAT(byte_4D0DA0);
    a9 = *(int *)grim_interface_ptr;
    v62[2] = *(float *)&v69 + 30.0;
    a10 = v40 / 2;
    v62[1] = retaddr + 32.0 - (double)(v40 / 2);
    (*(void (__stdcall **)(_DWORD, _DWORD, char *))(a9 + 324))(LODWORD(v62[1]), LODWORD(v62[2]), byte_4D0DA0);
  }
  retaddr = retaddr + 96.0;
  sub_441220(&retaddr);
  v42 = *(_DWORD *)grim_interface_ptr;
  if ( *(_BYTE *)(v12 + 40) == 3 )
  {
    (*(void (__cdecl **)(int, float, int, char *))(v42 + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(retaddr)),
      v69,
      aExperience);
    crt_sprintf(byte_4D0DA0, "%d", *(_DWORD *)(v12 + 36));
    v43 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 332))(grim_interface_ptr, byte_4D0DA0);
    v63 = *(float *)&v32;
    v44 = v43;
    v45 = *(_DWORD *)grim_interface_ptr;
    qmemcpy(v62, "fff?fff?fff?", sizeof(v62));
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(v45 + 276))(
      grim_interface_ptr,
      LODWORD(v62[0]),
      LODWORD(v62[1]),
      LODWORD(v62[2]),
      v32);
    v63 = COERCE_FLOAT(byte_4D0DA0);
    v62[2] = *(float *)&v69 + 15.0;
    v46 = *(_DWORD *)grim_interface_ptr;
    a10 = v44 / 2;
    v62[1] = retaddr + 32.0 - (double)(v44 / 2);
    (*(void (__stdcall **)(_DWORD, _DWORD, char *))(v46 + 324))(LODWORD(v62[1]), LODWORD(v62[2]), byte_4D0DA0);
    flt_4D120C = flt_4D120C - (frame_dt + frame_dt);
  }
  else
  {
    v62[1] = retaddr + 6.0;
    (*(void (__cdecl **)(int, _DWORD, int, char *))(v42 + 328))(grim_interface_ptr, LODWORD(v62[1]), v69, aGameTime);
    ui_draw_clock_gauge((__int64)(retaddr + 8.0), (__int64)(*(float *)&v69 + 13.0), *(_DWORD *)(v12 + 32), v15);
    if ( retaddr + 8.0 >= ui_mouse_x
      || retaddr + 72.0 <= ui_mouse_x
      || *(float *)&v69 + 16.0 >= ui_mouse_y
      || *(float *)&v69 + 45.0 <= ui_mouse_y )
    {
      v47 = flt_4D120C - (frame_dt + frame_dt);
    }
    else
    {
      v47 = frame_dt + frame_dt + flt_4D120C;
    }
    v63 = *(float *)&v32;
    flt_4D120C = v47;
    v48 = *(_DWORD *)grim_interface_ptr;
    qmemcpy(v62, "fff?fff?fff?", sizeof(v62));
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(v48 + 276))(
      grim_interface_ptr,
      LODWORD(v62[0]),
      LODWORD(v62[1]),
      LODWORD(v62[2]),
      v32);
    v49 = *(_DWORD *)(v12 + 32) / 1000 / 60;
    v50 = *(_DWORD *)grim_interface_ptr;
    LODWORD(v63) = *(_DWORD *)(v12 + 32) / 1000 % 60;
    LODWORD(v62[2]) = v49;
    if ( SLODWORD(v63) >= 10 )
      LODWORD(v62[1]) = aDD_0;
    else
      LODWORD(v62[1]) = aD0D;
    v62[0] = *(float *)&v69 + 19.0;
    v61 = retaddr + 40.0;
    (*(void (__cdecl **)(int, float, _DWORD, _DWORD, _DWORD, float))(v50 + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v61)),
      LODWORD(v62[0]),
      LODWORD(v62[1]),
      LODWORD(v62[2]),
      COERCE_FLOAT(LODWORD(v63)));
  }
  *(float *)&v72 = *(float *)&v69 + 52.0;
  retaddr = retaddr - 96.0;
  if ( dword_487234 == 2 && game_state_id == 8
    || (game_state_id == 7 || game_state_id == 8 || game_state_id == 12) && !dword_487234 )
  {
    flt_4D1210 = 0.0;
  }
  else
  {
    sub_4411C0(&retaddr);
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(
      grim_interface_ptr,
      ui_weapon_icons_texture,
      0);
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      1,
      LODWORD(v62[1]),
      LODWORD(v62[2]),
      COERCE_FLOAT(LODWORD(v63)));
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 264))(
      grim_interface_ptr,
      8,
      2,
      1,
      2 * effect_subrect_frame_table[31 * *(unsigned __int8 *)(v12 + 43)]);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      v15);
    v63 = 32.0;
    v51 = *(_DWORD *)grim_interface_ptr;
    v62[1] = (float)(__int64)*(float *)&v72;
    v52 = (__int64)retaddr;
    a10 = v52;
    v62[0] = (float)(int)v52;
    (*(void (__fastcall **)(int, _DWORD, _DWORD, _DWORD, int, int))(v51 + 284))(
      grim_interface_ptr,
      HIDWORD(v52),
      LODWORD(v62[0]),
      LODWORD(v62[1]),
      1115684864,
      1107296256);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
    (*(void (__thiscall **)(int, int, int, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      21,
      2,
      LODWORD(v62[1]),
      LODWORD(v62[2]),
      COERCE_FLOAT(LODWORD(v63)));
    if ( ui_mouse_x <= (double)retaddr
      || retaddr + 64.0 <= ui_mouse_x
      || ui_mouse_y <= (double)*(float *)&v72
      || *(float *)&v72 + 32.0 <= ui_mouse_y )
    {
      v53 = flt_4D1208 - (frame_dt + frame_dt);
    }
    else
    {
      v53 = frame_dt + frame_dt + flt_4D1208;
    }
    flt_4D1208 = v53;
    v54 = *(_DWORD *)grim_interface_ptr;
    qmemcpy(v62, "fff?fff?fff?", sizeof(v62));
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(v54 + 276))(
      grim_interface_ptr,
      LODWORD(v62[0]),
      LODWORD(v62[1]),
      LODWORD(v62[2]),
      v67);
    a10 = 32
        - (*(int (__stdcall **)(int))(*(_DWORD *)grim_interface_ptr + 332))(124 * *(unsigned __int8 *)(v12 + 43) + 5077548)
        / 2;
    v55 = (double)a10;
    if ( v55 < 0.0 )
      v55 = 0.0;
    v56 = *(_DWORD *)grim_interface_ptr;
    LODWORD(v63) = 124 * *(unsigned __int8 *)(v12 + 43) + 5077548;
    v62[2] = *(float *)&v72 + 32.0;
    v62[1] = v55 + retaddr;
    (*(void (__stdcall **)(_DWORD, _DWORD, float))(v56 + 324))(
      LODWORD(v62[1]),
      LODWORD(v62[2]),
      COERCE_FLOAT(LODWORD(v63)));
    v57 = *(_DWORD *)grim_interface_ptr;
    v63 = *(float *)(v12 + 52);
    v62[1] = *(float *)&v72 + 1.0;
    v62[0] = retaddr + 110.0;
    (*(void (**)(int, _DWORD, _DWORD, char *, ...))(v57 + 328))(
      grim_interface_ptr,
      LODWORD(v62[0]),
      LODWORD(v62[1]),
      aFragsD,
      v63);
    v58 = *(_DWORD *)grim_interface_ptr;
    LODWORD(v63) = (__int64)((double)*(int *)(v12 + 48) * 100.0 / (double)*(int *)(v12 + 44));
    v62[1] = *(float *)&v72 + 16.0 - 1.0;
    v62[0] = retaddr + 110.0;
    (*(void (**)(int, _DWORD, _DWORD, char *, ...))(v58 + 328))(
      grim_interface_ptr,
      LODWORD(v62[0]),
      LODWORD(v62[1]),
      aHitD,
      v63);
    if ( retaddr + 110.0 >= ui_mouse_x
      || retaddr + 174.0 <= ui_mouse_x
      || *(float *)&v72 + 16.0 - 1.0 >= ui_mouse_y
      || *(float *)&v72 + 32.0 <= ui_mouse_y )
    {
      v59 = flt_4D1210 - (frame_dt + frame_dt);
    }
    else
    {
      v59 = frame_dt + frame_dt + flt_4D1210;
    }
    flt_4D1210 = v59;
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    v15);
  sub_4411C0(&v65);
  if ( flt_4D1208 <= 1.0 )
  {
    if ( flt_4D1208 < 0.0 )
      flt_4D1208 = 0.0;
  }
  else
  {
    flt_4D1208 = 1.0;
  }
  if ( flt_4D120C <= 1.0 )
  {
    if ( flt_4D120C < 0.0 )
      flt_4D120C = 0.0;
  }
  else
  {
    flt_4D120C = 1.0;
  }
  if ( flt_4D1210 <= 1.0 )
  {
    if ( flt_4D1210 < 0.0 )
      flt_4D1210 = 0.0;
  }
  else
  {
    flt_4D1210 = 1.0;
  }
  if ( game_state_id == 7 || game_state_id == 8 || game_state_id == 12 )
  {
    qmemcpy(v60, "fff?fff?fff?", sizeof(v60));
    (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      LODWORD(v60[0]),
      LODWORD(v60[1]),
      LODWORD(v60[2]),
      COERCE_FLOAT(LODWORD(v64)));
    if ( flt_4D1208 > 0.5 )
    {
      v61 = (flt_4D1208 - 0.5) * a7 + (flt_4D1208 - 0.5) * a7;
      qmemcpy(v60, "fff?fff?fff?", sizeof(v60));
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        LODWORD(v60[0]),
        LODWORD(v60[1]),
        LODWORD(v60[2]),
        COERCE_FLOAT(LODWORD(v61)));
      v60[1] = v65 - 20.0;
      (*(void (__stdcall **)(_DWORD, int, char *))(*(_DWORD *)grim_interface_ptr + 324))(
        LODWORD(v60[1]),
        v66,
        aMostUsedWeapon);
    }
    if ( flt_4D120C > 0.5 )
    {
      v61 = (flt_4D120C - 0.5) * a7 + (flt_4D120C - 0.5) * a7;
      qmemcpy(v60, "fff?fff?fff?", sizeof(v60));
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        LODWORD(v60[0]),
        LODWORD(v60[1]),
        LODWORD(v60[2]),
        COERCE_FLOAT(LODWORD(v61)));
      v60[1] = v65 + 12.0;
      (*(void (__stdcall **)(_DWORD, int, char *))(*(_DWORD *)grim_interface_ptr + 324))(
        LODWORD(v60[1]),
        v66,
        aTheTimeTheGame);
    }
    if ( flt_4D1210 > 0.5 )
    {
      v61 = (flt_4D1210 - 0.5) * a7 + (flt_4D1210 - 0.5) * a7;
      qmemcpy(v60, "fff?fff?fff?", sizeof(v60));
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, float))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        LODWORD(v60[0]),
        LODWORD(v60[1]),
        LODWORD(v60[2]),
        COERCE_FLOAT(LODWORD(v61)));
      v60[1] = v65 - 22.0;
      (*(void (__stdcall **)(_DWORD, int, char *))(*(_DWORD *)grim_interface_ptr + 324))(
        LODWORD(v60[1]),
        v66,
        aTheOfShotBulle);
    }
  }
}

// ui_update_notice_update @ 0x00442150
// renders the update-available notice and its button
char __cdecl sub_442150(float *a1, float a2)
{
  char result; // al
  float v3; // [esp+4Ch] [ebp-2Ch]
  float v4; // [esp+4Ch] [ebp-2Ch]
  float v5; // [esp+4Ch] [ebp-2Ch]
  float v6; // [esp+4Ch] [ebp-2Ch]
  float v7; // [esp+4Ch] [ebp-2Ch]
  float v8; // [esp+50h] [ebp-28h]
  float v9; // [esp+50h] [ebp-28h]
  float v10; // [esp+50h] [ebp-28h]
  float v11; // [esp+50h] [ebp-28h]
  float v12; // [esp+50h] [ebp-28h]
  float v13[2]; // [esp+60h] [ebp-18h] BYREF
  _DWORD v14[4]; // [esp+68h] [ebp-10h] BYREF

  *(float *)&v14[3] = a2 * 0.80000001;
  memset(v14, 0, 12);
  (*(void (__thiscall **)(int, float *, int, int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 208))(
    grim_interface_ptr,
    a1,
    1132789760,
    1117257728,
    v14);
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    LODWORD(a2));
  (*(void (__thiscall **)(int, float *, int, int))(*(_DWORD *)grim_interface_ptr + 212))(
    grim_interface_ptr,
    a1,
    1132789760,
    1117257728);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1045220557,
    1045220557,
    1065353216);
  v8 = a1[1] + 14.0;
  v3 = *a1 + 12.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v3),
    LODWORD(v8),
    aNote);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1061997773);
  v9 = a1[1] + 4.0;
  v4 = *a1 + 60.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v4),
    LODWORD(v9),
    aThereIsANewerV_0);
  v10 = a1[1] + 18.0;
  v5 = *a1 + 60.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v5),
    LODWORD(v10),
    aGameAvailableF);
  v11 = a1[1] + 32.0;
  v6 = *a1 + 60.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, CHAR *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v6),
    LODWORD(v11),
    szPassword);
  v12 = a1[1] + 46.0;
  v7 = *a1 + 60.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, CHAR *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v7),
    LODWORD(v12),
    szPassword);
  if ( (byte_4CC930 & 1) == 0 )
  {
    byte_4D0ED6 = 1;
    byte_4CC930 |= 1u;
    byte_4D0EE5 = 0;
    byte_4D0EE4 = 0;
    dword_4D0EE0 = 1065353216;
    dword_4D0EDC = 0;
    dword_4D0ED0 = 0;
    byte_4D0ED4 = 0;
    byte_4D0ED5 = 0;
    dword_4D0ED8 = 0;
    crt_atexit(nullsub_57);
  }
  dword_4D0ED0 = (int)aGetTheUpdate;
  v13[0] = *a1 + 65.0;
  v13[1] = a1[1] + 42.0 - 2.0;
  ui_button_update(v13, (int)&dword_4D0ED0);
  result = byte_4D0ED5;
  if ( byte_4D0ED5 )
    byte_480838 = 1;
  return result;
}

// nullsub_57 @ 0x004423C0
void __cdecl nullsub_57()
{
  ;
}

// sub_4423D0 @ 0x004423D0
char sub_4423D0()
{
  char *v0; // eax
  int v1; // ecx
  int v2; // eax
  int v3; // eax
  double v4; // st7
  std::codecvt_base *v5; // ecx
  char *v6; // ebp
  char *v7; // esi
  float v8; // edi
  int v9; // ebx
  char v10; // al
  bool v11; // cc
  int v12; // ebx
  std::codecvt_base *v13; // ecx
  bool v14; // zf
  int v15; // eax
  char v16; // al
  int v17; // ecx
  int v18; // eax
  int *v19; // eax
  char *v20; // eax
  char *v21; // eax
  _BYTE *v22; // eax
  char *v23; // eax
  double v24; // st7
  int v25; // eax
  std::codecvt_base *v26; // ecx
  bool v27; // al
  float v28; // edi
  int v29; // eax
  float v30; // esi
  int v31; // eax
  int v32; // esi
  int v33; // esi
  int v34; // esi
  float v35; // edi
  float v36; // esi
  int v37; // edx
  std::codecvt_base *v38; // ecx
  char v39; // al
  int v40; // ecx
  std::codecvt_base *v41; // ecx
  float v42; // esi
  int v43; // edi
  int v44; // eax
  int v45; // ecx
  int v46; // eax
  int v47; // ecx
  int v48; // eax
  int v49; // ecx
  int v50; // eax
  int v51; // eax
  int v52; // ecx
  char result; // al
  float v54; // [esp+104h] [ebp-ACh]
  float v55; // [esp+108h] [ebp-A8h]
  float v56; // [esp+110h] [ebp-A0h]
  int v57; // [esp+110h] [ebp-A0h]
  int v58; // [esp+110h] [ebp-A0h]
  float v59; // [esp+110h] [ebp-A0h]
  float v60; // [esp+110h] [ebp-A0h]
  float v61; // [esp+110h] [ebp-A0h]
  int v62; // [esp+110h] [ebp-A0h]
  int v63; // [esp+110h] [ebp-A0h]
  float v64; // [esp+110h] [ebp-A0h]
  float v65; // [esp+114h] [ebp-9Ch]
  int v66; // [esp+114h] [ebp-9Ch]
  int v67; // [esp+114h] [ebp-9Ch]
  int v68; // [esp+114h] [ebp-9Ch]
  int v69; // [esp+114h] [ebp-9Ch]
  float v70; // [esp+114h] [ebp-9Ch]
  float v71; // [esp+114h] [ebp-9Ch]
  int v72; // [esp+118h] [ebp-98h]
  int v73; // [esp+118h] [ebp-98h]
  int v74; // [esp+118h] [ebp-98h]
  int v75; // [esp+118h] [ebp-98h]
  float v76; // [esp+118h] [ebp-98h]
  float v77; // [esp+118h] [ebp-98h]
  int v78; // [esp+11Ch] [ebp-94h]
  int v79; // [esp+120h] [ebp-90h]
  int v80; // [esp+124h] [ebp-8Ch]
  int v81; // [esp+128h] [ebp-88h]
  float v82; // [esp+12Ch] [ebp-84h] BYREF
  float v83; // [esp+130h] [ebp-80h]
  char v84; // [esp+137h] [ebp-79h]
  float v85; // [esp+138h] [ebp-78h] BYREF
  float v86; // [esp+13Ch] [ebp-74h]
  float v87; // [esp+140h] [ebp-70h]
  float v88; // [esp+144h] [ebp-6Ch]
  float v89; // [esp+148h] [ebp-68h] BYREF
  float v90; // [esp+14Ch] [ebp-64h]
  float v91; // [esp+150h] [ebp-60h] BYREF
  float v92; // [esp+154h] [ebp-5Ch]
  int v93; // [esp+158h] [ebp-58h] BYREF
  float v94; // [esp+15Ch] [ebp-54h]
  int v95; // [esp+160h] [ebp-50h]
  int v96; // [esp+164h] [ebp-4Ch]
  float v97[2]; // [esp+168h] [ebp-48h] BYREF
  float v98; // [esp+170h] [ebp-40h]
  float v99; // [esp+174h] [ebp-3Ch]
  int v100; // [esp+178h] [ebp-38h] BYREF
  int v101; // [esp+17Ch] [ebp-34h]
  int v102; // [esp+180h] [ebp-30h]
  int v103; // [esp+184h] [ebp-2Ch]
  _DWORD v104[5]; // [esp+188h] [ebp-28h] BYREF
  _DWORD v105[5]; // [esp+19Ch] [ebp-14h] BYREF

  if ( config_hardcore )
  {
    *(float *)&v93 = 0.98039216;
    v94 = 0.27450982;
    v95 = 1047589105;
    v96 = 1060320051;
    v100 = 1065024251;
    v101 = 1049398413;
    v102 = 1047589105;
  }
  else
  {
    *(float *)&v93 = 0.27450982;
    v94 = 0.70588237;
    v95 = 1064366321;
    v96 = 1060320051;
    v100 = 1049398413;
    v101 = 1060418741;
    v102 = 1064366321;
  }
  v103 = 1060320051;
  v94 = flt_489DFC + flt_489E20;
  v84 = 0;
  v98 = flt_489E1C + flt_489DF8 + 300.0;
  v99 = v94 + 40.0;
  v83 = v99 + 1.0;
  v82 = v98 + flt_489DE8 + 44.0 - 110.0 - 32.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v0 = game_mode_label();
  crt_sprintf(byte_4D0FC4, "High scores - %s", v0);
  v88 = COERCE_FLOAT((*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 332))(grim_interface_ptr, byte_4D0FC4));
  LODWORD(v97[0]) = SLODWORD(v88) / 2;
  v56 = v82 - (double)(SLODWORD(v88) / 2) + 128.0;
  (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v56),
    COERCE_FLOAT(LODWORD(v83)),
    byte_4D0FC4);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1060320051);
  LODWORD(v97[0]) = 128 - SLODWORD(v88) / 2;
  v89 = (double)SLODWORD(v97[0]) + v82;
  v90 = v83 + 14.0;
  v65 = (float)SLODWORD(v88);
  (*(void (__stdcall **)(float *, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 212))(&v89, LODWORD(v65), 1065353216);
  v83 = v83 + 15.0;
  if ( config_game_mode != 3 )
  {
    v4 = v83 + 20.0;
    goto LABEL_32;
  }
  v82 = v82 - 8.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1061997773);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v57,
    v66,
    v72);
  v83 = v83 + 6.0;
  if ( config_hardcore )
  {
    v1 = quest_unlock_index_full;
    if ( quest_stage_minor + 10 * *(_DWORD *)quest_stage_major - 11 <= quest_unlock_index_full )
      goto LABEL_10;
  }
  else
  {
    v1 = quest_unlock_index;
    if ( quest_stage_minor + 10 * *(_DWORD *)quest_stage_major - 11 <= quest_unlock_index )
      goto LABEL_10;
  }
  *(_DWORD *)quest_stage_major = v1 / 10 + 1;
  quest_stage_minor = v1 % 10 + 1;
  j_highscore_load_table();
LABEL_10:
  (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &v100);
  v55 = v83 + 1.0;
  v54 = v82 + 42.0;
  (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v54),
    LODWORD(v55),
    aDDS,
    *(_DWORD *)quest_stage_major,
    quest_stage_minor,
    quest_meta_name[110 * *(_DWORD *)quest_stage_major - 121 + 11 * quest_stage_minor]);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1061997773);
  if ( ui_mouse_x <= (double)v82
    || v83 - 2.0 >= ui_mouse_y
    || v82 + 32.0 <= ui_mouse_x
    || v83 + 18.0 <= ui_mouse_y
    || ui_mouse_blocked )
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1057971241);
  }
  else
  {
    dword_4D1214 = -3;
    v2 = *(_DWORD *)grim_interface_ptr;
    v84 = 1;
    (*(void (__thiscall **)(int, int, int, int, int))(v2 + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
  }
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_48F7BC, 0);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  if ( *(_DWORD *)quest_stage_major != 1 || quest_stage_minor != 1 )
    (*(void (__thiscall **)(int, float, float, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v82)),
      COERCE_FLOAT(LODWORD(v83)),
      1107296256,
      1098907648);
  v82 = v82 + 255.0;
  if ( ui_mouse_x <= (double)v82
    || v83 - 2.0 >= ui_mouse_y
    || v82 + 32.0 <= ui_mouse_x
    || v83 + 18.0 <= ui_mouse_y
    || ui_mouse_blocked )
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1057132380);
  }
  else
  {
    dword_4D1214 = -2;
    v3 = *(_DWORD *)grim_interface_ptr;
    v84 = 1;
    (*(void (__thiscall **)(int, int, int, int, int))(v3 + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
  }
  (*(void (__thiscall **)(int, int, _DWORD, _DWORD, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    1065353216,
    0,
    0,
    1065353216);
  if ( *(_DWORD *)quest_stage_major != 5 || quest_stage_minor != 10 )
    (*(void (__thiscall **)(int, float, float, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v82)),
      COERCE_FLOAT(LODWORD(v83)),
      1107296256,
      1098907648);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  v82 = v82 - 255.0;
  v4 = v83 + 14.0;
  v82 = v82 + 8.0;
LABEL_32:
  v83 = v4 + 8.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v58,
    v67,
    v73);
  v59 = v82 + 9.0;
  (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v59),
    COERCE_FLOAT(LODWORD(v83)),
    aRank);
  v60 = v82 + 44.0;
  (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v60),
    COERCE_FLOAT(LODWORD(v83)),
    aScore);
  v61 = v82 + 100.0;
  (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v61),
    COERCE_FLOAT(LODWORD(v83)),
    aPlayer);
  if ( config_game_mode == 3 )
  {
    if ( (byte_4CCCB8 & 1) == 0 )
    {
      byte_4D0D98 = 0;
      byte_4CCCB8 |= 1u;
      byte_4D0D99 = 0;
      byte_4D0D9A = 0;
      dword_4D0D9C = 0;
      crt_atexit(nullsub_66);
    }
    dword_4D0D9C = (int)aHardcore;
    if ( quest_unlock_index < 40 )
    {
      config_hardcore = 0;
    }
    else
    {
      v89 = v82 + 162.0;
      byte_4D0D98 = config_hardcore;
      v90 = v83 - 2.0;
      ui_checkbox_update(&v89, (int)&byte_4D0D98);
      LOBYTE(v5) = config_hardcore;
      if ( config_hardcore != byte_4D0D98 )
      {
        config_hardcore = byte_4D0D98;
        j_highscore_load_table();
      }
    }
    if ( !game_is_full_version(v5) )
      config_hardcore = 0;
  }
  LODWORD(v87) = 1;
  v91 = NAN;
  v97[0] = 0.0;
  v6 = (char *)&unk_4CC934;
  v7 = byte_482B54;
  v88 = COERCE_FLOAT(&unk_4CCD68);
  v83 = v83 + 16.0 + 1.0;
  do
  {
    v8 = v88;
    *(float *)v6 = v88;
    memset((void *)LODWORD(v8), 0, 0xA4u);
    v9 = 0;
    if ( !*((_DWORD *)v7 - 9) )
      break;
    v10 = *v7;
    if ( (*v7 & 5) != 0 && ((v10 & 2) == 0 || (v10 & 4) != 0) )
    {
      v9 = 2;
      **(_BYTE **)v6 = 92;
      *(_BYTE *)(*(_DWORD *)v6 + 1) = 103;
    }
    if ( config_game_mode == 2 || config_game_mode == 3 )
      crt_sprintf((char *const)(v9 + *(_DWORD *)v6), "%d\t%d\t%s", v87, *((_DWORD *)v7 - 9) / 1000, v7 - 68);
    else
      crt_sprintf((char *const)(v9 + *(_DWORD *)v6), "%d\t%d\t%s", v87, *((_DWORD *)v7 - 8), v7 - 68);
    v7 += 72;
    v6 += 4;
    v11 = LODWORD(v88) + 164 < (int)&byte_4D0D78;
    ++LODWORD(v97[0]);
    LODWORD(v88) += 164;
    ++LODWORD(v87);
  }
  while ( v11 );
  v82 = v82 + 16.0;
  if ( (byte_4CCCB8 & 2) == 0 )
  {
    byte_4CCCB8 |= 2u;
    dword_4CCAD8 = 0;
    dword_4CCADC = 0;
    crt_atexit(nullsub_65);
  }
  dword_4CCAFC = LODWORD(v97[0]);
  v89 = v82 - 8.0;
  v90 = v83;
  dword_4CCAF8 = (int)&unk_4CC934;
  dword_4CCAD4 = 10;
  dword_4CCAD8 = 10;
  dword_4CCADC = 30;
  dword_4CCAE0 = 44;
  ui_scrollbar_update(&v89, (int)&unk_4CCAC8);
  v12 = dword_4CCACC;
  v83 = v83 + 168.0;
  if ( dword_4CCACC == -1 )
    v12 = LODWORD(v91);
  v82 = v82 + 16.0;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v62,
    v68,
    v74);
  v83 = v83 - 1.0;
  if ( (byte_4CCCB8 & 4) == 0 )
  {
    byte_4CCCB8 |= 4u;
    byte_4D0F7E = 1;
    byte_4D0F8D = 0;
    byte_4D0F8C = 0;
    dword_4D0F88 = 1065353216;
    dword_4D0F84 = 0;
    dword_4D0F78 = 0;
    byte_4D0F7C = 0;
    byte_4D0F7D = 0;
    dword_4D0F80 = 0;
    crt_atexit(nullsub_64);
  }
  v14 = !game_is_full_version(v13);
  v15 = *(_DWORD *)grim_interface_ptr;
  if ( v14 )
  {
    if ( (*(unsigned __int8 (__stdcall **)(int))(v15 + 68))(42)
      || (v16 = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 54),
          dword_4D0F78 = (int)aReceiveScores,
          v16) )
    {
      dword_4D0F78 = (int)aReceiveAll;
    }
  }
  else if ( (*(unsigned __int8 (__stdcall **)(int))(v15 + 68))(42)
         || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 54) )
  {
    dword_4D0F78 = (int)aUpdateAll;
  }
  else
  {
    dword_4D0F78 = (int)aUpdateScores;
  }
  if ( ui_button_update(&v82, (int)&dword_4D0F78) && (!dword_4D11F0 || dword_4D11F0 == 6) )
  {
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 42)
      || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 54) )
    {
      dword_4CCB58 = -4;
      byte_4D11F9 = 1;
    }
    else
    {
      byte_4D11F9 = 0;
    }
    dword_4D11F0 = 1;
    crt_beginthread((_beginthread_proc_type)sub_42D0E0, 0, 0);
  }
  v83 = v83 + 33.0;
  if ( (byte_4CCCB8 & 8) == 0 )
  {
    byte_4D0F0E = 1;
    byte_4CCCB8 |= 8u;
    byte_4D0F1D = 0;
    byte_4D0F1C = 0;
    dword_4D0F18 = 1065353216;
    dword_4D0F14 = 0;
    dword_4D0F08 = 0;
    byte_4D0F0C = 0;
    byte_4D0F0D = 0;
    dword_4D0F10 = 0;
    crt_atexit(nullsub_63);
  }
  dword_4D0F08 = (int)aPlayAGame;
  if ( dword_4D11F0 == 6 || (byte_4D0F0E = 0, !dword_4D11F0) )
    byte_4D0F0E = 1;
  if ( ui_button_update(&v82, (int)&dword_4D0F08) )
  {
    if ( config_game_mode == 3 )
    {
      v17 = quest_stage_minor + 10 * *(_DWORD *)quest_stage_major - 11;
      if ( config_hardcore )
      {
        if ( quest_unlock_index_full < v17 )
          goto LABEL_88;
      }
      else if ( quest_unlock_index < v17 )
      {
        goto LABEL_88;
      }
      render_pass_mode = 0;
      byte_487292 = 0;
      ui_transition_direction = 0;
      game_state_pending = 9;
    }
    else
    {
      render_pass_mode = 0;
      v18 = -(config_game_mode != 4);
      byte_487292 = 0;
      LOBYTE(v18) = v18 & 0xF7;
      ui_transition_direction = 0;
      game_state_pending = v18 + 18;
    }
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    byte_48702C = 1;
  }
LABEL_88:
  v98 = v82 - 32.0;
  v99 = v83 + 32.0;
  if ( (byte_4CCCB8 & 0x10) == 0 )
  {
    byte_4D0F96 = 1;
    byte_4CCCB8 |= 0x10u;
    byte_4D0FA5 = 0;
    byte_4D0FA4 = 0;
    dword_4D0FA0 = 1065353216;
    dword_4D0F9C = 0;
    dword_4D0F90 = 0;
    byte_4D0F94 = 0;
    byte_4D0F95 = 0;
    dword_4D0F98 = 0;
    crt_atexit(nullsub_62);
  }
  dword_4D0F90 = (int)aBack_0;
  if ( dword_4D11F0 == 6 || (byte_4D0F96 = 0, !dword_4D11F0) )
    byte_4D0F96 = 1;
  v89 = v82 + 166.0;
  v90 = v83;
  if ( ui_button_update(&v89, (int)&dword_4D0F90) )
  {
    if ( byte_48724D )
    {
      v19 = bonus_pool;
      do
      {
        *v19 = 0;
        v19 += 7;
      }
      while ( (int)v19 < (int)&quest_spawn_count );
      v20 = projectile_pool;
      do
      {
        *v20 = 0;
        v20 += 64;
      }
      while ( (int)v20 < (int)particle_pool );
      v21 = sprite_effect_pool;
      do
      {
        *v21 = 0;
        v21 += 44;
      }
      while ( (int)v21 < (int)byte_49AA20 );
      v22 = &secondary_projectile_pool;
      do
      {
        *v22 = 0;
        v22 += 44;
      }
      while ( (int)v22 < (int)&dword_4965D8 );
      v23 = creature_pool;
      do
      {
        *v23 = 0;
        v23 += 152;
      }
      while ( (int)v23 < (int)byte_4AA338 );
      quest_stage_minor = dword_487254;
      *(_DWORD *)quest_stage_major = dword_487250;
      byte_48727C = 1;
      config_game_mode = dword_487258;
      config_hardcore = byte_48725C;
      ui_transition_direction = 0;
      game_state_pending = (dword_487258 == 3) + 7;
    }
    else
    {
      ui_transition_direction = 0;
      game_state_pending = 4;
    }
  }
  v94 = flt_48A114 + flt_48A138;
  v85 = flt_48A134 + flt_48A110 + 300.0;
  v86 = v94 + 40.0;
  v24 = flt_48A100 - 16.0 + v85 - 224.0;
  v82 = v24;
  v83 = v86 + 10.0;
  v89 = v24 + 32.0;
  v90 = v83 + 364.0;
  v86 = v83 - 8.0;
  v85 = v82 - 16.0;
  if ( *(int *)config_screen_width <= 640 )
  {
    v85 = v85 + 10.0;
    v24 = v24 - 8.0;
  }
  v25 = dword_4D11F0;
  v82 = v24 - 10.0;
  if ( (dword_4D11F0 == 6 || !dword_4D11F0) && v12 == -1 )
  {
    v86 = v86 + 2.0;
    if ( (byte_4CCCB8 & 0x20) == 0 )
    {
      byte_4D0E20 = 0;
      byte_4CCCB8 |= 0x20u;
      byte_4D0E21 = 0;
      byte_4D0E22 = 0;
      dword_4D0E24 = 0;
      crt_atexit(nullsub_61);
    }
    v97[0] = v85;
    v91 = v85;
    v92 = v86;
    dword_4D0E24 = (int)aShowInternetSc;
    byte_4D0E20 = config_score_load_gate;
    if ( ui_checkbox_update(&v91, (int)&byte_4D0E20) )
    {
      config_score_load_gate = byte_4D0E20;
      j_highscore_load_table();
    }
    v104[0] = aBestOfAllTime;
    v104[1] = aBestOfMonth;
    v104[2] = aBestOfWeek;
    v86 = v86 + 6.0;
    v104[3] = aBestOfDay;
    v104[4] = 0;
    if ( (byte_4CCCB8 & 0x40) == 0 )
    {
      byte_4D0D78 = 1;
      byte_4CCCB8 |= 0x40u;
      dword_4D0D90 = 0;
      byte_4D0D8C = 0;
      dword_4D0D80 = 0;
      dword_4D0D7C = 0;
      dword_4D0D88 = 0;
      dword_4D0D84 = 0;
      crt_atexit(nullsub_60);
    }
    dword_4D0D88 = 4;
    dword_4D0D84 = (int)v104;
    v27 = game_is_full_version(v26);
    v28 = v85;
    if ( v27 )
    {
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        1061997773);
      v70 = v86 + 114.0 - 14.0;
      (*(void (__thiscall **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 324))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v28)),
        LODWORD(v70),
        aSelectedScoreL);
      v92 = v86 + 114.0;
      v91 = v97[0];
      FUN_004443c0(&v91, byte_478678);
    }
    dword_4D0D80 = SBYTE2(config_blob[0]);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1061997773);
    v29 = *(_DWORD *)grim_interface_ptr;
    v91 = v86 + 28.0 - 14.0;
    v30 = v91;
    v88 = v85 + 2.0;
    (*(void (__thiscall **)(int, float, float, char *))(v29 + 324))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v88)),
      COERCE_FLOAT(LODWORD(v91)),
      aNumberOfPlayer);
    v31 = *(_DWORD *)grim_interface_ptr;
    v87 = v85 + 130.0;
    (*(void (__thiscall **)(int, float, float, char *))(v31 + 324))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v87)),
      COERCE_FLOAT(LODWORD(v30)),
      aGameMode);
    v71 = v86 + 70.0 - 14.0;
    (*(void (__thiscall **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 324))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v28)),
      LODWORD(v71),
      aShowScores);
    v92 = v86 + 70.0;
    v91 = v97[0];
    v32 = ui_list_widget_update(&v91, (int)&byte_4D0D78);
    if ( (dword_4D11F0 == 6 || !dword_4D11F0)
      && v32 > -2
      && ((unsigned __int8)input_primary_just_pressed()
       || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28)) )
    {
      dword_4D0D7C = 1 - dword_4D0D7C;
      if ( v32 >= 0 )
      {
        dword_4D0D80 = v32;
        if ( v32 )
        {
          switch ( v32 )
          {
            case 1:
              BYTE2(config_blob[0]) = 1;
              break;
            case 2:
              BYTE2(config_blob[0]) = 2;
              break;
            case 3:
              BYTE2(config_blob[0]) = 3;
              break;
          }
        }
        else
        {
          BYTE2(config_blob[0]) = 0;
        }
        j_highscore_load_table();
      }
    }
    *(float *)&v93 = COERCE_FLOAT(a1Player);
    v94 = COERCE_FLOAT(a2Players);
    if ( byte_4CCCB8 >= 0 )
    {
      byte_4D0FA8 = 1;
      byte_4CCCB8 |= 0x80u;
      dword_4D0FC0 = 0;
      byte_4D0FBC = 0;
      dword_4D0FB0 = 0;
      dword_4D0FAC = 0;
      dword_4D0FB8 = 0;
      dword_4D0FB4 = 0;
      crt_atexit(nullsub_59);
    }
    dword_4D0FB4 = (int)&v93;
    dword_4D0FB8 = 2;
    dword_4D0FB0 = config_player_count - 1;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1062165545);
    v97[0] = v88;
    v91 = v86 + 28.0;
    v97[1] = v91;
    v33 = ui_list_widget_update(v97, (int)&byte_4D0FA8);
    if ( (dword_4D11F0 == 6 || !dword_4D11F0)
      && v33 > -2
      && ((unsigned __int8)input_primary_just_pressed()
       || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28)) )
    {
      dword_4D0FAC = 1 - dword_4D0FAC;
      if ( v33 >= 0 )
      {
        dword_4D0FB0 = v33;
        config_player_count = v33 + 1;
        j_highscore_load_table();
      }
    }
    v105[0] = aQuests;
    v105[1] = aRush_0;
    v105[2] = aSurvival;
    v105[3] = aTypOShooter;
    v105[4] = 0;
    if ( (byte_4D0F58 & 1) == 0 )
    {
      byte_4CCCE0 = 1;
      byte_4D0F58 |= 1u;
      dword_4CCCF8 = 0;
      byte_4CCCF4 = 0;
      dword_4CCCE8 = 0;
      dword_4CCCE4 = 0;
      dword_4CCCF0 = 0;
      dword_4CCCEC = 0;
      crt_atexit(nullsub_58);
    }
    dword_4CCCEC = (int)v105;
    dword_4CCCF0 = 3;
    if ( quest_unlock_index >= 40 )
      dword_4CCCF0 = 4;
    byte_4CCCE0 = 1;
    byte_4D0D78 = 1;
    byte_478678 = 1;
    if ( dword_4CCCE4 )
    {
      byte_478678 = 0;
      byte_4D0D78 = 0;
    }
    if ( dword_4D0FAC )
    {
      byte_478678 = 0;
      byte_4D0D78 = 0;
      byte_4CCCE0 = 0;
    }
    if ( dword_4D0D7C )
    {
      byte_478678 = 0;
      byte_4CCCE0 = 0;
    }
    byte_4D0FA8 = 1;
    switch ( config_game_mode )
    {
      case 1:
        dword_4CCCE8 = 2;
        break;
      case 2:
        dword_4CCCE8 = 1;
        break;
      case 3:
        dword_4CCCE8 = 0;
        break;
      case 4:
        dword_4CCCE8 = 3;
        byte_4D0FA8 = 0;
        dword_4D0FB0 = 0;
        config_player_count = 1;
        break;
    }
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1062165545);
    v85 = v87;
    v86 = v91;
    v34 = ui_list_widget_update(&v85, (int)&byte_4CCCE0);
    v25 = dword_4D11F0;
    if ( (dword_4D11F0 == 6 || !dword_4D11F0) && v34 > -2 )
    {
      if ( (unsigned __int8)input_primary_just_pressed()
        || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28) )
      {
        dword_4CCCE4 = 1 - dword_4CCCE4;
        if ( v34 >= 0 )
        {
          dword_4CCCE8 = v34;
          if ( v34 )
          {
            switch ( v34 )
            {
              case 1:
                config_game_mode = 2;
                break;
              case 2:
                config_game_mode = 1;
                break;
              case 3:
                config_game_mode = 4;
                config_player_count = 1;
                break;
            }
          }
          else
          {
            config_game_mode = 3;
          }
          j_highscore_load_table();
        }
      }
      v25 = dword_4D11F0;
    }
  }
  v83 = v83 + 44.0;
  if ( *(int *)config_screen_width <= 640 )
    v82 = v82 + 20.0;
  v35 = v98;
  v36 = v99;
  v37 = *(_DWORD *)grim_interface_ptr;
  if ( v25 )
  {
    (*(void (__stdcall **)(int, int, int, int))(v37 + 276))(1056964608, 1065353216, 1058642330, 1065353216);
    if ( dword_4D11F0 == 1 )
    {
      (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v35)),
        COERCE_FLOAT(LODWORD(v36)),
        aConnecting);
      Sleep(0xAu);
      goto LABEL_224;
    }
    if ( dword_4D11F0 == 2 )
    {
      (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v35)),
        COERCE_FLOAT(LODWORD(v36)),
        aConnected);
      Sleep(0xAu);
      goto LABEL_224;
    }
    if ( dword_4D11F0 == 3 )
    {
      if ( game_is_full_version(v38) )
        (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
          grim_interface_ptr,
          COERCE_FLOAT(LODWORD(v35)),
          COERCE_FLOAT(LODWORD(v36)),
          aSendingLocalSc);
      else
        (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
          grim_interface_ptr,
          COERCE_FLOAT(LODWORD(v35)),
          COERCE_FLOAT(LODWORD(v36)),
          aConnected_0);
      goto LABEL_188;
    }
    if ( dword_4D11F0 == 4 )
    {
      (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v35)),
        COERCE_FLOAT(LODWORD(v36)),
        aReceivingInter);
      Sleep(0xAu);
    }
    else
    {
      if ( dword_4D11F0 != 5 )
      {
        if ( dword_4D11F0 == 6 )
        {
          (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
            grim_interface_ptr,
            1065353216,
            1056964608,
            1056964608,
            1065353216);
          (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
            grim_interface_ptr,
            COERCE_FLOAT(LODWORD(v35)),
            COERCE_FLOAT(LODWORD(v36)),
            aFailedToUpdate);
          byte_4D11F9 = 0;
        }
        goto LABEL_188;
      }
      (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v35)),
        COERCE_FLOAT(LODWORD(v36)),
        aDone_0);
      if ( byte_4D1218 )
      {
LABEL_188:
        Sleep(0xAu);
        goto LABEL_224;
      }
      dword_4D11F0 = 1;
      crt_beginthread((_beginthread_proc_type)sub_42D8A0, 0, 0);
      byte_4D1218 = 1;
      Sleep(0xAu);
    }
    goto LABEL_224;
  }
  if ( (*(unsigned __int8 (__stdcall **)(int))(v37 + 68))(1) )
  {
    byte_4D11F9 = 0;
    goto LABEL_224;
  }
  if ( byte_4D11F9 )
  {
    if ( config_game_mode == 3 )
    {
      v39 = config_hardcore;
    }
    else
    {
      v39 = 0;
      config_hardcore = 0;
    }
    byte_4D0D94 = v39;
    v40 = ++dword_4CCB58;
    if ( v39 && v40 < 0 )
    {
      v40 = 0;
      dword_4CCB58 = 0;
    }
    else
    {
      switch ( v40 )
      {
        case -3:
          config_game_mode = 1;
          goto LABEL_223;
        case -2:
          config_game_mode = 2;
          goto LABEL_223;
        case -1:
          if ( config_player_count > 1 )
          {
            v40 = 0;
            dword_4CCB58 = 0;
          }
          config_game_mode = 4;
          break;
      }
      if ( v40 < 0 )
        goto LABEL_223;
    }
    if ( v39 )
    {
      if ( HIWORD(game_status_blob) >= v40 )
      {
LABEL_220:
        if ( v40 / 10 + 1 >= 5 )
          goto LABEL_221;
        *(_DWORD *)quest_stage_major = v40 / 10 + 1;
        config_game_mode = 3;
        quest_stage_minor = v40 % 10 + 1;
LABEL_223:
        Sleep(0x32u);
        dword_4D11F0 = 1;
        crt_beginthread((_beginthread_proc_type)sub_42D0E0, 0, 0);
        goto LABEL_224;
      }
    }
    else if ( (unsigned __int16)game_status_blob >= v40 )
    {
      goto LABEL_220;
    }
LABEL_221:
    byte_4D11F9 = 0;
  }
LABEL_224:
  if ( v12 == -1 )
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    if ( !dword_4D11F0 )
    {
      if ( dword_4D0F80 > 0 )
      {
        v76 = (double)dword_4D0F80 * 0.00090000004;
        (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          LODWORD(v76));
        if ( game_is_full_version(v41) )
        {
          if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(
                 grim_interface_ptr,
                 42)
            || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(
                 grim_interface_ptr,
                 54) )
          {
            (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
              grim_interface_ptr,
              COERCE_FLOAT(LODWORD(v35)),
              COERCE_FLOAT(LODWORD(v36)),
              aUpdateScoresFr);
          }
        }
        else
        {
          v64 = v98 - 4.0;
          (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
            grim_interface_ptr,
            LODWORD(v64),
            COERCE_FLOAT(LODWORD(v36)),
            aOnlyReceiveSco);
        }
      }
      if ( dword_4D0F10 > 0 )
      {
        v77 = (double)dword_4D0F10 * 0.00090000004;
        (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
          grim_interface_ptr,
          1065353216,
          1065353216,
          1065353216,
          LODWORD(v77));
        (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
          grim_interface_ptr,
          COERCE_FLOAT(LODWORD(v35)),
          COERCE_FLOAT(LODWORD(v36)),
          aPlayAGameOfSel);
      }
    }
  }
  else
  {
    v42 = v82;
    *(float *)&v43 = v83;
    (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
      grim_interface_ptr,
      24,
      1054615798,
      v63,
      v69,
      v75);
    v83 = v83 - 54.0;
    *(float *)&v93 = v82 + 24.0;
    v94 = v83 + 4.0;
    ui_text_input_render(v12, 0, v43, v42, (int)&v93, 72 * v12 + 4729616, 1.0, v12 + 1, v78, v79, v80, v81);
    v82 = v42;
    v83 = *(float *)&v43;
  }
  if ( (dword_4D11F0 == 6 || !dword_4D11F0)
    && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 203) )
  {
    v44 = *(_DWORD *)quest_stage_major;
    v45 = --quest_stage_minor;
    if ( quest_stage_minor <= 0 )
    {
      if ( *(int *)quest_stage_major < 2 )
      {
        v45 = 1;
      }
      else
      {
        v44 = *(_DWORD *)quest_stage_major - 1;
        v45 = 10;
        --*(_DWORD *)quest_stage_major;
      }
      quest_stage_minor = v45;
    }
    if ( config_hardcore )
    {
      if ( v45 + 10 * v44 - 11 > quest_unlock_index_full )
      {
        *(_DWORD *)quest_stage_major = quest_unlock_index_full / 10 + 1;
        quest_stage_minor = quest_unlock_index_full % 10 + 1;
        j_highscore_load_table();
      }
    }
    else if ( v45 + 10 * v44 - 11 > quest_unlock_index )
    {
      *(_DWORD *)quest_stage_major = quest_unlock_index / 10 + 1;
      quest_stage_minor = quest_unlock_index % 10 + 1;
    }
    j_highscore_load_table();
  }
  if ( (dword_4D11F0 == 6 || !dword_4D11F0)
    && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 205) )
  {
    v46 = *(_DWORD *)quest_stage_major;
    v47 = quest_stage_minor;
    if ( quest_stage_minor + 10 * *(_DWORD *)quest_stage_major - 11 < quest_unlock_index )
      v47 = ++quest_stage_minor;
    if ( v47 > 10 )
    {
      if ( *(int *)quest_stage_major >= 5 )
      {
        v47 = 10;
      }
      else
      {
        v46 = *(_DWORD *)quest_stage_major + 1;
        v47 = 1;
        ++*(_DWORD *)quest_stage_major;
      }
      quest_stage_minor = v47;
    }
    if ( config_hardcore )
    {
      if ( v47 + 10 * v46 - 11 > quest_unlock_index_full )
      {
        *(_DWORD *)quest_stage_major = quest_unlock_index_full / 10 + 1;
        quest_stage_minor = quest_unlock_index_full % 10 + 1;
        j_highscore_load_table();
      }
    }
    else if ( v47 + 10 * v46 - 11 > quest_unlock_index )
    {
      *(_DWORD *)quest_stage_major = quest_unlock_index / 10 + 1;
      quest_stage_minor = quest_unlock_index % 10 + 1;
    }
    j_highscore_load_table();
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  if ( (!dword_4D11F0 || dword_4D11F0 == 6)
    && (v84 && (unsigned __int8)input_primary_just_pressed()
     || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28)) )
  {
    switch ( dword_4D1214 )
    {
      case -3:
        v48 = *(_DWORD *)quest_stage_major;
        v49 = --quest_stage_minor;
        if ( quest_stage_minor <= 0 )
        {
          if ( *(int *)quest_stage_major < 2 )
          {
            v49 = 1;
          }
          else
          {
            v48 = *(_DWORD *)quest_stage_major - 1;
            v49 = 10;
            --*(_DWORD *)quest_stage_major;
          }
          quest_stage_minor = v49;
        }
        v50 = v49 + 10 * v48 - 11;
        if ( config_hardcore )
        {
          if ( v50 > quest_unlock_index_full )
          {
LABEL_278:
            *(_DWORD *)quest_stage_major = quest_unlock_index_full / 10 + 1;
            quest_stage_minor = quest_unlock_index_full % 10 + 1;
            j_highscore_load_table();
            j_highscore_load_table();
            break;
          }
        }
        else if ( v50 > quest_unlock_index )
        {
          *(_DWORD *)quest_stage_major = quest_unlock_index / 10 + 1;
          quest_stage_minor = quest_unlock_index % 10 + 1;
        }
        goto LABEL_281;
      case -2:
        v51 = *(_DWORD *)quest_stage_major;
        v52 = quest_stage_minor;
        if ( quest_stage_minor + 10 * *(_DWORD *)quest_stage_major - 11 < quest_unlock_index )
          v52 = ++quest_stage_minor;
        if ( v52 > 10 )
        {
          if ( *(int *)quest_stage_major >= 5 )
          {
            v52 = 10;
          }
          else
          {
            v51 = *(_DWORD *)quest_stage_major + 1;
            v52 = 1;
            ++*(_DWORD *)quest_stage_major;
          }
          quest_stage_minor = v52;
        }
        if ( config_hardcore )
        {
          if ( v52 + 10 * v51 - 11 > quest_unlock_index_full )
            goto LABEL_278;
        }
        else if ( v52 + 10 * v51 - 11 > quest_unlock_index )
        {
          *(_DWORD *)quest_stage_major = quest_unlock_index / 10 + 1;
          quest_stage_minor = quest_unlock_index % 10 + 1;
        }
LABEL_281:
        j_highscore_load_table();
        break;
      case 1:
        if ( !dword_4D11F0 || dword_4D11F0 == 6 )
        {
          if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(
                 grim_interface_ptr,
                 42)
            || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(
                 grim_interface_ptr,
                 54) )
          {
            dword_4CCB58 = -4;
            byte_4D11F9 = 1;
          }
          else
          {
            byte_4D11F9 = 0;
          }
          dword_4D11F0 = 1;
          crt_beginthread((_beginthread_proc_type)sub_42D0E0, 0, 0);
        }
        break;
      case 2:
        render_pass_mode = 0;
        byte_487292 = 0;
        ui_transition_direction = 0;
        game_state_pending = 9;
        sfx_mute_all(music_track_crimson_theme_id);
        sfx_mute_all(music_track_shortie_monk_id);
        sfx_mute_all(music_track_extra_0);
        byte_48702C = 1;
        break;
      case 3:
        ui_transition_direction = 0;
        game_state_pending = 4;
        break;
    }
  }
  if ( (!dword_4D11F0 || dword_4D11F0 == 6)
    && (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 1) )
  {
    ui_transition_direction = 0;
    game_state_pending = 4;
  }
  if ( !dword_4D11F0 && byte_4D11F8 && lpMultiByteStr )
  {
    *(float *)&v93 = v89 - 48.0;
    v94 = v90 - 146.0;
    ui_update_notice_update((float *)&v93, 1.0);
  }
  else
  {
    byte_480838 = 0;
  }
  result = ui_transition_direction;
  if ( !ui_transition_direction )
  {
    byte_4D11F8 = 0;
    byte_4D1218 = 0;
  }
  return result;
}

// nullsub_58 @ 0x00444330
void __cdecl nullsub_58()
{
  ;
}

// nullsub_59 @ 0x00444340
void __cdecl nullsub_59()
{
  ;
}

// nullsub_60 @ 0x00444350
void __cdecl nullsub_60()
{
  ;
}

// nullsub_61 @ 0x00444360
void __cdecl nullsub_61()
{
  ;
}

// nullsub_62 @ 0x00444370
void __cdecl nullsub_62()
{
  ;
}

// nullsub_63 @ 0x00444380
void __cdecl nullsub_63()
{
  ;
}

// nullsub_64 @ 0x00444390
void __cdecl nullsub_64()
{
  ;
}

// nullsub_65 @ 0x004443A0
void __cdecl nullsub_65()
{
  ;
}

// nullsub_66 @ 0x004443B0
void __cdecl nullsub_66()
{
  ;
}

// FUN_004443c0 @ 0x004443C0
// [binja] int32_t sub_4443c0(float* arg1, char arg2)
char __cdecl sub_4443C0(float *a1, char a2)
{
  int v2; // edx
  int *v3; // ecx
  char *v4; // eax
  int v5; // esi
  int v6; // eax
  int v8; // [esp+Ch] [ebp-Ch]
  float v9; // [esp+10h] [ebp-8h] BYREF
  float v10; // [esp+14h] [ebp-4h]

  if ( (byte_4CCCD8 & 1) == 0 )
  {
    dword_4D0F38 = 1065353216;
    byte_4CCCD8 |= 1u;
    dword_4D0F28 = (int)&byte_4CCB18;
    dword_4D0F2C = 0;
    dword_4D0F30 = 27;
    dword_4D0F34 = 96;
    crt_atexit(nullsub_70);
  }
  v2 = config_name_slot_count;
  v8 = 0;
  if ( config_name_slot_count > 0 )
  {
    v3 = dword_4CCB5C;
    v4 = config_saved_name_0;
    v8 = config_name_slot_count;
    do
    {
      *v3 = (int)v4;
      v4 += 27;
      ++v3;
      --v2;
    }
    while ( v2 );
  }
  dword_4CCB5C[v8] = (int)strdup_malloc(aAddNewNamedLis);
  if ( (byte_4CCCD8 & 2) == 0 )
  {
    byte_4CCC96 = 1;
    byte_4CCCD8 |= 2u;
    byte_4CCCA5 = 0;
    byte_4CCCA4 = 0;
    dword_4CCCA0 = 1065353216;
    dword_4CCC9C = 0;
    dword_4CCC90 = 0;
    byte_4CCC94 = 0;
    byte_4CCC95 = 0;
    dword_4CCC98 = 0;
    crt_atexit(nullsub_69);
  }
  dword_4CCC90 = (int)aAdd;
  if ( (byte_4CCCD8 & 4) == 0 )
  {
    byte_4CCB06 = 1;
    byte_4CCCD8 |= 4u;
    byte_4CCB15 = 0;
    byte_4CCB14 = 0;
    dword_4CCB10 = 1065353216;
    dword_4CCB0C = 0;
    dword_4CCB00 = 0;
    byte_4CCB04 = 0;
    byte_4CCB05 = 0;
    dword_4CCB08 = 0;
    crt_atexit(nullsub_68);
  }
  dword_4CCB00 = (int)aDelete_0;
  dword_4D0F34 = 174;
  if ( byte_4D1220 )
  {
    v9 = *a1;
    v10 = a1[1] + 29.0;
    if ( ui_text_input_update(&v9, &dword_4D0F28)
      || (v9 = *a1 + 180.0, v10 = a1[1] + 22.0, ui_button_update(&v9, (int)&dword_4CCC90)) )
    {
      strcpy(&config_saved_name_0[27 * config_name_slot_count], &byte_4CCB18);
      config_name_slot_selected = config_name_slot_count++;
      if ( config_name_slot_count >= 8 )
      {
        strcpy(config_saved_name_1, &byte_4CCB18);
        --config_name_slot_count;
      }
      byte_4CCB18 = 0;
      dword_4D0F2C = 0;
      byte_4D1220 = 0;
      goto LABEL_20;
    }
  }
  else if ( !dword_4D121C )
  {
    if ( config_name_slot_selected )
    {
      v9 = *a1;
      v10 = a1[1] + 22.0;
      if ( ui_button_update(&v9, (int)&dword_4CCB00) )
      {
        --config_name_slot_count;
        strcpy(&config_saved_name_0[27 * config_name_slot_selected], &config_saved_name_0[27 * config_name_slot_count]);
        config_name_slot_selected = 0;
LABEL_20:
        j_highscore_load_table();
      }
    }
  }
  if ( (byte_4CCCD8 & 8) == 0 )
  {
    byte_4D0EE8 = 1;
    byte_4CCCD8 |= 8u;
    dword_4D0F00 = 0;
    byte_4D0EFC = 0;
    dword_4D0EF0 = 0;
    dword_4D0EEC = 0;
    dword_4D0EF8 = 0;
    dword_4D0EF4 = 0;
    crt_atexit(nullsub_67);
  }
  dword_4D0EF4 = (int)dword_4CCB5C;
  dword_4D0EF8 = v8 + 1;
  byte_4D0EE8 = a2;
  dword_4D0EF0 = config_name_slot_selected;
  v5 = ui_list_widget_update(a1, (int)&byte_4D0EE8);
  if ( v5 > -2
    && ((unsigned __int8)input_primary_just_pressed()
     || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28)) )
  {
    v6 = 1 - dword_4D121C;
    dword_4D121C = 1 - dword_4D121C;
    if ( v5 >= 0 )
    {
      dword_4D0EF0 = v5;
      config_name_slot_selected = v5;
      if ( v5 != v8 )
      {
        j_highscore_load_table();
        v6 = dword_4D121C;
      }
      byte_4D1221 = 1;
      byte_4D1222 = 1;
    }
    byte_4D1220 = v5 == v8;
  }
  else
  {
    v6 = dword_4D121C;
  }
  dword_4D0EEC = v6;
  crt_free((LPVOID)dword_4CCB5C[v8]);
  return 0;
}

// nullsub_67 @ 0x004447D0
void __cdecl nullsub_67()
{
  ;
}

// nullsub_68 @ 0x004447E0
void __cdecl nullsub_68()
{
  ;
}

// nullsub_69 @ 0x004447F0
void __cdecl nullsub_69()
{
  ;
}

// nullsub_70 @ 0x00444800
void __cdecl nullsub_70()
{
  ;
}

// creature_spawn_tinted @ 0x00444810
// spawns a creature with tint and default stats
int __cdecl sub_444810(int a1, int *a2, int a3)
{
  int v3; // edi
  int v4; // esi
  int v5; // eax
  int *v6; // edx
  int v7; // eax
  double v8; // st7
  double v9; // st6
  int v10; // eax

  v3 = creature_alloc_slot();
  v4 = 38 * v3;
  *(int *)((char *)&creature_pos_x + v4 * 4) = *(_DWORD *)a1;
  creature_pos_y[v4] = *(float *)(a1 + 4);
  creature_pool[v4 * 4] = 1;
  creature_state_flag[v4 * 4] = 1;
  creature_vel_x[v4] = 0;
  creature_ai_mode[v4] = 2;
  creature_collision_flag[v4 * 4] = 0;
  creature_collision_timer[v4] = 0;
  *(int *)((char *)&creature_type_id + v4 * 4) = a3;
  creature_force_target[v4 * 4] = 0;
  creature_hitbox_size[v4] = 1098907648;
  creature_health[v4] = 1065353216;
  creature_vel_y[v4] = 0;
  v5 = crt_rand();
  creature_move_speed[v4] = 1.7;
  creature_reward_value[v4] = 1.0;
  creature_attack_cooldown[v4] = 0.0;
  v6 = &creature_tint_r + 38 * v3;
  *(float *)(v4 * 4 + 4833124) = (double)(v5 % 314) * 0.0099999998;
  *v6 = *a2;
  v6[1] = a2[1];
  v6[2] = a2[2];
  v6[3] = a2[3];
  v7 = crt_rand();
  *(float *)((char *)&creature_contact_damage + v4 * 4) = 100.0;
  LODWORD(creature_max_health[v4]) = creature_health[v4];
  v8 = (double)(v7 % 20) + 47.0;
  *(float *)(v4 * 4 + 4833132) = v8;
  if ( a3 != 3 && a3 != 4 )
    return v3;
  v9 = creature_move_speed[38 * v3] * 1.2;
  v10 = creature_flags[38 * v3];
  LOBYTE(v10) = v10 | 0x80;
  creature_flags[38 * v3] = v10;
  creature_move_speed[38 * v3] = v9;
  *(&creature_size + 38 * v3) = v8 * 0.80000001;
  return v3;
}

// player_fire_weapon @ 0x00444980
// handles player firing: cooldowns, ammo, projectiles, and muzzle effects
void __cdecl sub_444980(int *a1, char a2, char a3)
{
  std::codecvt_base *v3; // ecx
  int v4; // edx
  int v5; // ecx
  double v7; // st7
  unsigned __int8 v8; // c0
  unsigned __int8 v9; // c3
  double v10; // st7
  char v11; // bl
  int v12; // ecx
  long double v13; // st7
  long double v14; // st7
  long double v15; // st7
  double v16; // st7
  int v17; // eax
  float *v18; // eax
  double v19; // st7
  int v20; // edi
  int v21; // eax
  float *v22; // eax
  double v23; // st7
  int v24; // esi
  int v25; // esi
  double v26; // st7
  int v27; // eax
  double v28; // st7
  double v29; // st7
  double v30; // st6
  double v31; // st7
  float v32; // [esp+4h] [ebp-2Ch]
  float v33; // [esp+18h] [ebp-18h]
  float v34; // [esp+1Ch] [ebp-14h]
  float v35; // [esp+20h] [ebp-10h] BYREF
  float v36; // [esp+24h] [ebp-Ch]
  int v37; // [esp+28h] [ebp-8h] BYREF
  float v38; // [esp+2Ch] [ebp-4h]
  float v39; // [esp+34h] [ebp+4h]
  float v40; // [esp+38h] [ebp+8h]
  char v41; // [esp+3Ch] [ebp+Ch]
  int v42; // [esp+3Ch] [ebp+Ch]

  if ( !game_is_full_version(v3) )
    crt_exit(0);
  if ( !console_open_flag )
  {
    v4 = render_overlay_player_index;
    v5 = 216 * render_overlay_player_index;
    v7 = frame_dt;
    if ( v8 | v9 )
    {
      player_death_timer[216 * render_overlay_player_index] = player_death_timer[216 * render_overlay_player_index]
                                                            - v7 * 20.0;
    }
    else
    {
      v10 = *(float *)&player_muzzle_flash_alpha[216 * render_overlay_player_index] - (v7 + v7);
      *(float *)&player_muzzle_flash_alpha[216 * render_overlay_player_index] = v10;
      if ( v10 < 0.0 )
        player_muzzle_flash_alpha[v5] = 0;
      player_shot_cooldown[v5] = 0;
      player_move_dx[v5] = 0;
      player_move_dy[v5] = 0;
      player_spread_heat[v5] = 0;
      player_ammo[v5] = player_clip_size[v5];
      player_reload_timer[v5] = 0;
      if ( a3 )
      {
        player_start_reload();
        v4 = render_overlay_player_index;
      }
      v11 = 0;
      v12 = 216 * v4;
      v41 = 0;
      player_aim_x[v12] = *a1;
      player_aim_y[v12] = a1[1];
      *(float *)(v12 * 4 + 4787120) = atan2(
                                        *(float *)&player_pos_y[216 * v4] - *(float *)&player_aim_y[216 * v4],
                                        *(float *)&player_pos_x[216 * v4] - *(float *)&player_aim_x[216 * v4])
                                    - 1.5707964;
      if ( *(float *)&player_shot_cooldown[216 * v4] <= 0.0 && *(float *)&player_reload_timer[216 * v4] == 0.0 )
      {
        v11 = 1;
        player_reload_active[864 * v4] = 0;
      }
      if ( *(float *)&player_shot_cooldown[216 * v4] <= 0.0 && player_experience[216 * v4] > 0 )
      {
        if ( perk_count_get(perk_id_regression_bullets) || perk_count_get(perk_id_ammunition_within) )
          v41 = 1;
        v4 = render_overlay_player_index;
      }
      if ( v11 || v41 )
      {
        v42 = player_aim_heading[216 * v4];
        if ( a2 )
        {
          v13 = *(float *)&v42 - 1.5707964 - 0.150915;
          v33 = cos(v13) * 16.0;
          v34 = sin(v13) * 16.0;
          if ( (byte_4D7A94[124 * player_weapon_id[216 * v4]] & 1) != 0 )
          {
            crt_rand();
            crt_rand();
            v4 = render_overlay_player_index;
          }
          if ( *(float *)&player_muzzle_flash_alpha[216 * v4] > 1.0 )
            player_muzzle_flash_alpha[216 * v4] = 1065353216;
          *(float *)&player_muzzle_flash_alpha[216 * v4] = flt_4D7A7C[31 * player_weapon_id[216 * v4]]
                                                         + *(float *)&player_muzzle_flash_alpha[216 * v4];
          sfx_play_panned(*(&dword_4D7A84 + 31 * player_weapon_id[216 * v4]), (float *)&player_pos_x[216 * v4], 1.0);
          v4 = render_overlay_player_index;
          if ( player_weapon_id[216 * render_overlay_player_index] == 3 )
          {
            v14 = cos(*(float *)&v42);
            v40 = v14;
            v35 = v14 * 25.0;
            v15 = sin(*(float *)&v42);
            v39 = v15;
            v36 = v15 * 25.0;
            v16 = v34 + *(float *)&player_pos_y[216 * render_overlay_player_index];
            *(float *)&v37 = v33 + *(float *)&player_pos_x[216 * render_overlay_player_index];
            v38 = v16;
            v17 = fx_spawn_sprite(&v37, (int *)&v35, 1065353216);
            *(float *)&v37 = v40 * 15.0;
            v17 *= 44;
            *(int *)((char *)sprite_effect_color_r + v17) = 1056964608;
            *(int *)((char *)sprite_effect_color_g + v17) = 1056964608;
            *(int *)((char *)sprite_effect_color_b + v17) = 1056964608;
            *(int *)((char *)sprite_effect_color_a + v17) = 1048576000;
            v38 = v39 * 15.0;
            v18 = (float *)&player_pos_x[216 * render_overlay_player_index];
            v19 = v34 + v18[1];
            v35 = v33 + *v18;
            v36 = v19;
            v20 = 12;
            v21 = 11 * fx_spawn_sprite((int *)&v35, &v37, 0x40000000);
            sprite_effect_color_r[v21] = 1056964608;
            sprite_effect_color_g[v21] = 1056964608;
            sprite_effect_color_b[v21] = 1056964608;
            sprite_effect_color_a[v21] = 1046764061;
            do
            {
              v22 = (float *)&player_pos_x[216 * render_overlay_player_index];
              v23 = v34 + v22[1];
              *(float *)&v37 = v33 + *v22;
              v38 = v23;
              v32 = (double)(crt_rand() % 200 - 100) * 0.0013 + *(float *)&v42;
              v24 = projectile_spawn(&v37, v32, 3, -100);
              --v20;
              projectile_speed_scale[16 * v24] = (double)(crt_rand() % 100) * 0.0099999998 + 1.0;
            }
            while ( v20 );
            v4 = render_overlay_player_index;
          }
          v25 = perk_id_sharpshooter;
          if ( (int)*(&player_perk_counts + perk_id_sharpshooter) <= 0 )
            *(float *)&player_spread_heat[216 * v4] = flt_473A40 * frame_dt * 150.0
                                                    + *(float *)&player_spread_heat[216 * v4];
          v26 = flt_473A40 + flt_473A40;
          if ( v26 < *(float *)&player_spread_heat[216 * v4] )
            *(float *)&player_spread_heat[216 * v4] = v26;
          v27 = perk_id_fastshot;
          *(float *)&player_spread_heat[216 * v4] = flt_473A40 * *(float *)&player_spread_heat[216 * v4];
          if ( (int)*(&player_perk_counts + v27) > 0 )
            *(float *)&player_shot_cooldown[216 * v4] = *(float *)&player_shot_cooldown[216 * v4] * 0.88;
          if ( (int)*(&player_perk_counts + v25) > 0 )
            *(float *)&player_shot_cooldown[216 * v4] = *(float *)&player_shot_cooldown[216 * v4] * 1.05;
          if ( *(float *)&player_ammo[216 * v4] <= 0.0 )
          {
            player_start_reload();
            v4 = render_overlay_player_index;
          }
        }
      }
      if ( *((float *)&player_move_phase + 216 * v4) > 14.0 )
      {
        do
        {
          v28 = *((float *)&player_move_phase + 216 * v4) - 14.0;
          *((float *)&player_move_phase + 216 * v4) = v28;
        }
        while ( v28 > 14.0 );
      }
      v29 = *(float *)&player_size[216 * v4] * 0.5;
      if ( v29 > *(float *)&player_pos_x[216 * v4] )
        *(float *)&player_pos_x[216 * v4] = v29;
      v30 = (double)terrain_texture_width - v29;
      if ( v30 < *(float *)&player_pos_x[216 * v4] )
        *(float *)&player_pos_x[216 * v4] = v30;
      if ( v29 > *(float *)&player_pos_y[216 * v4] )
        *(float *)&player_pos_y[216 * v4] = v29;
      v31 = (double)terrain_texture_height - v29;
      if ( v31 < *(float *)&player_pos_y[216 * v4] )
        *(float *)&player_pos_y[216 * v4] = v31;
      if ( *(float *)&player_muzzle_flash_alpha[216 * v4] > 0.80000001 )
        player_muzzle_flash_alpha[216 * v4] = 1061997773;
    }
  }
}

// sub_444F70 @ 0x00444F70
char *__cdecl sub_444F70(char a1)
{
  int v1; // esi
  char *result; // eax

  v1 = 52;
  if ( !a1 )
    v1 = 51;
  switch ( crt_rand() % v1 )
  {
    case 0:
      result = aLamb;
      break;
    case 1:
      result = aGun;
      break;
    case 2:
      result = aHead;
      break;
    case 3:
      result = aTail;
      break;
    case 4:
      result = aLeg;
      break;
    case 5:
      result = aNose;
      break;
    case 6:
      result = aRoad;
      break;
    case 7:
      result = aStab;
      break;
    case 8:
      result = aHigh;
      break;
    case 9:
      result = aLow;
      break;
    case 10:
      result = aHat;
      break;
    case 11:
      result = aPie;
      break;
    case 12:
      result = aHand;
      break;
    case 13:
      result = aJack;
      break;
    case 14:
      result = aCube;
      break;
    case 15:
      result = aIce;
      break;
    case 16:
      result = aCow;
      break;
    case 17:
      result = aKing;
      break;
    case 18:
      result = aLord;
      break;
    case 19:
      result = aMate;
      break;
    case 20:
      result = aMary;
      break;
    case 21:
      result = aDick;
      break;
    case 22:
      result = aBill;
      break;
    case 23:
      result = aCat;
      break;
    case 24:
      result = aHarry;
      break;
    case 25:
      result = aTom;
      break;
    case 26:
      result = aFly;
      break;
    case 27:
      result = aCall;
      break;
    case 28:
      result = aShot;
      break;
    case 29:
      result = aGate;
      break;
    case 30:
      result = aQuick;
      break;
    case 31:
      result = aBrown;
      break;
    case 32:
      result = aFox;
      break;
    case 33:
      result = aJumper;
      break;
    case 34:
      result = aOver;
      break;
    case 35:
      result = aLazy;
      break;
    case 36:
      result = aDog;
      break;
    case 37:
      result = aZeta;
      break;
    case 38:
      result = aUnique;
      break;
    case 40:
      result = aEarl;
      break;
    case 41:
      result = aSleep_0;
      break;
    case 42:
      result = aOnyx;
      break;
    case 43:
      result = aMill;
      break;
    case 44:
      result = aBlue;
      break;
    case 45:
      result = aBelow;
      break;
    case 46:
      result = aScape;
      break;
    case 47:
      result = aReap;
      break;
    case 48:
      result = aDamo;
      break;
    case 49:
      result = aBreak;
      break;
    case 50:
      result = aBoom;
      break;
    case 51:
      result = aThe;
      break;
    default:
      result = aNerd;
      break;
  }
  return result;
}

// FUN_004451b0 @ 0x004451B0
// [binja] void* sub_4451b0()
char *sub_4451B0()
{
  int v0; // ebx
  const char *v1; // ebp
  const char *v2; // edi
  int v3; // edx
  int v4; // esi
  unsigned int v5; // kr04_4
  char *v6; // edx
  char *v8; // [esp+0h] [ebp-8h]
  int v9; // [esp+4h] [ebp-4h]

  if ( !byte_4D7580 )
  {
    j_highscore_load_table();
    v0 = 0;
    v1 = (const char *)&highscore_table;
    v9 = 0;
    v8 = byte_4D1228;
    do
    {
      v2 = byte_4D1228;
      v3 = 0;
      if ( (int)v8 <= (int)byte_4D1228 )
      {
LABEL_6:
        v4 = 0;
        v5 = strlen(v1) + 1;
        if ( (int)(v5 - 1) <= 0 )
        {
LABEL_10:
          v6 = v8;
          v8 += 32;
          ++v0;
          strcpy(v6, v1);
          v9 = v0;
          console_printf((int)&console_log_queue, aDUniqueS, v0, v1);
        }
        else
        {
          while ( crt_isalpha(v1[v4]) || v1[v4] == 46 )
          {
            if ( ++v4 >= (int)(v5 - 1) )
              goto LABEL_10;
          }
        }
      }
      else
      {
        while ( strcmp(v1, v2) )
        {
          v0 = v9;
          ++v3;
          v2 += 32;
          if ( v3 >= v9 )
            goto LABEL_6;
        }
        v0 = v9;
      }
      v1 += 72;
    }
    while ( (int)v1 < (int)quest_selected_meta );
    dword_4D7584 = v0;
    byte_4D7580 = 1;
    if ( !v0 )
      crt_sprintf(byte_4D1228, aQuickbrownfox);
  }
  if ( dword_4D7584 <= 0 )
    return byte_4D1228;
  else
    return &byte_4D1228[32 * (crt_rand() % dword_4D7584)];
}

// FUN_00445310 @ 0x00445310
// [binja] int32_t sub_445310(char* arg1, int32_t arg2)
char __cdecl sub_445310(const char *a1, int a2)
{
  int v2; // edx
  const char *v3; // ebp
  char *v4; // edi

  v2 = 0;
  v3 = (const char *)&unk_4D152C;
  v4 = creature_pool;
  while ( !*v4 || v2 == a2 || strcmp(v3, a1) )
  {
    v4 += 152;
    ++v2;
    v3 += 64;
    if ( (int)v4 >= (int)byte_4AA338 )
      return 1;
  }
  return 0;
}

// creature_name_assign_random @ 0x00445380
// builds a randomized creature name string into DAT_004d152c for debug overlays
int __cdecl sub_445380(int a1)
{
  char *v1; // ebx
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  int result; // eax
  char *v8; // [esp-Ch] [ebp-20h]
  char *v9; // [esp-8h] [ebp-1Ch]
  char *v10; // [esp-8h] [ebp-1Ch]
  char *v11; // [esp-4h] [ebp-18h]
  char *v12; // [esp-4h] [ebp-18h]
  char *v13; // [esp-4h] [ebp-18h]
  int v14; // [esp+10h] [ebp-4h]

  v14 = 0;
  while ( 1 )
  {
    if ( highscore_score_xp > 120 )
    {
      if ( crt_rand() % 100 < 10 )
      {
        v1 = (char *)&unk_4D152C + 64 * a1;
        strcpy(v1, FUN_004451b0());
        goto LABEL_19;
      }
      if ( highscore_score_xp > 120 && crt_rand() % 100 < 80 )
      {
        v1 = (char *)&unk_4D152C + 64 * a1;
        v11 = sub_444F70(0);
        v9 = sub_444F70(0);
        v8 = sub_444F70(0);
        v2 = sub_444F70(1);
        crt_sprintf(v1, "%s%s%s%s", v2, v8, v9, v11);
        goto LABEL_19;
      }
    }
    if ( highscore_score_xp > 80 && crt_rand() % 100 < 80 || highscore_score_xp > 60 && crt_rand() % 100 < 40 )
    {
      v1 = (char *)&unk_4D152C + 64 * a1;
      v12 = sub_444F70(0);
      v10 = sub_444F70(0);
      v3 = sub_444F70(1);
      crt_sprintf(v1, "%s%s%s", v3, v10, v12);
    }
    else if ( highscore_score_xp > 40 && crt_rand() % 100 < 80 || highscore_score_xp > 20 && crt_rand() % 100 < 40 )
    {
      v1 = (char *)&unk_4D152C + 64 * a1;
      v13 = sub_444F70(0);
      v4 = sub_444F70(1);
      crt_sprintf(v1, "%s%s", v4, v13);
    }
    else
    {
      v1 = (char *)&unk_4D152C + 64 * a1;
      v5 = sub_444F70(0);
      crt_sprintf(v1, "%s", v5);
    }
LABEL_19:
    if ( FUN_00445310(v1, a1) )
    {
      result = 0;
      if ( strlen(v1) <= 0xF )
        return result;
      result = v14 + 1;
      if ( v14++ >= 100 )
        return result;
    }
  }
}

// creature_find_by_name @ 0x00445590
// returns the first creature index whose name matches DAT_004d152c, or -1
int __cdecl sub_445590(const char *a1)
{
  int result; // eax
  const char *v2; // ebp
  char *v3; // edi

  result = 0;
  v2 = (const char *)&unk_4D152C;
  v3 = creature_pool;
  while ( !*v3 || strcmp(v2, a1) )
  {
    v3 += 152;
    ++result;
    v2 += 64;
    if ( (int)v3 >= (int)byte_4AA338 )
      return -1;
  }
  return result;
}

// creature_name_draw_labels @ 0x00445600
// debug overlay: draws creature name labels over world positions
char sub_445600()
{
  char *v0; // edi
  float *v1; // esi
  char result; // al
  int v3; // eax
  int v4; // [esp+28h] [ebp-40h]
  float v5; // [esp+28h] [ebp-40h]
  int v6; // [esp+2Ch] [ebp-3Ch]
  int v7; // [esp+30h] [ebp-38h]
  float v8; // [esp+40h] [ebp-28h]
  float v9; // [esp+48h] [ebp-20h]
  float v10; // [esp+4Ch] [ebp-1Ch]
  float v11[2]; // [esp+50h] [ebp-18h] BYREF
  _DWORD v12[3]; // [esp+58h] [ebp-10h] BYREF
  float v13; // [esp+64h] [ebp-4h]

  memset(v12, 0, sizeof(v12));
  v13 = 1.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v4,
    v6,
    v7);
  v0 = (char *)&unk_4D152C;
  v1 = (float *)creature_hitbox_size;
  do
  {
    result = *((_BYTE *)v1 - 16);
    if ( result )
    {
      v3 = (*(int (__thiscall **)(int, char *))(*(_DWORD *)grim_interface_ptr + 332))(grim_interface_ptr, v0);
      if ( *v1 < 0.0 && (v8 = (*v1 + 10.0) * 0.1, v8 <= 1.0) )
      {
        if ( v8 < 0.0 )
          v8 = 0.0;
      }
      else
      {
        v8 = 1.0;
      }
      v9 = *(float *)&camera_offset_x + v1[1] - (double)v3 * 0.5;
      v10 = *(float *)&camera_offset_y + v1[2] - 50.0;
      v13 = v8 * 0.67000002;
      v11[0] = v9 - 4.0;
      v11[1] = v10;
      v5 = (float)(v3 + 8);
      (*(void (__thiscall **)(int, float *, _DWORD, int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 208))(
        grim_interface_ptr,
        v11,
        LODWORD(v5),
        1097859072,
        v12);
      (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        COERCE_FLOAT(LODWORD(v8)));
      result = (*(int (__thiscall **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 324))(
                 grim_interface_ptr,
                 LODWORD(v9),
                 LODWORD(v10),
                 v0);
    }
    v1 += 38;
    v0 += 64;
  }
  while ( (int)v1 < (int)&flt_4AA348 );
  return result;
}

// survival_gameplay_update_and_render @ 0x004457C0
// survival mode frame loop: effects, spawns, death handling, world render, HUD, and debug name input
int sub_4457C0()
{
  int *v0; // ecx
  double v1; // st7
  int v2; // edx
  int v3; // edi
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // ecx
  int v9; // eax
  double v10; // st7
  int v11; // edx
  int v12; // esi
  int v13; // eax
  int v14; // ecx
  double v15; // st7
  int v16; // eax
  int v17; // eax
  int *v18; // eax
  int v19; // ecx
  float v20; // esi
  int v21; // edi
  int v23; // [esp+B0h] [ebp-48h]
  float v24; // [esp+B0h] [ebp-48h]
  int v25; // [esp+B0h] [ebp-48h]
  int v26; // [esp+B0h] [ebp-48h]
  float v27; // [esp+B0h] [ebp-48h]
  int v28; // [esp+B4h] [ebp-44h]
  int v29; // [esp+B4h] [ebp-44h]
  int v30; // [esp+B4h] [ebp-44h]
  int v31; // [esp+B8h] [ebp-40h]
  int v32; // [esp+B8h] [ebp-40h]
  int v33; // [esp+B8h] [ebp-40h]
  int v34[2]; // [esp+C8h] [ebp-30h] BYREF
  int v35; // [esp+D0h] [ebp-28h]
  float v36; // [esp+D4h] [ebp-24h]
  float v37[3]; // [esp+D8h] [ebp-20h] BYREF
  float v38; // [esp+E4h] [ebp-14h]
  float v39; // [esp+E8h] [ebp-10h] BYREF
  float v40; // [esp+ECh] [ebp-Ch]
  float v41; // [esp+F0h] [ebp-8h]
  int v42; // [esp+F4h] [ebp-4h]

  LOBYTE(v34[0]) = 0;
  LOBYTE(v35) = 0;
  if ( (byte_4D1528 & 1) == 0 )
  {
    flt_4D7570 = *(float *)player_pos_x + 128.0;
    flt_4D7574 = *(float *)player_pos_y;
    byte_4D1528 |= 1u;
    crt_atexit(nullsub_71);
  }
  if ( byte_478C94 )
  {
    dword_4D7588 = 0;
    byte_4D14A8[0] = 0;
    byte_478C94 = 0;
  }
  v0 = (int *)grim_interface_ptr;
  v1 = (double)config_screen_height - 128.0;
  byte_4D14A9[dword_4D7588] = 0;
  v2 = *v0;
  v38 = v1;
  if ( (*(unsigned __int8 (__thiscall **)(int *, int))(v2 + 68))(v0, 28) && dword_4D7588 > 0 )
  {
    sfx_play(sfx_ui_typeenter, 1.0);
    v3 = dword_4D7578 + 1;
    byte_4D14A8[dword_4D7588] = 0;
    dword_4D7578 = v3;
    v4 = creature_find_by_name(byte_4D14A8);
    if ( v4 == -1 )
    {
      if ( !strcmp(aReload_0, byte_4D14A8) )
        LOBYTE(v35) = 1;
    }
    else
    {
      LOBYTE(v34[0]) = 1;
      v5 = 19 * v4;
      LODWORD(flt_4D7570) = *(&creature_pos_x + 2 * v5);
      flt_4D7574 = creature_pos_y[2 * v5];
      ++dword_4D757C;
    }
    dword_4D7588 = 0;
    byte_4D14A8[0] = 0;
  }
  v6 = console_input_poll();
  if ( v6 && v6 != 13 )
  {
    if ( v6 == 8 )
    {
      v7 = crt_rand() % 2;
      sfx_play(sfx_ui_typeclick_01 + v7, 1.0);
      if ( dword_4D7588 <= 0 )
        byte_4D14A8[0] = 0;
      else
        byte_4D14A8[--dword_4D7588] = 0;
    }
    else
    {
      v8 = dword_4D7588;
      if ( dword_4D7588 < 17 )
      {
        byte_4D14A8[dword_4D7588] = v6;
        dword_4D7588 = ++v8;
      }
      byte_4D14A8[v8] = 0;
      v9 = crt_rand() % 2;
      sfx_play(sfx_ui_typeclick_01 + v9, 1.0);
    }
  }
  perks_update_effects();
  v36 = frame_dt;
  if ( time_scale_active )
  {
    v10 = frame_dt * 0.30000001;
    time_scale_factor = 1050253722;
    frame_dt = v10;
    frame_dt_ms = (__int64)(v10 * 1000.0);
  }
  effects_update();
  if ( game_state_id == 18 && (creature_update_all(), projectile_update(), game_state_id == 18) )
  {
    v11 = config_player_count;
    for ( render_overlay_player_index = 0; render_overlay_player_index < config_player_count; ++render_overlay_player_index )
    {
      player_fire_weapon((int *)&flt_4D7570, v34[0], v35);
      v11 = config_player_count;
    }
  }
  else
  {
    v11 = config_player_count;
  }
  v12 = 3;
  v13 = frame_dt_ms;
  render_overlay_player_index = 0;
  player_weapon_id[0] = 3;
  player_ammo[0] = 1106247680;
  if ( console_open_flag )
  {
    v14 = survival_spawn_cooldown;
  }
  else
  {
    v14 = survival_spawn_cooldown - frame_dt_ms * v11;
    survival_spawn_cooldown = v14;
  }
  if ( v14 < 0 )
  {
    do
    {
      survival_spawn_cooldown = 3500 - survival_elapsed_ms / 800 + v14;
      if ( survival_spawn_cooldown < 100 )
        survival_spawn_cooldown = 100;
      v42 = 1065353216;
      v35 = survival_elapsed_ms + 1;
      v15 = (double)(survival_elapsed_ms + 1);
      v39 = v15 * 0.0000083333334 + 0.30000001;
      v40 = v15 * 10000.0 + 0.30000001;
      v41 = sin(v15 * 0.0001) + 0.30000001;
      if ( v39 >= 0.0 )
      {
        if ( v39 > 1.0 )
          v39 = 1.0;
      }
      else
      {
        v39 = 0.0;
      }
      if ( v40 >= 0.0 )
      {
        if ( v40 > 1.0 )
          v40 = 1.0;
      }
      else
      {
        v40 = 0.0;
      }
      if ( v41 >= 0.0 )
      {
        if ( v41 > 1.0 )
          v41 = 1.0;
      }
      else
      {
        v41 = 0.0;
      }
      ++dword_4D758C;
      *(float *)v34 = (double)terrain_texture_width + 64.0;
      *(float *)&v34[1] = cos((double)survival_elapsed_ms * 0.001) * 256.0 + (double)terrain_texture_height * 0.5;
      v16 = creature_spawn_tinted((int)v34, (int *)&v39, 4);
      creature_name_assign_random(v16);
      v37[0] = -64.0;
      v37[1] = cos((double)survival_elapsed_ms * 0.001) * 256.0 + (double)terrain_texture_height * 0.5;
      v17 = creature_spawn_tinted((int)v37, (int *)&v39, 2);
      creature_name_assign_random(v17);
      v14 = survival_spawn_cooldown;
    }
    while ( survival_spawn_cooldown < 0 );
    v12 = player_weapon_id[0];
    v13 = frame_dt_ms;
  }
  highscore_score_xp = player_experience[0];
  if ( !console_open_flag )
  {
    bonus_weapon_power_up_timer = 0;
    bonus_reflex_boost_timer = 0.0;
    time_scale_active = 0;
    survival_elapsed_ms += v13;
    dword_48708C[v12] += v13;
  }
  camera_update();
  gameplay_render_world();
  creature_name_draw_labels();
  v18 = bonus_pool;
  do
  {
    *v18 = 0;
    v18 += 7;
  }
  while ( (int)v18 < (int)&quest_spawn_count );
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  if ( !demo_mode_active
    && *(float *)player_health <= 0.0
    && player_death_timer[0] < 0.0
    && (config_player_count == 1 || player2_health[0] <= 0.0 && player2_death_timer < 0.0) )
  {
    render_pass_mode = 0;
    game_state_pending = 7;
    ui_transition_direction = 0;
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
    console_input_poll();
    sfx_mute_all(music_track_extra_0);
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_play_exclusive(music_track_shortie_monk_id);
  }
  frame_dt = v36;
  frame_dt_ms = (__int64)(v36 * 1000.0);
  perk_prompt_update_and_render();
  hud_update_and_render();
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    v23,
    v28,
    v31);
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_48F7C4, 0);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1060320051);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  v24 = v38 - 16.0;
  (*(void (__stdcall **)(int, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    -1082130432,
    LODWORD(v24),
    1127612416,
    1112801280);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v25,
    v29,
    v32);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v26,
    v30,
    v33);
  v19 = *(_DWORD *)grim_interface_ptr;
  v38 = v38 + 1.0;
  v20 = v38;
  (*(void (**)(int, int, float, char *, ...))(v19 + 328))(
    grim_interface_ptr,
    1086324736,
    COERCE_FLOAT(LODWORD(v38)),
    aS_1,
    byte_4D14A8);
  v36 = 1.0;
  if ( sin(flt_47EA4C * 4.0) > 0.0 )
    v36 = 0.40000001;
  (*(void (__thiscall **)(int, int, int, int, float))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    COERCE_FLOAT(LODWORD(v36)));
  v21 = *(_DWORD *)grim_interface_ptr;
  v36 = COERCE_FLOAT(
          (*(int (__thiscall **)(int, char *, float, char *))(*(_DWORD *)grim_interface_ptr + 332))(
            grim_interface_ptr,
            byte_4D14A8,
            COERCE_FLOAT(LODWORD(v20)),
            asc_4712B8));
  v27 = (double)SLODWORD(v36) + 14.0;
  (*(void (__cdecl **)(int, _DWORD))(v21 + 328))(grim_interface_ptr, LODWORD(v27));
  highscore_record_shots_hit = dword_4D757C;
  highscore_record_shots_fired = dword_4D7578;
  return ui_elements_update_and_render();
}

// nullsub_71 @ 0x00445FF0
void __cdecl nullsub_71()
{
  ;
}

// input_any_key_pressed @ 0x00446000
// returns true if any key is down (scans keycodes 2..0x17e)
char sub_446000()
{
  int v0; // esi
  char result; // al

  v0 = 2;
  while ( 1 )
  {
    result = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(grim_interface_ptr, v0);
    if ( result )
      break;
    if ( ++v0 >= 383 )
      return result;
  }
  return 1;
}

// input_primary_just_pressed @ 0x00446030
// edge-detect primary action (mouse button 0 or per-player fire key DAT_00490bec)
char __cdecl sub_446030()
{
  int *v0; // esi
  bool v2; // bl
  int *v3; // esi

  if ( !console_open_flag )
  {
    if ( input_primary_latch )
    {
      v2 = (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 88))(grim_interface_ptr, 0) == 0;
      v3 = &player_fire_key;
      do
      {
        if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
               grim_interface_ptr,
               *v3) )
        {
          v2 = 0;
        }
        v3 += 216;
      }
      while ( (int)v3 < (int)&dword_4912AC );
      if ( v2 )
        input_primary_latch = 0;
    }
    else
    {
      input_primary_latch = (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 88))(
                              grim_interface_ptr,
                              0) != 0;
      v0 = &player_fire_key;
      do
      {
        if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
               grim_interface_ptr,
               *v0) )
        {
          input_primary_latch = 1;
        }
        v0 += 216;
      }
      while ( (int)v0 < (int)&dword_4912AC );
      if ( input_primary_latch )
        return 1;
    }
  }
  return 0;
}

// input_primary_is_down @ 0x004460F0
// returns true while primary action is held (mouse button 0 or primary fire keys)
BOOL sub_4460F0()
{
  return (*(unsigned __int8 (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 88))(grim_interface_ptr, 0)
      || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
           grim_interface_ptr,
           player_fire_key)
      || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
           grim_interface_ptr,
           player_alt_fire_key);
}

// nullsub_72 @ 0x00446140
void nullsub_72()
{
  ;
}

// sub_446150 @ 0x00446150
int __cdecl sub_446150(int a1)
{
  int result; // eax
  int *v2; // ecx

  result = 0;
  v2 = &ui_element_table_end;
  while ( a1 != *v2 )
  {
    ++v2;
    ++result;
    if ( (int)v2 >= (int)byte_48F20C )
      return -1;
  }
  return result;
}

// ui_elements_reset_state @ 0x00446170
// clears active flags and hover timers on all UI elements
int *sub_446170()
{
  int *result; // eax
  _BYTE *v1; // edx

  result = &ui_element_table_end;
  do
  {
    v1 = (_BYTE *)*result++;
    *v1 = 0;
    *(_DWORD *)(*(result - 1) + 760) = 0;
  }
  while ( (int)result < (int)byte_48F20C );
  return result;
}

// ui_elements_max_timeline @ 0x00446190
// returns max timeline value (element +0x10) among active UI elements
int sub_446190()
{
  int result; // eax
  int *v1; // edx

  result = 0;
  v1 = &ui_element_table_end;
  do
  {
    if ( *(_BYTE *)*v1 )
    {
      if ( result < *(_DWORD *)(*v1 + 16) )
        result = *(_DWORD *)(*v1 + 16);
    }
    ++v1;
  }
  while ( (int)v1 < (int)byte_48F20C );
  return result;
}

// game_state_set @ 0x004461C0
// resets UI state, updates game_state_prev/id, and seeds UI elements for the new state
char __cdecl sub_4461C0(int a1)
{
  int v2; // edi
  std::codecvt_base *v3; // ecx
  std::codecvt_base *v4; // ecx
  std::codecvt_base *v5; // ecx
  int i; // esi
  int v7; // edx
  int v8; // edx
  int v9; // eax
  int v10; // eax
  float v11; // edx
  int v12; // edx
  int v13; // edx
  int v14; // eax
  char result; // al
  int v16; // [esp-8h] [ebp-68h]
  int v17; // [esp-4h] [ebp-64h]
  float v18; // [esp+14h] [ebp-4Ch]
  float v19; // [esp+24h] [ebp-3Ch]
  float v20; // [esp+34h] [ebp-2Ch]
  float v21; // [esp+44h] [ebp-1Ch]
  _BYTE v22[16]; // [esp+50h] [ebp-10h] BYREF
  int v23; // [esp+64h] [ebp+4h]

  ui_elements_reset_state();
  v2 = 0;
  game_paused_flag = 0;
  game_state_prev = game_state_id;
  game_state_id = a1;
  dword_487238 = 0;
  byte_487241 = 0;
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
  console_input_poll();
  switch ( a1 )
  {
    case 0:
      byte_48724D = 0;
      render_pass_mode = 0;
      byte_487290 = 1;
      if ( game_is_full_version(v3) && mods_any_available() )
        byte_488208 = 1;
      if ( game_is_full_version(v4) )
        dword_48823C = (int)sub_447350;
      else
        byte_488208 = 1;
      v23 = 0;
      for ( i = 2; i <= 7; ++i )
      {
        if ( i == 2 && game_is_full_version(v5) )
        {
          v2 = 4;
          v23 = 4;
        }
        if ( *(_BYTE *)(*(int (__thiscall **)(int, _BYTE *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                         grim_interface_ptr,
                         v22,
                         100) )
        {
          *(_DWORD *)(ui_element_table_end[i] + 516) = dword_48F7F4;
          v12 = ui_element_table_end[i];
          *(_DWORD *)(v12 + 312) = 0;
          v20 = (double)v23 * 0.125;
          *(float *)(v12 + 316) = v20;
          v13 = ui_element_table_end[i];
          *(_DWORD *)(v13 + 340) = 1065353216;
          *(float *)(v13 + 344) = v20;
          v14 = ui_element_table_end[i];
          *(_DWORD *)(v14 + 368) = 1065353216;
          v5 = 0;
          v21 = (double)(v2 + 1) * 0.125;
          *(float *)(v14 + 372) = v21;
          v10 = ui_element_table_end[i];
          v11 = v21;
          *(_DWORD *)(v10 + 396) = 0;
        }
        else
        {
          if ( i == 6 )
          {
            v2 = 6;
            v23 = 6;
          }
          *(_DWORD *)(ui_element_table_end[i] + 516) = dword_48F7F4;
          v7 = ui_element_table_end[i];
          *(_DWORD *)(v7 + 312) = 0;
          v18 = (double)v23 * 0.125;
          *(float *)(v7 + 316) = v18;
          v8 = ui_element_table_end[i];
          *(_DWORD *)(v8 + 340) = 1065353216;
          *(float *)(v8 + 344) = v18;
          v9 = ui_element_table_end[i];
          *(_DWORD *)(v9 + 368) = 1065353216;
          v5 = 0;
          v19 = (double)(v2 + 1) * 0.125;
          *(float *)(v9 + 372) = v19;
          v10 = ui_element_table_end[i];
          v11 = v19;
          *(_DWORD *)(v10 + 396) = 0;
        }
        *(float *)(v10 + 400) = v11;
        if ( i == 2 && game_is_full_version(0) )
          v2 = 0;
        v23 = ++v2;
        if ( v2 == 4 )
        {
          v2 = 5;
          v23 = 5;
        }
      }
      if ( !game_is_full_version(v5) )
        byte_488208 = 1;
      byte_4878C0 = 1;
      byte_487BD8 = 1;
      byte_487EF0 = 1;
      byte_488520 = *(_BYTE *)(*(int (__thiscall **)(int, _BYTE *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                                grim_interface_ptr,
                                v22,
                                100) != 0;
      byte_488838 = 1;
      break;
    case 22:
      render_pass_mode = 0;
      byte_487292 = 0;
      break;
    case 9:
      byte_48EB38 = 1;
      byte_48702C = 0;
      if ( !render_pass_mode )
      {
        byte_48724D = 0;
        gameplay_reset_state();
        switch ( config_game_mode )
        {
          case 3:
            v17 = quest_stage_minor;
            v16 = *(_DWORD *)quest_stage_major;
            ++quest_play_counts[10 * *(_DWORD *)quest_stage_major + quest_stage_minor];
            quest_start_selected(v16, v17);
            render_pass_mode = 1;
            byte_487241 = 1;
            break;
          case 2:
            render_pass_mode = 1;
            byte_487241 = 1;
            ++dword_485788;
            break;
          case 1:
            render_pass_mode = 1;
            byte_487241 = 1;
            ++dword_485784;
            break;
          default:
            render_pass_mode = 1;
            byte_487241 = 1;
            if ( config_game_mode == 4 )
              ++dword_48578C;
            else
              ++dword_485790;
            break;
        }
      }
      break;
    case 18:
      config_player_count = 1;
      byte_478C94 = 1;
      byte_48EB38 = 1;
      byte_48702C = 0;
      if ( !render_pass_mode )
      {
        byte_48724D = 0;
        gameplay_reset_state();
        render_pass_mode = 1;
        byte_487241 = 1;
      }
      break;
    case 1:
      byte_487290 = 1;
      byte_489498 = 1;
      byte_4897B0 = 1;
      break;
    case 2:
      if ( !byte_4824D1 )
        byte_487290 = 1;
      byte_488B50 = 1;
      dword_48CF78 = -1033371648;
      byte_488E68 = 1;
      dword_487234 = 0;
      *(float *)&dword_48CF7C = (double)*(int *)config_screen_width * 0.0015625 * 150.0 + 10.0 - 150.0 + 135.0;
      break;
    case 4:
      byte_48724D = 0;
      byte_487290 = 1;
      byte_48E820 = 1;
      dword_48E858 = (int)sub_43F550;
      break;
    case 13:
      byte_487290 = 1;
      byte_489DE0 = 1;
      dword_489E18 = (int)nullsub_72;
LABEL_56:
      j_highscore_load_table();
      break;
    case 3:
      byte_487290 = 1;
      dword_48CF78 = -1020002304;
      byte_48D278 = 1;
      byte_48D590 = 1;
      byte_48EE50 = 1;
      *(float *)&dword_48CF7C = (double)*(int *)config_screen_width * 0.0015625 * 150.0 - 150.0 + 139.0;
      break;
    case 14:
      byte_487290 = 1;
      byte_489DE0 = 1;
      byte_48A0F8 = 1;
      dword_489E18 = (int)sub_4423D0;
      goto LABEL_56;
  }
  dword_48A130 = 0;
  switch ( a1 )
  {
    case 19:
      byte_487290 = 1;
      byte_489DE0 = 1;
      break;
    case 26:
      byte_487290 = 1;
      byte_489DE0 = 1;
      dword_489E18 = (int)credits_secret_alien_zookeeper_update;
      break;
    case 20:
      byte_487290 = 1;
      byte_489DE0 = 1;
      dword_489E18 = (int)sub_40E9A0;
      break;
    case 15:
      byte_487290 = 1;
      byte_489DE0 = 1;
      byte_48A0F8 = 1;
      dword_489E18 = (int)sub_440110;
      break;
    case 16:
      byte_487290 = 1;
      byte_489DE0 = 1;
      byte_48A0F8 = 1;
      dword_489E18 = (int)sub_440960;
      break;
    case 17:
      dword_487234 = 0;
      byte_487290 = 1;
      byte_489DE0 = 1;
      dword_489E18 = (int)credits_screen_update;
      break;
    case 11:
      byte_487290 = 1;
      byte_48E1F0 = 1;
      break;
    case 5:
      if ( !byte_4824D1 )
        byte_487290 = 1;
      byte_487292 = 0;
      byte_48B9B8 = 1;
      byte_48BCD0 = 1;
      byte_48BFE8 = 1;
      break;
    default:
      switch ( a1 )
      {
        case 6:
          byte_48C618 = 1;
          goto LABEL_86;
        case 8:
          byte_48DBC0 = 1;
          game_save_status();
          dword_487234 = -2;
          goto LABEL_86;
        case 21:
          byte_48DBC0 = 1;
          break;
        case 12:
          byte_48DBC0 = 1;
          break;
        case 7:
          byte_48CC48 = 1;
          dword_487260 = 0;
          break;
        default:
          goto LABEL_86;
      }
      dword_487234 = -1;
      break;
  }
LABEL_86:
  result = byte_48724D;
  if ( byte_48724D )
    byte_487290 = 0;
  ui_elements_timeline = 0;
  ui_transition_direction = 1;
  return result;
}

// ui_element_update @ 0x00446900
// updates hover/click/animation for a UI element and fires callbacks
void __cdecl sub_446900(int a1)
{
  char v2; // al
  int *v3; // ecx
  int v4; // eax
  char v5; // cl
  int v6; // ecx
  int v7; // eax
  int v8; // edx
  int v9; // eax
  double v10; // st7
  double v11; // st6
  char v12; // al
  double v13; // st7
  long double v14; // st7
  long double v15; // st6
  float v16; // [esp+18h] [ebp+4h]

  if ( !*(_BYTE *)(a1 + 2) && *(_BYTE *)a1 )
  {
    if ( ui_mouse_x <= (double)*(float *)(a1 + 32)
      || ui_mouse_y <= (double)*(float *)(a1 + 36)
      || ui_mouse_x >= (double)*(float *)(a1 + 40)
      || ui_mouse_y >= (double)*(float *)(a1 + 44)
      || ui_mouse_blocked
      || byte_4871CA )
    {
      *(_BYTE *)(a1 + 756) = 0;
    }
    else
    {
      v2 = *(_BYTE *)(a1 + 1);
      *(_BYTE *)(a1 + 756) = 1;
      if ( v2 && *(_DWORD *)(a1 + 52) )
      {
        dword_48723C = a1;
        dword_487238 = 0;
        v3 = ui_element_table_end;
        do
        {
          v4 = *v3;
          if ( *(_BYTE *)(*v3 + 1) && (game_state_id || *(_DWORD *)(v4 + 52)) )
          {
            if ( a1 == v4 )
              break;
            ++dword_487238;
          }
          ++v3;
        }
        while ( (int)v3 < (int)byte_48F20C );
      }
    }
    *(_DWORD *)(a1 + 764) += frame_dt_ms;
    v5 = *(_BYTE *)(a1 + 756);
    if ( v5 )
      *(_DWORD *)(a1 + 760) += 6 * frame_dt_ms;
    else
      *(_DWORD *)(a1 + 760) += -2 * frame_dt_ms;
    if ( *(int *)(a1 + 760) < 0 )
      *(_DWORD *)(a1 + 760) = 0;
    if ( *(int *)(a1 + 760) > 1000 )
      *(_DWORD *)(a1 + 760) = 1000;
    if ( *(_DWORD *)(a1 + 52) && *(int *)(a1 + 764) >= 255 && v5 && input_primary_just_pressed() )
    {
      sfx_play(sfx_ui_buttonclick, 1.0);
      (*(void (**)(void))(a1 + 52))();
    }
    v6 = *(_DWORD *)(a1 + 16);
    if ( ui_elements_timeline < v6 )
    {
      v8 = *(_DWORD *)(a1 + 20);
      if ( ui_elements_timeline < v8 )
      {
        v12 = *(_BYTE *)(a1 + 788);
        v16 = 1.5707964;
        v13 = *(float *)(a1 + 60) - *(float *)(a1 + 88);
        *(_DWORD *)(a1 + 12) = 0;
        if ( v12 )
          *(float *)(a1 + 8) = fabs(v13);
        else
          *(float *)(a1 + 8) = -fabs(v13);
      }
      else
      {
        v9 = ui_elements_timeline - v8;
        *(_DWORD *)(a1 + 12) = 0;
        v10 = (double)(v6 - v8);
        v16 = 1.5707964 - (double)v9 * 1.5707964 / v10;
        if ( *(_BYTE *)(a1 + 788) )
          v11 = (1.0 - ((double)ui_elements_timeline - (double)v8) / v10)
              * fabs(*(float *)(a1 + 60) - *(float *)(a1 + 88));
        else
          v11 = -((1.0 - ((double)ui_elements_timeline - (double)v8) / v10)
                * fabs(*(float *)(a1 + 60) - *(float *)(a1 + 88)));
        *(float *)(a1 + 8) = v11;
      }
    }
    else
    {
      if ( !*(_BYTE *)(a1 + 1) )
      {
        sfx_play(sfx_ui_panelclick, 1.0);
        *(_BYTE *)(a1 + 1) = 1;
      }
      v7 = *(_DWORD *)(a1 + 764);
      if ( v7 <= 255 )
        *(_DWORD *)(a1 + 764) = frame_dt_ms + v7;
      *(_DWORD *)(a1 + 8) = 0;
      v16 = 0.0;
      *(_DWORD *)(a1 + 12) = 0;
    }
    if ( !sub_446150(a1) )
      v16 = -COERCE_FLOAT(LODWORD(v16) & 0x7FFFFFFF);
    if ( ui_elements_timeline < *(_DWORD *)(a1 + 16) )
    {
      if ( *(_BYTE *)(a1 + 1) )
        *(_BYTE *)(a1 + 1) = 0;
    }
    v14 = cos(v16);
    *(float *)(a1 + 772) = v14;
    v15 = sin(v16);
    *(float *)(a1 + 776) = -v15;
    *(float *)(a1 + 780) = v15;
    *(float *)(a1 + 784) = v14;
  }
}

// ui_element_render @ 0x00446C40
// updates focus/click handling and renders a UI element
void __cdecl sub_446C40(int a1)
{
  int v1; // esi
  bool v2; // bl
  void (*v3)(void); // eax
  _BYTE *v4; // eax
  int v5; // ecx
  int v6; // edi
  int v7; // ebx
  int v8; // eax
  int v9; // eax
  double v10; // st7
  double v11; // st7
  double v12; // st7
  int v13; // eax
  int v14; // ecx
  int v15; // edi
  char v16; // al
  int v17; // eax
  void (*v18)(void); // esi
  int v19; // [esp+F4h] [ebp-38h]
  int v20; // [esp+F4h] [ebp-38h]
  int v21; // [esp+F4h] [ebp-38h]
  int v22; // [esp+F4h] [ebp-38h]
  int v23; // [esp+F4h] [ebp-38h]
  int v24; // [esp+F4h] [ebp-38h]
  int v25; // [esp+F4h] [ebp-38h]
  int v26; // [esp+F8h] [ebp-34h]
  int v27; // [esp+F8h] [ebp-34h]
  int v28; // [esp+F8h] [ebp-34h]
  int v29; // [esp+F8h] [ebp-34h]
  int v30; // [esp+F8h] [ebp-34h]
  int v31; // [esp+F8h] [ebp-34h]
  int v32; // [esp+F8h] [ebp-34h]
  int v33; // [esp+FCh] [ebp-30h]
  int v34; // [esp+FCh] [ebp-30h]
  int v35; // [esp+FCh] [ebp-30h]
  int v36; // [esp+FCh] [ebp-30h]
  int v37; // [esp+FCh] [ebp-30h]
  int v38; // [esp+FCh] [ebp-30h]
  int v39; // [esp+FCh] [ebp-30h]
  float v40; // [esp+10Ch] [ebp-20h] BYREF
  float v41; // [esp+110h] [ebp-1Ch]
  float v42; // [esp+118h] [ebp-14h]
  _DWORD v43[4]; // [esp+11Ch] [ebp-10h] BYREF

  v1 = a1;
  v2 = 0;
  if ( !*(_BYTE *)a1 )
    return;
  if ( *(float *)(a1 + 768) == 0.0 && *(float *)(dword_48088C + 12) != 0.0 )
    (*(void (__thiscall **)(int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(grim_interface_ptr, 21, 1);
  if ( *(_DWORD *)(v1 + 52) )
  {
    if ( (int *)v1 != byte_48F20C )
    {
      v2 = ui_focus_update(v1);
      if ( v2 )
      {
        if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28) )
        {
          if ( !console_open_flag )
          {
            if ( *(_BYTE *)(v1 + 1) )
            {
              v3 = *(void (**)(void))(v1 + 52);
              if ( v3 )
                v3();
            }
          }
        }
      }
    }
  }
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  if ( *(_DWORD *)(v1 + 516) != -1 )
  {
    if ( v2 && dword_4D11EC > 0 )
      *(_DWORD *)(v1 + 760) = dword_4D11EC;
    if ( *(_DWORD *)(v1 + 52) )
    {
      v6 = v1 + 311;
      v7 = 4;
      do
      {
        v6 += 28;
        --v7;
        *(_BYTE *)(v6 - 28) = 155 * *(_DWORD *)(v1 + 760) / 1000 + 100;
      }
      while ( v7 );
    }
    else
    {
      v4 = (_BYTE *)(v1 + 311);
      v5 = 4;
      do
      {
        *v4 = -56;
        v4 += 28;
        --v5;
      }
      while ( v5 );
    }
  }
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    v19,
    v26,
    v33);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    6,
    v20,
    v27,
    v34);
  v8 = *(_DWORD *)(v1 + 284);
  if ( v8 != -1 )
  {
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, v8, 0);
    v9 = *(_DWORD *)(v1 + 4);
    a1 = 1145324612;
    if ( !v9 )
    {
      if ( config_fx_detail_flag0 )
      {
        (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
          grim_interface_ptr,
          19,
          1,
          v21,
          v28,
          v35);
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
        v40 = *(float *)(v1 + 24) + 7.0;
        v41 = *(float *)(v1 + 28) + 7.0;
        (*(void (__thiscall **)(int, int, int, float *, int, int *))(*(_DWORD *)grim_interface_ptr + 308))(
          grim_interface_ptr,
          v1 + 60,
          4,
          &v40,
          v1 + 772,
          &a1);
        if ( *(_DWORD *)(v1 + 288) == 8 )
        {
          v40 = *(float *)(v1 + 24) + 7.0;
          v41 = *(float *)(v1 + 28) + 7.0;
          (*(void (__thiscall **)(int, int, int, float *, int, int *))(*(_DWORD *)grim_interface_ptr + 308))(
            grim_interface_ptr,
            v1 + 116,
            4,
            &v40,
            v1 + 772,
            &a1);
          v40 = *(float *)(v1 + 24) + 7.0;
          v41 = *(float *)(v1 + 28) + 7.0;
          (*(void (__thiscall **)(int, int, int, float *, int, int *))(*(_DWORD *)grim_interface_ptr + 308))(
            grim_interface_ptr,
            v1 + 172,
            4,
            &v40,
            v1 + 772,
            &a1);
        }
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      }
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v21,
        v28,
        v35);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 296))(
        grim_interface_ptr,
        v1 + 60,
        4,
        v1 + 24,
        v1 + 772);
      if ( *(_DWORD *)(v1 + 288) == 8 )
      {
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 296))(
          grim_interface_ptr,
          v1 + 116,
          4,
          v1 + 24,
          v1 + 772);
        (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 296))(
          grim_interface_ptr,
          v1 + 172,
          4,
          v1 + 24,
          v1 + 772);
      }
LABEL_38:
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      goto LABEL_39;
    }
    if ( v9 == 1 )
    {
      if ( config_fx_detail_flag0 )
      {
        (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
          grim_interface_ptr,
          19,
          1,
          v21,
          v28,
          v35);
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
        v10 = *(float *)(v1 + 24) + 7.0;
        v42 = *(float *)(v1 + 28) + 7.0;
        v40 = v10 + *(float *)(v1 + 8);
        v41 = v42 + *(float *)(v1 + 12);
        (*(void (__thiscall **)(int, int, int, float *, int *))(*(_DWORD *)grim_interface_ptr + 304))(
          grim_interface_ptr,
          v1 + 60,
          4,
          &v40,
          &a1);
        if ( *(_DWORD *)(v1 + 288) == 8 )
        {
          v11 = *(float *)(v1 + 24) + 7.0;
          v42 = *(float *)(v1 + 28) + 7.0;
          v40 = v11 + *(float *)(v1 + 8);
          v41 = v42 + *(float *)(v1 + 12);
          (*(void (__thiscall **)(int, int, int, float *, int *))(*(_DWORD *)grim_interface_ptr + 304))(
            grim_interface_ptr,
            v1 + 116,
            4,
            &v40,
            &a1);
          v12 = *(float *)(v1 + 24) + 7.0;
          v42 = *(float *)(v1 + 28) + 7.0;
          v40 = v12 + *(float *)(v1 + 8);
          v41 = v42 + *(float *)(v1 + 12);
          (*(void (__thiscall **)(int, int, int, float *, int *))(*(_DWORD *)grim_interface_ptr + 304))(
            grim_interface_ptr,
            v1 + 172,
            4,
            &v40,
            &a1);
        }
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      }
      (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
        grim_interface_ptr,
        19,
        5,
        v21,
        v28,
        v35);
      (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
      v40 = *(float *)(v1 + 8) + *(float *)(v1 + 24);
      v41 = *(float *)(v1 + 12) + *(float *)(v1 + 28);
      (*(void (__thiscall **)(int, int, int, float *))(*(_DWORD *)grim_interface_ptr + 300))(
        grim_interface_ptr,
        v1 + 60,
        4,
        &v40);
      if ( *(_DWORD *)(v1 + 288) == 8 )
      {
        v40 = *(float *)(v1 + 8) + *(float *)(v1 + 24);
        v41 = *(float *)(v1 + 12) + *(float *)(v1 + 28);
        (*(void (__thiscall **)(int, int, int, float *))(*(_DWORD *)grim_interface_ptr + 300))(
          grim_interface_ptr,
          v1 + 116,
          4,
          &v40);
        v40 = *(float *)(v1 + 8) + *(float *)(v1 + 24);
        v41 = *(float *)(v1 + 12) + *(float *)(v1 + 28);
        (*(void (__thiscall **)(int, int, int, float *))(*(_DWORD *)grim_interface_ptr + 300))(
          grim_interface_ptr,
          v1 + 172,
          4,
          &v40);
      }
      goto LABEL_38;
    }
  }
LABEL_39:
  v13 = *(_DWORD *)(v1 + 516);
  if ( v13 != -1 )
  {
    (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, v13, 0);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    if ( *(_DWORD *)(v1 + 4) )
    {
      v40 = *(float *)(v1 + 8) + *(float *)(v1 + 24);
      v41 = *(float *)(v1 + 12) + *(float *)(v1 + 28);
      (*(void (__thiscall **)(int, int, int, float *))(*(_DWORD *)grim_interface_ptr + 300))(
        grim_interface_ptr,
        v1 + 292,
        4,
        &v40);
    }
    else
    {
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 296))(
        grim_interface_ptr,
        v1 + 292,
        4,
        v1 + 24,
        v1 + 772);
    }
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  }
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    v21,
    v28,
    v35);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    2,
    v22,
    v29,
    v36);
  if ( *(_DWORD *)(v1 + 764) < 0x100u )
  {
    v14 = v1 + 543;
    v15 = 4;
    do
    {
      v14 += 28;
      *(_BYTE *)(v14 - 260) = -1 - *(_DWORD *)(v1 + 764) / 2;
      --v15;
      *(_BYTE *)(v14 - 28) = -1 - *(_DWORD *)(v1 + 764) / 2;
    }
    while ( v15 );
  }
  v43[0] = *(_DWORD *)(v1 + 772);
  v43[1] = *(_DWORD *)(v1 + 776);
  v43[2] = *(_DWORD *)(v1 + 780);
  v16 = *(_BYTE *)(v1 + 1);
  v43[3] = *(_DWORD *)(v1 + 784);
  if ( v16 )
  {
    v17 = *(_DWORD *)(v1 + 516);
    if ( v17 != -1 )
    {
      if ( *(_DWORD *)(v1 + 52) )
      {
        (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, v17, 0);
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
        (*(void (__thiscall **)(int, int, int, int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 296))(
          grim_interface_ptr,
          v1 + 292,
          4,
          v1 + 24,
          v43);
        (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
      }
    }
  }
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    19,
    5,
    v23,
    v30,
    v37);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    20,
    6,
    v24,
    v31,
    v38);
  v18 = *(void (**)(void))(v1 + 56);
  if ( v18 )
    v18();
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v25,
    v32,
    v39);
}

// sub_447350 @ 0x00447350
void sub_447350()
{
  ui_transition_direction = 0;
  game_state_pending = 20;
}

// sub_447370 @ 0x00447370
void sub_447370()
{
  ui_transition_direction = 0;
  game_state_pending = 2;
}

// sub_447390 @ 0x00447390
void sub_447390()
{
  ui_transition_direction = 0;
  game_state_pending = 4;
  sfx_mute_all(music_track_crimson_theme_id);
  sfx_mute_all(music_track_shortie_monk_id);
  sfx_mute_all(music_track_extra_0);
  sfx_play_exclusive(music_track_shortie_monk_id);
}

// FUN_004473e0 @ 0x004473E0
// [binja] int32_t sub_4473e0()
void sub_4473E0()
{
  ui_transition_direction = 0;
  game_state_pending = 3;
}

// sub_447400 @ 0x00447400
void sub_447400()
{
  ui_transition_direction = 0;
  game_state_pending = 1;
}

// FUN_00447420 @ 0x00447420
// [binja] int32_t sub_447420()
char sub_447420()
{
  int v0; // eax

  LOBYTE(v0) = byte_4824D1;
  ui_transition_direction = 0;
  if ( byte_4824D1 )
  {
    game_state_pending = 5;
  }
  else
  {
    v0 = render_pass_mode != 0 ? 5 : 0;
    game_state_pending = v0;
  }
  return v0;
}

// sub_447450 @ 0x00447450
char sub_447450()
{
  game_state_pending = 10;
  byte_487292 = 0;
  ui_transition_direction = 0;
  sfx_mute_all(music_track_crimson_theme_id);
  sfx_mute_all(music_track_extra_0);
  return sfx_mute_all(music_track_shortie_monk_id);
}

// sub_447490 @ 0x00447490
int sub_447490()
{
  int result; // eax

  if ( plugin_interface_ptr )
    *(_BYTE *)(plugin_interface_ptr + 9) = 0;
  byte_487292 = 0;
  ui_transition_direction = 0;
  game_state_pending = byte_4824D1 != 0 ? 22 : 9;
  result = config_game_mode;
  if ( config_game_mode == 4 )
    game_state_pending = 18;
  return result;
}

// sub_4474E0 @ 0x004474E0
void sub_4474E0()
{
  if ( plugin_interface_ptr )
  {
    *(_BYTE *)(plugin_interface_ptr + 9) = 0;
    byte_4824D1 = 0;
    (*(void (__thiscall **)(int))(*(_DWORD *)plugin_interface_ptr + 4))(plugin_interface_ptr);
    sfx_mute_all(music_track_extra_0);
    plugin_interface_ptr = 0;
    FreeLibrary(hLibModule);
    hLibModule = 0;
    byte_471304 = 1;
    game_state_pending = 20;
  }
  else
  {
    game_state_pending = 0;
  }
  ui_transition_direction = 0;
  render_pass_mode = 0;
  sfx_mute_all(music_track_crimson_theme_id);
  sfx_mute_all(music_track_shortie_monk_id);
  sfx_mute_all(music_track_extra_0);
  sfx_play_exclusive(music_track_crimson_theme_id);
}

// FUN_00447580 @ 0x00447580
// [binja] int32_t sub_447580()
char sub_447580()
{
  char result; // al

  result = config_detail_preset - 1;
  switch ( config_detail_preset )
  {
    case 1:
      config_fx_detail_flag2 = 0;
      goto LABEL_3;
    case 2:
LABEL_3:
      config_fx_detail_flag0 = 0;
      config_fx_detail_flag1 = 0;
      break;
    case 3:
    case 4:
    case 5:
      config_fx_detail_flag1 = 1;
      config_fx_detail_flag2 = 1;
      config_fx_detail_flag0 = 1;
      result = 1;
      break;
    default:
      return result;
  }
  return result;
}

// sub_4475D0 @ 0x004475D0
char sub_4475D0()
{
  int v0; // edx
  int v1; // edx
  double v2; // st7
  int v3; // edx
  int v4; // eax
  char result; // al
  int v6; // [esp+6Ch] [ebp-30h]
  int v7; // [esp+6Ch] [ebp-30h]
  int v8; // [esp+70h] [ebp-2Ch]
  int v9; // [esp+70h] [ebp-2Ch]
  float v10; // [esp+70h] [ebp-2Ch]
  float v11; // [esp+70h] [ebp-2Ch]
  float v12; // [esp+70h] [ebp-2Ch]
  float v13; // [esp+70h] [ebp-2Ch]
  int v14; // [esp+74h] [ebp-28h]
  int v15; // [esp+74h] [ebp-28h]
  float v16[2]; // [esp+84h] [ebp-18h] BYREF
  float v17; // [esp+8Ch] [ebp-10h]
  float v18; // [esp+90h] [ebp-Ch]
  float v19; // [esp+94h] [ebp-8h] BYREF
  float v20; // [esp+98h] [ebp-4h]

  v20 = *(float *)&dword_488B6C + flt_488B90;
  v0 = *(_DWORD *)grim_interface_ptr;
  v17 = flt_488B8C + *(float *)&dword_488B68 + 300.0;
  v18 = v20 + 40.0;
  v16[0] = flt_488B58 - 24.0 - 64.0 + v17;
  v17 = v16[0];
  (*(void (__thiscall **)(int, int, int, int, int))(v0 + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_48F7F4, 0);
  (*(void (__thiscall **)(int, _DWORD, int, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    1048576000,
    1065353216,
    1052770304);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    v6,
    v8,
    v14);
  (*(void (__thiscall **)(int, _DWORD, float, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    grim_interface_ptr,
    LODWORD(v16[0]),
    COERCE_FLOAT(LODWORD(v18)),
    1124073472,
    1107296256);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v7,
    v9,
    v15);
  v1 = *(_DWORD *)grim_interface_ptr;
  v17 = v16[0] + 8.0;
  v18 = v18 + 2.0;
  (*(void (__thiscall **)(int, int, int, int, int))(v1 + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1061997773);
  v10 = v18 + 45.0;
  (*(void (__cdecl **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v17)),
    LODWORD(v10),
    aSoundVolume);
  v11 = v18 + 65.0;
  (*(void (__cdecl **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v17)),
    LODWORD(v11),
    aMusicVolume);
  v12 = v18 + 85.0;
  (*(void (__cdecl **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v17)),
    LODWORD(v12),
    aGraphicsDetail);
  v13 = v18 + 105.0;
  (*(void (__cdecl **)(int, float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v17)),
    LODWORD(v13),
    aMouseSensitivi);
  if ( (byte_4D79A0 & 1) == 0 )
  {
    byte_4D77E0 = 0;
    byte_4D79A0 |= 1u;
    byte_4D77E1 = 0;
    byte_4D77E2 = 0;
    dword_4D77E4 = 0;
    crt_atexit(nullsub_78);
  }
  v16[0] = v17;
  dword_4D77E4 = (int)aUiInfoTexts;
  byte_4D77E0 = config_full_version;
  v16[1] = v18 + 133.0;
  ui_checkbox_update(v16, (int)&byte_4D77E0);
  config_full_version = byte_4D77E0;
  v17 = v17 - 18.0;
  v18 = v18 - 2.0;
  if ( (byte_4D79A0 & 2) == 0 )
  {
    byte_4D7804 = 1;
    byte_4D79A0 |= 2u;
    byte_4D7805 = 0;
    dword_4D77F8 = 0;
    dword_4D77FC = 10;
    dword_4D7800 = 0;
    crt_atexit(nullsub_77);
  }
  dword_4D77F8 = (__int64)(config_sfx_volume * 10.0);
  v16[0] = v17 + 148.0;
  v19 = v16[0];
  v20 = v18 + 47.0;
  FUN_0043d9b0((int)&v19, (int)&dword_4D77F8);
  config_sfx_volume = (double)dword_4D77F8 * 0.1;
  if ( (byte_4D79A0 & 4) == 0 )
  {
    byte_4D75F4 = 1;
    byte_4D79A0 |= 4u;
    byte_4D75F5 = 0;
    dword_4D75E8 = 0;
    dword_4D75EC = 10;
    dword_4D75F0 = 0;
    crt_atexit(nullsub_76);
  }
  v20 = v18 + 67.0;
  dword_4D75E8 = (__int64)(config_music_volume * 10.0);
  v19 = v16[0];
  FUN_0043d9b0((int)&v19, (int)&dword_4D75E8);
  config_music_volume = (double)dword_4D75E8 * 0.1;
  if ( (byte_4D79A0 & 8) == 0 )
  {
    byte_4D759C = 1;
    byte_4D79A0 |= 8u;
    byte_4D759D = 0;
    dword_4D7590 = 0;
    dword_4D7594 = 10;
    dword_4D7598 = 0;
    crt_atexit(nullsub_75);
  }
  v20 = v18 + 87.0;
  dword_4D7594 = 5;
  dword_4D7598 = 1;
  dword_4D7590 = config_detail_preset;
  v19 = v16[0];
  FUN_0043d9b0((int)&v19, (int)&dword_4D7590);
  config_detail_preset = dword_4D7590;
  if ( dword_4D7590 >= 1 )
  {
    if ( dword_4D7590 > 5 )
      config_detail_preset = 5;
  }
  else
  {
    config_detail_preset = 1;
  }
  FUN_00447580();
  if ( (byte_4D79A0 & 0x10) == 0 )
  {
    byte_4D768C = 1;
    byte_4D79A0 |= 0x10u;
    byte_4D768D = 0;
    dword_4D7680 = 0;
    dword_4D7684 = 10;
    dword_4D7688 = 0;
    crt_atexit(nullsub_74);
  }
  dword_4D7684 = 10;
  dword_4D7688 = 1;
  dword_4D7680 = (__int64)(flt_4807BC * 10.0 + 0.5);
  v20 = v18 + 107.0;
  v19 = v16[0];
  FUN_0043d9b0((int)&v19, (int)&dword_4D7680);
  v2 = (double)dword_4D7680 * 0.1;
  flt_4807BC = v2;
  if ( v2 >= 0.1 )
  {
    if ( flt_4807BC > 1.0 )
      flt_4807BC = 1.0;
  }
  else
  {
    flt_4807BC = 0.1;
  }
  if ( (byte_4D79A0 & 0x20) == 0 )
  {
    byte_4D798E = 1;
    byte_4D79A0 |= 0x20u;
    byte_4D799D = 0;
    byte_4D799C = 0;
    dword_4D7998 = 1065353216;
    dword_4D7994 = 0;
    dword_4D7988 = 0;
    byte_4D798C = 0;
    byte_4D798D = 0;
    dword_4D7990 = 0;
    crt_atexit(nullsub_73);
  }
  dword_4D7988 = (int)aControls;
  v19 = v17 + 10.0;
  v20 = v18 + 155.0;
  ui_button_update(&v19, (int)&dword_4D7988);
  if ( config_fx_toggle )
  {
    v3 = dword_4C364C;
    v4 = 5 * perk_id_bloody_mess_quick_learner;
    perk_name_table[5 * perk_id_bloody_mess_quick_learner] = dword_4C3644;
  }
  else
  {
    v3 = dword_4C3648;
    v4 = 5 * perk_id_bloody_mess_quick_learner;
    perk_name_table[5 * perk_id_bloody_mess_quick_learner] = dword_4C3640;
  }
  perk_desc_table[v4] = v3;
  if ( byte_4D798D )
    FUN_004473e0();
  result = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 1);
  if ( result )
    return FUN_00447420();
  return result;
}

// nullsub_73 @ 0x00447C30
void __cdecl nullsub_73()
{
  ;
}

// nullsub_74 @ 0x00447C40
void __cdecl nullsub_74()
{
  ;
}

// nullsub_75 @ 0x00447C50
void __cdecl nullsub_75()
{
  ;
}

// nullsub_76 @ 0x00447C60
void __cdecl nullsub_76()
{
  ;
}

// nullsub_77 @ 0x00447C70
void __cdecl nullsub_77()
{
  ;
}

// nullsub_78 @ 0x00447C80
void __cdecl nullsub_78()
{
  ;
}

// FUN_00447c90 @ 0x00447C90
// [binja] int32_t sub_447c90(int32_t arg1)
char *__cdecl sub_447C90(int a1)
{
  char *result; // eax

  switch ( a1 )
  {
    case 0:
      result = aMouse;
      break;
    case 1:
      result = aKeyboard;
      break;
    case 2:
      result = aJoystick;
      break;
    case 3:
      result = aMouseRelative;
      break;
    case 4:
      result = aDualActionPad;
      break;
    case 5:
      result = aComputer;
      break;
    default:
      result = aUnknown;
      break;
  }
  return result;
}

// input_scheme_label @ 0x00447CF0
// maps control scheme ids to labels (Relative/Static/Dual Action Pad/etc)
char *__cdecl sub_447CF0(int a1)
{
  char *result; // eax

  switch ( a1 )
  {
    case 1:
      result = aRelative;
      break;
    case 2:
      result = aStatic;
      break;
    case 3:
      result = aDualActionPad;
      break;
    case 4:
      result = aMousePointClic;
      break;
    case 5:
      result = aComputer;
      break;
    default:
      result = aUnknown;
      break;
  }
  return result;
}

// sub_447D40 @ 0x00447D40
char sub_447D40()
{
  float v0; // edi
  int *v1; // esi
  float v2; // ebp
  int v3; // edx
  int v4; // edx
  int v5; // edx
  int v6; // eax
  std::codecvt_base *v7; // ecx
  char v8; // bl
  int v9; // esi
  int v10; // eax
  int v11; // edi
  float v12; // esi
  int v13; // eax
  float v14; // ebp
  int v15; // edi
  int v16; // edi
  int v17; // eax
  int v18; // edx
  float v20; // [esp+A2h] [ebp-54h]
  float v21; // [esp+A6h] [ebp-50h]
  int v22; // [esp+AAh] [ebp-4Ch]
  float v23; // [esp+AAh] [ebp-4Ch]
  float v24; // [esp+AAh] [ebp-4Ch]
  int v25; // [esp+AEh] [ebp-48h]
  float v26; // [esp+AEh] [ebp-48h]
  int v27; // [esp+B2h] [ebp-44h]
  char v28; // [esp+C8h] [ebp-2Eh]
  char v29; // [esp+C9h] [ebp-2Dh]
  float v30; // [esp+CAh] [ebp-2Ch]
  float v31; // [esp+CAh] [ebp-2Ch]
  float v32[2]; // [esp+CEh] [ebp-28h] BYREF
  float v33; // [esp+D6h] [ebp-20h]
  float v34; // [esp+DAh] [ebp-1Ch]
  float v35; // [esp+DEh] [ebp-18h]
  float v36; // [esp+E2h] [ebp-14h]
  float v37; // [esp+E6h] [ebp-10h] BYREF
  float v38; // [esp+EAh] [ebp-Ch]
  int v39; // [esp+EEh] [ebp-8h]
  int v40; // [esp+F2h] [ebp-4h]

  v38 = *(float *)&dword_48E20C + flt_48E230;
  v29 = 0;
  v33 = flt_48E22C + *(float *)&dword_48E208 + 300.0;
  v34 = v38 + 40.0;
  v35 = v33 + flt_48E1F8 + 64.0 - 145.0;
  v36 = v34 + 4.0;
  if ( (byte_4D76A0 & 1) == 0 )
  {
    dword_4D7628 = 1049398413;
    byte_4D76A0 |= 1u;
    dword_4D762C = 1060418741;
    dword_4D7630 = 1064366321;
    dword_4D7634 = 1058642330;
    crt_atexit(nullsub_88);
  }
  if ( (byte_4D76A0 & 2) == 0 )
  {
    dword_4D76F0 = 1049398413;
    byte_4D76A0 |= 2u;
    dword_4D76F4 = 1060418741;
    dword_4D76F8 = 1064366321;
    dword_4D76FC = 1065353216;
    crt_atexit(nullsub_87);
  }
  if ( (byte_4D76A0 & 4) == 0 )
  {
    dword_4D7888 = 0;
    byte_4D76A0 |= 4u;
    dword_4D788C = 1056767229;
    dword_4D7890 = 1061603015;
    dword_4D7894 = 1065353216;
    crt_atexit(nullsub_86);
  }
  if ( (byte_4D76A0 & 8) == 0 )
  {
    dword_4D7738 = 0;
    byte_4D76A0 |= 8u;
    dword_4D773C = 1056767229;
    dword_4D7740 = 1061603015;
    dword_4D7744 = 1056964608;
    crt_atexit(nullsub_85);
  }
  if ( (byte_4D76A0 & 0x10) == 0 )
  {
    qmemcpy(&dword_4D7720, "333?333?333?333?", 16);
    byte_4D76A0 |= 0x10u;
    crt_atexit(nullsub_84);
  }
  if ( (byte_4D76A0 & 0x20) == 0 )
  {
    dword_4D79A8 = 1065353216;
    byte_4D76A0 |= 0x20u;
    dword_4D79AC = 1065353216;
    dword_4D79B0 = 1065353216;
    dword_4D79B4 = 1065353216;
    crt_atexit(nullsub_83);
  }
  if ( (byte_4D76A0 & 0x40) == 0 )
  {
    dword_4D76E0 = 1065353216;
    byte_4D76A0 |= 0x40u;
    dword_4D76E4 = 1065353216;
    dword_4D76E8 = 1065353216;
    dword_4D76EC = 1061997773;
    crt_atexit(nullsub_82);
  }
  if ( byte_4D76A0 >= 0 )
  {
    dword_4D7690 = 1061603015;
    byte_4D76A0 |= 0x80u;
    dword_4D7694 = 1056767229;
    dword_4D7698 = 0;
    dword_4D769C = 1065353216;
    crt_atexit(nullsub_81);
  }
  if ( config_hardcore )
  {
    dword_4D7628 = 1065024251;
    dword_4D762C = 1049398413;
    v37 = 0.98039216;
    dword_4D7630 = 1047589105;
    dword_4D7634 = 1058642330;
    v38 = 0.27450982;
    v39 = 1047589105;
    v40 = 1065353216;
    dword_4D76F0 = 1065024251;
    dword_4D76F4 = 1049398413;
    dword_4D76F8 = 1047589105;
  }
  else
  {
    dword_4D7628 = 1049398413;
    dword_4D762C = 1060418741;
    v37 = 0.27450982;
    dword_4D7630 = 1064366321;
    dword_4D7634 = 1058642330;
    v38 = 0.70588237;
    v39 = 1064366321;
    v40 = 1065353216;
    dword_4D76F0 = 1049398413;
    dword_4D76F4 = 1060418741;
    dword_4D76F8 = 1064366321;
  }
  dword_4D76FC = 1065353216;
  (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4D7720);
  (*(void (__thiscall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    0,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 252))(grim_interface_ptr, 0);
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_48F7A4, 0);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
  (*(void (__thiscall **)(int, float, float, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v35)),
    COERCE_FLOAT(LODWORD(v36)),
    1115684864,
    1107296256);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  v33 = NAN;
  LODWORD(v0) = 1;
  v1 = &dword_48F7A8;
  v35 = v35 + 64.0 + 16.0;
  v32[0] = v36 + 3.0;
  v2 = v32[0];
  do
  {
    if ( ui_mouse_x <= (double)v35
      || ui_mouse_y <= (double)v36
      || v35 + 32.0 <= ui_mouse_x
      || v36 + 32.0 <= ui_mouse_y
      || ui_mouse_blocked )
    {
      (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4D7720);
    }
    else
    {
      (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4D76E0);
      v33 = v0;
    }
    v30 = 1.0;
    if ( dword_478E58 == LODWORD(v0) )
      (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4D79A8);
    else
      v30 = 0.80000001;
    if ( (int)v1 >= (int)&dword_48F7BC )
      v3 = dword_48F7B4;
    else
      v3 = *v1;
    (*(void (__stdcall **)(int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(v3, 0);
    (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 232))(grim_interface_ptr);
    v4 = *(_DWORD *)grim_interface_ptr;
    v32[0] = v30 * 32.0;
    (*(void (__thiscall **)(int, float, float, _DWORD, _DWORD))(v4 + 284))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v35)),
      COERCE_FLOAT(LODWORD(v2)),
      LODWORD(v32[0]),
      LODWORD(v32[0]));
    v5 = *(_DWORD *)grim_interface_ptr;
    v35 = v35 + 36.0;
    (*(void (__thiscall **)(int))(v5 + 240))(grim_interface_ptr);
    ++v1;
    ++LODWORD(v0);
  }
  while ( (int)v1 < (int)&dword_48F7BC );
  v6 = *(_DWORD *)grim_interface_ptr;
  v35 = v35 - 36.0;
  (*(void (__thiscall **)(int, int, int, int, int))(v6 + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v36 = v36 + 50.0;
  v35 = v35 - 208.0 + 16.0;
  if ( (byte_4D79D4 & 1) == 0 )
  {
    byte_4D7700 = 0;
    byte_4D79D4 |= 1u;
    byte_4D7701 = 0;
    byte_4D7702 = 0;
    dword_4D7704 = 0;
    crt_atexit(nullsub_80);
  }
  dword_4D7704 = (int)aHardcore;
  if ( quest_unlock_index >= 40 )
  {
    v32[0] = v35 + 132.0;
    byte_4D7700 = config_hardcore;
    v32[1] = v36 - 12.0;
    ui_checkbox_update(v32, (int)&byte_4D7700);
    config_hardcore = byte_4D7700;
    v36 = v36 + 10.0;
  }
  if ( !game_is_full_version(v7) )
    config_hardcore = 0;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v22,
    v25,
    v27);
  v8 = 0;
  v28 = 0;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 59) )
  {
    v8 = 1;
    v28 = 1;
  }
  v9 = 0;
  v32[0] = v35 - 10.0;
  do
  {
    if ( ui_mouse_x <= (double)v32[0]
      || v36 - 2.0 >= ui_mouse_y
      || v35 + 210.0 <= ui_mouse_x
      || v36 + 18.0 <= ui_mouse_y
      || ui_mouse_blocked )
    {
      (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4D7628);
    }
    else
    {
      dword_4D79D8 = v9;
      v29 = 1;
      (*(void (__thiscall **)(int, int *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, &dword_4D76F0);
    }
    v10 = v9 + 10 * dword_478E58 - 10;
    if ( config_hardcore )
    {
      if ( quest_unlock_index_full < v10 )
        goto LABEL_53;
    }
    else if ( quest_unlock_index < v10 )
    {
LABEL_53:
      v11 = v9 + 1;
      v12 = v36;
      (*(void (**)(int, float, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v35)),
        COERCE_FLOAT(LODWORD(v36)),
        aDD,
        dword_478E58,
        v11);
      v23 = v35 + 32.0;
      (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v23),
        COERCE_FLOAT(LODWORD(v12)),
        asc_478884);
      goto LABEL_54;
    }
    v14 = v36;
    v11 = v9 + 1;
    (*(void (**)(int, float, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v35)),
      COERCE_FLOAT(LODWORD(v36)),
      aDD,
      dword_478E58,
      v9 + 1);
    v21 = v35 + 32.0;
    (*(void (**)(int, _DWORD, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      LODWORD(v21),
      COERCE_FLOAT(LODWORD(v14)),
      aS_0,
      quest_meta_name[110 * dword_478E58 - 110 + 11 * v9]);
    v31 = (float)((*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 332))(
                    grim_interface_ptr,
                    quest_meta_name[110 * dword_478E58 - 110 + 11 * v9])
                + 32);
    v37 = v35;
    v38 = v36 + 13.0;
    (*(void (__thiscall **)(int, float *, float, int))(*(_DWORD *)grim_interface_ptr + 212))(
      grim_interface_ptr,
      &v37,
      COERCE_FLOAT(LODWORD(v31)),
      1065353216);
    v8 = v28;
    if ( v28 )
    {
      v20 = v31 + v35 + 12.0;
      (*(void (**)(int, _DWORD, float, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v20),
        COERCE_FLOAT(LODWORD(v14)),
        aDD_2,
        dword_4856BC[10 * dword_478E58 + v9],
        dword_48561C[10 * dword_478E58 + v9]);
    }
LABEL_54:
    v9 = v11;
    v36 = v36 + 20.0;
  }
  while ( v11 < 10 );
  if ( v8 )
  {
    v26 = v36 - 2.0;
    v24 = v35 + 96.0;
    (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      LODWORD(v24),
      LODWORD(v26),
      aCompletedGames);
  }
  v35 = v32[0];
  v13 = *(_DWORD *)grim_interface_ptr;
  v36 = v36 + 12.0;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(v13 + 72))(grim_interface_ptr, 203) )
  {
    if ( --dword_478E58 < 1 )
      dword_478E58 = 1;
  }
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 205) )
  {
    if ( ++dword_478E58 > 5 )
      dword_478E58 = 5;
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1063675494);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  if ( (byte_4D79D4 & 2) == 0 )
  {
    byte_4D79D4 |= 2u;
    byte_4D774E = 1;
    byte_4D775D = 0;
    byte_4D775C = 0;
    dword_4D7758 = 1065353216;
    dword_4D7754 = 0;
    dword_4D7748 = 0;
    byte_4D774C = 0;
    byte_4D774D = 0;
    dword_4D7750 = 0;
    crt_atexit(nullsub_79);
  }
  dword_4D7748 = (int)aBack_0;
  v37 = v35 + 148.0;
  v38 = v36;
  ui_button_update(&v37, (int)&dword_4D7748);
  if ( byte_4D774D )
  {
    ui_transition_direction = 0;
    game_state_pending = 1;
    sfx_play(sfx_ui_buttonclick, 1.0);
  }
  v15 = LODWORD(v33);
  if ( v33 != NAN && input_primary_just_pressed() )
    dword_478E58 = v15;
  v16 = dword_4D79D8;
  dword_4D79D8 = -10;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 2) )
    dword_4D79D8 = 0;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 3) )
    dword_4D79D8 = 1;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 4) )
    dword_4D79D8 = 2;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 5) )
    dword_4D79D8 = 3;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 6) )
    dword_4D79D8 = 4;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 7) )
    dword_4D79D8 = 5;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 8) )
    dword_4D79D8 = 6;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 9) )
    dword_4D79D8 = 7;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 10) )
    dword_4D79D8 = 8;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 11) )
  {
    v17 = 9;
    dword_4D79D8 = 9;
    goto LABEL_99;
  }
  v17 = dword_4D79D8;
  if ( dword_4D79D8 == -10 )
  {
    dword_4D79D8 = v16;
    LOBYTE(v17) = input_primary_just_pressed();
    if ( (_BYTE)v17 )
    {
      if ( v29
        || (LOBYTE(v17) = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 28),
            (_BYTE)v17) )
      {
        v17 = dword_4D79D8;
        goto LABEL_98;
      }
    }
  }
  else
  {
LABEL_98:
    if ( v17 != 10 )
    {
LABEL_99:
      v18 = v17 + 10 * dword_478E58 - 10;
      if ( config_hardcore )
      {
        if ( quest_unlock_index_full < v18 )
          return v17;
      }
      else if ( quest_unlock_index < v18 )
      {
        return v17;
      }
      byte_487292 = 0;
      ui_transition_direction = 0;
      game_state_pending = 9;
      config_game_mode = 3;
      sfx_mute_all(music_track_crimson_theme_id);
      sfx_mute_all(music_track_shortie_monk_id);
      sfx_mute_all(music_track_extra_0);
      *(_DWORD *)quest_stage_major = dword_478E58;
      quest_stage_minor = dword_4D79D8 + 1;
      byte_48702C = 1;
      LOBYTE(v17) = sfx_play(sfx_ui_buttonclick, 1.0);
    }
  }
  return v17;
}

// nullsub_79 @ 0x00448AB0
void __cdecl nullsub_79()
{
  ;
}

// nullsub_80 @ 0x00448AC0
void __cdecl nullsub_80()
{
  ;
}

// nullsub_81 @ 0x00448AD0
void __cdecl nullsub_81()
{
  ;
}

// nullsub_82 @ 0x00448AE0
void __cdecl nullsub_82()
{
  ;
}

// nullsub_83 @ 0x00448AF0
void __cdecl nullsub_83()
{
  ;
}

// nullsub_84 @ 0x00448B00
void __cdecl nullsub_84()
{
  ;
}

// nullsub_85 @ 0x00448B10
void __cdecl nullsub_85()
{
  ;
}

// nullsub_86 @ 0x00448B20
void __cdecl nullsub_86()
{
  ;
}

// nullsub_87 @ 0x00448B30
void __cdecl nullsub_87()
{
  ;
}

// nullsub_88 @ 0x00448B40
void __cdecl nullsub_88()
{
  ;
}

// sub_448B50 @ 0x00448B50
int sub_448B50()
{
  float v1; // [esp+18h] [ebp-4h]
  float v2; // [esp+18h] [ebp-4h]
  float v3; // [esp+18h] [ebp-4h]
  float v4; // [esp+18h] [ebp-4h]
  float v5; // [esp+18h] [ebp-4h]
  float v6; // [esp+18h] [ebp-4h]

  v1 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(grim_interface_ptr, 319);
  if ( COERCE_FLOAT(LODWORD(v1) & 0x7FFFFFFF) > 0.5 )
    return 319;
  v2 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(grim_interface_ptr, 320);
  if ( COERCE_FLOAT(LODWORD(v2) & 0x7FFFFFFF) > 0.5 )
    return 320;
  v3 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(grim_interface_ptr, 321);
  if ( COERCE_FLOAT(LODWORD(v3) & 0x7FFFFFFF) > 0.5 )
    return 321;
  v4 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(grim_interface_ptr, 339);
  if ( COERCE_FLOAT(LODWORD(v4) & 0x7FFFFFFF) > 0.5 )
    return 339;
  v5 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(grim_interface_ptr, 340);
  if ( COERCE_FLOAT(LODWORD(v5) & 0x7FFFFFFF) > 0.5 )
    return 340;
  v6 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(grim_interface_ptr, 341);
  if ( COERCE_FLOAT(LODWORD(v6) & 0x7FFFFFFF) > 0.5 )
    return 341;
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
  return 0;
}

// sub_448CD0 @ 0x00448CD0
int sub_448CD0()
{
  int v0; // ebx
  int v1; // edx
  double v2; // st7
  char v3; // cl
  double v4; // st7
  int *v5; // ecx
  int *v6; // eax
  int v7; // edx
  int v8; // esi
  int v9; // ecx
  _DWORD *v10; // eax
  char *v11; // eax
  float v12; // edi
  int *v13; // ebp
  int v14; // esi
  const char *v15; // eax
  const char *v16; // edi
  int v17; // ebx
  int v18; // esi
  const char *v19; // eax
  const char *v20; // edi
  int v21; // esi
  const char *v22; // eax
  const char *v23; // edi
  int v24; // esi
  const char *v25; // eax
  const char *v26; // edi
  int v27; // eax
  int v28; // esi
  int v29; // esi
  int v30; // eax
  float *v31; // eax
  float *v32; // eax
  float *v33; // eax
  float *v34; // eax
  float *v35; // eax
  int v36; // edi
  int v37; // eax
  int v38; // eax
  float *v39; // eax
  float *v40; // eax
  float *v41; // eax
  float *v42; // eax
  float *v43; // eax
  float *v44; // eax
  float *v45; // eax
  float *v46; // eax
  float *v47; // eax
  float *v48; // eax
  float *v49; // eax
  int v50; // edi
  int v51; // eax
  float *v52; // eax
  float *v53; // eax
  int v54; // eax
  char v55; // dl
  int v56; // esi
  char *v57; // ecx
  bool v58; // zf
  double v59; // st7
  double v60; // st7
  double v61; // st7
  double v62; // st7
  double v63; // st7
  double v64; // st7
  int v65; // edx
  float *v66; // ecx
  int v67; // eax
  int v68; // ecx
  int v69; // ecx
  int v70; // ecx
  int v71; // ecx
  int v72; // ecx
  int v73; // esi
  int v74; // ecx
  int v75; // eax
  int v76; // edx
  int v77; // eax
  float *v78; // eax
  int v79; // esi
  float *v80; // eax
  int v81; // esi
  float *v82; // eax
  int result; // eax
  int v84; // esi
  int v85; // ecx
  int v86; // edx
  float v87; // [esp+254h] [ebp-90h]
  int v88; // [esp+254h] [ebp-90h]
  float v89; // [esp+254h] [ebp-90h]
  float v90; // [esp+254h] [ebp-90h]
  float v91; // [esp+254h] [ebp-90h]
  float v92; // [esp+254h] [ebp-90h]
  float v93; // [esp+254h] [ebp-90h]
  float v94; // [esp+254h] [ebp-90h]
  float v95; // [esp+258h] [ebp-8Ch]
  int v96; // [esp+258h] [ebp-8Ch]
  float v97; // [esp+258h] [ebp-8Ch]
  float v98; // [esp+258h] [ebp-8Ch]
  float v99; // [esp+258h] [ebp-8Ch]
  int v100; // [esp+25Ch] [ebp-88h]
  float v101; // [esp+25Ch] [ebp-88h]
  float v102; // [esp+25Ch] [ebp-88h]
  float v103; // [esp+260h] [ebp-84h]
  float v104; // [esp+260h] [ebp-84h]
  float v105; // [esp+260h] [ebp-84h]
  float v106; // [esp+260h] [ebp-84h]
  float v107; // [esp+260h] [ebp-84h]
  float v108; // [esp+260h] [ebp-84h]
  float v109; // [esp+260h] [ebp-84h]
  float v110; // [esp+260h] [ebp-84h]
  float v111; // [esp+260h] [ebp-84h]
  float v112; // [esp+260h] [ebp-84h]
  float v113; // [esp+260h] [ebp-84h]
  float v114; // [esp+260h] [ebp-84h]
  int v115; // [esp+264h] [ebp-80h]
  int v116; // [esp+264h] [ebp-80h]
  int v117; // [esp+264h] [ebp-80h]
  int v118; // [esp+264h] [ebp-80h]
  int v119; // [esp+264h] [ebp-80h]
  int v120; // [esp+264h] [ebp-80h]
  int v121; // [esp+264h] [ebp-80h]
  int v122; // [esp+264h] [ebp-80h]
  int v123; // [esp+264h] [ebp-80h]
  int v124; // [esp+264h] [ebp-80h]
  int v125; // [esp+264h] [ebp-80h]
  int v126; // [esp+264h] [ebp-80h]
  int v127; // [esp+268h] [ebp-7Ch]
  int v128; // [esp+268h] [ebp-7Ch]
  int v129; // [esp+268h] [ebp-7Ch]
  int v130; // [esp+268h] [ebp-7Ch]
  int v131; // [esp+268h] [ebp-7Ch]
  int v132; // [esp+268h] [ebp-7Ch]
  int v133; // [esp+268h] [ebp-7Ch]
  int v134; // [esp+268h] [ebp-7Ch]
  int v135; // [esp+268h] [ebp-7Ch]
  int v136; // [esp+268h] [ebp-7Ch]
  int v137; // [esp+268h] [ebp-7Ch]
  int v138; // [esp+268h] [ebp-7Ch]
  float v139; // [esp+270h] [ebp-74h] BYREF
  int v140; // [esp+274h] [ebp-70h]
  float v141; // [esp+278h] [ebp-6Ch] BYREF
  float v142; // [esp+27Ch] [ebp-68h]
  float v143; // [esp+280h] [ebp-64h]
  int v144; // [esp+284h] [ebp-60h]
  float v145; // [esp+288h] [ebp-5Ch] BYREF
  float v146; // [esp+28Ch] [ebp-58h] BYREF
  _DWORD v147[4]; // [esp+290h] [ebp-54h] BYREF
  _DWORD v148[4]; // [esp+2A0h] [ebp-44h] BYREF
  _DWORD v149[6]; // [esp+2B0h] [ebp-34h] BYREF
  _DWORD v150[7]; // [esp+2C8h] [ebp-1Ch] BYREF

  v0 = 0;
  if ( (byte_4D77E8 & 1) == 0 )
  {
    byte_4D770E = 1;
    byte_4D77E8 |= 1u;
    byte_4D771D = 0;
    byte_4D771C = 0;
    dword_4D7718 = 1065353216;
    dword_4D7714 = 0;
    dword_4D7708 = 0;
    byte_4D770C = 0;
    byte_4D770D = 0;
    dword_4D7710 = 0;
    crt_atexit(nullsub_95);
  }
  dword_4D7708 = (int)aRedefine;
  if ( (byte_4D77E8 & 2) == 0 )
  {
    byte_4D75BE = 1;
    byte_4D77E8 |= 2u;
    byte_4D75CD = 0;
    byte_4D75CC = 0;
    dword_4D75C8 = 1065353216;
    dword_4D75C4 = 0;
    dword_4D75B8 = 0;
    byte_4D75BC = 0;
    byte_4D75BD = 0;
    dword_4D75C0 = 0;
    crt_atexit(nullsub_94);
  }
  dword_4D75B8 = (int)aBack_0;
  if ( (byte_4D77E8 & 4) == 0 )
  {
    byte_4D7660 = 1;
    byte_4D77E8 |= 4u;
    dword_4D7678 = 0;
    byte_4D7674 = 0;
    dword_4D7668 = 0;
    dword_4D7664 = 0;
    dword_4D7670 = 0;
    dword_4D766C = 0;
    crt_atexit(nullsub_93);
  }
  if ( (byte_4D77E8 & 8) == 0 )
  {
    byte_4D76A8 = 1;
    byte_4D77E8 |= 8u;
    dword_4D76C0 = 0;
    byte_4D76BC = 0;
    dword_4D76B0 = 0;
    dword_4D76AC = 0;
    dword_4D76B8 = 0;
    dword_4D76B4 = 0;
    crt_atexit(nullsub_92);
  }
  if ( (byte_4D77E8 & 0x10) == 0 )
  {
    byte_4D7638 = 1;
    byte_4D77E8 |= 0x10u;
    dword_4D7650 = 0;
    byte_4D764C = 0;
    dword_4D7640 = 0;
    dword_4D763C = 0;
    dword_4D7648 = 0;
    dword_4D7644 = 0;
    crt_atexit(nullsub_91);
  }
  if ( byte_478E60 )
  {
    byte_478E60 = 0;
    v1 = config_player_mode_flags[dword_4D79DC] - 1;
    dword_4D76B0 = config_aim_scheme[dword_4D79DC];
    dword_4D7640 = v1;
  }
  v150[0] = FUN_00447c90(0);
  v150[1] = FUN_00447c90(1);
  v150[2] = FUN_00447c90(2);
  v150[3] = FUN_00447c90(3);
  v150[4] = FUN_00447c90(4);
  v150[5] = FUN_00447c90(5);
  v150[6] = FUN_00447c90(6);
  dword_4D76B4 = (int)v150;
  dword_4D76B8 = 5;
  v149[0] = input_scheme_label(1);
  v149[1] = input_scheme_label(2);
  v149[2] = input_scheme_label(3);
  v149[3] = input_scheme_label(4);
  v149[4] = input_scheme_label(5);
  v149[5] = input_scheme_label(6);
  dword_4D7644 = (int)v149;
  v2 = *(float *)(dword_480874 + 12);
  dword_4D7648 = 3;
  if ( v2 != 0.0 )
    dword_4D7648 = 4;
  dword_4D766C = (int)v148;
  v148[0] = aPlayer1;
  v146 = *(float *)&dword_48D294 + flt_48D2B8;
  v148[1] = aPlayer2;
  v148[2] = aPlayer3;
  v148[3] = aPlayer4;
  dword_4D7670 = 2;
  v139 = flt_48D2B4 + *(float *)&dword_48D290 + 300.0;
  *(float *)&v140 = v146 + 40.0;
  v142 = *(float *)&v140;
  v144 = v140;
  v141 = flt_48D280 - 32.0 - 64.0 + v139;
  v143 = v141;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  ui_draw_textured_quad((__int64)(v141 + 2.0), (__int64)(*(float *)&v140 + 4.0), 128, 32, dword_48F7FC);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1061997773);
  v142 = *(float *)&v140 + 3.0;
  v141 = v141 + 9.0;
  v95 = v142 - 2.0;
  v87 = v141 + 126.0;
  (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v87),
    LODWORD(v95),
    aConfigureFor);
  v142 = v142 + 43.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v88,
    v96,
    v100);
  (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v141)),
    COERCE_FLOAT(LODWORD(v142)),
    aAimingMethod);
  v142 = v142 + 42.0;
  (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v141)),
    COERCE_FLOAT(LODWORD(v142)),
    aMovingMethod);
  v142 = v142 + 42.0;
  if ( (byte_4D77E8 & 0x20) == 0 )
  {
    byte_4D77F0 = 0;
    byte_4D77E8 |= 0x20u;
    byte_4D77F1 = 0;
    byte_4D77F2 = 0;
    dword_4D77F4 = 0;
    crt_atexit(nullsub_90);
  }
  v3 = *((_BYTE *)&config_hud_indicator_toggle + dword_4D79DC);
  dword_4D77F4 = (int)aShowDirectionA;
  v142 = v142 + 4.0;
  byte_4D77F0 = v3;
  ui_checkbox_update(&v141, (int)&byte_4D77F0);
  v4 = flt_48EE8C + *(float *)&dword_48EE68;
  v146 = *(float *)&dword_48EE6C + flt_48EE90;
  *((_BYTE *)&config_hud_indicator_toggle + dword_4D79DC) = byte_4D77F0;
  v5 = &player_move_key_backward;
  v139 = v4 + 50.0;
  *(float *)&v140 = v146 + 40.0;
  v6 = &config_p1_axis_move_x;
  v142 = *(float *)&v140 + 32.0;
  v141 = flt_48EE58 - 64.0 + v139 + 64.0;
  do
  {
    v7 = *(v6 - 12);
    v6 += 16;
    *(v5 - 1) = v7;
    *v5 = *(v6 - 27);
    v5[1] = *(v6 - 26);
    v5[2] = *(v6 - 25);
    v5[3] = *(v6 - 24);
    v5[4] = *(v6 - 23);
    v5[5] = *(v6 - 22);
    v5[6] = *(v6 - 21);
    v5[7] = *(v6 - 20);
    v5[9] = *(v6 - 19);
    v5[8] = *(v6 - 18);
    v5[11] = *(v6 - 17);
    v5[10] = *(v6 - 16);
    v5 += 216;
  }
  while ( (int)v6 < (int)dword_4805C0 );
  v101 = (double)dword_4D7710 * 0.00090000004;
  (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    LODWORD(v101));
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1063675494);
  v141 = v141 + 16.0;
  v142 = v142 + 4.0 - 38.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v89 = v141 + 54.0;
  (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    LODWORD(v89),
    COERCE_FLOAT(LODWORD(v142)),
    aConfiguredCont);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1061997773);
  v145 = v141 + 54.0;
  v146 = v142 + 13.0;
  v8 = *(_DWORD *)grim_interface_ptr;
  *(float *)&v140 = COERCE_FLOAT(
                      (*(int (__thiscall **)(int, char *, int))(*(_DWORD *)grim_interface_ptr + 332))(
                        grim_interface_ptr,
                        aConfiguredCont,
                        1065353216));
  v102 = (float)v140;
  (*(void (__thiscall **)(int, float *, _DWORD))(v8 + 212))(grim_interface_ptr, &v146, LODWORD(v102));
  v142 = v142 + 26.0;
  v141 = v141 - 8.0;
  if ( (byte_4D77E8 & 0x40) == 0 )
  {
    v9 = 15;
    byte_4D77E8 |= 0x40u;
    v10 = &unk_4D78A4;
    do
    {
      *((_BYTE *)v10 - 6) = 1;
      *v10 = 1065353216;
      *(v10 - 3) = 0;
      *((_BYTE *)v10 - 8) = 0;
      *((_BYTE *)v10 - 7) = 0;
      *(v10 - 1) = 0;
      v10 += 4;
      --v9;
    }
    while ( v9 );
    crt_atexit(nullsub_89);
  }
  v11 = (char *)&unk_4D789D;
  do
  {
    v11[1] = 1;
    *v11 = 0;
    v11 += 16;
  }
  while ( (int)v11 < (int)&byte_4D798D );
  LODWORD(v12) = 16 * dword_4D79DC;
  do
  {
    v13 = &dword_4D7898[4 * v0];
    if ( *v13 )
      crt_free((LPVOID)dword_4D7898[4 * v0]);
    v14 = config_p1_move_forward[LODWORD(v12)++];
    v139 = v12;
    if ( v14 > 255 )
    {
      switch ( v14 )
      {
        case 256:
          strcpy(String, aMouse1);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 257:
          v16 = aMouse2;
          break;
        case 258:
          strcpy(String, aMouse3);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 259:
          v16 = aMouse4;
          break;
        case 260:
          strcpy(String, aMouse5);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 265:
          v16 = aMwheelup;
          break;
        case 266:
          strcpy(String, aMwheeldown);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 287:
          v16 = aJoys1;
          break;
        case 288:
          strcpy(String, aJoys2);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 289:
          v16 = aJoys3;
          break;
        case 290:
          strcpy(String, aJoys4);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 291:
          v16 = aJoys5;
          break;
        case 292:
          strcpy(String, aJoys6);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 293:
          v16 = aJoys7;
          break;
        case 294:
          strcpy(String, aJoys8);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 295:
          v16 = aJoys9;
          break;
        case 296:
          strcpy(String, aJoys10);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 297:
          v16 = aJoys11;
          break;
        case 298:
          strcpy(String, aJoys12);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 305:
          v16 = aJoysup;
          break;
        case 306:
          strcpy(String, aJoysdown);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 307:
          v16 = aJoysleft;
          break;
        case 308:
          strcpy(String, aJoysright);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 319:
          v16 = aJoyaxisx;
          break;
        case 320:
          strcpy(String, aJoyaxisy);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 321:
          v16 = aJoyaxisz;
          break;
        case 339:
          strcpy(String, aJoyrotx);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 340:
          v16 = aJoyroty;
          break;
        case 341:
          strcpy(String, aJoyrotz);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 382:
          v16 = aUnbound;
          break;
        case 355:
          strcpy(String, aRim0xaxis);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 356:
          v16 = aRim1xaxis;
          break;
        case 357:
          strcpy(String, aRim2xaxis);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 360:
          v16 = aRim0yaxis;
          break;
        case 361:
          strcpy(String, aRim1yaxis);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 362:
          v16 = aRim2yaxis;
          break;
        case 365:
          strcpy(String, aRim0btn1);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 366:
          v16 = aRim0btn2;
          break;
        case 367:
          strcpy(String, aRim0btn3);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 368:
          v16 = aRim0btn4;
          break;
        case 369:
          strcpy(String, aRim0btn5);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 370:
          v16 = aRim1btn1;
          break;
        case 371:
          strcpy(String, aRim1btn2);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 372:
          v16 = aRim1btn3;
          break;
        case 373:
          strcpy(String, aRim1btn4);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 374:
          v16 = aRim1btn5;
          break;
        case 375:
          strcpy(String, aRim2btn1);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 376:
          v16 = aRim2btn2;
          break;
        case 377:
          strcpy(String, aRim2btn3);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        case 378:
          v16 = aRim2btn4;
          break;
        case 379:
          strcpy(String, aRim2btn5);
          v15 = String;
          v12 = v139;
          goto LABEL_283;
        default:
          if ( v14 <= 355 )
            goto LABEL_134;
          v16 = aRawinput;
          break;
      }
      strcpy(String, v16);
LABEL_134:
      v12 = v139;
      v15 = String;
      goto LABEL_283;
    }
    if ( GetKeyNameTextA(v14 << 16, String, 63) )
    {
      v15 = String;
    }
    else
    {
      switch ( v14 )
      {
        case 1:
          v15 = aDikEscape;
          break;
        case 2:
          v15 = aDik1;
          break;
        case 3:
          v15 = aDik2;
          break;
        case 4:
          v15 = aDik3;
          break;
        case 5:
          v15 = aDik4;
          break;
        case 6:
          v15 = aDik5;
          break;
        case 7:
          v15 = aDik6;
          break;
        case 8:
          v15 = aDik7;
          break;
        case 9:
          v15 = aDik8;
          break;
        case 10:
          v15 = aDik9;
          break;
        case 11:
          v15 = aDik0;
          break;
        case 12:
          v15 = aMinus;
          break;
        case 13:
          v15 = aEquals;
          break;
        case 14:
          v15 = aBack;
          break;
        case 15:
          v15 = (const char *)&off_47186C;
          break;
        case 16:
          v15 = aQ;
          break;
        case 17:
          v15 = aW;
          break;
        case 18:
          v15 = aE;
          break;
        case 19:
          v15 = aR;
          break;
        case 20:
          v15 = aT;
          break;
        case 21:
          v15 = aY;
          break;
        case 22:
          v15 = aU;
          break;
        case 23:
          v15 = aI;
          break;
        case 24:
          v15 = aO;
          break;
        case 25:
          v15 = aP;
          break;
        case 26:
          v15 = aLbracket;
          break;
        case 27:
          v15 = aRbracket;
          break;
        case 28:
          v15 = aReturn;
          break;
        case 29:
          v15 = aLcontrol;
          break;
        case 30:
          v15 = aA;
          break;
        case 31:
          v15 = aS_3;
          break;
        case 32:
          v15 = aD_1;
          break;
        case 33:
          v15 = asc_471808;
          break;
        case 34:
          v15 = aG;
          break;
        case 35:
          v15 = asc_471800;
          break;
        case 36:
          v15 = aJ;
          break;
        case 37:
          v15 = aK;
          break;
        case 38:
          v15 = asc_4717F4;
          break;
        case 39:
          v15 = aSemicolon;
          break;
        case 40:
          v15 = aApostrophe;
          break;
        case 41:
          v15 = aGrave;
          break;
        case 42:
          v15 = aLshift;
          break;
        case 43:
          v15 = aBackslash;
          break;
        case 44:
          v15 = aZ;
          break;
        case 45:
          v15 = asc_4717B8;
          break;
        case 46:
          v15 = aC;
          break;
        case 47:
          v15 = aV;
          break;
        case 48:
          v15 = aB;
          break;
        case 49:
          v15 = aN;
          break;
        case 50:
          v15 = aM;
          break;
        case 51:
          v15 = aComma;
          break;
        case 52:
          v15 = aPeriod;
          break;
        case 53:
          v15 = aSlash;
          break;
        case 54:
          v15 = aRshift;
          break;
        case 55:
          v15 = aMultiply;
          break;
        case 56:
          v15 = aLmenu;
          break;
        case 57:
          v15 = aSpace;
          break;
        case 58:
          v15 = aCapital;
          break;
        case 59:
          v15 = aF1;
          break;
        case 60:
          v15 = aF2;
          break;
        case 61:
          v15 = aF3;
          break;
        case 62:
          v15 = aF4;
          break;
        case 63:
          v15 = aF5;
          break;
        case 64:
          v15 = aF6;
          break;
        case 65:
          v15 = aF7;
          break;
        case 66:
          v15 = aF8;
          break;
        case 67:
          v15 = aF9;
          break;
        case 68:
          v15 = aF10;
          break;
        case 69:
          v15 = aNumlock;
          break;
        case 70:
          v15 = aScroll;
          break;
        case 71:
          v15 = aNumpad7;
          break;
        case 72:
          v15 = aNumpad8;
          break;
        case 73:
          v15 = aNumpad9;
          break;
        case 74:
          v15 = aSubtract;
          break;
        case 75:
          v15 = aNumpad4;
          break;
        case 76:
          v15 = aNumpad5;
          break;
        case 77:
          v15 = aNumpad6;
          break;
        case 78:
          v15 = (const char *)&off_4716E8;
          break;
        case 79:
          v15 = aNumpad1;
          break;
        case 80:
          v15 = aNumpad2;
          break;
        case 81:
          v15 = aNumpad3;
          break;
        case 82:
          v15 = aNumpad0;
          break;
        case 83:
          v15 = aDecimal;
          break;
        case 86:
          v15 = aOem102;
          break;
        case 87:
          v15 = aF11;
          break;
        case 88:
          v15 = aF12;
          break;
        case 100:
          v15 = aF13;
          break;
        case 101:
          v15 = aF14;
          break;
        case 102:
          v15 = aF15;
          break;
        case 112:
          v15 = aKana;
          break;
        case 115:
          v15 = aAbntC1;
          break;
        case 121:
          v15 = aConvert;
          break;
        case 123:
          v15 = aNoconvert;
          break;
        case 125:
          v15 = aYen;
          break;
        case 126:
          v15 = aAbntC2;
          break;
        case 141:
          v15 = aNumpadequals;
          break;
        case 144:
          v15 = aPrevtrack;
          break;
        case 145:
          v15 = aAt;
          break;
        case 146:
          v15 = aColon;
          break;
        case 147:
          v15 = aUnderline;
          break;
        case 148:
          v15 = aKanji;
          break;
        case 149:
          v15 = aStop;
          break;
        case 150:
          v15 = aAx;
          break;
        case 151:
          v15 = aUnlabeled;
          break;
        case 153:
          v15 = aNexttrack;
          break;
        case 156:
          v15 = aNumpadenter;
          break;
        case 157:
          v15 = aRcontrol;
          break;
        case 160:
          v15 = aMute;
          break;
        case 161:
          v15 = aCalculator;
          break;
        case 162:
          v15 = aPlaypause;
          break;
        case 164:
          v15 = aMediastop;
          break;
        case 174:
          v15 = aVolumedown;
          break;
        case 176:
          v15 = aVolumeup;
          break;
        case 178:
          v15 = aWebhome;
          break;
        case 179:
          v15 = aNumpadcomma;
          break;
        case 181:
          v15 = aDivide;
          break;
        case 183:
          v15 = aSysrq;
          break;
        case 184:
          v15 = aRmenu;
          break;
        case 197:
          v15 = aPause;
          break;
        case 199:
          v15 = aHome;
          break;
        case 200:
          v15 = aUp;
          break;
        case 201:
          v15 = aPrior;
          break;
        case 203:
          v15 = aLeft;
          break;
        case 205:
          v15 = aRight;
          break;
        case 207:
          v15 = (const char *)&off_47155C;
          break;
        case 208:
          v15 = aDown;
          break;
        case 209:
          v15 = aNext;
          break;
        case 210:
          v15 = aInsert;
          break;
        case 211:
          v15 = aDelete;
          break;
        case 219:
          v15 = aLwin;
          break;
        case 220:
          v15 = aRwin;
          break;
        case 221:
          v15 = aApps;
          break;
        case 222:
          v15 = aPower;
          break;
        case 223:
          v15 = aSleep;
          break;
        case 227:
          v15 = aWake;
          break;
        case 229:
          v15 = aWebsearch;
          break;
        case 230:
          v15 = aWebfavorites;
          break;
        case 231:
          v15 = aWebrefresh;
          break;
        case 232:
          v15 = aWebstop;
          break;
        case 233:
          v15 = aWebforward;
          break;
        case 234:
          v15 = aWebback;
          break;
        case 235:
          v15 = aMycomputer;
          break;
        case 236:
          v15 = aMail;
          break;
        case 237:
          v15 = aMediaselect;
          break;
        default:
          v15 = aUnknown;
          break;
      }
    }
LABEL_283:
    ++v0;
    *v13 = (int)strdup_malloc(v15);
  }
  while ( v0 < 13 );
  v17 = 4 * v0;
  if ( dword_4D7898[v17] )
    crt_free((LPVOID)dword_4D7898[v17]);
  v18 = config_p1_move_forward[LODWORD(v12)];
  if ( v18 <= 255 )
  {
    if ( GetKeyNameTextA(v18 << 16, String, 63) )
    {
      v19 = String;
    }
    else
    {
      switch ( v18 )
      {
        case 1:
          v19 = aDikEscape;
          break;
        case 2:
          v19 = aDik1;
          break;
        case 3:
          v19 = aDik2;
          break;
        case 4:
          v19 = aDik3;
          break;
        case 5:
          v19 = aDik4;
          break;
        case 6:
          v19 = aDik5;
          break;
        case 7:
          v19 = aDik6;
          break;
        case 8:
          v19 = aDik7;
          break;
        case 9:
          v19 = aDik8;
          break;
        case 10:
          v19 = aDik9;
          break;
        case 11:
          v19 = aDik0;
          break;
        case 12:
          v19 = aMinus;
          break;
        case 13:
          v19 = aEquals;
          break;
        case 14:
          v19 = aBack;
          break;
        case 15:
          v19 = (const char *)&off_47186C;
          break;
        case 16:
          v19 = aQ;
          break;
        case 17:
          v19 = aW;
          break;
        case 18:
          v19 = aE;
          break;
        case 19:
          v19 = aR;
          break;
        case 20:
          v19 = aT;
          break;
        case 21:
          v19 = aY;
          break;
        case 22:
          v19 = aU;
          break;
        case 23:
          v19 = aI;
          break;
        case 24:
          v19 = aO;
          break;
        case 25:
          v19 = aP;
          break;
        case 26:
          v19 = aLbracket;
          break;
        case 27:
          v19 = aRbracket;
          break;
        case 28:
          v19 = aReturn;
          break;
        case 29:
          v19 = aLcontrol;
          break;
        case 30:
          v19 = aA;
          break;
        case 31:
          v19 = aS_3;
          break;
        case 32:
          v19 = aD_1;
          break;
        case 33:
          v19 = asc_471808;
          break;
        case 34:
          v19 = aG;
          break;
        case 35:
          v19 = asc_471800;
          break;
        case 36:
          v19 = aJ;
          break;
        case 37:
          v19 = aK;
          break;
        case 38:
          v19 = asc_4717F4;
          break;
        case 39:
          v19 = aSemicolon;
          break;
        case 40:
          v19 = aApostrophe;
          break;
        case 41:
          v19 = aGrave;
          break;
        case 42:
          v19 = aLshift;
          break;
        case 43:
          v19 = aBackslash;
          break;
        case 44:
          v19 = aZ;
          break;
        case 45:
          v19 = asc_4717B8;
          break;
        case 46:
          v19 = aC;
          break;
        case 47:
          v19 = aV;
          break;
        case 48:
          v19 = aB;
          break;
        case 49:
          v19 = aN;
          break;
        case 50:
          v19 = aM;
          break;
        case 51:
          v19 = aComma;
          break;
        case 52:
          v19 = aPeriod;
          break;
        case 53:
          v19 = aSlash;
          break;
        case 54:
          v19 = aRshift;
          break;
        case 55:
          v19 = aMultiply;
          break;
        case 56:
          v19 = aLmenu;
          break;
        case 57:
          v19 = aSpace;
          break;
        case 58:
          v19 = aCapital;
          break;
        case 59:
          v19 = aF1;
          break;
        case 60:
          v19 = aF2;
          break;
        case 61:
          v19 = aF3;
          break;
        case 62:
          v19 = aF4;
          break;
        case 63:
          v19 = aF5;
          break;
        case 64:
          v19 = aF6;
          break;
        case 65:
          v19 = aF7;
          break;
        case 66:
          v19 = aF8;
          break;
        case 67:
          v19 = aF9;
          break;
        case 68:
          v19 = aF10;
          break;
        case 69:
          v19 = aNumlock;
          break;
        case 70:
          v19 = aScroll;
          break;
        case 71:
          v19 = aNumpad7;
          break;
        case 72:
          v19 = aNumpad8;
          break;
        case 73:
          v19 = aNumpad9;
          break;
        case 74:
          v19 = aSubtract;
          break;
        case 75:
          v19 = aNumpad4;
          break;
        case 76:
          v19 = aNumpad5;
          break;
        case 77:
          v19 = aNumpad6;
          break;
        case 78:
          v19 = (const char *)&off_4716E8;
          break;
        case 79:
          v19 = aNumpad1;
          break;
        case 80:
          v19 = aNumpad2;
          break;
        case 81:
          v19 = aNumpad3;
          break;
        case 82:
          v19 = aNumpad0;
          break;
        case 83:
          v19 = aDecimal;
          break;
        case 86:
          v19 = aOem102;
          break;
        case 87:
          v19 = aF11;
          break;
        case 88:
          v19 = aF12;
          break;
        case 100:
          v19 = aF13;
          break;
        case 101:
          v19 = aF14;
          break;
        case 102:
          v19 = aF15;
          break;
        case 112:
          v19 = aKana;
          break;
        case 115:
          v19 = aAbntC1;
          break;
        case 121:
          v19 = aConvert;
          break;
        case 123:
          v19 = aNoconvert;
          break;
        case 125:
          v19 = aYen;
          break;
        case 126:
          v19 = aAbntC2;
          break;
        case 141:
          v19 = aNumpadequals;
          break;
        case 144:
          v19 = aPrevtrack;
          break;
        case 145:
          v19 = aAt;
          break;
        case 146:
          v19 = aColon;
          break;
        case 147:
          v19 = aUnderline;
          break;
        case 148:
          v19 = aKanji;
          break;
        case 149:
          v19 = aStop;
          break;
        case 150:
          v19 = aAx;
          break;
        case 151:
          v19 = aUnlabeled;
          break;
        case 153:
          v19 = aNexttrack;
          break;
        case 156:
          v19 = aNumpadenter;
          break;
        case 157:
          v19 = aRcontrol;
          break;
        case 160:
          v19 = aMute;
          break;
        case 161:
          v19 = aCalculator;
          break;
        case 162:
          v19 = aPlaypause;
          break;
        case 164:
          v19 = aMediastop;
          break;
        case 174:
          v19 = aVolumedown;
          break;
        case 176:
          v19 = aVolumeup;
          break;
        case 178:
          v19 = aWebhome;
          break;
        case 179:
          v19 = aNumpadcomma;
          break;
        case 181:
          v19 = aDivide;
          break;
        case 183:
          v19 = aSysrq;
          break;
        case 184:
          v19 = aRmenu;
          break;
        case 197:
          v19 = aPause;
          break;
        case 199:
          v19 = aHome;
          break;
        case 200:
          v19 = aUp;
          break;
        case 201:
          v19 = aPrior;
          break;
        case 203:
          v19 = aLeft;
          break;
        case 205:
          v19 = aRight;
          break;
        case 207:
          v19 = (const char *)&off_47155C;
          break;
        case 208:
          v19 = aDown;
          break;
        case 209:
          v19 = aNext;
          break;
        case 210:
          v19 = aInsert;
          break;
        case 211:
          v19 = aDelete;
          break;
        case 219:
          v19 = aLwin;
          break;
        case 220:
          v19 = aRwin;
          break;
        case 221:
          v19 = aApps;
          break;
        case 222:
          v19 = aPower;
          break;
        case 223:
          v19 = aSleep;
          break;
        case 227:
          v19 = aWake;
          break;
        case 229:
          v19 = aWebsearch;
          break;
        case 230:
          v19 = aWebfavorites;
          break;
        case 231:
          v19 = aWebrefresh;
          break;
        case 232:
          v19 = aWebstop;
          break;
        case 233:
          v19 = aWebforward;
          break;
        case 234:
          v19 = aWebback;
          break;
        case 235:
          v19 = aMycomputer;
          break;
        case 236:
          v19 = aMail;
          break;
        case 237:
          v19 = aMediaselect;
          break;
        default:
          v19 = aUnknown;
          break;
      }
    }
  }
  else
  {
    switch ( v18 )
    {
      case 256:
        v19 = strcpy(String, aMouse1);
        break;
      case 257:
        v20 = aMouse2;
        goto LABEL_391;
      case 258:
        v19 = strcpy(String, aMouse3);
        break;
      case 259:
        v20 = aMouse4;
        goto LABEL_391;
      case 260:
        v19 = strcpy(String, aMouse5);
        break;
      case 265:
        v20 = aMwheelup;
        goto LABEL_391;
      case 266:
        v19 = strcpy(String, aMwheeldown);
        break;
      case 287:
        v20 = aJoys1;
        goto LABEL_391;
      case 288:
        v19 = strcpy(String, aJoys2);
        break;
      case 289:
        v20 = aJoys3;
        goto LABEL_391;
      case 290:
        v19 = strcpy(String, aJoys4);
        break;
      case 291:
        v20 = aJoys5;
        goto LABEL_391;
      case 292:
        v19 = strcpy(String, aJoys6);
        break;
      case 293:
        v20 = aJoys7;
        goto LABEL_391;
      case 294:
        v19 = strcpy(String, aJoys8);
        break;
      case 295:
        v20 = aJoys9;
        goto LABEL_391;
      case 296:
        v19 = strcpy(String, aJoys10);
        break;
      case 297:
        v20 = aJoys11;
        goto LABEL_391;
      case 298:
        v19 = strcpy(String, aJoys12);
        break;
      case 305:
        v20 = aJoysup;
        goto LABEL_391;
      case 306:
        v19 = strcpy(String, aJoysdown);
        break;
      case 307:
        v20 = aJoysleft;
        goto LABEL_391;
      case 308:
        v19 = strcpy(String, aJoysright);
        break;
      case 319:
        v20 = aJoyaxisx;
        goto LABEL_391;
      case 320:
        v19 = strcpy(String, aJoyaxisy);
        break;
      case 321:
        v20 = aJoyaxisz;
        goto LABEL_391;
      case 339:
        v19 = strcpy(String, aJoyrotx);
        break;
      case 340:
        v20 = aJoyroty;
        goto LABEL_391;
      case 341:
        v19 = strcpy(String, aJoyrotz);
        break;
      case 382:
        v20 = aUnbound;
        goto LABEL_391;
      case 355:
        v19 = strcpy(String, aRim0xaxis);
        break;
      case 356:
        v20 = aRim1xaxis;
        goto LABEL_391;
      case 357:
        v19 = strcpy(String, aRim2xaxis);
        break;
      case 360:
        v20 = aRim0yaxis;
        goto LABEL_391;
      case 361:
        v19 = strcpy(String, aRim1yaxis);
        break;
      case 362:
        v20 = aRim2yaxis;
        goto LABEL_391;
      case 365:
        v19 = strcpy(String, aRim0btn1);
        break;
      case 366:
        v20 = aRim0btn2;
        goto LABEL_391;
      case 367:
        v19 = strcpy(String, aRim0btn3);
        break;
      case 368:
        v20 = aRim0btn4;
        goto LABEL_391;
      case 369:
        v19 = strcpy(String, aRim0btn5);
        break;
      case 370:
        v20 = aRim1btn1;
        goto LABEL_391;
      case 371:
        v19 = strcpy(String, aRim1btn2);
        break;
      case 372:
        v20 = aRim1btn3;
        goto LABEL_391;
      case 373:
        v19 = strcpy(String, aRim1btn4);
        break;
      case 374:
        v20 = aRim1btn5;
        goto LABEL_391;
      case 375:
        v19 = strcpy(String, aRim2btn1);
        break;
      case 376:
        v20 = aRim2btn2;
        goto LABEL_391;
      case 377:
        v19 = strcpy(String, aRim2btn3);
        break;
      case 378:
        v20 = aRim2btn4;
        goto LABEL_391;
      case 379:
        v19 = strcpy(String, aRim2btn5);
        break;
      default:
        if ( v18 > 355 )
        {
          v20 = aRawinput;
LABEL_391:
          strcpy(String, v20);
        }
        v19 = String;
        break;
    }
  }
  dword_4D7898[v17] = (int)strdup_malloc(v19);
  if ( dword_4D7968 )
    crt_free((LPVOID)dword_4D7968);
  v21 = config_key_pick_perk;
  if ( config_key_pick_perk <= 255 )
  {
    if ( GetKeyNameTextA(config_key_pick_perk << 16, String, 63) )
    {
      v22 = String;
    }
    else
    {
      switch ( v21 )
      {
        case 1:
          v22 = aDikEscape;
          break;
        case 2:
          v22 = aDik1;
          break;
        case 3:
          v22 = aDik2;
          break;
        case 4:
          v22 = aDik3;
          break;
        case 5:
          v22 = aDik4;
          break;
        case 6:
          v22 = aDik5;
          break;
        case 7:
          v22 = aDik6;
          break;
        case 8:
          v22 = aDik7;
          break;
        case 9:
          v22 = aDik8;
          break;
        case 10:
          v22 = aDik9;
          break;
        case 11:
          v22 = aDik0;
          break;
        case 12:
          v22 = aMinus;
          break;
        case 13:
          v22 = aEquals;
          break;
        case 14:
          v22 = aBack;
          break;
        case 15:
          v22 = (const char *)&off_47186C;
          break;
        case 16:
          v22 = aQ;
          break;
        case 17:
          v22 = aW;
          break;
        case 18:
          v22 = aE;
          break;
        case 19:
          v22 = aR;
          break;
        case 20:
          v22 = aT;
          break;
        case 21:
          v22 = aY;
          break;
        case 22:
          v22 = aU;
          break;
        case 23:
          v22 = aI;
          break;
        case 24:
          v22 = aO;
          break;
        case 25:
          v22 = aP;
          break;
        case 26:
          v22 = aLbracket;
          break;
        case 27:
          v22 = aRbracket;
          break;
        case 28:
          v22 = aReturn;
          break;
        case 29:
          v22 = aLcontrol;
          break;
        case 30:
          v22 = aA;
          break;
        case 31:
          v22 = aS_3;
          break;
        case 32:
          v22 = aD_1;
          break;
        case 33:
          v22 = asc_471808;
          break;
        case 34:
          v22 = aG;
          break;
        case 35:
          v22 = asc_471800;
          break;
        case 36:
          v22 = aJ;
          break;
        case 37:
          v22 = aK;
          break;
        case 38:
          v22 = asc_4717F4;
          break;
        case 39:
          v22 = aSemicolon;
          break;
        case 40:
          v22 = aApostrophe;
          break;
        case 41:
          v22 = aGrave;
          break;
        case 42:
          v22 = aLshift;
          break;
        case 43:
          v22 = aBackslash;
          break;
        case 44:
          v22 = aZ;
          break;
        case 45:
          v22 = asc_4717B8;
          break;
        case 46:
          v22 = aC;
          break;
        case 47:
          v22 = aV;
          break;
        case 48:
          v22 = aB;
          break;
        case 49:
          v22 = aN;
          break;
        case 50:
          v22 = aM;
          break;
        case 51:
          v22 = aComma;
          break;
        case 52:
          v22 = aPeriod;
          break;
        case 53:
          v22 = aSlash;
          break;
        case 54:
          v22 = aRshift;
          break;
        case 55:
          v22 = aMultiply;
          break;
        case 56:
          v22 = aLmenu;
          break;
        case 57:
          v22 = aSpace;
          break;
        case 58:
          v22 = aCapital;
          break;
        case 59:
          v22 = aF1;
          break;
        case 60:
          v22 = aF2;
          break;
        case 61:
          v22 = aF3;
          break;
        case 62:
          v22 = aF4;
          break;
        case 63:
          v22 = aF5;
          break;
        case 64:
          v22 = aF6;
          break;
        case 65:
          v22 = aF7;
          break;
        case 66:
          v22 = aF8;
          break;
        case 67:
          v22 = aF9;
          break;
        case 68:
          v22 = aF10;
          break;
        case 69:
          v22 = aNumlock;
          break;
        case 70:
          v22 = aScroll;
          break;
        case 71:
          v22 = aNumpad7;
          break;
        case 72:
          v22 = aNumpad8;
          break;
        case 73:
          v22 = aNumpad9;
          break;
        case 74:
          v22 = aSubtract;
          break;
        case 75:
          v22 = aNumpad4;
          break;
        case 76:
          v22 = aNumpad5;
          break;
        case 77:
          v22 = aNumpad6;
          break;
        case 78:
          v22 = (const char *)&off_4716E8;
          break;
        case 79:
          v22 = aNumpad1;
          break;
        case 80:
          v22 = aNumpad2;
          break;
        case 81:
          v22 = aNumpad3;
          break;
        case 82:
          v22 = aNumpad0;
          break;
        case 83:
          v22 = aDecimal;
          break;
        case 86:
          v22 = aOem102;
          break;
        case 87:
          v22 = aF11;
          break;
        case 88:
          v22 = aF12;
          break;
        case 100:
          v22 = aF13;
          break;
        case 101:
          v22 = aF14;
          break;
        case 102:
          v22 = aF15;
          break;
        case 112:
          v22 = aKana;
          break;
        case 115:
          v22 = aAbntC1;
          break;
        case 121:
          v22 = aConvert;
          break;
        case 123:
          v22 = aNoconvert;
          break;
        case 125:
          v22 = aYen;
          break;
        case 126:
          v22 = aAbntC2;
          break;
        case 141:
          v22 = aNumpadequals;
          break;
        case 144:
          v22 = aPrevtrack;
          break;
        case 145:
          v22 = aAt;
          break;
        case 146:
          v22 = aColon;
          break;
        case 147:
          v22 = aUnderline;
          break;
        case 148:
          v22 = aKanji;
          break;
        case 149:
          v22 = aStop;
          break;
        case 150:
          v22 = aAx;
          break;
        case 151:
          v22 = aUnlabeled;
          break;
        case 153:
          v22 = aNexttrack;
          break;
        case 156:
          v22 = aNumpadenter;
          break;
        case 157:
          v22 = aRcontrol;
          break;
        case 160:
          v22 = aMute;
          break;
        case 161:
          v22 = aCalculator;
          break;
        case 162:
          v22 = aPlaypause;
          break;
        case 164:
          v22 = aMediastop;
          break;
        case 174:
          v22 = aVolumedown;
          break;
        case 176:
          v22 = aVolumeup;
          break;
        case 178:
          v22 = aWebhome;
          break;
        case 179:
          v22 = aNumpadcomma;
          break;
        case 181:
          v22 = aDivide;
          break;
        case 183:
          v22 = aSysrq;
          break;
        case 184:
          v22 = aRmenu;
          break;
        case 197:
          v22 = aPause;
          break;
        case 199:
          v22 = aHome;
          break;
        case 200:
          v22 = aUp;
          break;
        case 201:
          v22 = aPrior;
          break;
        case 203:
          v22 = aLeft;
          break;
        case 205:
          v22 = aRight;
          break;
        case 207:
          v22 = (const char *)&off_47155C;
          break;
        case 208:
          v22 = aDown;
          break;
        case 209:
          v22 = aNext;
          break;
        case 210:
          v22 = aInsert;
          break;
        case 211:
          v22 = aDelete;
          break;
        case 219:
          v22 = aLwin;
          break;
        case 220:
          v22 = aRwin;
          break;
        case 221:
          v22 = aApps;
          break;
        case 222:
          v22 = aPower;
          break;
        case 223:
          v22 = aSleep;
          break;
        case 227:
          v22 = aWake;
          break;
        case 229:
          v22 = aWebsearch;
          break;
        case 230:
          v22 = aWebfavorites;
          break;
        case 231:
          v22 = aWebrefresh;
          break;
        case 232:
          v22 = aWebstop;
          break;
        case 233:
          v22 = aWebforward;
          break;
        case 234:
          v22 = aWebback;
          break;
        case 235:
          v22 = aMycomputer;
          break;
        case 236:
          v22 = aMail;
          break;
        case 237:
          v22 = aMediaselect;
          break;
        default:
          v22 = aUnknown;
          break;
      }
    }
  }
  else
  {
    switch ( config_key_pick_perk )
    {
      case 256:
        strcpy(String, aMouse1);
        v22 = String;
        break;
      case 257:
        v23 = aMouse2;
        goto LABEL_648;
      case 258:
        strcpy(String, aMouse3);
        v22 = String;
        break;
      case 259:
        v23 = aMouse4;
        goto LABEL_648;
      case 260:
        strcpy(String, aMouse5);
        v22 = String;
        break;
      case 265:
        v23 = aMwheelup;
        goto LABEL_648;
      case 266:
        strcpy(String, aMwheeldown);
        v22 = String;
        break;
      case 287:
        v23 = aJoys1;
        goto LABEL_648;
      case 288:
        strcpy(String, aJoys2);
        v22 = String;
        break;
      case 289:
        v23 = aJoys3;
        goto LABEL_648;
      case 290:
        strcpy(String, aJoys4);
        v22 = String;
        break;
      case 291:
        v23 = aJoys5;
        goto LABEL_648;
      case 292:
        strcpy(String, aJoys6);
        v22 = String;
        break;
      case 293:
        v23 = aJoys7;
        goto LABEL_648;
      case 294:
        strcpy(String, aJoys8);
        v22 = String;
        break;
      case 295:
        v23 = aJoys9;
        goto LABEL_648;
      case 296:
        strcpy(String, aJoys10);
        v22 = String;
        break;
      case 297:
        v23 = aJoys11;
        goto LABEL_648;
      case 298:
        strcpy(String, aJoys12);
        v22 = String;
        break;
      case 305:
        v23 = aJoysup;
        goto LABEL_648;
      case 306:
        strcpy(String, aJoysdown);
        v22 = String;
        break;
      case 307:
        v23 = aJoysleft;
        goto LABEL_648;
      case 308:
        strcpy(String, aJoysright);
        v22 = String;
        break;
      case 319:
        v23 = aJoyaxisx;
        goto LABEL_648;
      case 320:
        strcpy(String, aJoyaxisy);
        v22 = String;
        break;
      case 321:
        v23 = aJoyaxisz;
        goto LABEL_648;
      case 339:
        strcpy(String, aJoyrotx);
        v22 = String;
        break;
      case 340:
        v23 = aJoyroty;
        goto LABEL_648;
      case 341:
        strcpy(String, aJoyrotz);
        v22 = String;
        break;
      case 382:
        v23 = aUnbound;
        goto LABEL_648;
      case 355:
        strcpy(String, aRim0xaxis);
        v22 = String;
        break;
      case 356:
        v23 = aRim1xaxis;
        goto LABEL_648;
      case 357:
        strcpy(String, aRim2xaxis);
        v22 = String;
        break;
      case 360:
        v23 = aRim0yaxis;
        goto LABEL_648;
      case 361:
        strcpy(String, aRim1yaxis);
        v22 = String;
        break;
      case 362:
        v23 = aRim2yaxis;
        goto LABEL_648;
      case 365:
        strcpy(String, aRim0btn1);
        v22 = String;
        break;
      case 366:
        v23 = aRim0btn2;
        goto LABEL_648;
      case 367:
        strcpy(String, aRim0btn3);
        v22 = String;
        break;
      case 368:
        v23 = aRim0btn4;
        goto LABEL_648;
      case 369:
        strcpy(String, aRim0btn5);
        v22 = String;
        break;
      case 370:
        v23 = aRim1btn1;
        goto LABEL_648;
      case 371:
        strcpy(String, aRim1btn2);
        v22 = String;
        break;
      case 372:
        v23 = aRim1btn3;
        goto LABEL_648;
      case 373:
        strcpy(String, aRim1btn4);
        v22 = String;
        break;
      case 374:
        v23 = aRim1btn5;
        goto LABEL_648;
      case 375:
        strcpy(String, aRim2btn1);
        v22 = String;
        break;
      case 376:
        v23 = aRim2btn2;
        goto LABEL_648;
      case 377:
        strcpy(String, aRim2btn3);
        v22 = String;
        break;
      case 378:
        v23 = aRim2btn4;
        goto LABEL_648;
      case 379:
        strcpy(String, aRim2btn5);
        v22 = String;
        break;
      default:
        if ( config_key_pick_perk > 355 )
        {
          v23 = aRawinput;
LABEL_648:
          strcpy(String, v23);
        }
        v22 = String;
        break;
    }
  }
  dword_4D7968 = (int)strdup_malloc(v22);
  if ( dword_4D7978 )
    crt_free((LPVOID)dword_4D7978);
  v24 = config_key_reload;
  if ( config_key_reload <= 255 )
  {
    if ( GetKeyNameTextA(config_key_reload << 16, String, 63) )
    {
      v25 = String;
    }
    else
    {
      switch ( v24 )
      {
        case 1:
          v25 = aDikEscape;
          break;
        case 2:
          v25 = aDik1;
          break;
        case 3:
          v25 = aDik2;
          break;
        case 4:
          v25 = aDik3;
          break;
        case 5:
          v25 = aDik4;
          break;
        case 6:
          v25 = aDik5;
          break;
        case 7:
          v25 = aDik6;
          break;
        case 8:
          v25 = aDik7;
          break;
        case 9:
          v25 = aDik8;
          break;
        case 10:
          v25 = aDik9;
          break;
        case 11:
          v25 = aDik0;
          break;
        case 12:
          v25 = aMinus;
          break;
        case 13:
          v25 = aEquals;
          break;
        case 14:
          v25 = aBack;
          break;
        case 15:
          v25 = (const char *)&off_47186C;
          break;
        case 16:
          v25 = aQ;
          break;
        case 17:
          v25 = aW;
          break;
        case 18:
          v25 = aE;
          break;
        case 19:
          v25 = aR;
          break;
        case 20:
          v25 = aT;
          break;
        case 21:
          v25 = aY;
          break;
        case 22:
          v25 = aU;
          break;
        case 23:
          v25 = aI;
          break;
        case 24:
          v25 = aO;
          break;
        case 25:
          v25 = aP;
          break;
        case 26:
          v25 = aLbracket;
          break;
        case 27:
          v25 = aRbracket;
          break;
        case 28:
          v25 = aReturn;
          break;
        case 29:
          v25 = aLcontrol;
          break;
        case 30:
          v25 = aA;
          break;
        case 31:
          v25 = aS_3;
          break;
        case 32:
          v25 = aD_1;
          break;
        case 33:
          v25 = asc_471808;
          break;
        case 34:
          v25 = aG;
          break;
        case 35:
          v25 = asc_471800;
          break;
        case 36:
          v25 = aJ;
          break;
        case 37:
          v25 = aK;
          break;
        case 38:
          v25 = asc_4717F4;
          break;
        case 39:
          v25 = aSemicolon;
          break;
        case 40:
          v25 = aApostrophe;
          break;
        case 41:
          v25 = aGrave;
          break;
        case 42:
          v25 = aLshift;
          break;
        case 43:
          v25 = aBackslash;
          break;
        case 44:
          v25 = aZ;
          break;
        case 45:
          v25 = asc_4717B8;
          break;
        case 46:
          v25 = aC;
          break;
        case 47:
          v25 = aV;
          break;
        case 48:
          v25 = aB;
          break;
        case 49:
          v25 = aN;
          break;
        case 50:
          v25 = aM;
          break;
        case 51:
          v25 = aComma;
          break;
        case 52:
          v25 = aPeriod;
          break;
        case 53:
          v25 = aSlash;
          break;
        case 54:
          v25 = aRshift;
          break;
        case 55:
          v25 = aMultiply;
          break;
        case 56:
          v25 = aLmenu;
          break;
        case 57:
          v25 = aSpace;
          break;
        case 58:
          v25 = aCapital;
          break;
        case 59:
          v25 = aF1;
          break;
        case 60:
          v25 = aF2;
          break;
        case 61:
          v25 = aF3;
          break;
        case 62:
          v25 = aF4;
          break;
        case 63:
          v25 = aF5;
          break;
        case 64:
          v25 = aF6;
          break;
        case 65:
          v25 = aF7;
          break;
        case 66:
          v25 = aF8;
          break;
        case 67:
          v25 = aF9;
          break;
        case 68:
          v25 = aF10;
          break;
        case 69:
          v25 = aNumlock;
          break;
        case 70:
          v25 = aScroll;
          break;
        case 71:
          v25 = aNumpad7;
          break;
        case 72:
          v25 = aNumpad8;
          break;
        case 73:
          v25 = aNumpad9;
          break;
        case 74:
          v25 = aSubtract;
          break;
        case 75:
          v25 = aNumpad4;
          break;
        case 76:
          v25 = aNumpad5;
          break;
        case 77:
          v25 = aNumpad6;
          break;
        case 78:
          v25 = (const char *)&off_4716E8;
          break;
        case 79:
          v25 = aNumpad1;
          break;
        case 80:
          v25 = aNumpad2;
          break;
        case 81:
          v25 = aNumpad3;
          break;
        case 82:
          v25 = aNumpad0;
          break;
        case 83:
          v25 = aDecimal;
          break;
        case 86:
          v25 = aOem102;
          break;
        case 87:
          v25 = aF11;
          break;
        case 88:
          v25 = aF12;
          break;
        case 100:
          v25 = aF13;
          break;
        case 101:
          v25 = aF14;
          break;
        case 102:
          v25 = aF15;
          break;
        case 112:
          v25 = aKana;
          break;
        case 115:
          v25 = aAbntC1;
          break;
        case 121:
          v25 = aConvert;
          break;
        case 123:
          v25 = aNoconvert;
          break;
        case 125:
          v25 = aYen;
          break;
        case 126:
          v25 = aAbntC2;
          break;
        case 141:
          v25 = aNumpadequals;
          break;
        case 144:
          v25 = aPrevtrack;
          break;
        case 145:
          v25 = aAt;
          break;
        case 146:
          v25 = aColon;
          break;
        case 147:
          v25 = aUnderline;
          break;
        case 148:
          v25 = aKanji;
          break;
        case 149:
          v25 = aStop;
          break;
        case 150:
          v25 = aAx;
          break;
        case 151:
          v25 = aUnlabeled;
          break;
        case 153:
          v25 = aNexttrack;
          break;
        case 156:
          v25 = aNumpadenter;
          break;
        case 157:
          v25 = aRcontrol;
          break;
        case 160:
          v25 = aMute;
          break;
        case 161:
          v25 = aCalculator;
          break;
        case 162:
          v25 = aPlaypause;
          break;
        case 164:
          v25 = aMediastop;
          break;
        case 174:
          v25 = aVolumedown;
          break;
        case 176:
          v25 = aVolumeup;
          break;
        case 178:
          v25 = aWebhome;
          break;
        case 179:
          v25 = aNumpadcomma;
          break;
        case 181:
          v25 = aDivide;
          break;
        case 183:
          v25 = aSysrq;
          break;
        case 184:
          v25 = aRmenu;
          break;
        case 197:
          v25 = aPause;
          break;
        case 199:
          v25 = aHome;
          break;
        case 200:
          v25 = aUp;
          break;
        case 201:
          v25 = aPrior;
          break;
        case 203:
          v25 = aLeft;
          break;
        case 205:
          v25 = aRight;
          break;
        case 207:
          v25 = (const char *)&off_47155C;
          break;
        case 208:
          v25 = aDown;
          break;
        case 209:
          v25 = aNext;
          break;
        case 210:
          v25 = aInsert;
          break;
        case 211:
          v25 = aDelete;
          break;
        case 219:
          v25 = aLwin;
          break;
        case 220:
          v25 = aRwin;
          break;
        case 221:
          v25 = aApps;
          break;
        case 222:
          v25 = aPower;
          break;
        case 223:
          v25 = aSleep;
          break;
        case 227:
          v25 = aWake;
          break;
        case 229:
          v25 = aWebsearch;
          break;
        case 230:
          v25 = aWebfavorites;
          break;
        case 231:
          v25 = aWebrefresh;
          break;
        case 232:
          v25 = aWebstop;
          break;
        case 233:
          v25 = aWebforward;
          break;
        case 234:
          v25 = aWebback;
          break;
        case 235:
          v25 = aMycomputer;
          break;
        case 236:
          v25 = aMail;
          break;
        case 237:
          v25 = aMediaselect;
          break;
        default:
          v25 = aUnknown;
          break;
      }
    }
  }
  else
  {
    switch ( config_key_reload )
    {
      case 256:
        v25 = strcpy(String, aMouse1);
        break;
      case 257:
        v26 = aMouse2;
        goto LABEL_905;
      case 258:
        v25 = strcpy(String, aMouse3);
        break;
      case 259:
        v26 = aMouse4;
        goto LABEL_905;
      case 260:
        v25 = strcpy(String, aMouse5);
        break;
      case 265:
        v26 = aMwheelup;
        goto LABEL_905;
      case 266:
        v25 = strcpy(String, aMwheeldown);
        break;
      case 287:
        v26 = aJoys1;
        goto LABEL_905;
      case 288:
        v25 = strcpy(String, aJoys2);
        break;
      case 289:
        v26 = aJoys3;
        goto LABEL_905;
      case 290:
        v25 = strcpy(String, aJoys4);
        break;
      case 291:
        v26 = aJoys5;
        goto LABEL_905;
      case 292:
        v25 = strcpy(String, aJoys6);
        break;
      case 293:
        v26 = aJoys7;
        goto LABEL_905;
      case 294:
        v25 = strcpy(String, aJoys8);
        break;
      case 295:
        v26 = aJoys9;
        goto LABEL_905;
      case 296:
        v25 = strcpy(String, aJoys10);
        break;
      case 297:
        v26 = aJoys11;
        goto LABEL_905;
      case 298:
        v25 = strcpy(String, aJoys12);
        break;
      case 305:
        v26 = aJoysup;
        goto LABEL_905;
      case 306:
        v25 = strcpy(String, aJoysdown);
        break;
      case 307:
        v26 = aJoysleft;
        goto LABEL_905;
      case 308:
        v25 = strcpy(String, aJoysright);
        break;
      case 319:
        v26 = aJoyaxisx;
        goto LABEL_905;
      case 320:
        v25 = strcpy(String, aJoyaxisy);
        break;
      case 321:
        v26 = aJoyaxisz;
        goto LABEL_905;
      case 339:
        v25 = strcpy(String, aJoyrotx);
        break;
      case 340:
        v26 = aJoyroty;
        goto LABEL_905;
      case 341:
        v25 = strcpy(String, aJoyrotz);
        break;
      case 382:
        v26 = aUnbound;
        goto LABEL_905;
      case 355:
        v25 = strcpy(String, aRim0xaxis);
        break;
      case 356:
        v26 = aRim1xaxis;
        goto LABEL_905;
      case 357:
        v25 = strcpy(String, aRim2xaxis);
        break;
      case 360:
        v26 = aRim0yaxis;
        goto LABEL_905;
      case 361:
        v25 = strcpy(String, aRim1yaxis);
        break;
      case 362:
        v26 = aRim2yaxis;
        goto LABEL_905;
      case 365:
        v25 = strcpy(String, aRim0btn1);
        break;
      case 366:
        v26 = aRim0btn2;
        goto LABEL_905;
      case 367:
        v25 = strcpy(String, aRim0btn3);
        break;
      case 368:
        v26 = aRim0btn4;
        goto LABEL_905;
      case 369:
        v25 = strcpy(String, aRim0btn5);
        break;
      case 370:
        v26 = aRim1btn1;
        goto LABEL_905;
      case 371:
        v25 = strcpy(String, aRim1btn2);
        break;
      case 372:
        v26 = aRim1btn3;
        goto LABEL_905;
      case 373:
        v25 = strcpy(String, aRim1btn4);
        break;
      case 374:
        v26 = aRim1btn5;
        goto LABEL_905;
      case 375:
        v25 = strcpy(String, aRim2btn1);
        break;
      case 376:
        v26 = aRim2btn2;
        goto LABEL_905;
      case 377:
        v25 = strcpy(String, aRim2btn3);
        break;
      case 378:
        v26 = aRim2btn4;
        goto LABEL_905;
      case 379:
        v25 = strcpy(String, aRim2btn5);
        break;
      default:
        if ( config_key_reload > 355 )
        {
          v26 = aRawinput;
LABEL_905:
          strcpy(String, v26);
        }
        v25 = String;
        break;
    }
  }
  dword_4D7978 = (int)strdup_malloc(v25);
  v27 = dword_478E64;
  if ( dword_478E64 != -1 )
  {
    if ( dword_4D7898[4 * dword_478E64] )
    {
      crt_free((LPVOID)dword_4D7898[4 * dword_478E64]);
      v27 = dword_478E64;
    }
    v28 = 4 * v27;
    dword_4D7898[v28] = (int)strdup_malloc(asc_478884);
    byte_4D789E[v28 * 4] = 0;
  }
  flt_496604 = 0.69999999;
  v147[0] = dword_4965F8;
  v141 = v141 - 14.0;
  v147[2] = dword_496600;
  v147[1] = dword_4965FC;
  v147[3] = 1060320051;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v141)),
    COERCE_FLOAT(LODWORD(v142)),
    aAiming);
  (*(void (__thiscall **)(int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, v147);
  v145 = 0.0;
  v146 = 13.0;
  v29 = *(_DWORD *)grim_interface_ptr;
  v30 = FUN_0044ecf0(&v139, &v145);
  (*(void (__thiscall **)(int, int, int, int))(v29 + 212))(grim_interface_ptr, v30, 1130627072, 1065353216);
  v142 = v142 + 18.0;
  v141 = v141 + 8.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1060320051);
  if ( config_aim_scheme[dword_4D79DC] == 1 )
  {
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aTorsoLeft);
    v145 = 128.0;
    v146 = 0.0;
    v31 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(v29, v31, (int)&unk_4D7908, v103, v115, v127);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aTorsoRight);
    v145 = 128.0;
    v146 = 0.0;
    v32 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(v29, v32, (int)&unk_4D7918, v104, v116, v128);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
  }
  if ( config_aim_scheme[dword_4D79DC] == 4 )
  {
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aAimUpDownAxis);
    v145 = 128.0;
    v146 = 0.0;
    v33 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v33, (int)&unk_4D7928, v103, v115, v127);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aAimLeftRightAx);
    v145 = 128.0;
    v146 = 0.0;
    v34 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v34, (int)&unk_4D7938, v105, v117, v129);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
  }
  (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v141)),
    COERCE_FLOAT(LODWORD(v142)),
    aFire);
  v145 = 128.0;
  v146 = 0.0;
  v35 = (float *)FUN_0044ecf0(&v139, &v145);
  ui_menu_item_update(4, v35, (int)&unk_4D78D8, v103, v115, v127);
  v142 = v142 + 16.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1060320051);
  v142 = v142 + 8.0;
  v141 = v141 - 8.0;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
    grim_interface_ptr,
    COERCE_FLOAT(LODWORD(v141)),
    COERCE_FLOAT(LODWORD(v142)),
    aMoving);
  (*(void (__thiscall **)(int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, v147);
  v145 = 0.0;
  v146 = 13.0;
  v36 = *(_DWORD *)grim_interface_ptr;
  v37 = FUN_0044ecf0(&v139, &v145);
  (*(void (__thiscall **)(int, int, int, int))(v36 + 212))(grim_interface_ptr, v37, 1130627072, 1065353216);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1060320051);
  v38 = config_player_mode_flags[dword_4D79DC];
  v141 = v141 + 8.0;
  v142 = v142 + 18.0;
  if ( v38 == 2 )
  {
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aMoveUp);
    v145 = 128.0;
    v146 = 0.0;
    v39 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v39, (int)dword_4D7898, v106, v118, v130);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aMoveDown);
    v145 = 128.0;
    v146 = 0.0;
    v40 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v40, (int)&unk_4D78A8, v107, v119, v131);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aMoveLeft);
    v145 = 128.0;
    v146 = 0.0;
    v41 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v41, (int)&unk_4D78B8, v108, v120, v132);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aMoveRight);
    v145 = 128.0;
    v146 = 0.0;
    v42 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v42, (int)&unk_4D78C8, v109, v121, v133);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
  }
  if ( config_player_mode_flags[dword_4D79DC] == 1 )
  {
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aForward);
    v145 = 128.0;
    v146 = 0.0;
    v43 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v43, (int)dword_4D7898, v106, v118, v130);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aBackwards);
    v145 = 128.0;
    v146 = 0.0;
    v44 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v44, (int)&unk_4D78A8, v110, v122, v134);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aTurnLeft);
    v145 = 128.0;
    v146 = 0.0;
    v45 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v45, (int)&unk_4D78B8, v111, v123, v135);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aTurnRight);
    v145 = 128.0;
    v146 = 0.0;
    v46 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v46, (int)&unk_4D78C8, v112, v124, v136);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
  }
  if ( config_player_mode_flags[dword_4D79DC] == 4 )
  {
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aMoveToCursor);
    v145 = 128.0;
    v146 = 0.0;
    v47 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v47, (int)&dword_4D7978, v106, v118, v130);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
  }
  if ( config_player_mode_flags[dword_4D79DC] == 3 )
  {
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aUpDownAxis);
    v145 = 128.0;
    v146 = 0.0;
    v48 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v48, (int)&unk_4D7948, v106, v118, v130);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aLeftRightAxis);
    v145 = 128.0;
    v146 = 0.0;
    v49 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v49, (int)&unk_4D7958, v113, v125, v137);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
  }
  v142 = v142 + 8.0;
  v141 = v141 - 8.0;
  if ( !dword_4D79DC )
  {
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1065353216);
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aMisc);
    (*(void (__thiscall **)(int, _DWORD *))(*(_DWORD *)grim_interface_ptr + 272))(grim_interface_ptr, v147);
    v145 = 0.0;
    v146 = 13.0;
    v50 = *(_DWORD *)grim_interface_ptr;
    v51 = FUN_0044ecf0(&v139, &v145);
    (*(void (__thiscall **)(int, int, int, int))(v50 + 212))(grim_interface_ptr, v51, 1130627072, 1065353216);
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    v142 = v142 + 18.0;
    v141 = v141 + 8.0;
    (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      COERCE_FLOAT(LODWORD(v141)),
      COERCE_FLOAT(LODWORD(v142)),
      aLevelUp);
    v145 = 128.0;
    v146 = 0.0;
    v52 = (float *)FUN_0044ecf0(&v139, &v145);
    ui_menu_item_update(4, v52, (int)&dword_4D7968, v106, v118, v130);
    v142 = v142 + 16.0;
    (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      1060320051);
    if ( config_player_mode_flags[dword_4D79DC] != 4 )
    {
      (*(void (__cdecl **)(int, float, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        COERCE_FLOAT(LODWORD(v141)),
        COERCE_FLOAT(LODWORD(v142)),
        aReload);
      v145 = 128.0;
      v146 = 0.0;
      v53 = (float *)FUN_0044ecf0(&v139, &v145);
      ui_menu_item_update(4, v53, (int)&dword_4D7978, v114, v126, v138);
      v142 = v142 + 16.0;
      (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
        grim_interface_ptr,
        1065353216,
        1065353216,
        1065353216,
        1060320051);
    }
    v142 = v142 + 8.0;
    v141 = v141 - 8.0;
  }
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1063675494);
  v54 = dword_478E64;
  v141 = v141 - 27.0;
  if ( dword_478E64 != -1 )
  {
    if ( dword_478E64 < 9 || dword_478E64 >= 13 )
    {
      v142 = v142 + 12.0;
      v93 = v141 + 54.0;
      (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v93),
        COERCE_FLOAT(LODWORD(v142)),
        aAssignControlE);
      v99 = v142 + 13.0;
      v94 = v141 + 54.0;
      (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v94),
        LODWORD(v99),
        aPressEscapeToC);
      v54 = dword_478E64;
    }
    else
    {
      v142 = v142 + 12.0;
      v90 = v141 + 54.0;
      (*(void (__cdecl **)(int, _DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v90),
        COERCE_FLOAT(LODWORD(v142)),
        aMoveJoystickPa);
      v97 = v142 + 13.0;
      v91 = v141 + 54.0;
      (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v91),
        LODWORD(v97),
        aAxisYouWantToA);
      v98 = v142 + 26.0;
      v92 = v141 + 54.0;
      (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v92),
        LODWORD(v98),
        aPressEscapeToC);
      v54 = dword_478E64;
    }
  }
  v55 = byte_4D79E0;
  v56 = 0;
  v57 = (char *)&unk_4D789D;
  v141 = v141 + 27.0;
  do
  {
    if ( *v57 )
    {
      v55 = 0;
      v58 = v54 == -1;
      v54 = -1;
      if ( v58 )
        v54 = v56;
    }
    v57 += 16;
    ++v56;
  }
  while ( (int)v57 < (int)&byte_4D798D );
  dword_478E64 = v54;
  byte_4D79E0 = v55;
  if ( v54 != -1 )
  {
    if ( v54 < 9 || v54 >= 13 )
    {
      if ( !input_any_key_pressed() )
        byte_4D79E0 = 1;
      if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 1) )
      {
        byte_4871CA = 0;
        dword_478E64 = -1;
        byte_4D79E0 = 0;
      }
      else if ( byte_4D79E0 )
      {
        v73 = 2;
        if ( dword_478E64 >= 13 )
        {
          do
          {
            if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
                   grim_interface_ptr,
                   v73) )
            {
              (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
              if ( dword_478E64 == 13 )
                config_key_pick_perk = v73;
              else
                config_key_reload = v73;
              dword_478E64 = -1;
              byte_4D79E0 = 0;
            }
            ++v73;
          }
          while ( v73 < 383 );
          v77 = sub_448B50();
          if ( v77 )
          {
            if ( dword_478E64 == 13 )
              config_key_pick_perk = v77;
            else
              config_key_reload = v77;
          }
        }
        else
        {
          do
          {
            if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 128))(
                   grim_interface_ptr,
                   v73) )
            {
              (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
              v74 = dword_478E64 + 16 * dword_4D79DC;
              dword_478E64 = -1;
              byte_4D79E0 = 0;
              config_p1_move_forward[v74] = v73;
            }
            ++v73;
          }
          while ( v73 < 383 );
          v75 = sub_448B50();
          if ( v75 )
          {
            v76 = dword_478E64 + 16 * dword_4D79DC;
            dword_478E64 = -1;
            byte_4D79E0 = 0;
            config_p1_move_forward[v76] = v75;
          }
        }
      }
    }
    else
    {
      if ( !v55 && !input_any_key_pressed() )
      {
        byte_4D79E0 = 1;
        memset(&flt_4D79E4, 0, 0x40u);
      }
      if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 1) )
      {
        byte_4871CA = 0;
        goto LABEL_1093;
      }
      if ( byte_4D79E0 )
      {
        v139 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
                 grim_interface_ptr,
                 319);
        LODWORD(v139) &= ~0x80000000;
        if ( flt_4D79E4 <= (double)v139 )
          v59 = v139;
        else
          v59 = flt_4D79E4;
        flt_4D79E4 = v59;
        v139 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
                 grim_interface_ptr,
                 320);
        LODWORD(v139) &= ~0x80000000;
        if ( flt_4D79E8 <= (double)v139 )
          v60 = v139;
        else
          v60 = flt_4D79E8;
        flt_4D79E8 = v60;
        v139 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
                 grim_interface_ptr,
                 321);
        LODWORD(v139) &= ~0x80000000;
        if ( flt_4D79EC <= (double)v139 )
          v61 = v139;
        else
          v61 = flt_4D79EC;
        flt_4D79EC = v61;
        v139 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
                 grim_interface_ptr,
                 339);
        LODWORD(v139) &= ~0x80000000;
        if ( flt_4D79F0 <= (double)v139 )
          v62 = v139;
        else
          v62 = flt_4D79F0;
        flt_4D79F0 = v62;
        v139 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
                 grim_interface_ptr,
                 340);
        LODWORD(v139) &= ~0x80000000;
        if ( flt_4D79F4 <= (double)v139 )
          v63 = v139;
        else
          v63 = flt_4D79F4;
        flt_4D79F4 = v63;
        v139 = ((double (__thiscall *)(int, int))*(_DWORD *)(*(_DWORD *)grim_interface_ptr + 132))(
                 grim_interface_ptr,
                 341);
        LODWORD(v139) &= ~0x80000000;
        if ( flt_4D79F8 <= (double)v139 )
          v64 = v139;
        else
          v64 = flt_4D79F8;
        flt_4D79F8 = v64;
        v65 = 0;
        v66 = &flt_4D79E4;
        while ( *v66 <= 0.5 )
        {
          ++v66;
          ++v65;
          if ( (int)v66 >= (int)flt_4D7A00 )
            goto LABEL_1146;
        }
        v67 = dword_478E64 + 16 * dword_4D79DC;
        switch ( v65 )
        {
          case 0:
            v68 = grim_interface_ptr;
            config_p1_move_forward[v67] = 319;
            (*(void (__thiscall **)(int))(*(_DWORD *)v68 + 76))(v68);
            break;
          case 1:
            v69 = grim_interface_ptr;
            config_p1_move_forward[v67] = 320;
            (*(void (__thiscall **)(int))(*(_DWORD *)v69 + 76))(v69);
            break;
          case 2:
            v70 = grim_interface_ptr;
            config_p1_move_forward[v67] = 321;
            (*(void (__thiscall **)(int))(*(_DWORD *)v70 + 76))(v70);
            break;
          case 3:
            v71 = grim_interface_ptr;
            config_p1_move_forward[v67] = 339;
            (*(void (__thiscall **)(int))(*(_DWORD *)v71 + 76))(v71);
            break;
          case 4:
            v72 = grim_interface_ptr;
            config_p1_move_forward[v67] = 340;
            (*(void (__thiscall **)(int))(*(_DWORD *)v72 + 76))(v72);
            break;
          case 5:
            config_p1_move_forward[v67] = 341;
            goto LABEL_1124;
          default:
LABEL_1124:
            (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 76))(grim_interface_ptr);
            break;
        }
LABEL_1093:
        dword_478E64 = -1;
        byte_4D79E0 = 0;
      }
    }
  }
LABEL_1146:
  byte_4D7638 = 1;
  byte_4D76A8 = 1;
  byte_4D7660 = 1;
  byte_4D77F1 = 0;
  if ( dword_4D763C )
  {
    byte_4D76A8 = 0;
    byte_4D7660 = 0;
  }
  if ( dword_4D7664 )
  {
    byte_4D76A8 = 0;
    byte_4D7638 = 0;
  }
  if ( dword_4D76AC )
  {
    byte_4D7638 = 0;
    byte_4D7660 = 0;
  }
  if ( dword_4D763C || dword_4D76AC )
    byte_4D77F1 = 1;
  v145 = 10.0;
  v146 = 104.0;
  v78 = (float *)FUN_0044ecf0(&v139, &v145);
  v79 = ui_list_widget_update(v78, (int)&byte_4D7638);
  if ( v79 > -2
    && (input_primary_just_pressed()
     || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28)) )
  {
    dword_4D763C = 1 - dword_4D763C;
    if ( v79 >= 0 )
    {
      dword_4D7640 = v79;
      config_player_mode_flags[dword_4D79DC] = v79 + 1;
    }
  }
  v145 = 10.0;
  v146 = 62.0;
  v80 = (float *)FUN_0044ecf0(&v139, &v145);
  v81 = ui_list_widget_update(v80, (int)&byte_4D76A8);
  if ( v81 > -2
    && (input_primary_just_pressed()
     || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28)) )
  {
    dword_4D76AC = 1 - dword_4D76AC;
    if ( v81 >= 0 )
    {
      dword_4D76B0 = v81;
      config_aim_scheme[dword_4D79DC] = v81;
    }
  }
  v145 = 136.0;
  v146 = 16.0;
  v82 = (float *)FUN_0044ecf0(&v139, &v145);
  result = ui_list_widget_update(v82, (int)&byte_4D7660);
  v84 = result;
  if ( result > -2 )
  {
    if ( input_primary_just_pressed()
      || (result = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28),
          (_BYTE)result) )
    {
      result = 1 - dword_4D7664;
      dword_4D7664 = 1 - dword_4D7664;
      if ( v84 >= 0 )
      {
        v85 = config_aim_scheme[v84];
        v86 = config_player_mode_flags[v84] - 1;
        dword_4D7668 = v84;
        dword_4D79DC = v84;
        dword_4D76B0 = v85;
        dword_4D7640 = v86;
      }
    }
  }
  return result;
}

// FUN_0044ecf0 @ 0x0044ECF0
// [binja] float* __thiscall sub_44ecf0(float* arg1, float* arg2, float* arg3)
float *__thiscall sub_44ECF0(float *this, float *a2, float *a3)
{
  double v3; // st7

  v3 = a3[1] + *(this + 1);
  *a2 = *a3 + *this;
  a2[1] = v3;
  return a2;
}

// nullsub_89 @ 0x0044ED10
void __cdecl nullsub_89()
{
  ;
}

// nullsub_90 @ 0x0044ED20
void __cdecl nullsub_90()
{
  ;
}

// nullsub_91 @ 0x0044ED30
void __cdecl nullsub_91()
{
  ;
}

// nullsub_92 @ 0x0044ED40
void __cdecl nullsub_92()
{
  ;
}

// nullsub_93 @ 0x0044ED50
void __cdecl nullsub_93()
{
  ;
}

// nullsub_94 @ 0x0044ED60
void __cdecl nullsub_94()
{
  ;
}

// nullsub_95 @ 0x0044ED70
void __cdecl nullsub_95()
{
  ;
}

// sub_44ED80 @ 0x0044ED80
char sub_44ED80()
{
  int v0; // ecx
  int *v1; // eax
  int v2; // edx
  double v3; // st7
  int v4; // ecx
  int *v5; // eax
  int v6; // edx
  std::codecvt_base *v7; // ecx
  int v8; // esi
  int v9; // eax
  char result; // al
  float v11; // [esp+108h] [ebp-44h]
  float v12; // [esp+108h] [ebp-44h]
  float v13; // [esp+108h] [ebp-44h]
  float v14; // [esp+108h] [ebp-44h]
  float v15; // [esp+108h] [ebp-44h]
  float v16; // [esp+108h] [ebp-44h]
  float v17; // [esp+108h] [ebp-44h]
  float v18; // [esp+108h] [ebp-44h]
  int v19; // [esp+10Ch] [ebp-40h]
  float v20; // [esp+10Ch] [ebp-40h]
  int v21; // [esp+10Ch] [ebp-40h]
  float v22; // [esp+10Ch] [ebp-40h]
  float v23; // [esp+10Ch] [ebp-40h]
  float v24; // [esp+10Ch] [ebp-40h]
  float v25; // [esp+10Ch] [ebp-40h]
  float v26; // [esp+10Ch] [ebp-40h]
  float v27; // [esp+10Ch] [ebp-40h]
  float v28; // [esp+10Ch] [ebp-40h]
  float v29; // [esp+10Ch] [ebp-40h]
  int v30; // [esp+10Ch] [ebp-40h]
  float v31; // [esp+10Ch] [ebp-40h]
  float v32; // [esp+10Ch] [ebp-40h]
  float v33; // [esp+10Ch] [ebp-40h]
  float v34; // [esp+10Ch] [ebp-40h]
  int v35; // [esp+110h] [ebp-3Ch]
  int v36; // [esp+110h] [ebp-3Ch]
  float v37; // [esp+110h] [ebp-3Ch]
  int v38; // [esp+110h] [ebp-3Ch]
  float v39; // [esp+110h] [ebp-3Ch]
  int v40; // [esp+114h] [ebp-38h]
  int v41; // [esp+114h] [ebp-38h]
  int v42; // [esp+114h] [ebp-38h]
  float v43; // [esp+114h] [ebp-38h]
  float v44; // [esp+114h] [ebp-38h]
  float v45; // [esp+114h] [ebp-38h]
  float v46; // [esp+114h] [ebp-38h]
  float v47; // [esp+114h] [ebp-38h]
  char v48; // [esp+123h] [ebp-29h]
  float v49; // [esp+124h] [ebp-28h] BYREF
  float v50; // [esp+128h] [ebp-24h]
  float v51; // [esp+12Ch] [ebp-20h]
  float v52; // [esp+130h] [ebp-1Ch]
  float v53; // [esp+134h] [ebp-18h] BYREF
  float v54; // [esp+138h] [ebp-14h]
  _DWORD v55[4]; // [esp+13Ch] [ebp-10h] BYREF

  if ( (byte_4D7730 & 1) == 0 )
  {
    byte_4D75FE = 1;
    byte_4D7730 |= 1u;
    byte_4D760D = 0;
    byte_4D760C = 0;
    dword_4D7608 = 1065353216;
    dword_4D7604 = 0;
    dword_4D75F8 = 0;
    byte_4D75FC = 0;
    byte_4D75FD = 0;
    dword_4D7600 = 0;
    crt_atexit(nullsub_102);
  }
  dword_4D75F8 = (int)aQuests_0;
  if ( (byte_4D7730 & 2) == 0 )
  {
    byte_4D75A6 = 1;
    byte_4D7730 |= 2u;
    byte_4D75B5 = 0;
    byte_4D75B4 = 0;
    dword_4D75B0 = 1065353216;
    dword_4D75AC = 0;
    dword_4D75A0 = 0;
    byte_4D75A4 = 0;
    byte_4D75A5 = 0;
    dword_4D75A8 = 0;
    crt_atexit(nullsub_101);
  }
  dword_4D75A0 = (int)aRush;
  if ( (byte_4D7730 & 4) == 0 )
  {
    byte_4D76CE = 1;
    byte_4D7730 |= 4u;
    byte_4D76DD = 0;
    byte_4D76DC = 0;
    dword_4D76D8 = 1065353216;
    dword_4D76D4 = 0;
    dword_4D76C8 = 0;
    byte_4D76CC = 0;
    byte_4D76CD = 0;
    dword_4D76D0 = 0;
    crt_atexit(nullsub_100);
  }
  dword_4D76C8 = (int)aSurvival;
  if ( (byte_4D7730 & 8) == 0 )
  {
    byte_4D7616 = 1;
    byte_4D7730 |= 8u;
    byte_4D7625 = 0;
    byte_4D7624 = 0;
    dword_4D7620 = 1065353216;
    dword_4D761C = 0;
    dword_4D7610 = 0;
    byte_4D7614 = 0;
    byte_4D7615 = 0;
    dword_4D7618 = 0;
    crt_atexit(nullsub_99);
  }
  dword_4D7610 = (int)aTypOShooter;
  if ( (byte_4D7730 & 0x10) == 0 )
  {
    byte_4D7658 = 0;
    byte_4D7730 |= 0x10u;
    byte_4D7659 = 0;
    byte_4D765A = 0;
    dword_4D765C = 0;
    crt_atexit(nullsub_98);
  }
  dword_4D765C = (int)aHardcore;
  if ( (byte_4D7730 & 0x20) == 0 )
  {
    byte_4D75D6 = 1;
    byte_4D7730 |= 0x20u;
    byte_4D75E5 = 0;
    byte_4D75E4 = 0;
    dword_4D75E0 = 1065353216;
    dword_4D75DC = 0;
    dword_4D75D0 = 0;
    byte_4D75D4 = 0;
    byte_4D75D5 = 0;
    dword_4D75D8 = 0;
    crt_atexit(nullsub_97);
  }
  dword_4D75D0 = (int)aTutorial;
  v54 = *(float *)&dword_4894B4 + flt_4894D8;
  v51 = flt_4894D4 + *(float *)&dword_4894B0 + 330.0;
  v52 = v54 + 50.0;
  v50 = v52;
  v49 = flt_4894A0 - 64.0 + v51;
  v51 = v49;
  (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 196))(grim_interface_ptr, dword_48F7F4, 0);
  (*(void (__thiscall **)(int, _DWORD, int, int, int))(*(_DWORD *)grim_interface_ptr + 256))(
    grim_interface_ptr,
    0,
    1040187392,
    1065353216,
    1048576000);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    1,
    v19,
    v35,
    v40);
  v20 = v52 - 8.0;
  v11 = v49 - 64.0;
  (*(void (__stdcall **)(_DWORD, _DWORD, int, int))(*(_DWORD *)grim_interface_ptr + 284))(
    LODWORD(v11),
    LODWORD(v20),
    1124073472,
    1107296256);
  (*(void (__thiscall **)(int))(*(_DWORD *)grim_interface_ptr + 240))(grim_interface_ptr);
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    21,
    2,
    v21,
    v36,
    v41);
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1065353216);
  v48 = 0;
  if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 68))(grim_interface_ptr, 59) )
  {
    v48 = 1;
    v37 = v50 + 16.0;
    v22 = v49 + 132.0;
    (*(void (__cdecl **)(int, _DWORD, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 328))(
      grim_interface_ptr,
      LODWORD(v22),
      LODWORD(v37),
      aTimesPlayed);
  }
  if ( quest_unlock_index >= 40 && config_player_count <= 1 )
  {
    v50 = v50 + 26.0;
    if ( dword_485788 + dword_485644 + dword_485784 <= 0 )
    {
      if ( config_player_count == 1 )
        ui_button_update(&v49, (int)&dword_4D75D0);
      v50 = v50 + 28.0;
    }
    ui_button_update(&v49, (int)&dword_4D75F8);
    if ( v48 )
    {
      v4 = 0;
      v5 = &dword_485644;
      do
      {
        v6 = *v5++;
        v4 += v6;
      }
      while ( (int)v5 < (int)dword_4856E4 );
      v26 = v50 + 8.0;
      v15 = v49 + 158.0;
      (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v15),
        LODWORD(v26),
        aD_0,
        v4);
    }
    v50 = v50 + 28.0;
    ui_button_update(&v49, (int)&dword_4D75A0);
    if ( v48 )
    {
      v27 = v50 + 8.0;
      v16 = v49 + 158.0;
      (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v16),
        LODWORD(v27),
        aD_0,
        dword_485788);
    }
    v50 = v50 + 28.0;
    ui_button_update(&v49, (int)&dword_4D76C8);
    if ( v48 )
    {
      v28 = v50 + 8.0;
      v17 = v49 + 158.0;
      (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v17),
        LODWORD(v28),
        aD_0,
        dword_485784);
    }
    v50 = v50 + 28.0;
    if ( game_is_full_version(v7) )
    {
      if ( config_player_count == 1 )
        ui_button_update(&v49, (int)&dword_4D7610);
      if ( v48 )
      {
        v29 = v50 + 8.0;
        v18 = v49 + 158.0;
        (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
          grim_interface_ptr,
          LODWORD(v18),
          LODWORD(v29),
          aD_0,
          dword_48578C);
      }
    }
    v50 = v50 + 28.0;
    if ( dword_485788 + dword_485644 + dword_485784 > 0 )
    {
      ui_button_update(&v49, (int)&dword_4D75D0);
      v3 = v50 + 28.0;
LABEL_52:
      v50 = v3;
    }
  }
  else
  {
    v50 = v50 + 32.0;
    if ( dword_485788 + dword_485644 + dword_485784 <= 0 )
    {
      if ( config_player_count == 1 )
        ui_button_update(&v49, (int)&dword_4D75D0);
      v50 = v50 + 32.0;
    }
    ui_button_update(&v49, (int)&dword_4D75F8);
    if ( v48 )
    {
      v0 = 0;
      v1 = &dword_485644;
      do
      {
        v2 = *v1++;
        v0 += v2;
      }
      while ( (int)v1 < (int)dword_4856E4 );
      v23 = v50 + 8.0;
      v12 = v49 + 158.0;
      (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v12),
        LODWORD(v23),
        aD_0,
        v0);
    }
    v50 = v50 + 32.0;
    ui_button_update(&v49, (int)&dword_4D75A0);
    if ( v48 )
    {
      v24 = v50 + 8.0;
      v13 = v49 + 158.0;
      (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v13),
        LODWORD(v24),
        aD_0,
        dword_485788);
    }
    v50 = v50 + 32.0;
    ui_button_update(&v49, (int)&dword_4D76C8);
    if ( v48 )
    {
      v25 = v50 + 8.0;
      v14 = v49 + 158.0;
      (*(void (**)(int, _DWORD, _DWORD, char *, ...))(*(_DWORD *)grim_interface_ptr + 328))(
        grim_interface_ptr,
        LODWORD(v14),
        LODWORD(v25),
        aD_0,
        dword_485784);
    }
    v50 = v50 + 32.0;
    if ( dword_485788 + dword_485644 + dword_485784 > 0 )
    {
      if ( config_player_count == 1 )
        ui_button_update(&v49, (int)&dword_4D75D0);
      v3 = v50 + 32.0;
      goto LABEL_52;
    }
  }
  v55[0] = a1Player;
  v55[1] = a2Players;
  v55[2] = a3Players;
  v55[3] = a4Players;
  if ( (byte_4D7730 & 0x40) == 0 )
  {
    byte_4D79B8 = 1;
    byte_4D7730 |= 0x40u;
    dword_4D79D0 = 0;
    byte_4D79CC = 0;
    dword_4D79C0 = 0;
    dword_4D79BC = 0;
    dword_4D79C8 = 0;
    dword_4D79C4 = 0;
    crt_atexit(nullsub_96);
  }
  dword_4D79C0 = config_player_count - 1;
  dword_4D79C4 = (int)v55;
  dword_4D79C8 = 2;
  (*(void (__thiscall **)(int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 276))(
    grim_interface_ptr,
    1065353216,
    1065353216,
    1065353216,
    1062165545);
  v53 = v51 + 80.0;
  v54 = v52 + 1.0;
  v8 = ui_list_widget_update(&v53, (int)&byte_4D79B8);
  if ( v8 > -2
    && (input_primary_just_pressed()
     || (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 28)) )
  {
    v9 = 1 - dword_4D79BC;
    dword_4D79BC = 1 - dword_4D79BC;
    if ( v8 < 0 )
      goto LABEL_61;
    dword_4D79C0 = v8;
    config_player_count = v8 + 1;
    j_highscore_load_table();
  }
  v9 = dword_4D79BC;
LABEL_61:
  if ( v9 )
  {
    byte_4D76CE = 0;
    byte_4D75A6 = 0;
    byte_4D75FE = 0;
  }
  else
  {
    byte_4D76CE = 1;
    byte_4D75A6 = 1;
    byte_4D75FE = 1;
  }
  v49 = v49 - 55.0;
  v50 = v50 + 16.0;
  (*(void (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)grim_interface_ptr + 32))(
    grim_interface_ptr,
    24,
    1056964608,
    v30,
    v38,
    v42);
  if ( dword_4D7600 > 0 )
  {
    v43 = (double)dword_4D7600 * 0.00090000004;
    (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v43));
    v31 = v49 - 8.0;
    (*(void (__stdcall **)(_DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 324))(
      LODWORD(v31),
      COERCE_FLOAT(LODWORD(v50)),
      aUnlockNewWeapo);
  }
  if ( dword_4D75A8 > 0 )
  {
    v44 = (double)dword_4D75A8 * 0.00090000004;
    (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v44));
    v32 = v49 + 32.0;
    (*(void (__stdcall **)(_DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 324))(
      LODWORD(v32),
      COERCE_FLOAT(LODWORD(v50)),
      aFaceARushOfAli);
  }
  if ( dword_4D76D0 > 0 )
  {
    v45 = (double)dword_4D76D0 * 0.00090000004;
    (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v45));
    v33 = v49 + 20.0;
    (*(void (__stdcall **)(_DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 324))(
      LODWORD(v33),
      COERCE_FLOAT(LODWORD(v50)),
      aGainPerksAndWe);
  }
  if ( dword_4D7618 > 0 )
  {
    v46 = (double)dword_4D7618 * 0.00090000004;
    (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v46));
    v39 = v50 - 12.0;
    (*(void (__stdcall **)(float, _DWORD, char *))(*(_DWORD *)grim_interface_ptr + 324))(
      COERCE_FLOAT(LODWORD(v49)),
      LODWORD(v39),
      aUseYourTypingS);
  }
  if ( dword_4D75D8 > 0 )
  {
    v47 = (double)dword_4D75D8 * 0.00090000004;
    (*(void (__thiscall **)(int, int, int, int, _DWORD))(*(_DWORD *)grim_interface_ptr + 276))(
      grim_interface_ptr,
      1065353216,
      1065353216,
      1065353216,
      LODWORD(v47));
    v34 = v49 + 38.0;
    (*(void (__stdcall **)(_DWORD, float, char *))(*(_DWORD *)grim_interface_ptr + 324))(
      LODWORD(v34),
      COERCE_FLOAT(LODWORD(v50)),
      aLearnHowToPlay);
  }
  if ( byte_4D7615 )
  {
    render_pass_mode = 0;
    byte_487292 = 0;
    ui_transition_direction = 0;
    game_state_pending = 18;
    config_game_mode = 4;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    byte_48702C = 1;
  }
  if ( byte_4D75FD )
  {
    ui_transition_direction = 0;
    game_state_pending = 11;
  }
  if ( byte_4D75A5 )
  {
    byte_487292 = 0;
    ui_transition_direction = 0;
    game_state_pending = 9;
    config_game_mode = 2;
    byte_48702C = 1;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
  }
  if ( byte_4D76CD )
  {
    byte_487292 = 0;
    ui_transition_direction = 0;
    game_state_pending = 9;
    config_game_mode = 1;
    byte_48702C = 1;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
  }
  if ( byte_4D75D5 )
  {
    byte_487292 = 0;
    ui_transition_direction = 0;
    game_state_pending = 9;
    config_game_mode = 8;
    byte_48702C = 1;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
  }
  result = (*(int (__thiscall **)(int, int))(*(_DWORD *)grim_interface_ptr + 72))(grim_interface_ptr, 1);
  if ( result )
    return FUN_00447420();
  return result;
}

// nullsub_96 @ 0x0044FA30
void __cdecl nullsub_96()
{
  ;
}

// nullsub_97 @ 0x0044FA40
void __cdecl nullsub_97()
{
  ;
}

// nullsub_98 @ 0x0044FA50
void __cdecl nullsub_98()
{
  ;
}

// nullsub_99 @ 0x0044FA60
void __cdecl nullsub_99()
{
  ;
}

// nullsub_100 @ 0x0044FA70
void __cdecl nullsub_100()
{
  ;
}

// nullsub_101 @ 0x0044FA80
void __cdecl nullsub_101()
{
  ;
}

// nullsub_102 @ 0x0044FA90
void __cdecl nullsub_102()
{
  ;
}

// FUN_0044faa0 @ 0x0044FAA0
// [binja] char* sub_44faa0(char* arg1)
char __cdecl sub_44FAA0(int a1)
{
  char result; // al

  result = a1;
  if ( !a1 )
    return console_printf((int)&console_log_queue, aElemNull);
  *(_DWORD *)(a1 + 284) = -1;
  *(_DWORD *)(a1 + 516) = -1;
  *(_DWORD *)(a1 + 748) = -1;
  *(_DWORD *)(a1 + 32) = 1130954752;
  *(_DWORD *)(a1 + 36) = 1105199104;
  *(_DWORD *)(a1 + 40) = 1138196480;
  *(_DWORD *)(a1 + 764) = 256;
  *(_DWORD *)(a1 + 52) = 0;
  *(_DWORD *)(a1 + 56) = 0;
  *(_DWORD *)(a1 + 44) = 1116209152;
  *(_DWORD *)(a1 + 768) = 0;
  *(_BYTE *)a1 = 0;
  *(_DWORD *)(a1 + 48) = 57;
  *(_BYTE *)(a1 + 756) = 0;
  *(_DWORD *)(a1 + 16) = 300;
  *(_DWORD *)(a1 + 20) = 0;
  *(_BYTE *)(a1 + 2) = 0;
  *(_DWORD *)(a1 + 4) = 0;
  return result;
}

// FUN_0044fb50 @ 0x0044FB50
// [binja] float sub_44fb50(float arg1)
int __cdecl sub_44FB50(int a1)
{
  int result; // eax
  double v2; // st7
  double v3; // st7
  double v4; // st6
  double v5; // st6
  char v6; // cl
  int v7; // edx
  float *v8; // ecx
  double v9; // st7
  float v10; // [esp+0h] [ebp-8h]
  float v11; // [esp+0h] [ebp-8h]
  float v12; // [esp+4h] [ebp-4h]
  float v13; // [esp+4h] [ebp-4h]
  float v14; // [esp+4h] [ebp-4h]
  float v15; // [esp+4h] [ebp-4h]
  float v16; // [esp+Ch] [ebp+4h]

  result = a1;
  if ( (_UNKNOWN *)a1 != &unk_48C300 && (char *)a1 != &byte_48C618 )
  {
    v12 = *(float *)(a1 + 64) + *(float *)(a1 + 28);
    *(float *)(a1 + 32) = *(float *)(a1 + 60) + *(float *)(a1 + 24) + *(float *)(a1 + 32);
    *(float *)(a1 + 36) = v12 + *(float *)(a1 + 36);
    v13 = *(float *)(a1 + 64) + *(float *)(a1 + 28);
    *(float *)(a1 + 40) = *(float *)(a1 + 60) + *(float *)(a1 + 24) + *(float *)(a1 + 40);
    *(float *)(a1 + 44) = v13 + *(float *)(a1 + 44);
    v10 = *(float *)(a1 + 60) + *(float *)(a1 + 24);
    v2 = *(float *)(a1 + 64) + *(float *)(a1 + 28);
    *(float *)(a1 + 32) = v10;
    v14 = v2;
    v3 = *(float *)(a1 + 116) - *(float *)(a1 + 60);
    *(float *)(a1 + 36) = v14;
    *(float *)(a1 + 32) = v3 * 0.54000002 + *(float *)(a1 + 32);
    v4 = *(float *)(a1 + 120) - *(float *)(a1 + 64);
    v16 = v4;
    *(float *)(result + 36) = v4 * 0.28 + *(float *)(result + 36);
    v11 = *(float *)(result + 116) + *(float *)(result + 24);
    v5 = *(float *)(result + 120) + *(float *)(result + 28);
    *(float *)(result + 40) = v11;
    v6 = *(_BYTE *)(result + 788);
    v15 = v5;
    *(float *)(result + 44) = v15;
    *(float *)(result + 40) = *(float *)(result + 40) - v3 * 0.050000001;
    *(float *)(result + 44) = *(float *)(result + 44) - v16 * 0.1;
    if ( v6 )
    {
      v7 = 0;
      if ( *(int *)(result + 288) > 0 )
      {
        v8 = (float *)(result + 108);
        do
        {
          v9 = *(v8 - 7);
          v7 += 2;
          *(v8 - 7) = *v8;
          *v8 = v9;
          v8 += 14;
        }
        while ( v7 < *(_DWORD *)(result + 288) );
      }
    }
  }
  return result;
}

// sub_44FC70 @ 0x0044FC70
HINSTANCE sub_44FC70()
{
  byte_47EA50 = 1;
  byte_480851 = 1;
  return ShellExecuteA(0, Operation, File, 0, 0, 1);
}

// sub_44FCA0 @ 0x0044FCA0
void sub_44FCA0()
{
  byte_4D7A25 = 1;
}

// ui_menu_layout_init @ 0x0044FCB0
// initializes menu UI element layout and text textures
int sub_44FCB0()
{
  int *v0; // esi
  std::codecvt_base *v1; // ecx
  int v2; // ebp
  std::codecvt_base *v3; // ecx
  int v4; // edi
  int i; // esi
  int v6; // edx
  int v7; // edx
  int v8; // eax
  int v9; // eax
  float v10; // edx
  int v11; // edx
  int v12; // edx
  int v13; // eax
  int k; // eax
  float *v15; // ecx
  float *v16; // ecx
  double v17; // st7
  float *v18; // ecx
  int j; // eax
  float *v20; // ecx
  float *v21; // ecx
  double v22; // st7
  float *v23; // ecx
  int v24; // ecx
  int v25; // edx
  int *v26; // eax
  float *v27; // eax
  double v28; // st7
  int v29; // edx
  double v30; // st7
  double v31; // st7
  int v32; // esi
  int *v33; // ecx
  double v34; // st7
  int m; // eax
  float *v36; // edx
  float *v37; // edx
  float *v38; // edx
  double v39; // st6
  float *v40; // edx
  int v41; // esi
  int *v42; // eax
  double v43; // st7
  int ii; // ecx
  float *v45; // edx
  float *v46; // edx
  float *v47; // edx
  double v48; // st6
  float *v49; // edx
  double v50; // st7
  int n; // ecx
  float *v52; // edx
  float *v53; // edx
  float *v54; // edx
  double v55; // st6
  float *v56; // edx
  int jj; // eax
  float *v58; // ecx
  float *v59; // ecx
  double v60; // st7
  float *v61; // ecx
  int kk; // eax
  float *v63; // ecx
  float *v64; // ecx
  double v65; // st7
  float *v66; // ecx
  int mm; // eax
  float *v68; // ecx
  float *v69; // ecx
  double v70; // st7
  float *v71; // ecx
  int nn; // eax
  float *v73; // ecx
  float *v74; // ecx
  double v75; // st7
  float *v76; // ecx
  int i2; // eax
  float *v78; // ecx
  float *v79; // ecx
  double v80; // st7
  float *v81; // ecx
  int i1; // eax
  float *v83; // ecx
  float *v84; // ecx
  double v85; // st7
  float *v86; // ecx
  float *v87; // eax
  double v88; // st7
  int *v89; // eax
  int v90; // ecx
  int *v91; // esi
  int result; // eax
  int v93; // [esp+18h] [ebp-68h]
  int v94; // [esp+18h] [ebp-68h]
  int v95; // [esp+18h] [ebp-68h]
  int v96; // [esp+18h] [ebp-68h]
  float v97; // [esp+1Ch] [ebp-64h]
  float v98; // [esp+20h] [ebp-60h]
  float v99; // [esp+20h] [ebp-60h]
  int v100; // [esp+20h] [ebp-60h]
  float v101; // [esp+20h] [ebp-60h]
  float v102; // [esp+2Ch] [ebp-54h]
  float v103; // [esp+3Ch] [ebp-44h]
  float v104; // [esp+4Ch] [ebp-34h]
  float v105; // [esp+5Ch] [ebp-24h]
  std::codecvt_base *v106; // [esp+60h] [ebp-20h] BYREF
  float v107; // [esp+64h] [ebp-1Ch]
  _BYTE v108[16]; // [esp+70h] [ebp-10h] BYREF

  screen_fade_alpha = 0.0;
  dword_48723C = 0;
  byte_48702C = 0;
  flt_487288 = (double)*(int *)config_screen_width * 0.0015625;
  flt_48728C = (double)config_screen_height * 0.0020833334;
  memset(ui_element_table_end, 0, 0xA4u);
  ui_element_table_end[0] = (int)&byte_487290;
  dword_48F16C = (int)&byte_4875A8;
  dword_48F170 = (int)&byte_488208;
  dword_48F174 = (int)&byte_4878C0;
  dword_48F178 = (int)&byte_487BD8;
  dword_48F17C = (int)&byte_487EF0;
  if ( *(_BYTE *)(*(int (__thiscall **)(int, std::codecvt_base **, int))(*(_DWORD *)grim_interface_ptr + 36))(
                   grim_interface_ptr,
                   &v106,
                   100) )
  {
    dword_48F180 = (int)&byte_488520;
    dword_48F184 = (int)&byte_488838;
  }
  else
  {
    dword_48F184 = (int)&byte_488520;
    dword_48F180 = (int)&byte_488838;
  }
  dword_48F1E4 = (int)&byte_488B50;
  dword_48F1E8 = (int)&byte_488E68;
  dword_48F190 = (int)&unk_489180;
  dword_48F194 = (int)&byte_489498;
  dword_48F198 = (int)&byte_4897B0;
  dword_48F1A4 = (int)&unk_48A410;
  dword_48F1A8 = (int)&unk_48A728;
  dword_48F1AC = (int)&unk_48AA40;
  dword_48F1B4 = (int)&unk_48AD58;
  dword_48F1B8 = (int)&unk_48B070;
  dword_48F1BC = (int)&unk_48B388;
  dword_48F1C0 = (int)&unk_48B6A0;
  dword_48F1C4 = (int)&byte_48B9B8;
  dword_48F1C8 = (int)&byte_48BCD0;
  dword_48F1CC = (int)&byte_48BFE8;
  dword_48F1D0 = (int)&unk_48C300;
  dword_48F1D4 = (int)&byte_48C618;
  dword_48F1D8 = (int)&byte_48EB38;
  dword_48F1DC = (int)&unk_48C930;
  dword_48F1E0 = (int)&byte_48CC48;
  dword_48F19C = (int)&unk_48CF60;
  dword_48F1A0 = (int)&byte_48D278;
  dword_48F1B0 = (int)&byte_48D590;
  dword_48F188 = (int)&unk_489AC8;
  dword_48F18C = (int)&byte_489DE0;
  dword_48F1EC = (int)&byte_48A0F8;
  dword_48F1F0 = (int)&unk_48D8A8;
  dword_48F1F4 = (int)&byte_48DBC0;
  dword_48F1F8 = (int)&unk_48DED8;
  dword_48F1FC = (int)&byte_48E1F0;
  dword_48F200 = (int)&unk_48E508;
  dword_48F204 = (int)&byte_48E820;
  ui_element_table_start = (int)&byte_48EE50;
  v0 = ui_element_table_end;
  do
    FUN_0044faa0(*v0++);
  while ( (int)v0 < (int)byte_48F20C );
  qmemcpy(&unk_4872CC, &unk_48FAC0, 0xE8u);
  dword_4872AC = 1116471296;
  v98 = (float)(*(_DWORD *)config_screen_width + 4);
  dword_4872A8 = LODWORD(v98);
  if ( *(int *)config_screen_width <= 640 )
    dword_4872AC = 1114636288;
  dword_48F7F4 = texture_get_or_load_alt(aUiUiItemtextsJ);
  dword_48F7F8 = texture_get_or_load_alt(aUiUiTextreaper);
  dword_48F7FC = texture_get_or_load_alt(aUiUiTextcontro);
  dword_48F800 = texture_get_or_load_alt(aUiUiTextpickap);
  dword_48F804 = texture_get_or_load_alt(aUiUiTextwelldo);
  qmemcpy(&unk_488244, &unk_48FBA8, 0xE8u);
  dword_488220 = -1032847360;
  dword_488224 = 1129447424;
  *(float *)&v106 = 270.0;
  v107 = -38.0;
  ui_element_set_rect((int)&unk_48832C, 124.0, 30.0, (float *)&v106);
  dword_488238 = 48;
  dword_48823C = (int)sub_44FC70;
  if ( game_is_full_version(v1) )
    dword_48823C = (int)sub_447350;
  qmemcpy(&unk_4878FC, &unk_48FBA8, 0xE8u);
  dword_4878D8 = -1032847360;
  dword_4878DC = 1132920832;
  *(float *)&v106 = 270.0;
  v107 = -38.0;
  ui_element_set_rect((int)&unk_4879E4, 124.0, 30.0, (float *)&v106);
  dword_4878F4 = (int)sub_447400;
  dword_4878F0 = 25;
  *(float *)&v106 = 270.0;
  qmemcpy(&unk_487C14, &unk_48FBA8, 0xE8u);
  dword_487BF0 = -1032847360;
  dword_487BF4 = 1134886912;
  v107 = -38.0;
  ui_element_set_rect((int)&unk_487CFC, 124.0, 30.0, (float *)&v106);
  dword_487C0C = (int)sub_447370;
  dword_487C08 = 24;
  *(float *)&v106 = 270.0;
  qmemcpy(&unk_487F2C, &unk_48FBA8, 0xE8u);
  dword_487F08 = -1032847360;
  dword_487F0C = 1136852992;
  v107 = -38.0;
  ui_element_set_rect((int)&unk_488014, 124.0, 30.0, (float *)&v106);
  dword_487F24 = (int)sub_447390;
  dword_487F20 = 31;
  v2 = 5;
  if ( *(_BYTE *)(*(int (__thiscall **)(int, std::codecvt_base **, int))(*(_DWORD *)grim_interface_ptr + 36))(
                   grim_interface_ptr,
                   &v106,
                   100) )
  {
    qmemcpy(&unk_48855C, &unk_48FBA8, 0xE8u);
    dword_488538 = -1032847360;
    dword_48853C = 1138819072;
    *(float *)&v106 = 270.0;
    v107 = -38.0;
    ui_element_set_rect((int)&unk_488644, 124.0, 30.0, (float *)&v106);
    dword_488550 = 48;
    dword_488554 = (int)sub_44FCA0;
    v2 = 6;
  }
  qmemcpy(&unk_488874, &unk_48FBA8, 0xE8u);
  *(float *)&v106 = 270.0;
  dword_488850 = -1032847360;
  v97 = (float)(60 * v2 + 150);
  v107 = -38.0;
  dword_488854 = LODWORD(v97);
  ui_element_set_rect((int)&unk_48895C, 124.0, 30.0, (float *)&v106);
  v4 = 0;
  dword_48886C = (int)sub_447450;
  dword_488868 = 16;
  v93 = 0;
  for ( i = 2; i <= 7; ++i )
  {
    if ( i == 2 && game_is_full_version(v3) )
    {
      v4 = 4;
      v93 = 4;
    }
    if ( *(_BYTE *)(*(int (__thiscall **)(int, _BYTE *, int))(*(_DWORD *)grim_interface_ptr + 36))(
                     grim_interface_ptr,
                     v108,
                     100) )
    {
      *(_DWORD *)(ui_element_table_end[i] + 516) = dword_48F7F4;
      v11 = ui_element_table_end[i];
      *(_DWORD *)(v11 + 312) = 0;
      v104 = (double)v93 * 0.125;
      *(float *)&v106 = 0.0;
      *(float *)(v11 + 316) = v104;
      v12 = ui_element_table_end[i];
      *(_DWORD *)(v12 + 340) = 1065353216;
      *(float *)(v12 + 344) = v104;
      v13 = ui_element_table_end[i];
      *(_DWORD *)(v13 + 368) = 1065353216;
      v3 = v106;
      v105 = (double)(v4 + 1) * 0.125;
      v107 = v105;
      *(float *)(v13 + 372) = v105;
      v9 = ui_element_table_end[i];
      v10 = v107;
      *(_DWORD *)(v9 + 396) = v3;
    }
    else
    {
      if ( i == 6 )
      {
        v4 = 6;
        v93 = 6;
      }
      *(_DWORD *)(ui_element_table_end[i] + 516) = dword_48F7F4;
      v6 = ui_element_table_end[i];
      *(_DWORD *)(v6 + 312) = 0;
      v102 = (double)v93 * 0.125;
      *(float *)(v6 + 316) = v102;
      v7 = ui_element_table_end[i];
      *(_DWORD *)(v7 + 340) = 1065353216;
      *(float *)(v7 + 344) = v102;
      v8 = ui_element_table_end[i];
      *(_DWORD *)(v8 + 368) = 1065353216;
      v3 = 0;
      v103 = (double)(v4 + 1) * 0.125;
      *(float *)(v8 + 372) = v103;
      v9 = ui_element_table_end[i];
      v10 = v103;
      *(_DWORD *)(v9 + 396) = 0;
    }
    *(float *)(v9 + 400) = v10;
    if ( i == 2 && game_is_full_version(v3) )
      v4 = 0;
    v93 = ++v4;
    if ( v4 == 4 )
    {
      v4 = 5;
      v93 = 5;
    }
  }
  if ( *(int *)config_screen_width > 640 )
  {
    if ( *(int *)config_screen_width > 800 && *(int *)config_screen_width <= 1024 )
    {
      for ( j = 0;
            j < 112;
            *(float *)(j + ui_element_table_end[0] + 264) = *(float *)(j + ui_element_table_end[0] + 264) + 10.0 )
      {
        v20 = (float *)(j + ui_element_table_end[0] + 60);
        *v20 = *v20 * 1.2;
        v20[1] = v20[1] * 1.2;
        v21 = (float *)(j + ui_element_table_end[0] + 524);
        *v21 = *v21 * 1.2;
        v21[1] = v21[1] * 1.2;
        v22 = *(float *)(j + ui_element_table_end[0] + 292) * 1.2;
        v23 = (float *)(j + ui_element_table_end[0] + 292);
        j += 28;
        *v23 = v22;
        v23[1] = v23[1] * 1.2;
        *(float *)(j + ui_element_table_end[0] + 32) = *(float *)(j + ui_element_table_end[0] + 32) + 10.0;
        *(float *)(j + ui_element_table_end[0] + 496) = *(float *)(j + ui_element_table_end[0] + 496) + 10.0;
      }
    }
  }
  else
  {
    for ( k = 0; k < 112; *(float *)(k + dword_48F16C + 268) = *(float *)(k + dword_48F16C + 268) - 14.0 )
    {
      v15 = (float *)(k + ui_element_table_end[0] + 60);
      *v15 = *v15 * 0.80000001;
      v15[1] = v15[1] * 0.80000001;
      v16 = (float *)(k + ui_element_table_end[0] + 524);
      *v16 = *v16 * 0.80000001;
      v16[1] = v16[1] * 0.80000001;
      v17 = *(float *)(k + ui_element_table_end[0] + 292) * 0.80000001;
      v18 = (float *)(k + ui_element_table_end[0] + 292);
      k += 28;
      *v18 = v17;
      v18[1] = v18[1] * 0.80000001;
      *(float *)(k + ui_element_table_end[0] + 32) = *(float *)(k + ui_element_table_end[0] + 32) + 10.0;
      *(float *)(k + ui_element_table_end[0] + 496) = *(float *)(k + ui_element_table_end[0] + 496) + 10.0;
      *(float *)(k + ui_element_table_end[0] + 264) = *(float *)(k + ui_element_table_end[0] + 264) + 10.0;
      *(float *)(k + dword_48F16C + 36) = *(float *)(k + dword_48F16C + 36) - 14.0;
      *(float *)(k + dword_48F16C + 500) = *(float *)(k + dword_48F16C + 500) - 14.0;
    }
  }
  v24 = -20;
  v25 = 100;
  v26 = &dword_48F16C;
  v94 = -20;
  do
  {
    *(_DWORD *)(*v26 + 20) += v25;
    *(_DWORD *)(*v26 + 16) += v25;
    if ( v24 > 0 )
      *(float *)(*v26 + 24) = *(float *)(*v26 + 24) - (double)v94;
    v24 += 20;
    v25 += 100;
    ++v26;
    v94 = v24;
  }
  while ( v24 <= 100 );
  if ( game_is_full_version((std::codecvt_base *)v24) )
    byte_486FAA = 1;
  qmemcpy(&flt_488B8C, &unk_48FC90, 0xE8u);
  *(float *)&v106 = flt_488B70 + 280.0;
  dword_488B68 = -1036779520;
  dword_488B6C = 1129447424;
  v107 = flt_488B74 + 180.0;
  dword_488B7C = LODWORD(v107);
  dword_488B84 = 0;
  dword_488B88 = (int)sub_4475D0;
  dword_488B78 = (int)v106;
  dword_488B54 = 1;
  qmemcpy(&unk_488EA4, &unk_48FBA8, 0xE8u);
  dword_488E80 = -1034158080;
  dword_488E84 = 1138163712;
  *(float *)&v106 = 270.0;
  v107 = -38.0;
  ui_element_set_rect((int)&unk_488F8C, 124.0, 30.0, (float *)&v106);
  dword_48906C = dword_48F7F4;
  dword_488FA0 = 0;
  dword_488FA4 = 1063256064;
  dword_488FC0 = 1063256064;
  dword_488FBC = 1065353216;
  dword_488FD8 = 1065353216;
  dword_488FF4 = 0;
  dword_488FDC = 1065353216;
  dword_488FF8 = 1065353216;
  dword_488E9C = (int)FUN_00447420;
  dword_488E6C = 1;
  dword_488E98 = 48;
  qmemcpy(&unk_48B9F4, &unk_48FBA8, 0xE8u);
  dword_48B9D0 = -1032847360;
  dword_48B9D4 = 1129447424;
  qmemcpy(&unk_48BADC, &unk_487CFC, 0xE8u);
  dword_48B9C8 += 100;
  dword_48B9CC += 100;
  dword_48B9EC = (int)sub_447370;
  qmemcpy(&unk_48BD0C, &unk_48FBA8, 0xE8u);
  dword_48BCE8 = -1029701632;
  dword_48BCEC = 1132920832;
  qmemcpy(&unk_48BDF4, &unk_48895C, 0xE8u);
  dword_48BD04 = (int)sub_4474E0;
  dword_48BCE0 += 200;
  dword_48BCE4 += 200;
  qmemcpy(&unk_48C024, &unk_48FBA8, 0xE8u);
  dword_48C000 = -1027080192;
  dword_48C004 = 1134886912;
  qmemcpy(&unk_48C10C, &unk_488F8C, 0xE8u);
  dword_48BFF8 += 300;
  dword_48C318 = -1020329984;
  dword_48BFFC += 300;
  dword_48C31C = 1110704128;
  dword_48C01C = (int)sub_447490;
  dword_48C018 = 48;
  dword_48C304 = 1;
  qmemcpy(&flt_48C654, &unk_48FD78, 0xE8u);
  flt_48C630 = -45.0;
  flt_48C634 = 110.0;
  dword_48C628 += 100;
  dword_48C62C += 100;
  dword_48919C = 1125187584;
  dword_48C61C = 1;
  dword_489198 = -1032847360;
  dword_489184 = 1;
  qmemcpy(&flt_4894D4, &unk_48FE60, 0xE8u);
  *(float *)&v106 = -45.0;
  v107 = 210.0;
  dword_4894B0 = -1036779520;
  dword_4894B4 = 1129447424;
  v27 = (float *)&unk_4895BC;
  do
  {
    v28 = *v27 + 10.0;
    v27 += 7;
    *(v27 - 7) = v28;
    *(v27 - 6) = *(v27 - 6) + 10.0;
  }
  while ( (int)v27 < (int)flt_48962C );
  dword_4894D0 = (int)sub_44ED80;
  dword_48949C = 1;
  qmemcpy(&unk_4897EC, &unk_48FBA8, 0xE8u);
  dword_4897CC = 1139212288;
  dword_4897C8 = -1034158080;
  qmemcpy(&unk_4898D4, &unk_488F8C, 0xE8u);
  dword_4897E4 = (int)FUN_00447420;
  dword_48C948 = -1020329984;
  dword_4897B4 = 1;
  dword_4897E0 = 48;
  dword_48C94C = 1110704128;
  dword_48C934 = 1;
  qmemcpy(&flt_48CC84, &unk_48FD78, 0xE8u);
  flt_48CC64 = 110.0;
  flt_48CC60 = -45.0;
  dword_48CC5C += 100;
  dword_48CC58 += 100;
  dword_48CF78 = -1020002304;
  dword_48CF7C = 1124532224;
  v107 = 200.0;
  dword_48CC4C = 1;
  dword_48CF64 = 1;
  *(float *)&v106 = -165.0;
  qmemcpy(&flt_48D2B4, &unk_48FC90, 0xE8u);
  dword_48D294 = 1128792064;
  v29 = *(_DWORD *)config_screen_width;
  dword_48D290 = -1020985344;
  if ( *(int *)config_screen_width <= 640 )
    dword_48D290 = -1019805696;
  dword_48D2B0 = (int)sub_448CD0;
  dword_48D27C = 1;
  qmemcpy(&unk_48D5CC, &unk_48FBA8, 0xE8u);
  dword_48D5A8 = -1021640704;
  dword_48D5AC = 1137836032;
  qmemcpy(&unk_48D6B4, &unk_488F8C, 0xE8u);
  dword_48D8C0 = -1020329984;
  dword_48D8C4 = 1110704128;
  dword_48D5C4 = (int)sub_447370;
  dword_48D594 = 0;
  dword_48D5C0 = 48;
  dword_48D8AC = 1;
  qmemcpy(&flt_48DBFC, &unk_48FD78, 0xE8u);
  flt_48DBD8 = -45.0;
  flt_48DBDC = 110.0;
  dword_48DBD4 += 100;
  dword_48DBD0 += 100;
  dword_48DEF4 = 1123287040;
  dword_48DBC4 = 1;
  dword_48DEF0 = -1022951424;
  dword_48DEDC = 1;
  qmemcpy(&flt_48E22C, &unk_48FD78, 0xE8u);
  dword_48E20C = 1127809024;
  dword_48E208 = -1063256064;
  dword_48E524 = 1123287040;
  dword_48E228 = (int)sub_447D40;
  dword_48E1F4 = 1;
  dword_48E520 = -1022951424;
  dword_48E50C = 1;
  qmemcpy(&flt_48E85C, &unk_48FD78, 0xE8u);
  v107 = 185.0;
  *(float *)&v106 = -5.0;
  flt_48E83C = 185.0;
  flt_48E838 = -5.0;
  dword_48E824 = 1;
  qmemcpy(&flt_48A134, &unk_48FC90, 0xE8u);
  v99 = (float)(*(_DWORD *)config_screen_width - 350);
  flt_48A110 = v99;
  flt_48A114 = 200.0;
  if ( *(int *)config_screen_width <= 800 )
  {
    v31 = v99;
    if ( *(int *)config_screen_width <= 640 )
      v30 = v31 + 10.0;
    else
      v30 = v31 - 30.0;
  }
  else
  {
    v30 = v99 - 65.0;
  }
  flt_48A110 = v30;
  *(float *)&v106 = -190.0;
  v107 = 122.0;
  dword_48A0FC = 1;
  byte_48A40C = 1;
  dword_489AE4 = 1123287040;
  dword_489AE0 = -1020985344;
  if ( *(int *)config_screen_width <= 640 )
    dword_489AE0 = -1017708544;
  dword_489ACC = 1;
  qmemcpy(&flt_489E1C, &unk_48FD78, 0xE8u);
  *(float *)&v106 = -60.0;
  v107 = 185.0;
  flt_489DFC = 185.0;
  flt_489DF8 = -35.0;
  if ( *(int *)config_screen_width <= 640 )
    flt_489DF8 = -85.0;
  v32 = -11;
  dword_489DE4 = 1;
  dword_48EB48 = 500;
  v33 = &dword_48F16C;
  v95 = -11;
  do
  {
    if ( v29 <= 640 )
    {
      v34 = (double)v95;
      for ( m = 0; m < 112; m += 28 )
      {
        v36 = (float *)(*v33 + m + 60);
        *v36 = *v36 * 0.89999998;
        v36[1] = v36[1] * 0.89999998;
        v37 = (float *)(*v33 + m + 524);
        *v37 = *v37 * 0.89999998;
        v37[1] = v37[1] * 0.89999998;
        v38 = (float *)(*v33 + m + 292);
        *v38 = *v38 * 0.89999998;
        v38[1] = v38[1] * 0.89999998;
        *(float *)(*v33 + m + 64) = *(float *)(*v33 + m + 64) - v34;
        *(float *)(*v33 + m + 528) = *(float *)(*v33 + m + 528) - v34;
        v39 = *(float *)(*v33 + m + 296);
        v40 = (float *)(*v33 + m + 296);
        *v40 = v39 - v34;
      }
      v29 = *(_DWORD *)config_screen_width;
    }
    v32 += 11;
    ++v33;
    v95 = v32;
  }
  while ( v32 <= 55 );
  v41 = -11;
  v42 = &dword_48F1C0;
  v96 = -5;
  v100 = -11;
  do
  {
    if ( v29 > 640 )
    {
      if ( v29 > 800 )
        goto LABEL_69;
      v50 = (double)v96;
      for ( n = 0; n < 112; n += 28 )
      {
        v52 = (float *)(*v42 + n + 60);
        *v52 = *v52 * 0.89999998;
        v52[1] = v52[1] * 0.89999998;
        v53 = (float *)(*v42 + n + 524);
        *v53 = *v53 * 0.89999998;
        v53[1] = v53[1] * 0.89999998;
        v54 = (float *)(*v42 + n + 292);
        *v54 = *v54 * 0.89999998;
        v54[1] = v54[1] * 0.89999998;
        *(float *)(*v42 + n + 64) = *(float *)(*v42 + n + 64) - v50;
        *(float *)(*v42 + n + 528) = *(float *)(*v42 + n + 528) - v50;
        v55 = *(float *)(*v42 + n + 296);
        v56 = (float *)(*v42 + n + 296);
        *v56 = v55 - v50;
      }
    }
    else
    {
      v43 = (double)v100;
      for ( ii = 0; ii < 112; ii += 28 )
      {
        v45 = (float *)(*v42 + ii + 60);
        *v45 = *v45 * 0.80000001;
        v45[1] = v45[1] * 0.80000001;
        v46 = (float *)(*v42 + ii + 524);
        *v46 = *v46 * 0.80000001;
        v46[1] = v46[1] * 0.80000001;
        v47 = (float *)(*v42 + ii + 292);
        *v47 = *v47 * 0.80000001;
        v47[1] = v47[1] * 0.80000001;
        *(float *)(*v42 + ii + 64) = *(float *)(*v42 + ii + 64) - v43;
        *(float *)(*v42 + ii + 528) = *(float *)(*v42 + ii + 528) - v43;
        v48 = *(float *)(*v42 + ii + 296);
        v49 = (float *)(*v42 + ii + 296);
        *v49 = v48 - v43;
      }
    }
    v29 = *(_DWORD *)config_screen_width;
LABEL_69:
    v41 += 11;
    ++v42;
    v100 = v41;
    v96 += 5;
  }
  while ( v41 <= 22 );
  if ( v29 <= 640 )
  {
    for ( jj = 0; jj < 112; *(float *)(jj + dword_48F1E8 + 268) = *(float *)(jj + dword_48F1E8 + 268) - 11.0 )
    {
      v58 = (float *)(jj + dword_48F1E8 + 60);
      *v58 = *v58 * 0.80000001;
      v58[1] = v58[1] * 0.80000001;
      v59 = (float *)(jj + dword_48F1E8 + 524);
      *v59 = *v59 * 0.80000001;
      v59[1] = v59[1] * 0.80000001;
      v60 = *(float *)(jj + dword_48F1E8 + 292) * 0.80000001;
      v61 = (float *)(jj + dword_48F1E8 + 292);
      jj += 28;
      *v61 = v60;
      v61[1] = v61[1] * 0.80000001;
      *(float *)(jj + dword_48F1E8 + 36) = *(float *)(jj + dword_48F1E8 + 36) - 11.0;
      *(float *)(jj + dword_48F1E8 + 500) = *(float *)(jj + dword_48F1E8 + 500) - 11.0;
    }
    goto LABEL_77;
  }
  if ( v29 <= 800 )
  {
    for ( kk = 0; kk < 112; *(float *)(kk + dword_48F1E8 + 268) = *(float *)(kk + dword_48F1E8 + 268) - 3.0 )
    {
      v63 = (float *)(kk + dword_48F1E8 + 60);
      *v63 = *v63 * 0.89999998;
      v63[1] = v63[1] * 0.89999998;
      v64 = (float *)(kk + dword_48F1E8 + 524);
      *v64 = *v64 * 0.89999998;
      v64[1] = v64[1] * 0.89999998;
      v65 = *(float *)(kk + dword_48F1E8 + 292) * 0.89999998;
      v66 = (float *)(kk + dword_48F1E8 + 292);
      kk += 28;
      *v66 = v65;
      v66[1] = v66[1] * 0.89999998;
      *(float *)(kk + dword_48F1E8 + 36) = *(float *)(kk + dword_48F1E8 + 36) - 3.0;
      *(float *)(kk + dword_48F1E8 + 500) = *(float *)(kk + dword_48F1E8 + 500) - 3.0;
    }
LABEL_77:
    v29 = *(_DWORD *)config_screen_width;
  }
  if ( v29 <= 640 )
  {
    for ( mm = 0; mm < 112; *(float *)(mm + dword_48F198 + 268) = *(float *)(mm + dword_48F198 + 268) - 11.0 )
    {
      v68 = (float *)(mm + dword_48F198 + 60);
      *v68 = *v68 * 0.80000001;
      v68[1] = v68[1] * 0.80000001;
      v69 = (float *)(mm + dword_48F198 + 524);
      *v69 = *v69 * 0.80000001;
      v69[1] = v69[1] * 0.80000001;
      v70 = *(float *)(mm + dword_48F198 + 292) * 0.80000001;
      v71 = (float *)(mm + dword_48F198 + 292);
      mm += 28;
      *v71 = v70;
      v71[1] = v71[1] * 0.80000001;
      *(float *)(mm + dword_48F198 + 36) = *(float *)(mm + dword_48F198 + 36) - 11.0;
      *(float *)(mm + dword_48F198 + 500) = *(float *)(mm + dword_48F198 + 500) - 11.0;
    }
    goto LABEL_85;
  }
  if ( v29 <= 800 )
  {
    for ( nn = 0; nn < 112; *(float *)(nn + dword_48F198 + 268) = *(float *)(nn + dword_48F198 + 268) - 3.0 )
    {
      v73 = (float *)(nn + dword_48F198 + 60);
      *v73 = *v73 * 0.89999998;
      v73[1] = v73[1] * 0.89999998;
      v74 = (float *)(nn + dword_48F198 + 524);
      *v74 = *v74 * 0.89999998;
      v74[1] = v74[1] * 0.89999998;
      v75 = *(float *)(nn + dword_48F198 + 292) * 0.89999998;
      v76 = (float *)(nn + dword_48F198 + 292);
      nn += 28;
      *v76 = v75;
      v76[1] = v76[1] * 0.89999998;
      *(float *)(nn + dword_48F198 + 36) = *(float *)(nn + dword_48F198 + 36) - 3.0;
      *(float *)(nn + dword_48F198 + 500) = *(float *)(nn + dword_48F198 + 500) - 3.0;
    }
LABEL_85:
    v29 = *(_DWORD *)config_screen_width;
  }
  if ( v29 > 640 )
  {
    if ( v29 <= 800 )
    {
      for ( i1 = 0; i1 < 112; *(float *)(i1 + dword_48F1B0 + 268) = *(float *)(i1 + dword_48F1B0 + 268) - 3.0 )
      {
        v83 = (float *)(i1 + dword_48F1B0 + 60);
        *v83 = *v83 * 0.89999998;
        v83[1] = v83[1] * 0.89999998;
        v84 = (float *)(i1 + dword_48F1B0 + 524);
        *v84 = *v84 * 0.89999998;
        v84[1] = v84[1] * 0.89999998;
        v85 = *(float *)(i1 + dword_48F1B0 + 292) * 0.89999998;
        v86 = (float *)(i1 + dword_48F1B0 + 292);
        i1 += 28;
        *v86 = v85;
        v86[1] = v86[1] * 0.89999998;
        *(float *)(i1 + dword_48F1B0 + 36) = *(float *)(i1 + dword_48F1B0 + 36) - 3.0;
        *(float *)(i1 + dword_48F1B0 + 500) = *(float *)(i1 + dword_48F1B0 + 500) - 3.0;
      }
    }
  }
  else
  {
    for ( i2 = 0; i2 < 112; *(float *)(i2 + dword_48F1B0 + 268) = *(float *)(i2 + dword_48F1B0 + 268) - 11.0 )
    {
      v78 = (float *)(i2 + dword_48F1B0 + 60);
      *v78 = *v78 * 0.80000001;
      v78[1] = v78[1] * 0.80000001;
      v79 = (float *)(i2 + dword_48F1B0 + 524);
      *v79 = *v79 * 0.80000001;
      v79[1] = v79[1] * 0.80000001;
      v80 = *(float *)(i2 + dword_48F1B0 + 292) * 0.80000001;
      v81 = (float *)(i2 + dword_48F1B0 + 292);
      i2 += 28;
      *v81 = v80;
      v81[1] = v81[1] * 0.80000001;
      *(float *)(i2 + dword_48F1B0 + 36) = *(float *)(i2 + dword_48F1B0 + 36) - 11.0;
      *(float *)(i2 + dword_48F1B0 + 500) = *(float *)(i2 + dword_48F1B0 + 500) - 11.0;
    }
  }
  FUN_0044faa0((int)byte_48F20C);
  dword_48F240 = (int)nullsub_72;
  qmemcpy(&perk_prompt_bounds_min_x, &unk_48FBA8, 0xE8u);
  dword_48F25C = 1065353216;
  dword_48F278 = 0;
  dword_48F2B0 = 1065353216;
  dword_48F294 = 0;
  ui_element_load((int)&unk_48F330, aUiUiTextlevelu);
  *(float *)&v106 = -230.0;
  v107 = -27.0;
  ui_element_set_rect((int)&unk_48F330, 75.0, 25.0, (float *)&v106);
  v87 = (float *)&unk_48F334;
  do
  {
    v88 = *(v87 - 59) - 300.0;
    v87 += 7;
    *(v87 - 66) = v88;
    *(v87 - 66) = *(v87 - 66) * 0.75;
    *(v87 - 65) = *(v87 - 65) * 0.75;
    *(v87 - 8) = *(v87 - 8) * 0.85000002;
    *(v87 - 7) = *(v87 - 7) * 0.85000002;
    *(v87 - 8) = *(v87 - 8) - 46.0;
    *(v87 - 7) = *(v87 - 7) - 4.0;
  }
  while ( (int)v87 < (int)flt_48F3A4 );
  if ( *(_DWORD *)config_screen_width == 640 )
  {
    *(float *)&v106 = 690.0;
    v107 = 80.0;
    perk_prompt_origin_x = 690.0;
    perk_prompt_origin_y = 80.0;
  }
  else
  {
    v107 = 40.0;
    perk_prompt_origin_y = 40.0;
    *(float *)&v106 = (float)(*(_DWORD *)config_screen_width + 50);
    LODWORD(perk_prompt_origin_x) = v106;
  }
  v89 = &dword_48F16C;
  do
  {
    v90 = *v89++;
    *(float *)(v90 + 28) = (double)*(int *)config_screen_width * 0.0015625 * 150.0 - 150.0 + *(float *)(v90 + 28);
  }
  while ( (int)v89 < (int)byte_48F20C );
  qmemcpy(&byte_48EE50, &byte_489DE0, 0x318u);
  v101 = (float)(*(_DWORD *)config_screen_width - 350);
  dword_48EE68 = LODWORD(v101);
  dword_48EE6C = 1128792064;
  if ( *(int *)config_screen_width <= 640 )
  {
    *(float *)&dword_48EE68 = v101 + 80.0;
    *(float *)&dword_48EE6C = *(float *)&dword_48EE6C - 14.0;
  }
  dword_48EE54 = 1;
  byte_48F164 = 1;
  v91 = ui_element_table_end;
  do
    result = FUN_0044fb50(*v91++);
  while ( (int)v91 < (int)byte_48F20C );
  return result;
}

// sub_451910 @ 0x00451910
int sub_451910()
{
  float *v0; // edx
  unsigned int v1; // kr04_4
  float *v2; // edi
  int result; // eax
  int v4; // [esp+10h] [ebp-8h]

  v0 = weapon_projectile_damage_scale;
  v4 = 64;
  do
  {
    *(v0 - 3) = 0.0;
    *v0 = 1.0;
    *(v0 - 1) = 45.0;
    *(v0 - 2) = 0.0;
    *((_DWORD *)v0 - 5) = 1;
    v1 = strlen(aUnknown) + 1;
    qmemcpy(v0 - 28, aUnknown, 4 * (v1 >> 2));
    v2 = &v0[(v1 >> 2) - 28];
    v0 += 31;
    qmemcpy(v2, &aUnknown[4 * (v1 >> 2)], v1 & 3);
    *(v0 - 60) = 0.0;
    *((_BYTE *)v0 - 172) = 0;
    *(v0 - 42) = 0.0;
    *(v0 - 41) = 1.0;
    *(v0 - 40) = 1.0;
    *(v0 - 39) = 0.0;
    result = v4 - 1;
    v4 = result;
  }
  while ( result );
  return result;
}

// weapon_table_init @ 0x004519B0
// initializes the weapon stats table at DAT_004d7a28
unsigned int sub_4519B0()
{
  int v0; // ecx
  int *v1; // eax
  int v2; // edx
  int v3; // ebp
  int v4; // edx
  int v5; // edx
  int v6; // ebp
  int v7; // ebx
  int v8; // ebp
  int v9; // ebp
  int v10; // ebp
  unsigned int result; // eax

  v0 = 0;
  v1 = weapon_projectile_pellet_count;
  do
  {
    v2 = v0++ - 1;
    *(v1 - 4) = v2;
    *v1 = 1;
    v1 += 31;
  }
  while ( (int)v1 < (int)&dword_4D99A0 );
  effect_subrect_frame_table[0] = 0;
  dword_4D7EF4 = 1106247680;
  dword_4D7FEC = 1108082688;
  dword_4D84C4 = 1097859072;
  dword_4D8540 = 1101004800;
  dword_4D85BC = 1092616192;
  dword_4D8828 = 1092616192;
  dword_4D83CC = 1101004800;
  dword_4D7D80 = 1129775104;
  dword_4D8E74 = 1097859072;
  dword_4D8F6C = 1092616192;
  dword_4D7C0C = 1114636288;
  dword_4D7B14 = 1113325568;
  dword_4D7B90 = 1112014848;
  dword_4D86B4 = 1101004800;
  dword_4D86B8 = 1093664768;
  dword_4D9064 = 1114636288;
  dword_4D9068 = 1048576000;
  dword_4D8730 = 1092616192;
  dword_4D8734 = 1056964608;
  dword_4D7EF8 = 1084227584;
  dword_4D7FF0 = 1074161254;
  dword_4D84C8 = 1077936128;
  dword_4D8544 = 1068708659;
  dword_4D85C0 = 1099274650;
  dword_4D882C = 1105199104;
  dword_4D83D0 = 1065353216;
  dword_4D8E78 = 0;
  dword_4D7C10 = 1067030938;
  dword_4D7B18 = 1082340147;
  dword_4D863C = 0;
  strcpy(byte_4D8FF8, aFireBullets_0);
  v3 = sfx_autorifle_fire;
  v4 = sfx_pistol_reload;
  dword_4D9060 = 1;
  dword_4D903C = 112;
  dword_4D9040 = 1041194025;
  dword_4D9044 = 1067030938;
  flt_4D9048 = 0.22;
  dword_4D9050 = sfx_autorifle_fire;
  dword_4D9058 = sfx_pistol_reload;
  strcpy(byte_4D7AA8, aPistol);
  dword_4D7B10 = 5;
  dword_4D7AEC = 12;
  dword_4D7AF0 = 1060516345;
  dword_4D7AF4 = 1067030938;
  dword_4D7AF8 = 1046562734;
  dword_4D7B00 = sfx_pistol_fire;
  dword_4D7B08 = v4;
  strcpy(byte_4D7B24, aAssaultRifle);
  v5 = sfx_shotgun_reload;
  dword_4D7B7C = v3;
  v6 = sfx_autorifle_reload;
  dword_4D7B8C = 1;
  dword_4D7B68 = 25;
  dword_4D7B6C = 1039113650;
  dword_4D7B70 = 1067030938;
  dword_4D7B74 = 1035489772;
  dword_4D7B84 = sfx_autorifle_reload;
  strcpy(byte_4D7BA0, aShotgun);
  dword_4D7BE4 = 12;
  dword_4D7C14 = 12;
  dword_4D7C08 = 1;
  v7 = sfx_shotgun_fire;
  dword_4D7BE8 = 1062836634;
  dword_4D7BEC = 1072902963;
  dword_4D7BF0 = 1049247089;
  dword_4D7BF8 = sfx_shotgun_fire;
  dword_4D7C00 = v5;
  strcpy(byte_4D7C1C, aSawedOffShotgu);
  dword_4D7C60 = 12;
  dword_4D7C90 = 12;
  dword_4D7C84 = 1;
  dword_4D7C64 = 1063172178;
  dword_4D7C68 = 1072902963;
  dword_4D7C6C = 1040522936;
  dword_4D7C74 = v7;
  dword_4D7C7C = v5;
  strcpy(byte_4D83DC, aJackhammer);
  dword_4D8444 = 1;
  dword_4D8420 = 16;
  dword_4D8424 = 1041194025;
  dword_4D8428 = 1077936128;
  dword_4D842C = 1042536202;
  dword_4D8450 = 4;
  dword_4D8434 = v7;
  dword_4D843C = v5;
  strcpy(byte_4D7C98, aSubmachineGun);
  dword_4D7CF0 = sfx_hrpm_fire;
  dword_4D7D00 = 5;
  dword_4D7CDC = 30;
  dword_4D7CE0 = 1035237040;
  dword_4D7CE4 = 1067030938;
  dword_4D7CE8 = 1034416030;
  dword_4D7CF8 = v6;
  strcpy(byte_4D7E0C, aFlamethrower);
  dword_4D7E64 = sfx_flamer_fire_01;
  dword_4D7E74 = 8;
  dword_4D7E68 = 2;
  dword_4D7E50 = 30;
  dword_4D7E54 = 1006955619;
  dword_4D7E58 = 0x40000000;
  dword_4D7E5C = 1014350479;
  dword_4D7E08 = 1;
  dword_4D7E6C = v6;
  strcpy(byte_4D7E88, aPlasmaRifle);
  dword_4D7ECC = 20;
  dword_4D7EE0 = sfx_shock_fire;
  dword_4D7ED0 = 1049945413;
  dword_4D7ED4 = 1067030938;
  dword_4D7ED8 = 1044012597;
  dword_4D7EE8 = v6;
  strcpy(byte_4D7F04, aMultiPlasma);
  dword_4D7F5C = sfx_shock_fire;
  dword_4D7F48 = 8;
  dword_4D7F4C = 1058991492;
  dword_4D7F50 = 1068708659;
  dword_4D7F54 = 1050924810;
  dword_4D7F78 = 3;
  dword_4D7F64 = v6;
  strcpy(byte_4D7F80, aPlasmaMinigun);
  dword_4D7FD8 = sfx_plasmaminigun_fire;
  dword_4D7FC4 = 30;
  dword_4D7FC8 = 1038174126;
  dword_4D7FCC = 1067869798;
  dword_4D7FD0 = 1036429296;
  dword_4D7FE0 = v6;
  strcpy(byte_4D7D14, aGaussGun);
  dword_4D7D6C = sfx_gauss_fire;
  dword_4D7D7C = 1;
  dword_4D7D58 = 6;
  dword_4D7D5C = 1058642330;
  dword_4D7D60 = 1070386381;
  dword_4D7D64 = 1054280253;
  dword_4D7D74 = v5;
  strcpy(byte_4D7FFC, aRocketLauncher);
  dword_4D8064 = 8;
  dword_4D8040 = 5;
  dword_4D8044 = 1061004758;
  dword_4D8048 = 1067030938;
  dword_4D804C = 1054280253;
  dword_4D8054 = sfx_rocket_fire;
  dword_4D805C = sfx_autorifle_reload_alt;
  dword_4D7FF8 = 2;
  strcpy(byte_4D8078, aSeekerRockets);
  dword_4D80D8 = sfx_autorifle_reload_alt;
  dword_4D80D0 = sfx_rocket_fire;
  dword_4D80E0 = 8;
  dword_4D80BC = 8;
  dword_4D80C0 = 1050616502;
  dword_4D80C4 = 1067030938;
  dword_4D80C8 = 1050924810;
  dword_4D8074 = 2;
  strcpy(byte_4D7D90, aMeanMinigun);
  dword_4D7DE8 = sfx_autorifle_fire;
  dword_4D7DF8 = 3;
  dword_4D7DD4 = 120;
  dword_4D7DD8 = 1035489772;
  dword_4D7DDC = 1082130432;
  dword_4D7DE0 = 1031664566;
  dword_4D7DF0 = v6;
  strcpy(byte_4D80F4, aPlasmaShotgun);
  dword_4D814C = sfx_plasmashotgun_fire;
  dword_4D8138 = 8;
  dword_4D813C = 1056293519;
  dword_4D8140 = 1078355558;
  dword_4D8144 = 1038174126;
  dword_4D8168 = 14;
  dword_4D8154 = v5;
  strcpy(byte_4D8170, aBlowTorch);
  dword_4D81C8 = sfx_flamer_fire_01;
  dword_4D81D8 = 8;
  dword_4D81CC = 2;
  dword_4D81B4 = 30;
  dword_4D81B8 = 1002983312;
  dword_4D81BC = 1069547520;
  dword_4D81C0 = 1008981770;
  dword_4D816C = 1;
  dword_4D81D0 = v6;
  strcpy(byte_4D81EC, aHrFlamer);
  dword_4D8244 = sfx_flamer_fire_01;
  dword_4D8254 = 8;
  dword_4D8248 = 2;
  dword_4D8230 = 30;
  dword_4D8234 = 1007371158;
  dword_4D8238 = 1072064102;
  dword_4D823C = 1008981770;
  dword_4D81E8 = 1;
  dword_4D824C = v6;
  strcpy(byte_4D8268, aMiniRocketSwar);
  dword_4D82C8 = sfx_autorifle_reload_alt;
  dword_4D82C0 = sfx_rocket_fire;
  dword_4D82D0 = 8;
  dword_4D82AC = 5;
  dword_4D82B0 = 1072064102;
  dword_4D82B4 = 1072064102;
  dword_4D82B8 = 1039516303;
  dword_4D8264 = 2;
  strcpy(byte_4D82E4, aRocketMinigun);
  dword_4D834C = 8;
  dword_4D8328 = 16;
  dword_4D832C = 1039516303;
  dword_4D833C = sfx_rocketmini_fire;
  dword_4D8344 = sfx_autorifle_reload_alt;
  dword_4D8330 = 1072064102;
  dword_4D8334 = 1039516303;
  dword_4D82E0 = 2;
  strcpy(byte_4D8360, aPulseGun);
  dword_4D83B8 = sfx_pulse_fire;
  dword_4D83C8 = 8;
  dword_4D83A4 = 16;
  dword_4D83A8 = 1036831949;
  dword_4D83AC = 1036831949;
  dword_4D83B0 = 0;
  dword_4D835C = 3;
  dword_4D83C0 = v6;
  v8 = sfx_shock_reload;
  strcpy(byte_4D8458, aIonRifle);
  dword_4D84B0 = sfx_shock_fire_alt;
  dword_4D84C0 = 8;
  dword_4D849C = 8;
  dword_4D84A0 = 1053609165;
  dword_4D84A4 = 1068289229;
  dword_4D84A8 = 1038442562;
  dword_4D8454 = 4;
  dword_4D84B8 = v8;
  strcpy(byte_4D84D4, aIonMinigun);
  dword_4D852C = sfx_shockminigun_fire;
  dword_4D853C = 8;
  dword_4D8518 = 20;
  dword_4D851C = 1036831949;
  dword_4D8520 = 1072064102;
  dword_4D8524 = 1035489772;
  dword_4D84D0 = 4;
  dword_4D8534 = v8;
  strcpy(byte_4D8550, aIonCannon);
  dword_4D85A8 = sfx_shock_fire_alt;
  dword_4D8594 = 3;
  dword_4D8598 = 1065353216;
  dword_4D859C = 1077936128;
  dword_4D85A0 = 1059984507;
  dword_4D854C = 4;
  dword_4D85B0 = v8;
  strcpy(byte_4D8930, aIonShotgun);
  dword_4D8988 = sfx_shock_fire_alt;
  dword_4D8998 = 1;
  dword_4D8974 = 10;
  dword_4D8978 = 1062836634;
  dword_4D897C = 1072902963;
  dword_4D8980 = 1049247089;
  dword_4D89A4 = 8;
  dword_4D892C = 4;
  dword_4D8990 = v8;
  dword_4D8994 = 31;
  strcpy(byte_4D88B4, aGaussShotgun);
  dword_4D890C = sfx_gauss_fire;
  dword_4D891C = 1;
  dword_4D88F8 = 4;
  dword_4D88FC = 1065772646;
  dword_4D8900 = 1074161254;
  dword_4D8904 = 1049247089;
  dword_4D88B0 = 0;
  dword_4D8914 = v5;
  dword_4D8918 = 30;
  strcpy(byte_4D87BC, aPlasmaCannon);
  dword_4D8814 = sfx_shock_fire;
  dword_4D8800 = 3;
  dword_4D8804 = 1063675494;
  dword_4D8808 = 1076677837;
  dword_4D880C = 1058642330;
  dword_4D881C = v8;
  dword_4D8820 = 25;
  strcpy(byte_4D8740, aEvilScythe);
  dword_4D8798 = sfx_shock_fire_alt;
  dword_4D8784 = 3;
  dword_4D8788 = 1065353216;
  dword_4D878C = 1077936128;
  dword_4D8790 = 1059984507;
  dword_4D873C = 4;
  dword_4D87A0 = v8;
  dword_4D87A4 = 25;
  strcpy(byte_4D89AC, aFlameburst);
  dword_4D8A04 = sfx_flamer_fire_01;
  dword_4D89F0 = 60;
  dword_4D89F4 = 1017370378;
  dword_4D89F8 = 1077936128;
  dword_4D89FC = 1043878380;
  dword_4D89A8 = 4;
  dword_4D8A0C = v8;
  dword_4D8A10 = 29;
  strcpy(byte_4D8A28, aRaygun);
  dword_4D8A80 = sfx_shock_fire_alt;
  dword_4D8A6C = 12;
  dword_4D8A70 = 1060320051;
  dword_4D8A74 = 0x40000000;
  dword_4D8A78 = 1052938076;
  dword_4D8A24 = 4;
  dword_4D8A88 = v8;
  dword_4D8A8C = 30;
  strcpy(byte_4D8838, aSplitterGun);
  dword_4D8890 = sfx_shock_fire_alt;
  dword_4D887C = 6;
  dword_4D8880 = 1060320051;
  dword_4D8884 = 1074580685;
  dword_4D8888 = 1049582633;
  dword_4D8834 = 0;
  dword_4D8898 = v8;
  dword_4D88A8 = 1086324736;
  dword_4D88A4 = 1106247680;
  strcpy(byte_4D85CC, aShrinkifier5k);
  dword_4D8624 = sfx_shock_fire_alt;
  dword_4D8634 = 8;
  dword_4D8610 = 8;
  dword_4D8614 = 1045891645;
  dword_4D8618 = 1067198710;
  dword_4D861C = 1025758986;
  dword_4D862C = v8;
  dword_4D8630 = 23;
  strcpy(byte_4D8648, aBladeGun);
  dword_4D86A0 = sfx_shock_fire_alt;
  dword_4D86B0 = 8;
  dword_4D868C = 6;
  dword_4D8690 = 1051931443;
  dword_4D8694 = 1080033280;
  dword_4D8698 = 1025758986;
  dword_4D86A8 = v8;
  dword_4D86AC = 24;
  strcpy(byte_4D8E08, aPlagueSphreade);
  dword_4D8E70 = 8;
  v9 = sfx_bloodspill_01;
  dword_4D8E4C = 5;
  dword_4D8E50 = 1045220557;
  dword_4D8E54 = 1067030938;
  dword_4D8E58 = 1025758986;
  dword_4D8E60 = sfx_bloodspill_01;
  dword_4D8E68 = v5;
  strcpy(byte_4D8F00, aRainbowGun);
  dword_4D8F68 = 8;
  dword_4D8F44 = 10;
  dword_4D8F48 = 1045220557;
  dword_4D8F4C = 1067030938;
  dword_4D8F50 = 1035489772;
  dword_4D8F58 = v9;
  dword_4D8F60 = v5;
  strcpy(byte_4D8F7C, aGrimWeapon);
  dword_4D8FC0 = 3;
  dword_4D8FC4 = 1056964608;
  dword_4D8FC8 = 1067030938;
  dword_4D8FCC = 1053609165;
  dword_4D8FD4 = v9;
  dword_4D8FDC = v5;
  strcpy(byte_4D8E84, aBubblegun);
  dword_4D8EEC = 8;
  dword_4D8EC8 = 15;
  dword_4D8ECC = 1042623444;
  dword_4D8ED0 = 1067030938;
  dword_4D8ED4 = 1028443341;
  dword_4D8EDC = v9;
  dword_4D8EE4 = v5;
  strcpy(byte_4D86C4, aSpiderPlasma);
  dword_4D872C = 8;
  dword_4D8708 = 5;
  dword_4D870C = 1045220557;
  dword_4D8710 = 1067030938;
  dword_4D8714 = 1025758986;
  dword_4D871C = v9;
  dword_4D8724 = v5;
  strcpy(byte_4D9264, aTransmutator);
  dword_4D92CC = 9;
  dword_4D92A8 = 50;
  dword_4D92AC = 1025758986;
  dword_4D92B0 = 1084227584;
  dword_4D92B4 = 1025758986;
  dword_4D92BC = v9;
  dword_4D92C4 = v5;
  v10 = sfx_explosion_large;
  strcpy(byte_4D92E0, aBlasterR300);
  dword_4D9338 = sfx_shock_fire;
  dword_4D9348 = 9;
  dword_4D9324 = 20;
  dword_4D9328 = 1034147594;
  dword_4D932C = 0x40000000;
  dword_4D9330 = 1028443341;
  dword_4D9340 = v5;
  strcpy(byte_4D93D8, aNukeLauncher);
  result = strlen(aLightingRifle) + 1;
  dword_4D9440 = 8;
  dword_4D941C = 1;
  dword_4D9420 = 1082130432;
  dword_4D9424 = 1090519040;
  dword_4D9428 = 1065353216;
  dword_4D9430 = v10;
  dword_4D9438 = v5;
  qmemcpy(&unk_4D935C, aLightingRifle, result);
  dword_4D93B4 = v10;
  dword_4D93C4 = 8;
  dword_4D93A0 = 500;
  dword_4D93A4 = 1082130432;
  dword_4D93A8 = 1090519040;
  dword_4D93AC = 1065353216;
  dword_4D93BC = v5;
  return result;
}

// weapon_pick_random_available @ 0x00452CD0
// selects a random weapon id that is marked available
int sub_452CD0()
{
  int v0; // esi

  do
  {
    v0 = crt_rand() % 33 + 1;
    if ( dword_485544[v0] && (crt_rand() & 1) == 0 )
      v0 = crt_rand() % 33 + 1;
  }
  while ( !byte_4D7A6C[124 * v0]
       || config_game_mode == 3 && *(_DWORD *)quest_stage_major == 5 && quest_stage_minor == 10 && v0 == 23 );
  return v0;
}

// weapon_assign_player @ 0x00452D40
// assigns a weapon to a player and resets ammo timers
int __cdecl sub_452D40(int a1, int a2)
{
  int v2; // esi
  int v3; // edi
  int v4; // ecx
  int v6; // [esp-10h] [ebp-10h]
  int v7; // [esp+8h] [ebp+8h]

  if ( !demo_mode_active )
    ++dword_485544[a2];
  v2 = 216 * a1;
  v3 = 124 * a2;
  player_weapon_id[v2] = a2;
  v6 = perk_id_ammo_maniac;
  *(float *)(v2 * 4 + 4787060) = (float)dword_4D7A70[31 * a2];
  if ( perk_count_get(v6) )
  {
    v7 = (__int64)(*(float *)&player_clip_size[216 * a1] * 0.25);
    if ( v7 <= 1 )
      v7 = 1;
    *(float *)&player_clip_size[216 * a1] = (double)v7 + *(float *)&player_clip_size[216 * a1];
  }
  if ( perk_count_get(perk_id_my_favourite_weapon) )
    *(float *)&player_clip_size[216 * a1] = *(float *)&player_clip_size[216 * a1] + 2.0;
  v4 = *(int *)((char *)&dword_4D7A8C + v3);
  player_ammo[216 * a1] = player_clip_size[216 * a1];
  player_weapon_reset_latch[216 * a1] = 0;
  player_shot_cooldown[216 * a1] = 0;
  player_reload_timer[216 * a1] = 0;
  dword_4871D0[a1] = 0x40000000;
  return sfx_play_panned(v4, (float *)&player_pos_x[v2], 1.0);
}

// weapon_refresh_available @ 0x00452E40
// rebuilds availability flags from the unlock list
bool __fastcall sub_452E40(std::codecvt_base *a1)
{
  char *v1; // eax
  int v2; // esi
  int v3; // edx
  int v4; // eax
  bool result; // al

  v1 = byte_4D7A6C;
  do
  {
    *v1 = 0;
    v1 += 124;
  }
  while ( (int)v1 < (int)byte_4D996C );
  v2 = quest_unlock_index;
  v3 = 0;
  byte_4D7AE8 = 1;
  if ( quest_unlock_index > 0 )
  {
    a1 = (std::codecvt_base *)quest_unlock_weapon_id;
    do
    {
      if ( (int)a1 >= (int)&unk_484FEC )
        break;
      v4 = *(_DWORD *)a1;
      a1 = (std::codecvt_base *)((char *)a1 + 44);
      ++v3;
      byte_4D7A6C[124 * v4] = 1;
    }
    while ( v3 < v2 );
  }
  if ( config_game_mode == 1 )
  {
    byte_4D7B64 = 1;
    byte_4D7BE0 = 1;
    byte_4D7CD8 = 1;
  }
  result = game_is_full_version(a1);
  if ( result )
  {
    if ( quest_unlock_index_full >= 40 )
      byte_4D8878 = 1;
    byte_4D7A6C[0] = 0;
  }
  else
  {
    quest_unlock_index_full = 0;
    byte_4D7A6C[0] = 0;
  }
  return result;
}

// float_near_equal @ 0x00452EF0
// returns 1 when |a-b| < 1.1920929e-07 (FLT_EPSILON)
BOOL __cdecl sub_452EF0(float a1, float a2)
{
  double v2; // st7

  v2 = a1 - a2;
  return v2 >= -0.00000011920929 && v2 <= 0.00000011920929;
}

// FUN_00452f1d @ 0x00452F1D
// [binja] int32_t sub_452f1d()
int sub_452F1D()
{
  renderer_select_backend(1u);
  return off_479658();
}

// sub_452F30 @ 0x00452F30
int __stdcall sub_452F30(int a1, int a2, int a3, int a4, int a5, float a6)
{
  renderer_select_backend(1u);
  return off_4795E4(a1, a2, a3, a4, a5, a6);
}

// sub_452F5A @ 0x00452F5A
float *__stdcall sub_452F5A(float *a1, float *a2, float *a3, float *a4, float *a5, float a6)
{
  double v6; // st7
  double v8; // st6
  double v9; // st7
  float v10; // [esp+0h] [ebp-8h]
  float v11; // [esp+4h] [ebp-4h]
  float v12; // [esp+24h] [ebp+1Ch]

  v6 = a6 * a6;
  v8 = a6 * v6;
  v10 = v8 + v8 - v6 * 3.0 + 1.0;
  v11 = v8 - (v6 + v6) + a6;
  v12 = v6 * 3.0 - (v8 + v8);
  v9 = v8 - v6;
  *a1 = v10 * *a2 + v11 * *a3 + v12 * *a4 + v9 * *a5;
  a1[1] = v9 * a5[1] + v12 * a4[1] + v11 * a3[1] + v10 * a2[1];
  return a1;
}

// sub_452FE8 @ 0x00452FE8
int __stdcall sub_452FE8(int a1, int a2, int a3, int a4, int a5, float a6)
{
  renderer_select_backend(1u);
  return off_47965C(a1, a2, a3, a4, a5, a6);
}

// sub_453012 @ 0x00453012
float *__stdcall sub_453012(float *a1, float *a2, float *a3, float *a4, float *a5, float a6)
{
  double v6; // st7
  double v8; // st6
  double v9; // st7
  float v10; // [esp+0h] [ebp-8h]
  float v11; // [esp+4h] [ebp-4h]
  float v12; // [esp+24h] [ebp+1Ch]

  v6 = a6 * a6;
  v8 = a6 * v6;
  v10 = v6 * 2.0 - v8 - a6;
  v11 = v8 * 3.0 - v6 * 5.0 + 2.0;
  v12 = v6 * 4.0 - v8 * 3.0 + a6;
  v9 = v8 - v6;
  *a1 = (v10 * *a2 + v11 * *a3 + v12 * *a4 + v9 * *a5) * 0.5;
  a1[1] = (v9 * a5[1] + v12 * a4[1] + v11 * a3[1] + v10 * a2[1]) * 0.5;
  return a1;
}

// sub_4530C1 @ 0x004530C1
int __stdcall sub_4530C1(int a1, int a2, int a3, int a4, float a5, float a6)
{
  renderer_select_backend(1u);
  return off_479660(a1, a2, a3, a4, a5, a6);
}

// sub_4530F0 @ 0x004530F0
float *__stdcall sub_4530F0(float *a1, float *a2, float *a3, float *a4, float a5, float a6)
{
  *a1 = (*a3 - *a2) * a5 + (*a4 - *a2) * a6 + *a2;
  a1[1] = (a3[1] - a2[1]) * a5 + (a4[1] - a2[1]) * a6 + a2[1];
  return a1;
}

// sub_453133 @ 0x00453133
int sub_453133()
{
  renderer_select_backend(1u);
  return off_4795A0();
}

// FUN_0045315a @ 0x0045315A
// [binja] int32_t sub_45315a()
int sub_45315A()
{
  renderer_select_backend(1u);
  return off_4795BC();
}

// sub_45316D @ 0x0045316D
int __stdcall sub_45316D(int a1, int a2, int a3, int a4, int a5, float a6)
{
  renderer_select_backend(1u);
  return off_479664(a1, a2, a3, a4, a5, a6);
}

// sub_453197 @ 0x00453197
float *__stdcall sub_453197(float *a1, float *a2, float *a3, float *a4, float *a5, float a6)
{
  double v6; // st7
  double v8; // st6
  double v9; // st7
  float v10; // [esp+0h] [ebp-8h]
  float v11; // [esp+4h] [ebp-4h]
  float v12; // [esp+24h] [ebp+1Ch]

  v6 = a6 * a6;
  v8 = a6 * v6;
  v10 = v8 + v8 - v6 * 3.0 + 1.0;
  v11 = v8 - (v6 + v6) + a6;
  v12 = v6 * 3.0 - (v8 + v8);
  v9 = v8 - v6;
  *a1 = v10 * *a2 + v11 * *a3 + v12 * *a4 + v9 * *a5;
  a1[1] = v9 * a5[1] + v12 * a4[1] + v11 * a3[1] + v10 * a2[1];
  a1[2] = v9 * a5[2] + v12 * a4[2] + v11 * a3[2] + v10 * a2[2];
  return a1;
}

// sub_453245 @ 0x00453245
int __stdcall sub_453245(int a1, int a2, int a3, int a4, int a5, float a6)
{
  renderer_select_backend(1u);
  return off_479668(a1, a2, a3, a4, a5, a6);
}

// sub_45326F @ 0x0045326F
float *__stdcall sub_45326F(float *a1, float *a2, float *a3, float *a4, float *a5, float a6)
{
  double v6; // st7
  double v8; // st6
  double v9; // st7
  float v10; // [esp+0h] [ebp-8h]
  float v11; // [esp+4h] [ebp-4h]
  float v12; // [esp+24h] [ebp+1Ch]

  v6 = a6 * a6;
  v8 = a6 * v6;
  v10 = v6 * 2.0 - v8 - a6;
  v11 = v8 * 3.0 - v6 * 5.0 + 2.0;
  v12 = v6 * 4.0 - v8 * 3.0 + a6;
  v9 = v8 - v6;
  *a1 = (v10 * *a2 + v11 * *a3 + v12 * *a4 + v9 * *a5) * 0.5;
  a1[1] = (v9 * a5[1] + v12 * a4[1] + v11 * a3[1] + v10 * a2[1]) * 0.5;
  a1[2] = (v9 * a5[2] + v12 * a4[2] + v11 * a3[2] + v10 * a2[2]) * 0.5;
  return a1;
}

// sub_453340 @ 0x00453340
int __stdcall sub_453340(int a1, int a2, int a3, int a4, float a5, float a6)
{
  renderer_select_backend(1u);
  return off_47966C(a1, a2, a3, a4, a5, a6);
}

// sub_45336F @ 0x0045336F
float *__stdcall sub_45336F(float *a1, float *a2, float *a3, float *a4, float a5, float a6)
{
  *a1 = (*a3 - *a2) * a5 + (*a4 - *a2) * a6 + *a2;
  a1[1] = (a3[1] - a2[1]) * a5 + (a4[1] - a2[1]) * a6 + a2[1];
  a1[2] = (a3[2] - a2[2]) * a5 + (a4[2] - a2[2]) * a6 + a2[2];
  return a1;
}

// sub_4533D9 @ 0x004533D9
float *__stdcall sub_4533D9(float *a1, float *a2, float *a3)
{
  float v4; // [esp+8h] [ebp-10h]
  float v5; // [esp+Ch] [ebp-Ch]
  float v6; // [esp+10h] [ebp-8h]
  float v7; // [esp+14h] [ebp-4h]

  v4 = a3[8] * a2[2] + a3[4] * a2[1] + *a2 * *a3 + a3[12];
  v5 = a3[9] * a2[2] + a3[5] * a2[1] + a3[1] * *a2 + a3[13];
  v6 = a3[10] * a2[2] + a3[6] * a2[1] + a3[2] * *a2 + a3[14];
  v7 = a3[11] * a2[2] + a3[7] * a2[1] + a3[3] * *a2 + a3[15];
  *a1 = v4;
  a1[1] = v5;
  a1[2] = v6;
  a1[3] = v7;
  return a1;
}

// FUN_00453464 @ 0x00453464
// [binja] int32_t sub_453464()
int sub_453464()
{
  renderer_select_backend(1u);
  return off_4795C8();
}

// sub_453484 @ 0x00453484
float *__stdcall sub_453484(float *a1, float *a2, float *a3)
{
  float v4; // [esp+8h] [ebp-Ch]
  float v5; // [esp+Ch] [ebp-8h]
  float v6; // [esp+10h] [ebp-4h]

  v4 = a3[8] * a2[2] + a3[4] * a2[1] + *a2 * *a3;
  v5 = a3[9] * a2[2] + a3[5] * a2[1] + a3[1] * *a2;
  v6 = a3[10] * a2[2] + a3[6] * a2[1] + a3[2] * *a2;
  *a1 = v4;
  a1[1] = v5;
  a1[2] = v6;
  return a1;
}

// FUN_004534ea @ 0x004534EA
// [binja] int32_t sub_4534ea()
int sub_4534EA()
{
  renderer_select_backend(1u);
  return off_4795D8();
}

// sub_4534FB @ 0x004534FB
int sub_4534FB()
{
  renderer_select_backend(1u);
  return off_4795DC();
}

// sub_453519 @ 0x00453519
float *__stdcall sub_453519(float *a1, float *a2, float *a3, float *a4)
{
  double v6; // st7
  double v8; // st6
  double v9; // st7
  double v10; // st6
  float v12; // [esp+8h] [ebp-1Ch]
  float v13; // [esp+Ch] [ebp-18h]
  float v14; // [esp+10h] [ebp-14h]
  float v15; // [esp+14h] [ebp-10h]
  float v16; // [esp+18h] [ebp-Ch]
  float v17; // [esp+1Ch] [ebp-8h]
  float v18; // [esp+20h] [ebp-4h]
  float v19; // [esp+30h] [ebp+Ch]
  float v20; // [esp+34h] [ebp+10h]
  float v21; // [esp+38h] [ebp+14h]

  v6 = a4[3] * a3[2];
  v8 = a3[3] * a4[2];
  v20 = a4[3] * a3[1] - a3[3] * a4[1];
  v17 = a3[1] * a4[2];
  v18 = a3[2] * a4[1];
  v12 = (v6 - v8) * a2[1] - v20 * a2[2] + (v17 - v18) * a2[3];
  v19 = a3[3] * *a4;
  v21 = a4[3] * *a3;
  v16 = *a4 * a3[2] - *a3 * a4[2];
  v13 = (v8 - v6) * *a2 - (v19 - v21) * a2[2] + v16 * a2[3];
  v9 = *a3 * a4[1];
  v10 = *a4 * a3[1];
  v14 = v20 * *a2 - (v21 - v19) * a2[1] + (v9 - v10) * a2[3];
  v15 = (v18 - v17) * *a2 - v16 * a2[1] + (v10 - v9) * a2[2];
  *a1 = v12;
  a1[1] = v13;
  a1[2] = v14;
  a1[3] = v15;
  return a1;
}

// sub_453616 @ 0x00453616
int __stdcall sub_453616(int a1, int a2, int a3, int a4, int a5, float a6)
{
  renderer_select_backend(1u);
  return off_479670(a1, a2, a3, a4, a5, a6);
}

// sub_453640 @ 0x00453640
float *__stdcall sub_453640(float *a1, float *a2, float *a3, float *a4, float *a5, float a6)
{
  double v6; // st7
  double v8; // st6
  double v9; // st6
  double v10; // st5
  double v11; // st4
  double v12; // st3
  float v13; // [esp+0h] [ebp-Ch]
  float v14; // [esp+4h] [ebp-8h]
  float v15; // [esp+8h] [ebp-4h]

  v6 = a6 * a6;
  v8 = a6 * v6;
  v15 = v8;
  v13 = v8 + v8;
  v14 = 3.0 * v6;
  v9 = v13 - v14 + 1.0;
  v10 = v15 - (v6 + v6) + a6;
  v11 = v14 - v13;
  v12 = v15 - v6;
  *a1 = v9 * *a2 + v10 * *a3 + v11 * *a4 + v12 * *a5;
  a1[1] = v12 * a5[1] + v11 * a4[1] + v10 * a3[1] + v9 * a2[1];
  a1[2] = v12 * a5[2] + v11 * a4[2] + v10 * a3[2] + v9 * a2[2];
  a1[3] = v12 * a5[3] + v11 * a4[3] + v10 * a3[3] + v9 * a2[3];
  return a1;
}

// sub_453711 @ 0x00453711
int __stdcall sub_453711(int a1, int a2, int a3, int a4, int a5, float a6)
{
  renderer_select_backend(1u);
  return off_479674(a1, a2, a3, a4, a5, a6);
}

// sub_45373B @ 0x0045373B
float *__stdcall sub_45373B(float *a1, float *a2, float *a3, float *a4, float *a5, float a6)
{
  double v6; // st7
  double v8; // st6
  double v9; // st7
  float v10; // [esp+0h] [ebp-8h]
  float v11; // [esp+4h] [ebp-4h]
  float v12; // [esp+24h] [ebp+1Ch]

  v6 = a6 * a6;
  v8 = a6 * v6;
  v10 = v6 * 2.0 - v8 - a6;
  v11 = v8 * 3.0 - v6 * 5.0 + 2.0;
  v12 = v6 * 4.0 - v8 * 3.0 + a6;
  v9 = v8 - v6;
  *a1 = (v10 * *a2 + v11 * *a3 + v12 * *a4 + v9 * *a5) * 0.5;
  a1[1] = (v9 * a5[1] + v12 * a4[1] + v11 * a3[1] + v10 * a2[1]) * 0.5;
  a1[2] = (v9 * a5[2] + v12 * a4[2] + v11 * a3[2] + v10 * a2[2]) * 0.5;
  a1[3] = (v9 * a5[3] + v12 * a4[3] + v11 * a3[3] + v10 * a2[3]) * 0.5;
  return a1;
}

// sub_45382E @ 0x0045382E
int __stdcall sub_45382E(int a1, int a2, int a3, int a4, float a5, float a6)
{
  renderer_select_backend(1u);
  return off_479678(a1, a2, a3, a4, a5, a6);
}

// sub_45385D @ 0x0045385D
float *__stdcall sub_45385D(float *a1, float *a2, float *a3, float *a4, float a5, float a6)
{
  *a1 = (*a3 - *a2) * a5 + (*a4 - *a2) * a6 + *a2;
  a1[1] = (a3[1] - a2[1]) * a5 + (a4[1] - a2[1]) * a6 + a2[1];
  a1[2] = (a3[2] - a2[2]) * a5 + (a4[2] - a2[2]) * a6 + a2[2];
  a1[3] = (a3[3] - a2[3]) * a5 + (a4[3] - a2[3]) * a6 + a2[3];
  return a1;
}

// sub_4538E1 @ 0x004538E1
float *__stdcall sub_4538E1(float *a1, float *a2, float *a3)
{
  float v4; // [esp+8h] [ebp-10h]
  float v5; // [esp+Ch] [ebp-Ch]
  float v6; // [esp+10h] [ebp-8h]
  float v7; // [esp+14h] [ebp-4h]

  v4 = a3[12] * a2[3] + a3[4] * a2[1] + a3[8] * a2[2] + *a2 * *a3;
  v5 = a3[13] * a2[3] + a3[5] * a2[1] + a3[1] * *a2 + a3[9] * a2[2];
  v6 = a3[14] * a2[3] + a3[6] * a2[1] + a3[2] * *a2 + a3[10] * a2[2];
  v7 = a3[15] * a2[3] + a3[7] * a2[1] + a3[3] * *a2 + a3[11] * a2[2];
  *a1 = v4;
  a1[1] = v5;
  a1[2] = v6;
  a1[3] = v7;
  return a1;
}

// sub_45398D @ 0x0045398D
double __stdcall sub_45398D(float *a1)
{
  double v2; // st7
  double v3; // st6
  double v4; // st5
  double v5; // st4
  double v6; // st3
  float v8; // [esp+8h] [ebp+8h]

  v2 = a1[10] * a1[15] - a1[14] * a1[11];
  v3 = a1[15] * a1[9] - a1[13] * a1[11];
  v4 = a1[14] * a1[9] - a1[10] * a1[13];
  v5 = a1[8] * a1[15] - a1[12] * a1[11];
  v6 = a1[14] * a1[8] - a1[12] * a1[10];
  v8 = a1[8] * a1[13] - a1[12] * a1[9];
  return (v2 * a1[5] - v3 * a1[6] + v4 * a1[7]) * *a1
       - (v2 * a1[4] - v5 * a1[6] + v6 * a1[7]) * a1[1]
       + (v3 * a1[4] - v5 * a1[5] + v8 * a1[7]) * a1[2]
       - (v4 * a1[4] - v6 * a1[5] + v8 * a1[6]) * a1[3];
}

// FUN_00453a57 @ 0x00453A57
// [binja] int32_t sub_453a57()
int sub_453A57()
{
  renderer_select_backend(1u);
  return off_4795AC();
}

// sub_453A6A @ 0x00453A6A
float *__stdcall sub_453A6A(float *a1, float *a2, float *a3)
{
  float *result; // eax
  float *v4; // esi
  char v5; // [esp+4h] [ebp-40h] BYREF

  result = a1;
  if ( a1 == a2 || (v4 = a1, a1 == a3) )
    v4 = (float *)&v5;
  *v4 = a2[3] * a3[12] + *a2 * *a3 + a2[2] * a3[8] + a3[4] * a2[1];
  v4[1] = a2[1] * a3[5] + a2[3] * a3[13] + a2[2] * a3[9] + a3[1] * *a2;
  v4[2] = a2[3] * a3[14] + a3[2] * *a2 + a2[2] * a3[10] + a3[6] * a2[1];
  v4[3] = a2[3] * a3[15] + a3[11] * a2[2] + *a2 * a3[3] + a3[7] * a2[1];
  v4[4] = a2[7] * a3[12] + a2[4] * *a3 + a3[4] * a2[5] + a2[6] * a3[8];
  v4[5] = a2[6] * a3[9] + a2[7] * a3[13] + a3[5] * a2[5] + a3[1] * a2[4];
  v4[6] = a3[6] * a2[5] + a2[7] * a3[14] + a3[2] * a2[4] + a2[6] * a3[10];
  v4[7] = a3[7] * a2[5] + a2[7] * a3[15] + a2[6] * a3[11] + a2[4] * a3[3];
  v4[8] = a2[11] * a3[12] + a2[8] * *a3 + a3[4] * a2[9] + a2[10] * a3[8];
  v4[9] = a2[11] * a3[13] + a2[10] * a3[9] + a3[5] * a2[9] + a3[1] * a2[8];
  v4[10] = a3[6] * a2[9] + a3[2] * a2[8] + a2[11] * a3[14] + a2[10] * a3[10];
  v4[11] = a2[11] * a3[15] + a2[10] * a3[11] + a3[7] * a2[9] + a2[8] * a3[3];
  v4[12] = a2[15] * a3[12] + a2[12] * *a3 + a3[4] * a2[13] + a2[14] * a3[8];
  v4[13] = a2[15] * a3[13] + a2[14] * a3[9] + a3[5] * a2[13] + a3[1] * a2[12];
  v4[14] = a3[6] * a2[13] + a3[2] * a2[12] + a2[15] * a3[14] + a2[14] * a3[10];
  v4[15] = a2[15] * a3[15] + a2[14] * a3[11] + a3[7] * a2[13] + a2[12] * a3[3];
  if ( v4 != a1 )
    qmemcpy(a1, v4, 0x40u);
  return result;
}

// FUN_00453ca0 @ 0x00453CA0
// [binja] int32_t sub_453ca0()
int sub_453CA0()
{
  renderer_select_backend(1u);
  return off_479634();
}

// sub_453CB3 @ 0x00453CB3
int __stdcall sub_453CB3(int a1, int a2)
{
  double v2; // st7
  int result; // eax
  double v4; // st7
  double v5; // st7
  double v6; // st7
  double v7; // st7
  double v8; // st7

  v2 = *(float *)(a2 + 4);
  result = a1;
  *(float *)(a1 + 4) = *(float *)(a2 + 16);
  *(float *)(a1 + 16) = v2;
  v4 = *(float *)(a2 + 8);
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 32);
  *(float *)(a1 + 32) = v4;
  v5 = *(float *)(a2 + 12);
  *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 48);
  *(float *)(a1 + 48) = v5;
  v6 = *(float *)(a2 + 24);
  *(_DWORD *)(a1 + 24) = *(_DWORD *)(a2 + 36);
  *(float *)(a1 + 36) = v6;
  v7 = *(float *)(a2 + 28);
  *(_DWORD *)(a1 + 28) = *(_DWORD *)(a2 + 52);
  *(float *)(a1 + 52) = v7;
  v8 = *(float *)(a2 + 44);
  *(_DWORD *)(a1 + 44) = *(_DWORD *)(a2 + 56);
  *(float *)(a1 + 56) = v8;
  if ( a1 != a2 )
  {
    *(_DWORD *)a1 = *(_DWORD *)a2;
    *(_DWORD *)(a1 + 20) = *(_DWORD *)(a2 + 20);
    *(_DWORD *)(a1 + 40) = *(_DWORD *)(a2 + 40);
    *(_DWORD *)(a1 + 60) = *(_DWORD *)(a2 + 60);
  }
  return result;
}

// sub_453D2D @ 0x00453D2D
float *__stdcall sub_453D2D(float *a1, float *a2, float *a3)
{
  float *result; // eax
  float *v4; // esi
  char v5; // [esp+4h] [ebp-40h] BYREF

  result = a1;
  if ( a1 == a2 || (v4 = a1, a1 == a3) )
    v4 = (float *)&v5;
  *v4 = a2[3] * a3[12] + *a2 * *a3 + a2[2] * a3[8] + a3[4] * a2[1];
  v4[1] = a2[4] * *a3 + a3[12] * a2[7] + a3[8] * a2[6] + a3[4] * a2[5];
  v4[2] = a2[10] * a3[8] + a2[9] * a3[4] + a3[12] * a2[11] + a2[8] * *a3;
  v4[3] = a2[13] * a3[4] + a2[15] * a3[12] + *a3 * a2[12] + a2[14] * a3[8];
  v4[4] = a3[9] * a2[2] + a3[1] * *a2 + a3[13] * a2[3] + a2[1] * a3[5];
  v4[5] = a3[13] * a2[7] + a3[9] * a2[6] + a2[5] * a3[5] + a2[4] * a3[1];
  v4[6] = a2[9] * a3[5] + a3[13] * a2[11] + a3[9] * a2[10] + a2[8] * a3[1];
  v4[7] = a2[13] * a3[5] + a3[13] * a2[15] + a3[9] * a2[14] + a3[1] * a2[12];
  v4[8] = a3[10] * a2[2] + a3[2] * *a2 + a2[1] * a3[6] + a3[14] * a2[3];
  v4[9] = a3[14] * a2[7] + a3[10] * a2[6] + a2[5] * a3[6] + a2[4] * a3[2];
  v4[10] = a2[9] * a3[6] + a3[14] * a2[11] + a3[10] * a2[10] + a2[8] * a3[2];
  v4[11] = a2[13] * a3[6] + a3[14] * a2[15] + a3[10] * a2[14] + a3[2] * a2[12];
  v4[12] = a3[11] * a2[2] + a3[3] * *a2 + a2[1] * a3[7] + a3[15] * a2[3];
  v4[13] = a3[15] * a2[7] + a3[11] * a2[6] + a2[5] * a3[7] + a2[4] * a3[3];
  v4[14] = a2[9] * a3[7] + a3[15] * a2[11] + a3[11] * a2[10] + a2[8] * a3[3];
  v4[15] = a2[13] * a3[7] + a3[15] * a2[15] + a3[11] * a2[14] + a3[3] * a2[12];
  if ( v4 != a1 )
    qmemcpy(a1, v4, 0x40u);
  return result;
}

// FUN_00453f63 @ 0x00453F63
// [binja] int32_t sub_453f63()
int sub_453F63()
{
  renderer_select_backend(1u);
  return off_4795E8();
}

// sub_453F76 @ 0x00453F76
int __stdcall sub_453F76(float *a1, float *a2, float *a3)
{
  double v4; // st7
  double v5; // st6
  double v6; // st7
  double v7; // st7
  double v8; // st6
  double v9; // st5
  double v10; // st4
  double v11; // st3
  double v12; // st2
  double v13; // st7
  double v14; // st6
  double v15; // st5
  double v16; // st3
  double v17; // st4
  double v18; // st3
  double v19; // st2
  double v20; // st7
  int result; // eax
  float v22; // [esp+8h] [ebp-54h]
  float v23; // [esp+Ch] [ebp-50h]
  float v24; // [esp+10h] [ebp-4Ch]
  float v25; // [esp+14h] [ebp-48h]
  float v26; // [esp+18h] [ebp-44h]
  float v27; // [esp+1Ch] [ebp-40h]
  float v28; // [esp+20h] [ebp-3Ch]
  float v29; // [esp+24h] [ebp-38h]
  float v30; // [esp+28h] [ebp-34h]
  float v31; // [esp+28h] [ebp-34h]
  float v32; // [esp+2Ch] [ebp-30h]
  float v33; // [esp+2Ch] [ebp-30h]
  float v34; // [esp+30h] [ebp-2Ch]
  float v35; // [esp+30h] [ebp-2Ch]
  float v36; // [esp+34h] [ebp-28h]
  float v37; // [esp+34h] [ebp-28h]
  float v38; // [esp+38h] [ebp-24h]
  float v39; // [esp+38h] [ebp-24h]
  float v40; // [esp+3Ch] [ebp-20h]
  float v41; // [esp+3Ch] [ebp-20h]
  float v42; // [esp+3Ch] [ebp-20h]
  float v43; // [esp+40h] [ebp-1Ch]
  float v44; // [esp+40h] [ebp-1Ch]
  float v45; // [esp+44h] [ebp-18h]
  float v46; // [esp+44h] [ebp-18h]
  float v47; // [esp+48h] [ebp-14h]
  float v48; // [esp+48h] [ebp-14h]
  float v49; // [esp+4Ch] [ebp-10h]
  float v50; // [esp+4Ch] [ebp-10h]
  float v51; // [esp+50h] [ebp-Ch]
  float v52; // [esp+50h] [ebp-Ch]
  float v53; // [esp+54h] [ebp-8h]
  float v54; // [esp+54h] [ebp-8h]
  float v55; // [esp+54h] [ebp-8h]
  float v56; // [esp+58h] [ebp-4h]
  float v57; // [esp+58h] [ebp-4h]
  float v58; // [esp+58h] [ebp-4h]
  float v59; // [esp+58h] [ebp-4h]
  float v60; // [esp+6Ch] [ebp+10h]
  float v61; // [esp+6Ch] [ebp+10h]
  float v62; // [esp+6Ch] [ebp+10h]
  float v63; // [esp+6Ch] [ebp+10h]

  v4 = *a3;
  v5 = a3[1];
  v43 = a3[4];
  v40 = a3[5];
  v45 = a3[8];
  v56 = a3[9];
  v47 = a3[12];
  v60 = a3[13];
  v51 = v40 * v4 - v43 * v5;
  v49 = a3[14];
  v53 = v56 * v4 - v45 * v5;
  v34 = v60 * v4 - v47 * v5;
  v29 = v56 * v43 - v45 * v40;
  v30 = v60 * v43 - v47 * v40;
  v6 = v60;
  v61 = a3[15];
  v32 = v6 * v45 - v47 * v56;
  v7 = a3[2];
  v8 = a3[3];
  v9 = a3[6];
  v36 = a3[6];
  v10 = a3[7];
  v41 = a3[7];
  v11 = a3[10];
  v38 = a3[10];
  v12 = a3[11];
  v57 = a3[11];
  v22 = v7 * v29 - v9 * v53 + v11 * v51;
  v23 = v9 * v34 - v49 * v51 - v7 * v30;
  v24 = v7 * v32 - v11 * v34 + v49 * v53;
  v25 = v11 * v30 - v49 * v29 - v9 * v32;
  v26 = v53 * v10 - v51 * v12 - v29 * v8;
  v27 = v30 * v8 - v34 * v10 + v51 * v61;
  v28 = v34 * v12 - v53 * v61 - v32 * v8;
  v35 = v32 * v10 - v30 * v12 + v29 * v61;
  v52 = v7 * v10 - v9 * v8;
  v54 = v7 * v57 - v38 * v8;
  v13 = v7 * v61 - v49 * v8;
  v44 = a3[4];
  v46 = a3[8];
  v14 = v36 * v57 - v38 * v41;
  v15 = v36 * v61 - v49 * v41;
  v16 = v49 * v57;
  v58 = a3[9];
  v48 = a3[12];
  v17 = v38 * v61 - v16;
  v18 = a3[1];
  v19 = a3[5];
  v62 = a3[13];
  v50 = v54 * v19 - v52 * v58 - v14 * v18;
  v39 = v15 * v18 - v13 * v19 + v52 * v62;
  v37 = v13 * v58 - v54 * v62 - v17 * v18;
  v31 = v17 * v19 - v15 * v58 + v14 * v62;
  v63 = v14 * *a3 - v54 * v44 + v52 * v46;
  v59 = v13 * v44 - v52 * v48 - v15 * *a3;
  v42 = *a3 * v17 - v13 * v46 + v54 * v48;
  v20 = v50 * v48 + v39 * v46 + v37 * v44 + v31 * *a3;
  if ( a2 )
    *a2 = v20;
  v55 = 1.0 / v20;
  result = _finite(v55);
  if ( result )
  {
    *a1 = v31 * v55;
    a1[1] = v37 * v55;
    a1[2] = v39 * v55;
    a1[3] = v50 * v55;
    v33 = v15 * v46 - v14 * v48 - v17 * v44;
    a1[4] = v33 * v55;
    a1[5] = v42 * v55;
    a1[6] = v59 * v55;
    a1[7] = v63 * v55;
    a1[8] = v35 * v55;
    a1[9] = v28 * v55;
    a1[10] = v27 * v55;
    a1[11] = v26 * v55;
    a1[12] = v25 * v55;
    a1[13] = v24 * v55;
    a1[14] = v23 * v55;
    a1[15] = v22 * v55;
    return (int)a1;
  }
  return result;
}

// FUN_00454303 @ 0x00454303
// [binja] int32_t __stdcall sub_454303(float arg1, float arg2, float arg3); wrapper calls PTR_FUN_00479624 (idx 0x21)
int __stdcall sub_454303(int a1, float a2, float a3, float a4)
{
  renderer_select_backend(1u);
  return off_479624(a1, a2, a3, a4);
}

// sub_454331 @ 0x00454331
int __stdcall sub_454331(int a1, int a2, int a3, int a4)
{
  *(float *)(a1 + 56) = 0.0;
  *(_DWORD *)a1 = a2;
  *(float *)(a1 + 52) = 0.0;
  *(_DWORD *)(a1 + 20) = a3;
  *(float *)(a1 + 48) = 0.0;
  *(_DWORD *)(a1 + 40) = a4;
  *(float *)(a1 + 44) = 0.0;
  *(float *)(a1 + 36) = 0.0;
  *(float *)(a1 + 32) = 0.0;
  *(float *)(a1 + 28) = 0.0;
  *(float *)(a1 + 24) = 0.0;
  *(float *)(a1 + 16) = 0.0;
  *(float *)(a1 + 12) = 0.0;
  *(float *)(a1 + 8) = 0.0;
  *(float *)(a1 + 4) = 0.0;
  *(float *)(a1 + 60) = 1.0;
  return a1;
}

// FUN_0045438d @ 0x0045438D
// [binja] int32_t __stdcall sub_45438d(float arg1, float arg2, float arg3); wrapper calls PTR_FUN_00479608 (idx 0x1a)
int __stdcall sub_45438D(int a1, float a2, float a3, float a4)
{
  renderer_select_backend(1u);
  return off_479608(a1, a2, a3, a4);
}

// sub_4543BB @ 0x004543BB
int __stdcall sub_4543BB(int a1, int a2, int a3, int a4)
{
  *(float *)(a1 + 44) = 0.0;
  *(_DWORD *)(a1 + 48) = a2;
  *(float *)(a1 + 36) = 0.0;
  *(_DWORD *)(a1 + 52) = a3;
  *(float *)(a1 + 32) = 0.0;
  *(_DWORD *)(a1 + 56) = a4;
  *(float *)(a1 + 28) = 0.0;
  *(float *)(a1 + 24) = 0.0;
  *(float *)(a1 + 16) = 0.0;
  *(float *)(a1 + 12) = 0.0;
  *(float *)(a1 + 8) = 0.0;
  *(float *)(a1 + 4) = 0.0;
  *(float *)(a1 + 60) = 1.0;
  *(float *)(a1 + 40) = 1.0;
  *(float *)(a1 + 20) = 1.0;
  *(float *)a1 = 1.0;
  return a1;
}

// FUN_00454417 @ 0x00454417
// [binja] int32_t __stdcall sub_454417(float arg1); wrapper calls PTR_FUN_00479618 (idx 0x1e)
int __stdcall sub_454417(int a1, float a2)
{
  renderer_select_backend(1u);
  return off_479618(a1, a2);
}

// FUN_00454433 @ 0x00454433
// [binja] float* __stdcall sub_454433(float* arg1, float arg2)
float *__stdcall sub_454433(float *a1, float a2)
{
  float v3; // [esp+8h] [ebp-8h]
  float v4; // [esp+Ch] [ebp-4h]

  v3 = cos(a2);
  v4 = sin(a2);
  *a1 = 1.0;
  a1[1] = 0.0;
  a1[6] = v4;
  a1[2] = 0.0;
  a1[3] = 0.0;
  a1[4] = 0.0;
  a1[5] = v3;
  a1[7] = 0.0;
  a1[8] = 0.0;
  a1[9] = -v4;
  a1[10] = v3;
  a1[11] = 0.0;
  a1[12] = 0.0;
  a1[13] = 0.0;
  a1[14] = 0.0;
  a1[15] = 1.0;
  return a1;
}

// FUN_004544ad @ 0x004544AD
// [binja] int32_t __stdcall sub_4544ad(float arg1); wrapper calls PTR_FUN_0047961c (idx 0x1f)
int __stdcall sub_4544AD(int a1, float a2)
{
  renderer_select_backend(1u);
  return off_47961C(a1, a2);
}

// FUN_004544c9 @ 0x004544C9
// [binja] float* __stdcall sub_4544c9(float* arg1, float arg2)
float *__stdcall sub_4544C9(float *a1, float a2)
{
  float v3; // [esp+8h] [ebp-8h]
  float v4; // [esp+Ch] [ebp-4h]

  v4 = cos(a2);
  v3 = sin(a2);
  *a1 = v4;
  a1[1] = 0.0;
  a1[2] = -v3;
  a1[3] = 0.0;
  a1[4] = 0.0;
  a1[5] = 1.0;
  a1[6] = 0.0;
  a1[7] = 0.0;
  a1[8] = v3;
  a1[9] = 0.0;
  a1[10] = v4;
  a1[11] = 0.0;
  a1[12] = 0.0;
  a1[13] = 0.0;
  a1[14] = 0.0;
  a1[15] = 1.0;
  return a1;
}

// FUN_00454544 @ 0x00454544
// [binja] int32_t __stdcall sub_454544(float arg1); wrapper calls PTR_FUN_00479620 (idx 0x20)
int __stdcall sub_454544(int a1, float a2)
{
  renderer_select_backend(1u);
  return off_479620(a1, a2);
}

// FUN_00454560 @ 0x00454560
// [binja] float* __stdcall sub_454560(float* arg1, float arg2)
float *__stdcall sub_454560(float *a1, float a2)
{
  float v3; // [esp+8h] [ebp-8h]
  float v4; // [esp+Ch] [ebp-4h]

  v3 = cos(a2);
  v4 = sin(a2);
  *a1 = v3;
  a1[1] = v4;
  a1[2] = 0.0;
  a1[3] = 0.0;
  a1[4] = -v4;
  a1[5] = v3;
  a1[6] = 0.0;
  a1[7] = 0.0;
  a1[8] = 0.0;
  a1[9] = 0.0;
  a1[10] = 1.0;
  a1[11] = 0.0;
  a1[12] = 0.0;
  a1[13] = 0.0;
  a1[14] = 0.0;
  a1[15] = 1.0;
  return a1;
}

// FUN_004545dc @ 0x004545DC
// [binja] int32_t __stdcall sub_4545dc(int arg1, float arg2); wrapper calls PTR_FUN_00479648 (idx 0x2a)
int __stdcall sub_4545DC(int a1, int a2, float a3)
{
  renderer_select_backend(1u);
  return off_479648(a1, a2, a3);
}

// FUN_004545fc @ 0x004545FC
// [binja] float* __stdcall sub_4545fc(float* arg1, float arg2, float arg3)
float *__stdcall sub_4545FC(float *a1, float *a2, float a3)
{
  double v4; // st7
  double v5; // st6
  double v6; // st5
  double v7; // st4
  double v8; // st3
  double v9; // st2
  double v10; // st3
  float v11; // [esp+8h] [ebp-1Ch] BYREF
  float v12; // [esp+Ch] [ebp-18h]
  float v13; // [esp+10h] [ebp-14h]
  float *v14; // [esp+14h] [ebp-10h]
  float *v15; // [esp+18h] [ebp-Ch]
  float v16; // [esp+1Ch] [ebp-8h] BYREF
  float v17; // [esp+20h] [ebp-4h] BYREF
  float v18; // [esp+30h] [ebp+Ch]
  float v19; // [esp+34h] [ebp+10h]
  float v20; // [esp+34h] [ebp+10h]

  v15 = &v17;
  v14 = &v16;
  v17 = cos(a3);
  v16 = sin(a3);
  v11 = *a2;
  v19 = 1.0 - v17;
  v12 = a2[1];
  v13 = a2[2];
  j_FUN_0045315a(&v11, &v11);
  v4 = v19;
  v20 = v12 * v11 * v19;
  v5 = v13;
  v6 = v12 * v13 * v4;
  v7 = v13 * v11 * v4;
  *a1 = v11 * v11 * v4 + v17;
  v8 = v5 * v16;
  a1[1] = v20 + v8;
  v9 = v12 * v16;
  v18 = v9;
  a1[2] = v7 - v9;
  a1[3] = 0.0;
  a1[4] = v20 - v8;
  a1[5] = v12 * v12 * v4 + v17;
  v10 = v11 * v16;
  a1[6] = v10 + v6;
  a1[7] = 0.0;
  a1[8] = v18 + v7;
  a1[9] = v6 - v10;
  a1[10] = v5 * v5 * v4 + v17;
  a1[11] = 0.0;
  a1[12] = 0.0;
  a1[13] = 0.0;
  a1[14] = 0.0;
  a1[15] = 1.0;
  return a1;
}

// FUN_004546fe @ 0x004546FE
// [binja] int32_t sub_4546fe()
int sub_4546FE()
{
  renderer_select_backend(1u);
  return off_479638();
}

// sub_454711 @ 0x00454711
float *__stdcall sub_454711(float *a1, float *a2)
{
  double v3; // st7
  double v4; // st6
  double v5; // st5
  double v6; // st4
  double v7; // st3
  float *result; // eax
  double v9; // st2
  float v10; // [esp+0h] [ebp-10h]
  float v11; // [esp+4h] [ebp-Ch]
  float v12; // [esp+8h] [ebp-8h]
  float v13; // [esp+Ch] [ebp-4h]
  float v14; // [esp+Ch] [ebp-4h]
  float v15; // [esp+18h] [ebp+8h]
  float v16; // [esp+1Ch] [ebp+Ch]
  float v17; // [esp+1Ch] [ebp+Ch]

  v13 = *a2 * 2.0;
  v16 = a2[1] * 2.0;
  v3 = 2.0 * a2[2];
  v4 = v13 * a2[3];
  v5 = v16 * a2[3];
  v6 = v3 * a2[3];
  v10 = v13 * *a2;
  v14 = v16 * *a2;
  v12 = v3 * *a2;
  v11 = v16 * a2[1];
  v17 = v3 * a2[1];
  v7 = v3 * a2[2];
  result = a1;
  *a1 = 1.0 - v11 - v7;
  a1[1] = v14 + v6;
  a1[2] = v12 - v5;
  a1[3] = 0.0;
  a1[4] = v14 - v6;
  v9 = 1.0 - v10;
  v15 = v9;
  result[5] = v9 - v7;
  result[6] = v17 + v4;
  result[7] = 0.0;
  result[8] = v12 + v5;
  result[9] = v17 - v4;
  result[10] = v15 - v11;
  result[11] = 0.0;
  result[12] = 0.0;
  result[13] = 0.0;
  result[14] = 0.0;
  result[15] = 1.0;
  return result;
}

// FUN_004547f3 @ 0x004547F3
// [binja] int32_t __stdcall sub_4547f3(float arg1, float arg2, float arg3); wrapper calls PTR_FUN_00479640 (idx 0x28)
int __stdcall sub_4547F3(int a1, float a2, float a3, float a4)
{
  renderer_select_backend(1u);
  return off_479640(a1, a2, a3, a4);
}

// FUN_00454821 @ 0x00454821
// [binja] int32_t sub_454821()
int sub_454821()
{
  renderer_select_backend(1u);
  return off_47963C();
}

// sub_454832 @ 0x00454832
int __stdcall sub_454832(int a1, float a2, int a3, int a4, int a5)
{
  renderer_select_backend(1u);
  return off_479644(a1, a2, a3, a4, a5);
}

// sub_454859 @ 0x00454859
float *__stdcall sub_454859(float *a1, float a2, float *a3, int a4, float *a5)
{
  int v6; // [esp+0h] [ebp-50h]
  int v7; // [esp+4h] [ebp-4Ch]
  int v8; // [esp+8h] [ebp-48h]
  _BYTE v9[12]; // [esp+10h] [ebp-40h] BYREF
  _BYTE v10[52]; // [esp+1Ch] [ebp-34h] BYREF

  a1[14] = 0.0;
  a1[13] = 0.0;
  a1[12] = 0.0;
  a1[11] = 0.0;
  a1[9] = 0.0;
  a1[8] = 0.0;
  a1[7] = 0.0;
  a1[6] = 0.0;
  a1[4] = 0.0;
  a1[3] = 0.0;
  a1[2] = 0.0;
  a1[1] = 0.0;
  *a1 = a2;
  a1[5] = a2;
  a1[10] = a2;
  a1[15] = 1.0;
  if ( a4 )
  {
    j_FUN_004546fe(v9, a4, v6, v7, v8);
    if ( a3 )
    {
      a1[12] = a1[12] - *a3;
      a1[13] = a1[13] - a3[1];
      a1[14] = a1[14] - a3[2];
      j_FUN_00453a57(a1, a1, v10);
      a1[12] = *a3 + a1[12];
      a1[13] = a1[13] + a3[1];
      a1[14] = a3[2] + a1[14];
    }
    else
    {
      j_FUN_00453a57(a1, a1, v10);
    }
  }
  if ( a5 )
  {
    a1[12] = *a5 + a1[12];
    a1[13] = a5[1] + a1[13];
    a1[14] = a5[2] + a1[14];
  }
  return a1;
}

// sub_454966 @ 0x00454966
float *__stdcall sub_454966(float *a1, float *a2, float *a3)
{
  long double v3; // st7
  float *result; // eax
  long double v5; // st7
  long double v6; // st7

  v3 = *a1 * *a1 + a1[1] * a1[1] + a1[2] * a1[2] + a1[3] * a1[3];
  result = a2;
  if ( v3 <= 1.1754944e-38 )
  {
    if ( a2 )
    {
      *a2 = 1.0;
      a2[1] = 0.0;
      a2[2] = 0.0;
    }
    result = a3;
    if ( a3 )
      *a3 = 0.0;
  }
  else
  {
    if ( a2 )
    {
      v5 = 1.0 / sqrt(v3);
      *a2 = v5 * *a1;
      a2[1] = v5 * a1[1];
      a2[2] = v5 * a1[2];
    }
    if ( a3 )
    {
      v6 = acos(a1[3]);
      *a3 = v6 + v6;
    }
  }
  return result;
}

// sub_454A10 @ 0x00454A10
float *__stdcall sub_454A10(float *a1, float *a2)
{
  double v3; // st7
  float *result; // eax
  long double v5; // st6
  double v6; // st7
  double v7; // st6
  int v8; // ebx
  int v9; // edx
  int v10; // edi
  int v11; // esi
  long double v12; // st7
  long double v13; // st6
  long double v14; // st7
  double v15; // st6
  int v16; // ebx
  int v17; // edi
  int v18; // esi
  double v19; // st6
  int v20; // edi
  _DWORD v21[3]; // [esp+0h] [ebp-1Ch]
  float v22; // [esp+Ch] [ebp-10h]
  float v23; // [esp+10h] [ebp-Ch]
  float v24; // [esp+14h] [ebp-8h]
  int v25; // [esp+18h] [ebp-4h]
  int v26; // [esp+24h] [ebp+8h]
  int v27; // [esp+28h] [ebp+Ch]

  v3 = a2[5] + *a2 + a2[10];
  if ( v3 <= 0.0 )
  {
    v21[2] = 0;
    v6 = *a2 - a2[5] - a2[10];
    v22 = v6;
    v21[0] = 1;
    v7 = a2[5];
    v21[1] = 2;
    v23 = v7 - *a2 - a2[10];
    v24 = a2[10] - (a2[5] + *a2);
    v8 = v6 < v23;
    v27 = v8;
    if ( *(&v22 + v8) < (double)v24 )
    {
      v8 = 2;
      v27 = 2;
    }
    v9 = v8;
    result = a1;
    v11 = v21[v8];
    v12 = sqrt(*(&v22 + v8) + 1.0);
    v25 = v21[v8];
    v10 = v25;
    v13 = v12 * 0.5;
    a1[v9] = v13;
    v14 = 0.25 / v13;
    v15 = a2[v11 * 4 + v8] + a2[4 * v8 + v10];
    v16 = 4 * v21[v11] + v27;
    v26 = v21[v11];
    v17 = v21[v11];
    result[v11] = v15 * v14;
    v18 = v17 + v11 * 4;
    v19 = a2[v16] + a2[v17 + v9 * 4];
    v20 = v25;
    result[v26] = v19 * v14;
    result[3] = (a2[v18] - a2[v20 + v26 * 4]) * v14;
  }
  else
  {
    v5 = sqrt(v3 + 1.0) * 0.5;
    a1[3] = v5;
    *a1 = (a2[6] - a2[9]) * (0.25 / v5);
    a1[1] = (a2[8] - a2[2]) * (0.25 / v5);
    a1[2] = (a2[1] - a2[4]) * (0.25 / v5);
    return a1;
  }
  return result;
}

// FUN_00454b44 @ 0x00454B44
// [binja] int32_t __stdcall sub_454b44(int arg1, float arg2); wrapper calls PTR_FUN_00479614 (idx 0x1d)
int __stdcall sub_454B44(int a1, int a2, float a3)
{
  renderer_select_backend(1u);
  return off_479614(a1, a2, a3);
}

// FUN_00454b64 @ 0x00454B64
// [binja] float* __stdcall sub_454b64(float arg1, float arg2, float arg3)
float *__stdcall sub_454B64(float *a1, int a2, float a3)
{
  float v5[3]; // [esp+0h] [ebp-14h] BYREF
  float *v6; // [esp+10h] [ebp-4h]
  float v7; // [esp+1Ch] [ebp+8h]
  float v8; // [esp+20h] [ebp+Ch]

  j_FUN_0045315a(v5, a2);
  v6 = a1 + 3;
  v7 = a3 * 0.5;
  *v6 = cos(v7);
  v8 = sin(v7);
  *a1 = v5[0] * v8;
  a1[1] = v5[1] * v8;
  a1[2] = v5[2] * v8;
  return a1;
}

// FUN_00454bc0 @ 0x00454BC0
// [binja] int32_t __stdcall sub_454bc0(float arg1, float arg2, float arg3); wrapper calls PTR_FUN_00479604 (idx 0x19)
int __stdcall sub_454BC0(int a1, float a2, float a3, float a4)
{
  renderer_select_backend(1u);
  return off_479604(a1, a2, a3, a4);
}

// sub_454BF4 @ 0x00454BF4
float *__stdcall sub_454BF4(float *a1, float a2, float a3, float a4)
{
  double v5; // st7
  double v6; // st6
  double v7; // st7
  double v8; // st6
  float v9; // [esp+8h] [ebp-18h]
  float v10; // [esp+Ch] [ebp-14h]
  float v11; // [esp+10h] [ebp-10h]
  float v12; // [esp+14h] [ebp-Ch]
  float v13; // [esp+18h] [ebp-8h]
  float v14; // [esp+1Ch] [ebp-4h]
  float v15; // [esp+30h] [ebp+10h]
  float v16; // [esp+30h] [ebp+10h]
  float v17; // [esp+34h] [ebp+14h]

  v9 = a4 * 0.5;
  v14 = cos(v9);
  v17 = sin(v9);
  v15 = a3 * 0.5;
  v12 = cos(v15);
  v10 = sin(v15);
  v16 = a2 * 0.5;
  v13 = cos(v16);
  v11 = sin(v16);
  v5 = v11 * v12;
  v6 = v13 * v10;
  *a1 = v14 * v6 + v5 * v17;
  a1[1] = v5 * v14 - v6 * v17;
  v7 = v13 * v12;
  v8 = v11 * v10;
  a1[2] = v7 * v17 - v8 * v14;
  a1[3] = v8 * v17 + v7 * v14;
  return a1;
}

// FUN_00454ccd @ 0x00454CCD
// [binja] int32_t sub_454ccd()
int sub_454CCD()
{
  renderer_select_backend(1u);
  return off_4795EC();
}

// sub_454CE0 @ 0x00454CE0
float *__stdcall sub_454CE0(float *a1, float *a2, float *a3)
{
  double v3; // st5
  double v4; // st6
  double v5; // st7

  v3 = a3[3] * a2[1] - *a3 * a2[2] + a3[1] * a2[3] + a3[2] * *a2;
  v4 = a3[3] * a2[2] + *a3 * a2[1] - a3[1] * *a2 + a3[2] * a2[3];
  v5 = a3[3] * a2[3] - *a3 * *a2 - a3[1] * a2[1] - a3[2] * a2[2];
  *a1 = a3[3] * *a2 + *a3 * a2[3] + a3[1] * a2[2] - a3[2] * a2[1];
  a1[1] = v3;
  a1[2] = v4;
  a1[3] = v5;
  return a1;
}

// sub_454D83 @ 0x00454D83
float *__stdcall sub_454D83(float *a1, float *a2)
{
  float *v2; // esi
  float *result; // eax
  float *v4; // esi
  long double v5; // st7
  long double v6; // st7
  float v7[4]; // [esp+10h] [ebp-10h] BYREF
  float v8; // [esp+2Ch] [ebp+Ch]

  v2 = a2;
  v8 = *a2 * *a2 + a2[1] * a2[1] + a2[2] * a2[2] + a2[3] * a2[3];
  if ( float_near_equal(v8, 1.0) )
  {
    result = a1;
    if ( a1 == v2 )
      return result;
    goto LABEL_3;
  }
  result = a1;
  if ( v8 > 1.1754944e-38 )
  {
    v5 = 1.0 / sqrt(v8);
    v7[0] = v5 * *v2;
    v7[1] = v5 * v2[1];
    v7[2] = v5 * v2[2];
    v6 = v5 * v2[3];
    v2 = v7;
    v7[3] = v6;
LABEL_3:
    *result = *v2;
    v4 = v2 + 1;
    result[1] = *v4++;
    result[2] = *v4;
    result[3] = v4[1];
    return result;
  }
  *a1 = 0.0;
  a1[1] = 0.0;
  a1[2] = 0.0;
  a1[3] = 0.0;
  return result;
}

// FUN_00454e3c @ 0x00454E3C
// [binja] int32_t sub_454e3c()
int sub_454E3C()
{
  renderer_select_backend(1u);
  return off_479650();
}

// sub_454E4F @ 0x00454E4F
float *__stdcall sub_454E4F(float *a1, float *a2)
{
  float *v3; // ecx
  double v4; // st7
  double v5; // st7
  float v7; // [esp+14h] [ebp+Ch]

  v3 = a1;
  v7 = *a2 * *a2 + a2[1] * a2[1] + a2[2] * a2[2] + a2[3] * a2[3];
  if ( v7 <= 1.0842022e-19 )
  {
    *a1 = 0.0;
    a1[1] = 0.0;
    a1[2] = 0.0;
    v5 = 0.0;
    goto LABEL_5;
  }
  *a1 = -*a2;
  a1[1] = -a2[1];
  a1[2] = -a2[2];
  a1[3] = a2[3];
  if ( !float_near_equal(v7, 1.0) )
  {
    v4 = 1.0 / v7;
    *v3 = v4 * *v3;
    v3[1] = v4 * v3[1];
    v3[2] = v4 * v3[2];
    v5 = v4 * v3[3];
LABEL_5:
    v3[3] = v5;
  }
  return v3;
}

// sub_454F09 @ 0x00454F09
float *__stdcall sub_454F09(float *a1, float *a2)
{
  long double v3; // st7
  bool v4; // zf
  float *result; // eax
  double v6; // st7
  float v7; // [esp+Ch] [ebp-4h]
  float v8; // [esp+1Ch] [ebp+Ch]

  if ( a2[3] >= 1.0 )
  {
    result = a1;
    goto LABEL_5;
  }
  v3 = acos(a2[3]);
  v7 = sin(v3);
  v4 = !float_near_equal(v7, 0.0);
  result = a1;
  if ( !v4 )
  {
LABEL_5:
    *result = *a2;
    result[1] = a2[1];
    result[2] = a2[2];
    goto LABEL_6;
  }
  v8 = v3;
  v6 = v8 / v7;
  *a1 = v6 * *a2;
  a1[1] = v6 * a2[1];
  a1[2] = v6 * a2[2];
LABEL_6:
  result[3] = 0.0;
  return result;
}

// sub_454F8D @ 0x00454F8D
float *__stdcall sub_454F8D(float *a1, float *a2)
{
  float *v2; // ecx
  double v3; // st7
  float v5; // [esp+10h] [ebp-4h]
  float v6; // [esp+20h] [ebp+Ch]

  v5 = sqrt(*a2 * *a2 + a2[1] * a2[1] + a2[2] * a2[2]);
  a1[3] = cos(v5);
  v6 = sin(v5);
  if ( float_near_equal(v6, 0.0) )
  {
    if ( a1 != v2 )
    {
      *a1 = *v2;
      a1[1] = v2[1];
      a1[2] = v2[2];
    }
  }
  else
  {
    v3 = v6 / v5;
    *a1 = v3 * *v2;
    a1[1] = v3 * v2[1];
    a1[2] = v3 * v2[2];
  }
  return a1;
}

// FUN_00455028 @ 0x00455028
// [binja] int32_t __stdcall sub_455028(int arg1, int arg2, float arg3); wrapper calls PTR_FUN_0047962c (idx 0x23)
int __stdcall sub_455028(int a1, int a2, int a3, float a4)
{
  renderer_select_backend(1u);
  return off_47962C(a1, a2, a3, a4);
}

// sub_455052 @ 0x00455052
float *__stdcall sub_455052(float *a1, float *a2, float *a3, float a4)
{
  double v5; // st7
  double v7; // st6
  double v8; // st5
  long double v9; // st6
  long double v10; // st6
  long double v11; // st6
  float v13; // [esp+0h] [ebp-4h]
  float v14; // [esp+10h] [ebp+Ch]
  float v15; // [esp+14h] [ebp+10h]
  float v16; // [esp+14h] [ebp+10h]

  v5 = 1.0 - a4;
  v7 = *a2 * *a3 + a3[2] * a2[2] + a3[1] * a2[1] + a3[3] * a2[3];
  if ( v7 < 0.0 )
    v14 = -1.0;
  else
    v14 = 1.0;
  v8 = v14 * v7;
  if ( 1.0 - v8 <= 0.00000011920929 )
  {
    v10 = a4;
  }
  else
  {
    v9 = sqrt(1.0 - v8 * v8);
    v15 = v8;
    v16 = atan2(v9, v15);
    v13 = 1.0 / v9;
    v5 = sin(v16 * v5) * v13;
    v10 = sin(v16 * a4) * v13;
  }
  v11 = v10 * v14;
  *a1 = v5 * *a2 + v11 * *a3;
  a1[1] = v11 * a3[1] + v5 * a2[1];
  a1[2] = v11 * a3[2] + v5 * a2[2];
  a1[3] = v11 * a3[3] + v5 * a2[3];
  return a1;
}

// sub_455135 @ 0x00455135
int __stdcall sub_455135(int a1, int a2, int a3, int a4, int a5, float a6)
{
  renderer_select_backend(1u);
  return off_47964C(a1, a2, a3, a4, a5, a6);
}

// sub_45515F @ 0x0045515F
int __stdcall sub_45515F(int a1, int a2, int a3, int a4, int a5, float a6)
{
  float v7; // [esp+0h] [ebp-24h]
  int v8[4]; // [esp+4h] [ebp-20h] BYREF
  int v9[4]; // [esp+14h] [ebp-10h] BYREF

  j_FUN_00455028((int)v8, a2, a5, a6);
  j_FUN_00455028((int)v9, a3, a4, a6);
  v7 = (1.0 - a6) * a6 + (1.0 - a6) * a6;
  j_FUN_00455028(a1, (int)v8, (int)v9, v7);
  return a1;
}

// FUN_004551b6 @ 0x004551B6
// [binja] int32_t sub_4551b6()
int sub_4551B6()
{
  renderer_select_backend(1u);
  return off_479654();
}

// sub_4551C7 @ 0x004551C7
int __stdcall sub_4551C7(int a1, int a2, int a3, int a4, float a5, float a6)
{
  renderer_select_backend(1u);
  return off_479630(a1, a2, a3, a4, a5, a6);
}

// sub_4551F6 @ 0x004551F6
_DWORD *__stdcall sub_4551F6(_DWORD *a1, _DWORD *a2, int a3, int a4, float a5, float a6)
{
  float v7; // [esp+4h] [ebp-28h]
  int v8[4]; // [esp+Ch] [ebp-20h] BYREF
  int v9[4]; // [esp+1Ch] [ebp-10h] BYREF
  float v10; // [esp+44h] [ebp+18h]

  v10 = a5 + a6;
  if ( float_near_equal(v10, 0.0) )
  {
    if ( a1 != a2 )
    {
      *a1 = *a2;
      a1[1] = a2[1];
      a1[2] = a2[2];
      a1[3] = a2[3];
    }
  }
  else
  {
    j_FUN_00455028((int)v8, (int)a2, a3, v10);
    j_FUN_00455028((int)v9, (int)a2, a4, v10);
    v7 = a6 / v10;
    j_FUN_00455028((int)a1, (int)v8, (int)v9, v7);
  }
  return a1;
}

// FUN_00455281 @ 0x00455281
// [binja] int32_t sub_455281()
int sub_455281()
{
  renderer_select_backend(1u);
  return off_4795F4();
}

// sub_455294 @ 0x00455294
float *__stdcall sub_455294(float *a1, float *a2)
{
  float *result; // eax
  float *v4; // esi
  long double v5; // st7
  long double v6; // st7
  float v7; // [esp+18h] [ebp+Ch]

  v7 = *a2 * *a2 + a2[1] * a2[1] + a2[2] * a2[2];
  if ( float_near_equal(v7, 1.0) )
  {
    result = a1;
    if ( a1 != a2 )
    {
      *a1 = *a2;
      v4 = a2 + 1;
      a1[1] = *v4++;
      a1[2] = *v4;
      a1[3] = v4[1];
    }
  }
  else
  {
    result = a1;
    if ( v7 <= 1.1754944e-38 )
    {
      *a1 = 0.0;
      a1[1] = 0.0;
      a1[2] = 0.0;
      v6 = 0.0;
    }
    else
    {
      v5 = 1.0 / sqrt(v7);
      *a1 = v5 * *a2;
      a1[1] = v5 * a2[1];
      a1[2] = v5 * a2[2];
      v6 = v5 * a2[3];
    }
    a1[3] = v6;
  }
  return result;
}

// sub_455345 @ 0x00455345
float *__stdcall sub_455345(float *a1, float *a2, float *a3, float *a4)
{
  double v4; // st7
  double v5; // st6
  float v7; // [esp+1Ch] [ebp+Ch]

  v4 = *a2 * *a3 + a2[1] * a3[1] + a3[2] * a2[2];
  v5 = v4 - (*a2 * *a4 + a4[2] * a2[2] + a2[1] * a4[1]);
  if ( v5 == 0.0 )
    return 0;
  v7 = (v4 + a2[3]) / v5;
  if ( !_finite(v7) )
    return 0;
  *a1 = (*a4 - *a3) * v7 + *a3;
  a1[1] = (a4[1] - a3[1]) * v7 + a3[1];
  a1[2] = (a4[2] - a3[2]) * v7 + a3[2];
  return a1;
}

// sub_4553F4 @ 0x004553F4
int __stdcall sub_4553F4(int a1, float *a2, int a3)
{
  *(float *)a1 = *(float *)a3;
  *(_DWORD *)(a1 + 4) = *(_DWORD *)(a3 + 4);
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(a3 + 8);
  *(float *)(a1 + 12) = -(a2[1] * *(float *)(a3 + 4) + a2[2] * *(float *)(a3 + 8) + *a2 * *(float *)a3);
  return a1;
}

// sub_455439 @ 0x00455439
float *__stdcall sub_455439(float *a1, float *a2, float *a3, float *a4)
{
  double v4; // st7
  double v5; // st6
  double v6; // st5
  double v7; // st4
  float v9; // [esp+Ch] [ebp-18h]
  float v10; // [esp+10h] [ebp-14h]
  float v11; // [esp+14h] [ebp-10h]
  float v12; // [esp+18h] [ebp-Ch]
  float v13; // [esp+1Ch] [ebp-8h]

  v4 = *a2 - *a3;
  v5 = a2[1] - a3[1];
  v6 = a2[2] - a3[2];
  v12 = *a2 - *a4;
  v13 = a2[1] - a4[1];
  v7 = a2[2] - a4[2];
  v9 = v7 * v5 - v13 * v6;
  v10 = v6 * v12 - v7 * v4;
  v11 = v13 * v4 - v12 * v5;
  *a1 = v9;
  a1[1] = v10;
  a1[2] = v11;
  j_FUN_0045315a(a1, a1);
  a1[3] = -(a1[2] * a2[2] + a1[1] * a2[1] + *a1 * *a2);
  return a1;
}

// sub_4554E8 @ 0x004554E8
float *__stdcall sub_4554E8(float *a1, float *a2, float *a3)
{
  float v4; // [esp+8h] [ebp-10h]
  float v5; // [esp+Ch] [ebp-Ch]
  float v6; // [esp+10h] [ebp-8h]
  float v7; // [esp+14h] [ebp-4h]

  v4 = a3[8] * a2[2] + a3[12] * a2[3] + a3[4] * a2[1] + *a2 * *a3;
  v5 = a3[9] * a2[2] + a3[1] * *a2 + a3[13] * a2[3] + a3[5] * a2[1];
  v6 = a3[10] * a2[2] + a3[2] * *a2 + a3[14] * a2[3] + a3[6] * a2[1];
  v7 = a3[11] * a2[2] + a3[3] * *a2 + a3[15] * a2[3] + a3[7] * a2[1];
  *a1 = v4;
  a1[1] = v5;
  a1[2] = v6;
  a1[3] = v7;
  return a1;
}

// FUN_00455587 @ 0x00455587
// [binja] int32_t* __stdcall sub_455587(int32_t* arg1, float arg2)
float *__stdcall sub_455587(float *a1, float *a2)
{
  float *v2; // ecx
  float *result; // eax
  float v4; // ecx
  long double v5; // st7
  long double v6; // st7
  float v7; // [esp+8h] [ebp-8h]
  float v8; // [esp+Ch] [ebp-4h]
  float v9; // [esp+1Ch] [ebp+Ch]

  v9 = *a2 * *a2 + a2[1] * a2[1];
  if ( float_near_equal(v9, 1.0) )
  {
    result = a1;
    if ( a1 == v2 )
      return result;
    *a1 = *v2;
    v4 = v2[1];
    goto LABEL_4;
  }
  result = a1;
  if ( v9 > 1.1754944e-38 )
  {
    v5 = 1.0 / sqrt(v9);
    v7 = v5 * *v2;
    v6 = v5 * v2[1];
    *a1 = v7;
    v8 = v6;
    v4 = v8;
LABEL_4:
    result[1] = v4;
    return result;
  }
  *a1 = 0.0;
  a1[1] = 0.0;
  return result;
}

// FUN_00455614 @ 0x00455614
// [binja] float* __stdcall sub_455614(float* arg1, float* arg2, float* arg3)
float *__stdcall sub_455614(float *a1, float *a2, float *a3)
{
  float v4; // [esp+8h] [ebp-10h]
  float v5; // [esp+Ch] [ebp-Ch]
  float v6; // [esp+10h] [ebp-8h]
  float v7; // [esp+14h] [ebp-4h]

  v4 = a3[4] * a2[1] + *a2 * *a3 + a3[12];
  v5 = a3[1] * *a2 + a3[5] * a2[1] + a3[13];
  v6 = a3[2] * *a2 + a3[6] * a2[1] + a3[14];
  v7 = a3[3] * *a2 + a3[7] * a2[1] + a3[15];
  *a1 = v4;
  a1[1] = v5;
  a1[2] = v6;
  a1[3] = v7;
  return a1;
}

// FUN_0045567f @ 0x0045567F
// [binja] float* __stdcall sub_45567f(float* arg1, float* arg2, float* arg3)
float *__stdcall sub_45567F(float *a1, float *a2, float *a3)
{
  double v3; // st6
  double v4; // st7
  bool v5; // zf
  float *result; // eax
  double v7; // st7
  float v8; // [esp+8h] [ebp-4h]

  v3 = *a2 * a3[1] + a2[1] * a3[5] + a3[13];
  v4 = *a2 * a3[3] + a2[1] * a3[7] + a3[15];
  *a1 = *a2 * *a3 + a2[1] * a3[4] + a3[12];
  a1[1] = v3;
  v8 = v4;
  v5 = !float_near_equal(v8, 1.0);
  result = a1;
  if ( v5 )
  {
    v7 = 1.0 / v8;
    *a1 = v7 * *a1;
    a1[1] = v7 * a1[1];
  }
  return result;
}

// FUN_004556ff @ 0x004556FF
// [binja] float* __stdcall sub_4556ff(float* arg1, float* arg2, float* arg3)
float *__stdcall sub_4556FF(float *a1, float *a2, float *a3)
{
  double v3; // st7
  double v4; // st6
  float v6; // [esp+0h] [ebp-8h]
  float v7; // [esp+4h] [ebp-4h]

  v6 = a3[4] * a2[1] + *a2 * *a3;
  v3 = a3[1] * *a2;
  v4 = a3[5] * a2[1];
  *a1 = v6;
  v7 = v3 + v4;
  a1[1] = v7;
  return a1;
}

// FUN_0045573b @ 0x0045573B
// [binja] float* __stdcall sub_45573b(float* arg1, float arg2)
float *__stdcall sub_45573B(float *a1, float *a2)
{
  float *v2; // esi
  float *result; // eax
  float *v4; // esi
  long double v5; // st7
  long double v6; // st7
  float v7[3]; // [esp+10h] [ebp-Ch] BYREF
  float v8; // [esp+28h] [ebp+Ch]

  v2 = a2;
  v8 = *a2 * *a2 + a2[1] * a2[1] + a2[2] * a2[2];
  if ( float_near_equal(v8, 1.0) )
  {
    result = a1;
    if ( a1 == v2 )
      return result;
    goto LABEL_3;
  }
  result = a1;
  if ( v8 > 1.1754944e-38 )
  {
    v5 = 1.0 / sqrt(v8);
    v7[0] = v5 * *v2;
    v7[1] = v5 * v2[1];
    v6 = v5 * v2[2];
    v2 = v7;
    v7[2] = v6;
LABEL_3:
    *result = *v2;
    v4 = v2 + 1;
    result[1] = *v4;
    result[2] = v4[1];
    return result;
  }
  *a1 = 0.0;
  a1[1] = 0.0;
  a1[2] = 0.0;
  return result;
}

// FUN_004557db @ 0x004557DB
// [binja] float* __stdcall sub_4557db(float* arg1, float* arg2, float* arg3)
float *__stdcall sub_4557DB(float *a1, float *a2, float *a3)
{
  double v3; // st5
  double v4; // st6
  double v5; // st7
  bool v6; // zf
  float *result; // eax
  double v8; // st7
  float v9; // [esp+8h] [ebp-4h]

  v3 = *a2 * a3[1] + a2[1] * a3[5] + a2[2] * a3[9] + a3[13];
  v4 = *a2 * a3[2] + a2[1] * a3[6] + a2[2] * a3[10] + a3[14];
  v5 = *a2 * a3[3] + a2[1] * a3[7] + a2[2] * a3[11] + a3[15];
  *a1 = *a2 * *a3 + a2[1] * a3[4] + a2[2] * a3[8] + a3[12];
  a1[1] = v3;
  a1[2] = v4;
  v9 = v5;
  v6 = !float_near_equal(v9, 1.0);
  result = a1;
  if ( v6 )
  {
    v8 = 1.0 / v9;
    *a1 = v8 * *a1;
    a1[1] = v8 * a1[1];
    a1[2] = v8 * a1[2];
  }
  return result;
}

// sub_45589A @ 0x0045589A
float *__stdcall sub_45589A(float *a1, int a2, int a3, float *a4, float *a5, float *a6)
{
  float *v6; // esi
  float *v8; // [esp-4h] [ebp-54h]
  float v9[16]; // [esp+10h] [ebp-40h] BYREF

  v6 = v9;
  switch ( (a4 != 0) | (2 * ((a5 != 0) | (2 * (a6 != 0)))) )
  {
    case 0:
      v9[14] = 0.0;
      v9[13] = 0.0;
      v9[12] = 0.0;
      v9[11] = 0.0;
      v9[9] = 0.0;
      v9[8] = 0.0;
      v9[7] = 0.0;
      v9[6] = 0.0;
      v9[4] = 0.0;
      v9[3] = 0.0;
      v9[2] = 0.0;
      v9[1] = 0.0;
      v9[15] = 1.0;
      v9[10] = 1.0;
      v9[5] = 1.0;
      v9[0] = 1.0;
      break;
    case 1:
      v6 = a4;
      break;
    case 2:
      v6 = a5;
      break;
    case 3:
      j_FUN_00453a57(v9, a5, a4);
      break;
    case 4:
      v6 = a6;
      break;
    case 5:
      v8 = a4;
      goto LABEL_9;
    case 6:
      v8 = a5;
LABEL_9:
      j_FUN_00453a57(v9, a6, v8);
      break;
    case 7:
      j_FUN_00453a57(v9, a6, a5);
      j_FUN_00453a57(v9, v9, a4);
      break;
    default:
      break;
  }
  j_FUN_00453464(a1, a2, v6);
  if ( a3 )
  {
    *a1 = (*a1 + 1.0) * (double)*(unsigned int *)(a3 + 8) * 0.5 + (double)*(unsigned int *)a3;
    a1[1] = (1.0 - a1[1]) * (double)*(unsigned int *)(a3 + 12) * 0.5 + (double)*(unsigned int *)(a3 + 4);
    a1[2] = (*(float *)(a3 + 20) - *(float *)(a3 + 16)) * a1[2] + *(float *)(a3 + 16);
  }
  return a1;
}

// FUN_00455a27 @ 0x00455A27
// [binja] float* __stdcall sub_455a27(float* arg1, float* arg2, int32_t* arg3, int32_t* arg4, int32_t* arg5, int32_t* arg6)
float *__stdcall sub_455A27(float *a1, float *a2, int a3, int a4, int a5, int a6)
{
  double v6; // st7
  double v7; // st7
  int v9; // [esp+10h] [ebp-54h]
  float v10[16]; // [esp+24h] [ebp-40h] BYREF

  switch ( (a4 != 0) | (2 * ((a5 != 0) | (2 * (a6 != 0)))) )
  {
    case 0:
      v10[14] = 0.0;
      v10[13] = 0.0;
      v10[12] = 0.0;
      v10[11] = 0.0;
      v10[9] = 0.0;
      v10[8] = 0.0;
      v10[7] = 0.0;
      v10[6] = 0.0;
      v10[4] = 0.0;
      v10[3] = 0.0;
      v10[2] = 0.0;
      v10[1] = 0.0;
      v10[15] = 1.0;
      v10[10] = 1.0;
      v10[5] = 1.0;
      v10[0] = 1.0;
      break;
    case 1:
      j_FUN_00453f63(v10, 0, a4);
      break;
    case 2:
      j_FUN_00453f63(v10, 0, a5);
      break;
    case 3:
      j_FUN_00453a57(v10, a5, a4);
      goto LABEL_11;
    case 4:
      j_FUN_00453f63(v10, 0, a6);
      break;
    case 5:
      v9 = a4;
      goto LABEL_9;
    case 6:
      v9 = a5;
LABEL_9:
      j_FUN_00453a57(v10, a6, v9);
      goto LABEL_11;
    case 7:
      j_FUN_00453a57(v10, a6, a5);
      j_FUN_00453a57(v10, v10, a4);
LABEL_11:
      j_FUN_00453f63(v10, 0, v10);
      break;
    default:
      break;
  }
  if ( a3 )
  {
    v6 = *a2 - (double)*(unsigned int *)a3;
    *a1 = v6 / (double)*(unsigned int *)(a3 + 8) + v6 / (double)*(unsigned int *)(a3 + 8) - 1.0;
    v7 = a2[1] - (double)*(unsigned int *)(a3 + 4);
    a1[1] = -(v7 / (double)*(unsigned int *)(a3 + 12) + v7 / (double)*(unsigned int *)(a3 + 12) - 1.0);
    a1[2] = (a2[2] - *(float *)(a3 + 16)) / (*(float *)(a3 + 20) - *(float *)(a3 + 16));
    j_FUN_00453464(a1, a1, v10);
  }
  else
  {
    j_FUN_00453464(a1, a2, v10);
  }
  return a1;
}

// FUN_00455bcd @ 0x00455BCD
// [binja] float* __stdcall sub_455bcd(float* arg1, float arg2)
float *__stdcall sub_455BCD(float *a1, float *a2)
{
  float *v2; // esi
  float *result; // eax
  float *v4; // esi
  long double v5; // st7
  long double v6; // st7
  float v7[4]; // [esp+10h] [ebp-10h] BYREF
  float v8; // [esp+2Ch] [ebp+Ch]

  v2 = a2;
  v8 = *a2 * *a2 + a2[1] * a2[1] + a2[2] * a2[2] + a2[3] * a2[3];
  if ( float_near_equal(v8, 1.0) )
  {
    result = a1;
    if ( a1 == v2 )
      return result;
    goto LABEL_3;
  }
  result = a1;
  if ( v8 > 1.1754944e-38 )
  {
    v5 = 1.0 / sqrt(v8);
    v7[0] = v5 * *v2;
    v7[1] = v5 * v2[1];
    v7[2] = v5 * v2[2];
    v6 = v5 * v2[3];
    v2 = v7;
    v7[3] = v6;
LABEL_3:
    *result = *v2;
    v4 = v2 + 1;
    result[1] = *v4++;
    result[2] = *v4;
    result[3] = v4[1];
    return result;
  }
  *a1 = 0.0;
  a1[1] = 0.0;
  a1[2] = 0.0;
  a1[3] = 0.0;
  return result;
}

// FUN_00455c86 @ 0x00455C86
// [binja] int32_t __stdcall sub_455c86(int32_t arg1, float arg2, float arg3, float arg4)
int __stdcall sub_455C86(int a1, float a2, float a3, float a4)
{
  int v5[4]; // [esp+Ch] [ebp-10h] BYREF

  j_FUN_00454bc0((int)v5, a2, a3, a4);
  ((void (__stdcall *)(int, int *))j_FUN_004546fe)(a1, v5);
  return a1;
}

// sub_455CBF @ 0x00455CBF
float *__stdcall sub_455CBF(float *a1, float *a2, int a3, float *a4, float *a5, int a6, float *a7)
{
  float v7; // ecx
  int v8; // ecx
  float *v9; // esi
  int v10; // eax
  char *v12; // [esp+Ch] [ebp-D0h]
  int v13; // [esp+10h] [ebp-CCh]
  int v14; // [esp+14h] [ebp-C8h]
  _DWORD v15[16]; // [esp+1Ch] [ebp-C0h] BYREF
  _BYTE v16[4]; // [esp+5Ch] [ebp-80h] BYREF
  char v17; // [esp+60h] [ebp-7Ch] BYREF
  _BYTE v18[52]; // [esp+68h] [ebp-74h] BYREF
  _BYTE v19[4]; // [esp+9Ch] [ebp-40h] BYREF
  _BYTE v20[60]; // [esp+A0h] [ebp-3Ch] BYREF

  if ( a4 )
  {
    if ( a3 )
    {
      *(float *)&v15[14] = 0.0;
      v7 = *a4;
      *(float *)&v15[13] = 0.0;
      *(float *)v15 = v7;
      v8 = *((_DWORD *)a4 + 1);
      *(float *)&v15[12] = 0.0;
      *(float *)&v15[10] = a4[2];
      *(float *)&v15[11] = 0.0;
      v15[5] = v8;
      *(float *)&v15[9] = 0.0;
      *(float *)&v15[8] = 0.0;
      *(float *)&v15[7] = 0.0;
      *(float *)&v15[6] = 0.0;
      *(float *)&v15[4] = 0.0;
      *(float *)&v15[3] = 0.0;
      *(float *)&v15[2] = 0.0;
      *(float *)&v15[1] = 0.0;
      *(float *)&v15[15] = 1.0;
      j_FUN_004546fe(v16, a3, v12, v13, v14);
      v12 = &v17;
      if ( a2 )
      {
        j_FUN_00453ca0(v20);
        v9 = a1;
        a1[14] = 0.0;
        a1[13] = 0.0;
        a1[12] = 0.0;
        a1[11] = 0.0;
        a1[9] = 0.0;
        a1[8] = 0.0;
        a1[7] = 0.0;
        a1[6] = 0.0;
        a1[4] = 0.0;
        a1[3] = 0.0;
        a1[2] = 0.0;
        a1[1] = 0.0;
        a1[15] = 1.0;
        a1[10] = 1.0;
        a1[5] = 1.0;
        *a1 = 1.0;
        a1[12] = -*a2;
        a1[13] = -a2[1];
        a1[14] = -a2[2];
        j_FUN_00453a57(a1, a1, v19);
        j_FUN_00453a57(v9, v9, v15);
        j_FUN_00453a57(v9, v9, v16);
        a1[12] = a1[12] + *a2;
        a1[13] = a2[1] + a1[13];
        a1[14] = a1[14] + a2[2];
      }
      else
      {
        v9 = a1;
        j_FUN_00453ca0(a1);
        j_FUN_00453a57(v9, v9, v15);
        j_FUN_00453a57(v9, v9, v16);
      }
    }
    else
    {
      v9 = a1;
      a1[14] = 0.0;
      a1[13] = 0.0;
      a1[12] = 0.0;
      a1[11] = 0.0;
      a1[9] = 0.0;
      a1[8] = 0.0;
      a1[7] = 0.0;
      a1[6] = 0.0;
      a1[4] = 0.0;
      a1[3] = 0.0;
      a1[2] = 0.0;
      a1[1] = 0.0;
      *a1 = *a4;
      a1[5] = a4[1];
      v10 = *((_DWORD *)a4 + 2);
      a1[15] = 1.0;
      *((_DWORD *)a1 + 10) = v10;
    }
  }
  else
  {
    v9 = a1;
    a1[14] = 0.0;
    a1[13] = 0.0;
    a1[12] = 0.0;
    a1[11] = 0.0;
    a1[9] = 0.0;
    a1[8] = 0.0;
    a1[7] = 0.0;
    a1[6] = 0.0;
    a1[4] = 0.0;
    a1[3] = 0.0;
    a1[2] = 0.0;
    a1[1] = 0.0;
    a1[15] = 1.0;
    a1[10] = 1.0;
    a1[5] = 1.0;
    *a1 = 1.0;
  }
  if ( a6 )
  {
    j_FUN_004546fe(v16, a6, v12, v13, v14);
    if ( a5 )
    {
      v9[12] = v9[12] - *a5;
      v9[13] = v9[13] - a5[1];
      v9[14] = v9[14] - a5[2];
      j_FUN_00453a57(v9, v9, v18);
      v9[12] = v9[12] + *a5;
      v9[13] = v9[13] + a5[1];
      v9[14] = v9[14] + a5[2];
    }
    else
    {
      j_FUN_00453a57(v9, v9, v18);
    }
  }
  if ( a7 )
  {
    v9[12] = v9[12] + *a7;
    v9[13] = a7[1] + v9[13];
    v9[14] = a7[2] + v9[14];
  }
  return v9;
}

// sub_455F73 @ 0x00455F73
float *__stdcall sub_455F73(float *a1, float *a2, int a3)
{
  double v4; // st7
  double v5; // st6
  double v6; // st5
  double v7; // st4
  double v8; // st3
  float v9; // [esp+8h] [ebp-18h]
  float v10; // [esp+Ch] [ebp-14h]
  float v11; // [esp+10h] [ebp-10h] BYREF
  float v12; // [esp+14h] [ebp-Ch]
  float v13; // [esp+18h] [ebp-8h]
  float v14; // [esp+1Ch] [ebp-4h]

  j_FUN_00455281(&v11, a3);
  v4 = v12 * a2[1] + v11 * *a2 + v14 * a2[3] + v13 * a2[2];
  v5 = -v11;
  v6 = -v12;
  v7 = -v13;
  v9 = v7;
  v8 = -v14;
  v10 = v8;
  *a1 = v5 * *a2 + v4;
  a1[4] = v6 * *a2;
  a1[8] = v7 * *a2;
  a1[12] = v8 * *a2;
  a1[1] = v5 * a2[1];
  a1[5] = v6 * a2[1] + v4;
  a1[9] = v7 * a2[1];
  a1[13] = v8 * a2[1];
  a1[2] = v5 * a2[2];
  a1[6] = v6 * a2[2];
  a1[10] = v7 * a2[2] + v4;
  a1[14] = v8 * a2[2];
  a1[3] = v5 * a2[3];
  a1[7] = v6 * a2[3];
  a1[11] = v9 * a2[3];
  a1[15] = v10 * a2[3] + v4;
  return a1;
}

// sub_45604D @ 0x0045604D
float *__stdcall sub_45604D(float *a1, int a2)
{
  double v2; // st7
  double v4; // st6
  double v5; // st5
  float v6; // [esp+0h] [ebp-10h] BYREF
  float v7; // [esp+4h] [ebp-Ch]
  float v8; // [esp+8h] [ebp-8h]
  float v9; // [esp+Ch] [ebp-4h]
  float v10; // [esp+1Ch] [ebp+Ch]

  j_FUN_00455281(&v6, a2);
  v2 = v6 * -2.0;
  v4 = v7 * -2.0;
  v5 = v8 * -2.0;
  v10 = v5;
  *a1 = v6 * v2 + 1.0;
  a1[1] = v4 * v6;
  a1[2] = v5 * v6;
  a1[3] = 0.0;
  a1[4] = v7 * v2;
  a1[5] = v7 * v4 + 1.0;
  a1[6] = v5 * v7;
  a1[7] = 0.0;
  a1[8] = v8 * v2;
  a1[9] = v8 * v4;
  a1[10] = v8 * v5 + 1.0;
  a1[11] = 0.0;
  a1[12] = v9 * v2;
  a1[13] = v9 * v4;
  a1[14] = v9 * v10;
  a1[15] = 1.0;
  return a1;
}

// sub_45610C @ 0x0045610C
int __stdcall sub_45610C(float *a1, float *a2, float *a3, float *a4, float *a5, float *a6, float *a7)
{
  unsigned __int8 v8; // c0
  unsigned __int8 v9; // c3
  unsigned __int8 v11; // c0
  unsigned __int8 v12; // c3
  unsigned __int8 v14; // c0
  unsigned __int8 v15; // c3
  int result; // eax
  _BYTE v17[16]; // [esp+8h] [ebp-44h] BYREF
  float v18; // [esp+18h] [ebp-34h] BYREF
  float v19; // [esp+1Ch] [ebp-30h]
  float v20; // [esp+20h] [ebp-2Ch]
  float v21; // [esp+24h] [ebp-28h]
  float v22; // [esp+28h] [ebp-24h] BYREF
  float v23; // [esp+2Ch] [ebp-20h]
  float v24; // [esp+30h] [ebp-1Ch]
  float v25; // [esp+34h] [ebp-18h]
  float v26; // [esp+38h] [ebp-14h] BYREF
  float v27; // [esp+3Ch] [ebp-10h]
  float v28; // [esp+40h] [ebp-Ch]
  float v29; // [esp+44h] [ebp-8h]
  float v30; // [esp+48h] [ebp-4h] BYREF
  float v31; // [esp+4Ch] [ebp+0h]
  float v32; // [esp+50h] [ebp+4h]
  float v33; // [esp+54h] [ebp+8h]
  float v34; // [esp+58h] [ebp+Ch] BYREF
  float v35; // [esp+5Ch] [ebp+10h]
  float v36; // [esp+60h] [ebp+14h]
  float v37; // [esp+64h] [ebp+18h]
  float v38; // [esp+68h] [ebp+1Ch] BYREF
  float v39; // [esp+6Ch] [ebp+20h]
  float v40; // [esp+70h] [ebp+24h]
  float v41; // [esp+74h] [ebp+28h]
  float v42; // [esp+78h] [ebp+2Ch] BYREF
  float v43; // [esp+7Ch] [ebp+30h]
  float v44; // [esp+80h] [ebp+34h]
  float v45; // [esp+84h] [ebp+38h]
  float v46; // [esp+88h] [ebp+3Ch] BYREF
  float v47; // [esp+8Ch] [ebp+40h]
  float v48; // [esp+90h] [ebp+44h]
  float v49; // [esp+94h] [ebp+48h]
  float v50; // [esp+98h] [ebp+4Ch] BYREF
  float v51; // [esp+9Ch] [ebp+50h]
  float v52; // [esp+A0h] [ebp+54h]
  float v53; // [esp+A4h] [ebp+58h]

  v22 = *a4;
  v23 = a4[1];
  v24 = a4[2];
  v25 = a4[3];
  v34 = *a5;
  v35 = a5[1];
  v36 = a5[2];
  v37 = a5[3];
  v46 = *a6;
  v47 = a6[1];
  v48 = a6[2];
  v51 = v23 - v35;
  v49 = a6[3];
  v52 = v24 - v36;
  v26 = *a7;
  v27 = a7[1];
  v53 = v25 - v37;
  v28 = a7[2];
  v29 = a7[3];
  if ( !(v8 | v9) )
  {
    v42 = -v22;
    v43 = -v23;
    v44 = -v24;
    v45 = -v25;
    v22 = v42;
    v23 = v43;
    v24 = v44;
    v25 = v45;
  }
  v51 = v35 - v47;
  v52 = v36 - v48;
  v53 = v37 - v49;
  if ( !(v11 | v12) )
  {
    v42 = -v46;
    v43 = -v47;
    v44 = -v48;
    v45 = -v49;
    v46 = v42;
    v47 = v43;
    v48 = v44;
    v49 = v45;
  }
  v51 = v47 - v27;
  v52 = v48 - v28;
  v53 = v49 - v29;
  if ( !(v14 | v15) )
  {
    v42 = -v26;
    v43 = -v27;
    v44 = -v28;
    v45 = -v29;
    v26 = v42;
    v27 = v43;
    v28 = v44;
    v29 = v45;
  }
  j_FUN_00454e3c(&v42, &v34);
  j_FUN_00454ccd(&v38, &v42, &v22);
  v30 = v38;
  v31 = v39;
  v32 = v40;
  v33 = v41;
  FUN_00454f03(&v18, &v30);
  j_FUN_00454ccd(&v38, &v42, &v46);
  v30 = v38;
  v31 = v39;
  v32 = v40;
  v33 = v41;
  FUN_00454f03(&v50, &v30);
  v39 = v19 + v51;
  v40 = v20 + v52;
  v30 = (v18 + v50) * -0.25;
  v31 = v39 * -0.25;
  v32 = v40 * -0.25;
  v33 = (v21 + v53) * -0.25;
  FUN_00454f87(v17, &v30);
  j_FUN_00454ccd(&v38, &v34, v17);
  *a1 = v38;
  a1[1] = v39;
  a1[2] = v40;
  a1[3] = v41;
  j_FUN_00454e3c(&v42, &v46);
  j_FUN_00454ccd(&v38, &v42, &v34);
  v30 = v38;
  v31 = v39;
  v32 = v40;
  v33 = v41;
  FUN_00454f03(&v18, &v30);
  j_FUN_00454ccd(&v38, &v42, &v26);
  v30 = v38;
  v31 = v39;
  v32 = v40;
  v33 = v41;
  FUN_00454f03(&v50, &v30);
  v39 = v19 + v51;
  v40 = v20 + v52;
  v30 = (v18 + v50) * -0.25;
  v31 = v39 * -0.25;
  v32 = v40 * -0.25;
  v33 = (v21 + v53) * -0.25;
  FUN_00454f87(v17, &v30);
  result = j_FUN_00454ccd(&v38, &v46, v17);
  *a2 = v38;
  a2[1] = v39;
  a2[2] = v40;
  a2[3] = v41;
  *a3 = v46;
  a3[1] = v47;
  a3[2] = v48;
  a3[3] = v49;
  return result;
}

// sub_4564E6 @ 0x004564E6
BOOL __cdecl sub_4564E6(int a1, LPCSTR lpValueName, LPBYTE lpData, DWORD cbData)
{
  LSTATUS v4; // esi
  BOOL result; // eax
  DWORD Type; // [esp+0h] [ebp-8h] BYREF
  HKEY phkResult; // [esp+4h] [ebp-4h] BYREF

  phkResult = 0;
  result = 0;
  if ( !RegOpenKeyA(HKEY_LOCAL_MACHINE, "Software\\Microsoft\\Direct3D", &phkResult) )
  {
    v4 = RegQueryValueExA(phkResult, lpValueName, 0, &Type, lpData, &cbData);
    RegCloseKey(phkResult);
    if ( !v4 && Type == a1 )
      return 1;
  }
  return result;
}

// sub_456542 @ 0x00456542
BOOL sub_456542()
{
  int v11; // [esp+Ch] [ebp-4h]

  v11 = 0;
  _EAX = 0x80000000;
  __asm { cpuid }
  if ( _EAX >= 0x80000001 )
  {
    _EAX = -2147483647;
    __asm { cpuid }
    return _EDX < 0;
  }
  return v11;
}

// sub_45657A @ 0x0045657A
int sub_45657A()
{
  _DWORD v11[7]; // [esp-Ch] [ebp-48h] BYREF
  int v12; // [esp+10h] [ebp-2Ch]
  int v13; // [esp+14h] [ebp-28h]
  char v14[16]; // [esp+18h] [ebp-24h] BYREF
  int v15; // [esp+28h] [ebp-14h]
  _DWORD *v16; // [esp+2Ch] [ebp-10h]
  int v17; // [esp+38h] [ebp-4h]

  v16 = v11;
  v15 = 0;
  strcpy(v14, "GenuineIntel");
  _EAX = 0;
  __asm { cpuid }
  v12 = _EAX;
  v11[4] = _EBX;
  v11[5] = _EDX;
  v11[6] = _ECX;
  v17 = -1;
  if ( !_EAX )
    return v15;
  _EAX = 1;
  __asm { cpuid }
  v12 = _EAX;
  v13 = _EDX;
  if ( (_EDX & 0x2000000) != 0 )
    v15 |= 4u;
  if ( (v13 & 0x4000000) != 0 )
    return v15 | 8;
  return v15;
}

// sub_45661F @ 0x0045661F
int __cdecl sub_45661F(DWORD ProcessorFeature)
{
  char v1; // bl
  struct _OSVERSIONINFOA VersionInformation; // [esp+8h] [ebp-24h] BYREF
  char v4; // [esp+9Fh] [ebp+73h]

  memset(&VersionInformation, 0, sizeof(VersionInformation));
  v1 = 0;
  v4 = 0;
  VersionInformation.dwOSVersionInfoSize = 148;
  if ( !GetVersionExA(&VersionInformation) )
  {
    v1 = 1;
    v4 = 1;
  }
  if ( VersionInformation.dwPlatformId == 1 )
  {
    if ( VersionInformation.dwMajorVersion <= 4
      && (VersionInformation.dwMajorVersion != 4
       || VersionInformation.dwMinorVersion < 0xA
       || LOWORD(VersionInformation.dwBuildNumber) < 0x55Du) )
    {
      v4 = 1;
    }
    goto LABEL_11;
  }
  if ( VersionInformation.dwPlatformId != 2 )
    return 0;
  if ( v1 )
  {
LABEL_11:
    if ( ProcessorFeature != 6 )
    {
      if ( ProcessorFeature == 7 )
        return sub_456542();
      if ( ProcessorFeature != 10 || v4 )
        return 0;
      return sub_45657A() & 8;
    }
    if ( !v4 )
      return sub_45657A() & 4;
    return 0;
  }
  if ( ProcessorFeature != 10 )
    return IsProcessorFeaturePresent(ProcessorFeature);
  return sub_45657A() & 8;
}

// renderer_select_backend @ 0x004566D3
// selects renderer table based on config
int __stdcall sub_4566D3(int Data)
{
  if ( Data )
  {
    if ( dword_479770 == 0xFFFF )
    {
      dword_479770 = 0;
      qmemcpy(&off_4795A0, off_479688, 0xE4u);
      sub_457127(&off_4795A0);
      if ( !sub_4564E6(4, "DisableD3DXPSGP", (LPBYTE)&Data, 4u) )
        Data = 0;
      if ( Data != 1 )
      {
        if ( sub_45661F(7u) )
        {
          sub_456AA5(&off_4795A0);
          dword_479770 = 1;
        }
        else if ( sub_45661F(0xAu) )
        {
          sub_4568C0(&off_4795A0);
          dword_479770 = 2;
        }
        else if ( sub_45661F(6u) )
        {
          sub_4567B0(&off_4795A0);
          dword_479770 = 3;
        }
      }
    }
  }
  else
  {
    dword_479770 = 0xFFFF;
    qmemcpy(&off_4795A0, off_479688, 0xE4u);
  }
  return dword_479770;
}

// sub_4567B0 @ 0x004567B0
__m128 *(__stdcall **__cdecl sub_4567B0(
        __m128 *(__stdcall **a1)(__m128 *, unsigned int *, __m128 *)))(__m128 *, unsigned int *, __m128 *)
{
  a1[28] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457E90;
  *a1 = sub_457170;
  a1[13] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457C10;
  a1[27] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457D00;
  a1[11] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458E20;
  a1[48] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457AF0;
  a1[47] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457710;
  a1[17] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_4579B0;
  a1[54] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457AA0;
  a1[53] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_4577A0;
  a1[52] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457910;
  a1[51] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457A40;
  a1[50] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457650;
  a1[49] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457850;
  a1[18] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458840;
  a1[22] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457B50;
  a1[25] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458230;
  a1[24] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458110;
  a1[19] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457F70;
  a1[44] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_4580A0;
  a1[20] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458000;
  a1[16] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457500;
  a1[21] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457420;
  a1[8] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_4575B0;
  a1[7] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457350;
  a1[10] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457250;
  a1[9] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_4571B0;
  a1[6] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458300;
  a1[5] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457210;
  a1[4] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458B00;
  a1[3] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458540;
  a1[2] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458480;
  a1[1] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_4583C0;
  return a1;
}

// sub_4568C0 @ 0x004568C0
__m128 *(__stdcall **__cdecl sub_4568C0(
        __m128 *(__stdcall **a1)(__m128 *, unsigned int *, __m128 *)))(__m128 *, unsigned int *, __m128 *)
{
  a1[28] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_459170;
  *a1 = sub_457170;
  a1[13] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458EF0;
  a1[27] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458FE0;
  a1[11] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458E20;
  a1[48] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457AF0;
  a1[47] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457710;
  a1[17] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_4579B0;
  a1[54] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457AA0;
  a1[53] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_4577A0;
  a1[52] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457910;
  a1[51] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457A40;
  a1[50] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457650;
  a1[49] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457850;
  a1[18] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458840;
  a1[22] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457B50;
  a1[25] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_459370;
  a1[24] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_459250;
  a1[31] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458D90;
  a1[30] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458D10;
  a1[19] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457F70;
  a1[20] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458000;
  a1[16] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458C60;
  a1[21] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458760;
  a1[8] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_4575B0;
  a1[7] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458690;
  a1[10] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457250;
  a1[9] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_4571B0;
  a1[6] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458300;
  a1[5] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_457210;
  a1[4] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458B00;
  a1[3] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458540;
  a1[2] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_458480;
  a1[1] = (__m128 *(__stdcall *)(__m128 *, unsigned int *, __m128 *))sub_4583C0;
  return a1;
}

// FUN_004569d0 @ 0x004569D0
// [binja] int32_t sub_4569d0()
int sub_4569D0()
{
  char v26[16]; // [esp+Ch] [ebp-28h] BYREF
  _DWORD v27[5]; // [esp+1Ch] [ebp-18h] BYREF
  int v28; // [esp+30h] [ebp-4h]

  strcpy((char *)v27, "UnknownVendr");
  strcpy(v26, "AuthenticAMD");
  _EAX = 0;
  __asm { cpuid }
  v28 = 1;
  _EAX = 0;
  __asm { cpuid }
  v27[0] = _EBX;
  v27[1] = _EDX;
  v27[2] = _ECX;
  if ( _EAX )
  {
    _EAX = 1;
    __asm { cpuid }
    v27[4] = _EAX;
    v28 |= ((_EDX & 0x800000) != 0 ? 0x20 : 0) | 2;
    _EAX = 0x80000000;
    __asm { cpuid }
    if ( _EAX > 0x80000000 )
    {
      v28 |= 4u;
      _EAX = -2147483647;
      __asm { cpuid }
      v28 |= _EDX < 0 ? 0x80 : 0;
      if ( !memcmp(v26, v27, 0xCu) )
      {
        v28 |= (_EDX & 0x40000000) != 0 ? 0x100 : 0;
        return ((_EDX & 0x400000) != 0 ? 0x200 : 0) | v28;
      }
    }
  }
  return v28;
}

// sub_456AA5 @ 0x00456AA5
int __cdecl sub_456AA5(__m64 *(__stdcall **a1)(__m64 *, __m64 *, __m64 *))
{
  int result; // eax

  result = FUN_004569d0();
  if ( (result & 0x20) != 0 && (result & 0x80u) != 0 )
  {
    *a1 = sub_45F218;
    a1[1] = sub_45E75A;
    a1[2] = sub_45F4D9;
    a1[3] = sub_45A9AA;
    a1[5] = sub_45F26D;
    a1[6] = sub_45E7CB;
    a1[7] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45E832;
    a1[8] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45F55B;
    a1[9] = sub_45F2A6;
    a1[10] = j_vec3_transform_coord;
    a1[11] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45ABDC;
    a1[12] = sub_45F903;
    a1[13] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45F946;
    a1[14] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))vec3_project;
    a1[15] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))vec3_unproject;
    a1[16] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45F5BA;
    a1[17] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45F30A;
    a1[18] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45E73E;
    a1[19] = sub_459440;
    a1[20] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_4594D9;
    a1[21] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45FAE8;
    a1[22] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45FA2A;
    a1[23] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_459536;
    a1[24] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_4595E9;
    a1[25] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_459A1A;
    a1[26] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45ACAB;
    a1[27] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45ACFB;
    a1[28] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45ADE6;
    a1[29] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_459ADF;
    a1[30] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45AEC2;
    a1[31] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45AF25;
    a1[32] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45AF83;
    a1[33] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45AFDC;
    a1[34] = sub_45FB4C;
    a1[35] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_459B4B;
    a1[36] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_459C82;
    a1[37] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45B023;
    a1[38] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45B0CB;
    a1[39] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45B252;
    a1[40] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45C3EA;
    a1[41] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45C58F;
    a1[42] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45CAC3;
    a1[43] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_459D0F;
    a1[44] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_459DA1;
    a1[54] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45F6EC;
    a1[51] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45E891;
    a1[48] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45F3A2;
    a1[46] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45F3EB;
    a1[52] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45F75D;
    a1[49] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45E902;
    a1[55] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_459E05;
    a1[56] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_459EAC;
    a1[53] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45F825;
    a1[47] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45F42E;
    a1[50] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45E9D6;
    a1[4] = sub_45E012;
    a1[45] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_459F51;
    if ( (result & 0x100) != 0 && (result & 0x200) != 0 )
    {
      a1[15] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45F0C5;
      a1[18] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45DD30;
      a1[38] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45B19D;
      a1[39] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_45CBDC;
      a1[24] = (__m64 *(__stdcall *)(__m64 *, __m64 *, __m64 *))sub_459805;
    }
  }
  return result;
}

// sub_456CCB @ 0x00456CCB
float *__stdcall sub_456CCB(float *a1, float *a2, float *a3)
{
  double v3; // st5
  double v4; // st6
  double v5; // st7

  v3 = *a2 * a3[1] + a2[1] * a3[5] + a3[13];
  v4 = *a2 * a3[2] + a2[1] * a3[6] + a3[14];
  v5 = *a2 * a3[3] + a2[1] * a3[7] + a3[15];
  *a1 = *a2 * *a3 + a2[1] * a3[4] + a3[12];
  a1[1] = v3;
  a1[2] = v4;
  a1[3] = v5;
  return a1;
}

// sub_456D34 @ 0x00456D34
float *__stdcall sub_456D34(float *a1, float *a2, float *a3)
{
  double v3; // st7

  v3 = *a2 * a3[1] + a2[1] * a3[5];
  *a1 = *a2 * *a3 + a2[1] * a3[4];
  a1[1] = v3;
  return a1;
}

// sub_456D69 @ 0x00456D69
float *__stdcall sub_456D69(float *a1, float *a2, float *a3)
{
  double v3; // st5
  double v4; // st6
  double v5; // st7

  v3 = *a2 * a3[1] + a2[1] * a3[5] + a2[2] * a3[9] + a3[13];
  v4 = *a2 * a3[2] + a2[1] * a3[6] + a2[2] * a3[10] + a3[14];
  v5 = *a2 * a3[3] + a2[1] * a3[7] + a2[2] * a3[11] + a3[15];
  *a1 = *a2 * *a3 + a2[1] * a3[4] + a2[2] * a3[8] + a3[12];
  a1[1] = v3;
  a1[2] = v4;
  a1[3] = v5;
  return a1;
}

// sub_456DF4 @ 0x00456DF4
float *__stdcall sub_456DF4(float *a1, float *a2, float *a3)
{
  double v3; // st6
  double v4; // st7

  v3 = *a2 * a3[1] + a2[1] * a3[5] + a2[2] * a3[9];
  v4 = *a2 * a3[2] + a2[1] * a3[6] + a2[2] * a3[10];
  *a1 = *a2 * *a3 + a2[1] * a3[4] + a2[2] * a3[8];
  a1[1] = v3;
  a1[2] = v4;
  return a1;
}

// sub_456E53 @ 0x00456E53
float *__stdcall sub_456E53(float *a1, float *a2, float *a3)
{
  double v3; // st5
  double v4; // st6
  double v5; // st7

  v3 = *a2 * a3[1] + a2[1] * a3[5] + a2[2] * a3[9] + a2[3] * a3[13];
  v4 = *a2 * a3[2] + a2[1] * a3[6] + a2[2] * a3[10] + a2[3] * a3[14];
  v5 = *a2 * a3[3] + a2[1] * a3[7] + a2[2] * a3[11] + a2[3] * a3[15];
  *a1 = *a2 * *a3 + a2[1] * a3[4] + a2[2] * a3[8] + a2[3] * a3[12];
  a1[1] = v3;
  a1[2] = v4;
  a1[3] = v5;
  return a1;
}

// FUN_00456eec @ 0x00456EEC
// [binja] float* __stdcall sub_456eec(float* arg1, float* arg2)
float *__stdcall sub_456EEC(float *a1, float *a2)
{
  float v8; // [esp+4h] [ebp-8h]
  float v9; // [esp+8h] [ebp-4h]
  int v10; // [esp+8h] [ebp-4h]
  unsigned int v11; // [esp+8h] [ebp-4h]

  _EDX = a2;
  __asm
  {
    fld     dword ptr [edx]
    fmul    dword ptr [edx]
    fld     dword ptr [edx+4]
    fmul    dword ptr [edx+4]
    fld     dword ptr [edx+8]
    fmul    dword ptr [edx+8]
    fxch    st(2)
    faddp   st(1), st
    faddp   st(1), st
    fst     [ebp+var_8]
  }
  if ( v8 == 0.0 )
  {
    __asm { ffree   st }
    *(_DWORD *)a1 = LOBYTE(v8);
    *((_DWORD *)a1 + 1) = LOBYTE(v8);
    *((_DWORD *)a1 + 2) = LOBYTE(v8);
  }
  else
  {
    __asm
    {
      fld1
      fsubp   st(1), st
      fstp    [ebp+var_4]
    }
    if ( (LODWORD(v9) & 0x7FFFFFFFu) > 0x3727C5AC )
    {
      _EDI = (LODWORD(v8) >> 12) & 0xFF8;
      v10 = LODWORD(v8) & 0xFFFFFF | 0x3F000000;
      __asm
      {
        fld     [ebp+var_4]
        fmul    dword ptr [edi+479780h]
      }
      __asm { fadd    dword ptr [edi+479784h] }
      v11 = ((unsigned int)(-1090519041 - LODWORD(v8)) >> 1) & 0xFF800000;
      __asm
      {
        fmul    [ebp+var_4]
        fld     dword ptr [edx]
        fmul    st, st(1)
        fld     dword ptr [edx+4]
        fmul    st, st(2)
        fld     dword ptr [edx+8]
        fmul    st, st(3)
        fxch    st(2)
        fstp    dword ptr [ecx]
      }
      *a1 = _ET1;
      __asm { fstp    dword ptr [ecx+4] }
      a1[1] = _ET1;
      __asm { fstp    dword ptr [ecx+8] }
      a1[2] = _ET1;
      __asm { fstp    st }
    }
    else if ( a1 != a2 )
    {
      *a1 = *a2;
      a1[1] = a2[1];
      a1[2] = a2[2];
    }
  }
  return a1;
}

// FUN_00456fb6 @ 0x00456FB6
// [binja] int32_t __stdcall sub_456fb6(int32_t arg1, int32_t arg2, void* arg3)
_BYTE *__stdcall sub_456FB6(_BYTE *a1, _BYTE *a2, _BYTE *a3)
{
  _BYTE *result; // eax
  _BYTE *v4; // ebx
  _BYTE *v10; // ebx
  int v13; // edi
  _BYTE v16[64]; // [esp+Ch] [ebp-40h] BYREF

  result = a1;
  if ( a3 == a1 )
  {
    if ( a2 != a1 )
    {
      v4 = a1;
      _ECX = a2;
      _EDX = a3;
      _EDI = -4;
      do
      {
        _ESI = -16;
        __asm
        {
          fld     dword ptr [edx+edi*4+10h]
          fld     dword ptr [edx+edi*4+20h]
          fld     dword ptr [edx+edi*4+30h]
          fld     dword ptr [edx+edi*4+40h]
        }
        do
        {
          __asm
          {
            fld     st(3)
            fmul    dword ptr [ecx+esi*4+40h]
            fld     st(3)
            fmul    dword ptr [ecx+esi*4+44h]
            fld     st(3)
            fmul    dword ptr [ecx+esi*4+48h]
            fld     st(3)
            fmul    dword ptr [ecx+esi*4+4Ch]
            fxch    st(3)
            faddp   st(1), st
            fxch    st(2)
            faddp   st(1), st
            faddp   st(1), st
            fstp    dword ptr [ebx+esi*4+40h]
          }
          *(float *)&v4[4 * _ESI + 64] = _ET1;
          _ESI += 4;
        }
        while ( _ESI );
        __asm
        {
          ffree   st(3)
          ffree   st(2)
          ffree   st(1)
          ffree   st
        }
        v4 += 4;
        ++_EDI;
      }
      while ( _EDI );
      return result;
    }
    qmemcpy(v16, a3, sizeof(v16));
    a3 = v16;
  }
  v10 = a1;
  _ECX = a2;
  _EDX = a3;
  v13 = -4;
  do
  {
    _ESI = -4;
    __asm
    {
      fld     dword ptr [ecx]
      fld     dword ptr [ecx+4]
      fld     dword ptr [ecx+8]
      fld     dword ptr [ecx+0Ch]
    }
    do
    {
      __asm
      {
        fld     st(3)
        fmul    dword ptr [edx+esi*4+10h]
        fld     st(3)
        fmul    dword ptr [edx+esi*4+20h]
        fld     st(3)
        fmul    dword ptr [edx+esi*4+30h]
        fld     st(3)
        fmul    dword ptr [edx+esi*4+40h]
        fxch    st(3)
        faddp   st(1), st
        fxch    st(2)
        faddp   st(1), st
        faddp   st(1), st
        fstp    dword ptr [ebx+esi*4+10h]
      }
      *(float *)&v10[4 * _ESI++ + 16] = _ET1;
    }
    while ( _ESI );
    __asm
    {
      ffree   st(3)
      ffree   st(2)
      ffree   st(1)
      ffree   st
    }
    _ECX += 16;
    v10 += 16;
    ++v13;
  }
  while ( v13 );
  return result;
}

// FUN_00457099 @ 0x00457099
// [binja] void* __stdcall sub_457099(void* arg1, int32_t arg2, int32_t arg3)
char *__stdcall sub_457099(char *a1, char *a2, char *a3)
{
  char *v3; // eax
  int v6; // edi
  float *v8; // ebx
  char *result; // eax
  char v11; // [esp+0h] [ebp-44h] BYREF
  char *v12; // [esp+40h] [ebp-4h]

  v3 = a1;
  if ( a1 == a2 || a1 == a3 )
    v3 = &v11;
  v12 = v3;
  _ECX = a2;
  _EDX = a3;
  v6 = -4;
  do
  {
    _ESI = -4;
    v8 = (float *)&v3[4 * v6 + 16];
    __asm
    {
      fld     dword ptr [ecx]
      fld     dword ptr [ecx+4]
      fld     dword ptr [ecx+8]
      fld     dword ptr [ecx+0Ch]
    }
    do
    {
      __asm
      {
        fld     st(3)
        fmul    dword ptr [edx+esi*4+10h]
        fld     st(3)
        fmul    dword ptr [edx+esi*4+20h]
        fld     st(3)
        fmul    dword ptr [edx+esi*4+30h]
        fld     st(3)
        fmul    dword ptr [edx+esi*4+40h]
        fxch    st(3)
        faddp   st(1), st
        fxch    st(2)
        faddp   st(1), st
        faddp   st(1), st
        fstp    dword ptr [ebx]
      }
      *v8 = _ET1;
      v8 += 4;
      ++_ESI;
    }
    while ( _ESI );
    __asm
    {
      ffree   st(3)
      ffree   st(2)
      ffree   st(1)
      ffree   st
    }
    _ECX += 16;
    ++v6;
  }
  while ( v6 );
  result = a1;
  if ( v12 != a1 )
    qmemcpy(a1, v12, 0x40u);
  return result;
}

// sub_457127 @ 0x00457127
float *(__stdcall **__cdecl sub_457127(
        float *(__stdcall **a1)(float *a1, float *a2, float *a3)))(float *a1, float *a2, float *a3)
{
  *a1 = sub_456CCB;
  a1[1] = sub_456D69;
  a1[2] = sub_456E53;
  a1[3] = (float *(__stdcall *)(float *, float *, float *))FUN_00456fb6;
  a1[4] = (float *(__stdcall *)(float *, float *, float *))FUN_00457099;
  a1[5] = sub_456D34;
  a1[6] = sub_456DF4;
  a1[7] = (float *(__stdcall *)(float *, float *, float *))FUN_00456eec;
  return a1;
}

// sub_457170 @ 0x00457170
__m128 *__stdcall sub_457170(__m128 *a1, unsigned int *a2, __m128 *a3)
{
  *a1 = _mm_add_ps(
          _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps((__m128)*a2, (__m128)*a2, 0), *a3), a3[3]),
          _mm_mul_ps(_mm_shuffle_ps((__m128)a2[1], (__m128)a2[1], 0), a3[1]));
  return a1;
}

// sub_4571B0 @ 0x004571B0
double *__stdcall sub_4571B0(double *a1, unsigned int *a2, __m128 *a3)
{
  __m128 v3; // xmm2
  __m128 v4; // xmm0
  __m128 v5; // xmm1

  v3 = _mm_add_ps(
         _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps((__m128)*a2, (__m128)*a2, 0), *a3), a3[3]),
         _mm_mul_ps(_mm_shuffle_ps((__m128)a2[1], (__m128)a2[1], 0), a3[1]));
  v4 = _mm_rcp_ps(v3);
  v5 = _mm_mul_ps(_mm_mul_ps(v4, v4), v3);
  _mm_storel_ps(a1, _mm_mul_ps(v3, _mm_shuffle_ps(v5, v5, 255)));
  return a1;
}

// sub_457210 @ 0x00457210
double *__stdcall sub_457210(double *a1, unsigned int *a2, __m128 *a3)
{
  _mm_storel_ps(
    a1,
    _mm_add_ps(
      _mm_mul_ps(_mm_shuffle_ps((__m128)*a2, (__m128)*a2, 0), *a3),
      _mm_mul_ps(_mm_shuffle_ps((__m128)a2[1], (__m128)a2[1], 0), a3[1])));
  return a1;
}

// sub_457250 @ 0x00457250
void __stdcall sub_457250(int a1, int a2, int a3)
{
  JUMPOUT(0x457261);
}

// sub_45725E @ 0x0045725E
int __stdcall sub_45725E(int a1, int a2, int a3)
{
  __m128 v3; // xmm2
  __m128 v4; // xmm0
  __m128 v5; // xmm2
  __m128 v6; // xmm2
  __m128 v7; // xmm0
  __m128 v9; // xmm6
  __m128 v10; // xmm4
  __m128 v11; // xmm1
  __m128 v12; // xmm1
  __m128 v13; // xmm4

  if ( (a3 & 0xF) != 0 )
  {
    v9 = _mm_loadl_ps((const double *)a2);
    v10 = _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(_mm_loadh_ps((const double *)(a3 + 8)), _mm_shuffle_ps(v9, v9, 0)),
              _mm_mul_ps(_mm_loadh_ps((const double *)(a3 + 24)), _mm_shuffle_ps(v9, v9, 85))),
            _mm_add_ps(
              _mm_mul_ps(
                _mm_loadh_ps((const double *)(a3 + 40)),
                _mm_shuffle_ps((__m128)*(unsigned int *)(a2 + 8), (__m128)*(unsigned int *)(a2 + 8), 0)),
              _mm_loadh_ps((const double *)(a3 + 56))));
    v11 = _mm_rcp_ps(v10);
    v12 = _mm_sub_ps(_mm_add_ps(v11, v11), _mm_mul_ps(_mm_mul_ps(v11, v10), v11));
    v13 = _mm_mul_ps(v10, _mm_shuffle_ps(v12, v12, 255));
    _mm_storel_ps((double *)a1, v13);
    *(_DWORD *)(a1 + 8) = _mm_movehl_ps(v13, v13).m128_u32[0];
  }
  else
  {
    v3 = _mm_loadl_ps((const double *)a2);
    v4 = _mm_add_ps(
           _mm_add_ps(
             _mm_mul_ps(_mm_shuffle_ps(v3, v3, 0), *(__m128 *)a3),
             _mm_mul_ps(_mm_shuffle_ps(v3, v3, 85), *(__m128 *)(a3 + 16))),
           _mm_add_ps(
             _mm_mul_ps(
               _mm_shuffle_ps((__m128)*(unsigned int *)(a2 + 8), (__m128)*(unsigned int *)(a2 + 8), 0),
               *(__m128 *)(a3 + 32)),
             *(__m128 *)(a3 + 48)));
    v5 = _mm_rcp_ps(v4);
    v6 = _mm_sub_ps(_mm_add_ps(v5, v5), _mm_mul_ps(_mm_mul_ps(v5, v4), v5));
    v7 = _mm_mul_ps(v4, _mm_shuffle_ps(v6, v6, 255));
    _mm_storel_ps((double *)a1, v7);
    *(_DWORD *)(a1 + 8) = _mm_movehl_ps(v7, v7).m128_u32[0];
  }
  return a1;
}

// sub_457350 @ 0x00457350
void __stdcall sub_457350(int a1, int a2)
{
  JUMPOUT(0x457361);
}

// sub_45735E @ 0x0045735E
float *__stdcall sub_45735E(float *a1, float *a2)
{
  float *result; // eax
  float v3; // xmm6_4
  float v4; // xmm5_4
  float v5; // xmm3_4
  float v6; // xmm3_4
  float v7; // xmm0_4

  result = a1;
  v3 = a2[1];
  v4 = a2[2];
  v5 = (float)((float)(*a2 * *a2) + (float)(v3 * v3)) + (float)(v4 * v4);
  if ( *(float *)&dword_4DC000 <= v5 )
  {
    v6 = 1.0 / fsqrt(v5);
    v7 = (float)(*(float *)&dword_4DC004 * v6)
       * (float)(*(float *)&dword_4DC008
               - (float)((float)((float)((float)((float)(*a2 * *a2) + (float)(a2[1] * a2[1])) + (float)(a2[2] * a2[2]))
                               * v6)
                       * v6));
    *a1 = v7 * *a2;
    a1[1] = v7 * v3;
    a1[2] = v7 * v4;
  }
  else
  {
    *a1 = 0.0;
    a1[1] = 0.0;
    a1[2] = 0.0;
  }
  return result;
}

// sub_457420 @ 0x00457420
void __stdcall sub_457420(int a1, int a2)
{
  JUMPOUT(0x457431);
}

// sub_45742E @ 0x0045742E
float *__stdcall sub_45742E(float *a1, float *a2)
{
  float *result; // eax
  float v3; // xmm4_4
  float v4; // xmm6_4
  float v5; // xmm3_4
  float v6; // xmm3_4
  float v7; // xmm0_4

  result = a1;
  v3 = a2[1];
  v4 = a2[2];
  v5 = (float)((float)(*a2 * *a2) + (float)(v3 * v3)) + (float)(v4 * v4);
  if ( *(float *)&dword_4DC00C <= v5 )
  {
    v6 = 1.0 / fsqrt(v5);
    v7 = (float)(*(float *)&dword_4DC010 * v6)
       * (float)(*(float *)&dword_4DC014
               - (float)((float)((float)((float)((float)(*a2 * *a2) + (float)(a2[1] * a2[1])) + (float)(a2[2] * a2[2]))
                               * v6)
                       * v6));
    *a1 = v7 * *a2;
    a1[1] = v7 * v3;
    a1[2] = v7 * v4;
    a1[3] = v7 * a2[3];
  }
  else
  {
    *a1 = 0.0;
    a1[1] = 0.0;
    a1[2] = 0.0;
    a1[3] = 0.0;
  }
  return result;
}

// sub_457500 @ 0x00457500
void __stdcall sub_457500(int a1, int a2, int a3, int a4)
{
  JUMPOUT(0x457511);
}

// sub_45750E @ 0x0045750E
__m128 *__stdcall sub_45750E(__m128 *a1, int a2, int a3, int a4)
{
  __m128 v5; // xmm2
  __m128 v6; // xmm2
  __m128 v7; // xmm1
  __m128 v8; // xmm3
  __m128 v9; // xmm4
  __m128 v10; // xmm0
  __m128 v11; // xmm4
  __m128 v12; // xmm2
  __m128 v13; // xmm3
  __m128 v14; // xmm1

  v5 = _mm_loadh_ps((const double *)(a3 + 8));
  v6 = _mm_shuffle_ps(v5, v5, 57);
  v7 = _mm_loadh_ps((const double *)(a2 + 8));
  v8 = _mm_loadh_ps((const double *)(a4 + 8));
  v9 = _mm_shuffle_ps(v8, v8, 78);
  v10 = _mm_mul_ps(_mm_shuffle_ps(v9, v9, 57), v6);
  v11 = _mm_mul_ps(v9, v6);
  v12 = _mm_mul_ps(v6, v8);
  v13 = _mm_shuffle_ps(v7, v7, 57);
  v14 = _mm_shuffle_ps(v13, v13, 57);
  *a1 = _mm_xor_ps(
          _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(v13, _mm_sub_ps(_mm_shuffle_ps(v11, v11, 57), _mm_shuffle_ps(v12, v12, 78))),
              _mm_mul_ps(_mm_sub_ps(_mm_shuffle_ps(v10, v10, 78), v10), v14)),
            _mm_mul_ps(_mm_shuffle_ps(v14, v14, 57), _mm_sub_ps(v11, _mm_shuffle_ps(v12, v12, 57)))),
          (__m128)xmmword_47A7A0);
  return a1;
}

// sub_4575B0 @ 0x004575B0
float *__stdcall sub_4575B0(float *a1, float *a2)
{
  float v2; // xmm1_4
  float v3; // xmm2_4
  float v4; // xmm3_4
  float v5; // xmm4_4
  float v6; // xmm6_4
  float v7; // xmm5_4

  v2 = a2[1];
  v3 = a2[2];
  v4 = a2[3];
  v5 = (float)((float)(*a2 * *a2) + (float)(v2 * v2)) + (float)((float)(v3 * v3) + (float)(v4 * v4));
  v6 = 1.0 / fsqrt(v5);
  v7 = (float)((float)(*(float *)&dword_47A7C0 - (float)(v5 * (float)(v6 * v6))) * *(float *)&dword_47A7B0) * v6;
  *a1 = *a2 * v7;
  a1[1] = v2 * v7;
  a1[2] = v3 * v7;
  a1[3] = v4 * v7;
  return a1;
}

// sub_457650 @ 0x00457650
int __userpurge sub_457650@<eax>(
        __m128 a1@<xmm1>,
        __m128 a2@<xmm2>,
        int a3,
        const double *a4,
        const double *a5,
        const double *a6,
        const double *a7,
        float a8)
{
  __m128 v8; // xmm0
  __m128 v9; // xmm0
  __m128 v10; // xmm4

  v8 = (__m128)LODWORD(a8);
  a1.m128_f32[0] = v8.m128_f32[0] * v8.m128_f32[0];
  a2.m128_f32[0] = a8 * (float)(v8.m128_f32[0] * v8.m128_f32[0]);
  v9 = _mm_add_ps(
         _mm_add_ps(
           _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v8, v8, 0), (__m128)xmmword_47A800), (__m128)xmmword_47A7E0),
           _mm_mul_ps(_mm_shuffle_ps(a1, a1, 0), (__m128)xmmword_47A7F0)),
         _mm_mul_ps(_mm_shuffle_ps(a2, a2, 0), (__m128)xmmword_47A7D0));
  v10 = _mm_add_ps(
          _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(_mm_loadh_ps(a4), _mm_shuffle_ps(v9, v9, 0)),
              _mm_mul_ps(_mm_loadh_ps(a5), _mm_shuffle_ps(v9, v9, 85))),
            _mm_mul_ps(_mm_loadh_ps(a6), _mm_shuffle_ps(v9, v9, 170))),
          _mm_mul_ps(_mm_loadh_ps(a7), _mm_shuffle_ps(v9, v9, 255)));
  _mm_storeh_ps((double *)a3, v10);
  *(_DWORD *)(a3 + 8) = v10.m128_i32[0];
  return a3;
}

// sub_457710 @ 0x00457710
double *__userpurge sub_457710@<eax>(
        __m128 a1@<xmm1>,
        __m128 a2@<xmm2>,
        double *a3,
        int a4,
        const double *a5,
        int a6,
        const double *a7,
        float a8)
{
  __m128 v8; // xmm0
  __m128 v9; // xmm0
  __m128 v10; // xmm6
  __m128 v11; // xmm4

  v8 = (__m128)LODWORD(a8);
  a1.m128_f32[0] = v8.m128_f32[0] * v8.m128_f32[0];
  a2.m128_f32[0] = a8 * (float)(v8.m128_f32[0] * v8.m128_f32[0]);
  v9 = _mm_add_ps(
         _mm_add_ps(
           _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v8, v8, 0), (__m128)xmmword_47A800), (__m128)xmmword_47A7E0),
           _mm_mul_ps(_mm_shuffle_ps(a1, a1, 0), (__m128)xmmword_47A7F0)),
         _mm_mul_ps(_mm_shuffle_ps(a2, a2, 0), (__m128)xmmword_47A7D0));
  v10 = _mm_mul_ps(_mm_loadh_ps(a7), _mm_shuffle_ps(v9, v9, 250));
  v11 = _mm_add_ps(_mm_mul_ps(_mm_loadh_ps(a5), _mm_shuffle_ps(v9, v9, 80)), v10);
  _mm_storel_ps(a3, _mm_add_ps(v11, _mm_movehl_ps(v10, v11)));
  return a3;
}

// sub_4577A0 @ 0x004577A0
__m128 *__userpurge sub_4577A0@<eax>(
        __m128 a1@<xmm1>,
        __m128 a2@<xmm2>,
        __m128 *a3,
        __m128 *a4,
        __m128 *a5,
        __m128 *a6,
        __m128 *a7,
        float a8)
{
  __m128 v8; // xmm0
  __m128 v9; // xmm0

  v8 = (__m128)LODWORD(a8);
  a1.m128_f32[0] = v8.m128_f32[0] * v8.m128_f32[0];
  a2.m128_f32[0] = a8 * (float)(v8.m128_f32[0] * v8.m128_f32[0]);
  v9 = _mm_add_ps(
         _mm_add_ps(
           _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v8, v8, 0), (__m128)xmmword_47A800), (__m128)xmmword_47A7E0),
           _mm_mul_ps(_mm_shuffle_ps(a1, a1, 0), (__m128)xmmword_47A7F0)),
         _mm_mul_ps(_mm_shuffle_ps(a2, a2, 0), (__m128)xmmword_47A7D0));
  *a3 = _mm_add_ps(
          _mm_add_ps(
            _mm_add_ps(_mm_mul_ps(*a4, _mm_shuffle_ps(v9, v9, 0)), _mm_mul_ps(*a5, _mm_shuffle_ps(v9, v9, 85))),
            _mm_mul_ps(*a6, _mm_shuffle_ps(v9, v9, 170))),
          _mm_mul_ps(*a7, _mm_shuffle_ps(v9, v9, 255)));
  return a3;
}

// sub_457850 @ 0x00457850
int __userpurge sub_457850@<eax>(
        __m128 a1@<xmm1>,
        __m128 a2@<xmm2>,
        int a3,
        const double *a4,
        const double *a5,
        const double *a6,
        const double *a7,
        float a8)
{
  __m128 v8; // xmm0
  __m128 v9; // xmm0
  __m128 v10; // xmm0
  __m128 v11; // xmm4

  v8 = (__m128)LODWORD(a8);
  a1.m128_f32[0] = v8.m128_f32[0] * v8.m128_f32[0];
  a2.m128_f32[0] = a8 * (float)(v8.m128_f32[0] * v8.m128_f32[0]);
  v9 = _mm_mul_ps(_mm_shuffle_ps(v8, v8, 0), (__m128)xmmword_47A840);
  v9.m128_f32[0] = v9.m128_f32[0] + *(float *)&dword_47A820;
  v10 = _mm_add_ps(
          _mm_add_ps(v9, _mm_mul_ps(_mm_shuffle_ps(a1, a1, 0), (__m128)xmmword_47A830)),
          _mm_mul_ps(_mm_shuffle_ps(a2, a2, 0), (__m128)xmmword_47A810));
  v11 = _mm_add_ps(
          _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(_mm_loadh_ps(a4), _mm_shuffle_ps(v10, v10, 0)),
              _mm_mul_ps(_mm_loadh_ps(a5), _mm_shuffle_ps(v10, v10, 85))),
            _mm_mul_ps(_mm_loadh_ps(a6), _mm_shuffle_ps(v10, v10, 170))),
          _mm_mul_ps(_mm_loadh_ps(a7), _mm_shuffle_ps(v10, v10, 255)));
  _mm_storeh_ps((double *)a3, v11);
  *(_DWORD *)(a3 + 8) = v11.m128_i32[0];
  return a3;
}

// sub_457910 @ 0x00457910
__m128 *__userpurge sub_457910@<eax>(
        __m128 a1@<xmm1>,
        __m128 a2@<xmm2>,
        __m128 *a3,
        __m128 *a4,
        __m128 *a5,
        __m128 *a6,
        __m128 *a7,
        float a8)
{
  __m128 v8; // xmm0
  __m128 v9; // xmm0
  __m128 v10; // xmm0

  v8 = (__m128)LODWORD(a8);
  a1.m128_f32[0] = v8.m128_f32[0] * v8.m128_f32[0];
  a2.m128_f32[0] = a8 * (float)(v8.m128_f32[0] * v8.m128_f32[0]);
  v9 = _mm_mul_ps(_mm_shuffle_ps(v8, v8, 0), (__m128)xmmword_47A840);
  v9.m128_f32[0] = v9.m128_f32[0] + *(float *)&dword_47A820;
  v10 = _mm_add_ps(
          _mm_add_ps(v9, _mm_mul_ps(_mm_shuffle_ps(a1, a1, 0), (__m128)xmmword_47A830)),
          _mm_mul_ps(_mm_shuffle_ps(a2, a2, 0), (__m128)xmmword_47A810));
  *a3 = _mm_add_ps(
          _mm_add_ps(
            _mm_add_ps(_mm_mul_ps(*a4, _mm_shuffle_ps(v10, v10, 0)), _mm_mul_ps(*a5, _mm_shuffle_ps(v10, v10, 85))),
            _mm_mul_ps(*a6, _mm_shuffle_ps(v10, v10, 170))),
          _mm_mul_ps(*a7, _mm_shuffle_ps(v10, v10, 255)));
  return a3;
}

// sub_4579B0 @ 0x004579B0
double *__userpurge sub_4579B0@<eax>(
        __m128 a1@<xmm1>,
        __m128 a2@<xmm2>,
        __m128 a3@<xmm3>,
        double *a4,
        int a5,
        const double *a6,
        int a7,
        const double *a8,
        float a9)
{
  __m128 v9; // xmm0
  __m128 v10; // xmm0
  __m128 v11; // xmm0
  __m128 v12; // xmm4

  v9 = (__m128)LODWORD(a9);
  a1.m128_f32[0] = v9.m128_f32[0] * v9.m128_f32[0];
  a2.m128_f32[0] = a9 * (float)(v9.m128_f32[0] * v9.m128_f32[0]);
  v10 = _mm_mul_ps(_mm_shuffle_ps(v9, v9, 0), (__m128)xmmword_47A840);
  v10.m128_f32[0] = v10.m128_f32[0] + *(float *)&dword_47A820;
  v11 = _mm_add_ps(
          _mm_add_ps(v10, _mm_mul_ps(_mm_shuffle_ps(a1, a1, 0), (__m128)xmmword_47A830)),
          _mm_mul_ps(_mm_shuffle_ps(a2, a2, 0), (__m128)xmmword_47A810));
  v12 = _mm_add_ps(
          _mm_mul_ps(_mm_loadh_ps(a6), _mm_shuffle_ps(v11, v11, 80)),
          _mm_mul_ps(_mm_loadh_ps(a8), _mm_shuffle_ps(v11, v11, 250)));
  _mm_storel_ps(a4, _mm_add_ps(v12, _mm_movehl_ps(a3, v12)));
  return a4;
}

// sub_457A40 @ 0x00457A40
int __stdcall sub_457A40(
        int a1,
        const double *a2,
        const double *a3,
        const double *a4,
        unsigned int a5,
        unsigned int a6)
{
  __m128 v6; // xmm2
  __m128 v7; // xmm3

  v6 = _mm_loadh_ps(a2);
  v7 = _mm_add_ps(
         _mm_add_ps(_mm_mul_ps(_mm_sub_ps(_mm_loadh_ps(a3), v6), _mm_shuffle_ps((__m128)a5, (__m128)a5, 0)), v6),
         _mm_mul_ps(_mm_sub_ps(_mm_loadh_ps(a4), v6), _mm_shuffle_ps((__m128)a6, (__m128)a6, 0)));
  *(_DWORD *)(a1 + 8) = v7.m128_i32[0];
  _mm_storeh_ps((double *)a1, v7);
  return a1;
}

// sub_457AA0 @ 0x00457AA0
__m128 *__stdcall sub_457AA0(__m128 *a1, __m128 *a2, __m128 *a3, __m128 *a4, unsigned int a5, unsigned int a6)
{
  *a1 = _mm_add_ps(
          _mm_add_ps(_mm_mul_ps(_mm_sub_ps(*a3, *a2), _mm_shuffle_ps((__m128)a5, (__m128)a5, 0)), *a2),
          _mm_mul_ps(_mm_sub_ps(*a4, *a2), _mm_shuffle_ps((__m128)a6, (__m128)a6, 0)));
  return a1;
}

// sub_457AF0 @ 0x00457AF0
double *__stdcall sub_457AF0(
        double *a1,
        const double *a2,
        const double *a3,
        const double *a4,
        unsigned int a5,
        unsigned int a6)
{
  __m128 v6; // xmm2

  v6 = _mm_loadh_ps(a2);
  _mm_storeh_ps(
    a1,
    _mm_add_ps(
      _mm_add_ps(_mm_mul_ps(_mm_sub_ps(_mm_loadh_ps(a3), v6), _mm_shuffle_ps((__m128)a5, (__m128)a5, 0)), v6),
      _mm_mul_ps(_mm_sub_ps(_mm_loadh_ps(a4), v6), _mm_shuffle_ps((__m128)a6, (__m128)a6, 0))));
  return a1;
}

// sub_457B50 @ 0x00457B50
int __userpurge sub_457B50@<eax>(
        __m128 a1@<xmm5>,
        __m128 a2@<xmm6>,
        int a3,
        __m128 *a4,
        const double *a5,
        const double *a6)
{
  __m128 v6; // xmm1
  __m128 v7; // xmm4
  __m128 v8; // xmm0
  __m128 v9; // xmm2
  __m128 v10; // xmm3
  __m128 v11; // xmm0
  __m128 v12; // xmm5
  __m128 v13; // xmm6
  __m128 v14; // xmm0
  float v15; // xmm5_4
  __m128 v16; // xmm3
  __m128 v17; // xmm1
  int v19; // [esp+0h] [ebp-4h]

  v19 = a3;
  v6 = _mm_loadh_ps(a5);
  v7 = *a4;
  v8 = _mm_shuffle_ps(v7, v7, 78);
  v9 = _mm_loadh_ps(a6);
  v10 = _mm_mul_ps(v6, v8);
  v11 = _mm_mul_ps(v8, v9);
  v12 = _mm_movehl_ps(a1, v10);
  v13 = _mm_movehl_ps(a2, v11);
  v16 = _mm_add_ps(v10, v12);
  v14 = _mm_add_ps(v11, v13);
  v16.m128_f32[0] = v16.m128_f32[0] + _mm_shuffle_ps(v12, v16, 85).m128_f32[0];
  v15 = v16.m128_f32[0] - (float)(v14.m128_f32[0] + _mm_shuffle_ps(v13, v14, 85).m128_f32[0]);
  v16.m128_f32[0] = v16.m128_f32[0] + _mm_shuffle_ps(v7, v7, 255).m128_f32[0];
  if ( v15 == *(float *)&dword_4D9940 )
    return 0;
  v16.m128_f32[0] = v16.m128_f32[0]
                  * (float)((float)((float)(1.0 / v15) + (float)(1.0 / v15))
                          - (float)((float)(v15 * (float)(1.0 / v15)) * (float)(1.0 / v15)));
  v17 = _mm_add_ps(v6, _mm_mul_ps(_mm_shuffle_ps(v16, v16, 0), _mm_sub_ps(v9, v6)));
  _mm_storeh_ps((double *)a3, v17);
  *(_DWORD *)(a3 + 8) = v17.m128_i32[0];
  return v19;
}

// sub_457C10 @ 0x00457C10
void __stdcall sub_457C10(int a1, int a2, int a3, int a4)
{
  JUMPOUT(0x457C21);
}

// sub_457C1E @ 0x00457C1E
__m128 *__stdcall sub_457C1E(__m128 *a1, const double *a2, const double *a3, const double *a4)
{
  __m128 v5; // xmm3
  __m128 v6; // xmm1
  __m128 v7; // xmm0
  __m128 v8; // xmm4
  __m128 v9; // xmm5
  __m128 v10; // xmm3
  __m128 v11; // xmm5
  __m128 v12; // xmm1
  __m128 v13; // xmm3
  __m128 v14; // xmm5
  __m128 v15; // xmm0
  __m128 v16; // xmm5
  __m128 v17; // xmm3
  __m128 v18; // xmm0

  v5 = _mm_loadh_ps(a2);
  v6 = _mm_sub_ps(v5, _mm_loadh_ps(a4));
  v7 = _mm_shuffle_ps(v6, v6, 120);
  v8 = v5;
  v9 = _mm_sub_ps(v5, _mm_loadh_ps(a3));
  v10 = _mm_shuffle_ps(v9, v9, 99);
  v11 = _mm_mul_ps(_mm_shuffle_ps(v9, v9, 120), _mm_shuffle_ps(v6, v6, 99));
  v12 = (__m128)xmmword_47A870;
  v13 = _mm_sub_ps(_mm_mul_ps(v7, v10), v11);
  v14 = _mm_mul_ps(v13, v13);
  v15 = _mm_add_ps(v14, _mm_movehl_ps(v14, v14));
  v15.m128_f32[0] = v15.m128_f32[0] + _mm_shuffle_ps(v15, v15, 1).m128_f32[0];
  v16 = v15;
  v15.m128_f32[0] = fsqrt(v15.m128_f32[0]);
  v12.m128_f32[0] = (float)(*(float *)&xmmword_47A870 * (float)(1.0 / v15.m128_f32[0]))
                  * (float)(*(float *)&xmmword_47A860
                          - (float)((float)(v16.m128_f32[0] * (float)(1.0 / v15.m128_f32[0]))
                                  * (float)(1.0 / v15.m128_f32[0])));
  v17 = _mm_mul_ps(v13, _mm_shuffle_ps(v12, v12, 0));
  *a1 = v17;
  v18 = _mm_mul_ps(_mm_shuffle_ps(v8, v8, 14), v17);
  a1->m128_i32[3] = COERCE_UNSIGNED_INT(
                      v18.m128_f32[0]
                    + (float)(_mm_movehl_ps(v16, v18).m128_f32[0] + _mm_shuffle_ps(v18, v18, 85).m128_f32[0]))
                  ^ xmmword_47A850;
  return a1;
}

// sub_457D00 @ 0x00457D00
void __stdcall sub_457D00(int a1, int a2, int a3)
{
  JUMPOUT(0x457D11);
}

// sub_457D0E @ 0x00457D0E
double *__stdcall sub_457D0E(double *a1, __m128 *a2, __m128 *a3)
{
  __m128 v3; // xmm2
  __m128 v4; // xmm3
  __m128 v5; // xmm3
  __m128 v6; // xmm1
  __m128 v7; // xmm0
  CHAR v8; // al
  __m128 v9; // xmm4
  float v10; // xmm3_4
  float v11; // xmm5_4
  double *result; // eax
  __m128 v13; // xmm4
  __m128 v14; // xmm0
  __m128 v15; // xmm0
  __m128 v16; // xmm0
  __m128 v17; // xmm5
  __m128 v18; // xmm6
  float v19; // xmm7_4
  __m128 v20; // xmm0
  __m128 v21; // xmm1
  __m128 v22; // xmm2
  __m128 v23; // xmm3

  v3 = *a3;
  v4 = _mm_and_ps((__m128)xmmword_47A8C0, *a3);
  v5 = _mm_mul_ps(v4, v4);
  v6 = _mm_add_ps(v5, _mm_movehl_ps((__m128)0LL, v5));
  v7 = _mm_shuffle_ps(v6, v6, 1);
  v7.m128_f32[0] = v7.m128_f32[0] + v6.m128_f32[0];
  if ( v7.m128_f32[0] != 0.0 )
  {
    v8 = String[96];
    if ( (String[96] & 1) != 0 )
    {
      v9 = *(__m128 *)&String[64];
    }
    else
    {
      v8 = String[96] | 1;
      v9 = (__m128)(unsigned int)dword_4DC0C0;
      String[96] |= 1u;
      *(_OWORD *)&String[64] = (unsigned int)dword_4DC0C0;
    }
    if ( (v8 & 2) != 0 )
    {
      v10 = *(float *)&String[80];
    }
    else
    {
      v10 = *(float *)&dword_4DC0C4;
      String[96] = v8 | 2;
      *(_OWORD *)&String[80] = (unsigned int)dword_4DC0C4;
    }
    v11 = 1.0 / fsqrt(v7.m128_f32[0]);
    v9.m128_f32[0] = (float)(v9.m128_f32[0] * v11) * (float)(v10 - (float)((float)(v7.m128_f32[0] * v11) * v11));
    v7 = _mm_mul_ps(v3, _mm_shuffle_ps(v9, v9, 0));
  }
  result = a1;
  v13 = _mm_xor_ps((__m128)xmmword_47A880, v7);
  v14 = _mm_mul_ps(v7, *a2);
  v15 = _mm_add_ps(v14, _mm_movehl_ps(v6, v14));
  v15.m128_f32[0] = v15.m128_f32[0] + _mm_shuffle_ps(v15, v15, 1).m128_f32[0];
  v16 = _mm_shuffle_ps(v15, v15, 0);
  v17 = _mm_and_ps((__m128)xmmword_47A8A0, v16);
  v18 = _mm_and_ps((__m128)xmmword_47A8B0, v16);
  v19 = v16.m128_f32[0];
  v20 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v13, v13, 85), *a2), _mm_and_ps((__m128)xmmword_47A890, v16));
  v21 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v13, v13, 170), *a2), v17);
  v23 = _mm_mul_ps(_mm_shuffle_ps(v13, v13, 0), *a2);
  v22 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v13, v13, 255), *a2), v18);
  v23.m128_f32[0] = v23.m128_f32[0] + v19;
  if ( ((unsigned __int8)a1 & 0xF) != 0 )
  {
    _mm_storel_ps(a1, v23);
    _mm_storeh_ps(a1 + 1, v23);
    _mm_storel_ps(a1 + 2, v20);
    _mm_storeh_ps(a1 + 3, v20);
    _mm_storel_ps(a1 + 4, v21);
    _mm_storeh_ps(a1 + 5, v21);
    _mm_storel_ps(a1 + 6, v22);
    _mm_storeh_ps(a1 + 7, v22);
  }
  else
  {
    *(__m128 *)a1 = v23;
    *((__m128 *)a1 + 1) = v20;
    *((__m128 *)a1 + 2) = v21;
    *((__m128 *)a1 + 3) = v22;
  }
  return result;
}

// sub_457E90 @ 0x00457E90
void __stdcall sub_457E90(int a1, int a2)
{
  JUMPOUT(0x457EA1);
}

// sub_457E9E @ 0x00457E9E
__m128 *__stdcall sub_457E9E(__m128 *a1, const double *a2)
{
  __m128 v3; // xmm1
  __m128 v4; // xmm0
  __m128 v5; // xmm3
  __m128 v6; // xmm4
  __m128 v7; // xmm0
  float v8; // xmm5_4
  __m128 v9; // xmm1
  __m128 v10; // xmm4
  __m128 v11; // xmm0
  __m128 v12; // xmm1
  __m128 v13; // xmm2
  __m128 v14; // xmm0
  __m128 v15; // xmm3
  __m128 v16; // xmm2
  __m128 v17; // xmm4

  v3 = _mm_loadl_ps(a2);
  v4 = _mm_and_ps((__m128)xmmword_47A940, v3);
  v5 = (__m128)(unsigned int)dword_47A930;
  v6 = _mm_mul_ps(v4, v4);
  v7 = _mm_add_ps(v6, _mm_movehl_ps(v6, v6));
  v8 = v7.m128_f32[0] + _mm_shuffle_ps(v7, v7, 1).m128_f32[0];
  v7.m128_f32[0] = 1.0 / fsqrt(v8);
  v5.m128_f32[0] = (float)(*(float *)&dword_47A930 * v7.m128_f32[0])
                 * (float)(*(float *)&dword_47A920 - (float)((float)(v8 * v7.m128_f32[0]) * v7.m128_f32[0]));
  v9 = _mm_mul_ps(v3, _mm_shuffle_ps(v5, v5, 0));
  v10 = _mm_mul_ps((__m128)xmmword_47A910, v9);
  v11 = v9;
  v12 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v9, v9, 0), v10), (__m128)xmmword_47A900);
  v13 = v11;
  v14 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v11, v11, 255), v10), (__m128)xmmword_47A8D0);
  v15 = v13;
  v16 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v13, v13, 170), v10), (__m128)xmmword_47A8E0);
  v17 = _mm_add_ps(_mm_mul_ps(v10, _mm_shuffle_ps(v15, v15, 85)), (__m128)xmmword_47A8F0);
  *a1 = v12;
  a1[1] = v17;
  a1[2] = v16;
  a1[3] = v14;
  return a1;
}

// sub_457F70 @ 0x00457F70
double *__stdcall sub_457F70(double *a1, int a2, int a3)
{
  __m128 v3; // xmm0
  __m128 v4; // xmm2
  __m128 v5; // xmm1
  __m128 v6; // xmm0
  __m128 v7; // xmm1
  __m128 v8; // xmm0
  __m128 v9; // xmm1

  v3 = _mm_loadh_ps((const double *)(a2 + 8));
  v4 = _mm_loadh_ps((const double *)(a3 + 8));
  v5 = _mm_mul_ps(_mm_shuffle_ps(v4, v4, 255), v3);
  v6 = _mm_shuffle_ps(v3, v3, 27);
  v7 = _mm_add_ps(v5, _mm_mul_ps(_mm_xor_ps(_mm_shuffle_ps(v4, v4, 0), (__m128)xmmword_4DC100), v6));
  v8 = _mm_shuffle_ps(v6, v6, 177);
  v9 = _mm_add_ps(
         _mm_add_ps(v7, _mm_mul_ps(_mm_xor_ps(_mm_shuffle_ps(v4, v4, 85), (__m128)xmmword_4DC0F0), v8)),
         _mm_mul_ps(_mm_xor_ps(_mm_shuffle_ps(v4, v4, 170), (__m128)xmmword_4DC0E0), _mm_shuffle_ps(v8, v8, 27)));
  _mm_storel_ps(a1, v9);
  _mm_storeh_ps(a1 + 1, v9);
  return a1;
}

// sub_458000 @ 0x00458000
float *__stdcall sub_458000(float *a1, float *a2)
{
  float v2; // xmm1_4
  float v3; // xmm2_4
  float v4; // xmm3_4
  float v5; // xmm4_4
  float v6; // xmm6_4
  float v7; // xmm5_4

  v2 = a2[1];
  v3 = a2[2];
  v4 = a2[3];
  v5 = (float)((float)(*a2 * *a2) + (float)(v2 * v2)) + (float)((float)(v3 * v3) + (float)(v4 * v4));
  v6 = 1.0 / fsqrt(v5);
  v7 = (float)((float)(*(float *)&dword_47A970 - (float)(v5 * (float)(v6 * v6))) * *(float *)&dword_47A960) * v6;
  *a1 = *a2 * v7;
  a1[1] = v2 * v7;
  a1[2] = v3 * v7;
  a1[3] = v4 * v7;
  return a1;
}

// sub_4580A0 @ 0x004580A0
void __stdcall sub_4580A0(int a1, int a2)
{
  JUMPOUT(0x4580B1);
}

// sub_4580AE @ 0x004580AE
__m128 *__stdcall sub_4580AE(__m128 *a1, int a2)
{
  __m128 v3; // xmm1
  __m128 v4; // xmm2
  __m128 v5; // xmm0
  __m128 v6; // xmm3

  v3 = _mm_loadh_ps((const double *)(a2 + 8));
  v4 = _mm_mul_ps(v3, v3);
  v5 = _mm_add_ps(v4, _mm_movehl_ps(v4, v4));
  v4.m128_f32[0] = v5.m128_f32[0] + _mm_shuffle_ps(v5, v5, 85).m128_f32[0];
  v5.m128_f32[0] = 1.0 / v4.m128_f32[0];
  v6 = v5;
  v6.m128_f32[0] = (float)(v6.m128_f32[0] + v6.m128_f32[0])
                 - (float)((float)(v5.m128_f32[0] * v4.m128_f32[0]) * v5.m128_f32[0]);
  *a1 = _mm_mul_ps(_mm_mul_ps(v3, (__m128)xmmword_47A980), _mm_shuffle_ps(v6, v6, 0));
  return a1;
}

// sub_458110 @ 0x00458110
float *__stdcall sub_458110(float *a1, float *a2)
{
  float *result; // eax
  double v3; // st7
  float v4; // edi
  float v5; // esi
  int v6; // ebp
  double v7; // st7
  int v8; // ecx
  int v9; // ebx
  int v10; // ebp
  float *v11; // esi
  long double v12; // st6
  long double v13; // st7
  float *v14; // ecx
  long double v15; // st6
  long double v16; // st7
  _DWORD v17[7]; // [esp+0h] [ebp-1Ch]

  result = a1;
  v3 = *a2 + a2[5] + a2[10];
  v4 = *a2;
  v5 = a2[5];
  v6 = *((_DWORD *)a2 + 10);
  if ( flt_4DC11C < v3 )
  {
    v15 = sqrt(v3 + flt_4DC120) * flt_4DC124;
    v16 = flt_4DC128 / v15;
    a1[3] = v15;
    *a1 = (a2[6] - a2[9]) * v16;
    a1[1] = (a2[8] - a2[2]) * v16;
    a1[2] = v16 * (a2[1] - a2[4]);
  }
  else
  {
    v7 = a2[10];
    *(float *)v17 = *a2;
    *(float *)&v17[1] = v5;
    v17[2] = v6;
    v8 = 2;
    if ( *(float *)&v17[v5 > (double)v4] >= v7 )
      v8 = v5 > (double)v4;
    v9 = dword_4DC110[v8];
    v10 = dword_4DC110[v9];
    v11 = &a2[v8];
    v12 = sqrt(flt_4DC130 + *(float *)&v17[v8] - *(float *)&v17[v9] - *(float *)&v17[v10]) * flt_4DC134;
    v13 = flt_4DC138 / v12;
    a1[v8] = v12;
    v14 = &a2[4 * v8];
    a1[v9] = (v14[v9] + v11[4 * v9]) * v13;
    a1[v10] = (v11[4 * v10] + v14[v10]) * v13;
    a1[3] = v13 * (a2[4 * v9 + v10] - a2[4 * v10 + v9]);
  }
  return result;
}

// sub_458230 @ 0x00458230
void __stdcall sub_458230(int a1, int a2, int a3, int a4)
{
  JUMPOUT(0x458241);
}

// sub_45823E @ 0x0045823E
__m128 *__stdcall sub_45823E(__m128 *a1, unsigned int a2, unsigned int a3, unsigned int a4)
{
  __m128 v4; // xmm0
  __m128 v5; // xmm1
  __m128 v6; // xmm3
  __m128 v7; // xmm2
  __m128 v8; // xmm3
  __m128 v10; // [esp+10h] [ebp-4Ch] BYREF
  __m128 v11[3]; // [esp+20h] [ebp-3Ch] BYREF

  v10 = _mm_mul_ps(
          _mm_shuffle_ps(
            _mm_unpacklo_ps((__m128)a3, (__m128)a4),
            _mm_unpacklo_ps((__m128)(unsigned int)dword_4DC160, (__m128)a2),
            17),
          (__m128)xmmword_4DC150);
  sub_45FBD0(&v10, &v10, v11);
  v4 = _mm_shuffle_ps(v10, v11[0], 0);
  v5 = _mm_shuffle_ps(v4, v4, 138);
  v6 = _mm_shuffle_ps(v10, v11[0], 153);
  v7 = _mm_shuffle_ps(v6, v6, 247);
  v8 = _mm_shuffle_ps(v6, v6, 168);
  v10 = _mm_add_ps(
          _mm_mul_ps(_mm_mul_ps(v5, v7), v8),
          _mm_xor_ps(
            _mm_mul_ps(_mm_mul_ps(_mm_shuffle_ps(v5, v5, 138), _mm_shuffle_ps(v7, v7, 81)), _mm_shuffle_ps(v8, v8, 1)),
            (__m128)xmmword_4DC140));
  *a1 = v10;
  return a1;
}

// sub_458300 @ 0x00458300
void __stdcall sub_458300(int a1, int a2, int a3)
{
  JUMPOUT(0x458311);
}

// sub_45830E @ 0x0045830E
int __stdcall sub_45830E(int a1, int a2, int a3)
{
  __m128 v3; // xmm2
  __m128 v4; // xmm0
  __m128 v6; // xmm5
  __m128 v7; // xmm3

  if ( (a3 & 0xF) != 0 )
  {
    v6 = _mm_loadl_ps((const double *)a2);
    v7 = _mm_add_ps(
           _mm_add_ps(
             _mm_mul_ps(_mm_loadh_ps((const double *)(a3 + 8)), _mm_shuffle_ps(v6, v6, 0)),
             _mm_mul_ps(_mm_loadh_ps((const double *)(a3 + 24)), _mm_shuffle_ps(v6, v6, 85))),
           _mm_mul_ps(
             _mm_loadh_ps((const double *)(a3 + 40)),
             _mm_shuffle_ps((__m128)*(unsigned int *)(a2 + 8), (__m128)*(unsigned int *)(a2 + 8), 0)));
    _mm_storel_ps((double *)a1, v7);
    *(_DWORD *)(a1 + 8) = _mm_movehl_ps(v7, v7).m128_u32[0];
  }
  else
  {
    v3 = _mm_loadl_ps((const double *)a2);
    v4 = _mm_add_ps(
           _mm_add_ps(
             _mm_mul_ps(_mm_shuffle_ps(v3, v3, 0), *(__m128 *)a3),
             _mm_mul_ps(_mm_shuffle_ps(v3, v3, 85), *(__m128 *)(a3 + 16))),
           _mm_mul_ps(
             _mm_shuffle_ps((__m128)*(unsigned int *)(a2 + 8), (__m128)*(unsigned int *)(a2 + 8), 0),
             *(__m128 *)(a3 + 32)));
    _mm_storel_ps((double *)a1, v4);
    *(_DWORD *)(a1 + 8) = _mm_movehl_ps(v4, v4).m128_u32[0];
  }
  return a1;
}

// sub_4583C0 @ 0x004583C0
void __stdcall sub_4583C0(int a1, int a2, int a3)
{
  JUMPOUT(0x4583D1);
}

// sub_4583CE @ 0x004583CE
__m128 *__stdcall sub_4583CE(__m128 *a1, int a2, int a3)
{
  __m128 v3; // xmm2
  __m128 v5; // xmm6

  if ( (a3 & 0xF) != 0 )
  {
    v5 = _mm_loadl_ps((const double *)a2);
    *a1 = _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(_mm_loadh_ps((const double *)(a3 + 8)), _mm_shuffle_ps(v5, v5, 0)),
              _mm_mul_ps(_mm_loadh_ps((const double *)(a3 + 24)), _mm_shuffle_ps(v5, v5, 85))),
            _mm_add_ps(
              _mm_mul_ps(
                _mm_loadh_ps((const double *)(a3 + 40)),
                _mm_shuffle_ps((__m128)*(unsigned int *)(a2 + 8), (__m128)*(unsigned int *)(a2 + 8), 0)),
              _mm_loadh_ps((const double *)(a3 + 56))));
  }
  else
  {
    v3 = _mm_loadl_ps((const double *)a2);
    *a1 = _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(_mm_shuffle_ps(v3, v3, 0), *(__m128 *)a3),
              _mm_mul_ps(_mm_shuffle_ps(v3, v3, 85), *(__m128 *)(a3 + 16))),
            _mm_add_ps(
              _mm_mul_ps(
                _mm_shuffle_ps((__m128)*(unsigned int *)(a2 + 8), (__m128)*(unsigned int *)(a2 + 8), 0),
                *(__m128 *)(a3 + 32)),
              *(__m128 *)(a3 + 48)));
  }
  return a1;
}

// sub_458480 @ 0x00458480
void __stdcall sub_458480(int a1, int a2, int a3)
{
  JUMPOUT(0x458491);
}

// sub_45848E @ 0x0045848E
__m128 *__stdcall sub_45848E(__m128 *a1, __m128 *a2, int a3)
{
  if ( (a3 & 0xF) != 0 )
    *a1 = _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(_mm_loadh_ps((const double *)(a3 + 8)), _mm_shuffle_ps(*a2, *a2, 0)),
              _mm_mul_ps(_mm_loadh_ps((const double *)(a3 + 24)), _mm_shuffle_ps(*a2, *a2, 85))),
            _mm_add_ps(
              _mm_mul_ps(_mm_loadh_ps((const double *)(a3 + 40)), _mm_shuffle_ps(*a2, *a2, 170)),
              _mm_mul_ps(_mm_loadh_ps((const double *)(a3 + 56)), _mm_shuffle_ps(*a2, *a2, 255))));
  else
    *a1 = _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(_mm_shuffle_ps(*a2, *a2, 0), *(__m128 *)a3),
              _mm_mul_ps(_mm_shuffle_ps(*a2, *a2, 85), *(__m128 *)(a3 + 16))),
            _mm_add_ps(
              _mm_mul_ps(_mm_shuffle_ps(*a2, *a2, 170), *(__m128 *)(a3 + 32)),
              _mm_mul_ps(_mm_shuffle_ps(*a2, *a2, 255), *(__m128 *)(a3 + 48))));
  return a1;
}

// sub_458540 @ 0x00458540
void __stdcall sub_458540(int a1, int a2, int a3)
{
  JUMPOUT(0x458551);
}

// sub_45854E @ 0x0045854E
double *__stdcall sub_45854E(double *a1, unsigned int *a2, const double *a3)
{
  __m128 v5; // xmm3
  __m128 v6; // xmm2
  __m128 v7; // xmm1
  __m128 v8; // xmm0
  __m128 v9; // xmm4
  __m128 v10; // xmm5
  __m128 v11; // xmm6
  __m128 v12; // xmm7
  __m128 v13; // xmm2
  __m128 v14; // xmm1
  __m128 v15; // xmm7

  v5 = _mm_loadh_ps(a3 + 1);
  v6 = _mm_loadh_ps(a3 + 3);
  v7 = _mm_loadh_ps(a3 + 5);
  v8 = _mm_loadh_ps(a3 + 7);
  v9 = _mm_add_ps(
         _mm_add_ps(
           _mm_add_ps(
             _mm_mul_ps(_mm_shuffle_ps((__m128)*a2, (__m128)*a2, 0), v5),
             _mm_mul_ps(_mm_shuffle_ps((__m128)a2[1], (__m128)a2[1], 0), v6)),
           _mm_mul_ps(_mm_shuffle_ps((__m128)a2[2], (__m128)a2[2], 0), v7)),
         _mm_mul_ps(_mm_shuffle_ps((__m128)a2[3], (__m128)a2[3], 0), v8));
  v10 = _mm_add_ps(
          _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(_mm_shuffle_ps((__m128)a2[4], (__m128)a2[4], 0), v5),
              _mm_mul_ps(_mm_shuffle_ps((__m128)a2[5], (__m128)a2[5], 0), v6)),
            _mm_mul_ps(_mm_shuffle_ps((__m128)a2[6], (__m128)a2[6], 0), v7)),
          _mm_mul_ps(_mm_shuffle_ps((__m128)a2[7], (__m128)a2[7], 0), v8));
  v11 = _mm_add_ps(
          _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(_mm_shuffle_ps((__m128)a2[8], (__m128)a2[8], 0), v5),
              _mm_mul_ps(_mm_shuffle_ps((__m128)a2[9], (__m128)a2[9], 0), v6)),
            _mm_mul_ps(_mm_shuffle_ps((__m128)a2[10], (__m128)a2[10], 0), v7)),
          _mm_mul_ps(_mm_shuffle_ps((__m128)a2[11], (__m128)a2[11], 0), v8));
  v12 = _mm_add_ps(
          _mm_mul_ps(_mm_shuffle_ps((__m128)a2[12], (__m128)a2[12], 0), v5),
          _mm_mul_ps(_mm_shuffle_ps((__m128)a2[13], (__m128)a2[13], 0), v6));
  v13 = _mm_mul_ps(_mm_shuffle_ps((__m128)a2[14], (__m128)a2[14], 0), v7);
  v14 = (__m128)a2[15];
  _mm_storel_ps(a1, v9);
  _mm_storeh_ps(a1 + 1, v9);
  _mm_storel_ps(a1 + 2, v10);
  _mm_storeh_ps(a1 + 3, v10);
  _mm_storel_ps(a1 + 4, v11);
  _mm_storeh_ps(a1 + 5, v11);
  v15 = _mm_add_ps(_mm_add_ps(v12, v13), _mm_mul_ps(_mm_shuffle_ps(v14, v14, 0), v8));
  _mm_storel_ps(a1 + 6, v15);
  _mm_storeh_ps(a1 + 7, v15);
  return a1;
}

// sub_458690 @ 0x00458690
void __stdcall sub_458690(int a1, int a2)
{
  JUMPOUT(0x4586A1);
}

// sub_45869E @ 0x0045869E
float *__stdcall sub_45869E(float *a1, float *a2)
{
  float *result; // eax
  float v3; // xmm6_4
  float v4; // xmm5_4
  float v5; // xmm3_4
  float v6; // xmm3_4
  float v7; // xmm0_4

  result = a1;
  v3 = a2[1];
  v4 = a2[2];
  v5 = (float)((float)(*a2 * *a2) + (float)(v3 * v3)) + (float)(v4 * v4);
  if ( *(float *)&dword_4DC180 <= v5 )
  {
    v6 = 1.0 / fsqrt(v5);
    v7 = (float)(*(float *)&dword_4DC184 * v6)
       * (float)(*(float *)&dword_4DC188
               - (float)((float)((float)((float)((float)(*a2 * *a2) + (float)(a2[1] * a2[1])) + (float)(a2[2] * a2[2]))
                               * v6)
                       * v6));
    *a1 = v7 * *a2;
    a1[1] = v7 * v3;
    a1[2] = v7 * v4;
  }
  else
  {
    *a1 = 0.0;
    a1[1] = 0.0;
    a1[2] = 0.0;
  }
  return result;
}

// sub_458760 @ 0x00458760
void __stdcall sub_458760(int a1, int a2)
{
  JUMPOUT(0x458771);
}

// sub_45876E @ 0x0045876E
float *__stdcall sub_45876E(float *a1, float *a2)
{
  float *result; // eax
  float v3; // xmm4_4
  float v4; // xmm6_4
  float v5; // xmm3_4
  float v6; // xmm3_4
  float v7; // xmm0_4

  result = a1;
  v3 = a2[1];
  v4 = a2[2];
  v5 = (float)((float)(*a2 * *a2) + (float)(v3 * v3)) + (float)(v4 * v4);
  if ( *(float *)&dword_4DC18C <= v5 )
  {
    v6 = 1.0 / fsqrt(v5);
    v7 = (float)(*(float *)&dword_4DC190 * v6)
       * (float)(*(float *)&dword_4DC194
               - (float)((float)((float)((float)((float)(*a2 * *a2) + (float)(a2[1] * a2[1])) + (float)(a2[2] * a2[2]))
                               * v6)
                       * v6));
    *a1 = v7 * *a2;
    a1[1] = v7 * v3;
    a1[2] = v7 * v4;
    a1[3] = v7 * a2[3];
  }
  else
  {
    *a1 = 0.0;
    a1[1] = 0.0;
    a1[2] = 0.0;
    a1[3] = 0.0;
  }
  return result;
}

// sub_458840 @ 0x00458840
void __stdcall sub_458840(int a1, int a2, int a3)
{
  JUMPOUT(0x458851);
}

// sub_45884E @ 0x0045884E
double *__stdcall sub_45884E(double *a1, _DWORD *a2, const double *a3)
{
  __m128 v3; // xmm4
  __m128 v4; // xmm1
  __m128 v5; // xmm5
  __m128 v6; // xmm0
  __m128 v7; // xmm4
  __m128 v8; // xmm5
  __m128 v9; // xmm6
  __m128 v10; // xmm5
  __m128 v11; // xmm7
  __m128 v12; // xmm3
  __m128 v13; // xmm1
  __m128 v14; // xmm7
  __m128 v15; // xmm3
  __m128 v16; // xmm5
  __m128 v17; // xmm5
  __m128 v18; // xmm6
  __m128 v19; // xmm3
  __m128 v20; // xmm5
  __m128 v21; // xmm6
  __m128 v22; // xmm3
  __m128 v23; // xmm7
  __m128 v24; // xmm7
  __m128 v25; // xmm5
  __m128 v26; // xmm0
  __m128 v27; // xmm6
  __m128 v28; // xmm7
  __m128 v29; // xmm4
  __m128 v30; // xmm0
  __m128 v31; // xmm7
  __m128 v32; // xmm5
  __m128 v33; // xmm6
  __m128 v34; // xmm1
  __m128 v35; // xmm1
  __m128 v36; // xmm0
  __m128 v37; // xmm5
  __m128 v38; // xmm6
  __m128 v39; // xmm3
  __m128 v40; // xmm3
  __m128 v41; // xmm5
  __m128 v42; // xmm7
  __m128 v43; // xmm3
  __m128 v44; // xmm6
  __m128 v45; // xmm4
  __m128 v46; // xmm0
  __m128 v47; // xmm4
  __m128 v48; // xmm3
  __m128 v49; // xmm0
  __m128 v50; // xmm4
  __m128 v51; // xmm6
  __m128 v52; // xmm2
  __m128 v53; // xmm0
  __m128 v55; // xmm5
  __m128 v56; // xmm5
  __m128 v57; // xmm1
  __m128 v58; // xmm4
  __m128 v59; // xmm6
  __m128 v60; // xmm5
  __m128 v61; // [esp+20h] [ebp-FCh]
  __m128 v62; // [esp+30h] [ebp-ECh]
  __m128 v63; // [esp+40h] [ebp-DCh]
  __m128 v64; // [esp+50h] [ebp-CCh]
  __m128 v65; // [esp+60h] [ebp-BCh]
  __m128 v66; // [esp+70h] [ebp-ACh]
  __m128 v67; // [esp+80h] [ebp-9Ch]
  __m128 v68; // [esp+90h] [ebp-8Ch]
  __m128 v69; // [esp+A0h] [ebp-7Ch]
  __m128 v70; // [esp+B0h] [ebp-6Ch]
  __m128 v71; // [esp+E0h] [ebp-3Ch]

  v3 = _mm_loadh_ps(a3 + 7);
  v4 = _mm_loadh_ps(a3 + 2);
  v5 = _mm_loadh_ps(a3 + 3);
  v6 = _mm_shuffle_ps(v5, v3, 136);
  v7 = _mm_shuffle_ps(v3, v5, 221);
  v8 = _mm_mul_ps(v7, v6);
  v9 = _mm_shuffle_ps(v8, v8, 177);
  v10 = _mm_shuffle_ps(v9, v9, 78);
  v11 = _mm_loadh_ps(a3 + 6);
  v12 = _mm_shuffle_ps(v11, v4, 221);
  v13 = _mm_shuffle_ps(v4, v11, 136);
  v14 = v12;
  v15 = _mm_mul_ps(v12, v10);
  v62 = _mm_mul_ps(v10, v13);
  v16 = _mm_mul_ps(v14, v6);
  v17 = _mm_shuffle_ps(v16, v16, 177);
  v63 = _mm_mul_ps(v9, v13);
  v18 = _mm_add_ps(_mm_mul_ps(v7, v17), _mm_sub_ps(v15, _mm_mul_ps(v14, v9)));
  v19 = v17;
  v20 = _mm_shuffle_ps(v17, v17, 78);
  v64 = _mm_mul_ps(v19, v13);
  v21 = _mm_sub_ps(v18, _mm_mul_ps(v7, v20));
  v22 = v14;
  v23 = _mm_mul_ps(_mm_shuffle_ps(v14, v14, 78), v7);
  v24 = _mm_shuffle_ps(v23, v23, 177);
  v65 = _mm_mul_ps(v20, v13);
  v25 = _mm_shuffle_ps(v6, v6, 78);
  v26 = _mm_add_ps(_mm_mul_ps(v25, v24), v21);
  v27 = v24;
  v28 = _mm_shuffle_ps(v24, v24, 78);
  v66 = v7;
  v29 = v25;
  v30 = _mm_sub_ps(v26, _mm_mul_ps(v25, v28));
  v31 = _mm_sub_ps(_mm_mul_ps(v28, v13), _mm_mul_ps(v27, v13));
  v32 = v13;
  v33 = _mm_mul_ps(v13, v30);
  v61 = v30;
  v34 = _mm_add_ps(_mm_shuffle_ps(v33, v33, 78), v33);
  v30.m128_i32[0] = v34.m128_i32[0];
  v35 = _mm_shuffle_ps(v34, v34, 177);
  v35.m128_f32[0] = v35.m128_f32[0] + v30.m128_f32[0];
  v36 = v32;
  v37 = _mm_mul_ps(v32, v22);
  v38 = _mm_shuffle_ps(v37, v37, 177);
  v67 = v29;
  v68 = v22;
  v39 = _mm_mul_ps(v66, v36);
  v40 = _mm_shuffle_ps(v39, v39, 177);
  v69 = _mm_shuffle_ps(v38, v38, 78);
  v70 = v38;
  v41 = _mm_add_ps(
          _mm_mul_ps(v68, v40),
          _mm_sub_ps(_mm_mul_ps(v66, v69), _mm_add_ps(_mm_mul_ps(v66, v38), _mm_shuffle_ps(v31, v31, 78))));
  v42 = v40;
  v43 = _mm_shuffle_ps(v40, v40, 78);
  v44 = _mm_sub_ps(v41, _mm_mul_ps(v68, v43));
  v45 = _mm_sub_ps(v62, v63);
  v46 = _mm_mul_ps(v36, v67);
  v47 = _mm_add_ps(_mm_sub_ps(_mm_shuffle_ps(v45, v45, 78), _mm_mul_ps(v42, v67)), _mm_mul_ps(v43, v67));
  v48 = _mm_shuffle_ps(v46, v46, 177);
  v49 = _mm_shuffle_ps(v48, v48, 78);
  v71 = v44;
  v50 = _mm_sub_ps(_mm_add_ps(v47, _mm_mul_ps(v66, v48)), _mm_mul_ps(v66, v49));
  v51 = _mm_sub_ps(v65, v64);
  v52 = _mm_add_ps(
          _mm_mul_ps(v68, v49),
          _mm_sub_ps(
            _mm_sub_ps(_mm_sub_ps(_mm_mul_ps(v70, v67), _mm_shuffle_ps(v51, v51, 78)), _mm_mul_ps(v67, v69)),
            _mm_mul_ps(v48, v68)));
  if ( v35.m128_f32[0] == 0.0 )
    return 0;
  if ( a2 )
    *a2 = v35.m128_i32[0];
  v53 = v35;
  v53.m128_f32[0] = 1.0 / v35.m128_f32[0];
  v55 = v53;
  v55.m128_f32[0] = (float)(v55.m128_f32[0] + v55.m128_f32[0])
                  - (float)(v35.m128_f32[0] * (float)(v53.m128_f32[0] * v53.m128_f32[0]));
  v56 = _mm_shuffle_ps(v55, v55, 0);
  v57 = _mm_mul_ps(v61, v56);
  _mm_storel_ps(a1, v57);
  _mm_storeh_ps(a1 + 1, v57);
  v58 = _mm_mul_ps(v50, v56);
  _mm_storel_ps(a1 + 2, v58);
  _mm_storeh_ps(a1 + 3, v58);
  v59 = _mm_mul_ps(v71, v56);
  _mm_storel_ps(a1 + 4, v59);
  _mm_storeh_ps(a1 + 5, v59);
  v60 = _mm_mul_ps(v56, v52);
  _mm_storel_ps(a1 + 6, v60);
  _mm_storeh_ps(a1 + 7, v60);
  return a1;
}

// sub_458B00 @ 0x00458B00
void __stdcall sub_458B00(int a1, int a2, int a3)
{
  JUMPOUT(0x458B11);
}

// sub_458B0E @ 0x00458B0E
double *__stdcall sub_458B0E(double *a1, unsigned int *a2, const double *a3)
{
  __m128 v5; // xmm3
  __m128 v6; // xmm2
  __m128 v7; // xmm1
  __m128 v8; // xmm0
  __m128 v9; // xmm5
  __m128 v10; // xmm7
  __m128 v11; // xmm4
  __m128 v12; // xmm7
  __m128 v13; // xmm6
  __m128 v14; // xmm5
  __m128 v15; // xmm2
  __m128 v16; // xmm1
  __m128 v17; // xmm5
  __m128 v18; // xmm0
  __m128 v19; // xmm6
  __m128 v20; // xmm0

  v5 = _mm_loadh_ps(a3 + 1);
  v6 = _mm_loadh_ps(a3 + 3);
  v7 = _mm_loadh_ps(a3 + 5);
  v8 = _mm_loadh_ps(a3 + 7);
  v9 = _mm_add_ps(
         _mm_add_ps(
           _mm_add_ps(
             _mm_mul_ps(_mm_shuffle_ps((__m128)a2[4], (__m128)a2[4], 0), v5),
             _mm_mul_ps(_mm_shuffle_ps((__m128)a2[5], (__m128)a2[5], 0), v6)),
           _mm_mul_ps(_mm_shuffle_ps((__m128)a2[6], (__m128)a2[6], 0), v7)),
         _mm_mul_ps(_mm_shuffle_ps((__m128)a2[7], (__m128)a2[7], 0), v8));
  v10 = _mm_add_ps(
          _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(_mm_shuffle_ps((__m128)*a2, (__m128)*a2, 0), v5),
              _mm_mul_ps(_mm_shuffle_ps((__m128)a2[1], (__m128)a2[1], 0), v6)),
            _mm_mul_ps(_mm_shuffle_ps((__m128)a2[2], (__m128)a2[2], 0), v7)),
          _mm_mul_ps(_mm_shuffle_ps((__m128)a2[3], (__m128)a2[3], 0), v8));
  v11 = _mm_unpacklo_ps(v10, v9);
  v12 = _mm_unpackhi_ps(v10, v9);
  v13 = _mm_add_ps(
          _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(_mm_shuffle_ps((__m128)a2[8], (__m128)a2[8], 0), v5),
              _mm_mul_ps(_mm_shuffle_ps((__m128)a2[9], (__m128)a2[9], 0), v6)),
            _mm_mul_ps(_mm_shuffle_ps((__m128)a2[10], (__m128)a2[10], 0), v7)),
          _mm_mul_ps(_mm_shuffle_ps((__m128)a2[11], (__m128)a2[11], 0), v8));
  v14 = _mm_add_ps(
          _mm_mul_ps(_mm_shuffle_ps((__m128)a2[12], (__m128)a2[12], 0), v5),
          _mm_mul_ps(_mm_shuffle_ps((__m128)a2[13], (__m128)a2[13], 0), v6));
  v15 = _mm_mul_ps(_mm_shuffle_ps((__m128)a2[14], (__m128)a2[14], 0), v7);
  v16 = (__m128)a2[15];
  _mm_storel_ps(a1, v11);
  v17 = _mm_add_ps(_mm_add_ps(v14, v15), _mm_mul_ps(_mm_shuffle_ps(v16, v16, 0), v8));
  _mm_storeh_ps(a1 + 2, v11);
  _mm_storel_ps(a1 + 4, v12);
  _mm_storeh_ps(a1 + 6, v12);
  v18 = v13;
  v19 = _mm_unpacklo_ps(v13, v17);
  _mm_storel_ps(a1 + 1, v19);
  _mm_storeh_ps(a1 + 3, v19);
  v20 = _mm_unpackhi_ps(v18, v17);
  _mm_storel_ps(a1 + 5, v20);
  _mm_storeh_ps(a1 + 7, v20);
  return a1;
}

// sub_458C60 @ 0x00458C60
void __stdcall sub_458C60(int a1, int a2, int a3, int a4)
{
  JUMPOUT(0x458C71);
}

// sub_458C6E @ 0x00458C6E
__m128 *__stdcall sub_458C6E(__m128 *a1, int a2, int a3, int a4)
{
  __m128 v5; // xmm2
  __m128 v6; // xmm2
  __m128 v7; // xmm1
  __m128 v8; // xmm3
  __m128 v9; // xmm4
  __m128 v10; // xmm0
  __m128 v11; // xmm4
  __m128 v12; // xmm2
  __m128 v13; // xmm3
  __m128 v14; // xmm1

  v5 = _mm_loadh_ps((const double *)(a3 + 8));
  v6 = _mm_shuffle_ps(v5, v5, 57);
  v7 = _mm_loadh_ps((const double *)(a2 + 8));
  v8 = _mm_loadh_ps((const double *)(a4 + 8));
  v9 = _mm_shuffle_ps(v8, v8, 78);
  v10 = _mm_mul_ps(_mm_shuffle_ps(v9, v9, 57), v6);
  v11 = _mm_mul_ps(v9, v6);
  v12 = _mm_mul_ps(v6, v8);
  v13 = _mm_shuffle_ps(v7, v7, 57);
  v14 = _mm_shuffle_ps(v13, v13, 57);
  *a1 = _mm_xor_ps(
          _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(v13, _mm_sub_ps(_mm_shuffle_ps(v11, v11, 57), _mm_shuffle_ps(v12, v12, 78))),
              _mm_mul_ps(_mm_sub_ps(_mm_shuffle_ps(v10, v10, 78), v10), v14)),
            _mm_mul_ps(_mm_shuffle_ps(v14, v14, 57), _mm_sub_ps(v11, _mm_shuffle_ps(v12, v12, 57)))),
          (__m128)xmmword_47A9A0);
  return a1;
}

// sub_458D10 @ 0x00458D10
void __stdcall sub_458D10(int a1, int a2)
{
  JUMPOUT(0x458D21);
}

// sub_458D1E @ 0x00458D1E
int __stdcall sub_458D1E(int a1, int a2)
{
  __m128 v2; // xmm0
  __m128 v3; // xmm2
  __m128 v5; // xmm3
  __m128 v6; // xmm0
  int v7; // [esp-14h] [ebp-44h]
  int v8; // [esp-10h] [ebp-40h]
  int v9; // [esp-Ch] [ebp-3Ch]
  int v10; // [esp-8h] [ebp-38h]
  void *vars0; // [esp+30h] [ebp+0h]
  void *retaddr; // [esp+38h] [ebp+8h]

  vars0 = retaddr;
  v2 = sub_45FDC0(v7, v8, v9, v10);
  v3 = (__m128)xmmword_4DC1B0;
  v5 = v2;
  v6 = (__m128)xmmword_4DC1C0;
  *(_OWORD *)a1 = xmmword_4DC1D0;
  *(_DWORD *)(a1 + 16) = v6.m128_i32[0];
  _mm_storel_ps((double *)(a1 + 20), v5);
  _mm_storel_ps((double *)(a1 + 28), v6);
  *(_DWORD *)(a1 + 44) = v6.m128_i32[0];
  _mm_storel_ps((double *)(a1 + 36), _mm_xor_ps(_mm_shuffle_ps(v5, v5, 17), v3));
  *(__m128 *)(a1 + 48) = v6;
  return a1;
}

// sub_458D90 @ 0x00458D90
void __stdcall sub_458D90(int a1, int a2)
{
  JUMPOUT(0x458DA1);
}

// sub_458D9E @ 0x00458D9E
int __stdcall sub_458D9E(int a1, int a2)
{
  __m128 v2; // xmm0
  __m128 v3; // xmm0
  __int128 v5; // xmm1
  int v6; // [esp-14h] [ebp-64h]
  int v7; // [esp-10h] [ebp-60h]
  int v8; // [esp-Ch] [ebp-5Ch]
  int v9; // [esp-8h] [ebp-58h]
  __m128 v10; // [esp+1Ch] [ebp-34h]
  __m128 v11; // [esp+2Ch] [ebp-24h]
  void *vars0; // [esp+50h] [ebp+0h]
  void *retaddr; // [esp+58h] [ebp+8h]

  vars0 = retaddr;
  v11 = (__m128)xmmword_4DC210;
  v10 = (__m128)xmmword_4DC200;
  v2 = sub_45FDC0(v6, v7, v8, v9);
  v3 = _mm_and_ps(_mm_shuffle_ps(v2, v2, 80), v11);
  *(__m128 *)a1 = _mm_xor_ps(v10, v3);
  *(_OWORD *)(a1 + 16) = xmmword_4DC1F0;
  v5 = xmmword_4DC1E0;
  *(__m128 *)(a1 + 32) = _mm_shuffle_ps(v3, v3, 70);
  *(_OWORD *)(a1 + 48) = v5;
  return a1;
}

// sub_458E20 @ 0x00458E20
void __stdcall sub_458E20(int a1)
{
  JUMPOUT(0x458E31);
}

// sub_458E2E @ 0x00458E2E
double __stdcall sub_458E2E(int a1)
{
  __m128 v1; // xmm7
  __m128 v2; // xmm1
  __m128 v3; // xmm2
  __m128 v4; // xmm0
  __m128 v5; // xmm2
  __m128 v6; // xmm3
  __m128 v7; // xmm4
  __m128 v8; // xmm0
  __m128 v9; // xmm4
  __m128 v10; // xmm0
  __m128 v11; // xmm2
  __m128 v12; // xmm0
  __m128 v13; // xmm1
  __m128 v14; // xmm1
  __m128 v15; // xmm0

  if ( (a1 & 0xF) != 0 )
  {
    v2 = _mm_loadh_ps((const double *)(a1 + 24));
    v1 = _mm_loadh_ps((const double *)(a1 + 8));
    v3 = _mm_loadh_ps((const double *)(a1 + 40));
    v4 = _mm_loadh_ps((const double *)(a1 + 56));
  }
  else
  {
    v1 = *(__m128 *)a1;
    v2 = *(__m128 *)(a1 + 16);
    v3 = *(__m128 *)(a1 + 32);
    v4 = *(__m128 *)(a1 + 48);
  }
  v5 = _mm_shuffle_ps(v3, v3, 57);
  v6 = _mm_mul_ps(v4, v5);
  v7 = _mm_shuffle_ps(v4, v4, 78);
  v8 = _mm_shuffle_ps(v7, v7, 57);
  v9 = _mm_mul_ps(v7, v5);
  v10 = _mm_mul_ps(v5, v8);
  v11 = _mm_sub_ps(_mm_shuffle_ps(v10, v10, 78), v10);
  v12 = _mm_shuffle_ps(v2, v2, 57);
  v13 = _mm_shuffle_ps(v12, v12, 57);
  v14 = _mm_mul_ps(
          _mm_add_ps(
            _mm_add_ps(
              _mm_mul_ps(v12, _mm_sub_ps(_mm_shuffle_ps(v9, v9, 57), _mm_shuffle_ps(v6, v6, 78))),
              _mm_mul_ps(v11, v13)),
            _mm_mul_ps(_mm_shuffle_ps(v13, v13, 57), _mm_sub_ps(v9, _mm_shuffle_ps(v6, v6, 57)))),
          v1);
  v15 = _mm_add_ps(v14, _mm_movehl_ps(v14, v14));
  return (float)(v15.m128_f32[0] - _mm_shuffle_ps(v15, v15, 1).m128_f32[0]);
}

// sub_458EF0 @ 0x00458EF0
void __stdcall sub_458EF0(int a1, int a2, int a3, int a4)
{
  JUMPOUT(0x458F01);
}

// sub_458EFE @ 0x00458EFE
__m128 *__stdcall sub_458EFE(__m128 *a1, const double *a2, const double *a3, const double *a4)
{
  __m128 v5; // xmm3
  __m128 v6; // xmm1
  __m128 v7; // xmm0
  __m128 v8; // xmm4
  __m128 v9; // xmm5
  __m128 v10; // xmm3
  __m128 v11; // xmm5
  __m128 v12; // xmm1
  __m128 v13; // xmm3
  __m128 v14; // xmm5
  __m128 v15; // xmm0
  __m128 v16; // xmm5
  __m128 v17; // xmm3
  __m128 v18; // xmm0

  v5 = _mm_loadh_ps(a2);
  v6 = _mm_sub_ps(v5, _mm_loadh_ps(a4));
  v7 = _mm_shuffle_ps(v6, v6, 120);
  v8 = v5;
  v9 = _mm_sub_ps(v5, _mm_loadh_ps(a3));
  v10 = _mm_shuffle_ps(v9, v9, 99);
  v11 = _mm_mul_ps(_mm_shuffle_ps(v9, v9, 120), _mm_shuffle_ps(v6, v6, 99));
  v12 = (__m128)xmmword_47A9D0;
  v13 = _mm_sub_ps(_mm_mul_ps(v7, v10), v11);
  v14 = _mm_mul_ps(v13, v13);
  v15 = _mm_add_ps(v14, _mm_movehl_ps(v14, v14));
  v15.m128_f32[0] = v15.m128_f32[0] + _mm_shuffle_ps(v15, v15, 1).m128_f32[0];
  v16 = v15;
  v15.m128_f32[0] = fsqrt(v15.m128_f32[0]);
  v12.m128_f32[0] = (float)(*(float *)&xmmword_47A9D0 * (float)(1.0 / v15.m128_f32[0]))
                  * (float)(*(float *)&xmmword_47A9C0
                          - (float)((float)(v16.m128_f32[0] * (float)(1.0 / v15.m128_f32[0]))
                                  * (float)(1.0 / v15.m128_f32[0])));
  v17 = _mm_mul_ps(v13, _mm_shuffle_ps(v12, v12, 0));
  *a1 = v17;
  v18 = _mm_mul_ps(_mm_shuffle_ps(v8, v8, 14), v17);
  a1->m128_i32[3] = COERCE_UNSIGNED_INT(
                      v18.m128_f32[0]
                    + (float)(_mm_movehl_ps(v16, v18).m128_f32[0] + _mm_shuffle_ps(v18, v18, 85).m128_f32[0]))
                  ^ xmmword_47A9B0;
  return a1;
}

// sub_458FE0 @ 0x00458FE0
void __stdcall sub_458FE0(int a1, int a2, int a3)
{
  JUMPOUT(0x458FF1);
}

// sub_458FEE @ 0x00458FEE
double *__stdcall sub_458FEE(double *a1, __m128 *a2, __m128 *a3)
{
  __m128 v3; // xmm2
  __m128 v4; // xmm3
  __m128 v5; // xmm3
  __m128 v6; // xmm1
  __m128 v7; // xmm0
  CHAR v8; // al
  __m128 v9; // xmm4
  float v10; // xmm3_4
  float v11; // xmm5_4
  double *result; // eax
  __m128 v13; // xmm4
  __m128 v14; // xmm0
  __m128 v15; // xmm0
  __m128 v16; // xmm0
  __m128 v17; // xmm5
  __m128 v18; // xmm6
  float v19; // xmm7_4
  __m128 v20; // xmm0
  __m128 v21; // xmm1
  __m128 v22; // xmm2
  __m128 v23; // xmm3

  v3 = *a3;
  v4 = _mm_and_ps((__m128)xmmword_47AA20, *a3);
  v5 = _mm_mul_ps(v4, v4);
  v6 = _mm_add_ps(v5, _mm_movehl_ps((__m128)0LL, v5));
  v7 = _mm_shuffle_ps(v6, v6, 1);
  v7.m128_f32[0] = v7.m128_f32[0] + v6.m128_f32[0];
  if ( v7.m128_f32[0] != 0.0 )
  {
    v8 = String[96];
    if ( (String[96] & 1) != 0 )
    {
      v9 = *(__m128 *)&String[64];
    }
    else
    {
      v8 = String[96] | 1;
      v9 = (__m128)(unsigned int)dword_4DC220;
      String[96] |= 1u;
      *(_OWORD *)&String[64] = (unsigned int)dword_4DC220;
    }
    if ( (v8 & 2) != 0 )
    {
      v10 = *(float *)&String[80];
    }
    else
    {
      v10 = *(float *)&dword_4DC224;
      String[96] = v8 | 2;
      *(_OWORD *)&String[80] = (unsigned int)dword_4DC224;
    }
    v11 = 1.0 / fsqrt(v7.m128_f32[0]);
    v9.m128_f32[0] = (float)(v9.m128_f32[0] * v11) * (float)(v10 - (float)((float)(v7.m128_f32[0] * v11) * v11));
    v7 = _mm_mul_ps(v3, _mm_shuffle_ps(v9, v9, 0));
  }
  result = a1;
  v13 = _mm_xor_ps((__m128)xmmword_47A9E0, v7);
  v14 = _mm_mul_ps(v7, *a2);
  v15 = _mm_add_ps(v14, _mm_movehl_ps(v6, v14));
  v15.m128_f32[0] = v15.m128_f32[0] + _mm_shuffle_ps(v15, v15, 1).m128_f32[0];
  v16 = _mm_shuffle_ps(v15, v15, 0);
  v17 = _mm_and_ps((__m128)xmmword_47AA00, v16);
  v18 = _mm_and_ps((__m128)xmmword_47AA10, v16);
  v19 = v16.m128_f32[0];
  v20 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v13, v13, 85), *a2), _mm_and_ps((__m128)xmmword_47A9F0, v16));
  v21 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v13, v13, 170), *a2), v17);
  v23 = _mm_mul_ps(_mm_shuffle_ps(v13, v13, 0), *a2);
  v22 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v13, v13, 255), *a2), v18);
  v23.m128_f32[0] = v23.m128_f32[0] + v19;
  if ( ((unsigned __int8)a1 & 0xF) != 0 )
  {
    _mm_storel_ps(a1, v23);
    _mm_storeh_ps(a1 + 1, v23);
    _mm_storel_ps(a1 + 2, v20);
    _mm_storeh_ps(a1 + 3, v20);
    _mm_storel_ps(a1 + 4, v21);
    _mm_storeh_ps(a1 + 5, v21);
    _mm_storel_ps(a1 + 6, v22);
    _mm_storeh_ps(a1 + 7, v22);
  }
  else
  {
    *(__m128 *)a1 = v23;
    *((__m128 *)a1 + 1) = v20;
    *((__m128 *)a1 + 2) = v21;
    *((__m128 *)a1 + 3) = v22;
  }
  return result;
}

// sub_459170 @ 0x00459170
void __stdcall sub_459170(int a1, int a2)
{
  JUMPOUT(0x459181);
}

// sub_45917E @ 0x0045917E
__m128 *__stdcall sub_45917E(__m128 *a1, const double *a2)
{
  __m128 v3; // xmm1
  __m128 v4; // xmm0
  __m128 v5; // xmm3
  __m128 v6; // xmm4
  __m128 v7; // xmm0
  float v8; // xmm5_4
  __m128 v9; // xmm1
  __m128 v10; // xmm4
  __m128 v11; // xmm0
  __m128 v12; // xmm1
  __m128 v13; // xmm2
  __m128 v14; // xmm0
  __m128 v15; // xmm3
  __m128 v16; // xmm2
  __m128 v17; // xmm4

  v3 = _mm_loadl_ps(a2);
  v4 = _mm_and_ps((__m128)xmmword_47AAA0, v3);
  v5 = (__m128)(unsigned int)dword_47AA90;
  v6 = _mm_mul_ps(v4, v4);
  v7 = _mm_add_ps(v6, _mm_movehl_ps(v6, v6));
  v8 = v7.m128_f32[0] + _mm_shuffle_ps(v7, v7, 1).m128_f32[0];
  v7.m128_f32[0] = 1.0 / fsqrt(v8);
  v5.m128_f32[0] = (float)(*(float *)&dword_47AA90 * v7.m128_f32[0])
                 * (float)(*(float *)&dword_47AA80 - (float)((float)(v8 * v7.m128_f32[0]) * v7.m128_f32[0]));
  v9 = _mm_mul_ps(v3, _mm_shuffle_ps(v5, v5, 0));
  v10 = _mm_mul_ps((__m128)xmmword_47AA70, v9);
  v11 = v9;
  v12 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v9, v9, 0), v10), (__m128)xmmword_47AA60);
  v13 = v11;
  v14 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v11, v11, 255), v10), (__m128)xmmword_47AA30);
  v15 = v13;
  v16 = _mm_add_ps(_mm_mul_ps(_mm_shuffle_ps(v13, v13, 170), v10), (__m128)xmmword_47AA40);
  v17 = _mm_add_ps(_mm_mul_ps(v10, _mm_shuffle_ps(v15, v15, 85)), (__m128)xmmword_47AA50);
  *a1 = v12;
  a1[1] = v17;
  a1[2] = v16;
  a1[3] = v14;
  return a1;
}

// sub_459250 @ 0x00459250
float *__stdcall sub_459250(float *a1, float *a2)
{
  float *result; // eax
  double v3; // st7
  float v4; // edi
  float v5; // esi
  int v6; // ebp
  double v7; // st7
  int v8; // ecx
  int v9; // ebx
  int v10; // ebp
  float *v11; // esi
  long double v12; // st6
  long double v13; // st7
  float *v14; // ecx
  long double v15; // st6
  long double v16; // st7
  _DWORD v17[7]; // [esp+0h] [ebp-1Ch]

  result = a1;
  v3 = *a2 + a2[5] + a2[10];
  v4 = *a2;
  v5 = a2[5];
  v6 = *((_DWORD *)a2 + 10);
  if ( flt_4DC27C < v3 )
  {
    v15 = sqrt(v3 + flt_4DC280) * flt_4DC284;
    v16 = flt_4DC288 / v15;
    a1[3] = v15;
    *a1 = (a2[6] - a2[9]) * v16;
    a1[1] = (a2[8] - a2[2]) * v16;
    a1[2] = v16 * (a2[1] - a2[4]);
  }
  else
  {
    v7 = a2[10];
    *(float *)v17 = *a2;
    *(float *)&v17[1] = v5;
    v17[2] = v6;
    v8 = 2;
    if ( *(float *)&v17[v5 > (double)v4] >= v7 )
      v8 = v5 > (double)v4;
    v9 = dword_4DC270[v8];
    v10 = dword_4DC270[v9];
    v11 = &a2[v8];
    v12 = sqrt(flt_4DC290 + *(float *)&v17[v8] - *(float *)&v17[v9] - *(float *)&v17[v10]) * flt_4DC294;
    v13 = flt_4DC298 / v12;
    a1[v8] = v12;
    v14 = &a2[4 * v8];
    a1[v9] = (v14[v9] + v11[4 * v9]) * v13;
    a1[v10] = (v11[4 * v10] + v14[v10]) * v13;
    a1[3] = v13 * (a2[4 * v9 + v10] - a2[4 * v10 + v9]);
  }
  return result;
}

// sub_459370 @ 0x00459370
void __stdcall sub_459370(int a1, int a2, int a3, int a4)
{
  JUMPOUT(0x459381);
}

// sub_45937E @ 0x0045937E
__m128 *__stdcall sub_45937E(__m128 *a1, unsigned int a2, unsigned int a3, unsigned int a4)
{
  __m128 v4; // xmm0
  __m128 v5; // xmm1
  __m128 v6; // xmm3
  __m128 v7; // xmm2
  __m128 v8; // xmm3
  __m128 v10; // [esp+10h] [ebp-4Ch] BYREF
  __m128 v11[3]; // [esp+20h] [ebp-3Ch] BYREF

  v10 = _mm_mul_ps(
          _mm_shuffle_ps(
            _mm_unpacklo_ps((__m128)a3, (__m128)a4),
            _mm_unpacklo_ps((__m128)(unsigned int)dword_4DC2C0, (__m128)a2),
            17),
          (__m128)xmmword_4DC2B0);
  sub_45FEB0(&v10, &v10, v11);
  v4 = _mm_shuffle_ps(v10, v11[0], 0);
  v5 = _mm_shuffle_ps(v4, v4, 138);
  v6 = _mm_shuffle_ps(v10, v11[0], 153);
  v7 = _mm_shuffle_ps(v6, v6, 247);
  v8 = _mm_shuffle_ps(v6, v6, 168);
  v10 = _mm_add_ps(
          _mm_mul_ps(_mm_mul_ps(v5, v7), v8),
          _mm_xor_ps(
            _mm_mul_ps(_mm_mul_ps(_mm_shuffle_ps(v5, v5, 138), _mm_shuffle_ps(v7, v7, 81)), _mm_shuffle_ps(v8, v8, 1)),
            (__m128)xmmword_4DC2A0));
  *a1 = v10;
  return a1;
}

// sub_459440 @ 0x00459440
__m64 *__stdcall sub_459440(__m64 *a1, __m64 *a2, __m64 *a3)
{
  __m64 v3; // mm3
  __m64 v4; // mm1
  __m64 v6; // mm6
  __m64 v7; // mm7
  unsigned __int64 v8; // mm4
  __m64 v9; // mm6
  __m64 v10; // mm5
  __m64 v11; // mm3

  v3 = a3[1];
  v4 = a2[1];
  v6 = _m_punpckldq(_m_punpckhdq((__m64)a3->m64_u64, (__m64)a3->m64_u64), (__m64)a3->m64_u64);
  v7 = _m_punpckldq(_m_punpckhdq(v3, v3), v3);
  v8 = (unsigned __int64)_m_pfacc(
                           _m_pfsub(_m_pfmul(v6, v4), _m_pfmul(_m_pxor(v7, (__m64)0x80000000LL), (__m64)a2->m64_u64)),
                           _m_pfadd(
                             _m_pxor(_m_pfmul((__m64)a3->m64_u64, v4), (__m64)0x80000000LL),
                             _m_pfmul(v3, (__m64)a2->m64_u64)));
  v9 = _m_pfmul(_m_pxor(v6, (__m64)0x80000000LL), (__m64)a2->m64_u64);
  v10 = _m_pxor(v3, (__m64)0x80000000LL);
  v11 = _m_pfmul((__m64)a3->m64_u64, (__m64)a2->m64_u64);
  a1->m64_u64 = v8;
  a1[1].m64_u64 = (unsigned __int64)_m_pfacc(_m_pfadd(v9, _m_pfmul(v7, v4)), _m_pfsub(_m_pfmul(v10, v4), v11));
  _m_femms();
  return a1;
}

// sub_4594D9 @ 0x004594D9
__m64 *__stdcall sub_4594D9(__m64 *a1, __m64 *a2)
{
  __m64 v2; // mm3
  __m64 v3; // mm0
  __m64 v5; // mm0
  __m64 v6; // mm4
  __m64 v7; // mm5
  __m64 v8; // mm0

  v2 = a2[1];
  v3 = _m_pfadd(_m_pfmul((__m64)a2->m64_u64, (__m64)a2->m64_u64), _m_pfmul(v2, v2));
  v5 = _m_pfacc(v3, v3);
  v6 = _m_pfrsqrt(v5);
  v7 = _m_pfcmpgt(v5, (__m64)0x80000000800000LL);
  v8 = _m_pfrcpit2(_m_pfrsqit1(v5, _m_pfmul(v6, v6)), v6);
  a1->m64_u64 = (unsigned __int64)_m_pfmul(_m_pand((__m64)a2->m64_u64, v7), v8);
  a1[1].m64_u64 = (unsigned __int64)_m_pfmul(_m_pand(v2, v7), v8);
  _m_femms();
  return a1;
}

// sub_459536 @ 0x00459536
int __stdcall sub_459536(__m64 *a1, int a2, _DWORD *a3)
{
  __m64 m64_u64; // mm2
  __m64 v4; // mm0
  __m64 v5; // mm5
  __m64 v6; // mm5
  __m64 v7; // mm1
  int result; // eax
  __m64 v9; // mm4
  __m64 v10; // mm1
  __m64 v11; // mm1

  m64_u64 = (__m64)a1->m64_u64;
  v4 = a1[1];
  v5 = _m_pfadd(_m_pfmul(m64_u64, m64_u64), _m_pfmul(v4, v4));
  v6 = _m_pfacc(v5, v5);
  v7 = _m_pfrsqrt(v6);
  result = _mm_cvtsi64_si32(_m_pfcmpge((__m64)0x80000000800000LL, v6));
  v9 = v7;
  if ( result )
  {
    if ( a2 )
    {
      *(_QWORD *)(a2 + 4) = 0;
      *(_DWORD *)a2 = _mm_cvtsi64_si32((__m64)0xBF8000003F800000uLL);
    }
    if ( a3 )
      *a3 = _mm_cvtsi64_si32(0);
  }
  else
  {
    v10 = _m_pfmul(v7, v7);
    if ( a2 )
    {
      v11 = _m_pfrcpit2(_m_pfrsqit1(v10, v6), v9);
      *(__m64 *)a2 = _m_pfmul(m64_u64, v11);
      *(_DWORD *)(a2 + 8) = _mm_cvtsi64_si32(_m_pfmul(v11, v4));
    }
    if ( a3 )
    {
      result = math_acos_packed(a3, a2);
      *a3 = _mm_cvtsi64_si32(_m_pfmul(_m_punpckhdq(v4, v4), (__m64)0x4000000040000000LL));
    }
  }
  _m_femms();
  return result;
}

// sub_4595E9 @ 0x004595E9
__m64 *__stdcall sub_4595E9(__m64 *a1, __m64 *a2)
{
  __m64 v2; // mm4
  __m64 v3; // mm5
  __m64 v4; // mm3
  __m64 v5; // mm0
  __m64 v6; // mm1
  __m64 v7; // mm2
  __m64 v8; // mm5
  __m64 v9; // mm3
  __m64 v10; // mm0
  __m64 v11; // mm3
  __m64 v12; // mm6
  int v13; // ecx
  __m64 v14; // mm0
  __m64 v15; // mm7
  __m64 v16; // mm2
  __m64 v17; // mm0
  __m64 v18; // mm4
  __m64 *result; // eax
  __m64 v20; // mm1
  __m64 v21; // mm1
  __m64 v22; // mm0
  __m64 v23; // mm1
  __m64 v24; // mm4
  __m64 v25; // mm1
  __m64 v26; // mm2
  __m64 v27; // mm0
  __m64 v28; // mm2
  __m64 v29; // mm4
  __m64 v30; // mm1
  __m64 v31; // mm3
  __m64 v32; // mm0
  __m64 v33; // mm3
  __m64 v34; // mm2
  __m64 v35; // mm3

  v2 = _mm_cvtsi32_si64(a2[2].m64_u32[1]);
  v3 = _mm_cvtsi32_si64(a2[5].m64_u32[0]);
  v4 = _m_pfsubr((__m64)a2->m64_u64, v3);
  v5 = _m_pfadd(_m_pfadd((__m64)a2->m64_u64, v2), v3);
  v6 = _m_pfsub(_m_pfsub((__m64)a2->m64_u64, v2), v3);
  v7 = _m_pfsub(_m_pfsubr((__m64)a2->m64_u64, v2), v3);
  v8 = a2[4];
  v9 = _m_pfsub(v4, v2);
  v10 = _m_punpckldq(v5, v7);
  v11 = _m_punpckldq(v9, v9);
  v12 = _m_packssdw(_m_pfcmpge(_m_punpckldq(0, v6), v10), _m_pfcmpge(_m_punpckldq(v7, v6), v11));
  v13 = _mm_cvtsi64_si32(_m_packsswb(v12, v12));
  if ( (v13 & 1) != 0 )
  {
    if ( (v13 & 0xFF00FF00) == 0xFF00FF00 )
    {
      v21 = _m_pfadd(v6, (__m64)0xBF8000003F800000uLL);
      v22 = _m_pfrsqrt(v21);
      v23 = _m_punpckldq(v21, v21);
      v24 = _m_pfmul(_m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v22, v22), v23), v22), (__m64)0x3F0000003F000000LL);
      v25 = _m_punpckldq(
              _m_pfmul(v23, v24),
              _m_pfmul(_m_pfsub(_mm_cvtsi32_si64(a2[2].m64_u32[0]), _m_punpckhdq(v7, v7)), v24));
      a1[1].m64_u64 = (unsigned __int64)_m_pfmul(
                                          _m_pfadd(
                                            _m_punpckldq(v8, (__m64)a2[3].m64_u32[0]),
                                            _m_pxor(
                                              _m_punpckldq(_mm_cvtsi32_si64(a2[1].m64_u32[0]), _m_punpckhdq(v8, v8)),
                                              (__m64)0x8000000000000000uLL)),
                                          v24);
      a1->m64_u64 = (unsigned __int64)v25;
      _m_femms();
      return a1;
    }
    else
    {
      result = a1;
      if ( (v13 & 0x10000) != 0 )
      {
        v26 = _m_pfadd(v7, (__m64)0xBF8000003F800000uLL);
        v27 = _m_pfrsqrt(v26);
        v28 = _m_punpckldq(v26, v26);
        v29 = _m_pfmul(_m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v27, v27), v28), v27), (__m64)0x3F0000003F000000LL);
        v30 = _m_punpckldq(
                _m_pfmul(_m_pfadd(_m_punpckhdq(v6, v6), _mm_cvtsi32_si64(a2[2].m64_u32[0])), v29),
                _m_pfmul(v28, v29));
        a1[1].m64_u64 = (unsigned __int64)_m_pfmul(
                                            _m_pfadd(
                                              _m_punpckldq(_mm_cvtsi32_si64(a2[3].m64_u32[0]), v8),
                                              _m_pxor(
                                                _m_punpckldq(_m_punpckhdq(v8, v8), (__m64)a2[1].m64_u32[0]),
                                                (__m64)0x8000000000000000uLL)),
                                            v29);
        a1->m64_u64 = (unsigned __int64)v30;
      }
      else
      {
        v31 = _m_pfadd(v11, (__m64)0xBF8000003F800000uLL);
        v32 = _m_pfrsqrt(v31);
        v33 = _m_punpckldq(v31, v31);
        v34 = _m_pfmul(_m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v32, v32), v33), v32), (__m64)0x3F0000003F000000LL);
        v35 = _m_punpckldq(
                _m_pfmul(v33, v34),
                _m_pfmul(_m_pfsub(_m_punpckhdq(v6, v6), _mm_cvtsi32_si64(a2[2].m64_u32[0])), v34));
        a1->m64_u64 = (unsigned __int64)_m_pfmul(
                                          _m_pfadd(
                                            _m_punpckldq(v8, (__m64)a2[3].m64_u32[0]),
                                            _m_punpckldq(_mm_cvtsi32_si64(a2[1].m64_u32[0]), _m_punpckhdq(v8, v8))),
                                          v34);
        a1[1].m64_u64 = (unsigned __int64)v35;
      }
      _m_femms();
    }
  }
  else
  {
    v14 = _m_pfadd(v10, (__m64)0xBF8000003F800000uLL);
    v15 = _mm_cvtsi32_si64(a2[1].m64_u32[0]);
    v16 = _m_pfrsqrt(v14);
    v17 = _m_punpckldq(v14, v14);
    v18 = _m_pfmul(_m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v16, v16), v17), v16), (__m64)0x3F0000003F000000LL);
    v20 = _m_punpckldq(
            _m_pfmul(_m_pfsub(_m_punpckhdq(v6, v6), _mm_cvtsi32_si64(a2[2].m64_u32[0])), v18),
            _m_pfmul(v17, v18));
    a1->m64_u64 = (unsigned __int64)_m_pfmul(
                                      _m_pfsub(
                                        _m_punpckldq(_mm_cvtsi32_si64(a2[3].m64_u32[0]), v8),
                                        _m_punpckhdq(v8, _m_punpckldq(v15, v15))),
                                      v18);
    a1[1].m64_u64 = (unsigned __int64)v20;
    _m_femms();
    return a1;
  }
  return result;
}

// sub_459805 @ 0x00459805
__m64 *__stdcall sub_459805(__m64 *a1, __m64 *a2)
{
  __m64 v2; // mm4
  __m64 v3; // mm5
  __m64 v4; // mm3
  __m64 v5; // mm0
  __m64 v6; // mm1
  __m64 v7; // mm2
  __m64 v8; // mm5
  __m64 v9; // mm3
  __m64 v10; // mm0
  __m64 v11; // mm3
  char v12; // cl
  __m64 v13; // mm0
  __m64 v14; // mm7
  __m64 v15; // mm2
  __m64 v16; // mm0
  __m64 v17; // mm4
  __m64 *result; // eax
  __m64 v19; // mm1
  __m64 v20; // mm1
  __m64 v21; // mm0
  __m64 v22; // mm1
  __m64 v23; // mm4
  __m64 v24; // mm1
  __m64 v25; // mm2
  __m64 v26; // mm0
  __m64 v27; // mm2
  __m64 v28; // mm4
  __m64 v29; // mm1
  __m64 v30; // mm3
  __m64 v31; // mm0
  __m64 v32; // mm3
  __m64 v33; // mm2
  __m64 v34; // mm3

  v2 = _mm_cvtsi32_si64(a2[2].m64_u32[1]);
  v3 = _mm_cvtsi32_si64(a2[5].m64_u32[0]);
  v4 = _m_pfsubr((__m64)a2->m64_u64, v3);
  v5 = _m_pfadd(_m_pfadd((__m64)a2->m64_u64, v2), v3);
  v6 = _m_pfsub(_m_pfsub((__m64)a2->m64_u64, v2), v3);
  v7 = _m_pfsub(_m_pfsubr((__m64)a2->m64_u64, v2), v3);
  v8 = a2[4];
  v9 = _m_pfsub(v4, v2);
  v10 = _m_punpckldq(v5, v7);
  v11 = _m_punpckldq(v9, v9);
  v12 = _m_pmovmskb(_m_packssdw(_m_pfcmpge(_m_punpckldq(0, v6), v10), _m_pfcmpge(_m_punpckldq(v7, v6), v11)));
  if ( (v12 & 1) != 0 )
  {
    if ( (v12 & 0xCC) == 0xCC )
    {
      v20 = _m_pfadd(v6, (__m64)0xBF8000003F800000uLL);
      v21 = _m_pfrsqrt(v20);
      v22 = _m_punpckldq(v20, v20);
      v23 = _m_pfmul(_m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v21, v21), v22), v21), (__m64)0x3F0000003F000000LL);
      v24 = _m_punpckldq(
              _m_pfmul(v22, v23),
              _m_pfmul(_m_pfsub(_mm_cvtsi32_si64(a2[2].m64_u32[0]), _m_punpckhdq(v7, v7)), v23));
      a1[1].m64_u64 = (unsigned __int64)_m_pfmul(
                                          _m_pfadd(
                                            _m_punpckldq(v8, (__m64)a2[3].m64_u32[0]),
                                            _m_pxor(
                                              _m_punpckldq(_mm_cvtsi32_si64(a2[1].m64_u32[0]), _m_punpckhdq(v8, v8)),
                                              (__m64)0x8000000000000000uLL)),
                                          v23);
      a1->m64_u64 = (unsigned __int64)v24;
      _m_femms();
      return a1;
    }
    else
    {
      result = a1;
      if ( (v12 & 0x10) != 0 )
      {
        v25 = _m_pfadd(v7, (__m64)0xBF8000003F800000uLL);
        v26 = _m_pfrsqrt(v25);
        v27 = _m_punpckldq(v25, v25);
        v28 = _m_pfmul(_m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v26, v26), v27), v26), (__m64)0x3F0000003F000000LL);
        v29 = _m_punpckldq(
                _m_pfmul(_m_pfadd(_m_punpckhdq(v6, v6), _mm_cvtsi32_si64(a2[2].m64_u32[0])), v28),
                _m_pfmul(v27, v28));
        a1[1].m64_u64 = (unsigned __int64)_m_pfmul(
                                            _m_pfadd(
                                              _m_punpckldq(_mm_cvtsi32_si64(a2[3].m64_u32[0]), v8),
                                              _m_pxor(
                                                _m_punpckldq(_m_punpckhdq(v8, v8), (__m64)a2[1].m64_u32[0]),
                                                (__m64)0x8000000000000000uLL)),
                                            v28);
        a1->m64_u64 = (unsigned __int64)v29;
      }
      else
      {
        v30 = _m_pfadd(v11, (__m64)0xBF8000003F800000uLL);
        v31 = _m_pfrsqrt(v30);
        v32 = _m_punpckldq(v30, v30);
        v33 = _m_pfmul(_m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v31, v31), v32), v31), (__m64)0x3F0000003F000000LL);
        v34 = _m_punpckldq(
                _m_pfmul(v32, v33),
                _m_pfmul(_m_pfsub(_m_punpckhdq(v6, v6), _mm_cvtsi32_si64(a2[2].m64_u32[0])), v33));
        a1->m64_u64 = (unsigned __int64)_m_pfmul(
                                          _m_pfadd(
                                            _m_punpckldq(v8, (__m64)a2[3].m64_u32[0]),
                                            _m_punpckldq(_mm_cvtsi32_si64(a2[1].m64_u32[0]), _m_punpckhdq(v8, v8))),
                                          v33);
        a1[1].m64_u64 = (unsigned __int64)v34;
      }
      _m_femms();
    }
  }
  else
  {
    v13 = _m_pfadd(v10, (__m64)0xBF8000003F800000uLL);
    v14 = _mm_cvtsi32_si64(a2[1].m64_u32[0]);
    v15 = _m_pfrsqrt(v13);
    v16 = _m_punpckldq(v13, v13);
    v17 = _m_pfmul(_m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v15, v15), v16), v15), (__m64)0x3F0000003F000000LL);
    v19 = _m_punpckldq(
            _m_pfmul(_m_pfsub(_m_punpckhdq(v6, v6), _mm_cvtsi32_si64(a2[2].m64_u32[0])), v17),
            _m_pfmul(v16, v17));
    a1->m64_u64 = (unsigned __int64)_m_pfmul(
                                      _m_pfsub(
                                        _m_punpckldq(_mm_cvtsi32_si64(a2[3].m64_u32[0]), v8),
                                        _m_punpckhdq(v8, _m_punpckldq(v14, v14))),
                                      v17);
    a1[1].m64_u64 = (unsigned __int64)v19;
    _m_femms();
    return a1;
  }
  return result;
}

// sub_459A1A @ 0x00459A1A
__m64 *__userpurge sub_459A1A@<eax>(__m64 *a1, __m64 a2, __m64 a3)
{
  __m64 v3; // mm1
  __m64 v5; // mm6
  __m64 v6; // mm2
  __m64 v7; // mm6
  __m64 v8; // mm7
  __m64 v9; // [esp+10h] [ebp-10h]

  _m_femms();
  v9 = _m_pfmul((__m64)0x3F0000003F000000LL, a2);
  math_sincos_packed();
  math_sincos_packed();
  math_sincos_packed();
  v3 = _m_pfmul((__m64)0x3F0000003F000000LL, a3);
  v5 = _m_punpckhdq(v9, v9);
  v6 = _m_punpckldq(v5, v5);
  v7 = _m_punpckhdq(v5, v5);
  v8 = _m_punpckldq(_m_punpckhdq(v3, v3), v3);
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfmul(
                                      _m_pfmul(_m_pxor(_m_punpckldq(v9, v9), (__m64)0x8000000000000000uLL), v7),
                                      v3),
                                    _m_pfmul(_m_pfmul(_m_punpckhdq(v9, v9), v6), v8));
  a1[1].m64_u64 = (unsigned __int64)_m_pfadd(
                                      _m_pfmul(_m_pfmul(_m_punpckldq(v9, v9), v6), v8),
                                      _m_pfmul(
                                        _m_pfmul(
                                          _m_pxor(_m_punpckhdq(v9, v9), _m_psrlqi((__m64)0x8000000000000000uLL, 0x20u)),
                                          v7),
                                        v3));
  _m_femms();
  return a1;
}

// sub_459ADF @ 0x00459ADF
__m64 *__stdcall sub_459ADF(__m64 *a1, int a2, unsigned int a3)
{
  __m64 v3; // mm0
  __m64 v5; // mm3
  __m64 v6; // mm2
  __m64 v7; // [esp+0h] [ebp-18h] BYREF
  unsigned int v8; // [esp+8h] [ebp-10h]

  _m_femms();
  sub_45E832((int)&v7, a2);
  v3 = _m_pfmul(_mm_cvtsi32_si64(a3), (__m64)0x3F0000003F000000LL);
  math_sincos_packed();
  v5 = _m_punpckhdq(v3, v3);
  v6 = _m_punpckldq(_m_pfmul(_mm_cvtsi32_si64(v8), v5), v3);
  a1->m64_u64 = (unsigned __int64)_m_pfmul(v7, v5);
  a1[1].m64_u64 = (unsigned __int64)v6;
  _m_femms();
  return a1;
}

// sub_459B4B @ 0x00459B4B
__m64 *__stdcall sub_459B4B(__m64 *a1, __m64 *a2, __m64 *a3, unsigned int a4)
{
  __m64 v4; // mm1
  __m64 v5; // mm4
  __m64 v6; // mm0
  __m64 v7; // mm1
  __m64 v8; // mm7
  __m64 v9; // mm1
  __m64 v10; // mm3
  __m64 v11; // mm4
  __m64 v12; // mm0
  __m64 v13; // mm1
  __m64 v15; // mm4
  __m64 v16; // mm5
  __m64 v17; // mm6
  __m64 v18; // mm0
  __m64 v19; // mm5
  unsigned int v20; // [esp+28h] [ebp+10h]

  _m_femms();
  v4 = _m_pfadd(_m_pfmul((__m64)a2->m64_u64, (__m64)a3->m64_u64), _m_pfmul(a2[1], a3[1]));
  v5 = _mm_cvtsi32_si64(a4);
  v6 = _m_pfsub(_mm_cvtsi32_si64(0x3F800000u), v5);
  v7 = _m_pfacc(v4, v4);
  v8 = _m_pand(_m_pfcmpge(0, v7), (__m64)0x8000000080000000uLL);
  v9 = _m_pxor(v7, v8);
  v10 = _m_pfsubr(_m_pfmul(v9, v9), (__m64)0x3F8000003F800000LL);
  if ( _mm_cvtsi64_si32(_m_pfcmpge((__m64)0x3F7FFF583F7FFF58LL, v9)) )
  {
    v11 = _m_pfrsqrt(v10);
    math_atan2_packed();
    math_sin_packed();
    v20 = _mm_cvtsi64_si32(_m_pfmul(v9, _mm_cvtsi32_si64(a4)));
    v12 = _m_pfmul(_mm_cvtsi32_si64(_mm_cvtsi64_si32(v9)), _mm_cvtsi32_si64(_mm_cvtsi64_si32(v6)));
    math_sin_packed();
    v13 = _mm_cvtsi32_si64(_mm_cvtsi64_si32(_m_pfrcpit2(_m_pfrsqit1(v10, _m_pfmul(v11, v11)), v11)));
    v8 = _mm_cvtsi32_si64(_mm_cvtsi64_si32(v8));
    v6 = _m_pfmul(v12, v13);
    v5 = _m_pfmul(_mm_cvtsi32_si64(v20), v13);
  }
  v15 = _m_pxor(v5, v8);
  v16 = _m_punpckldq(v6, v6);
  v17 = _m_punpckldq(v15, v15);
  v18 = _m_pfmul(v16, (__m64)a2->m64_u64);
  v19 = _m_pfadd(_m_pfmul(v16, a2[1]), _m_pfmul(v17, a3[1]));
  a1->m64_u64 = (unsigned __int64)_m_pfadd(v18, _m_pfmul(v17, (__m64)a3->m64_u64));
  a1[1].m64_u64 = (unsigned __int64)v19;
  _m_femms();
  return a1;
}

// sub_459C82 @ 0x00459C82
__m64 *__stdcall sub_459C82(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, unsigned int a5, unsigned int a6)
{
  __m64 v6; // mm0
  __m64 v7; // mm2
  __m64 v9[2]; // [esp+Ch] [ebp-24h] BYREF
  __m64 v10[2]; // [esp+1Ch] [ebp-14h] BYREF
  unsigned int v11; // [esp+44h] [ebp+14h]

  _m_femms();
  v11 = _mm_cvtsi64_si32(_m_pfadd(_mm_cvtsi32_si64(a5), _mm_cvtsi32_si64(a6)));
  sub_459B4B(v9, a2, a3, v11);
  sub_459B4B(v10, a2, a4, v11);
  v6 = _mm_cvtsi32_si64(v11);
  v7 = _m_pfrcp(v6);
  sub_459B4B(a1, v9, v10, _mm_cvtsi64_si32(_m_pfmul(_m_pfrcpit2(_m_pfrcpit1(v6, v7), v7), _mm_cvtsi32_si64(a6))));
  _m_femms();
  return a1;
}

// sub_459D0F @ 0x00459D0F
__m64 *__stdcall sub_459D0F(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, __m64 *a5, unsigned int a6)
{
  __m64 v6; // mm1
  __m64 *result; // eax
  __m64 v8[2]; // [esp+10h] [ebp-20h] BYREF
  __m64 v9[2]; // [esp+20h] [ebp-10h] BYREF

  sub_459B4B(v8, a2, a5, a6);
  sub_459B4B(v9, a3, a4, a6);
  v6 = _mm_cvtsi32_si64(a6);
  result = sub_459B4B(
             a1,
             v8,
             v9,
             _mm_cvtsi64_si32(_m_pfmul(_m_pfsub(v6, _m_pfmul(v6, v6)), (__m64)0x4000000040000000LL)));
  _m_femms();
  return result;
}

// sub_459DA1 @ 0x00459DA1
__m64 *__stdcall sub_459DA1(__m64 *a1, __m64 *a2)
{
  __m64 v2; // mm3
  __m64 v3; // mm0
  __m64 v4; // mm0
  __m64 v6; // mm4
  __m64 v7; // mm5
  __m64 v8; // mm0

  v2 = a2[1];
  v3 = _m_pfadd(_m_pfmul((__m64)a2->m64_u64, (__m64)a2->m64_u64), _m_pfmul(v2, v2));
  v4 = _m_pfacc(v3, v3);
  v6 = _m_pfrcp(v4);
  v7 = _m_pfcmpgt(v4, (__m64)0x80000000800000LL);
  v8 = _m_pfrcpit2(_m_pfrcpit1(v4, v6), v6);
  a1->m64_u64 = (unsigned __int64)_m_pfmul(_m_pand(_m_pxor((__m64)a2->m64_u64, (__m64)0x8000000080000000uLL), v7), v8);
  a1[1].m64_u64 = (unsigned __int64)_m_pfmul(_m_pand(_m_pxor(v2, (__m64)0x80000000LL), v7), v8);
  _m_femms();
  return a1;
}

// sub_459E05 @ 0x00459E05
__m64 *__stdcall sub_459E05(__m64 *a1, __m64 *a2)
{
  __m64 *result; // eax
  __m64 m64_u64; // mm1
  __m64 v4; // mm2
  __m64 v5; // mm0
  __m64 v6; // mm3
  __m64 v7; // mm4
  __m64 v8; // mm3
  unsigned int v9; // [esp+0h] [ebp-Ch]

  _m_femms();
  result = a1;
  m64_u64 = (__m64)a2->m64_u64;
  v4 = a2[1];
  v5 = _m_punpckhdq(v4, v4);
  if ( !_mm_cvtsi64_si32(_m_pfcmpge(v5, (__m64)0x3F8000003F800000LL)) )
  {
    math_acos_packed(0, a2);
    v9 = _mm_cvtsi64_si32(v5);
    math_sin_packed();
    result = a1;
    m64_u64 = (__m64)a2->m64_u64;
    v4 = a2[1];
    if ( _mm_cvtsi64_si32(_m_pfcmpge(_m_pand(v5, (__m64)0x7FFFFFFF7FFFFFFFLL), (__m64)0x3400000034000000LL)) )
    {
      v6 = _mm_cvtsi32_si64(v9);
      v7 = _m_pfrcp(v5);
      v8 = _m_pfmul(_m_punpckldq(v6, v6), _m_pfrcpit2(_m_pfrcpit1(v5, v7), v7));
      m64_u64 = _m_pfmul(m64_u64, v8);
      v4 = _m_pfmul(v4, v8);
    }
  }
  result->m64_u64 = (unsigned __int64)m64_u64;
  result[1].m64_u64 = (unsigned __int64)_m_pand(v4, (__m64)0xFFFFFFFFLL);
  _m_femms();
  return result;
}

// sub_459EAC @ 0x00459EAC
__m64 *__userpurge sub_459EAC@<eax>(unsigned int a1@<esi>, __m64 *a2, __m64 *a3)
{
  __m64 v3; // mm1
  __m64 v4; // mm0
  __m64 v5; // mm0
  __m64 v6; // mm2
  __m64 v7; // mm1
  __m64 v8; // mm1
  __m64 v9; // mm0
  __m64 *result; // eax
  char v11; // cl
  __m64 m64_u64; // mm2
  __m64 v13; // mm0
  __m64 v14; // mm1
  __m64 v15; // mm3
  __m64 v16; // mm1
  __m64 v17; // [esp+0h] [ebp-Ch]

  v3 = _mm_cvtsi32_si64(a3[1].m64_u32[0]);
  v4 = _m_pfadd(_m_pfmul((__m64)a3->m64_u64, (__m64)a3->m64_u64), _m_pfmul(v3, v3));
  v5 = _m_pfacc(v4, v4);
  v6 = _m_pfrsqrt(v5);
  v7 = _m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v6, v6), v5), v6);
  v17.m64_u64 = __PAIR64__(a1, _mm_cvtsi64_si32(v7));
  math_sincos_packed();
  v8 = _m_pfmul(v5, v7);
  v9 = _m_pfcmpge(_m_pand(v8, (__m64)0x7FFFFFFFFFFFFFFFLL), (__m64)0x3400000034000000LL);
  result = a2;
  v11 = _mm_cvtsi64_si32(_m_punpckhdq(v9, v9));
  m64_u64 = (__m64)a3->m64_u64;
  v13 = v8;
  v14 = _m_pfmul(_m_punpckhdq(v8, v8), v17);
  v15 = _mm_cvtsi32_si64(a3[1].m64_u32[0]);
  if ( (v11 & 1) != 0 )
  {
    v16 = _m_punpckldq(v14, v14);
    v15 = _m_pfmul(v15, v16);
    m64_u64 = _m_pfmul(m64_u64, v16);
  }
  a2->m64_u64 = (unsigned __int64)m64_u64;
  a2[1].m64_u64 = (unsigned __int64)_m_punpckldq(v15, v13);
  _m_femms();
  return result;
}

// sub_459F51 @ 0x00459F51
__m64 *__userpurge sub_459F51@<eax>(
        unsigned int a1@<esi>,
        __m64 *a2,
        __m64 *a3,
        __m64 *a4,
        __m64 *a5,
        __m64 *a6,
        __m64 *a7,
        __m64 *a8)
{
  __m64 v8; // mm0
  __m64 v9; // mm1
  __m64 v10; // mm2
  __m64 v11; // mm3
  __m64 *v12; // edx
  __m64 v13; // mm0
  __m64 v14; // mm2
  __m64 v15; // mm4
  __m64 v16; // mm5
  __m64 v17; // mm1
  __m64 v18; // mm3
  __m64 v19; // mm2
  int v20; // eax
  __m64 v21; // mm4
  __m64 v22; // mm6
  __m64 v23; // mm7
  __m64 v24; // mm3
  __m64 v25; // mm5
  __m64 v26; // mm6
  __m64 v27; // mm3
  __m64 v28; // mm0
  __m64 v29; // mm0
  __m64 v30; // mm4
  __m64 v31; // mm5
  __m64 v32; // mm0
  __m64 v33; // mm6
  __m64 v34; // mm7
  __m64 v35; // mm6
  __m64 v36; // mm7
  __m64 v37; // mm1
  __m64 v38; // mm2
  __m64 v39; // mm0
  __m64 v40; // mm3
  __m64 v41; // mm4
  __m64 v42; // mm3
  __m64 v43; // mm1
  __m64 v44; // mm2
  __m64 v45; // mm0
  __m64 v46; // mm3
  __m64 v47; // mm4
  __m64 v48; // mm3
  __m64 v49; // mm1
  __m64 v50; // mm0
  __m64 v51; // mm0
  __m64 v52; // mm2
  __m64 v53; // mm1
  __int32 v54; // edx
  __m64 v55; // mm1
  __m64 v56; // mm0
  char v57; // cl
  __m64 v58; // mm2
  __m64 v59; // mm0
  __m64 v60; // mm1
  __m64 v61; // mm3
  __m64 v62; // mm1
  __m64 v63; // mm6
  __m64 v64; // mm7
  __m64 v65; // mm0
  __m64 v66; // mm0
  __m64 v67; // mm4
  __m64 v68; // mm5
  __m64 v69; // mm0
  __m64 v70; // mm6
  __m64 v71; // mm7
  __m64 v72; // mm6
  __m64 v73; // mm7
  __m64 v74; // mm1
  __m64 v75; // mm2
  __m64 v76; // mm0
  __m64 v77; // mm3
  __m64 v78; // mm4
  __m64 v79; // mm3
  __m64 v80; // mm1
  __m64 v81; // mm2
  __m64 v82; // mm0
  __m64 v83; // mm3
  __m64 v84; // mm4
  __m64 v85; // mm3
  __m64 v86; // mm1
  __m64 v87; // mm0
  __m64 v88; // mm0
  __m64 v89; // mm2
  __m64 v90; // mm1
  __m64 v91; // mm1
  __m64 v92; // mm0
  char v93; // cl
  __m64 v94; // mm2
  __m64 v95; // mm0
  __m64 v96; // mm1
  __m64 v97; // mm3
  __m64 v98; // mm1
  __m64 v99; // mm6
  __m64 v100; // mm7
  unsigned int v102; // [esp+0h] [ebp-ACh]
  unsigned int v103; // [esp+0h] [ebp-ACh]
  __m64 v104; // [esp+0h] [ebp-ACh]
  unsigned int v105; // [esp+0h] [ebp-ACh]
  unsigned int v106; // [esp+0h] [ebp-ACh]
  __m64 v107; // [esp+0h] [ebp-ACh]
  __m64 m64_u64; // [esp+Ch] [ebp-A0h]
  __m64 v109; // [esp+14h] [ebp-98h]
  __m64 v110; // [esp+1Ch] [ebp-90h]
  __m64 v111; // [esp+24h] [ebp-88h]
  __m64 v112; // [esp+2Ch] [ebp-80h]
  __m64 v113; // [esp+34h] [ebp-78h]
  __m64 v114; // [esp+3Ch] [ebp-70h]
  __m64 v115; // [esp+44h] [ebp-68h]
  __m64 v116; // [esp+4Ch] [ebp-60h]
  __m64 v117; // [esp+4Ch] [ebp-60h]
  __m64 v118; // [esp+54h] [ebp-58h]
  __m64 v119; // [esp+54h] [ebp-58h]
  __m64 v120; // [esp+5Ch] [ebp-50h]
  __m64 v121; // [esp+5Ch] [ebp-50h]
  __m64 v122; // [esp+64h] [ebp-48h]
  __m64 v123; // [esp+64h] [ebp-48h]
  __m64 v124; // [esp+84h] [ebp-28h]
  __m64 v125; // [esp+84h] [ebp-28h]
  __m64 v126; // [esp+8Ch] [ebp-20h]
  __m64 v127; // [esp+8Ch] [ebp-20h]
  __m64 v128; // [esp+8Ch] [ebp-20h]
  __m64 v129; // [esp+8Ch] [ebp-20h]
  __m64 v130; // [esp+94h] [ebp-18h]
  unsigned int v131; // [esp+94h] [ebp-18h]
  __m64 v132; // [esp+94h] [ebp-18h]
  unsigned int v133; // [esp+94h] [ebp-18h]
  __m64 v134; // [esp+9Ch] [ebp-10h]
  __m64 v135; // [esp+9Ch] [ebp-10h]
  __m64 v136; // [esp+A4h] [ebp-8h]
  __m64 v137; // [esp+A4h] [ebp-8h]

  m64_u64 = (__m64)a5->m64_u64;
  v109 = a5[1];
  v110 = (__m64)a6->m64_u64;
  v8 = _m_pfadd((__m64)a5->m64_u64, (__m64)a6->m64_u64);
  v111 = a6[1];
  v9 = _m_pfadd(v109, v111);
  v10 = _m_pfsub((__m64)a5->m64_u64, (__m64)a6->m64_u64);
  v11 = _m_pfsub(v109, v111);
  v12 = a7;
  v13 = _m_pfadd(_m_pfmul(v8, v8), _m_pfmul(v9, v9));
  v14 = _m_pfadd(_m_pfmul(v10, v10), _m_pfmul(v11, v11));
  v112 = (__m64)a7->m64_u64;
  v113 = a7[1];
  v15 = _m_pfadd((__m64)a6->m64_u64, (__m64)a7->m64_u64);
  v16 = _m_pfadd(v111, v113);
  v17 = _m_pfsub((__m64)a6->m64_u64, (__m64)a7->m64_u64);
  v18 = _m_pfsub(v111, v113);
  v19 = _m_pfcmpgt(
          _m_pfacc(v14, _m_pfadd(_m_pfmul(v17, v17), _m_pfmul(v18, v18))),
          _m_pfacc(v13, _m_pfadd(_m_pfmul(v15, v15), _m_pfmul(v16, v16))));
  v20 = _mm_cvtsi64_si32(_m_packsswb(v19, v19));
  if ( (v20 & 1) != 0 )
  {
    v12 = a5;
    m64_u64 = _m_pxor((__m64)0x8000000080000000uLL, (__m64)a5->m64_u64);
    v109 = _m_pxor((__m64)0x8000000080000000uLL, a5[1]);
  }
  if ( (v20 & 0x10000) != 0 )
  {
    v112 = _m_pxor((__m64)0x8000000080000000uLL, (__m64)a7->m64_u64);
    v113 = _m_pxor((__m64)0x8000000080000000uLL, a7[1]);
  }
  v21 = a8[1];
  v22 = _m_pfadd(v112, (__m64)a8->m64_u64);
  v114 = (__m64)a8->m64_u64;
  v23 = _m_pfadd(v113, v21);
  v115 = v21;
  v24 = _m_pfsub(v112, (__m64)a8->m64_u64);
  v25 = _m_pfsub(v113, v21);
  v26 = _m_pfadd(_m_pfmul(v22, v22), _m_pfmul(v23, v23));
  v27 = _m_pfadd(_m_pfmul(v24, v24), _m_pfmul(v25, v25));
  if ( (_mm_cvtsi64_si32(_m_pfcmpgt(_m_pfacc(v27, v27), _m_pfacc(v26, v26))) & 1) != 0 )
  {
    v12 = a8;
    v114 = _m_pxor((__m64)0x8000000080000000uLL, (__m64)a8->m64_u64);
    v115 = _m_pxor((__m64)0x8000000080000000uLL, a8[1]);
  }
  v28 = _m_pfadd(_m_pfmul(v110, v110), _m_pfmul(v111, v111));
  v29 = _m_pfacc(v28, v28);
  v30 = _m_pfrcp(v29);
  v31 = _m_pfcmpgt(v29, (__m64)0x80000000800000LL);
  v32 = _m_pfrcpit2(_m_pfrcpit1(v29, v30), v30);
  v116 = _m_pfmul(_m_pand(_m_pxor(v110, (__m64)0x8000000080000000uLL), v31), v32);
  v118 = _m_pfmul(_m_pand(_m_pxor(v111, (__m64)0x80000000LL), v31), v32);
  v33 = _m_punpckldq(_m_punpckhdq(m64_u64, m64_u64), m64_u64);
  v34 = _m_punpckldq(_m_punpckhdq(v109, v109), v109);
  v126 = _m_pfacc(
           _m_pfsub(_m_pfmul(v33, v118), _m_pfmul(_m_pxor(v34, (__m64)0x80000000LL), v116)),
           _m_pfadd(_m_pxor(_m_pfmul(m64_u64, v118), (__m64)0x80000000LL), _m_pfmul(v109, v116)));
  v130 = _m_pfacc(
           _m_pfadd(_m_pfmul(_m_pxor(v33, (__m64)0x80000000LL), v116), _m_pfmul(v34, v118)),
           _m_pfsub(_m_pfmul(_m_pxor(v109, (__m64)0x80000000LL), v118), _m_pfmul(m64_u64, v116)));
  v35 = _m_punpckldq(_m_punpckhdq(v112, v112), v112);
  v36 = _m_punpckldq(_m_punpckhdq(v113, v113), v113);
  v134 = _m_pfacc(
           _m_pfsub(_m_pfmul(v35, v118), _m_pfmul(_m_pxor(v36, (__m64)0x80000000LL), v116)),
           _m_pfadd(_m_pxor(_m_pfmul(v112, v118), (__m64)0x80000000LL), _m_pfmul(v113, v116)));
  v136 = _m_pfacc(
           _m_pfadd(_m_pfmul(_m_pxor(v35, (__m64)0x80000000LL), v116), _m_pfmul(v36, v118)),
           _m_pfsub(_m_pfmul(_m_pxor(v113, (__m64)0x80000000LL), v118), _m_pfmul(v112, v116)));
  v37 = v126;
  v38 = v130;
  v39 = _m_punpckhdq(v130, v130);
  if ( !_mm_cvtsi64_si32(_m_pfcmpge(v39, (__m64)0x3F8000003F800000LL)) )
  {
    math_acos_packed(0, v12);
    v102 = _mm_cvtsi64_si32(v39);
    math_sin_packed();
    v12 = (__m64 *)m64_u64.m64_i32[1];
    v37 = v126;
    v38 = v130;
    if ( _mm_cvtsi64_si32(_m_pfcmpge(_m_pand(v39, (__m64)0x7FFFFFFF7FFFFFFFLL), (__m64)0x3400000034000000LL)) )
    {
      v40 = _mm_cvtsi32_si64(v102);
      v41 = _m_pfrcp(v39);
      v42 = _m_pfmul(_m_punpckldq(v40, v40), _m_pfrcpit2(_m_pfrcpit1(v39, v41), v41));
      v37 = _m_pfmul(v126, v42);
      v38 = _m_pfmul(v130, v42);
    }
  }
  v120 = v37;
  v122 = _m_pand(v38, (__m64)0xFFFFFFFFLL);
  v43 = v134;
  v44 = v136;
  v45 = _m_punpckhdq(v136, v136);
  if ( !_mm_cvtsi64_si32(_m_pfcmpge(v45, (__m64)0x3F8000003F800000LL)) )
  {
    math_acos_packed(0, v12);
    v103 = _mm_cvtsi64_si32(v45);
    math_sin_packed();
    v43 = v134;
    v44 = v136;
    if ( _mm_cvtsi64_si32(_m_pfcmpge(_m_pand(v45, (__m64)0x7FFFFFFF7FFFFFFFLL), (__m64)0x3400000034000000LL)) )
    {
      v46 = _mm_cvtsi32_si64(v103);
      v47 = _m_pfrcp(v45);
      v48 = _m_pfmul(_m_punpckldq(v46, v46), _m_pfrcpit2(_m_pfrcpit1(v45, v47), v47));
      v43 = _m_pfmul(v134, v48);
      v44 = _m_pfmul(v136, v48);
    }
  }
  v127 = _m_pfmul(_m_pfadd(v120, v43), (__m64)0xBE800000BE800000uLL);
  v131 = _m_pfmul(_m_pfadd(v122, _m_pand(v44, (__m64)0xFFFFFFFFLL)), (__m64)0xBE800000BE800000uLL).m64_u32[0];
  v49 = _mm_cvtsi32_si64(v131);
  v50 = _m_pfadd(_m_pfmul(v127, v127), _m_pfmul(v49, v49));
  v51 = _m_pfacc(v50, v50);
  v52 = _m_pfrsqrt(v51);
  v53 = _m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v52, v52), v51), v52);
  v104.m64_u64 = __PAIR64__(a1, _mm_cvtsi64_si32(v53));
  math_sincos_packed();
  v55 = _m_pfmul(v51, v53);
  v56 = _m_pfcmpge(_m_pand(v55, (__m64)0x7FFFFFFFFFFFFFFFLL), (__m64)0x3400000034000000LL);
  v57 = _mm_cvtsi64_si32(_m_punpckhdq(v56, v56));
  v58 = v127;
  v59 = v55;
  v60 = _m_pfmul(_m_punpckhdq(v55, v55), v104);
  v61 = _mm_cvtsi32_si64(v131);
  if ( (v57 & 1) != 0 )
  {
    v62 = _m_punpckldq(v60, v60);
    v61 = _m_pfmul(v61, v62);
    v58 = _m_pfmul(v127, v62);
  }
  v124 = _m_punpckldq(v61, v59);
  v63 = _m_punpckldq(_m_punpckhdq(v58, v58), v58);
  v64 = _m_punpckldq(_m_punpckhdq(v124, v124), v124);
  a2->m64_u64 = (unsigned __int64)_m_pfacc(
                                    _m_pfsub(_m_pfmul(v63, v111), _m_pfmul(_m_pxor(v64, (__m64)0x80000000LL), v110)),
                                    _m_pfadd(_m_pxor(_m_pfmul(v58, v111), (__m64)0x80000000LL), _m_pfmul(v124, v110)));
  a2[1].m64_u64 = (unsigned __int64)_m_pfacc(
                                      _m_pfadd(_m_pfmul(_m_pxor(v63, (__m64)0x80000000LL), v110), _m_pfmul(v64, v111)),
                                      _m_pfsub(_m_pfmul(_m_pxor(v124, (__m64)0x80000000LL), v111), _m_pfmul(v58, v110)));
  v65 = _m_pfadd(_m_pfmul(v112, v112), _m_pfmul(v113, v113));
  v66 = _m_pfacc(v65, v65);
  v67 = _m_pfrcp(v66);
  v68 = _m_pfcmpgt(v66, (__m64)0x80000000800000LL);
  v69 = _m_pfrcpit2(_m_pfrcpit1(v66, v67), v67);
  v117 = _m_pfmul(_m_pand(_m_pxor(v112, (__m64)0x8000000080000000uLL), v68), v69);
  v119 = _m_pfmul(_m_pand(_m_pxor(v113, (__m64)0x80000000LL), v68), v69);
  v70 = _m_punpckldq(_m_punpckhdq(v110, v110), v110);
  v71 = _m_punpckldq(_m_punpckhdq(v111, v111), v111);
  v128 = _m_pfacc(
           _m_pfsub(_m_pfmul(v70, v119), _m_pfmul(_m_pxor(v71, (__m64)0x80000000LL), v117)),
           _m_pfadd(_m_pxor(_m_pfmul(v110, v119), (__m64)0x80000000LL), _m_pfmul(v111, v117)));
  v132 = _m_pfacc(
           _m_pfadd(_m_pfmul(_m_pxor(v70, (__m64)0x80000000LL), v117), _m_pfmul(v71, v119)),
           _m_pfsub(_m_pfmul(_m_pxor(v111, (__m64)0x80000000LL), v119), _m_pfmul(v110, v117)));
  v72 = _m_punpckldq(_m_punpckhdq(v114, v114), v114);
  v73 = _m_punpckldq(_m_punpckhdq(v115, v115), v115);
  v135 = _m_pfacc(
           _m_pfsub(_m_pfmul(v72, v119), _m_pfmul(_m_pxor(v73, (__m64)0x80000000LL), v117)),
           _m_pfadd(_m_pxor(_m_pfmul(v114, v119), (__m64)0x80000000LL), _m_pfmul(v115, v117)));
  v137 = _m_pfacc(
           _m_pfadd(_m_pfmul(_m_pxor(v72, (__m64)0x80000000LL), v117), _m_pfmul(v73, v119)),
           _m_pfsub(_m_pfmul(_m_pxor(v115, (__m64)0x80000000LL), v119), _m_pfmul(v114, v117)));
  v74 = v128;
  v75 = v132;
  v76 = _m_punpckhdq(v132, v132);
  if ( !_mm_cvtsi64_si32(_m_pfcmpge(v76, (__m64)0x3F8000003F800000LL)) )
  {
    math_acos_packed(0, v54);
    v105 = _mm_cvtsi64_si32(v76);
    math_sin_packed();
    v54 = m64_u64.m64_i32[1];
    v74 = v128;
    v75 = v132;
    if ( _mm_cvtsi64_si32(_m_pfcmpge(_m_pand(v76, (__m64)0x7FFFFFFF7FFFFFFFLL), (__m64)0x3400000034000000LL)) )
    {
      v77 = _mm_cvtsi32_si64(v105);
      v78 = _m_pfrcp(v76);
      v79 = _m_pfmul(_m_punpckldq(v77, v77), _m_pfrcpit2(_m_pfrcpit1(v76, v78), v78));
      v74 = _m_pfmul(v128, v79);
      v75 = _m_pfmul(v132, v79);
    }
  }
  v121 = v74;
  v123 = _m_pand(v75, (__m64)0xFFFFFFFFLL);
  v80 = v135;
  v81 = v137;
  v82 = _m_punpckhdq(v137, v137);
  if ( !_mm_cvtsi64_si32(_m_pfcmpge(v82, (__m64)0x3F8000003F800000LL)) )
  {
    math_acos_packed(0, v54);
    v106 = _mm_cvtsi64_si32(v82);
    math_sin_packed();
    v80 = v135;
    v81 = v137;
    if ( _mm_cvtsi64_si32(_m_pfcmpge(_m_pand(v82, (__m64)0x7FFFFFFF7FFFFFFFLL), (__m64)0x3400000034000000LL)) )
    {
      v83 = _mm_cvtsi32_si64(v106);
      v84 = _m_pfrcp(v82);
      v85 = _m_pfmul(_m_punpckldq(v83, v83), _m_pfrcpit2(_m_pfrcpit1(v82, v84), v84));
      v80 = _m_pfmul(v135, v85);
      v81 = _m_pfmul(v137, v85);
    }
  }
  v129 = _m_pfmul(_m_pfadd(v121, v80), (__m64)0xBE800000BE800000uLL);
  v133 = _m_pfmul(_m_pfadd(v123, _m_pand(v81, (__m64)0xFFFFFFFFLL)), (__m64)0xBE800000BE800000uLL).m64_u32[0];
  v86 = _mm_cvtsi32_si64(v133);
  v87 = _m_pfadd(_m_pfmul(v129, v129), _m_pfmul(v86, v86));
  v88 = _m_pfacc(v87, v87);
  v89 = _m_pfrsqrt(v88);
  v90 = _m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v89, v89), v88), v89);
  v107.m64_u64 = __PAIR64__(v104.m64_u32[1], _mm_cvtsi64_si32(v90));
  math_sincos_packed();
  v91 = _m_pfmul(v88, v90);
  v92 = _m_pfcmpge(_m_pand(v91, (__m64)0x7FFFFFFFFFFFFFFFLL), (__m64)0x3400000034000000LL);
  v93 = _mm_cvtsi64_si32(_m_punpckhdq(v92, v92));
  v94 = v129;
  v95 = v91;
  v96 = _m_pfmul(_m_punpckhdq(v91, v91), v107);
  v97 = _mm_cvtsi32_si64(v133);
  if ( (v93 & 1) != 0 )
  {
    v98 = _m_punpckldq(v96, v96);
    v97 = _m_pfmul(v97, v98);
    v94 = _m_pfmul(v129, v98);
  }
  v125 = _m_punpckldq(v97, v95);
  v99 = _m_punpckldq(_m_punpckhdq(v94, v94), v94);
  v100 = _m_punpckldq(_m_punpckhdq(v125, v125), v125);
  a3->m64_u64 = (unsigned __int64)_m_pfacc(
                                    _m_pfsub(_m_pfmul(v99, v113), _m_pfmul(_m_pxor(v100, (__m64)0x80000000LL), v112)),
                                    _m_pfadd(_m_pxor(_m_pfmul(v94, v113), (__m64)0x80000000LL), _m_pfmul(v125, v112)));
  a3[1].m64_u64 = (unsigned __int64)_m_pfacc(
                                      _m_pfadd(_m_pfmul(_m_pxor(v99, (__m64)0x80000000LL), v112), _m_pfmul(v100, v113)),
                                      _m_pfsub(_m_pfmul(_m_pxor(v125, (__m64)0x80000000LL), v113), _m_pfmul(v94, v112)));
  a4->m64_u64 = (unsigned __int64)v112;
  a4[1].m64_u64 = (unsigned __int64)v113;
  _m_femms();
  return a4;
}

// sub_45A9AA @ 0x0045A9AA
__m64 *__stdcall sub_45A9AA(__m64 *a1, __m64 *a2, __m64 *a3)
{
  __m64 v3; // mm1
  __m64 v4; // mm4
  __m64 v5; // mm5
  __m64 v6; // mm7
  __m64 v7; // mm1
  __m64 v8; // mm6
  __m64 v9; // mm4
  __m64 v10; // mm2
  __m64 v12; // mm5
  __m64 v13; // mm4
  __m64 v14; // mm4
  __m64 v15; // mm5
  __m64 v16; // mm4
  __m64 v17; // mm5
  __m64 v18; // mm4
  __m64 v19; // mm5
  __m64 v20; // [esp+0h] [ebp-44h]
  __m64 v21; // [esp+8h] [ebp-3Ch]
  __m64 v22; // [esp+10h] [ebp-34h]
  __m64 v23; // [esp+18h] [ebp-2Ch]
  __m64 v24; // [esp+28h] [ebp-1Ch]
  __m64 v25; // [esp+30h] [ebp-14h]
  __m64 v26; // [esp+38h] [ebp-Ch]

  _m_femms();
  v3 = a3[2];
  v4 = a3[7];
  v5 = a3[5];
  v20 = _m_punpckldq((__m64)a3->m64_u64, v3);
  v22 = _m_punpckhdq((__m64)a3->m64_u64, v3);
  v6 = a3[3];
  v7 = a3[1];
  v24 = _m_punpckldq(v5, v4);
  v26 = _m_punpckhdq(v5, v4);
  v8 = _m_punpckldq(v7, v6);
  v9 = a3[6];
  v10 = a3[4];
  v25 = _m_punpckhdq(v7, v6);
  v23 = _m_punpckhdq(v10, v9);
  v21 = _m_punpckldq(v10, v9);
  v12 = a2[1];
  v13 = _m_pfadd(
          _m_pfacc(_m_pfmul((__m64)a2->m64_u64, v8), _m_pfmul((__m64)a2->m64_u64, v25)),
          _m_pfacc(_m_pfmul(v12, v24), _m_pfmul(v12, v26)));
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfacc(_m_pfmul((__m64)a2->m64_u64, v20), _m_pfmul((__m64)a2->m64_u64, v22)),
                                    _m_pfacc(_m_pfmul(v12, v21), _m_pfmul(v12, v23)));
  a1[1].m64_u64 = (unsigned __int64)v13;
  v14 = a2[2];
  v15 = a2[3];
  a1[2].m64_u64 = (unsigned __int64)_m_pfadd(
                                      _m_pfacc(_m_pfmul(v14, v20), _m_pfmul(v14, v22)),
                                      _m_pfacc(_m_pfmul(v15, v21), _m_pfmul(v15, v23)));
  a1[3].m64_u64 = (unsigned __int64)_m_pfadd(
                                      _m_pfacc(_m_pfmul(v14, v8), _m_pfmul(v14, v25)),
                                      _m_pfacc(_m_pfmul(v15, v24), _m_pfmul(v15, v26)));
  v16 = a2[4];
  v17 = a2[5];
  a1[4].m64_u64 = (unsigned __int64)_m_pfadd(
                                      _m_pfacc(_m_pfmul(v16, v20), _m_pfmul(v16, v22)),
                                      _m_pfacc(_m_pfmul(v17, v21), _m_pfmul(v17, v23)));
  a1[5].m64_u64 = (unsigned __int64)_m_pfadd(
                                      _m_pfacc(_m_pfmul(v16, v8), _m_pfmul(v16, v25)),
                                      _m_pfacc(_m_pfmul(v17, v24), _m_pfmul(v17, v26)));
  v18 = a2[6];
  v19 = a2[7];
  a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                      _m_pfacc(_m_pfmul(v18, v20), _m_pfmul(v18, v22)),
                                      _m_pfacc(_m_pfmul(v19, v21), _m_pfmul(v19, v23)));
  a1[7].m64_u64 = (unsigned __int64)_m_pfadd(
                                      _m_pfacc(_m_pfmul(v18, v8), _m_pfmul(v18, v25)),
                                      _m_pfacc(_m_pfmul(v19, v24), _m_pfmul(v19, v26)));
  _m_femms();
  return a1;
}

// sub_45ABDC @ 0x0045ABDC
double __stdcall sub_45ABDC(unsigned int *a1)
{
  __m64 v1; // mm0
  __m64 v2; // mm3
  __m64 v3; // mm4
  __m64 v4; // mm2
  __m64 v5; // mm3
  __m64 v6; // mm4

  v1 = *(__m64 *)(a1 + 9);
  v2 = *(__m64 *)(a1 + 13);
  v3 = _m_pfsub(
         _m_pfmul(_m_punpckhdq(*((__m64 *)a1 + 7), *((__m64 *)a1 + 7)), v1),
         _m_pfmul(_m_punpckhdq(*((__m64 *)a1 + 5), *((__m64 *)a1 + 5)), v2));
  v4 = _m_pfsub(
         _m_pfmul(_m_punpckldq(*((__m64 *)a1 + 4), *((__m64 *)a1 + 4)), *((__m64 *)a1 + 7)),
         _m_pfmul(_m_punpckldq(*((__m64 *)a1 + 6), *((__m64 *)a1 + 6)), *((__m64 *)a1 + 5)));
  v5 = _m_pfsub(_m_pfmul(v2, *((__m64 *)a1 + 4)), _m_pfmul(v1, *((__m64 *)a1 + 6)));
  v6 = _m_pfsub(
         _m_pfmul(
           _m_pfsub(
             _m_pfadd(
               _m_pfmul(v3, *((__m64 *)a1 + 2)),
               _m_pfmul(v5, _m_punpckhdq(*((__m64 *)a1 + 3), *((__m64 *)a1 + 3)))),
             _m_pfmul(_m_punpckldq(_m_punpckhdq(v4, v4), v3), *(__m64 *)(a1 + 5))),
           _m_punpckldq(*((__m64 *)a1 + 1), (__m64)*a1)),
         _m_pfmul(
           _m_pfsub(
             _m_pfadd(
               _m_pfmul(_m_punpckhdq(v5, v3), _m_punpckldq(*((__m64 *)a1 + 2), *((__m64 *)a1 + 2))),
               _m_pfmul(_m_punpckldq(v5, v4), *((__m64 *)a1 + 3))),
             _m_pfmul(v4, *(__m64 *)(a1 + 5))),
           _m_punpckhdq(*((__m64 *)a1 + 1), *(__m64 *)a1)));
  _m_femms();
  return COERCE_FLOAT(_mm_cvtsi64_si32(_m_pfacc(v6, v6)));
}

// sub_45ACAB @ 0x0045ACAB
__m64 *__stdcall sub_45ACAB(__m64 *a1, unsigned int a2, unsigned int a3, unsigned int a4)
{
  _m_femms();
  a1->m64_u64 = 1065353216;
  a1[1].m64_u64 = 0;
  a1[2].m64_u64 = 0x3F80000000000000LL;
  a1[3].m64_u64 = 0;
  a1[4].m64_u64 = 0;
  a1[5].m64_u64 = 1065353216;
  a1[6].m64_u64 = (unsigned __int64)_m_punpckldq(_mm_cvtsi32_si64(a2), _mm_cvtsi32_si64(a3));
  a1[7].m64_u64 = (unsigned __int64)_m_punpckldq(_mm_cvtsi32_si64(a4), (__m64)1065353216LL);
  _m_femms();
  return a1;
}

// sub_45ACFB @ 0x0045ACFB
__m64 *__stdcall sub_45ACFB(__m64 *a1, __m64 *a2, int a3)
{
  __m64 m64_u64; // mm6
  __m64 v5; // mm7
  __m64 v6; // mm3
  __m64 v7; // mm1
  __m64 v8; // mm0
  __m64 v9; // mm2
  __m64 v10; // mm1
  __m64 v11; // mm3
  __m64 v12; // mm1
  __m64 v13; // mm3
  __m64 v14; // [esp+0h] [ebp-14h] BYREF
  __m64 v15; // [esp+8h] [ebp-Ch]

  _m_femms();
  sub_45FAE8((int)&v14, a3);
  m64_u64 = (__m64)a2->m64_u64;
  v5 = a2[1];
  v6 = _m_pfmul(v5, v15);
  v7 = _m_pfadd(_m_pfmul((__m64)a2->m64_u64, v14), v6);
  v8 = _m_pxor(v14, (__m64)0x8000000080000000uLL);
  v9 = _m_pxor(v15, (__m64)0x8000000080000000uLL);
  v10 = _m_pfacc(v7, v7);
  v11 = _m_punpckldq(v6, v10);
  v12 = _m_psllqi(v10, 0x20u);
  v13 = _m_psrlqi(v11, 0x20u);
  a1->m64_u64 = (unsigned __int64)_m_pfadd(_m_pfmul(_m_punpckldq(v8, v8), (__m64)a2->m64_u64), v13);
  a1[1].m64_u64 = (unsigned __int64)_m_pfmul(_m_punpckldq(v8, v8), v5);
  a1[2].m64_u64 = (unsigned __int64)_m_pfadd(_m_pfmul(_m_punpckhdq(v8, v8), m64_u64), v12);
  a1[3].m64_u64 = (unsigned __int64)_m_pfmul(_m_punpckhdq(v8, v8), v5);
  a1[4].m64_u64 = (unsigned __int64)_m_pfmul(_m_punpckldq(v9, v9), m64_u64);
  a1[5].m64_u64 = (unsigned __int64)_m_pfadd(_m_pfmul(_m_punpckldq(v9, v9), v5), v13);
  a1[6].m64_u64 = (unsigned __int64)_m_pfmul(_m_punpckhdq(v9, v9), m64_u64);
  a1[7].m64_u64 = (unsigned __int64)_m_pfadd(_m_pfmul(_m_punpckhdq(v9, v9), v5), v12);
  _m_femms();
  return a1;
}

// sub_45ADE6 @ 0x0045ADE6
__m64 *__stdcall sub_45ADE6(__m64 *a1, int a2)
{
  __m64 v3; // mm3
  __m64 v4; // mm0
  __m64 v5; // mm1
  __m64 v6; // mm6
  __m64 v7; // mm4
  __m64 v8; // mm6
  __m64 v9; // mm4
  __m64 v10; // mm6
  __m64 v11; // [esp+0h] [ebp-14h] BYREF
  __m64 v12; // [esp+8h] [ebp-Ch]

  _m_femms();
  sub_45FAE8((int)&v11, a2);
  v3 = v12;
  v4 = _m_pfmul(v11, (__m64)0xC0000000C0000000uLL);
  v5 = _m_pfmul(v12, (__m64)0x3F800000C0000000LL);
  v6 = v11;
  v7 = _m_punpckldq(v6, v6);
  v8 = _m_punpckhdq(v6, v6);
  a1->m64_u64 = (unsigned __int64)_m_pfadd(_m_pfmul(v7, v4), (__m64)1065353216LL);
  a1[1].m64_u64 = (unsigned __int64)_m_pfmul(_m_psrlqi(v7, 0x20u), v5);
  a1[2].m64_u64 = (unsigned __int64)_m_pfadd(_m_pfmul(v8, v4), (__m64)0x3F80000000000000LL);
  a1[3].m64_u64 = (unsigned __int64)_m_pfmul(_m_psrlqi(v8, 0x20u), v5);
  v9 = _m_punpckldq(v3, v3);
  v10 = _m_punpckhdq(v3, v3);
  a1[4].m64_u64 = (unsigned __int64)_m_pfmul(v9, v4);
  a1[5].m64_u64 = (unsigned __int64)_m_pfadd(_m_pfmul(_m_psrlqi(v9, 0x20u), v5), (__m64)1065353216LL);
  a1[6].m64_u64 = (unsigned __int64)_m_pfmul(v10, v4);
  a1[7].m64_u64 = (unsigned __int64)_m_pfadd(_m_pfmul(_m_psrlqi(v10, 0x20u), v5), (__m64)0x3F80000000000000LL);
  _m_femms();
  return a1;
}

// sub_45AEC2 @ 0x0045AEC2
__m64 *__stdcall sub_45AEC2(__m64 *a1, unsigned int a2)
{
  __m64 v2; // mm0
  __m64 v4; // mm4

  _m_femms();
  v2 = _mm_cvtsi32_si64(a2);
  math_sincos_packed();
  v4 = _m_psrlqi(v2, 0x20u);
  a1->m64_u64 = 1065353216;
  a1[1].m64_u64 = 0;
  a1[2].m64_i32[0] = _mm_cvtsi64_si32(0);
  a1[2].m64_i32[1] = _mm_cvtsi64_si32(v2);
  a1[3].m64_u64 = (unsigned __int64)v4;
  a1[6].m64_u64 = 0;
  a1[7].m64_u64 = 0x3F80000000000000LL;
  a1[4].m64_i32[0] = _mm_cvtsi64_si32(0);
  a1[4].m64_i32[1] = _mm_cvtsi64_si32(_m_pxor(v4, (__m64)0x80000000LL));
  a1[5].m64_i32[0] = _mm_cvtsi64_si32(v2);
  a1[5].m64_i32[1] = _mm_cvtsi64_si32(0);
  _m_femms();
  return a1;
}

// sub_45AF25 @ 0x0045AF25
__m64 *__stdcall sub_45AF25(__m64 *a1, unsigned int a2)
{
  __m64 v3; // mm4
  __m64 v4; // mm0
  __m64 v5; // mm4

  _m_femms();
  math_sincos_packed();
  v3 = _mm_cvtsi32_si64(a2);
  v4 = _m_pand(v3, (__m64)0xFFFFFFFFLL);
  v5 = _m_psrlqi(v3, 0x20u);
  a1[2].m64_u64 = 0x3F80000000000000LL;
  a1[3].m64_u64 = 0;
  a1[6].m64_u64 = 0;
  a1[7].m64_u64 = 0x3F80000000000000LL;
  a1[4].m64_u64 = (unsigned __int64)v5;
  a1->m64_u64 = (unsigned __int64)v4;
  a1[5].m64_u64 = (unsigned __int64)v4;
  a1[1].m64_u64 = (unsigned __int64)_m_pxor(v5, (__m64)0x80000000LL);
  _m_femms();
  return a1;
}

// sub_45AF83 @ 0x0045AF83
__m64 *__stdcall sub_45AF83(__m64 *a1, unsigned int a2)
{
  __m64 v2; // mm0

  _m_femms();
  v2 = _mm_cvtsi32_si64(a2);
  math_sincos_packed();
  a1->m64_u64 = (unsigned __int64)v2;
  a1[1].m64_u64 = 0;
  a1[3].m64_u64 = 0;
  a1[4].m64_u64 = 0;
  a1[5].m64_u64 = 1065353216;
  a1[6].m64_u64 = 0;
  a1[7].m64_u64 = 0x3F80000000000000LL;
  a1[2].m64_u64 = (unsigned __int64)_m_pxor(_m_punpckldq(_m_punpckhdq(v2, v2), v2), (__m64)0x80000000LL);
  _m_femms();
  return a1;
}

// sub_45AFDC @ 0x0045AFDC
__m64 *__stdcall sub_45AFDC(__m64 *a1, unsigned int a2, unsigned int a3, unsigned int a4)
{
  _m_femms();
  a1->m64_u64 = (unsigned __int64)_mm_cvtsi32_si64(a2);
  a1[1].m64_u64 = 0;
  a1[3].m64_u64 = 0;
  a1[4].m64_u64 = 0;
  a1[6].m64_u64 = 0;
  a1[2].m64_u64 = (unsigned __int64)_m_psllqi(_mm_cvtsi32_si64(a3), 0x20u);
  a1[5].m64_u64 = (unsigned __int64)_mm_cvtsi32_si64(a4);
  a1[7].m64_u64 = 0x3F80000000000000LL;
  _m_femms();
  return a1;
}

// sub_45B023 @ 0x0045B023
__m64 *__stdcall sub_45B023(__m64 *a1, __m64 *a2)
{
  __m64 v2; // mm1
  __m64 v3; // mm4
  __m64 v5; // mm2
  __m64 v6; // mm5
  __m64 v7; // mm7
  __m64 v8; // mm0
  __m64 v9; // mm1
  __m64 v10; // mm4

  v2 = a2[2];
  v3 = a2[7];
  v5 = _m_punpckhdq((__m64)a2->m64_u64, v2);
  v6 = a2[5];
  a1->m64_u64 = (unsigned __int64)_m_punpckldq((__m64)a2->m64_u64, v2);
  a1[2].m64_u64 = (unsigned __int64)v5;
  v7 = a2[3];
  v8 = a2[4];
  v9 = a2[1];
  a1[5].m64_u64 = (unsigned __int64)_m_punpckldq(v6, v3);
  a1[7].m64_u64 = (unsigned __int64)_m_punpckhdq(v6, v3);
  v10 = a2[6];
  a1[4].m64_u64 = (unsigned __int64)_m_punpckldq(v9, v7);
  a1[6].m64_u64 = (unsigned __int64)_m_punpckhdq(v9, v7);
  a1[3].m64_u64 = (unsigned __int64)_m_punpckhdq(v8, v10);
  a1[1].m64_u64 = (unsigned __int64)_m_punpckldq(v8, v10);
  _m_femms();
  return a1;
}

// sub_45B092 @ 0x0045B092
__m64 *__cdecl sub_45B092(__m64 *a1)
{
  __m64 v1; // mm1
  __m64 v3; // mm2

  v1 = _mm_cvtsi32_si64(0x3F800000u);
  a1->m64_u64 = (unsigned __int64)v1;
  a1[1].m64_u64 = 0;
  a1[3].m64_u64 = 0;
  a1[4].m64_u64 = 0;
  a1[5].m64_u64 = (unsigned __int64)v1;
  v3 = _m_punpckldq(_m_punpckhdq(v1, v1), v1);
  a1[6].m64_u64 = 0;
  a1[2].m64_u64 = (unsigned __int64)v3;
  a1[7].m64_u64 = (unsigned __int64)v3;
  _m_femms();
  return a1;
}

// sub_45B0CB @ 0x0045B0CB
__m64 *__stdcall sub_45B0CB(__m64 *a1, __m64 *a2)
{
  __m64 m64_u64; // mm3
  __m64 v4; // mm0
  __m64 v5; // mm7
  __m64 v6; // mm2
  __m64 v7; // mm4
  __m64 v8; // mm3
  __m64 v9; // mm1
  __m64 v10; // mm5
  __m64 v11; // mm7
  __m64 v12; // mm6
  __m64 v13; // mm2
  __m64 v14; // mm1
  __m64 v15; // mm6
  __m64 v16; // mm7
  __m64 v17; // mm3
  __m64 v18; // mm2
  __m64 v19; // mm3
  __m64 v20; // mm5
  __m64 v21; // mm6

  m64_u64 = (__m64)a2->m64_u64;
  v4 = _m_pfadd(m64_u64, m64_u64);
  v5 = a2[1];
  v6 = _m_punpckhdq(m64_u64, m64_u64);
  v7 = _m_punpckhdq(v5, v5);
  v8 = _m_pfmul((__m64)a2->m64_u64, v4);
  v9 = _m_punpckldq(_m_pfadd(v5, v5), v4);
  v10 = _m_pfmul(v4, v7);
  v11 = _m_pfmul(_m_punpckldq(v5, v5), v9);
  v12 = _m_pfmul(v9, v7);
  v13 = _m_pfmul(v9, v6);
  v14 = _m_punpckhdq(v13, v11);
  a1[6].m64_u64 = 0;
  v15 = _m_punpckhdq(_m_punpckldq(v12, v12), v10);
  v16 = _m_pfsubr(_m_pfadd(_m_punpckldq(v11, v11), v8), (__m64)0x3F8000003F800000LL);
  a1[5].m64_u64 = (unsigned __int64)_m_punpckldq(_m_pfsubr(_m_pfacc(v8, v8), (__m64)0x3F8000003F800000LL), 0);
  v17 = v13;
  v18 = _m_pfadd(v13, v10);
  v19 = _m_pfsub(v17, v10);
  v20 = _m_pfsub(v14, v15);
  v21 = _m_pfadd(v14, v15);
  a1[3].m64_u64 = (unsigned __int64)_m_punpckldq(v18, 0);
  a1[1].m64_u64 = (unsigned __int64)_m_punpckhdq(v20, 0);
  a1[2].m64_u64 = (unsigned __int64)_m_punpckldq(v20, v16);
  a1->m64_u64 = (unsigned __int64)_m_punpckhdq(v16, _m_punpckldq(v21, v21));
  a1[4].m64_u64 = (unsigned __int64)_m_punpckldq(_m_punpckhdq(v21, v21), v19);
  a1[7].m64_u64 = (unsigned __int64)_m_punpckldq(0, (__m64)1065353216LL);
  _m_femms();
  return a1;
}

// sub_45B19D @ 0x0045B19D
__m64 *__stdcall sub_45B19D(__m64 *a1, __m64 *a2)
{
  __m64 v3; // mm4
  __m64 v4; // mm1
  __m64 v5; // mm5
  __m64 v6; // mm0
  __m64 v7; // mm5
  __m64 v8; // mm2
  __m64 v9; // mm3
  __m64 v10; // mm1
  __m64 v11; // mm6
  __m64 v12; // mm3
  __m64 v13; // mm6
  __m64 v14; // mm2
  __m64 v15; // mm1

  v3 = a2[1];
  v4 = _m_pfadd(v3, v3);
  v5 = _m_pfadd((__m64)a2->m64_u64, (__m64)a2->m64_u64);
  v6 = _m_pfmul(v5, (__m64)a2->m64_u64);
  v7 = _m_punpckldq(v5, v4);
  v8 = _m_pfmul((__m64)a2->m64_u64, v4);
  v9 = _m_pfmul(_m_pswapd((__m64)a2->m64_u64), v4);
  v10 = _m_pfmul(v4, v3);
  v11 = _m_pfmul(_m_punpckhdq((__m64)a2->m64_u64, v3), v7);
  v12 = _m_pfpnacc(v9, v9);
  v13 = _m_pfpnacc(v11, v11);
  v14 = _m_pfpnacc(v8, v8);
  v15 = _m_pfsub(_m_pfsubr(v6, (__m64)0x3F8000003F800000LL), _m_punpckldq(v10, v10));
  a1[6].m64_u64 = 0;
  a1[4].m64_u64 = (unsigned __int64)_m_punpckldq(_m_pswapd(v14), v12);
  a1[1].m64_u64 = (unsigned __int64)_m_punpckldq(v14, 0);
  a1[5].m64_u64 = (unsigned __int64)_m_punpckhdq(_m_pfsubr(_m_pfacc(v6, v6), (__m64)0x3F8000003F800000LL), 0);
  a1->m64_u64 = (unsigned __int64)_m_punpckhdq(v15, v13);
  a1[2].m64_u64 = (unsigned __int64)_m_punpckldq(v13, v15);
  a1[3].m64_u64 = (unsigned __int64)_m_punpckhdq(v12, 0);
  a1[7].m64_u64 = (unsigned __int64)_m_punpckldq(0, (__m64)1065353216LL);
  _m_femms();
  return a1;
}

// sub_45B252 @ 0x0045B252
__m64 *__stdcall sub_45B252(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, __m64 *a5, __m64 *a6, __m64 *a7)
{
  __m64 *result; // eax
  __m64 m64_u64; // mm3
  __m64 v9; // mm0
  __m64 v10; // mm7
  __m64 v11; // mm2
  __m64 v12; // mm4
  __m64 v13; // mm3
  __m64 v14; // mm1
  __m64 v15; // mm5
  __m64 v16; // mm7
  __m64 v17; // mm6
  __m64 v18; // mm2
  __m64 v19; // mm1
  __m64 v20; // mm6
  __m64 v21; // mm7
  __m64 v22; // mm3
  __m64 v23; // mm2
  __m64 v24; // mm3
  __m64 v25; // mm5
  __m64 v26; // mm6
  __m64 v27; // mm3
  __m64 v28; // mm4
  __m64 v29; // mm1
  __m64 v30; // mm2
  __m64 v31; // mm2
  __m64 v32; // mm1
  __m64 v33; // mm2
  __m64 v34; // mm3
  __m64 v35; // mm0
  __m64 v36; // mm1
  __m64 v37; // mm2
  __m64 v38; // mm5
  __m64 v39; // mm3
  __m64 v40; // mm2
  __m64 v41; // mm7
  __m64 v42; // mm0
  __m64 v43; // mm3
  __m64 v44; // mm1
  __m64 v45; // mm2
  __m64 v46; // mm3
  __m64 v47; // mm0
  __m64 v48; // mm1
  __m64 v49; // mm2
  __m64 v50; // mm5
  __m64 v51; // mm3
  __m64 v52; // mm2
  __m64 v53; // mm7
  __m64 v54; // mm0
  __m64 v55; // mm3
  __m64 v56; // mm1
  __m64 v57; // mm2
  __m64 v58; // mm3
  __m64 v59; // mm0
  __m64 v60; // mm1
  __m64 v61; // mm2
  __m64 v62; // mm5
  __m64 v63; // mm3
  __m64 v64; // mm2
  __m64 v65; // mm7
  __m64 v66; // mm0
  __m64 v67; // mm3
  __m64 v68; // mm1
  __m64 v69; // mm2
  __m64 v70; // mm3
  __m64 v71; // mm0
  __m64 v72; // mm1
  __m64 v73; // mm2
  __m64 v74; // mm5
  __m64 v75; // mm3
  __m64 v76; // mm7
  __m64 v77; // mm2
  __m64 v78; // mm3
  __m64 v79; // mm1
  __m64 v80; // mm2
  __m64 v81; // mm3
  __m64 v82; // mm0
  __m64 v83; // mm1
  __m64 v84; // mm2
  __m64 v85; // mm5
  __m64 v86; // mm3
  __m64 v87; // mm2
  __m64 v88; // mm7
  __m64 v89; // mm0
  __m64 v90; // mm3
  __m64 v91; // mm1
  __m64 v92; // mm2
  __m64 v93; // mm3
  __m64 v94; // mm0
  __m64 v95; // mm1
  __m64 v96; // mm2
  __m64 v97; // mm5
  __m64 v98; // mm3
  __m64 v99; // mm2
  __m64 v100; // mm7
  __m64 v101; // mm0
  __m64 v102; // mm3
  __m64 v103; // mm1
  __m64 v104; // mm2
  __m64 v105; // mm3
  __m64 v106; // mm0
  __m64 v107; // mm1
  __m64 v108; // mm2
  __m64 v109; // mm5
  __m64 v110; // mm3
  __m64 v111; // mm2
  __m64 v112; // mm7
  __m64 v113; // mm0
  __m64 v114; // mm3
  __m64 v115; // mm1
  __m64 v116; // mm2
  __m64 v117; // mm3
  __m64 v118; // mm0
  __m64 v119; // mm1
  __m64 v120; // mm2
  __m64 v121; // mm5
  __m64 v122; // mm3
  __m64 v123; // mm7
  __m64 v124; // mm2
  __m64 v125; // mm3
  __m64 v126; // mm1
  __m64 v127; // mm2
  __m64 v128; // mm3
  __m64 v129; // mm0
  __m64 v130; // mm1
  __m64 v131; // mm2
  __m64 v132; // mm5
  __m64 v133; // mm3
  __m64 v134; // mm2
  __m64 v135; // mm7
  __m64 v136; // mm0
  __m64 v137; // mm3
  __m64 v138; // mm1
  __m64 v139; // mm2
  __m64 v140; // mm3
  __m64 v141; // mm0
  __m64 v142; // mm1
  __m64 v143; // mm2
  __m64 v144; // mm5
  __m64 v145; // mm3
  __m64 v146; // mm2
  __m64 v147; // mm7
  __m64 v148; // mm0
  __m64 v149; // mm3
  __m64 v150; // mm1
  __m64 v151; // mm2
  __m64 v152; // mm3
  __m64 v153; // mm0
  __m64 v154; // mm1
  __m64 v155; // mm2
  __m64 v156; // mm5
  __m64 v157; // mm3
  __m64 v158; // mm2
  __m64 v159; // mm7
  __m64 v160; // mm0
  __m64 v161; // mm3
  __m64 v162; // mm1
  __m64 v163; // mm2
  __m64 v164; // mm3
  __m64 v165; // mm0
  __m64 v166; // mm1
  __m64 v167; // mm2
  __m64 v168; // mm3
  __m64 v169; // mm2
  __m64 v170; // mm3
  __m64 v171; // mm2
  __m64 v172; // mm1
  __m64 v173; // mm2
  __m64 v174; // mm3
  __m64 v175; // mm0
  __m64 v176; // mm1
  __m64 v177; // mm2
  __m64 v178; // mm5
  __m64 v179; // mm3
  __m64 v180; // mm2
  __m64 v181; // mm7
  __m64 v182; // mm0
  __m64 v183; // mm3
  __m64 v184; // mm1
  __m64 v185; // mm2
  __m64 v186; // mm3
  __m64 v187; // mm0
  __m64 v188; // mm1
  __m64 v189; // mm2
  __m64 v190; // mm5
  __m64 v191; // mm3
  __m64 v192; // mm2
  __m64 v193; // mm7
  __m64 v194; // mm0
  __m64 v195; // mm3
  __m64 v196; // mm1
  __m64 v197; // mm2
  __m64 v198; // mm3
  __m64 v199; // mm0
  __m64 v200; // mm1
  __m64 v201; // mm2
  __m64 v202; // mm5
  __m64 v203; // mm3
  __m64 v204; // mm2
  __m64 v205; // mm7
  __m64 v206; // mm0
  __m64 v207; // mm3
  __m64 v208; // mm1
  __m64 v209; // mm2
  __m64 v210; // mm3
  __m64 v211; // mm0
  __m64 v212; // mm1
  __m64 v213; // mm2
  __m64 v214; // mm5
  __m64 v215; // mm3
  __m64 v216; // mm7
  __m64 v217; // mm2
  __m64 v218; // mm3
  __m64 v219; // mm1
  __m64 v220; // mm2
  __m64 v221; // mm3
  __m64 v222; // mm0
  __m64 v223; // mm1
  __m64 v224; // mm2
  __m64 v225; // mm5
  __m64 v226; // mm3
  __m64 v227; // mm2
  __m64 v228; // mm7
  __m64 v229; // mm0
  __m64 v230; // mm3
  __m64 v231; // mm1
  __m64 v232; // mm2
  __m64 v233; // mm3
  __m64 v234; // mm0
  __m64 v235; // mm1
  __m64 v236; // mm2
  __m64 v237; // mm5
  __m64 v238; // mm3
  __m64 v239; // mm2
  __m64 v240; // mm7
  __m64 v241; // mm0
  __m64 v242; // mm3
  __m64 v243; // mm1
  __m64 v244; // mm2
  __m64 v245; // mm3
  __m64 v246; // mm0
  __m64 v247; // mm1
  __m64 v248; // mm2
  __m64 v249; // mm5
  __m64 v250; // mm3
  __m64 v251; // mm2
  __m64 v252; // mm7
  __m64 v253; // mm0
  __m64 v254; // mm3
  __m64 v255; // mm1
  __m64 v256; // mm2
  __m64 v257; // mm3
  __m64 v258; // mm0
  __m64 v259; // mm1
  __m64 v260; // mm2
  __m64 v261; // mm3
  __m64 v262; // mm4
  __m64 v263; // mm5
  __m64 v264; // mm1
  __m64 v265; // mm2
  __m64 v266; // mm3
  __m64 v267; // mm0
  __m64 v268; // mm7
  __m64 v269; // mm2
  __m64 v270; // mm4
  __m64 v271; // mm3
  __m64 v272; // mm1
  __m64 v273; // mm5
  __m64 v274; // mm7
  __m64 v275; // mm6
  __m64 v276; // mm2
  __m64 v277; // mm1
  __m64 v278; // mm6
  __m64 v279; // mm7
  __m64 v280; // mm3
  __m64 v281; // mm2
  __m64 v282; // mm3
  __m64 v283; // mm5
  __m64 v284; // mm2
  __m64 v285; // mm6
  __m64 v286; // mm2
  __m64 v287; // mm3
  __m64 v288; // mm1
  __m64 v289; // mm1
  __m64 v290; // mm2
  __m64 v291; // mm3
  __m64 v292; // mm0
  __m64 v293; // mm1
  __m64 v294; // mm2
  __m64 v295; // mm5
  __m64 v296; // mm3
  __m64 v297; // mm2
  __m64 v298; // mm7
  __m64 v299; // mm0
  __m64 v300; // mm3
  __m64 v301; // mm1
  __m64 v302; // mm2
  __m64 v303; // mm3
  __m64 v304; // mm0
  __m64 v305; // mm1
  __m64 v306; // mm2
  __m64 v307; // mm5
  __m64 v308; // mm3
  __m64 v309; // mm2
  __m64 v310; // mm7
  __m64 v311; // mm0
  __m64 v312; // mm3
  __m64 v313; // mm1
  __m64 v314; // mm2
  __m64 v315; // mm3
  __m64 v316; // mm0
  __m64 v317; // mm1
  __m64 v318; // mm2
  __m64 v319; // mm5
  __m64 v320; // mm3
  __m64 v321; // mm2
  __m64 v322; // mm7
  __m64 v323; // mm0
  __m64 v324; // mm3
  __m64 v325; // mm1
  __m64 v326; // mm2
  __m64 v327; // mm3
  __m64 v328; // mm0
  __m64 v329; // mm1
  __m64 v330; // mm2
  __m64 v331; // mm3
  __m64 v332; // mm1
  __m64 v333; // mm1
  __m64 v334; // mm2
  __m64 v335; // mm3
  __m64 v336; // mm0
  __m64 v337; // mm1
  __m64 v338; // mm2
  __m64 v339; // mm5
  __m64 v340; // mm3
  __m64 v341; // mm2
  __m64 v342; // mm7
  __m64 v343; // mm0
  __m64 v344; // mm3
  __m64 v345; // mm1
  __m64 v346; // mm2
  __m64 v347; // mm3
  __m64 v348; // mm0
  __m64 v349; // mm1
  __m64 v350; // mm2
  __m64 v351; // mm5
  __m64 v352; // mm3
  __m64 v353; // mm2
  __m64 v354; // mm7
  __m64 v355; // mm0
  __m64 v356; // mm3
  __m64 v357; // mm1
  __m64 v358; // mm2
  __m64 v359; // mm3
  __m64 v360; // mm0
  __m64 v361; // mm1
  __m64 v362; // mm2
  __m64 v363; // mm5
  __m64 v364; // mm3
  __m64 v365; // mm2
  __m64 v366; // mm7
  __m64 v367; // mm0
  __m64 v368; // mm3
  __m64 v369; // mm1
  __m64 v370; // mm2
  __m64 v371; // mm3
  __m64 v372; // mm0
  __m64 v373; // mm1
  __m64 v374; // mm2
  __m64 v375; // mm3
  __m64 v376; // mm1
  __m64 v377; // [esp+0h] [ebp-C0h]
  __m64 v378; // [esp+10h] [ebp-B0h]
  __m64 v379; // [esp+28h] [ebp-98h]
  __m64 v380; // [esp+40h] [ebp-80h]
  __m64 v381; // [esp+40h] [ebp-80h]
  __m64 v382; // [esp+48h] [ebp-78h]
  __m64 v383; // [esp+48h] [ebp-78h]
  __m64 v384; // [esp+50h] [ebp-70h]
  __m64 v385; // [esp+50h] [ebp-70h]
  __m64 v386; // [esp+58h] [ebp-68h]
  __m64 v387; // [esp+58h] [ebp-68h]
  __m64 v388; // [esp+60h] [ebp-60h]
  __m64 v389; // [esp+60h] [ebp-60h]
  __m64 v390; // [esp+68h] [ebp-58h]
  __m64 v391; // [esp+68h] [ebp-58h]
  __m64 v392; // [esp+78h] [ebp-48h]
  __m64 v393; // [esp+78h] [ebp-48h]
  __m64 v394; // [esp+80h] [ebp-40h]
  __m64 v395; // [esp+88h] [ebp-38h]
  __m64 v396; // [esp+90h] [ebp-30h]
  __m64 v397; // [esp+98h] [ebp-28h]
  __m64 v398; // [esp+A0h] [ebp-20h]
  __m64 v399; // [esp+A8h] [ebp-18h]
  __m64 v400; // [esp+B0h] [ebp-10h]
  __m64 v401; // [esp+B8h] [ebp-8h]

  result = a1;
  if ( a4 )
  {
    if ( a3 )
    {
      v377 = _m_punpckldq((__m64)a4->m64_u64, 0);
      v378 = _m_punpckhdq(0, (__m64)a4->m64_u64);
      v379 = _mm_cvtsi32_si64(a4[1].m64_u32[0]);
      m64_u64 = (__m64)a3->m64_u64;
      v9 = _m_pfadd(m64_u64, m64_u64);
      v10 = a3[1];
      v11 = _m_punpckhdq(m64_u64, m64_u64);
      v12 = _m_punpckhdq(v10, v10);
      v13 = _m_pfmul((__m64)a3->m64_u64, v9);
      v14 = _m_punpckldq(_m_pfadd(v10, v10), v9);
      v15 = _m_pfmul(v9, v12);
      v16 = _m_pfmul(_m_punpckldq(v10, v10), v14);
      v17 = _m_pfmul(v14, v12);
      v18 = _m_pfmul(v14, v11);
      v19 = _m_punpckhdq(v18, v16);
      v20 = _m_punpckhdq(_m_punpckldq(v17, v17), v15);
      v21 = _m_pfsubr(_m_pfadd(_m_punpckldq(v16, v16), v13), (__m64)0x3F8000003F800000LL);
      v390 = _m_punpckldq(_m_pfsubr(_m_pfacc(v13, v13), (__m64)0x3F8000003F800000LL), 0);
      v22 = v18;
      v23 = _m_pfadd(v18, v15);
      v24 = _m_pfsub(v22, v15);
      v25 = _m_pfsub(v19, v20);
      v26 = _m_pfadd(v19, v20);
      v386 = _m_punpckldq(v23, 0);
      v382 = _m_punpckhdq(v25, 0);
      v384 = _m_punpckldq(v25, v21);
      v380 = _m_punpckhdq(v21, _m_punpckldq(v26, v26));
      v388 = _m_punpckldq(_m_punpckhdq(v26, v26), v24);
      v392 = _m_punpckldq(0, (__m64)1065353216LL);
      if ( a2 )
      {
        v394 = _m_punpckldq(v380, v384);
        v396 = _m_punpckhdq(v380, v384);
        v399 = _m_punpckldq(v390, v392);
        v401 = _m_punpckhdq(v390, v392);
        v398 = _m_punpckldq(v382, v386);
        v400 = _m_punpckhdq(v382, v386);
        v397 = _m_punpckhdq(v388, 0);
        v395 = _m_punpckldq(v388, 0);
        result = a1;
        v27 = (__m64)a2->m64_u64;
        v28 = _mm_cvtsi32_si64(a2[1].m64_u32[0]);
        v29 = _mm_cvtsi32_si64(0x3F800000u);
        v30 = _m_punpckldq(_m_punpckhdq(v29, v29), v29);
        a1->m64_u64 = (unsigned __int64)v29;
        a1[1].m64_u64 = 0;
        a1[2].m64_u64 = (unsigned __int64)v30;
        a1[3].m64_u64 = 0;
        a1[4].m64_u64 = 0;
        a1[5].m64_u64 = (unsigned __int64)v29;
        v31 = _m_pfsub(v30, v28);
        a1[7].m64_u64 = (unsigned __int64)v31;
        a1[6].m64_u64 = (unsigned __int64)_m_pfsub(0, v27);
        v32 = a1[1];
        v33 = _m_punpckhdq(v31, (__m64)a1->m64_u64);
        v34 = _m_punpckhdq(v27, v32);
        v35 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
        v36 = _m_punpckldq(v32, v32);
        v37 = _m_punpckhdq(v33, v33);
        v38 = _m_pfmul(v396, v37);
        v39 = _m_punpckhdq(v34, v34);
        v40 = _m_pfadd(_m_pfadd(_m_pfmul(v37, v397), _m_pfmul(v35, v395)), _m_pfmul(v36, v399));
        v41 = _m_pfadd(_m_pfmul(v400, v39), _m_pfadd(_m_pfmul(v398, v36), _m_pfadd(v38, _m_pfmul(v394, v35))));
        v42 = a1[2];
        v43 = _m_pfadd(_m_pfmul(v39, v401), v40);
        v44 = a1[3];
        a1->m64_u64 = (unsigned __int64)v41;
        a1[1].m64_u64 = (unsigned __int64)v43;
        v45 = _m_punpckhdq(v40, v42);
        v46 = _m_punpckhdq(v43, v44);
        v47 = _m_punpckldq(v42, v42);
        v48 = _m_punpckldq(v44, v44);
        v49 = _m_punpckhdq(v45, v45);
        v50 = _m_pfmul(v396, v49);
        v51 = _m_punpckhdq(v46, v46);
        v52 = _m_pfadd(_m_pfadd(_m_pfmul(v49, v397), _m_pfmul(v47, v395)), _m_pfmul(v48, v399));
        v53 = _m_pfadd(_m_pfmul(v400, v51), _m_pfadd(_m_pfmul(v398, v48), _m_pfadd(v50, _m_pfmul(v394, v47))));
        v54 = a1[4];
        v55 = _m_pfadd(_m_pfmul(v51, v401), v52);
        v56 = a1[5];
        a1[2].m64_u64 = (unsigned __int64)v53;
        a1[3].m64_u64 = (unsigned __int64)v55;
        v57 = _m_punpckhdq(v52, v54);
        v58 = _m_punpckhdq(v55, v56);
        v59 = _m_punpckldq(v54, v54);
        v60 = _m_punpckldq(v56, v56);
        v61 = _m_punpckhdq(v57, v57);
        v62 = _m_pfmul(v396, v61);
        v63 = _m_punpckhdq(v58, v58);
        v64 = _m_pfadd(_m_pfadd(_m_pfmul(v61, v397), _m_pfmul(v59, v395)), _m_pfmul(v60, v399));
        v65 = _m_pfadd(_m_pfmul(v400, v63), _m_pfadd(_m_pfmul(v398, v60), _m_pfadd(v62, _m_pfmul(v394, v59))));
        v66 = a1[6];
        v67 = _m_pfadd(_m_pfmul(v63, v401), v64);
        v68 = a1[7];
        a1[4].m64_u64 = (unsigned __int64)v65;
        a1[5].m64_u64 = (unsigned __int64)v67;
        v69 = _m_punpckhdq(v64, v66);
        v70 = _m_punpckhdq(v67, v68);
        v71 = _m_punpckldq(v66, v66);
        v72 = _m_punpckldq(v68, v68);
        v73 = _m_punpckhdq(v69, v69);
        v74 = _m_pfmul(v396, v73);
        v75 = _m_punpckhdq(v70, v70);
        v76 = _m_pfmul(v400, v75);
        v77 = _m_pfadd(_m_pfadd(_m_pfmul(v73, v397), _m_pfmul(v71, v395)), _m_pfmul(v72, v399));
        v78 = _m_pfadd(_m_pfmul(v75, v401), v77);
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                            v76,
                                            _m_pfadd(_m_pfmul(v398, v72), _m_pfadd(v74, _m_pfmul(v394, v71))));
        a1[7].m64_u64 = (unsigned __int64)v78;
        v79 = a1[1];
        v80 = _m_punpckhdq(v77, (__m64)a1->m64_u64);
        v81 = _m_punpckhdq(v78, v79);
        v82 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
        v83 = _m_punpckldq(v79, v79);
        v84 = _m_punpckhdq(v80, v80);
        v85 = _m_pfmul(v378, v84);
        v86 = _m_punpckhdq(v81, v81);
        v87 = _m_pfadd(_m_pfadd(_m_pfmul(v84, 0), _m_pfmul(v82, 0)), _m_pfmul(v83, v379));
        v88 = _m_pfadd(_m_pfmul(0, v86), _m_pfadd(_m_pfmul(0, v83), _m_pfadd(v85, _m_pfmul(v377, v82))));
        v89 = a1[2];
        v90 = _m_pfadd(_m_pfmul(v86, (__m64)0x3F80000000000000LL), v87);
        v91 = a1[3];
        a1->m64_u64 = (unsigned __int64)v88;
        a1[1].m64_u64 = (unsigned __int64)v90;
        v92 = _m_punpckhdq(v87, v89);
        v93 = _m_punpckhdq(v90, v91);
        v94 = _m_punpckldq(v89, v89);
        v95 = _m_punpckldq(v91, v91);
        v96 = _m_punpckhdq(v92, v92);
        v97 = _m_pfmul(v378, v96);
        v98 = _m_punpckhdq(v93, v93);
        v99 = _m_pfadd(_m_pfadd(_m_pfmul(v96, 0), _m_pfmul(v94, 0)), _m_pfmul(v95, v379));
        v100 = _m_pfadd(_m_pfmul(0, v98), _m_pfadd(_m_pfmul(0, v95), _m_pfadd(v97, _m_pfmul(v377, v94))));
        v101 = a1[4];
        v102 = _m_pfadd(_m_pfmul(v98, (__m64)0x3F80000000000000LL), v99);
        v103 = a1[5];
        a1[2].m64_u64 = (unsigned __int64)v100;
        a1[3].m64_u64 = (unsigned __int64)v102;
        v104 = _m_punpckhdq(v99, v101);
        v105 = _m_punpckhdq(v102, v103);
        v106 = _m_punpckldq(v101, v101);
        v107 = _m_punpckldq(v103, v103);
        v108 = _m_punpckhdq(v104, v104);
        v109 = _m_pfmul(v378, v108);
        v110 = _m_punpckhdq(v105, v105);
        v111 = _m_pfadd(_m_pfadd(_m_pfmul(v108, 0), _m_pfmul(v106, 0)), _m_pfmul(v107, v379));
        v112 = _m_pfadd(_m_pfmul(0, v110), _m_pfadd(_m_pfmul(0, v107), _m_pfadd(v109, _m_pfmul(v377, v106))));
        v113 = a1[6];
        v114 = _m_pfadd(_m_pfmul(v110, (__m64)0x3F80000000000000LL), v111);
        v115 = a1[7];
        a1[4].m64_u64 = (unsigned __int64)v112;
        a1[5].m64_u64 = (unsigned __int64)v114;
        v116 = _m_punpckhdq(v111, v113);
        v117 = _m_punpckhdq(v114, v115);
        v118 = _m_punpckldq(v113, v113);
        v119 = _m_punpckldq(v115, v115);
        v120 = _m_punpckhdq(v116, v116);
        v121 = _m_pfmul(v378, v120);
        v122 = _m_punpckhdq(v117, v117);
        v123 = _m_pfmul(0, v122);
        v124 = _m_pfadd(_m_pfadd(_m_pfmul(v120, 0), _m_pfmul(v118, 0)), _m_pfmul(v119, v379));
        v125 = _m_pfadd(_m_pfmul(v122, (__m64)0x3F80000000000000LL), v124);
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                            v123,
                                            _m_pfadd(_m_pfmul(0, v119), _m_pfadd(v121, _m_pfmul(v377, v118))));
        a1[7].m64_u64 = (unsigned __int64)v125;
        v126 = a1[1];
        v127 = _m_punpckhdq(v124, (__m64)a1->m64_u64);
        v128 = _m_punpckhdq(v125, v126);
        v129 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
        v130 = _m_punpckldq(v126, v126);
        v131 = _m_punpckhdq(v127, v127);
        v132 = _m_pfmul(v384, v131);
        v133 = _m_punpckhdq(v128, v128);
        v134 = _m_pfadd(_m_pfadd(_m_pfmul(v131, v386), _m_pfmul(v129, v382)), _m_pfmul(v130, v390));
        v135 = _m_pfadd(_m_pfmul(0, v133), _m_pfadd(_m_pfmul(v388, v130), _m_pfadd(v132, _m_pfmul(v380, v129))));
        v136 = a1[2];
        v137 = _m_pfadd(_m_pfmul(v133, v392), v134);
        v138 = a1[3];
        a1->m64_u64 = (unsigned __int64)v135;
        a1[1].m64_u64 = (unsigned __int64)v137;
        v139 = _m_punpckhdq(v134, v136);
        v140 = _m_punpckhdq(v137, v138);
        v141 = _m_punpckldq(v136, v136);
        v142 = _m_punpckldq(v138, v138);
        v143 = _m_punpckhdq(v139, v139);
        v144 = _m_pfmul(v384, v143);
        v145 = _m_punpckhdq(v140, v140);
        v146 = _m_pfadd(_m_pfadd(_m_pfmul(v143, v386), _m_pfmul(v141, v382)), _m_pfmul(v142, v390));
        v147 = _m_pfadd(_m_pfmul(0, v145), _m_pfadd(_m_pfmul(v388, v142), _m_pfadd(v144, _m_pfmul(v380, v141))));
        v148 = a1[4];
        v149 = _m_pfadd(_m_pfmul(v145, v392), v146);
        v150 = a1[5];
        a1[2].m64_u64 = (unsigned __int64)v147;
        a1[3].m64_u64 = (unsigned __int64)v149;
        v151 = _m_punpckhdq(v146, v148);
        v152 = _m_punpckhdq(v149, v150);
        v153 = _m_punpckldq(v148, v148);
        v154 = _m_punpckldq(v150, v150);
        v155 = _m_punpckhdq(v151, v151);
        v156 = _m_pfmul(v384, v155);
        v157 = _m_punpckhdq(v152, v152);
        v158 = _m_pfadd(_m_pfadd(_m_pfmul(v155, v386), _m_pfmul(v153, v382)), _m_pfmul(v154, v390));
        v159 = _m_pfadd(_m_pfmul(0, v157), _m_pfadd(_m_pfmul(v388, v154), _m_pfadd(v156, _m_pfmul(v380, v153))));
        v160 = a1[6];
        v161 = _m_pfadd(_m_pfmul(v157, v392), v158);
        v162 = a1[7];
        a1[4].m64_u64 = (unsigned __int64)v159;
        a1[5].m64_u64 = (unsigned __int64)v161;
        v163 = _m_punpckhdq(v158, v160);
        v164 = _m_punpckhdq(v161, v162);
        v165 = _m_punpckldq(v160, v160);
        v166 = _m_punpckldq(v162, v162);
        v167 = _m_punpckhdq(v163, v163);
        v168 = _m_punpckhdq(v164, v164);
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                            _m_pfmul(0, v168),
                                            _m_pfadd(
                                              _m_pfmul(v388, v166),
                                              _m_pfadd(_m_pfmul(v384, v167), _m_pfmul(v380, v165))));
        a1[7].m64_u64 = (unsigned __int64)_m_pfadd(
                                            _m_pfmul(v168, v392),
                                            _m_pfadd(
                                              _m_pfadd(_m_pfmul(v167, v386), _m_pfmul(v165, v382)),
                                              _m_pfmul(v166, v390)));
        v169 = _m_pfadd(_mm_cvtsi32_si64(a2[1].m64_u32[0]), _mm_cvtsi32_si64(a1[7].m64_u32[0]));
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd((__m64)a2->m64_u64, a1[6]);
        a1[7].m64_i32[0] = _mm_cvtsi64_si32(v169);
      }
      else
      {
        result = a1;
        a1->m64_u64 = (unsigned __int64)_m_punpckldq(v380, v384);
        a1[2].m64_u64 = (unsigned __int64)_m_punpckhdq(v380, v384);
        v170 = _m_punpckldq(v390, v392);
        a1[5].m64_u64 = (unsigned __int64)v170;
        a1[7].m64_u64 = (unsigned __int64)_m_punpckhdq(v390, v392);
        a1[4].m64_u64 = (unsigned __int64)_m_punpckldq(v382, v386);
        v171 = _m_punpckldq(v388, 0);
        a1[6].m64_u64 = (unsigned __int64)_m_punpckhdq(v382, v386);
        a1[3].m64_u64 = (unsigned __int64)_m_punpckhdq(v388, 0);
        a1[1].m64_u64 = (unsigned __int64)v171;
        v172 = a1[1];
        v173 = _m_punpckhdq(v171, (__m64)a1->m64_u64);
        v174 = _m_punpckhdq(v170, v172);
        v175 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
        v176 = _m_punpckldq(v172, v172);
        v177 = _m_punpckhdq(v173, v173);
        v178 = _m_pfmul(v378, v177);
        v179 = _m_punpckhdq(v174, v174);
        v180 = _m_pfadd(_m_pfadd(_m_pfmul(v177, 0), _m_pfmul(v175, 0)), _m_pfmul(v176, v379));
        v181 = _m_pfadd(_m_pfmul(0, v179), _m_pfadd(_m_pfmul(0, v176), _m_pfadd(v178, _m_pfmul(v377, v175))));
        v182 = a1[2];
        v183 = _m_pfadd(_m_pfmul(v179, (__m64)0x3F80000000000000LL), v180);
        v184 = a1[3];
        a1->m64_u64 = (unsigned __int64)v181;
        a1[1].m64_u64 = (unsigned __int64)v183;
        v185 = _m_punpckhdq(v180, v182);
        v186 = _m_punpckhdq(v183, v184);
        v187 = _m_punpckldq(v182, v182);
        v188 = _m_punpckldq(v184, v184);
        v189 = _m_punpckhdq(v185, v185);
        v190 = _m_pfmul(v378, v189);
        v191 = _m_punpckhdq(v186, v186);
        v192 = _m_pfadd(_m_pfadd(_m_pfmul(v189, 0), _m_pfmul(v187, 0)), _m_pfmul(v188, v379));
        v193 = _m_pfadd(_m_pfmul(0, v191), _m_pfadd(_m_pfmul(0, v188), _m_pfadd(v190, _m_pfmul(v377, v187))));
        v194 = a1[4];
        v195 = _m_pfadd(_m_pfmul(v191, (__m64)0x3F80000000000000LL), v192);
        v196 = a1[5];
        a1[2].m64_u64 = (unsigned __int64)v193;
        a1[3].m64_u64 = (unsigned __int64)v195;
        v197 = _m_punpckhdq(v192, v194);
        v198 = _m_punpckhdq(v195, v196);
        v199 = _m_punpckldq(v194, v194);
        v200 = _m_punpckldq(v196, v196);
        v201 = _m_punpckhdq(v197, v197);
        v202 = _m_pfmul(v378, v201);
        v203 = _m_punpckhdq(v198, v198);
        v204 = _m_pfadd(_m_pfadd(_m_pfmul(v201, 0), _m_pfmul(v199, 0)), _m_pfmul(v200, v379));
        v205 = _m_pfadd(_m_pfmul(0, v203), _m_pfadd(_m_pfmul(0, v200), _m_pfadd(v202, _m_pfmul(v377, v199))));
        v206 = a1[6];
        v207 = _m_pfadd(_m_pfmul(v203, (__m64)0x3F80000000000000LL), v204);
        v208 = a1[7];
        a1[4].m64_u64 = (unsigned __int64)v205;
        a1[5].m64_u64 = (unsigned __int64)v207;
        v209 = _m_punpckhdq(v204, v206);
        v210 = _m_punpckhdq(v207, v208);
        v211 = _m_punpckldq(v206, v206);
        v212 = _m_punpckldq(v208, v208);
        v213 = _m_punpckhdq(v209, v209);
        v214 = _m_pfmul(v378, v213);
        v215 = _m_punpckhdq(v210, v210);
        v216 = _m_pfmul(0, v215);
        v217 = _m_pfadd(_m_pfadd(_m_pfmul(v213, 0), _m_pfmul(v211, 0)), _m_pfmul(v212, v379));
        v218 = _m_pfadd(_m_pfmul(v215, (__m64)0x3F80000000000000LL), v217);
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                            v216,
                                            _m_pfadd(_m_pfmul(0, v212), _m_pfadd(v214, _m_pfmul(v377, v211))));
        a1[7].m64_u64 = (unsigned __int64)v218;
        v219 = a1[1];
        v220 = _m_punpckhdq(v217, (__m64)a1->m64_u64);
        v221 = _m_punpckhdq(v218, v219);
        v222 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
        v223 = _m_punpckldq(v219, v219);
        v224 = _m_punpckhdq(v220, v220);
        v225 = _m_pfmul(v384, v224);
        v226 = _m_punpckhdq(v221, v221);
        v227 = _m_pfadd(_m_pfadd(_m_pfmul(v224, v386), _m_pfmul(v222, v382)), _m_pfmul(v223, v390));
        v228 = _m_pfadd(_m_pfmul(0, v226), _m_pfadd(_m_pfmul(v388, v223), _m_pfadd(v225, _m_pfmul(v380, v222))));
        v229 = a1[2];
        v230 = _m_pfadd(_m_pfmul(v226, v392), v227);
        v231 = a1[3];
        a1->m64_u64 = (unsigned __int64)v228;
        a1[1].m64_u64 = (unsigned __int64)v230;
        v232 = _m_punpckhdq(v227, v229);
        v233 = _m_punpckhdq(v230, v231);
        v234 = _m_punpckldq(v229, v229);
        v235 = _m_punpckldq(v231, v231);
        v236 = _m_punpckhdq(v232, v232);
        v237 = _m_pfmul(v384, v236);
        v238 = _m_punpckhdq(v233, v233);
        v239 = _m_pfadd(_m_pfadd(_m_pfmul(v236, v386), _m_pfmul(v234, v382)), _m_pfmul(v235, v390));
        v240 = _m_pfadd(_m_pfmul(0, v238), _m_pfadd(_m_pfmul(v388, v235), _m_pfadd(v237, _m_pfmul(v380, v234))));
        v241 = a1[4];
        v242 = _m_pfadd(_m_pfmul(v238, v392), v239);
        v243 = a1[5];
        a1[2].m64_u64 = (unsigned __int64)v240;
        a1[3].m64_u64 = (unsigned __int64)v242;
        v244 = _m_punpckhdq(v239, v241);
        v245 = _m_punpckhdq(v242, v243);
        v246 = _m_punpckldq(v241, v241);
        v247 = _m_punpckldq(v243, v243);
        v248 = _m_punpckhdq(v244, v244);
        v249 = _m_pfmul(v384, v248);
        v250 = _m_punpckhdq(v245, v245);
        v251 = _m_pfadd(_m_pfadd(_m_pfmul(v248, v386), _m_pfmul(v246, v382)), _m_pfmul(v247, v390));
        v252 = _m_pfadd(_m_pfmul(0, v250), _m_pfadd(_m_pfmul(v388, v247), _m_pfadd(v249, _m_pfmul(v380, v246))));
        v253 = a1[6];
        v254 = _m_pfadd(_m_pfmul(v250, v392), v251);
        v255 = a1[7];
        a1[4].m64_u64 = (unsigned __int64)v252;
        a1[5].m64_u64 = (unsigned __int64)v254;
        v256 = _m_punpckhdq(v251, v253);
        v257 = _m_punpckhdq(v254, v255);
        v258 = _m_punpckldq(v253, v253);
        v259 = _m_punpckldq(v255, v255);
        v260 = _m_punpckhdq(v256, v256);
        v261 = _m_punpckhdq(v257, v257);
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                            _m_pfmul(0, v261),
                                            _m_pfadd(
                                              _m_pfmul(v388, v259),
                                              _m_pfadd(_m_pfmul(v384, v260), _m_pfmul(v380, v258))));
        a1[7].m64_u64 = (unsigned __int64)_m_pfadd(
                                            _m_pfmul(v261, v392),
                                            _m_pfadd(
                                              _m_pfadd(_m_pfmul(v260, v386), _m_pfmul(v258, v382)),
                                              _m_pfmul(v259, v390)));
      }
    }
    else
    {
      v262 = _mm_cvtsi32_si64(a4[1].m64_u32[0]);
      v263 = _m_punpckhdq(0, (__m64)a4->m64_u64);
      a1->m64_u64 = (unsigned __int64)_m_punpckldq((__m64)a4->m64_u64, 0);
      a1[1].m64_u64 = 0;
      a1[2].m64_u64 = (unsigned __int64)v263;
      a1[3].m64_u64 = 0;
      a1[4].m64_u64 = 0;
      a1[5].m64_u64 = (unsigned __int64)v262;
      a1[6].m64_u64 = 0;
      a1[7].m64_u64 = 0x3F80000000000000LL;
    }
  }
  else
  {
    v264 = _mm_cvtsi32_si64(0x3F800000u);
    v265 = _m_punpckldq(_m_punpckhdq(v264, v264), v264);
    a1->m64_u64 = (unsigned __int64)v264;
    a1[1].m64_u64 = 0;
    a1[2].m64_u64 = (unsigned __int64)v265;
    a1[3].m64_u64 = 0;
    a1[4].m64_u64 = 0;
    a1[5].m64_u64 = (unsigned __int64)v264;
    a1[6].m64_u64 = 0;
    a1[7].m64_u64 = (unsigned __int64)v265;
  }
  if ( a6 )
  {
    v266 = (__m64)a6->m64_u64;
    v267 = _m_pfadd(v266, v266);
    v268 = a6[1];
    v269 = _m_punpckhdq(v266, v266);
    v270 = _m_punpckhdq(v268, v268);
    v271 = _m_pfmul((__m64)a6->m64_u64, v267);
    v272 = _m_punpckldq(_m_pfadd(v268, v268), v267);
    v273 = _m_pfmul(v267, v270);
    v274 = _m_pfmul(_m_punpckldq(v268, v268), v272);
    v275 = _m_pfmul(v272, v270);
    v276 = _m_pfmul(v272, v269);
    v277 = _m_punpckhdq(v276, v274);
    v278 = _m_punpckhdq(_m_punpckldq(v275, v275), v273);
    v279 = _m_pfsubr(_m_pfadd(_m_punpckldq(v274, v274), v271), (__m64)0x3F8000003F800000LL);
    v391 = _m_punpckldq(_m_pfsubr(_m_pfacc(v271, v271), (__m64)0x3F8000003F800000LL), 0);
    v280 = v276;
    v281 = _m_pfadd(v276, v273);
    v282 = _m_pfsub(v280, v273);
    v283 = _m_pfsub(v277, v278);
    v284 = _m_punpckldq(v281, 0);
    v285 = _m_pfadd(v277, v278);
    v387 = v284;
    v383 = _m_punpckhdq(v283, 0);
    v385 = _m_punpckldq(v283, v279);
    v381 = _m_punpckhdq(v279, _m_punpckldq(v285, v285));
    v389 = _m_punpckldq(_m_punpckhdq(v285, v285), v282);
    v393 = _m_punpckldq(0, (__m64)1065353216LL);
    if ( a5 )
    {
      v286 = (__m64)a5->m64_u64;
      v287 = _mm_cvtsi32_si64(a5[1].m64_u32[0]);
      v288 = _m_pfsub(_mm_cvtsi32_si64(result[7].m64_u32[0]), v287);
      result[6].m64_u64 = (unsigned __int64)_m_pfsub(result[6], (__m64)a5->m64_u64);
      result[7].m64_i32[0] = _mm_cvtsi64_si32(v288);
      v289 = result[1];
      v290 = _m_punpckhdq(v286, (__m64)result->m64_u64);
      v291 = _m_punpckhdq(v287, v289);
      v292 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
      v293 = _m_punpckldq(v289, v289);
      v294 = _m_punpckhdq(v290, v290);
      v295 = _m_pfmul(v385, v294);
      v296 = _m_punpckhdq(v291, v291);
      v297 = _m_pfadd(_m_pfadd(_m_pfmul(v294, v387), _m_pfmul(v292, v383)), _m_pfmul(v293, v391));
      v298 = _m_pfadd(_m_pfmul(0, v296), _m_pfadd(_m_pfmul(v389, v293), _m_pfadd(v295, _m_pfmul(v381, v292))));
      v299 = result[2];
      v300 = _m_pfadd(_m_pfmul(v296, v393), v297);
      v301 = result[3];
      result->m64_u64 = (unsigned __int64)v298;
      result[1].m64_u64 = (unsigned __int64)v300;
      v302 = _m_punpckhdq(v297, v299);
      v303 = _m_punpckhdq(v300, v301);
      v304 = _m_punpckldq(v299, v299);
      v305 = _m_punpckldq(v301, v301);
      v306 = _m_punpckhdq(v302, v302);
      v307 = _m_pfmul(v385, v306);
      v308 = _m_punpckhdq(v303, v303);
      v309 = _m_pfadd(_m_pfadd(_m_pfmul(v306, v387), _m_pfmul(v304, v383)), _m_pfmul(v305, v391));
      v310 = _m_pfadd(_m_pfmul(0, v308), _m_pfadd(_m_pfmul(v389, v305), _m_pfadd(v307, _m_pfmul(v381, v304))));
      v311 = result[4];
      v312 = _m_pfadd(_m_pfmul(v308, v393), v309);
      v313 = result[5];
      result[2].m64_u64 = (unsigned __int64)v310;
      result[3].m64_u64 = (unsigned __int64)v312;
      v314 = _m_punpckhdq(v309, v311);
      v315 = _m_punpckhdq(v312, v313);
      v316 = _m_punpckldq(v311, v311);
      v317 = _m_punpckldq(v313, v313);
      v318 = _m_punpckhdq(v314, v314);
      v319 = _m_pfmul(v385, v318);
      v320 = _m_punpckhdq(v315, v315);
      v321 = _m_pfadd(_m_pfadd(_m_pfmul(v318, v387), _m_pfmul(v316, v383)), _m_pfmul(v317, v391));
      v322 = _m_pfadd(_m_pfmul(0, v320), _m_pfadd(_m_pfmul(v389, v317), _m_pfadd(v319, _m_pfmul(v381, v316))));
      v323 = result[6];
      v324 = _m_pfadd(_m_pfmul(v320, v393), v321);
      v325 = result[7];
      result[4].m64_u64 = (unsigned __int64)v322;
      result[5].m64_u64 = (unsigned __int64)v324;
      v326 = _m_punpckhdq(v321, v323);
      v327 = _m_punpckhdq(v324, v325);
      v328 = _m_punpckldq(v323, v323);
      v329 = _m_punpckldq(v325, v325);
      v330 = _m_punpckhdq(v326, v326);
      v331 = _m_punpckhdq(v327, v327);
      result[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                              _m_pfmul(0, v331),
                                              _m_pfadd(
                                                _m_pfmul(v389, v329),
                                                _m_pfadd(_m_pfmul(v385, v330), _m_pfmul(v381, v328))));
      result[7].m64_u64 = (unsigned __int64)_m_pfadd(
                                              _m_pfmul(v331, v393),
                                              _m_pfadd(
                                                _m_pfadd(_m_pfmul(v330, v387), _m_pfmul(v328, v383)),
                                                _m_pfmul(v329, v391)));
      v332 = _m_pfadd(_mm_cvtsi32_si64(result[7].m64_u32[0]), _mm_cvtsi32_si64(a5[1].m64_u32[0]));
      result[6].m64_u64 = (unsigned __int64)_m_pfadd(result[6], (__m64)a5->m64_u64);
      result[7].m64_i32[0] = _mm_cvtsi64_si32(v332);
    }
    else
    {
      v333 = result[1];
      v334 = _m_punpckhdq(v284, (__m64)result->m64_u64);
      v335 = _m_punpckhdq(v282, v333);
      v336 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
      v337 = _m_punpckldq(v333, v333);
      v338 = _m_punpckhdq(v334, v334);
      v339 = _m_pfmul(v385, v338);
      v340 = _m_punpckhdq(v335, v335);
      v341 = _m_pfadd(_m_pfadd(_m_pfmul(v338, v387), _m_pfmul(v336, v383)), _m_pfmul(v337, v391));
      v342 = _m_pfadd(_m_pfmul(0, v340), _m_pfadd(_m_pfmul(v389, v337), _m_pfadd(v339, _m_pfmul(v381, v336))));
      v343 = result[2];
      v344 = _m_pfadd(_m_pfmul(v340, v393), v341);
      v345 = result[3];
      result->m64_u64 = (unsigned __int64)v342;
      result[1].m64_u64 = (unsigned __int64)v344;
      v346 = _m_punpckhdq(v341, v343);
      v347 = _m_punpckhdq(v344, v345);
      v348 = _m_punpckldq(v343, v343);
      v349 = _m_punpckldq(v345, v345);
      v350 = _m_punpckhdq(v346, v346);
      v351 = _m_pfmul(v385, v350);
      v352 = _m_punpckhdq(v347, v347);
      v353 = _m_pfadd(_m_pfadd(_m_pfmul(v350, v387), _m_pfmul(v348, v383)), _m_pfmul(v349, v391));
      v354 = _m_pfadd(_m_pfmul(0, v352), _m_pfadd(_m_pfmul(v389, v349), _m_pfadd(v351, _m_pfmul(v381, v348))));
      v355 = result[4];
      v356 = _m_pfadd(_m_pfmul(v352, v393), v353);
      v357 = result[5];
      result[2].m64_u64 = (unsigned __int64)v354;
      result[3].m64_u64 = (unsigned __int64)v356;
      v358 = _m_punpckhdq(v353, v355);
      v359 = _m_punpckhdq(v356, v357);
      v360 = _m_punpckldq(v355, v355);
      v361 = _m_punpckldq(v357, v357);
      v362 = _m_punpckhdq(v358, v358);
      v363 = _m_pfmul(v385, v362);
      v364 = _m_punpckhdq(v359, v359);
      v365 = _m_pfadd(_m_pfadd(_m_pfmul(v362, v387), _m_pfmul(v360, v383)), _m_pfmul(v361, v391));
      v366 = _m_pfadd(_m_pfmul(0, v364), _m_pfadd(_m_pfmul(v389, v361), _m_pfadd(v363, _m_pfmul(v381, v360))));
      v367 = result[6];
      v368 = _m_pfadd(_m_pfmul(v364, v393), v365);
      v369 = result[7];
      result[4].m64_u64 = (unsigned __int64)v366;
      result[5].m64_u64 = (unsigned __int64)v368;
      v370 = _m_punpckhdq(v365, v367);
      v371 = _m_punpckhdq(v368, v369);
      v372 = _m_punpckldq(v367, v367);
      v373 = _m_punpckldq(v369, v369);
      v374 = _m_punpckhdq(v370, v370);
      v375 = _m_punpckhdq(v371, v371);
      result[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                              _m_pfmul(0, v375),
                                              _m_pfadd(
                                                _m_pfmul(v389, v373),
                                                _m_pfadd(_m_pfmul(v385, v374), _m_pfmul(v381, v372))));
      result[7].m64_u64 = (unsigned __int64)_m_pfadd(
                                              _m_pfmul(v375, v393),
                                              _m_pfadd(
                                                _m_pfadd(_m_pfmul(v374, v387), _m_pfmul(v372, v383)),
                                                _m_pfmul(v373, v391)));
    }
  }
  if ( a7 )
  {
    v376 = _m_pfadd(_mm_cvtsi32_si64(result[7].m64_u32[0]), _mm_cvtsi32_si64(a7[1].m64_u32[0]));
    result[6].m64_u64 = (unsigned __int64)_m_pfadd(result[6], (__m64)a7->m64_u64);
    result[7].m64_i32[0] = _mm_cvtsi64_si32(v376);
  }
  _m_femms();
  return result;
}

// sub_45C3EA @ 0x0045C3EA
__m64 *__userpurge sub_45C3EA@<eax>(__m64 *a1, __m64 a2, __m64 a3)
{
  __m64 v3; // mm0
  __m64 v4; // mm6
  __m64 v5; // mm2
  __m64 v6; // mm6
  __m64 v7; // mm7
  __m64 v9; // mm3
  __m64 v10; // mm0
  __m64 v11; // mm7
  __m64 v12; // mm2
  __m64 v13; // mm4
  __m64 v14; // mm3
  __m64 v15; // mm1
  __m64 v16; // mm5
  __m64 v17; // mm7
  __m64 v18; // mm6
  __m64 v19; // mm2
  __m64 v20; // mm1
  __m64 v21; // mm6
  __m64 v22; // mm7
  __m64 v23; // mm3
  __m64 v24; // mm2
  __m64 v25; // mm3
  __m64 v26; // mm5
  __m64 v27; // mm6
  __m64 v28; // [esp+8h] [ebp-28h]
  __m64 v29; // [esp+28h] [ebp-8h]

  math_sincos_packed();
  v28 = _m_pfmul((__m64)0x3F0000003F000000LL, a3);
  math_sincos_packed();
  v3 = _m_pfmul((__m64)0x3F0000003F000000LL, a2);
  math_sincos_packed();
  v4 = _m_punpckhdq(v3, v3);
  v5 = _m_punpckldq(v4, v4);
  v6 = _m_punpckhdq(v4, v4);
  v7 = _m_punpckldq(_m_punpckhdq(v28, v28), v28);
  v29 = _m_pfadd(
          _m_pfmul(_m_pfmul(_m_punpckldq(v3, v3), v5), v7),
          _m_pfmul(_m_pfmul(_m_pxor(_m_punpckhdq(v3, v3), _m_psrlqi((__m64)0x8000000000000000uLL, 0x20u)), v6), v28));
  v9 = _m_pfadd(
         _m_pfmul(_m_pfmul(_m_pxor(_m_punpckldq(v3, v3), (__m64)0x8000000000000000uLL), v6), v28),
         _m_pfmul(_m_pfmul(_m_punpckhdq(v3, v3), v5), v7));
  v10 = _m_pfadd(v9, v9);
  v11 = v29;
  v12 = _m_punpckhdq(v9, v9);
  v13 = _m_punpckhdq(v11, v11);
  v14 = _m_pfmul(v9, v10);
  v15 = _m_punpckldq(_m_pfadd(v11, v11), v10);
  v16 = _m_pfmul(v10, v13);
  v17 = _m_pfmul(_m_punpckldq(v11, v11), v15);
  v18 = _m_pfmul(v15, v13);
  v19 = _m_pfmul(v15, v12);
  v20 = _m_punpckhdq(v19, v17);
  a1[6].m64_u64 = 0;
  v21 = _m_punpckhdq(_m_punpckldq(v18, v18), v16);
  v22 = _m_pfsubr(_m_pfadd(_m_punpckldq(v17, v17), v14), (__m64)0x3F8000003F800000LL);
  a1[5].m64_u64 = (unsigned __int64)_m_punpckldq(_m_pfsubr(_m_pfacc(v14, v14), (__m64)0x3F8000003F800000LL), 0);
  v23 = v19;
  v24 = _m_pfadd(v19, v16);
  v25 = _m_pfsub(v23, v16);
  v26 = _m_pfsub(v20, v21);
  v27 = _m_pfadd(v20, v21);
  a1[3].m64_u64 = (unsigned __int64)_m_punpckldq(v24, 0);
  a1[1].m64_u64 = (unsigned __int64)_m_punpckhdq(v26, 0);
  a1[2].m64_u64 = (unsigned __int64)_m_punpckldq(v26, v22);
  a1->m64_u64 = (unsigned __int64)_m_punpckhdq(v22, _m_punpckldq(v27, v27));
  a1[4].m64_u64 = (unsigned __int64)_m_punpckldq(_m_punpckhdq(v27, v27), v25);
  a1[7].m64_u64 = (unsigned __int64)_m_punpckldq(0, (__m64)1065353216LL);
  _m_femms();
  return a1;
}

// sub_45C58F @ 0x0045C58F
__m64 *__stdcall sub_45C58F(__m64 *a1, unsigned int a2, __m64 *a3, __m64 *a4, __m64 *a5)
{
  __m64 *result; // eax
  __m64 v6; // mm6
  __m64 m64_u64; // mm3
  __m64 v8; // mm0
  __m64 v9; // mm7
  __m64 v10; // mm2
  __m64 v11; // mm4
  __m64 v12; // mm3
  __m64 v13; // mm1
  __m64 v14; // mm5
  __m64 v15; // mm7
  __m64 v16; // mm6
  __m64 v17; // mm2
  __m64 v18; // mm1
  __m64 v19; // mm6
  __m64 v20; // mm7
  __m64 v21; // mm3
  __m64 v22; // mm2
  __m64 v23; // mm3
  __m64 v24; // mm5
  __m64 v25; // mm2
  __m64 v26; // mm6
  __m64 v27; // mm2
  __m64 v28; // mm3
  __m64 v29; // mm1
  __m64 v30; // mm1
  __m64 v31; // mm2
  __m64 v32; // mm3
  __m64 v33; // mm0
  __m64 v34; // mm1
  __m64 v35; // mm2
  __m64 v36; // mm5
  __m64 v37; // mm3
  __m64 v38; // mm2
  __m64 v39; // mm7
  __m64 v40; // mm0
  __m64 v41; // mm3
  __m64 v42; // mm1
  __m64 v43; // mm2
  __m64 v44; // mm3
  __m64 v45; // mm0
  __m64 v46; // mm1
  __m64 v47; // mm2
  __m64 v48; // mm5
  __m64 v49; // mm3
  __m64 v50; // mm2
  __m64 v51; // mm7
  __m64 v52; // mm0
  __m64 v53; // mm3
  __m64 v54; // mm1
  __m64 v55; // mm2
  __m64 v56; // mm3
  __m64 v57; // mm0
  __m64 v58; // mm1
  __m64 v59; // mm2
  __m64 v60; // mm5
  __m64 v61; // mm3
  __m64 v62; // mm2
  __m64 v63; // mm7
  __m64 v64; // mm0
  __m64 v65; // mm3
  __m64 v66; // mm1
  __m64 v67; // mm2
  __m64 v68; // mm3
  __m64 v69; // mm0
  __m64 v70; // mm1
  __m64 v71; // mm2
  __m64 v72; // mm3
  __m64 v73; // mm1
  __m64 v74; // mm1
  __m64 v75; // mm2
  __m64 v76; // mm3
  __m64 v77; // mm0
  __m64 v78; // mm1
  __m64 v79; // mm2
  __m64 v80; // mm5
  __m64 v81; // mm3
  __m64 v82; // mm2
  __m64 v83; // mm7
  __m64 v84; // mm0
  __m64 v85; // mm3
  __m64 v86; // mm1
  __m64 v87; // mm2
  __m64 v88; // mm3
  __m64 v89; // mm0
  __m64 v90; // mm1
  __m64 v91; // mm2
  __m64 v92; // mm5
  __m64 v93; // mm3
  __m64 v94; // mm2
  __m64 v95; // mm7
  __m64 v96; // mm0
  __m64 v97; // mm3
  __m64 v98; // mm1
  __m64 v99; // mm2
  __m64 v100; // mm3
  __m64 v101; // mm0
  __m64 v102; // mm1
  __m64 v103; // mm2
  __m64 v104; // mm5
  __m64 v105; // mm3
  __m64 v106; // mm2
  __m64 v107; // mm7
  __m64 v108; // mm0
  __m64 v109; // mm3
  __m64 v110; // mm1
  __m64 v111; // mm2
  __m64 v112; // mm3
  __m64 v113; // mm0
  __m64 v114; // mm1
  __m64 v115; // mm2
  __m64 v116; // mm3
  __m64 v117; // mm1
  __m64 v118; // [esp+0h] [ebp-40h]
  __m64 v119; // [esp+8h] [ebp-38h]
  __m64 v120; // [esp+10h] [ebp-30h]
  __m64 v121; // [esp+18h] [ebp-28h]
  __m64 v122; // [esp+20h] [ebp-20h]
  __m64 v123; // [esp+28h] [ebp-18h]
  __m64 v124; // [esp+38h] [ebp-8h]

  result = a1;
  v6 = _mm_cvtsi32_si64(a2);
  a1->m64_u64 = (unsigned __int64)v6;
  a1[1].m64_u64 = 0;
  a1[2].m64_i32[0] = _mm_cvtsi64_si32(0);
  a1[2].m64_i32[1] = _mm_cvtsi64_si32(v6);
  a1[3].m64_u64 = 0;
  a1[4].m64_u64 = 0;
  a1[5].m64_u64 = (unsigned __int64)v6;
  a1[6].m64_u64 = 0;
  a1[7].m64_u64 = 0x3F80000000000000LL;
  if ( a4 )
  {
    m64_u64 = (__m64)a4->m64_u64;
    v8 = _m_pfadd(m64_u64, m64_u64);
    v9 = a4[1];
    v10 = _m_punpckhdq(m64_u64, m64_u64);
    v11 = _m_punpckhdq(v9, v9);
    v12 = _m_pfmul((__m64)a4->m64_u64, v8);
    v13 = _m_punpckldq(_m_pfadd(v9, v9), v8);
    v14 = _m_pfmul(v8, v11);
    v15 = _m_pfmul(_m_punpckldq(v9, v9), v13);
    v16 = _m_pfmul(v13, v11);
    v17 = _m_pfmul(v13, v10);
    v18 = _m_punpckhdq(v17, v15);
    v19 = _m_punpckhdq(_m_punpckldq(v16, v16), v14);
    v20 = _m_pfsubr(_m_pfadd(_m_punpckldq(v15, v15), v12), (__m64)0x3F8000003F800000LL);
    v123 = _m_punpckldq(_m_pfsubr(_m_pfacc(v12, v12), (__m64)0x3F8000003F800000LL), 0);
    v21 = v17;
    v22 = _m_pfadd(v17, v14);
    v23 = _m_pfsub(v21, v14);
    v24 = _m_pfsub(v18, v19);
    v25 = _m_punpckldq(v22, 0);
    v26 = _m_pfadd(v18, v19);
    v121 = v25;
    v119 = _m_punpckhdq(v24, 0);
    v120 = _m_punpckldq(v24, v20);
    v118 = _m_punpckhdq(v20, _m_punpckldq(v26, v26));
    v122 = _m_punpckldq(_m_punpckhdq(v26, v26), v23);
    v124 = _m_punpckldq(0, (__m64)1065353216LL);
    if ( a3 )
    {
      v27 = (__m64)a3->m64_u64;
      v28 = _mm_cvtsi32_si64(a3[1].m64_u32[0]);
      v29 = _m_pfsub(_mm_cvtsi32_si64(a1[7].m64_u32[0]), v28);
      a1[6].m64_u64 = (unsigned __int64)_m_pfsub(a1[6], (__m64)a3->m64_u64);
      a1[7].m64_i32[0] = _mm_cvtsi64_si32(v29);
      v30 = a1[1];
      v31 = _m_punpckhdq(v27, (__m64)a1->m64_u64);
      v32 = _m_punpckhdq(v28, v30);
      v33 = _m_punpckldq((__m64)a1->m64_u64, (__m64)a1->m64_u64);
      v34 = _m_punpckldq(v30, v30);
      v35 = _m_punpckhdq(v31, v31);
      v36 = _m_pfmul(v120, v35);
      v37 = _m_punpckhdq(v32, v32);
      v38 = _m_pfadd(_m_pfadd(_m_pfmul(v35, v121), _m_pfmul(v33, v119)), _m_pfmul(v34, v123));
      v39 = _m_pfadd(_m_pfmul(0, v37), _m_pfadd(_m_pfmul(v122, v34), _m_pfadd(v36, _m_pfmul(v118, v33))));
      v40 = a1[2];
      v41 = _m_pfadd(_m_pfmul(v37, v124), v38);
      v42 = a1[3];
      a1->m64_u64 = (unsigned __int64)v39;
      a1[1].m64_u64 = (unsigned __int64)v41;
      v43 = _m_punpckhdq(v38, v40);
      v44 = _m_punpckhdq(v41, v42);
      v45 = _m_punpckldq(v40, v40);
      v46 = _m_punpckldq(v42, v42);
      v47 = _m_punpckhdq(v43, v43);
      v48 = _m_pfmul(v120, v47);
      v49 = _m_punpckhdq(v44, v44);
      v50 = _m_pfadd(_m_pfadd(_m_pfmul(v47, v121), _m_pfmul(v45, v119)), _m_pfmul(v46, v123));
      v51 = _m_pfadd(_m_pfmul(0, v49), _m_pfadd(_m_pfmul(v122, v46), _m_pfadd(v48, _m_pfmul(v118, v45))));
      v52 = a1[4];
      v53 = _m_pfadd(_m_pfmul(v49, v124), v50);
      v54 = a1[5];
      a1[2].m64_u64 = (unsigned __int64)v51;
      a1[3].m64_u64 = (unsigned __int64)v53;
      v55 = _m_punpckhdq(v50, v52);
      v56 = _m_punpckhdq(v53, v54);
      v57 = _m_punpckldq(v52, v52);
      v58 = _m_punpckldq(v54, v54);
      v59 = _m_punpckhdq(v55, v55);
      v60 = _m_pfmul(v120, v59);
      v61 = _m_punpckhdq(v56, v56);
      v62 = _m_pfadd(_m_pfadd(_m_pfmul(v59, v121), _m_pfmul(v57, v119)), _m_pfmul(v58, v123));
      v63 = _m_pfadd(_m_pfmul(0, v61), _m_pfadd(_m_pfmul(v122, v58), _m_pfadd(v60, _m_pfmul(v118, v57))));
      v64 = a1[6];
      v65 = _m_pfadd(_m_pfmul(v61, v124), v62);
      v66 = a1[7];
      a1[4].m64_u64 = (unsigned __int64)v63;
      a1[5].m64_u64 = (unsigned __int64)v65;
      v67 = _m_punpckhdq(v62, v64);
      v68 = _m_punpckhdq(v65, v66);
      v69 = _m_punpckldq(v64, v64);
      v70 = _m_punpckldq(v66, v66);
      v71 = _m_punpckhdq(v67, v67);
      v72 = _m_punpckhdq(v68, v68);
      a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                          _m_pfmul(0, v72),
                                          _m_pfadd(
                                            _m_pfmul(v122, v70),
                                            _m_pfadd(_m_pfmul(v120, v71), _m_pfmul(v118, v69))));
      a1[7].m64_u64 = (unsigned __int64)_m_pfadd(
                                          _m_pfmul(v72, v124),
                                          _m_pfadd(
                                            _m_pfadd(_m_pfmul(v71, v121), _m_pfmul(v69, v119)),
                                            _m_pfmul(v70, v123)));
      v73 = _m_pfadd(_mm_cvtsi32_si64(a1[7].m64_u32[0]), _mm_cvtsi32_si64(a3[1].m64_u32[0]));
      a1[6].m64_u64 = (unsigned __int64)_m_pfadd(a1[6], (__m64)a3->m64_u64);
      a1[7].m64_i32[0] = _mm_cvtsi64_si32(v73);
    }
    else
    {
      v74 = a1[1];
      v75 = _m_punpckhdq(v25, (__m64)a1->m64_u64);
      v76 = _m_punpckhdq(v23, v74);
      v77 = _m_punpckldq((__m64)a1->m64_u64, (__m64)a1->m64_u64);
      v78 = _m_punpckldq(v74, v74);
      v79 = _m_punpckhdq(v75, v75);
      v80 = _m_pfmul(v120, v79);
      v81 = _m_punpckhdq(v76, v76);
      v82 = _m_pfadd(_m_pfadd(_m_pfmul(v79, v121), _m_pfmul(v77, v119)), _m_pfmul(v78, v123));
      v83 = _m_pfadd(_m_pfmul(0, v81), _m_pfadd(_m_pfmul(v122, v78), _m_pfadd(v80, _m_pfmul(v118, v77))));
      v84 = a1[2];
      v85 = _m_pfadd(_m_pfmul(v81, v124), v82);
      v86 = a1[3];
      a1->m64_u64 = (unsigned __int64)v83;
      a1[1].m64_u64 = (unsigned __int64)v85;
      v87 = _m_punpckhdq(v82, v84);
      v88 = _m_punpckhdq(v85, v86);
      v89 = _m_punpckldq(v84, v84);
      v90 = _m_punpckldq(v86, v86);
      v91 = _m_punpckhdq(v87, v87);
      v92 = _m_pfmul(v120, v91);
      v93 = _m_punpckhdq(v88, v88);
      v94 = _m_pfadd(_m_pfadd(_m_pfmul(v91, v121), _m_pfmul(v89, v119)), _m_pfmul(v90, v123));
      v95 = _m_pfadd(_m_pfmul(0, v93), _m_pfadd(_m_pfmul(v122, v90), _m_pfadd(v92, _m_pfmul(v118, v89))));
      v96 = a1[4];
      v97 = _m_pfadd(_m_pfmul(v93, v124), v94);
      v98 = a1[5];
      a1[2].m64_u64 = (unsigned __int64)v95;
      a1[3].m64_u64 = (unsigned __int64)v97;
      v99 = _m_punpckhdq(v94, v96);
      v100 = _m_punpckhdq(v97, v98);
      v101 = _m_punpckldq(v96, v96);
      v102 = _m_punpckldq(v98, v98);
      v103 = _m_punpckhdq(v99, v99);
      v104 = _m_pfmul(v120, v103);
      v105 = _m_punpckhdq(v100, v100);
      v106 = _m_pfadd(_m_pfadd(_m_pfmul(v103, v121), _m_pfmul(v101, v119)), _m_pfmul(v102, v123));
      v107 = _m_pfadd(_m_pfmul(0, v105), _m_pfadd(_m_pfmul(v122, v102), _m_pfadd(v104, _m_pfmul(v118, v101))));
      v108 = a1[6];
      v109 = _m_pfadd(_m_pfmul(v105, v124), v106);
      v110 = a1[7];
      a1[4].m64_u64 = (unsigned __int64)v107;
      a1[5].m64_u64 = (unsigned __int64)v109;
      v111 = _m_punpckhdq(v106, v108);
      v112 = _m_punpckhdq(v109, v110);
      v113 = _m_punpckldq(v108, v108);
      v114 = _m_punpckldq(v110, v110);
      v115 = _m_punpckhdq(v111, v111);
      v116 = _m_punpckhdq(v112, v112);
      a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                          _m_pfmul(0, v116),
                                          _m_pfadd(
                                            _m_pfmul(v122, v114),
                                            _m_pfadd(_m_pfmul(v120, v115), _m_pfmul(v118, v113))));
      a1[7].m64_u64 = (unsigned __int64)_m_pfadd(
                                          _m_pfmul(v116, v124),
                                          _m_pfadd(
                                            _m_pfadd(_m_pfmul(v115, v121), _m_pfmul(v113, v119)),
                                            _m_pfmul(v114, v123)));
    }
  }
  if ( a5 )
  {
    v117 = _m_pfadd(_mm_cvtsi32_si64(a5[1].m64_u32[0]), _mm_cvtsi32_si64(a1[7].m64_u32[0]));
    a1[6].m64_u64 = (unsigned __int64)_m_pfadd((__m64)a5->m64_u64, a1[6]);
    a1[7].m64_i32[0] = _mm_cvtsi64_si32(v117);
  }
  _m_femms();
  return result;
}

// sub_45CAC3 @ 0x0045CAC3
__m64 *__stdcall sub_45CAC3(__m64 *a1, __m64 *a2, unsigned int a3)
{
  __m64 v3; // mm1
  __m64 v4; // mm1
  __m64 v5; // mm0
  __m64 v6; // mm7
  __m64 v7; // mm3
  __m64 v8; // mm0
  __m64 v9; // mm1
  __m64 v10; // mm2
  __m64 v12; // mm3
  __m64 v13; // mm4
  __m64 v14; // mm5
  __m64 v15; // mm1
  __m64 v16; // mm1
  __m64 v17; // mm6
  __m64 v18; // mm7
  __m64 v19; // mm1
  __m64 v20; // mm6
  __m64 v21; // mm2
  __m64 v22; // mm1
  unsigned __int64 m64_u64; // [esp+0h] [ebp-18h] BYREF
  unsigned int v24; // [esp+8h] [ebp-10h]
  unsigned int v25; // [esp+Ch] [ebp-Ch]

  v3 = _mm_cvtsi32_si64(a2[1].m64_u32[0]);
  m64_u64 = a2->m64_u64;
  v24 = _mm_cvtsi64_si32(v3);
  sub_45E832((int)&m64_u64, (int)&m64_u64);
  math_sincos_packed();
  v4 = _mm_cvtsi32_si64(a3);
  v5 = _m_pfsubr(v4, (__m64)0x3F8000003F800000LL);
  v25 = _mm_cvtsi64_si32(_m_punpckhdq(v4, v4));
  v6 = _mm_cvtsi32_si64(v24);
  v7 = _m_punpckldq(v6, v6);
  v8 = _m_punpckldq(v5, v5);
  v9 = _m_punpckldq(v4, v4);
  v10 = _m_pfmul(_m_pfmul(_m_punpckhdq((__m64)m64_u64, v7), (__m64)m64_u64), v8);
  v12 = _m_pfmul(_m_pfmul(v7, (__m64)m64_u64), v8);
  v13 = _m_pfadd(_m_pfmul(_m_pfmul((__m64)m64_u64, (__m64)m64_u64), v8), v9);
  v14 = _m_pfadd(_m_pfmul(_m_pfmul(v6, v6), v8), v9);
  v15 = _mm_cvtsi32_si64(v25);
  v16 = _m_punpckldq(v15, v15);
  v17 = _m_pfmul((__m64)m64_u64, v16);
  a1[6].m64_u64 = 0;
  v18 = _m_punpckldq(_m_pfmul(v6, v16), v17);
  v19 = v10;
  v20 = _m_punpckhdq(v17, v17);
  a1[5].m64_u64 = (unsigned __int64)_m_punpckldq(v14, 0);
  v21 = _m_pfsub(v10, v18);
  v22 = _m_pfadd(v19, v18);
  a1->m64_u64 = (unsigned __int64)_m_punpckldq(v13, v22);
  a1[1].m64_u64 = (unsigned __int64)_m_punpckldq(_m_pfsub(v12, v20), 0);
  a1[3].m64_u64 = (unsigned __int64)_m_punpckhdq(v22, 0);
  a1[7].m64_u64 = (unsigned __int64)_m_punpckhdq(0, (__m64)0x3F8000003F800000LL);
  a1[4].m64_u64 = (unsigned __int64)_m_punpckhdq(_m_pfadd(_m_punpckldq(v12, v12), v20), v21);
  a1[2].m64_u64 = (unsigned __int64)_m_punpckldq(v21, _m_punpckhdq(v13, v13));
  _m_femms();
  return a1;
}

// sub_45CBDC @ 0x0045CBDC
__m64 *__stdcall sub_45CBDC(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, __m64 *a5, __m64 *a6, __m64 *a7)
{
  __m64 *result; // eax
  __m64 v8; // mm4
  __m64 v9; // mm1
  __m64 v10; // mm5
  __m64 v11; // mm0
  __m64 v12; // mm5
  __m64 v13; // mm2
  __m64 v14; // mm3
  __m64 v15; // mm1
  __m64 v16; // mm6
  __m64 v17; // mm3
  __m64 v18; // mm6
  __m64 v19; // mm2
  __m64 v20; // mm1
  __m64 m64_u64; // mm3
  __m64 v22; // mm4
  __m64 v23; // mm1
  __m64 v24; // mm2
  __m64 v25; // mm2
  __m64 v26; // mm1
  __m64 v27; // mm2
  __m64 v28; // mm3
  __m64 v29; // mm0
  __m64 v30; // mm1
  __m64 v31; // mm2
  __m64 v32; // mm5
  __m64 v33; // mm3
  __m64 v34; // mm2
  __m64 v35; // mm7
  __m64 v36; // mm0
  __m64 v37; // mm3
  __m64 v38; // mm1
  __m64 v39; // mm2
  __m64 v40; // mm3
  __m64 v41; // mm0
  __m64 v42; // mm1
  __m64 v43; // mm2
  __m64 v44; // mm5
  __m64 v45; // mm3
  __m64 v46; // mm2
  __m64 v47; // mm7
  __m64 v48; // mm0
  __m64 v49; // mm3
  __m64 v50; // mm1
  __m64 v51; // mm2
  __m64 v52; // mm3
  __m64 v53; // mm0
  __m64 v54; // mm1
  __m64 v55; // mm2
  __m64 v56; // mm5
  __m64 v57; // mm3
  __m64 v58; // mm2
  __m64 v59; // mm7
  __m64 v60; // mm0
  __m64 v61; // mm3
  __m64 v62; // mm1
  __m64 v63; // mm2
  __m64 v64; // mm3
  __m64 v65; // mm0
  __m64 v66; // mm1
  __m64 v67; // mm2
  __m64 v68; // mm5
  __m64 v69; // mm3
  __m64 v70; // mm7
  __m64 v71; // mm2
  __m64 v72; // mm3
  __m64 v73; // mm1
  __m64 v74; // mm2
  __m64 v75; // mm3
  __m64 v76; // mm0
  __m64 v77; // mm1
  __m64 v78; // mm2
  __m64 v79; // mm5
  __m64 v80; // mm3
  __m64 v81; // mm2
  __m64 v82; // mm7
  __m64 v83; // mm0
  __m64 v84; // mm3
  __m64 v85; // mm1
  __m64 v86; // mm2
  __m64 v87; // mm3
  __m64 v88; // mm0
  __m64 v89; // mm1
  __m64 v90; // mm2
  __m64 v91; // mm5
  __m64 v92; // mm3
  __m64 v93; // mm2
  __m64 v94; // mm7
  __m64 v95; // mm0
  __m64 v96; // mm3
  __m64 v97; // mm1
  __m64 v98; // mm2
  __m64 v99; // mm3
  __m64 v100; // mm0
  __m64 v101; // mm1
  __m64 v102; // mm2
  __m64 v103; // mm5
  __m64 v104; // mm3
  __m64 v105; // mm2
  __m64 v106; // mm7
  __m64 v107; // mm0
  __m64 v108; // mm3
  __m64 v109; // mm1
  __m64 v110; // mm2
  __m64 v111; // mm3
  __m64 v112; // mm0
  __m64 v113; // mm1
  __m64 v114; // mm2
  __m64 v115; // mm5
  __m64 v116; // mm3
  __m64 v117; // mm7
  __m64 v118; // mm2
  __m64 v119; // mm3
  __m64 v120; // mm1
  __m64 v121; // mm2
  __m64 v122; // mm3
  __m64 v123; // mm0
  __m64 v124; // mm1
  __m64 v125; // mm2
  __m64 v126; // mm5
  __m64 v127; // mm3
  __m64 v128; // mm2
  __m64 v129; // mm7
  __m64 v130; // mm0
  __m64 v131; // mm3
  __m64 v132; // mm1
  __m64 v133; // mm2
  __m64 v134; // mm3
  __m64 v135; // mm0
  __m64 v136; // mm1
  __m64 v137; // mm2
  __m64 v138; // mm5
  __m64 v139; // mm3
  __m64 v140; // mm2
  __m64 v141; // mm7
  __m64 v142; // mm0
  __m64 v143; // mm3
  __m64 v144; // mm1
  __m64 v145; // mm2
  __m64 v146; // mm3
  __m64 v147; // mm0
  __m64 v148; // mm1
  __m64 v149; // mm2
  __m64 v150; // mm5
  __m64 v151; // mm3
  __m64 v152; // mm2
  __m64 v153; // mm7
  __m64 v154; // mm0
  __m64 v155; // mm3
  __m64 v156; // mm1
  __m64 v157; // mm2
  __m64 v158; // mm3
  __m64 v159; // mm0
  __m64 v160; // mm1
  __m64 v161; // mm2
  __m64 v162; // mm3
  __m64 v163; // mm2
  __m64 v164; // mm3
  __m64 v165; // mm2
  __m64 v166; // mm1
  __m64 v167; // mm2
  __m64 v168; // mm3
  __m64 v169; // mm0
  __m64 v170; // mm1
  __m64 v171; // mm2
  __m64 v172; // mm5
  __m64 v173; // mm3
  __m64 v174; // mm2
  __m64 v175; // mm7
  __m64 v176; // mm0
  __m64 v177; // mm3
  __m64 v178; // mm1
  __m64 v179; // mm2
  __m64 v180; // mm3
  __m64 v181; // mm0
  __m64 v182; // mm1
  __m64 v183; // mm2
  __m64 v184; // mm5
  __m64 v185; // mm3
  __m64 v186; // mm2
  __m64 v187; // mm7
  __m64 v188; // mm0
  __m64 v189; // mm3
  __m64 v190; // mm1
  __m64 v191; // mm2
  __m64 v192; // mm3
  __m64 v193; // mm0
  __m64 v194; // mm1
  __m64 v195; // mm2
  __m64 v196; // mm5
  __m64 v197; // mm3
  __m64 v198; // mm2
  __m64 v199; // mm7
  __m64 v200; // mm0
  __m64 v201; // mm3
  __m64 v202; // mm1
  __m64 v203; // mm2
  __m64 v204; // mm3
  __m64 v205; // mm0
  __m64 v206; // mm1
  __m64 v207; // mm2
  __m64 v208; // mm5
  __m64 v209; // mm3
  __m64 v210; // mm7
  __m64 v211; // mm2
  __m64 v212; // mm3
  __m64 v213; // mm1
  __m64 v214; // mm2
  __m64 v215; // mm3
  __m64 v216; // mm0
  __m64 v217; // mm1
  __m64 v218; // mm2
  __m64 v219; // mm5
  __m64 v220; // mm3
  __m64 v221; // mm2
  __m64 v222; // mm7
  __m64 v223; // mm0
  __m64 v224; // mm3
  __m64 v225; // mm1
  __m64 v226; // mm2
  __m64 v227; // mm3
  __m64 v228; // mm0
  __m64 v229; // mm1
  __m64 v230; // mm2
  __m64 v231; // mm5
  __m64 v232; // mm3
  __m64 v233; // mm2
  __m64 v234; // mm7
  __m64 v235; // mm0
  __m64 v236; // mm3
  __m64 v237; // mm1
  __m64 v238; // mm2
  __m64 v239; // mm3
  __m64 v240; // mm0
  __m64 v241; // mm1
  __m64 v242; // mm2
  __m64 v243; // mm5
  __m64 v244; // mm3
  __m64 v245; // mm2
  __m64 v246; // mm7
  __m64 v247; // mm0
  __m64 v248; // mm3
  __m64 v249; // mm1
  __m64 v250; // mm2
  __m64 v251; // mm3
  __m64 v252; // mm0
  __m64 v253; // mm1
  __m64 v254; // mm2
  __m64 v255; // mm3
  __m64 v256; // mm4
  __m64 v257; // mm5
  __m64 v258; // mm1
  __m64 v259; // mm2
  __m64 v260; // mm4
  __m64 v261; // mm1
  __m64 v262; // mm5
  __m64 v263; // mm0
  __m64 v264; // mm5
  __m64 v265; // mm2
  __m64 v266; // mm3
  __m64 v267; // mm1
  __m64 v268; // mm6
  __m64 v269; // mm3
  __m64 v270; // mm6
  __m64 v271; // mm2
  __m64 v272; // mm1
  __m64 v273; // mm5
  __m64 v274; // mm2
  __m64 v275; // mm3
  __m64 v276; // mm2
  __m64 v277; // mm3
  __m64 v278; // mm1
  __m64 v279; // mm1
  __m64 v280; // mm2
  __m64 v281; // mm3
  __m64 v282; // mm0
  __m64 v283; // mm1
  __m64 v284; // mm2
  __m64 v285; // mm5
  __m64 v286; // mm3
  __m64 v287; // mm2
  __m64 v288; // mm7
  __m64 v289; // mm0
  __m64 v290; // mm3
  __m64 v291; // mm1
  __m64 v292; // mm2
  __m64 v293; // mm3
  __m64 v294; // mm0
  __m64 v295; // mm1
  __m64 v296; // mm2
  __m64 v297; // mm5
  __m64 v298; // mm3
  __m64 v299; // mm2
  __m64 v300; // mm7
  __m64 v301; // mm0
  __m64 v302; // mm3
  __m64 v303; // mm1
  __m64 v304; // mm2
  __m64 v305; // mm3
  __m64 v306; // mm0
  __m64 v307; // mm1
  __m64 v308; // mm2
  __m64 v309; // mm5
  __m64 v310; // mm3
  __m64 v311; // mm2
  __m64 v312; // mm7
  __m64 v313; // mm0
  __m64 v314; // mm3
  __m64 v315; // mm1
  __m64 v316; // mm2
  __m64 v317; // mm3
  __m64 v318; // mm0
  __m64 v319; // mm1
  __m64 v320; // mm2
  __m64 v321; // mm3
  __m64 v322; // mm1
  __m64 v323; // mm1
  __m64 v324; // mm2
  __m64 v325; // mm3
  __m64 v326; // mm0
  __m64 v327; // mm1
  __m64 v328; // mm2
  __m64 v329; // mm5
  __m64 v330; // mm3
  __m64 v331; // mm2
  __m64 v332; // mm7
  __m64 v333; // mm0
  __m64 v334; // mm3
  __m64 v335; // mm1
  __m64 v336; // mm2
  __m64 v337; // mm3
  __m64 v338; // mm0
  __m64 v339; // mm1
  __m64 v340; // mm2
  __m64 v341; // mm5
  __m64 v342; // mm3
  __m64 v343; // mm2
  __m64 v344; // mm7
  __m64 v345; // mm0
  __m64 v346; // mm3
  __m64 v347; // mm1
  __m64 v348; // mm2
  __m64 v349; // mm3
  __m64 v350; // mm0
  __m64 v351; // mm1
  __m64 v352; // mm2
  __m64 v353; // mm5
  __m64 v354; // mm3
  __m64 v355; // mm2
  __m64 v356; // mm7
  __m64 v357; // mm0
  __m64 v358; // mm3
  __m64 v359; // mm1
  __m64 v360; // mm2
  __m64 v361; // mm3
  __m64 v362; // mm0
  __m64 v363; // mm1
  __m64 v364; // mm2
  __m64 v365; // mm3
  __m64 v366; // mm1
  __m64 v367; // [esp+0h] [ebp-C0h]
  __m64 v368; // [esp+10h] [ebp-B0h]
  __m64 v369; // [esp+28h] [ebp-98h]
  __m64 v370; // [esp+40h] [ebp-80h]
  __m64 v371; // [esp+40h] [ebp-80h]
  __m64 v372; // [esp+48h] [ebp-78h]
  __m64 v373; // [esp+48h] [ebp-78h]
  __m64 v374; // [esp+50h] [ebp-70h]
  __m64 v375; // [esp+50h] [ebp-70h]
  __m64 v376; // [esp+58h] [ebp-68h]
  __m64 v377; // [esp+58h] [ebp-68h]
  __m64 v378; // [esp+60h] [ebp-60h]
  __m64 v379; // [esp+60h] [ebp-60h]
  __m64 v380; // [esp+68h] [ebp-58h]
  __m64 v381; // [esp+68h] [ebp-58h]
  __m64 v382; // [esp+78h] [ebp-48h]
  __m64 v383; // [esp+78h] [ebp-48h]
  __m64 v384; // [esp+80h] [ebp-40h]
  __m64 v385; // [esp+88h] [ebp-38h]
  __m64 v386; // [esp+90h] [ebp-30h]
  __m64 v387; // [esp+98h] [ebp-28h]
  __m64 v388; // [esp+A0h] [ebp-20h]
  __m64 v389; // [esp+A8h] [ebp-18h]
  __m64 v390; // [esp+B0h] [ebp-10h]
  __m64 v391; // [esp+B8h] [ebp-8h]

  result = a1;
  if ( a4 )
  {
    if ( a3 )
    {
      v367 = _m_punpckldq((__m64)a4->m64_u64, 0);
      v368 = _m_punpckhdq(0, (__m64)a4->m64_u64);
      v369 = _mm_cvtsi32_si64(a4[1].m64_u32[0]);
      v8 = a3[1];
      v9 = _m_pfadd(v8, v8);
      v10 = _m_pfadd((__m64)a3->m64_u64, (__m64)a3->m64_u64);
      v11 = _m_pfmul(v10, (__m64)a3->m64_u64);
      v12 = _m_punpckldq(v10, v9);
      v13 = _m_pfmul((__m64)a3->m64_u64, v9);
      v14 = _m_pfmul(_m_pswapd((__m64)a3->m64_u64), v9);
      v15 = _m_pfmul(v9, v8);
      v16 = _m_pfmul(_m_punpckhdq((__m64)a3->m64_u64, v8), v12);
      v17 = _m_pfpnacc(v14, v14);
      v18 = _m_pfpnacc(v16, v16);
      v19 = _m_pfpnacc(v13, v13);
      v20 = _m_pfsub(_m_pfsubr(v11, (__m64)0x3F8000003F800000LL), _m_punpckldq(v15, v15));
      v378 = _m_punpckldq(_m_pswapd(v19), v17);
      v372 = _m_punpckldq(v19, 0);
      v380 = _m_punpckhdq(_m_pfsubr(_m_pfacc(v11, v11), (__m64)0x3F8000003F800000LL), 0);
      v370 = _m_punpckhdq(v20, v18);
      v374 = _m_punpckldq(v18, v20);
      v376 = _m_punpckhdq(v17, 0);
      v382 = _m_punpckldq(0, (__m64)1065353216LL);
      if ( a2 )
      {
        v384 = _m_punpckldq(v370, v374);
        v386 = _m_punpckhdq(v370, v374);
        v389 = _m_punpckldq(v380, v382);
        v391 = _m_punpckhdq(v380, v382);
        v388 = _m_punpckldq(v372, v376);
        v390 = _m_punpckhdq(v372, v376);
        v387 = _m_punpckhdq(v378, 0);
        v385 = _m_punpckldq(v378, 0);
        result = a1;
        m64_u64 = (__m64)a2->m64_u64;
        v22 = _mm_cvtsi32_si64(a2[1].m64_u32[0]);
        v23 = _mm_cvtsi32_si64(0x3F800000u);
        v24 = _m_pswapd(v23);
        a1->m64_u64 = (unsigned __int64)v23;
        a1[1].m64_u64 = 0;
        a1[2].m64_u64 = (unsigned __int64)v24;
        a1[3].m64_u64 = 0;
        a1[4].m64_u64 = 0;
        a1[5].m64_u64 = (unsigned __int64)v23;
        v25 = _m_pfsub(v24, v22);
        a1[7].m64_u64 = (unsigned __int64)v25;
        a1[6].m64_u64 = (unsigned __int64)_m_pfsub(0, m64_u64);
        v26 = a1[1];
        v27 = _m_punpckhdq(v25, (__m64)a1->m64_u64);
        v28 = _m_punpckhdq(m64_u64, v26);
        v29 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
        v30 = _m_punpckldq(v26, v26);
        v31 = _m_punpckhdq(v27, v27);
        v32 = _m_pfmul(v386, v31);
        v33 = _m_punpckhdq(v28, v28);
        v34 = _m_pfadd(_m_pfadd(_m_pfmul(v31, v387), _m_pfmul(v29, v385)), _m_pfmul(v30, v389));
        v35 = _m_pfadd(_m_pfmul(v390, v33), _m_pfadd(_m_pfmul(v388, v30), _m_pfadd(v32, _m_pfmul(v384, v29))));
        v36 = a1[2];
        v37 = _m_pfadd(_m_pfmul(v33, v391), v34);
        v38 = a1[3];
        a1->m64_u64 = (unsigned __int64)v35;
        a1[1].m64_u64 = (unsigned __int64)v37;
        v39 = _m_punpckhdq(v34, v36);
        v40 = _m_punpckhdq(v37, v38);
        v41 = _m_punpckldq(v36, v36);
        v42 = _m_punpckldq(v38, v38);
        v43 = _m_punpckhdq(v39, v39);
        v44 = _m_pfmul(v386, v43);
        v45 = _m_punpckhdq(v40, v40);
        v46 = _m_pfadd(_m_pfadd(_m_pfmul(v43, v387), _m_pfmul(v41, v385)), _m_pfmul(v42, v389));
        v47 = _m_pfadd(_m_pfmul(v390, v45), _m_pfadd(_m_pfmul(v388, v42), _m_pfadd(v44, _m_pfmul(v384, v41))));
        v48 = a1[4];
        v49 = _m_pfadd(_m_pfmul(v45, v391), v46);
        v50 = a1[5];
        a1[2].m64_u64 = (unsigned __int64)v47;
        a1[3].m64_u64 = (unsigned __int64)v49;
        v51 = _m_punpckhdq(v46, v48);
        v52 = _m_punpckhdq(v49, v50);
        v53 = _m_punpckldq(v48, v48);
        v54 = _m_punpckldq(v50, v50);
        v55 = _m_punpckhdq(v51, v51);
        v56 = _m_pfmul(v386, v55);
        v57 = _m_punpckhdq(v52, v52);
        v58 = _m_pfadd(_m_pfadd(_m_pfmul(v55, v387), _m_pfmul(v53, v385)), _m_pfmul(v54, v389));
        v59 = _m_pfadd(_m_pfmul(v390, v57), _m_pfadd(_m_pfmul(v388, v54), _m_pfadd(v56, _m_pfmul(v384, v53))));
        v60 = a1[6];
        v61 = _m_pfadd(_m_pfmul(v57, v391), v58);
        v62 = a1[7];
        a1[4].m64_u64 = (unsigned __int64)v59;
        a1[5].m64_u64 = (unsigned __int64)v61;
        v63 = _m_punpckhdq(v58, v60);
        v64 = _m_punpckhdq(v61, v62);
        v65 = _m_punpckldq(v60, v60);
        v66 = _m_punpckldq(v62, v62);
        v67 = _m_punpckhdq(v63, v63);
        v68 = _m_pfmul(v386, v67);
        v69 = _m_punpckhdq(v64, v64);
        v70 = _m_pfmul(v390, v69);
        v71 = _m_pfadd(_m_pfadd(_m_pfmul(v67, v387), _m_pfmul(v65, v385)), _m_pfmul(v66, v389));
        v72 = _m_pfadd(_m_pfmul(v69, v391), v71);
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                            v70,
                                            _m_pfadd(_m_pfmul(v388, v66), _m_pfadd(v68, _m_pfmul(v384, v65))));
        a1[7].m64_u64 = (unsigned __int64)v72;
        v73 = a1[1];
        v74 = _m_punpckhdq(v71, (__m64)a1->m64_u64);
        v75 = _m_punpckhdq(v72, v73);
        v76 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
        v77 = _m_punpckldq(v73, v73);
        v78 = _m_punpckhdq(v74, v74);
        v79 = _m_pfmul(v368, v78);
        v80 = _m_punpckhdq(v75, v75);
        v81 = _m_pfadd(_m_pfadd(_m_pfmul(v78, 0), _m_pfmul(v76, 0)), _m_pfmul(v77, v369));
        v82 = _m_pfadd(_m_pfmul(0, v80), _m_pfadd(_m_pfmul(0, v77), _m_pfadd(v79, _m_pfmul(v367, v76))));
        v83 = a1[2];
        v84 = _m_pfadd(_m_pfmul(v80, (__m64)0x3F80000000000000LL), v81);
        v85 = a1[3];
        a1->m64_u64 = (unsigned __int64)v82;
        a1[1].m64_u64 = (unsigned __int64)v84;
        v86 = _m_punpckhdq(v81, v83);
        v87 = _m_punpckhdq(v84, v85);
        v88 = _m_punpckldq(v83, v83);
        v89 = _m_punpckldq(v85, v85);
        v90 = _m_punpckhdq(v86, v86);
        v91 = _m_pfmul(v368, v90);
        v92 = _m_punpckhdq(v87, v87);
        v93 = _m_pfadd(_m_pfadd(_m_pfmul(v90, 0), _m_pfmul(v88, 0)), _m_pfmul(v89, v369));
        v94 = _m_pfadd(_m_pfmul(0, v92), _m_pfadd(_m_pfmul(0, v89), _m_pfadd(v91, _m_pfmul(v367, v88))));
        v95 = a1[4];
        v96 = _m_pfadd(_m_pfmul(v92, (__m64)0x3F80000000000000LL), v93);
        v97 = a1[5];
        a1[2].m64_u64 = (unsigned __int64)v94;
        a1[3].m64_u64 = (unsigned __int64)v96;
        v98 = _m_punpckhdq(v93, v95);
        v99 = _m_punpckhdq(v96, v97);
        v100 = _m_punpckldq(v95, v95);
        v101 = _m_punpckldq(v97, v97);
        v102 = _m_punpckhdq(v98, v98);
        v103 = _m_pfmul(v368, v102);
        v104 = _m_punpckhdq(v99, v99);
        v105 = _m_pfadd(_m_pfadd(_m_pfmul(v102, 0), _m_pfmul(v100, 0)), _m_pfmul(v101, v369));
        v106 = _m_pfadd(_m_pfmul(0, v104), _m_pfadd(_m_pfmul(0, v101), _m_pfadd(v103, _m_pfmul(v367, v100))));
        v107 = a1[6];
        v108 = _m_pfadd(_m_pfmul(v104, (__m64)0x3F80000000000000LL), v105);
        v109 = a1[7];
        a1[4].m64_u64 = (unsigned __int64)v106;
        a1[5].m64_u64 = (unsigned __int64)v108;
        v110 = _m_punpckhdq(v105, v107);
        v111 = _m_punpckhdq(v108, v109);
        v112 = _m_punpckldq(v107, v107);
        v113 = _m_punpckldq(v109, v109);
        v114 = _m_punpckhdq(v110, v110);
        v115 = _m_pfmul(v368, v114);
        v116 = _m_punpckhdq(v111, v111);
        v117 = _m_pfmul(0, v116);
        v118 = _m_pfadd(_m_pfadd(_m_pfmul(v114, 0), _m_pfmul(v112, 0)), _m_pfmul(v113, v369));
        v119 = _m_pfadd(_m_pfmul(v116, (__m64)0x3F80000000000000LL), v118);
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                            v117,
                                            _m_pfadd(_m_pfmul(0, v113), _m_pfadd(v115, _m_pfmul(v367, v112))));
        a1[7].m64_u64 = (unsigned __int64)v119;
        v120 = a1[1];
        v121 = _m_punpckhdq(v118, (__m64)a1->m64_u64);
        v122 = _m_punpckhdq(v119, v120);
        v123 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
        v124 = _m_punpckldq(v120, v120);
        v125 = _m_punpckhdq(v121, v121);
        v126 = _m_pfmul(v374, v125);
        v127 = _m_punpckhdq(v122, v122);
        v128 = _m_pfadd(_m_pfadd(_m_pfmul(v125, v376), _m_pfmul(v123, v372)), _m_pfmul(v124, v380));
        v129 = _m_pfadd(_m_pfmul(0, v127), _m_pfadd(_m_pfmul(v378, v124), _m_pfadd(v126, _m_pfmul(v370, v123))));
        v130 = a1[2];
        v131 = _m_pfadd(_m_pfmul(v127, v382), v128);
        v132 = a1[3];
        a1->m64_u64 = (unsigned __int64)v129;
        a1[1].m64_u64 = (unsigned __int64)v131;
        v133 = _m_punpckhdq(v128, v130);
        v134 = _m_punpckhdq(v131, v132);
        v135 = _m_punpckldq(v130, v130);
        v136 = _m_punpckldq(v132, v132);
        v137 = _m_punpckhdq(v133, v133);
        v138 = _m_pfmul(v374, v137);
        v139 = _m_punpckhdq(v134, v134);
        v140 = _m_pfadd(_m_pfadd(_m_pfmul(v137, v376), _m_pfmul(v135, v372)), _m_pfmul(v136, v380));
        v141 = _m_pfadd(_m_pfmul(0, v139), _m_pfadd(_m_pfmul(v378, v136), _m_pfadd(v138, _m_pfmul(v370, v135))));
        v142 = a1[4];
        v143 = _m_pfadd(_m_pfmul(v139, v382), v140);
        v144 = a1[5];
        a1[2].m64_u64 = (unsigned __int64)v141;
        a1[3].m64_u64 = (unsigned __int64)v143;
        v145 = _m_punpckhdq(v140, v142);
        v146 = _m_punpckhdq(v143, v144);
        v147 = _m_punpckldq(v142, v142);
        v148 = _m_punpckldq(v144, v144);
        v149 = _m_punpckhdq(v145, v145);
        v150 = _m_pfmul(v374, v149);
        v151 = _m_punpckhdq(v146, v146);
        v152 = _m_pfadd(_m_pfadd(_m_pfmul(v149, v376), _m_pfmul(v147, v372)), _m_pfmul(v148, v380));
        v153 = _m_pfadd(_m_pfmul(0, v151), _m_pfadd(_m_pfmul(v378, v148), _m_pfadd(v150, _m_pfmul(v370, v147))));
        v154 = a1[6];
        v155 = _m_pfadd(_m_pfmul(v151, v382), v152);
        v156 = a1[7];
        a1[4].m64_u64 = (unsigned __int64)v153;
        a1[5].m64_u64 = (unsigned __int64)v155;
        v157 = _m_punpckhdq(v152, v154);
        v158 = _m_punpckhdq(v155, v156);
        v159 = _m_punpckldq(v154, v154);
        v160 = _m_punpckldq(v156, v156);
        v161 = _m_punpckhdq(v157, v157);
        v162 = _m_punpckhdq(v158, v158);
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                            _m_pfmul(0, v162),
                                            _m_pfadd(
                                              _m_pfmul(v378, v160),
                                              _m_pfadd(_m_pfmul(v374, v161), _m_pfmul(v370, v159))));
        a1[7].m64_u64 = (unsigned __int64)_m_pfadd(
                                            _m_pfmul(v162, v382),
                                            _m_pfadd(
                                              _m_pfadd(_m_pfmul(v161, v376), _m_pfmul(v159, v372)),
                                              _m_pfmul(v160, v380)));
        v163 = _m_pfadd(_mm_cvtsi32_si64(a2[1].m64_u32[0]), _mm_cvtsi32_si64(a1[7].m64_u32[0]));
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd((__m64)a2->m64_u64, a1[6]);
        a1[7].m64_i32[0] = _mm_cvtsi64_si32(v163);
      }
      else
      {
        result = a1;
        a1->m64_u64 = (unsigned __int64)_m_punpckldq(v370, v374);
        a1[2].m64_u64 = (unsigned __int64)_m_punpckhdq(v370, v374);
        v164 = _m_punpckldq(v380, v382);
        a1[5].m64_u64 = (unsigned __int64)v164;
        a1[7].m64_u64 = (unsigned __int64)_m_punpckhdq(v380, v382);
        a1[4].m64_u64 = (unsigned __int64)_m_punpckldq(v372, v376);
        v165 = _m_punpckldq(v378, 0);
        a1[6].m64_u64 = (unsigned __int64)_m_punpckhdq(v372, v376);
        a1[3].m64_u64 = (unsigned __int64)_m_punpckhdq(v378, 0);
        a1[1].m64_u64 = (unsigned __int64)v165;
        v166 = a1[1];
        v167 = _m_punpckhdq(v165, (__m64)a1->m64_u64);
        v168 = _m_punpckhdq(v164, v166);
        v169 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
        v170 = _m_punpckldq(v166, v166);
        v171 = _m_punpckhdq(v167, v167);
        v172 = _m_pfmul(v368, v171);
        v173 = _m_punpckhdq(v168, v168);
        v174 = _m_pfadd(_m_pfadd(_m_pfmul(v171, 0), _m_pfmul(v169, 0)), _m_pfmul(v170, v369));
        v175 = _m_pfadd(_m_pfmul(0, v173), _m_pfadd(_m_pfmul(0, v170), _m_pfadd(v172, _m_pfmul(v367, v169))));
        v176 = a1[2];
        v177 = _m_pfadd(_m_pfmul(v173, (__m64)0x3F80000000000000LL), v174);
        v178 = a1[3];
        a1->m64_u64 = (unsigned __int64)v175;
        a1[1].m64_u64 = (unsigned __int64)v177;
        v179 = _m_punpckhdq(v174, v176);
        v180 = _m_punpckhdq(v177, v178);
        v181 = _m_punpckldq(v176, v176);
        v182 = _m_punpckldq(v178, v178);
        v183 = _m_punpckhdq(v179, v179);
        v184 = _m_pfmul(v368, v183);
        v185 = _m_punpckhdq(v180, v180);
        v186 = _m_pfadd(_m_pfadd(_m_pfmul(v183, 0), _m_pfmul(v181, 0)), _m_pfmul(v182, v369));
        v187 = _m_pfadd(_m_pfmul(0, v185), _m_pfadd(_m_pfmul(0, v182), _m_pfadd(v184, _m_pfmul(v367, v181))));
        v188 = a1[4];
        v189 = _m_pfadd(_m_pfmul(v185, (__m64)0x3F80000000000000LL), v186);
        v190 = a1[5];
        a1[2].m64_u64 = (unsigned __int64)v187;
        a1[3].m64_u64 = (unsigned __int64)v189;
        v191 = _m_punpckhdq(v186, v188);
        v192 = _m_punpckhdq(v189, v190);
        v193 = _m_punpckldq(v188, v188);
        v194 = _m_punpckldq(v190, v190);
        v195 = _m_punpckhdq(v191, v191);
        v196 = _m_pfmul(v368, v195);
        v197 = _m_punpckhdq(v192, v192);
        v198 = _m_pfadd(_m_pfadd(_m_pfmul(v195, 0), _m_pfmul(v193, 0)), _m_pfmul(v194, v369));
        v199 = _m_pfadd(_m_pfmul(0, v197), _m_pfadd(_m_pfmul(0, v194), _m_pfadd(v196, _m_pfmul(v367, v193))));
        v200 = a1[6];
        v201 = _m_pfadd(_m_pfmul(v197, (__m64)0x3F80000000000000LL), v198);
        v202 = a1[7];
        a1[4].m64_u64 = (unsigned __int64)v199;
        a1[5].m64_u64 = (unsigned __int64)v201;
        v203 = _m_punpckhdq(v198, v200);
        v204 = _m_punpckhdq(v201, v202);
        v205 = _m_punpckldq(v200, v200);
        v206 = _m_punpckldq(v202, v202);
        v207 = _m_punpckhdq(v203, v203);
        v208 = _m_pfmul(v368, v207);
        v209 = _m_punpckhdq(v204, v204);
        v210 = _m_pfmul(0, v209);
        v211 = _m_pfadd(_m_pfadd(_m_pfmul(v207, 0), _m_pfmul(v205, 0)), _m_pfmul(v206, v369));
        v212 = _m_pfadd(_m_pfmul(v209, (__m64)0x3F80000000000000LL), v211);
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                            v210,
                                            _m_pfadd(_m_pfmul(0, v206), _m_pfadd(v208, _m_pfmul(v367, v205))));
        a1[7].m64_u64 = (unsigned __int64)v212;
        v213 = a1[1];
        v214 = _m_punpckhdq(v211, (__m64)a1->m64_u64);
        v215 = _m_punpckhdq(v212, v213);
        v216 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
        v217 = _m_punpckldq(v213, v213);
        v218 = _m_punpckhdq(v214, v214);
        v219 = _m_pfmul(v374, v218);
        v220 = _m_punpckhdq(v215, v215);
        v221 = _m_pfadd(_m_pfadd(_m_pfmul(v218, v376), _m_pfmul(v216, v372)), _m_pfmul(v217, v380));
        v222 = _m_pfadd(_m_pfmul(0, v220), _m_pfadd(_m_pfmul(v378, v217), _m_pfadd(v219, _m_pfmul(v370, v216))));
        v223 = a1[2];
        v224 = _m_pfadd(_m_pfmul(v220, v382), v221);
        v225 = a1[3];
        a1->m64_u64 = (unsigned __int64)v222;
        a1[1].m64_u64 = (unsigned __int64)v224;
        v226 = _m_punpckhdq(v221, v223);
        v227 = _m_punpckhdq(v224, v225);
        v228 = _m_punpckldq(v223, v223);
        v229 = _m_punpckldq(v225, v225);
        v230 = _m_punpckhdq(v226, v226);
        v231 = _m_pfmul(v374, v230);
        v232 = _m_punpckhdq(v227, v227);
        v233 = _m_pfadd(_m_pfadd(_m_pfmul(v230, v376), _m_pfmul(v228, v372)), _m_pfmul(v229, v380));
        v234 = _m_pfadd(_m_pfmul(0, v232), _m_pfadd(_m_pfmul(v378, v229), _m_pfadd(v231, _m_pfmul(v370, v228))));
        v235 = a1[4];
        v236 = _m_pfadd(_m_pfmul(v232, v382), v233);
        v237 = a1[5];
        a1[2].m64_u64 = (unsigned __int64)v234;
        a1[3].m64_u64 = (unsigned __int64)v236;
        v238 = _m_punpckhdq(v233, v235);
        v239 = _m_punpckhdq(v236, v237);
        v240 = _m_punpckldq(v235, v235);
        v241 = _m_punpckldq(v237, v237);
        v242 = _m_punpckhdq(v238, v238);
        v243 = _m_pfmul(v374, v242);
        v244 = _m_punpckhdq(v239, v239);
        v245 = _m_pfadd(_m_pfadd(_m_pfmul(v242, v376), _m_pfmul(v240, v372)), _m_pfmul(v241, v380));
        v246 = _m_pfadd(_m_pfmul(0, v244), _m_pfadd(_m_pfmul(v378, v241), _m_pfadd(v243, _m_pfmul(v370, v240))));
        v247 = a1[6];
        v248 = _m_pfadd(_m_pfmul(v244, v382), v245);
        v249 = a1[7];
        a1[4].m64_u64 = (unsigned __int64)v246;
        a1[5].m64_u64 = (unsigned __int64)v248;
        v250 = _m_punpckhdq(v245, v247);
        v251 = _m_punpckhdq(v248, v249);
        v252 = _m_punpckldq(v247, v247);
        v253 = _m_punpckldq(v249, v249);
        v254 = _m_punpckhdq(v250, v250);
        v255 = _m_punpckhdq(v251, v251);
        a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                            _m_pfmul(0, v255),
                                            _m_pfadd(
                                              _m_pfmul(v378, v253),
                                              _m_pfadd(_m_pfmul(v374, v254), _m_pfmul(v370, v252))));
        a1[7].m64_u64 = (unsigned __int64)_m_pfadd(
                                            _m_pfmul(v255, v382),
                                            _m_pfadd(
                                              _m_pfadd(_m_pfmul(v254, v376), _m_pfmul(v252, v372)),
                                              _m_pfmul(v253, v380)));
      }
    }
    else
    {
      v256 = _mm_cvtsi32_si64(a4[1].m64_u32[0]);
      v257 = _m_punpckhdq(0, (__m64)a4->m64_u64);
      a1->m64_u64 = (unsigned __int64)_m_punpckldq((__m64)a4->m64_u64, 0);
      a1[1].m64_u64 = 0;
      a1[2].m64_u64 = (unsigned __int64)v257;
      a1[3].m64_u64 = 0;
      a1[4].m64_u64 = 0;
      a1[5].m64_u64 = (unsigned __int64)v256;
      a1[6].m64_u64 = 0;
      a1[7].m64_u64 = 0x3F80000000000000LL;
    }
  }
  else
  {
    v258 = _mm_cvtsi32_si64(0x3F800000u);
    v259 = _m_pswapd(v258);
    a1->m64_u64 = (unsigned __int64)v258;
    a1[1].m64_u64 = 0;
    a1[2].m64_u64 = (unsigned __int64)v259;
    a1[3].m64_u64 = 0;
    a1[4].m64_u64 = 0;
    a1[5].m64_u64 = (unsigned __int64)v258;
    a1[6].m64_u64 = 0;
    a1[7].m64_u64 = (unsigned __int64)v259;
  }
  if ( a6 )
  {
    v260 = a6[1];
    v261 = _m_pfadd(v260, v260);
    v262 = _m_pfadd((__m64)a6->m64_u64, (__m64)a6->m64_u64);
    v263 = _m_pfmul(v262, (__m64)a6->m64_u64);
    v264 = _m_punpckldq(v262, v261);
    v265 = _m_pfmul((__m64)a6->m64_u64, v261);
    v266 = _m_pfmul(_m_pswapd((__m64)a6->m64_u64), v261);
    v267 = _m_pfmul(v261, v260);
    v268 = _m_pfmul(_m_punpckhdq((__m64)a6->m64_u64, v260), v264);
    v269 = _m_pfpnacc(v266, v266);
    v270 = _m_pfpnacc(v268, v268);
    v271 = _m_pfpnacc(v265, v265);
    v272 = _m_pfsub(_m_pfsubr(v263, (__m64)0x3F8000003F800000LL), _m_punpckldq(v267, v267));
    v273 = _m_punpckldq(_m_pswapd(v271), v269);
    v274 = _m_punpckldq(v271, 0);
    v379 = v273;
    v275 = _m_punpckhdq(v269, 0);
    v373 = v274;
    v381 = _m_punpckhdq(_m_pfsubr(_m_pfacc(v263, v263), (__m64)0x3F8000003F800000LL), 0);
    v371 = _m_punpckhdq(v272, v270);
    v375 = _m_punpckldq(v270, v272);
    v377 = v275;
    v383 = _m_punpckldq(0, (__m64)1065353216LL);
    if ( a5 )
    {
      v276 = (__m64)a5->m64_u64;
      v277 = _mm_cvtsi32_si64(a5[1].m64_u32[0]);
      v278 = _m_pfsub(_mm_cvtsi32_si64(result[7].m64_u32[0]), v277);
      result[6].m64_u64 = (unsigned __int64)_m_pfsub(result[6], (__m64)a5->m64_u64);
      result[7].m64_i32[0] = _mm_cvtsi64_si32(v278);
      v279 = result[1];
      v280 = _m_punpckhdq(v276, (__m64)result->m64_u64);
      v281 = _m_punpckhdq(v277, v279);
      v282 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
      v283 = _m_punpckldq(v279, v279);
      v284 = _m_punpckhdq(v280, v280);
      v285 = _m_pfmul(v375, v284);
      v286 = _m_punpckhdq(v281, v281);
      v287 = _m_pfadd(_m_pfadd(_m_pfmul(v284, v377), _m_pfmul(v282, v373)), _m_pfmul(v283, v381));
      v288 = _m_pfadd(_m_pfmul(0, v286), _m_pfadd(_m_pfmul(v379, v283), _m_pfadd(v285, _m_pfmul(v371, v282))));
      v289 = result[2];
      v290 = _m_pfadd(_m_pfmul(v286, v383), v287);
      v291 = result[3];
      result->m64_u64 = (unsigned __int64)v288;
      result[1].m64_u64 = (unsigned __int64)v290;
      v292 = _m_punpckhdq(v287, v289);
      v293 = _m_punpckhdq(v290, v291);
      v294 = _m_punpckldq(v289, v289);
      v295 = _m_punpckldq(v291, v291);
      v296 = _m_punpckhdq(v292, v292);
      v297 = _m_pfmul(v375, v296);
      v298 = _m_punpckhdq(v293, v293);
      v299 = _m_pfadd(_m_pfadd(_m_pfmul(v296, v377), _m_pfmul(v294, v373)), _m_pfmul(v295, v381));
      v300 = _m_pfadd(_m_pfmul(0, v298), _m_pfadd(_m_pfmul(v379, v295), _m_pfadd(v297, _m_pfmul(v371, v294))));
      v301 = result[4];
      v302 = _m_pfadd(_m_pfmul(v298, v383), v299);
      v303 = result[5];
      result[2].m64_u64 = (unsigned __int64)v300;
      result[3].m64_u64 = (unsigned __int64)v302;
      v304 = _m_punpckhdq(v299, v301);
      v305 = _m_punpckhdq(v302, v303);
      v306 = _m_punpckldq(v301, v301);
      v307 = _m_punpckldq(v303, v303);
      v308 = _m_punpckhdq(v304, v304);
      v309 = _m_pfmul(v375, v308);
      v310 = _m_punpckhdq(v305, v305);
      v311 = _m_pfadd(_m_pfadd(_m_pfmul(v308, v377), _m_pfmul(v306, v373)), _m_pfmul(v307, v381));
      v312 = _m_pfadd(_m_pfmul(0, v310), _m_pfadd(_m_pfmul(v379, v307), _m_pfadd(v309, _m_pfmul(v371, v306))));
      v313 = result[6];
      v314 = _m_pfadd(_m_pfmul(v310, v383), v311);
      v315 = result[7];
      result[4].m64_u64 = (unsigned __int64)v312;
      result[5].m64_u64 = (unsigned __int64)v314;
      v316 = _m_punpckhdq(v311, v313);
      v317 = _m_punpckhdq(v314, v315);
      v318 = _m_punpckldq(v313, v313);
      v319 = _m_punpckldq(v315, v315);
      v320 = _m_punpckhdq(v316, v316);
      v321 = _m_punpckhdq(v317, v317);
      result[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                              _m_pfmul(0, v321),
                                              _m_pfadd(
                                                _m_pfmul(v379, v319),
                                                _m_pfadd(_m_pfmul(v375, v320), _m_pfmul(v371, v318))));
      result[7].m64_u64 = (unsigned __int64)_m_pfadd(
                                              _m_pfmul(v321, v383),
                                              _m_pfadd(
                                                _m_pfadd(_m_pfmul(v320, v377), _m_pfmul(v318, v373)),
                                                _m_pfmul(v319, v381)));
      v322 = _m_pfadd(_mm_cvtsi32_si64(result[7].m64_u32[0]), _mm_cvtsi32_si64(a5[1].m64_u32[0]));
      result[6].m64_u64 = (unsigned __int64)_m_pfadd(result[6], (__m64)a5->m64_u64);
      result[7].m64_i32[0] = _mm_cvtsi64_si32(v322);
    }
    else
    {
      v323 = result[1];
      v324 = _m_punpckhdq(v274, (__m64)result->m64_u64);
      v325 = _m_punpckhdq(v275, v323);
      v326 = _m_punpckldq((__m64)result->m64_u64, (__m64)result->m64_u64);
      v327 = _m_punpckldq(v323, v323);
      v328 = _m_punpckhdq(v324, v324);
      v329 = _m_pfmul(v375, v328);
      v330 = _m_punpckhdq(v325, v325);
      v331 = _m_pfadd(_m_pfadd(_m_pfmul(v328, v377), _m_pfmul(v326, v373)), _m_pfmul(v327, v381));
      v332 = _m_pfadd(_m_pfmul(0, v330), _m_pfadd(_m_pfmul(v379, v327), _m_pfadd(v329, _m_pfmul(v371, v326))));
      v333 = result[2];
      v334 = _m_pfadd(_m_pfmul(v330, v383), v331);
      v335 = result[3];
      result->m64_u64 = (unsigned __int64)v332;
      result[1].m64_u64 = (unsigned __int64)v334;
      v336 = _m_punpckhdq(v331, v333);
      v337 = _m_punpckhdq(v334, v335);
      v338 = _m_punpckldq(v333, v333);
      v339 = _m_punpckldq(v335, v335);
      v340 = _m_punpckhdq(v336, v336);
      v341 = _m_pfmul(v375, v340);
      v342 = _m_punpckhdq(v337, v337);
      v343 = _m_pfadd(_m_pfadd(_m_pfmul(v340, v377), _m_pfmul(v338, v373)), _m_pfmul(v339, v381));
      v344 = _m_pfadd(_m_pfmul(0, v342), _m_pfadd(_m_pfmul(v379, v339), _m_pfadd(v341, _m_pfmul(v371, v338))));
      v345 = result[4];
      v346 = _m_pfadd(_m_pfmul(v342, v383), v343);
      v347 = result[5];
      result[2].m64_u64 = (unsigned __int64)v344;
      result[3].m64_u64 = (unsigned __int64)v346;
      v348 = _m_punpckhdq(v343, v345);
      v349 = _m_punpckhdq(v346, v347);
      v350 = _m_punpckldq(v345, v345);
      v351 = _m_punpckldq(v347, v347);
      v352 = _m_punpckhdq(v348, v348);
      v353 = _m_pfmul(v375, v352);
      v354 = _m_punpckhdq(v349, v349);
      v355 = _m_pfadd(_m_pfadd(_m_pfmul(v352, v377), _m_pfmul(v350, v373)), _m_pfmul(v351, v381));
      v356 = _m_pfadd(_m_pfmul(0, v354), _m_pfadd(_m_pfmul(v379, v351), _m_pfadd(v353, _m_pfmul(v371, v350))));
      v357 = result[6];
      v358 = _m_pfadd(_m_pfmul(v354, v383), v355);
      v359 = result[7];
      result[4].m64_u64 = (unsigned __int64)v356;
      result[5].m64_u64 = (unsigned __int64)v358;
      v360 = _m_punpckhdq(v355, v357);
      v361 = _m_punpckhdq(v358, v359);
      v362 = _m_punpckldq(v357, v357);
      v363 = _m_punpckldq(v359, v359);
      v364 = _m_punpckhdq(v360, v360);
      v365 = _m_punpckhdq(v361, v361);
      result[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                              _m_pfmul(0, v365),
                                              _m_pfadd(
                                                _m_pfmul(v379, v363),
                                                _m_pfadd(_m_pfmul(v375, v364), _m_pfmul(v371, v362))));
      result[7].m64_u64 = (unsigned __int64)_m_pfadd(
                                              _m_pfmul(v365, v383),
                                              _m_pfadd(
                                                _m_pfadd(_m_pfmul(v364, v377), _m_pfmul(v362, v373)),
                                                _m_pfmul(v363, v381)));
    }
  }
  if ( a7 )
  {
    v366 = _m_pfadd(_mm_cvtsi32_si64(result[7].m64_u32[0]), _mm_cvtsi32_si64(a7[1].m64_u32[0]));
    result[6].m64_u64 = (unsigned __int64)_m_pfadd(result[6], (__m64)a7->m64_u64);
    result[7].m64_i32[0] = _mm_cvtsi64_si32(v366);
  }
  _m_femms();
  return result;
}

// sub_45DD30 @ 0x0045DD30
int __stdcall sub_45DD30(__m64 *a1, _DWORD *a2, __m64 *a3)
{
  __m64 v3; // mm1
  __m64 v4; // mm2
  __m64 v5; // mm0
  __m64 v6; // mm5
  __m64 v7; // mm6
  __m64 v8; // mm1
  __m64 v9; // mm0
  __m64 v10; // mm7
  __m64 v11; // mm2
  __m64 v12; // rt1
  __m64 v13; // mm1
  __m64 v14; // mm0
  __m64 v15; // mm5
  __m64 v16; // mm6
  __m64 v17; // mm1
  __m64 v18; // mm0
  __m64 v19; // mm7
  __m64 v20; // mm2
  __m64 v21; // mm0
  __m64 v22; // mm0
  __m64 v23; // mm1
  int result; // eax
  __m64 v25; // mm0
  __m64 v26; // mm1
  __m64 v27; // mm3
  __m64 v28; // mm6
  __m64 v29; // mm4
  __m64 v30; // mm7
  __m64 v31; // mm3
  __m64 v32; // mm6
  __m64 v33; // mm4
  __m64 v34; // mm7
  __m64 v35; // [esp+0h] [ebp-40h]
  __m64 v36; // [esp+8h] [ebp-38h]
  __m64 v37; // [esp+10h] [ebp-30h]
  __m64 v38; // [esp+18h] [ebp-28h]
  __m64 v39; // [esp+20h] [ebp-20h]
  __m64 v40; // [esp+28h] [ebp-18h]
  __m64 v41; // [esp+30h] [ebp-10h]
  __m64 v42; // [esp+38h] [ebp-8h]

  v3 = a3[2];
  v4 = a3[4];
  v5 = _m_pswapd(a3[6]);
  v6 = _m_pfnacc(_m_pfmul(_m_pswapd(v3), (__m64)a3->m64_u64), _m_pfmul(_m_pswapd(v4), (__m64)a3->m64_u64));
  v7 = _m_pfnacc(_m_pfmul(v5, (__m64)a3->m64_u64), _m_pfmul(_m_pswapd(v4), v3));
  v8 = _m_pfnacc(_m_pfmul(v3, v5), _m_pfmul(v4, v5));
  v9 = a3[7];
  v10 = a3[5];
  v36 = _m_pfsub(
          _m_pfadd(_m_pfmul(_m_punpckhdq(v7, v7), v9), _m_pfmul(_m_punpckhdq(v8, v8), a3[3])),
          _m_pfmul(_m_punpckldq(v8, v8), v10));
  v38 = _m_pfadd(
          _m_pfsub(_m_pfmul(_m_punpckhdq(v6, v6), v9), _m_pfmul(_m_punpckldq(v7, v7), v10)),
          _m_pfmul(_m_punpckhdq(v8, v8), a3[1]));
  v11 = _m_punpckldq(v6, v6);
  v40 = _m_pfsub(
          _m_pfadd(_m_pfmul(v9, v11), _m_pfmul(_m_punpckldq(v8, v8), a3[1])),
          _m_pfmul(_m_punpckldq(v7, v7), a3[3]));
  v12 = a3[1];
  v42 = _m_pfadd(
          _m_pfsub(_m_pfmul(v11, v10), _m_pfmul(_m_punpckhdq(v6, v6), a3[3])),
          _m_pfmul(_m_punpckhdq(v7, v7), v12));
  v13 = a3[3];
  v14 = _m_pswapd(v9);
  v15 = _m_pfnacc(_m_pfmul(_m_pswapd(v13), v12), _m_pfmul(_m_pswapd(v10), v12));
  v16 = _m_pfnacc(_m_pfmul(v14, v12), _m_pfmul(_m_pswapd(v10), v13));
  v17 = _m_pfnacc(_m_pfmul(v13, v14), _m_pfmul(v10, v14));
  v18 = a3[6];
  v19 = a3[4];
  v35 = _m_pfsub(
          _m_pfadd(_m_pfmul(_m_punpckhdq(v16, v16), v18), _m_pfmul(_m_punpckhdq(v17, v17), a3[2])),
          _m_pfmul(_m_punpckldq(v17, v17), v19));
  v37 = _m_pfadd(
          _m_pfsub(_m_pfmul(_m_punpckhdq(v15, v15), v18), _m_pfmul(_m_punpckldq(v16, v16), v19)),
          _m_pfmul(_m_punpckhdq(v17, v17), (__m64)a3->m64_u64));
  v20 = _m_punpckldq(v15, v15);
  v39 = _m_pfsub(
          _m_pfadd(_m_pfmul(v18, v20), _m_pfmul(_m_punpckldq(v17, v17), (__m64)a3->m64_u64)),
          _m_pfmul(_m_punpckldq(v16, v16), a3[2]));
  v41 = _m_pfadd(
          _m_pfsub(_m_pfmul(v20, v19), _m_pfmul(_m_punpckhdq(v15, v15), a3[2])),
          _m_pfmul(_m_punpckhdq(v16, v16), (__m64)a3->m64_u64));
  v21 = _m_pfnacc(
          _m_pfmul(_m_punpckhdq(v39, v41), _m_punpckldq(v19, v18)),
          _m_pfmul(_m_punpckldq((__m64)a3->m64_u64, (__m64)a3[2].m64_u32[0]), _m_punpckhdq(v35, v37)));
  v22 = _m_pfacc(v21, v21);
  if ( a2 )
    *a2 = _mm_cvtsi64_si32(v22);
  v23 = _m_pfrcp(v22);
  result = _mm_cvtsi64_si32(_m_pfcmpeq(0, v22));
  v25 = _m_pfmul(_m_pfrcpit2(_m_pfrcpit1(_m_punpckldq(v22, v22), v23), v23), (__m64)0xBF8000003F800000uLL);
  v26 = _m_pswapd(v25);
  if ( !result )
  {
    result = (int)a1;
    v27 = _m_pfmul(v37, v25);
    v28 = _m_pfmul(v38, v25);
    v29 = _m_pfmul(v35, v26);
    v30 = _m_pfmul(v36, v26);
    a1->m64_u64 = (unsigned __int64)_m_punpckhdq(v29, v27);
    a1[2].m64_u64 = (unsigned __int64)_m_punpckldq(v29, v27);
    a1[4].m64_u64 = (unsigned __int64)_m_punpckhdq(v30, v28);
    a1[6].m64_u64 = (unsigned __int64)_m_punpckldq(v30, v28);
    v31 = _m_pfmul(v41, v25);
    v32 = _m_pfmul(v42, v25);
    v33 = _m_pfmul(v39, v26);
    v34 = _m_pfmul(v40, v26);
    a1[1].m64_u64 = (unsigned __int64)_m_punpckhdq(v33, v31);
    a1[3].m64_u64 = (unsigned __int64)_m_punpckldq(v33, v31);
    a1[5].m64_u64 = (unsigned __int64)_m_punpckhdq(v34, v32);
    a1[7].m64_u64 = (unsigned __int64)_m_punpckldq(v34, v32);
  }
  _m_femms();
  return result;
}

// sub_45E012 @ 0x0045E012
__m64 *__stdcall sub_45E012(__m64 *a1, __m64 *a2, __m64 *a3)
{
  __m64 v3; // mm1
  __m64 v4; // mm4
  __m64 v5; // mm5
  __m64 v6; // mm7
  __m64 v7; // mm0
  __m64 v8; // mm1
  __m64 v9; // mm4
  __m64 *result; // eax
  __m64 v11; // mm4
  __m64 v12; // mm4
  __m64 v13; // mm4
  __m64 v14; // mm4
  __m64 v15; // mm4
  __m64 v16; // mm4
  __m64 v17; // mm4
  __m64 v18; // [esp+0h] [ebp-44h]
  __m64 v19; // [esp+0h] [ebp-44h]
  __m64 v20; // [esp+8h] [ebp-3Ch]
  __m64 v21; // [esp+8h] [ebp-3Ch]
  __m64 v22; // [esp+10h] [ebp-34h]
  __m64 v23; // [esp+10h] [ebp-34h]
  __m64 v24; // [esp+18h] [ebp-2Ch]
  __m64 v25; // [esp+18h] [ebp-2Ch]
  __m64 v26; // [esp+20h] [ebp-24h]
  __m64 v27; // [esp+20h] [ebp-24h]
  __m64 v28; // [esp+28h] [ebp-1Ch]
  __m64 v29; // [esp+28h] [ebp-1Ch]
  __m64 v30; // [esp+30h] [ebp-14h]
  __m64 v31; // [esp+38h] [ebp-Ch]

  _m_femms();
  v3 = a3[2];
  v4 = a3[7];
  v5 = a3[5];
  v18 = _m_punpckldq((__m64)a3->m64_u64, v3);
  v22 = _m_punpckhdq((__m64)a3->m64_u64, v3);
  v6 = a3[3];
  v7 = a3[4];
  v8 = a3[1];
  v28 = _m_punpckldq(v5, v4);
  v31 = _m_punpckhdq(v5, v4);
  v9 = a3[6];
  v26 = _m_punpckldq(v8, v6);
  v30 = _m_punpckhdq(v8, v6);
  v24 = _m_punpckhdq(v7, v9);
  v20 = _m_punpckldq(v7, v9);
  result = a1;
  v11 = _m_pfadd(
          _m_pfacc(_m_pfmul(v18, a2[4]), _m_pfmul(v18, a2[6])),
          _m_pfacc(_m_pfmul(v20, a2[5]), _m_pfmul(v20, a2[7])));
  if ( a2 == a1 )
  {
    v19 = _m_pfadd(
            _m_pfacc(_m_pfmul(v18, (__m64)a2->m64_u64), _m_pfmul(v18, a2[2])),
            _m_pfacc(_m_pfmul(v20, a2[1]), _m_pfmul(v20, a2[3])));
    v21 = v11;
    v15 = _m_pfadd(
            _m_pfacc(_m_pfmul(v22, a2[4]), _m_pfmul(v22, a2[6])),
            _m_pfacc(_m_pfmul(v24, a2[5]), _m_pfmul(v24, a2[7])));
    v23 = _m_pfadd(
            _m_pfacc(_m_pfmul(v22, (__m64)a2->m64_u64), _m_pfmul(v22, a2[2])),
            _m_pfacc(_m_pfmul(v24, a2[1]), _m_pfmul(v24, a2[3])));
    v25 = v15;
    v16 = _m_pfadd(
            _m_pfacc(_m_pfmul(v26, a2[4]), _m_pfmul(v26, a2[6])),
            _m_pfacc(_m_pfmul(v28, a2[5]), _m_pfmul(v28, a2[7])));
    v27 = _m_pfadd(
            _m_pfacc(_m_pfmul(v26, (__m64)a2->m64_u64), _m_pfmul(v26, a2[2])),
            _m_pfacc(_m_pfmul(v28, a2[1]), _m_pfmul(v28, a2[3])));
    v29 = v16;
    v17 = _m_pfadd(
            _m_pfacc(_m_pfmul(v30, a2[4]), _m_pfmul(v30, a2[6])),
            _m_pfacc(_m_pfmul(v31, a2[5]), _m_pfmul(v31, a2[7])));
    a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                        _m_pfacc(_m_pfmul(v30, (__m64)a2->m64_u64), _m_pfmul(v30, a2[2])),
                                        _m_pfacc(_m_pfmul(v31, a2[1]), _m_pfmul(v31, a2[3])));
    a1[7].m64_u64 = (unsigned __int64)v17;
    a1->m64_u64 = (unsigned __int64)v19;
    a1[1].m64_u64 = (unsigned __int64)v21;
    a1[2].m64_u64 = (unsigned __int64)v23;
    a1[3].m64_u64 = (unsigned __int64)v25;
    a1[4].m64_u64 = (unsigned __int64)v27;
    a1[5].m64_u64 = (unsigned __int64)v29;
  }
  else
  {
    a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                      _m_pfacc(_m_pfmul(v18, (__m64)a2->m64_u64), _m_pfmul(v18, a2[2])),
                                      _m_pfacc(_m_pfmul(v20, a2[1]), _m_pfmul(v20, a2[3])));
    a1[1].m64_u64 = (unsigned __int64)v11;
    v12 = _m_pfadd(
            _m_pfacc(_m_pfmul(v22, a2[4]), _m_pfmul(v22, a2[6])),
            _m_pfacc(_m_pfmul(v24, a2[5]), _m_pfmul(v24, a2[7])));
    a1[2].m64_u64 = (unsigned __int64)_m_pfadd(
                                        _m_pfacc(_m_pfmul(v22, (__m64)a2->m64_u64), _m_pfmul(v22, a2[2])),
                                        _m_pfacc(_m_pfmul(v24, a2[1]), _m_pfmul(v24, a2[3])));
    a1[3].m64_u64 = (unsigned __int64)v12;
    v13 = _m_pfadd(
            _m_pfacc(_m_pfmul(v26, a2[4]), _m_pfmul(v26, a2[6])),
            _m_pfacc(_m_pfmul(v28, a2[5]), _m_pfmul(v28, a2[7])));
    a1[4].m64_u64 = (unsigned __int64)_m_pfadd(
                                        _m_pfacc(_m_pfmul(v26, (__m64)a2->m64_u64), _m_pfmul(v26, a2[2])),
                                        _m_pfacc(_m_pfmul(v28, a2[1]), _m_pfmul(v28, a2[3])));
    a1[5].m64_u64 = (unsigned __int64)v13;
    v14 = _m_pfadd(
            _m_pfacc(_m_pfmul(v30, a2[4]), _m_pfmul(v30, a2[6])),
            _m_pfacc(_m_pfmul(v31, a2[5]), _m_pfmul(v31, a2[7])));
    a1[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                        _m_pfacc(_m_pfmul(v30, (__m64)a2->m64_u64), _m_pfmul(v30, a2[2])),
                                        _m_pfacc(_m_pfmul(v31, a2[1]), _m_pfmul(v31, a2[3])));
    a1[7].m64_u64 = (unsigned __int64)v14;
  }
  _m_femms();
  return result;
}

// mat4_invert @ 0x0045E40A
// inverts a 4x4 matrix; optionally writes determinant
int __stdcall sub_45E40A(__m64 *a1, _DWORD *a2, __m64 *a3)
{
  __m64 v3; // mm1
  __m64 v4; // mm2
  __m64 v5; // mm5
  __m64 v6; // mm0
  __m64 v7; // mm4
  __m64 v8; // mm3
  __m64 v9; // mm6
  __m64 v10; // mm4
  __m64 v11; // mm6
  __m64 v12; // mm1
  __m64 v13; // mm0
  __m64 v14; // mm7
  __m64 v15; // mm2
  __m64 v16; // mm0
  __m64 v17; // mm1
  __m64 v18; // mm5
  __m64 v19; // mm0
  __m64 v20; // mm4
  __m64 v21; // mm3
  __m64 v22; // mm6
  __m64 v23; // mm4
  __m64 v24; // mm6
  __m64 v25; // mm1
  __m64 v26; // mm0
  __m64 v27; // mm7
  __m64 v28; // mm2
  __m64 v29; // mm2
  __m64 v30; // mm0
  __m64 v31; // mm0
  __m64 v32; // mm1
  int result; // eax
  __m64 v34; // mm0
  __m64 v35; // mm1
  __m64 v36; // mm3
  __m64 v37; // mm6
  __m64 v38; // mm4
  __m64 v39; // mm7
  __m64 v40; // mm3
  __m64 v41; // mm6
  __m64 v42; // mm4
  __m64 v43; // mm7
  __m64 v44; // [esp+0h] [ebp-44h]
  __m64 v45; // [esp+8h] [ebp-3Ch]
  __m64 v46; // [esp+10h] [ebp-34h]
  __m64 v47; // [esp+18h] [ebp-2Ch]
  __m64 v48; // [esp+20h] [ebp-24h]
  __m64 v49; // [esp+28h] [ebp-1Ch]
  __m64 v50; // [esp+38h] [ebp-Ch]

  v3 = a3[2];
  v4 = a3[4];
  v5 = _m_pfsub(
         _m_pfmul(_m_punpckldq((__m64)a3->m64_u64, (__m64)a3->m64_u64), _m_punpckhdq(v3, v4)),
         _m_pfmul(_m_punpckhdq((__m64)a3->m64_u64, (__m64)a3->m64_u64), _m_punpckldq(v3, v4)));
  v6 = _m_punpckldq((__m64)a3->m64_u64, v3);
  v7 = a3[6];
  v8 = _m_punpckhdq(v7, v7);
  v9 = _m_punpckhdq(v7, v4);
  v10 = _m_punpckldq(v7, v4);
  v11 = _m_pfsub(_m_pfmul(v9, v6), _m_pfmul(_m_punpckhdq((__m64)a3->m64_u64, v3), v10));
  v12 = _m_pfsubr(_m_pfmul(_m_punpckhdq(v3, v4), _m_punpckldq(v10, v10)), _m_pfmul(_m_punpckhdq(v6, v10), v8));
  v13 = a3[7];
  v14 = a3[5];
  v45 = _m_pfsub(
          _m_pfadd(_m_pfmul(_m_punpckhdq(v11, v11), v13), _m_pfmul(_m_punpckhdq(v12, v12), a3[3])),
          _m_pfmul(_m_punpckldq(v12, v12), v14));
  v47 = _m_pfadd(
          _m_pfsub(_m_pfmul(_m_punpckhdq(v5, v5), v13), _m_pfmul(_m_punpckldq(v11, v11), v14)),
          _m_pfmul(_m_punpckhdq(v12, v12), a3[1]));
  v15 = _m_punpckldq(v5, v5);
  v49 = _m_pfsub(
          _m_pfadd(_m_pfmul(v13, v15), _m_pfmul(_m_punpckldq(v12, v12), a3[1])),
          _m_pfmul(_m_punpckldq(v11, v11), a3[3]));
  v50 = _m_pfadd(
          _m_pfsub(_m_pfmul(v15, v14), _m_pfmul(_m_punpckhdq(v5, v5), a3[3])),
          _m_pfmul(_m_punpckhdq(v11, v11), a3[1]));
  v16 = a3[1];
  v17 = a3[3];
  v18 = _m_pfsub(
          _m_pfmul(_m_punpckldq(v16, v16), _m_punpckhdq(v17, v14)),
          _m_pfmul(_m_punpckhdq(v16, v16), _m_punpckldq(v17, v14)));
  v19 = _m_punpckldq(v16, v17);
  v20 = a3[7];
  v21 = _m_punpckhdq(v20, v20);
  v22 = _m_punpckhdq(v20, v14);
  v23 = _m_punpckldq(v20, v14);
  v24 = _m_pfsub(_m_pfmul(v22, v19), _m_pfmul(_m_punpckhdq(a3[1], v17), v23));
  v25 = _m_pfsubr(_m_pfmul(_m_punpckhdq(v17, v14), _m_punpckldq(v23, v23)), _m_pfmul(_m_punpckhdq(v19, v23), v21));
  v26 = a3[6];
  v27 = a3[4];
  v44 = _m_pfsub(
          _m_pfadd(_m_pfmul(_m_punpckhdq(v24, v24), v26), _m_pfmul(_m_punpckhdq(v25, v25), a3[2])),
          _m_pfmul(_m_punpckldq(v25, v25), v27));
  v46 = _m_pfadd(
          _m_pfsub(_m_pfmul(_m_punpckhdq(v18, v18), v26), _m_pfmul(_m_punpckldq(v24, v24), v27)),
          _m_pfmul(_m_punpckhdq(v25, v25), (__m64)a3->m64_u64));
  v28 = _m_punpckldq(v18, v18);
  v48 = _m_pfsub(
          _m_pfadd(_m_pfmul(v26, v28), _m_pfmul(_m_punpckldq(v25, v25), (__m64)a3->m64_u64)),
          _m_pfmul(_m_punpckldq(v24, v24), a3[2]));
  v29 = _m_pfadd(
          _m_pfsub(_m_pfmul(v28, v27), _m_pfmul(_m_punpckhdq(v18, v18), a3[2])),
          _m_pfmul(_m_punpckhdq(v24, v24), (__m64)a3->m64_u64));
  v30 = _m_pfadd(
          _m_pfmul(_m_punpckhdq(v48, v29), _m_pfmul(_m_punpckldq(v27, v26), (__m64)0xBF8000003F800000uLL)),
          _m_pfmul(
            _m_pfmul(_m_punpckldq((__m64)a3->m64_u64, (__m64)a3[2].m64_u32[0]), (__m64)0xBF8000003F800000uLL),
            _m_punpckhdq(v44, v46)));
  v31 = _m_pfacc(v30, v30);
  if ( a2 )
    *a2 = _mm_cvtsi64_si32(v31);
  v32 = _m_pfrcp(v31);
  result = _mm_cvtsi64_si32(_m_pfcmpeq(0, v31));
  v34 = _m_pfmul(_m_pfrcpit2(_m_pfrcpit1(_m_punpckldq(v31, v31), v32), v32), (__m64)0xBF8000003F800000uLL);
  v35 = _m_punpckhdq(v34, _m_punpckldq(v29, v34));
  if ( !result )
  {
    v36 = _m_pfmul(v46, v34);
    v37 = _m_pfmul(v47, v34);
    v38 = _m_pfmul(v44, v35);
    v39 = _m_pfmul(v45, v35);
    a1->m64_u64 = (unsigned __int64)_m_punpckhdq(v38, v36);
    a1[2].m64_u64 = (unsigned __int64)_m_punpckldq(v38, v36);
    a1[4].m64_u64 = (unsigned __int64)_m_punpckhdq(v39, v37);
    a1[6].m64_u64 = (unsigned __int64)_m_punpckldq(v39, v37);
    v40 = _m_pfmul(v29, v34);
    v41 = _m_pfmul(v50, v34);
    v42 = _m_pfmul(v48, v35);
    v43 = _m_pfmul(v49, v35);
    a1[1].m64_u64 = (unsigned __int64)_m_punpckhdq(v42, v40);
    a1[3].m64_u64 = (unsigned __int64)_m_punpckldq(v42, v40);
    a1[5].m64_u64 = (unsigned __int64)_m_punpckhdq(v43, v41);
    a1[7].m64_u64 = (unsigned __int64)_m_punpckldq(v43, v41);
    return (int)a1;
  }
  return result;
}

// sub_45E73E @ 0x0045E73E
__m64 *__stdcall sub_45E73E(__m64 *a1, _DWORD *a2, __m64 *a3)
{
  _m_femms();
  mat4_invert(a1, a2, a3);
  _m_femms();
  return a1;
}

// sub_45E75A @ 0x0045E75A
__m64 *__stdcall sub_45E75A(__m64 *a1, __m64 *a2, __m64 *a3)
{
  unsigned __int64 m64_u64; // mm1
  __m64 v4; // mm0
  __m64 v5; // mm2
  __m64 v6; // mm4
  __m64 v7; // mm5
  __m64 v8; // mm3

  _m_femms();
  m64_u64 = a2->m64_u64;
  v4 = _m_punpckldq((__m64)m64_u64, (__m64)m64_u64);
  v5 = _mm_cvtsi32_si64(a2[1].m64_u32[0]);
  v6 = _m_punpckhdq((__m64)m64_u64, (__m64)m64_u64);
  v7 = _m_punpckldq(v5, v5);
  v8 = _m_pfadd(_m_pfadd(_m_pfmul(v4, a3[1]), a3[7]), _m_pfadd(_m_pfmul(v6, a3[3]), _m_pfmul(v7, a3[5])));
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfadd(_m_pfmul(v4, (__m64)a3->m64_u64), a3[6]),
                                    _m_pfadd(_m_pfmul(v6, a3[2]), _m_pfmul(v7, a3[4])));
  a1[1].m64_u64 = (unsigned __int64)v8;
  _m_femms();
  return a1;
}

// sub_45E7CB @ 0x0045E7CB
__m64 *__stdcall sub_45E7CB(__m64 *a1, __m64 *a2, __m64 *a3)
{
  unsigned __int64 m64_u64; // mm1
  __m64 v4; // mm0
  __m64 v5; // mm2
  __m64 v6; // mm4
  __m64 v7; // mm5
  __m64 v8; // mm3

  _m_femms();
  m64_u64 = a2->m64_u64;
  v4 = _m_punpckldq((__m64)m64_u64, (__m64)m64_u64);
  v5 = _mm_cvtsi32_si64(a2[1].m64_u32[0]);
  v6 = _m_punpckhdq((__m64)m64_u64, (__m64)m64_u64);
  v7 = _m_punpckldq(v5, v5);
  v8 = _m_pfadd(_m_pfmul(v4, a3[1]), _m_pfadd(_m_pfmul(v6, a3[3]), _m_pfmul(v7, a3[5])));
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfmul(v4, (__m64)a3->m64_u64),
                                    _m_pfadd(_m_pfmul(v6, a3[2]), _m_pfmul(v7, a3[4])));
  a1[1].m64_i32[0] = _mm_cvtsi64_si32(v8);
  _m_femms();
  return a1;
}

// sub_45E832 @ 0x0045E832
__m64 *__stdcall sub_45E832(__m64 *a1, __m64 *a2)
{
  __m64 v2; // mm3
  __m64 v3; // mm0
  __m64 v4; // mm0
  __m64 v5; // mm4
  __m64 v6; // mm5
  __m64 v8; // mm0

  _m_femms();
  v2 = _mm_cvtsi32_si64(a2[1].m64_u32[0]);
  v3 = _m_pfadd(_m_pfmul((__m64)a2->m64_u64, (__m64)a2->m64_u64), _m_pfmul(v2, v2));
  v4 = _m_pfacc(v3, v3);
  v5 = _m_pfrsqrt(v4);
  v6 = _m_pfcmpgt(v4, (__m64)0x80000000800000LL);
  v8 = _m_pfrcpit2(_m_pfrsqit1(v4, _m_pfmul(v5, v5)), v5);
  a1->m64_u64 = (unsigned __int64)_m_pfmul(_m_pand((__m64)a2->m64_u64, v6), v8);
  a1[1].m64_i32[0] = _mm_cvtsi64_si32(_m_pfmul(_m_pand(v2, v6), v8));
  _m_femms();
  return a1;
}

// sub_45E891 @ 0x0045E891
__m64 *__stdcall sub_45E891(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, unsigned int a5, unsigned int a6)
{
  __m64 v6; // mm6
  __m64 v7; // mm5
  __m64 v8; // mm7
  __m64 v10; // mm6
  __m64 v11; // mm7
  __m64 v12; // mm1

  v6 = _mm_cvtsi32_si64(a5);
  v7 = _mm_cvtsi32_si64(a2[1].m64_u32[0]);
  v8 = _mm_cvtsi32_si64(a6);
  v10 = _m_punpckldq(v6, v6);
  v11 = _m_punpckldq(v8, v8);
  v12 = _m_pfadd(
          _m_pfadd(_m_pfmul(_m_pfsub(_mm_cvtsi32_si64(a3[1].m64_u32[0]), v7), v10), v7),
          _m_pfmul(_m_pfsub(_mm_cvtsi32_si64(a4[1].m64_u32[0]), v7), v11));
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfadd(
                                      _m_pfmul(_m_pfsub((__m64)a3->m64_u64, (__m64)a2->m64_u64), v10),
                                      (__m64)a2->m64_u64),
                                    _m_pfmul(_m_pfsub((__m64)a4->m64_u64, (__m64)a2->m64_u64), v11));
  a1[1].m64_i32[0] = _mm_cvtsi64_si32(v12);
  _m_femms();
  return a1;
}

// sub_45E902 @ 0x0045E902
__m64 *__stdcall sub_45E902(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, __m64 *a5, unsigned int a6)
{
  __m64 v6; // mm0
  __m64 v7; // mm1
  __m64 v8; // mm2
  __m64 v9; // mm7
  __m64 v10; // mm4
  __m64 v11; // mm6
  __m64 v12; // mm2
  __m64 v13; // mm5
  __m64 v14; // mm1
  __m64 v15; // mm6
  __m64 v16; // mm2
  __m64 v17; // mm5
  __m64 v18; // mm0
  __m64 v19; // mm1
  __m64 v21; // mm4
  __m64 v22; // mm3
  __m64 v23; // mm0

  _m_femms();
  v6 = _mm_cvtsi32_si64(a6);
  v7 = _m_pfmul(v6, v6);
  v8 = _m_pfmul(v7, v6);
  v9 = _m_pfsub(v8, v7);
  v10 = _m_pfmul(v7, (__m64)0x4000000040000000LL);
  v11 = v8;
  v12 = _m_pfmul(v8, (__m64)0x4000000040000000LL);
  v13 = _m_pfmul(v7, (__m64)0x4040000040400000LL);
  v14 = _m_pfsub(v13, v12);
  v15 = _m_pfadd(_m_pfsub(v11, v10), v6);
  v16 = _m_pfadd(_m_pfsub(v12, v13), (__m64)0x3F8000003F800000LL);
  v17 = _m_punpckldq(v9, v9);
  v18 = _m_punpckldq(v14, v14);
  v19 = _m_pfmul(v18, (__m64)a4->m64_u64);
  v21 = _m_punpckldq(v15, v15);
  v22 = _m_punpckldq(v16, v16);
  v23 = _m_pfadd(
          _m_pfadd(_m_pfmul(v18, _mm_cvtsi32_si64(a4[1].m64_u32[0])), _m_pfmul(v17, _mm_cvtsi32_si64(a5[1].m64_u32[0]))),
          _m_pfadd(_m_pfmul(v22, _mm_cvtsi32_si64(a2[1].m64_u32[0])), _m_pfmul(v21, _mm_cvtsi32_si64(a3[1].m64_u32[0]))));
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfadd(v19, _m_pfmul(v17, (__m64)a5->m64_u64)),
                                    _m_pfadd(_m_pfmul(v22, (__m64)a2->m64_u64), _m_pfmul(v21, (__m64)a3->m64_u64)));
  a1[1].m64_i32[0] = _mm_cvtsi64_si32(v23);
  _m_femms();
  return a1;
}

// sub_45E9D6 @ 0x0045E9D6
__m64 *__stdcall sub_45E9D6(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, __m64 *a5, unsigned int a6)
{
  __m64 v6; // mm1
  __m64 v7; // mm0
  __m64 v8; // mm1
  __m64 v9; // mm0
  __m64 v10; // mm3
  __m64 v11; // mm1
  __m64 v12; // mm0
  __m64 v13; // mm5
  __m64 v14; // mm0
  __m64 v15; // mm2
  __m64 v16; // mm3
  __m64 v17; // mm4
  __m64 v18; // mm5
  __m64 v19; // mm6
  __m64 v21; // mm7
  __m64 v22; // mm0
  __m64 v23; // mm4

  v6 = _mm_cvtsi32_si64(a6);
  v7 = _m_punpckldq(v6, v6);
  v8 = _m_punpckldq(v6, (__m64)1065353216LL);
  v9 = _m_pfmul(_m_pfmul(v7, v7), v8);
  v10 = v8;
  v11 = _m_pfmul(v8, v8);
  v12 = _m_pfsub(v9, v11);
  v13 = _m_pfmul(v12, (__m64)0x4000000040400000LL);
  v14 = _m_punpckldq(v13, v12);
  v15 = _m_pfsub(_m_pfadd(_m_punpckldq(v11, v11), _m_pxor(_m_punpckldq(v10, v10), (__m64)0x8000000000000000uLL)), v14);
  v16 = _m_pfsub(v14, _m_punpckhdq(v13, 0));
  v17 = _m_punpckhdq(v15, v15);
  v18 = _m_punpckldq(v16, v16);
  v19 = _m_punpckldq(v15, v15);
  v21 = _m_punpckhdq(v16, v16);
  v22 = _m_pfadd(
          _m_pfadd(_m_pfmul(v18, (__m64)a3->m64_u64), _m_pfmul(v17, (__m64)a2->m64_u64)),
          _m_pfmul(v19, (__m64)a4->m64_u64));
  v23 = _m_pfadd(
          _m_pfadd(
            _m_pfadd(
              _m_pfmul(v17, _mm_cvtsi32_si64(a2[1].m64_u32[0])),
              _m_pfmul(v18, _mm_cvtsi32_si64(a3[1].m64_u32[0]))),
            _m_pfmul(v19, _mm_cvtsi32_si64(a4[1].m64_u32[0]))),
          _m_pfmul(v21, _mm_cvtsi32_si64(a5[1].m64_u32[0])));
  a1->m64_u64 = (unsigned __int64)_m_pfmul(
                                    _m_pfadd(v22, _m_pfmul(v21, (__m64)a5->m64_u64)),
                                    (__m64)0x3F0000003F000000LL);
  a1[1].m64_i32[0] = _mm_cvtsi64_si32(_m_pfmul(v23, (__m64)0x3F0000003F000000LL));
  _m_femms();
  return a1;
}

// vec3_transform_coord @ 0x0045EAC0
// transforms a vec3 by a matrix and divides by W (perspective)
__m64 *__stdcall sub_45EAC0(__m64 *a1, __m64 *a2, __m64 *a3)
{
  __m64 m64_u64; // mm1
  __m64 v4; // mm0
  __m64 v5; // mm2
  __m64 v6; // mm4
  __m64 v7; // mm5
  __m64 v8; // mm1
  __m64 v9; // mm3
  __m64 v10; // mm5
  __m64 v11; // mm4
  __m64 v12; // mm5

  _m_femms();
  m64_u64 = (__m64)a2->m64_u64;
  v4 = _m_punpckldq(m64_u64, m64_u64);
  v5 = _mm_cvtsi32_si64(a2[1].m64_u32[0]);
  v6 = _m_punpckhdq(m64_u64, m64_u64);
  v7 = _m_punpckldq(v5, v5);
  v8 = _m_pfadd(_m_pfmul(v6, a3[2]), _m_pfmul(v7, a3[4]));
  v9 = _m_pfadd(_m_pfadd(_m_pfmul(v4, a3[1]), a3[7]), _m_pfadd(_m_pfmul(v6, a3[3]), _m_pfmul(v7, a3[5])));
  v10 = _m_punpckhdq(v9, v9);
  v11 = _m_pfrcp(v10);
  v12 = _m_pfrcpit2(_m_pfrcpit1(v10, v11), v11);
  a1->m64_u64 = (unsigned __int64)_m_pfmul(_m_pfadd(_m_pfadd(_m_pfmul(v4, (__m64)a3->m64_u64), a3[6]), v8), v12);
  a1[1].m64_i32[0] = _mm_cvtsi64_si32(_m_pfmul(v9, v12));
  _m_femms();
  return a1;
}

// mat4_mul @ 0x0045EB4B
// multiplies two 4x4 matrices (SSE)
__m64 *__userpurge sub_45EB4B@<eax>(__m64 a1@<mm2>, __m64 a2@<mm3>, __m64 *a3, __m64 *a4, __m64 *a5)
{
  __m64 v5; // mm1
  __m64 v6; // mm2
  __m64 v7; // mm3
  __m64 v8; // mm0
  __m64 v9; // mm1
  __m64 v10; // mm2
  __m64 v11; // mm5
  __m64 v12; // mm3
  __m64 v13; // mm2
  __m64 v14; // mm7
  __m64 v15; // mm0
  __m64 v16; // mm3
  __m64 v17; // mm1
  __m64 m64_u64; // mm4
  __m64 v19; // mm2
  __m64 v20; // mm3
  __m64 v21; // mm0
  __m64 v22; // mm1
  __m64 v23; // mm2
  __m64 v24; // mm5
  __m64 v25; // mm3
  __m64 v26; // mm2
  __m64 v27; // mm7
  __m64 v28; // mm0
  __m64 v29; // mm3
  __m64 v30; // mm1
  __m64 v31; // mm4
  __m64 v32; // mm2
  __m64 v33; // mm3
  __m64 v34; // mm0
  __m64 v35; // mm1
  __m64 v36; // mm2
  __m64 v37; // mm5
  __m64 v38; // mm3
  __m64 v39; // mm2
  __m64 v40; // mm7
  __m64 v41; // mm0
  __m64 v42; // mm3
  __m64 v43; // mm1
  __m64 v44; // mm4
  __m64 v45; // mm2
  __m64 v46; // mm3
  __m64 v47; // mm0
  __m64 v48; // mm1
  __m64 v49; // mm2
  __m64 v50; // mm3
  __m64 v51; // mm7
  __m64 v52; // mm3

  v5 = a4[1];
  v6 = _m_punpckhdq(a1, (__m64)a4->m64_u64);
  v7 = _m_punpckhdq(a2, v5);
  v8 = _m_punpckldq((__m64)a4->m64_u64, (__m64)a4->m64_u64);
  v9 = _m_punpckldq(v5, v5);
  v10 = _m_punpckhdq(v6, v6);
  v11 = _m_pfmul(a5[2], v10);
  v12 = _m_punpckhdq(v7, v7);
  v13 = _m_pfadd(_m_pfadd(_m_pfmul(v10, a5[3]), _m_pfmul(v8, a5[1])), _m_pfmul(v9, a5[5]));
  v14 = _m_pfadd(_m_pfmul(a5[6], v12), _m_pfadd(_m_pfmul(a5[4], v9), _m_pfadd(v11, _m_pfmul((__m64)a5->m64_u64, v8))));
  v15 = a4[2];
  v16 = _m_pfadd(_m_pfmul(v12, a5[7]), v13);
  v17 = a4[3];
  a3->m64_u64 = (unsigned __int64)v14;
  m64_u64 = (__m64)a5->m64_u64;
  a3[1].m64_u64 = (unsigned __int64)v16;
  v19 = _m_punpckhdq(v13, v15);
  v20 = _m_punpckhdq(v16, v17);
  v21 = _m_punpckldq(v15, v15);
  v22 = _m_punpckldq(v17, v17);
  v23 = _m_punpckhdq(v19, v19);
  v24 = _m_pfmul(a5[2], v23);
  v25 = _m_punpckhdq(v20, v20);
  v26 = _m_pfadd(_m_pfadd(_m_pfmul(v23, a5[3]), _m_pfmul(v21, a5[1])), _m_pfmul(v22, a5[5]));
  v27 = _m_pfadd(_m_pfmul(a5[6], v25), _m_pfadd(_m_pfmul(a5[4], v22), _m_pfadd(v24, _m_pfmul(m64_u64, v21))));
  v28 = a4[4];
  v29 = _m_pfadd(_m_pfmul(v25, a5[7]), v26);
  v30 = a4[5];
  a3[2].m64_u64 = (unsigned __int64)v27;
  v31 = (__m64)a5->m64_u64;
  a3[3].m64_u64 = (unsigned __int64)v29;
  v32 = _m_punpckhdq(v26, v28);
  v33 = _m_punpckhdq(v29, v30);
  v34 = _m_punpckldq(v28, v28);
  v35 = _m_punpckldq(v30, v30);
  v36 = _m_punpckhdq(v32, v32);
  v37 = _m_pfmul(a5[2], v36);
  v38 = _m_punpckhdq(v33, v33);
  v39 = _m_pfadd(_m_pfadd(_m_pfmul(v36, a5[3]), _m_pfmul(v34, a5[1])), _m_pfmul(v35, a5[5]));
  v40 = _m_pfadd(_m_pfmul(a5[6], v38), _m_pfadd(_m_pfmul(a5[4], v35), _m_pfadd(v37, _m_pfmul(v31, v34))));
  v41 = a4[6];
  v42 = _m_pfadd(_m_pfmul(v38, a5[7]), v39);
  v43 = a4[7];
  a3[4].m64_u64 = (unsigned __int64)v40;
  v44 = (__m64)a5->m64_u64;
  a3[5].m64_u64 = (unsigned __int64)v42;
  v45 = _m_punpckhdq(v39, v41);
  v46 = _m_punpckhdq(v42, v43);
  v47 = _m_punpckldq(v41, v41);
  v48 = _m_punpckldq(v43, v43);
  v49 = _m_punpckhdq(v45, v45);
  v50 = _m_punpckhdq(v46, v46);
  v51 = _m_pfmul(a5[6], v50);
  v52 = _m_pfadd(
          _m_pfmul(v50, a5[7]),
          _m_pfadd(_m_pfadd(_m_pfmul(v49, a5[3]), _m_pfmul(v47, a5[1])), _m_pfmul(v48, a5[5])));
  a3[6].m64_u64 = (unsigned __int64)_m_pfadd(
                                      v51,
                                      _m_pfadd(_m_pfmul(a5[4], v48), _m_pfadd(_m_pfmul(a5[2], v49), _m_pfmul(v44, v47))));
  a3[7].m64_u64 = (unsigned __int64)v52;
  _m_femms();
  return a3;
}

// vec3_project @ 0x0045ED17
// projects a vec3 through optional matrices and viewport scale/bias
__m64 *__userpurge sub_45ED17@<eax>(
        __m64 a1@<mm2>,
        __m64 a2@<mm3>,
        __m64 *a3,
        __m64 *a4,
        __m64 *a5,
        __m64 *a6,
        __m64 *a7,
        __m64 *a8)
{
  __m64 *v8; // esi
  __m64 v9; // mm1
  __m64 v11; // [esp+Ch] [ebp-40h] BYREF
  float v12; // [esp+14h] [ebp-38h]
  float v13; // [esp+18h] [ebp-34h]
  float v14; // [esp+1Ch] [ebp-30h]
  float v15; // [esp+20h] [ebp-2Ch]
  float v16; // [esp+24h] [ebp-28h]
  float v17; // [esp+28h] [ebp-24h]
  float v18; // [esp+2Ch] [ebp-20h]
  float v19; // [esp+30h] [ebp-1Ch]
  float v20; // [esp+34h] [ebp-18h]
  float v21; // [esp+38h] [ebp-14h]
  float v22; // [esp+3Ch] [ebp-10h]
  float v23; // [esp+40h] [ebp-Ch]
  float v24; // [esp+44h] [ebp-8h]
  float v25; // [esp+48h] [ebp-4h]

  v8 = &v11;
  switch ( (a6 != 0) | (2 * ((a7 != 0) | (2 * (a8 != 0)))) )
  {
    case 0:
      v24 = 0.0;
      v23 = 0.0;
      v22 = 0.0;
      v21 = 0.0;
      v19 = 0.0;
      v18 = 0.0;
      v17 = 0.0;
      v16 = 0.0;
      v14 = 0.0;
      v13 = 0.0;
      v12 = 0.0;
      v11.m64_f32[1] = 0.0;
      v25 = 1.0;
      v20 = 1.0;
      v15 = 1.0;
      v11.m64_f32[0] = 1.0;
      break;
    case 1:
      v8 = a6;
      break;
    case 2:
      v8 = a7;
      break;
    case 3:
      _m_femms();
      mat4_mul(a1, a2, &v11, a7, a6);
      _m_femms();
      break;
    case 4:
      v8 = a8;
      break;
    case 5:
      _m_femms();
      mat4_mul(a1, a2, &v11, a8, a6);
      _m_femms();
      break;
    case 6:
      _m_femms();
      mat4_mul(a1, a2, &v11, a8, a7);
      _m_femms();
      break;
    case 7:
      _m_femms();
      mat4_mul(a1, a2, &v11, a8, a7);
      mat4_mul(a1, a2, &v11, &v11, a6);
      _m_femms();
      break;
    default:
      break;
  }
  vec3_transform_coord(a3, a4, v8);
  if ( a5 )
  {
    _m_femms();
    v9 = _m_pfadd(_m_pfmul(_mm_cvtsi32_si64(a3[1].m64_u32[0]), _m_pfsub(_m_punpckhdq(a5[2], a5[2]), a5[2])), a5[2]);
    a3->m64_u64 = (unsigned __int64)_m_pfadd(
                                      _m_pfmul(
                                        _m_pfadd(
                                          _m_pxor((__m64)a3->m64_u64, (__m64)0x8000000000000000uLL),
                                          (__m64)0x3F8000003F800000LL),
                                        _m_pfmul(_m_pi2fd(a5[1]), (__m64)0x3F0000003F000000LL)),
                                      _m_pi2fd((__m64)a5->m64_u64));
    a3[1].m64_i32[0] = _mm_cvtsi64_si32(v9);
    _m_femms();
  }
  return a3;
}

// vec3_unproject @ 0x0045EE9F
// unprojects a screen-space vec3 using inverse matrices and viewport
__m64 *__userpurge sub_45EE9F@<eax>(
        __m64 a1@<mm2>,
        __m64 a2@<mm3>,
        __m64 *a3,
        __m64 *a4,
        __m64 *a5,
        __m64 *a6,
        __m64 *a7,
        __m64 *a8)
{
  __m64 v8; // mm4
  __m64 v9; // mm2
  __m64 v10; // mm5
  __m64 v11; // mm0
  __m64 v12; // mm5
  __m64 v13; // mm6
  __m64 v14; // mm3
  __m64 v16; // [esp+Ch] [ebp-40h] BYREF
  float v17; // [esp+14h] [ebp-38h]
  float v18; // [esp+18h] [ebp-34h]
  float v19; // [esp+1Ch] [ebp-30h]
  float v20; // [esp+20h] [ebp-2Ch]
  float v21; // [esp+24h] [ebp-28h]
  float v22; // [esp+28h] [ebp-24h]
  float v23; // [esp+2Ch] [ebp-20h]
  float v24; // [esp+30h] [ebp-1Ch]
  float v25; // [esp+34h] [ebp-18h]
  float v26; // [esp+38h] [ebp-14h]
  float v27; // [esp+3Ch] [ebp-10h]
  float v28; // [esp+40h] [ebp-Ch]
  float v29; // [esp+44h] [ebp-8h]
  float v30; // [esp+48h] [ebp-4h]

  switch ( (a6 != 0) | (2 * ((a7 != 0) | (2 * (a8 != 0)))) )
  {
    case 0:
      v29 = 0.0;
      v28 = 0.0;
      v27 = 0.0;
      v26 = 0.0;
      v24 = 0.0;
      v23 = 0.0;
      v22 = 0.0;
      v21 = 0.0;
      v19 = 0.0;
      v18 = 0.0;
      v17 = 0.0;
      v16.m64_f32[1] = 0.0;
      v30 = 1.0;
      v25 = 1.0;
      v20 = 1.0;
      v16.m64_f32[0] = 1.0;
      break;
    case 1:
      _m_femms();
      mat4_invert(&v16, 0, a6);
      _m_femms();
      break;
    case 2:
      _m_femms();
      mat4_invert(&v16, 0, a7);
      _m_femms();
      break;
    case 3:
      _m_femms();
      mat4_mul(a1, a2, &v16, a7, a6);
      mat4_invert(&v16, 0, &v16);
      _m_femms();
      break;
    case 4:
      _m_femms();
      mat4_invert(&v16, 0, a8);
      _m_femms();
      break;
    case 5:
      _m_femms();
      mat4_mul(a1, a2, &v16, a8, a6);
      mat4_invert(&v16, 0, &v16);
      _m_femms();
      break;
    case 6:
      _m_femms();
      mat4_mul(a1, a2, &v16, a8, a7);
      mat4_invert(&v16, 0, &v16);
      _m_femms();
      break;
    case 7:
      _m_femms();
      mat4_mul(a1, a2, &v16, a8, a7);
      mat4_mul(a1, a2, &v16, &v16, a6);
      mat4_invert(&v16, 0, &v16);
      _m_femms();
      break;
    default:
      break;
  }
  if ( a5 )
  {
    _m_femms();
    v8 = a5[2];
    v9 = _m_pi2fd(a5[1]);
    v10 = _m_punpckldq(_m_pfrcp(v9), _m_pfrcp(_m_punpckhdq(v9, v9)));
    v11 = _m_pfmul(
            _m_pfsub((__m64)a4->m64_u64, _m_pi2fd((__m64)a5->m64_u64)),
            _m_pfmul(_m_pfrcpit2(_m_pfrcpit1(v9, v10), v10), (__m64)0x4000000040000000LL));
    v12 = _m_pfsub(_m_punpckhdq(v8, v8), v8);
    v13 = _m_pfrcp(v12);
    v14 = _m_pfmul(_m_pfsub(_mm_cvtsi32_si64(a4[1].m64_u32[0]), v8), _m_pfrcpit2(_m_pfrcpit1(v12, v13), v13));
    a3->m64_u64 = (unsigned __int64)_m_pxor(_m_pfsub(v11, (__m64)0x3F8000003F800000LL), (__m64)0x8000000000000000uLL);
    a3[1].m64_i32[0] = _mm_cvtsi64_si32(v14);
    _m_femms();
    vec3_transform_coord(a3, a3, &v16);
  }
  else
  {
    vec3_transform_coord(a3, a4, &v16);
  }
  return a3;
}

// sub_45F0C5 @ 0x0045F0C5
__m64 *__userpurge sub_45F0C5@<eax>(
        __m64 a1@<mm2>,
        __m64 a2@<mm3>,
        __m64 *a3,
        __m64 *a4,
        __m64 *a5,
        __m64 *a6,
        __m64 *a7,
        __m64 *a8)
{
  __m64 v8; // mm4
  __m64 v9; // mm2
  __m64 v10; // mm5
  __m64 v11; // mm0
  __m64 v12; // mm5
  __m64 v13; // mm6
  __m64 v14; // mm3
  __m64 *v16; // [esp-4h] [ebp-50h]
  __m64 v17[8]; // [esp+Ch] [ebp-40h] BYREF

  switch ( (a6 != 0) | (2 * ((a7 != 0) | (2 * (a8 != 0)))) )
  {
    case 0:
      sub_45B092(v17);
      break;
    case 1:
      sub_45DD30(v17, 0, a6);
      break;
    case 2:
      sub_45DD30(v17, 0, a7);
      break;
    case 3:
      mat4_mul(a1, a2, v17, a7, a6);
      goto LABEL_11;
    case 4:
      sub_45DD30(v17, 0, a8);
      break;
    case 5:
      v16 = a6;
      goto LABEL_9;
    case 6:
      v16 = a7;
LABEL_9:
      mat4_mul(a1, a2, v17, a8, v16);
      goto LABEL_11;
    case 7:
      mat4_mul(a1, a2, v17, a8, a7);
      mat4_mul(a1, a2, v17, v17, a6);
LABEL_11:
      sub_45DD30(v17, 0, v17);
      break;
    default:
      break;
  }
  if ( a5 )
  {
    _m_femms();
    v8 = a5[2];
    v9 = _m_pi2fd(a5[1]);
    v10 = _m_punpckldq(_m_pfrcp(v9), _m_pfrcp(_m_punpckhdq(v9, v9)));
    v11 = _m_pfmul(
            _m_pfsub((__m64)a4->m64_u64, _m_pi2fd((__m64)a5->m64_u64)),
            _m_pfmul(_m_pfrcpit2(_m_pfrcpit1(v9, v10), v10), (__m64)0x4000000040000000LL));
    v12 = _m_pfsub(_m_punpckhdq(v8, v8), v8);
    v13 = _m_pfrcp(v12);
    v14 = _m_pfmul(_m_pfsub(_mm_cvtsi32_si64(a4[1].m64_u32[0]), v8), _m_pfrcpit2(_m_pfrcpit1(v12, v13), v13));
    a3->m64_u64 = (unsigned __int64)_m_pxor(_m_pfsub(v11, (__m64)0x3F8000003F800000LL), (__m64)0x8000000000000000uLL);
    a3[1].m64_i32[0] = _mm_cvtsi64_si32(v14);
    _m_femms();
    vec3_transform_coord(a3, a3, v17);
  }
  else
  {
    vec3_transform_coord(a3, a4, v17);
  }
  return a3;
}

// sub_45F218 @ 0x0045F218
__m64 *__stdcall sub_45F218(__m64 *a1, __m64 *a2, __m64 *a3)
{
  unsigned __int64 m64_u64; // mm1
  __m64 v4; // mm0
  __m64 v5; // mm4
  __m64 v6; // mm3

  _m_femms();
  m64_u64 = a2->m64_u64;
  v4 = _m_punpckldq((__m64)m64_u64, (__m64)m64_u64);
  v5 = _m_punpckhdq((__m64)m64_u64, (__m64)m64_u64);
  v6 = _m_pfadd(_m_pfadd(_m_pfmul(v4, a3[1]), a3[7]), _m_pfmul(v5, a3[3]));
  a1->m64_u64 = (unsigned __int64)_m_pfadd(_m_pfadd(_m_pfmul(v4, (__m64)a3->m64_u64), a3[6]), _m_pfmul(v5, a3[2]));
  a1[1].m64_u64 = (unsigned __int64)v6;
  _m_femms();
  return a1;
}

// sub_45F26D @ 0x0045F26D
__m64 *__stdcall sub_45F26D(__m64 *a1, __m64 *a2, __m64 *a3)
{
  _m_femms();
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfmul(_m_punpckldq((__m64)a2->m64_u64, (__m64)a2->m64_u64), (__m64)a3->m64_u64),
                                    _m_pfmul(_m_punpckhdq((__m64)a2->m64_u64, (__m64)a2->m64_u64), a3[2]));
  _m_femms();
  return a1;
}

// sub_45F2A6 @ 0x0045F2A6
__m64 *__stdcall sub_45F2A6(__m64 *a1, __m64 *a2, __m64 *a3)
{
  unsigned __int64 m64_u64; // mm1
  __m64 v4; // mm0
  __m64 v5; // mm4
  __m64 v6; // mm1
  __m64 v7; // mm3
  __m64 v8; // mm3
  __m64 v9; // mm4

  _m_femms();
  m64_u64 = a2->m64_u64;
  v4 = _m_punpckldq((__m64)m64_u64, (__m64)m64_u64);
  v5 = _m_punpckhdq((__m64)m64_u64, (__m64)m64_u64);
  v6 = _m_pfmul(v5, a3[2]);
  v7 = _m_pfadd(_m_pfadd(_m_pfmul(v4, a3[1]), a3[7]), _m_pfmul(v5, a3[3]));
  v8 = _m_punpckhdq(v7, v7);
  v9 = _m_pfrcp(v8);
  a1->m64_u64 = (unsigned __int64)_m_pfmul(
                                    _m_pfadd(_m_pfadd(_m_pfmul(v4, (__m64)a3->m64_u64), a3[6]), v6),
                                    _m_pfrcpit2(_m_pfrcpit1(v8, v9), v9));
  _m_femms();
  return a1;
}

// sub_45F30A @ 0x0045F30A
__m64 *__stdcall sub_45F30A(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, __m64 *a5, unsigned int a6)
{
  __m64 v6; // mm0
  __m64 v7; // mm1
  __m64 v8; // mm2
  __m64 v9; // mm7
  __m64 v10; // mm4
  __m64 v11; // mm6
  __m64 v12; // mm2
  __m64 v13; // mm5
  __m64 v14; // mm1
  __m64 v15; // mm6
  __m64 v16; // mm2

  _m_femms();
  v6 = _mm_cvtsi32_si64(a6);
  v7 = _m_pfmul(v6, v6);
  v8 = _m_pfmul(v7, v6);
  v9 = _m_pfsub(v8, v7);
  v10 = _m_pfmul(v7, (__m64)0x4000000040000000LL);
  v11 = v8;
  v12 = _m_pfmul(v8, (__m64)0x4000000040000000LL);
  v13 = _m_pfmul(v7, (__m64)0x4040000040400000LL);
  v14 = _m_pfsub(v13, v12);
  v15 = _m_pfadd(_m_pfsub(v11, v10), v6);
  v16 = _m_pfadd(_m_pfsub(v12, v13), (__m64)0x3F8000003F800000LL);
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfadd(
                                      _m_pfmul(_m_punpckldq(v16, v16), (__m64)a2->m64_u64),
                                      _m_pfmul(_m_punpckldq(v15, v15), (__m64)a3->m64_u64)),
                                    _m_pfadd(
                                      _m_pfmul(_m_punpckldq(v14, v14), (__m64)a4->m64_u64),
                                      _m_pfmul(_m_punpckldq(v9, v9), (__m64)a5->m64_u64)));
  _m_femms();
  return a1;
}

// sub_45F3A2 @ 0x0045F3A2
__m64 *__stdcall sub_45F3A2(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, unsigned int a5, unsigned int a6)
{
  __m64 v6; // mm6
  __m64 v7; // mm7

  v6 = _mm_cvtsi32_si64(a5);
  v7 = _mm_cvtsi32_si64(a6);
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfadd(
                                      (__m64)a2->m64_u64,
                                      _m_pfmul(_m_pfsub((__m64)a3->m64_u64, (__m64)a2->m64_u64), _m_punpckldq(v6, v6))),
                                    _m_pfmul(_m_pfsub((__m64)a4->m64_u64, (__m64)a2->m64_u64), _m_punpckldq(v7, v7)));
  _m_femms();
  return a1;
}

// sub_45F3EB @ 0x0045F3EB
__m64 *__stdcall sub_45F3EB(__m64 *a1, __m64 *a2)
{
  __m64 v2; // mm0
  __m64 v4; // mm0
  __m64 v5; // mm5

  v2 = _m_pfmul((__m64)a2->m64_u64, (__m64)a2->m64_u64);
  v4 = _m_pfacc(v2, v2);
  v5 = _m_pfrsqrt(v4);
  a1->m64_u64 = (unsigned __int64)_m_pfmul(
                                    _m_pand((__m64)a2->m64_u64, _m_pfcmpgt(v4, (__m64)0x80000000800000LL)),
                                    _m_pfrcpit2(_m_pfrsqit1(_m_pfmul(v5, v5), v4), v5));
  _m_femms();
  return a1;
}

// sub_45F42E @ 0x0045F42E
__m64 *__stdcall sub_45F42E(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, __m64 *a5, unsigned int a6)
{
  __m64 v6; // mm1
  __m64 v7; // mm0
  __m64 v8; // mm1
  __m64 v9; // mm0
  __m64 v10; // mm3
  __m64 v11; // mm1
  __m64 v12; // mm4
  __m64 v13; // mm5
  __m64 v14; // mm0
  __m64 v15; // mm1
  __m64 v16; // mm3

  v6 = _mm_cvtsi32_si64(a6);
  v7 = _m_punpckldq(v6, v6);
  v8 = _m_punpckldq(v6, (__m64)1065353216LL);
  v9 = _m_pfmul(_m_pfmul(v7, v7), v8);
  v10 = v8;
  v11 = _m_pfmul(v8, v8);
  v12 = _m_pfsub(v9, v11);
  v13 = _m_pfmul(v12, (__m64)0x4000000040400000LL);
  v14 = _m_punpckldq(v13, v12);
  v15 = _m_pfsub(_m_pfadd(_m_punpckldq(v11, v11), _m_pxor(_m_punpckldq(v10, v10), (__m64)0x8000000000000000uLL)), v14);
  v16 = _m_pfsub(v14, _m_punpckhdq(v13, 0));
  a1->m64_u64 = (unsigned __int64)_m_pfmul(
                                    _m_pfadd(
                                      _m_pfadd(
                                        _m_pfadd(
                                          _m_pfmul(_m_punpckldq(v16, v16), (__m64)a3->m64_u64),
                                          _m_pfmul(_m_punpckhdq(v15, v15), (__m64)a2->m64_u64)),
                                        _m_pfmul(_m_punpckldq(v15, v15), (__m64)a4->m64_u64)),
                                      _m_pfmul(_m_punpckhdq(v16, v16), (__m64)a5->m64_u64)),
                                    (__m64)0x3F0000003F000000LL);
  _m_femms();
  return a1;
}

// sub_45F4D9 @ 0x0045F4D9
__m64 *__stdcall sub_45F4D9(__m64 *a1, __m64 *a2, __m64 *a3)
{
  unsigned __int64 m64_u64; // mm1
  __m64 v4; // mm0
  __m64 v5; // mm3
  __m64 v6; // mm5
  __m64 v7; // mm6
  __m64 v8; // mm7
  __m64 v9; // mm4

  _m_femms();
  m64_u64 = a2->m64_u64;
  v4 = _m_punpckldq((__m64)m64_u64, (__m64)m64_u64);
  v5 = a2[1];
  v6 = _m_punpckhdq((__m64)m64_u64, (__m64)m64_u64);
  v7 = _m_punpckldq(v5, v5);
  v8 = _m_punpckhdq(v5, v5);
  v9 = _m_pfadd(_m_pfadd(_m_pfmul(v4, a3[1]), _m_pfmul(v6, a3[3])), _m_pfadd(_m_pfmul(v7, a3[5]), _m_pfmul(v8, a3[7])));
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfadd(_m_pfmul(v4, (__m64)a3->m64_u64), _m_pfmul(v6, a3[2])),
                                    _m_pfadd(_m_pfmul(v7, a3[4]), _m_pfmul(v8, a3[6])));
  a1[1].m64_u64 = (unsigned __int64)v9;
  _m_femms();
  return a1;
}

// sub_45F55B @ 0x0045F55B
__m64 *__stdcall sub_45F55B(__m64 *a1, __m64 *a2)
{
  __m64 v2; // mm3
  __m64 v3; // mm0
  __m64 v4; // mm0
  __m64 v6; // mm4
  __m64 v7; // mm5
  __m64 v8; // mm0

  _m_femms();
  v2 = a2[1];
  v3 = _m_pfadd(_m_pfmul((__m64)a2->m64_u64, (__m64)a2->m64_u64), _m_pfmul(v2, v2));
  v4 = _m_pfacc(v3, v3);
  v6 = _m_pfrsqrt(v4);
  v7 = _m_pfcmpgt(v4, (__m64)0x80000000800000LL);
  v8 = _m_pfrcpit2(_m_pfrsqit1(v4, _m_pfmul(v6, v6)), v6);
  a1->m64_u64 = (unsigned __int64)_m_pfmul(_m_pand((__m64)a2->m64_u64, v7), v8);
  a1[1].m64_u64 = (unsigned __int64)_m_pfmul(_m_pand(v2, v7), v8);
  _m_femms();
  return a1;
}

// sub_45F5BA @ 0x0045F5BA
__m64 *__stdcall sub_45F5BA(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4)
{
  __m64 v5; // mm2
  __m64 v6; // mm3
  __m64 v7; // mm4
  __m64 v8; // mm5
  __m64 v9; // mm6
  __m64 v10; // mm1
  __m64 m64_u64; // mm0
  __m64 v12; // mm7
  __m64 v13; // mm2
  __m64 v14; // mm6
  __m64 v15; // mm7

  _m_femms();
  v5 = a3[1];
  v6 = a4[1];
  v7 = _m_pfsub(
         _m_pfmul(_m_punpckhdq(v6, v6), _m_punpckhdq(_m_punpckldq(v5, v5), (__m64)a3->m64_u64)),
         _m_pfmul(_m_punpckhdq(v5, v5), _m_punpckhdq(_m_punpckldq(v6, v6), (__m64)a4->m64_u64)));
  v8 = _m_pfsub(
         _m_pfmul(_m_punpckhdq((__m64)a3->m64_u64, v5), _m_punpckldq(v6, (__m64)a4->m64_u64)),
         _m_pfmul(_m_punpckhdq((__m64)a4->m64_u64, v6), _m_punpckldq(v5, (__m64)a3->m64_u64)));
  v9 = _m_pfsub(
         _m_pfmul(
           _m_punpckldq((__m64)a4->m64_u64, (__m64)a4->m64_u64),
           _m_punpckhdq(_m_punpckldq(v5, v5), (__m64)a3->m64_u64)),
         _m_pfmul(
           _m_punpckldq((__m64)a3->m64_u64, (__m64)a3->m64_u64),
           _m_punpckhdq(_m_punpckldq(v6, v6), (__m64)a4->m64_u64)));
  v10 = a2[1];
  m64_u64 = (__m64)a2->m64_u64;
  a1->m64_u64 = (unsigned __int64)_m_pfsub(
                                    _m_pfmul(
                                      _m_pxor(_m_punpckldq(v7, v7), (__m64)0x8000000000000000uLL),
                                      _m_punpckhdq(
                                        (__m64)a2->m64_u64,
                                        _m_punpckldq((__m64)a2->m64_u64, (__m64)a2->m64_u64))),
                                    _m_pfacc(
                                      _m_pxor(
                                        _m_pfmul(_m_punpckldq(_m_punpckhdq(v7, v7), v8), v10),
                                        (__m64)0x8000000000000000uLL),
                                      _m_pxor(
                                        _m_pfmul(_m_punpckldq(_m_punpckhdq(v8, v8), v9), v10),
                                        (__m64)0x8000000000000000uLL)));
  v12 = _m_psrlqi((__m64)0x8000000000000000uLL, 0x20u);
  v13 = _m_pxor(_m_punpckldq(v8, v9), v12);
  v14 = _m_pxor(_m_punpckhdq(v9, v9), v12);
  v15 = _m_psllqi(v12, 0x20u);
  a1[1].m64_u64 = (unsigned __int64)_m_pfadd(
                                      _m_pfmul(_m_punpckhdq(v10, _m_punpckldq(v10, v10)), v14),
                                      _m_pfacc(
                                        _m_pxor(
                                          _m_pfmul(_m_pxor(_m_punpckhdq(v7, v8), (__m64)0x8000000000000000uLL), m64_u64),
                                          v15),
                                        _m_pxor(_m_pfmul(v13, m64_u64), v15)));
  _m_femms();
  return a1;
}

// sub_45F6EC @ 0x0045F6EC
__m64 *__stdcall sub_45F6EC(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, unsigned int a5, unsigned int a6)
{
  __m64 v6; // mm6
  __m64 v7; // mm7
  __m64 v9; // mm6
  __m64 v10; // mm7
  __m64 v11; // mm1

  v6 = _mm_cvtsi32_si64(a5);
  v7 = _mm_cvtsi32_si64(a6);
  v9 = _m_punpckldq(v6, v6);
  v10 = _m_punpckldq(v7, v7);
  v11 = _m_pfadd(_m_pfadd(_m_pfmul(_m_pfsub(a3[1], a2[1]), v9), a2[1]), _m_pfmul(_m_pfsub(a4[1], a2[1]), v10));
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfadd(
                                      _m_pfmul(_m_pfsub((__m64)a3->m64_u64, (__m64)a2->m64_u64), v9),
                                      (__m64)a2->m64_u64),
                                    _m_pfmul(_m_pfsub((__m64)a4->m64_u64, (__m64)a2->m64_u64), v10));
  a1[1].m64_u64 = (unsigned __int64)v11;
  _m_femms();
  return a1;
}

// sub_45F75D @ 0x0045F75D
__m64 *__stdcall sub_45F75D(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, __m64 *a5, unsigned int a6)
{
  __m64 v6; // mm0
  __m64 v7; // mm1
  __m64 v8; // mm2
  __m64 v9; // mm7
  __m64 v10; // mm4
  __m64 v11; // mm6
  __m64 v12; // mm2
  __m64 v13; // mm5
  __m64 v14; // mm1
  __m64 v15; // mm6
  __m64 v16; // mm2
  __m64 v17; // mm5
  __m64 v18; // mm0
  __m64 v19; // mm1
  __m64 v21; // mm4
  __m64 v22; // mm3
  __m64 v23; // mm0

  _m_femms();
  v6 = _mm_cvtsi32_si64(a6);
  v7 = _m_pfmul(v6, v6);
  v8 = _m_pfmul(v7, v6);
  v9 = _m_pfsub(v8, v7);
  v10 = _m_pfmul(v7, (__m64)0x4000000040000000LL);
  v11 = v8;
  v12 = _m_pfmul(v8, (__m64)0x4000000040000000LL);
  v13 = _m_pfmul(v7, (__m64)0x4040000040400000LL);
  v14 = _m_pfsub(v13, v12);
  v15 = _m_pfadd(_m_pfsub(v11, v10), v6);
  v16 = _m_pfadd(_m_pfsub(v12, v13), (__m64)0x3F8000003F800000LL);
  v17 = _m_punpckldq(v9, v9);
  v18 = _m_punpckldq(v14, v14);
  v19 = _m_pfmul(v18, (__m64)a4->m64_u64);
  v21 = _m_punpckldq(v15, v15);
  v22 = _m_punpckldq(v16, v16);
  v23 = _m_pfadd(
          _m_pfadd(_m_pfmul(v18, a4[1]), _m_pfmul(v17, a5[1])),
          _m_pfadd(_m_pfmul(v22, a2[1]), _m_pfmul(v21, a3[1])));
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfadd(v19, _m_pfmul(v17, (__m64)a5->m64_u64)),
                                    _m_pfadd(_m_pfmul(v22, (__m64)a2->m64_u64), _m_pfmul(v21, (__m64)a3->m64_u64)));
  a1[1].m64_u64 = (unsigned __int64)v23;
  _m_femms();
  return a1;
}

// sub_45F825 @ 0x0045F825
__m64 *__stdcall sub_45F825(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4, __m64 *a5, unsigned int a6)
{
  __m64 v6; // mm1
  __m64 v7; // mm0
  __m64 v8; // mm1
  __m64 v9; // mm0
  __m64 v10; // mm3
  __m64 v11; // mm1
  __m64 v12; // mm0
  __m64 v13; // mm5
  __m64 v14; // mm0
  __m64 v15; // mm2
  __m64 v16; // mm3
  __m64 v17; // mm4
  __m64 v18; // mm5
  __m64 v19; // mm6
  __m64 v20; // mm7
  __m64 v22; // mm0
  __m64 v23; // mm4

  v6 = _mm_cvtsi32_si64(a6);
  v7 = _m_punpckldq(v6, v6);
  v8 = _m_punpckldq(v6, (__m64)1065353216LL);
  v9 = _m_pfmul(_m_pfmul(v7, v7), v8);
  v10 = v8;
  v11 = _m_pfmul(v8, v8);
  v12 = _m_pfsub(v9, v11);
  v13 = _m_pfmul(v12, (__m64)0x4000000040400000LL);
  v14 = _m_punpckldq(v13, v12);
  v15 = _m_pfsub(_m_pfadd(_m_punpckldq(v11, v11), _m_pxor(_m_punpckldq(v10, v10), (__m64)0x8000000000000000uLL)), v14);
  v16 = _m_pfsub(v14, _m_punpckhdq(v13, 0));
  v17 = _m_punpckhdq(v15, v15);
  v18 = _m_punpckldq(v16, v16);
  v19 = _m_punpckldq(v15, v15);
  v20 = _m_punpckhdq(v16, v16);
  v22 = _m_pfadd(
          _m_pfadd(_m_pfmul(v18, (__m64)a3->m64_u64), _m_pfmul(v17, (__m64)a2->m64_u64)),
          _m_pfmul(v19, (__m64)a4->m64_u64));
  v23 = _m_pfadd(
          _m_pfadd(_m_pfadd(_m_pfmul(v17, a2[1]), _m_pfmul(v18, a3[1])), _m_pfmul(v19, a4[1])),
          _m_pfmul(v20, a5[1]));
  a1->m64_u64 = (unsigned __int64)_m_pfmul(
                                    _m_pfadd(v22, _m_pfmul(v20, (__m64)a5->m64_u64)),
                                    (__m64)0x3F0000003F000000LL);
  a1[1].m64_u64 = (unsigned __int64)_m_pfmul(v23, (__m64)0x3F0000003F000000LL);
  _m_femms();
  return a1;
}

// sub_45F903 @ 0x0045F903
__m64 *__stdcall sub_45F903(__m64 *a1, __m64 *a2, __m64 *a3)
{
  __m64 v4; // mm1
  __m64 v5; // mm2
  __m64 v6; // mm2

  _m_femms();
  v4 = _mm_cvtsi32_si64(a3[1].m64_u32[0]);
  v5 = _m_pfmul((__m64)a2->m64_u64, (__m64)a3->m64_u64);
  v6 = _m_pfadd(_m_pfacc(v5, v5), _m_pfmul(_mm_cvtsi32_si64(a2[1].m64_u32[0]), v4));
  a1->m64_u64 = a3->m64_u64;
  a1[1].m64_i32[0] = _mm_cvtsi64_si32(v4);
  a1[1].m64_i32[1] = _mm_cvtsi64_si32(_m_pxor(v6, (__m64)0x80000000LL));
  _m_femms();
  return a1;
}

// sub_45F946 @ 0x0045F946
__m64 *__stdcall sub_45F946(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4)
{
  __m64 v4; // mm2
  __m64 v5; // mm1
  __m64 v6; // mm4
  __m64 v7; // mm7
  __m64 v8; // mm5
  __m64 v9; // mm0
  __m64 v10; // mm1
  __m64 v11; // mm1
  __m64 v12; // mm7
  __m64 v13; // mm6
  __m64 v14; // mm6
  __m64 v15; // mm4
  __m64 v16; // mm5
  __m64 v17; // mm6
  unsigned __int64 v19; // mm4
  __m64 v20; // mm5
  __m64 v21; // mm0

  _m_femms();
  v4 = _mm_cvtsi32_si64(a2[1].m64_u32[0]);
  v5 = _m_pfsub(_m_punpckldq(v4, v4), _m_punpckldq(_mm_cvtsi32_si64(a4[1].m64_u32[0]), (__m64)a3[1].m64_u32[0]));
  v6 = _m_pfsub((__m64)a2->m64_u64, (__m64)a4->m64_u64);
  v7 = _m_pfsub(0, v6);
  v8 = _m_pfsub((__m64)a2->m64_u64, (__m64)a3->m64_u64);
  v9 = _m_pxor(
         _m_pfacc(
           _m_pfmul(_m_punpckhdq(v8, v7), v5),
           _m_pfmul(_m_punpckldq(_m_punpckhdq(v5, (__m64)0x8000000000000000uLL), v8), _m_punpckldq(v7, v5))),
         (__m64)0x8000000000000000uLL);
  v10 = _m_pfmul(_m_punpckhdq(v6, _m_punpckldq(v6, v7)), v8);
  v11 = _m_pfacc(v10, v10);
  v12 = _m_psllqi(v11, 0x20u);
  v13 = _m_pfadd(_m_pfmul(v9, v9), _m_pfmul(v12, v12));
  v14 = _m_pfacc(v13, v13);
  v15 = _m_pfrsqrt(v14);
  v16 = _m_pfcmpgt(v14, (__m64)0x80000000800000LL);
  v17 = _m_pfrcpit2(_m_pfrsqit1(v14, _m_pfmul(v15, v15)), v15);
  v19 = (unsigned __int64)_m_pfmul(_m_pand(v9, v16), v17);
  v20 = _m_pfmul(_m_pand(v11, v16), v17);
  v21 = _m_pfmul((__m64)v19, (__m64)a2->m64_u64);
  a1->m64_u64 = v19;
  a1[1].m64_u64 = (unsigned __int64)_m_pxor(
                                      _m_punpckldq(v20, _m_pfadd(_m_pfacc(v21, v21), _m_pfmul(v20, v4))),
                                      (__m64)0x8000000000000000uLL);
  _m_femms();
  return a1;
}

// sub_45FA2A @ 0x0045FA2A
__m64 *__stdcall sub_45FA2A(__m64 *a1, __m64 *a2, __m64 *a3, __m64 *a4)
{
  __m64 v4; // mm7
  __m64 v5; // mm4
  __m64 v6; // mm7
  __m64 v7; // mm4
  __m64 v8; // mm5
  __m64 *result; // eax
  __m64 v10; // mm2
  __m64 v11; // mm2
  __m64 v12; // mm2
  __m64 v13; // mm5

  v4 = _mm_cvtsi32_si64(a3[1].m64_u32[0]);
  v5 = _m_pfsub(
         _m_pfadd(_m_pfmul((__m64)a2->m64_u64, (__m64)a3->m64_u64), _m_pfmul(a2[1], v4)),
         _m_pfadd(_m_pfmul((__m64)a2->m64_u64, (__m64)a4->m64_u64), _m_pfmul(a2[1], _mm_cvtsi32_si64(a4[1].m64_u32[0]))));
  v6 = _m_punpckldq(v4, (__m64)1065353216LL);
  v7 = _m_pfacc(v5, v5);
  v8 = _m_pfrcp(v7);
  result = a1;
  v10 = _m_pfmul((__m64)a2->m64_u64, (__m64)a3->m64_u64);
  if ( _mm_cvtsi64_si32(_m_pfcmpeq(0, v7)) )
  {
    result = 0;
  }
  else
  {
    v11 = _m_pfadd(v10, _m_pfmul(a2[1], v6));
    v12 = _m_pfmul(_m_pfacc(v11, v11), _m_pfrcpit2(_m_pfrcpit1(v7, v8), v8));
    v13 = _m_pfadd(_m_pfmul(_m_pfsub(_mm_cvtsi32_si64(a4[1].m64_u32[0]), v6), v12), v6);
    a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                      _m_pfmul(_m_pfsub((__m64)a4->m64_u64, (__m64)a3->m64_u64), v12),
                                      (__m64)a3->m64_u64);
    a1[1].m64_i32[0] = _mm_cvtsi64_si32(v13);
  }
  _m_femms();
  return result;
}

// sub_45FAE8 @ 0x0045FAE8
__m64 *__stdcall sub_45FAE8(__m64 *a1, __m64 *a2)
{
  __m64 v2; // mm3
  __m64 v3; // mm2
  __m64 v4; // mm0
  __m64 v5; // mm0
  __m64 v6; // mm4
  __m64 v7; // mm5
  __m64 v9; // mm0

  v2 = a2[1];
  v3 = _m_pand(v2, (__m64)0xFFFFFFFFLL);
  v4 = _m_pfadd(_m_pfmul((__m64)a2->m64_u64, (__m64)a2->m64_u64), _m_pfmul(v3, v3));
  v5 = _m_pfacc(v4, v4);
  v6 = _m_pfrsqrt(v5);
  v7 = _m_pfcmpgt(v5, (__m64)0x80000000800000LL);
  v9 = _m_pfrcpit2(_m_pfrsqit1(v5, _m_pfmul(v6, v6)), v6);
  a1->m64_u64 = (unsigned __int64)_m_pfmul(_m_pand((__m64)a2->m64_u64, v7), v9);
  a1[1].m64_u64 = (unsigned __int64)_m_pfmul(_m_pand(v2, v7), v9);
  _m_femms();
  return a1;
}

// sub_45FB4C @ 0x0045FB4C
__m64 *__stdcall sub_45FB4C(__m64 *a1, __m64 *a2, __m64 *a3)
{
  __m64 m64_u64; // mm1
  __m64 v4; // mm0
  __m64 v5; // mm3
  __m64 v6; // mm5
  __m64 v7; // mm6
  __m64 v8; // mm7
  __m64 v10; // mm4

  _m_femms();
  m64_u64 = (__m64)a2->m64_u64;
  v4 = _m_punpckldq(m64_u64, m64_u64);
  v5 = a2[1];
  v6 = _m_punpckhdq(m64_u64, m64_u64);
  v7 = _m_punpckldq(v5, v5);
  v8 = _m_punpckhdq(v5, v5);
  v10 = _m_pfadd(_m_pfadd(_m_pfmul(v4, a3[1]), _m_pfmul(v6, a3[3])), _m_pfadd(_m_pfmul(v7, a3[5]), _m_pfmul(v8, a3[7])));
  a1->m64_u64 = (unsigned __int64)_m_pfadd(
                                    _m_pfadd(_m_pfmul(v4, (__m64)a3->m64_u64), _m_pfmul(v6, a3[2])),
                                    _m_pfadd(_m_pfmul(v7, a3[4]), _m_pfmul(v8, a3[6])));
  a1[1].m64_u64 = (unsigned __int64)v10;
  _m_femms();
  return a1;
}

// sub_45FBD0 @ 0x0045FBD0
__m128 *__cdecl sub_45FBD0(__m128 *a1, __m128 *a2, __m128 *a3)
{
  __m128 v3; // xmm1
  __m128 v4; // xmm2
  __m128 *v5; // edx
  __m128 v6; // xmm3
  __m128 v7; // xmm0
  __m128 v8; // xmm5
  __m128 v9; // xmm6
  __m128 v10; // xmm2
  __m128 v11; // xmm4
  __m128 v12; // xmm3
  __m128 v13; // xmm3
  __m128 v14; // xmm0
  __m128 v15; // xmm5
  __m128 v16; // xmm6
  __m128 v17; // xmm1
  __m128 v18; // xmm0
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v3 = _mm_and_ps(*a1, (__m128)xmmword_47AD90);
  v4 = _mm_and_ps(*a1, (__m128)xmmword_47ADA0);
  v5 = (__m128 *)(&savedregs - 16);
  v6 = _mm_add_ps(_mm_mul_ps(v4, (__m128)xmmword_47AD80), (__m128)xmmword_47AD30);
  v7 = _mm_sub_ps(v6, (__m128)xmmword_47AD30);
  v8 = (__m128)xmmword_47AD20;
  v9 = (__m128)xmmword_47AD10;
  v10 = _mm_sub_ps(
          _mm_sub_ps(
            _mm_sub_ps(_mm_sub_ps(v4, _mm_mul_ps((__m128)xmmword_47AD70, v7)), _mm_mul_ps((__m128)xmmword_47AD60, v7)),
            _mm_mul_ps((__m128)xmmword_47AD50, v7)),
          _mm_mul_ps((__m128)xmmword_47AD40, v7));
  v11 = _mm_mul_ps(v10, v10);
  v12 = _mm_and_ps(v6, (__m128)xmmword_47AD00);
  *v5 = _mm_and_ps(v12, (__m128)xmmword_47ACF0);
  v5[1] = v12;
  v5[2] = v12;
  v5[1].m128_i32[0] = (dword_47ACE0 & (v5[1].m128_i32[0] - v5->m128_i32[0])) << 30;
  v5[1].m128_i32[1] = (dword_47ACE0 & (v5[1].m128_i32[1] - v5->m128_i32[1])) << 30;
  v5[1].m128_i32[2] = (dword_47ACE0 & (v5[1].m128_i32[2] - v5->m128_i32[2])) << 30;
  v5[1].m128_i32[3] = (dword_47ACE0 & (v5[1].m128_i32[3] - v5->m128_i32[3])) << 30;
  v5[2].m128_i32[0] = (dword_47ACE0 & (v5->m128_i32[0] + v5[2].m128_i32[0])) << 30;
  v5[2].m128_i32[1] = (dword_47ACE0 & (v5->m128_i32[1] + v5[2].m128_i32[1])) << 30;
  v5[2].m128_i32[2] = (dword_47ACE0 & (v5->m128_i32[2] + v5[2].m128_i32[2])) << 30;
  v5[2].m128_i32[3] = (dword_47ACE0 & (v5->m128_i32[3] + v5[2].m128_i32[3])) << 30;
  v5->m128_i32[0] = *(&savedregs - 16) << 30;
  v5->m128_i32[1] <<= 30;
  v5->m128_i32[2] <<= 30;
  v5->m128_i32[3] = *(&savedregs - 13) << 30;
  v13 = _mm_xor_ps(*((__m128 *)&savedregs - 3), v3);
  v14 = _mm_cmpneq_ps(*((__m128 *)&savedregs - 4), (__m128)0LL);
  v15 = _mm_mul_ps(
          _mm_add_ps(
            _mm_mul_ps(
              _mm_add_ps(
                _mm_mul_ps(_mm_add_ps(_mm_mul_ps(v8, v11), (__m128)xmmword_47ACD0), v11),
                (__m128)xmmword_47ACB0),
              v11),
            (__m128)xmmword_47AC90),
          v10);
  v16 = _mm_add_ps(
          _mm_mul_ps(
            _mm_add_ps(
              _mm_mul_ps(
                _mm_add_ps(
                  _mm_mul_ps(_mm_add_ps(_mm_mul_ps(v9, v11), (__m128)xmmword_47ACC0), v11),
                  (__m128)xmmword_47ACA0),
                v11),
              (__m128)xmmword_47AC80),
            v11),
          (__m128)xmmword_47AC70);
  v17 = _mm_or_ps(_mm_andnot_ps(v14, v15), _mm_and_ps(v14, v16));
  v18 = _mm_xor_ps(_mm_or_ps(_mm_and_ps(v14, v15), _mm_andnot_ps(v14, v16)), *((__m128 *)&savedregs - 2));
  *a2 = _mm_xor_ps(v17, v13);
  *a3 = v18;
  return a2;
}

// sub_45FDC0 @ 0x0045FDC0
__m128 __userpurge sub_45FDC0@<xmm0>(__m128i a1@<xmm0>, int a2, int a3, int a4, int a5)
{
  __m128 v6; // xmm2
  __m128 v7; // xmm3
  __m128 v8; // xmm4
  __m128 v9; // xmm2
  __m128 v10; // xmm4
  __m128 v11; // xmm2
  __m128 v12; // xmm4
  __m128 v13; // xmm2
  __m128 v14; // xmm4
  __m128 v15; // xmm7
  __m128i v16; // xmm0
  __m128i v17; // xmm3
  __m128 v18; // xmm7
  __m128 v19; // xmm5
  __m128 v20; // xmm2
  __m128 v21; // xmm0
  __m128 v22; // xmm2

  v6 = (__m128)_mm_and_si128(a1, (__m128i)xmmword_47AE80);
  v7 = _mm_add_ps(_mm_mul_ps(v6, (__m128)xmmword_47AE60), (__m128)xmmword_47AE40);
  v8 = _mm_mul_ps((__m128)xmmword_47AE50, _mm_sub_ps(v7, (__m128)xmmword_47AE40));
  v9 = _mm_sub_ps(v6, v8);
  v10 = _mm_shuffle_ps(v8, v8, 57);
  v11 = _mm_sub_ps(v9, v10);
  v12 = _mm_shuffle_ps(v10, v10, 57);
  v13 = _mm_sub_ps(_mm_sub_ps(v11, v12), _mm_shuffle_ps(v12, v12, 57));
  v14 = _mm_mul_ps(v13, v13);
  v15 = _mm_and_ps(v7, (__m128)xmmword_47AE30);
  v16 = (__m128i)_mm_and_ps(v15, (__m128)xmmword_47AE20);
  v17 = _mm_sub_epi32((__m128i)v15, v16);
  v18 = (__m128)_mm_slli_epi32(_mm_and_si128(_mm_add_epi32((__m128i)v15, v16), (__m128i)xmmword_47AE10), 0x1Eu);
  v19 = _mm_add_ps(
          _mm_mul_ps(
            _mm_add_ps(
              _mm_mul_ps(
                _mm_add_ps(
                  _mm_mul_ps(_mm_add_ps(_mm_mul_ps((__m128)xmmword_47AE00, v14), (__m128)xmmword_47ADF0), v14),
                  (__m128)xmmword_47ADE0),
                v14),
              (__m128)xmmword_47ADD0),
            _mm_unpacklo_ps(v13, v14)),
          (__m128)xmmword_47ADC0);
  v20 = _mm_cmpneq_ps((__m128)_mm_slli_epi32(v16, 0x1Eu), (__m128)0LL);
  v21 = _mm_and_ps(v20, v19);
  v22 = _mm_andnot_ps(v20, v19);
  return _mm_xor_ps(
           _mm_or_ps(v21, _mm_shuffle_ps(v22, v22, 177)),
           _mm_unpacklo_ps(
             v18,
             (__m128)_mm_xor_si128(
                       _mm_slli_epi32(_mm_and_si128(v17, (__m128i)xmmword_47AE10), 0x1Eu),
                       _mm_and_si128(a1, (__m128i)xmmword_47AE70))));
}

// sub_45FEB0 @ 0x0045FEB0
__m128 *__cdecl sub_45FEB0(__m128i *a1, __m128 *a2, __m128 *a3)
{
  __m128 v3; // xmm2
  __m128 v4; // xmm3
  __m128 v5; // xmm0
  __m128 v6; // xmm2
  __m128 v7; // xmm4
  __m128 v8; // xmm7
  __m128i v9; // xmm0
  __m128i v10; // xmm3
  __m128 v11; // xmm7
  __m128 v12; // xmm0
  __m128 v13; // xmm5
  __m128 v14; // xmm6

  v3 = (__m128)_mm_and_si128(*a1, (__m128i)xmmword_47AFC0);
  v4 = _mm_add_ps(_mm_mul_ps(v3, (__m128)xmmword_47AFA0), (__m128)xmmword_47AF50);
  v5 = _mm_sub_ps(v4, (__m128)xmmword_47AF50);
  v6 = _mm_sub_ps(
         _mm_sub_ps(
           _mm_sub_ps(_mm_sub_ps(v3, _mm_mul_ps((__m128)xmmword_47AF90, v5)), _mm_mul_ps((__m128)xmmword_47AF80, v5)),
           _mm_mul_ps((__m128)xmmword_47AF70, v5)),
         _mm_mul_ps((__m128)xmmword_47AF60, v5));
  v7 = _mm_mul_ps(v6, v6);
  v8 = _mm_and_ps(v4, (__m128)xmmword_47AF20);
  v9 = (__m128i)_mm_and_ps(v8, (__m128)xmmword_47AF10);
  v10 = _mm_sub_epi32((__m128i)v8, v9);
  v11 = (__m128)_mm_slli_epi32(_mm_and_si128(_mm_add_epi32((__m128i)v8, v9), (__m128i)xmmword_47AF00), 0x1Eu);
  v12 = _mm_cmpneq_ps((__m128)_mm_slli_epi32(v9, 0x1Eu), (__m128)0LL);
  v13 = _mm_mul_ps(
          _mm_add_ps(
            _mm_mul_ps(
              _mm_add_ps(
                _mm_mul_ps(_mm_add_ps(_mm_mul_ps((__m128)xmmword_47AF40, v7), (__m128)xmmword_47AEF0), v7),
                (__m128)xmmword_47AED0),
              v7),
            (__m128)xmmword_47AEB0),
          v6);
  v14 = _mm_add_ps(
          _mm_mul_ps(
            _mm_add_ps(
              _mm_mul_ps(
                _mm_add_ps(
                  _mm_mul_ps(_mm_add_ps(_mm_mul_ps((__m128)xmmword_47AF30, v7), (__m128)xmmword_47AEE0), v7),
                  (__m128)xmmword_47AEC0),
                v7),
              (__m128)xmmword_47AEA0),
            v7),
          (__m128)xmmword_47AE90);
  *a2 = _mm_xor_ps(
          _mm_or_ps(_mm_andnot_ps(v12, v13), _mm_and_ps(v12, v14)),
          (__m128)_mm_xor_si128(
                    _mm_slli_epi32(_mm_and_si128(v10, (__m128i)xmmword_47AF00), 0x1Eu),
                    _mm_and_si128(*a1, (__m128i)xmmword_47AFB0)));
  *a3 = _mm_xor_ps(_mm_or_ps(_mm_and_ps(v12, v13), _mm_andnot_ps(v12, v14)), v11);
  return a2;
}

// math_atan2_packed @ 0x004600C0
// packed atan2 approximation; inputs in MM0/MM1
void sub_4600C0()
{
  ;
}

// math_acos_packed @ 0x004601C0
// packed acos approximation; input in MM0
void sub_4601C0()
{
  ;
}

// sub_4603C0 @ 0x004603C0
void sub_4603C0()
{
  ;
}

// math_sincos_packed @ 0x004607A0
// packed sin/cos approximation for the angle in MM0
unsigned int __usercall sub_4607A0@<eax>(__m64 a1@<mm0>)
{
  int v1; // eax

  v1 = _mm_cvtsi64_si32(a1);
  return v1 & 0x80000000 ^ v1;
}

// math_sin_packed @ 0x004608C0
// packed sin approximation; input in MM0
unsigned int __usercall sub_4608C0@<eax>(__m64 a1@<mm0>)
{
  int v1; // eax

  v1 = _mm_cvtsi64_si32(a1);
  return v1 & 0x80000000 ^ v1;
}

// FUN_00460cb8 @ 0x00460CB8
// [binja] int32_t sub_460cb8()
int sub_460CB8()
{
  int result; // eax

  _cfltcvt_init_10();
  dword_4D9964 = FUN_00463737();
  result = _setdefaultprecision();
  __asm { fnclex }
  return result;
}

// nullsub_103 @ 0x00460CCF
void nullsub_103()
{
  ;
}

// crt_free @ 0x00460DC7
// CRT free wrapper
int __cdecl sub_460DC7(LPVOID lpMem)
{
  return crt_free_base(lpMem);
}

// sub_461501 @ 0x00461501
int sub_461501()
{
  return crt_flushall(1);
}

// crt_fwrite @ 0x004615AE
// fwrite wrapper with CRT lock/unlock
size_t __cdecl sub_4615AE(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream)
{
  size_t v4; // esi

  crt_lock_file(Stream);
  v4 = crt_fwrite_nolock(Buffer, ElementSize, ElementCount, Stream);
  crt_unlock_file(Stream);
  return v4;
}

// crt_fread @ 0x00461AF7
// fread wrapper with CRT lock/unlock
size_t __cdecl sub_461AF7(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream)
{
  size_t v4; // esi

  crt_lock_file(Stream);
  v4 = crt_fread_nolock(Buffer, ElementSize, ElementCount, Stream);
  crt_unlock_file(Stream);
  return v4;
}

// sub_461FD5 @ 0x00461FD5
int sub_461FD5(int a1, ...)
{
  int v1; // edi
  int v2; // ebx
  va_list va; // [esp+14h] [ebp+8h] BYREF

  va_start(va, a1);
  crt_lock_file2(1, &stru_47B3F8);
  v1 = FUN_004666f5(&stru_47B3F8);
  v2 = crt_output(&stru_47B3F8, a1, (int)va);
  _ftbuf(v1, &stru_47B3F8);
  crt_unlock_file2(1, &stru_47B3F8);
  return v2;
}

// crt_thread_entry @ 0x004622B6
// CRT: thread start trampoline
void __stdcall __noreturn StartAddress(_DWORD *lpThreadParameter)
{
  _DWORD *Value; // esi

  Value = TlsGetValue(dwTlsIndex);
  if ( Value )
  {
    Value[18] = lpThreadParameter[18];
    Value[19] = lpThreadParameter[19];
    crt_free_thread_data(lpThreadParameter);
  }
  else
  {
    Value = lpThreadParameter;
  }
  if ( !TlsSetValue(dwTlsIndex, Value) )
    _amsg_exit(0x10u);
  if ( off_47B164 )
    off_47B164();
  ((void (__cdecl *)(_DWORD))Value[18])(Value[19]);
  crt_endthread();
}

// crt_free_base @ 0x004625C1
// [binja] int32_t sub_462683()
void __cdecl sub_4625C1(LPVOID lpMem)
{
  int block; // eax
  bool v2; // zf
  int v3; // eax
  int v4; // [esp+Ch] [ebp-28h] BYREF
  int v5; // [esp+10h] [ebp-24h]
  int v6; // [esp+14h] [ebp-20h] BYREF
  int v7; // [esp+18h] [ebp-1Ch]
  CPPEH_RECORD ms_exc; // [esp+1Ch] [ebp-18h]

  if ( lpMem )
  {
    if ( crt_heap_mode == 3 )
    {
      crt_lock(9);
      ms_exc.registration.TryLevel = 0;
      block = crt_sbh_find_region(lpMem);
      v7 = block;
      if ( block )
        FUN_00466ca6(block, lpMem);
      ms_exc.registration.TryLevel = -1;
      crt_unlock(9);
      v2 = v7 == 0;
    }
    else
    {
      if ( crt_heap_mode != 2 )
      {
LABEL_11:
        HeapFree(hHeap, 0, lpMem);
        return;
      }
      crt_lock(9);
      ms_exc.registration.TryLevel = 1;
      v3 = crt_sbh_find_block(lpMem, &v4, &v6);
      v5 = v3;
      if ( v3 )
        FUN_00467a2d(v4, v6, v3);
      ms_exc.registration.TryLevel = -1;
      crt_unlock(9);
      v2 = v5 == 0;
    }
    if ( !v2 )
      return;
    goto LABEL_11;
  }
}

// crt_realloc @ 0x004626AA
// [binja] int32_t sub_462983()
void *__cdecl sub_4626AA(LPVOID lpMem, SIZE_T dwBytes)
{
  void *v2; // ebx
  void *result; // eax
  SIZE_T v4; // esi
  int block; // eax
  size_t v6; // eax
  size_t v7; // eax
  unsigned __int8 *v8; // eax
  unsigned __int8 *v9; // edi
  size_t v10; // eax
  size_t v11; // eax
  int v12; // [esp+Ch] [ebp-38h] BYREF
  size_t v13; // [esp+10h] [ebp-34h]
  unsigned __int8 *v14; // [esp+14h] [ebp-30h]
  int v15; // [esp+18h] [ebp-2Ch] BYREF
  int v16; // [esp+1Ch] [ebp-28h]
  void *v17; // [esp+20h] [ebp-24h]
  size_t v18; // [esp+24h] [ebp-20h]
  CPPEH_RECORD ms_exc; // [esp+2Ch] [ebp-18h]

  v2 = lpMem;
  if ( !lpMem )
    return malloc(dwBytes);
  v4 = dwBytes;
  if ( dwBytes )
  {
    if ( crt_heap_mode == 3 )
    {
      while ( 1 )
      {
        v17 = 0;
        if ( v4 <= 0xFFFFFFE0 )
        {
          crt_lock(9);
          ms_exc.registration.TryLevel = 0;
          block = crt_sbh_find_region(lpMem);
          v16 = block;
          if ( block )
          {
            if ( v4 <= dword_4DA3A0 )
            {
              if ( FUN_00467484(block, lpMem, v4) )
              {
                v17 = lpMem;
              }
              else
              {
                v17 = (void *)crt_sbh_alloc(v4);
                if ( v17 )
                {
                  v6 = *((_DWORD *)lpMem - 1) - 1;
                  v18 = v6;
                  if ( v6 >= v4 )
                    v6 = v4;
                  crt_bufcpy(v17, lpMem, v6);
                  v16 = crt_sbh_find_region(lpMem);
                  FUN_00466ca6(v16, lpMem);
                }
              }
            }
            if ( !v17 )
            {
              if ( !v4 )
                v4 = 1;
              v4 = (v4 + 15) & 0xFFFFFFF0;
              v17 = HeapAlloc(hHeap, 0, v4);
              if ( v17 )
              {
                v7 = *((_DWORD *)lpMem - 1) - 1;
                v18 = v7;
                if ( v7 >= v4 )
                  v7 = v4;
                crt_bufcpy(v17, lpMem, v7);
                FUN_00466ca6(v16, lpMem);
              }
            }
          }
          ms_exc.registration.TryLevel = -1;
          crt_unlock(9);
          if ( !v16 )
          {
            if ( !v4 )
              v4 = 1;
            v4 = (v4 + 15) & 0xFFFFFFF0;
            v17 = HeapReAlloc(hHeap, 0, lpMem, v4);
          }
        }
        result = v17;
        if ( v17 || !dword_4D9A78 )
          break;
        if ( !crt_call_new_handler(v4) )
          return 0;
      }
    }
    else if ( crt_heap_mode == 2 )
    {
      if ( dwBytes <= 0xFFFFFFE0 )
        v4 = (dwBytes + 15) & 0xFFFFFFF0;
      while ( 1 )
      {
        v17 = 0;
        if ( v4 <= 0xFFFFFFE0 )
        {
          crt_lock(9);
          ms_exc.registration.TryLevel = 1;
          v8 = (unsigned __int8 *)crt_sbh_find_block(v2, &v12, &v15);
          v9 = v8;
          v14 = v8;
          if ( v8 )
          {
            if ( v4 < dword_47DB14 )
            {
              if ( FUN_00467d9e(v12, v15, v8, v4 >> 4) )
              {
                v17 = lpMem;
              }
              else
              {
                v17 = (void *)crt_sbh_alloc_units(v4 >> 4);
                if ( v17 )
                {
                  v10 = 16 * *v9;
                  v13 = v10;
                  if ( v10 >= v4 )
                    v10 = v4;
                  crt_bufcpy(v17, lpMem, v10);
                  FUN_00467a2d(v12, v15, v9);
                }
              }
              v2 = lpMem;
            }
            if ( !v17 )
            {
              v17 = HeapAlloc(hHeap, 0, v4);
              if ( v17 )
              {
                v11 = 16 * *v9;
                v13 = v11;
                if ( v11 >= v4 )
                  v11 = v4;
                crt_bufcpy(v17, v2, v11);
                FUN_00467a2d(v12, v15, v9);
              }
            }
          }
          else
          {
            v17 = HeapReAlloc(hHeap, 0, v2, v4);
          }
          ms_exc.registration.TryLevel = -1;
          crt_unlock(9);
        }
        result = v17;
        if ( v17 || !dword_4D9A78 )
          break;
        if ( !crt_call_new_handler(v4) )
          return 0;
      }
    }
    else
    {
      while ( 1 )
      {
        result = 0;
        if ( v4 <= 0xFFFFFFE0 )
        {
          if ( !v4 )
            v4 = 1;
          v4 = (v4 + 15) & 0xFFFFFFF0;
          result = HeapReAlloc(hHeap, 0, lpMem, v4);
        }
        if ( result || !dword_4D9A78 )
          break;
        if ( !crt_call_new_handler(v4) )
          return 0;
      }
    }
  }
  else
  {
    crt_free_base(lpMem);
    return 0;
  }
  return result;
}

// FUN_00462a17 @ 0x00462A17
// [binja] int32_t sub_462add()
LPVOID __cdecl sub_462A17(unsigned int a1)
{
  LPVOID result; // eax
  SIZE_T v2; // esi
  int v3; // eax
  SIZE_T v4; // eax
  void *v5; // [esp+Ch] [ebp-1Ch]
  void *v6; // [esp+Ch] [ebp-1Ch]

  if ( crt_heap_mode == 3 )
  {
    if ( a1 <= dword_4DA3A0 )
    {
      crt_lock(9);
      v5 = (void *)crt_sbh_alloc(a1);
      crt_unlock(9);
      result = v5;
      if ( v5 )
        return result;
    }
    goto LABEL_12;
  }
  if ( crt_heap_mode != 2 )
  {
LABEL_12:
    v3 = a1;
    if ( !a1 )
      v3 = 1;
    v4 = v3 + 15;
    LOBYTE(v4) = v4 & 0xF0;
    return HeapAlloc(hHeap, 0, v4);
  }
  if ( a1 )
    v2 = (a1 + 15) & 0xFFFFFFF0;
  else
    v2 = 16;
  if ( v2 > dword_47DB14 )
    return HeapAlloc(hHeap, 0, v2);
  crt_lock(9);
  v6 = (void *)crt_sbh_alloc_units(v2 >> 4);
  crt_unlock(9);
  result = v6;
  if ( !v6 )
    return HeapAlloc(hHeap, 0, v2);
  return result;
}

// nullsub_104 @ 0x00463176
void nullsub_104()
{
  ;
}

// crt_msize @ 0x00463B86
// [binja] int32_t sub_463c6b()
SIZE_T __cdecl sub_463B86(_DWORD *lpMem)
{
  int v1; // esi
  bool v2; // zf
  unsigned __int8 *v3; // eax
  _BYTE v5[4]; // [esp+Ch] [ebp-2Ch] BYREF
  unsigned __int8 *v6; // [esp+10h] [ebp-28h]
  _BYTE v7[4]; // [esp+14h] [ebp-24h] BYREF
  int v8; // [esp+18h] [ebp-20h]
  int block; // [esp+1Ch] [ebp-1Ch]
  CPPEH_RECORD ms_exc; // [esp+20h] [ebp-18h]

  if ( crt_heap_mode == 3 )
  {
    crt_lock(9);
    ms_exc.registration.TryLevel = 0;
    block = crt_sbh_find_region(lpMem);
    if ( block )
    {
      v1 = *(lpMem - 1) - 9;
      v8 = v1;
    }
    else
    {
      v1 = v8;
    }
    ms_exc.registration.TryLevel = -1;
    crt_unlock(9);
    v2 = block == 0;
  }
  else
  {
    if ( crt_heap_mode != 2 )
      return HeapSize(hHeap, 0, lpMem);
    crt_lock(9);
    ms_exc.registration.TryLevel = 1;
    v3 = (unsigned __int8 *)crt_sbh_find_block(lpMem, v5, v7);
    v6 = v3;
    if ( v3 )
    {
      v1 = 16 * *v3;
      v8 = v1;
    }
    else
    {
      v1 = v8;
    }
    ms_exc.registration.TryLevel = -1;
    crt_unlock(9);
    v2 = v6 == 0;
  }
  if ( v2 )
    return HeapSize(hHeap, 0, lpMem);
  return v1;
}

// crt_output @ 0x00464380
// CRT: core printf formatter
int __cdecl sub_464380(FILE *File, char *a2, int a3)
{
  int v3; // ecx
  char v4; // bl
  char *v5; // esi
  bool v6; // zf
  int v7; // eax
  int int_arg; // eax
  int v9; // eax
  int v10; // esi
  int v11; // eax
  char *v12; // ecx
  char *i; // eax
  int v14; // edx
  wchar_t short_arg; // ax
  __int16 *v16; // eax
  int v17; // ecx
  unsigned int v18; // eax
  int v19; // eax
  void *v20; // eax
  char *j; // eax
  int v22; // edx
  _WORD *v23; // eax
  __int64 v24; // rax
  int v25; // eax
  int v26; // ebx
  _BYTE *v27; // eax
  char *v28; // eax
  char v29; // bl
  int v30; // esi
  wchar_t *v31; // ebx
  int v32; // edi
  wchar_t v33; // ax
  int v34; // eax
  char MbCh[511]; // [esp+Ch] [ebp-24Ch] BYREF
  char v38; // [esp+20Bh] [ebp-4Dh] BYREF
  int v39; // [esp+20Ch] [ebp-4Ch]
  int v40; // [esp+210h] [ebp-48h]
  char v41[4]; // [esp+214h] [ebp-44h] BYREF
  int v42; // [esp+218h] [ebp-40h]
  int v43; // [esp+21Ch] [ebp-3Ch]
  int v44; // [esp+220h] [ebp-38h]
  int v45; // [esp+224h] [ebp-34h]
  LPVOID lpMem; // [esp+228h] [ebp-30h]
  int v47; // [esp+22Ch] [ebp-2Ch]
  int v48; // [esp+230h] [ebp-28h]
  int v49; // [esp+234h] [ebp-24h]
  unsigned __int64 v50; // [esp+238h] [ebp-20h]
  _WORD v51[3]; // [esp+242h] [ebp-16h] BYREF
  int v52; // [esp+248h] [ebp-10h]
  int v53; // [esp+24Ch] [ebp-Ch]
  int v54; // [esp+250h] [ebp-8h]
  int v55; // [esp+254h] [ebp-4h]
  char *v56; // [esp+264h] [ebp+Ch]

  v3 = 0;
  v52 = 0;
  v4 = *a2;
  v5 = a2 + 1;
  v6 = *a2 == 0;
  *(_DWORD *)&v51[1] = 0;
  lpMem = 0;
  v56 = a2 + 1;
  if ( !v6 )
  {
    while ( 1 )
    {
      if ( *(int *)&v51[1] < 0 )
        return *(_DWORD *)&v51[1];
      if ( v4 < 32 || v4 > 120 )
        v7 = 0;
      else
        v7 = Source[v4] & 0xF;
      v43 = byte_46FAD8[8 * v7 + v3] >> 4;
      switch ( v43 )
      {
        case 0:
          goto LABEL_42;
        case 1:
          v54 = -1;
          v42 = 0;
          v44 = 0;
          v48 = 0;
          v49 = 0;
          v55 = 0;
          v47 = 0;
          goto LABEL_179;
        case 2:
          switch ( v4 )
          {
            case ' ':
              v55 |= 2u;
              break;
            case '#':
              LOBYTE(v55) = v55 | 0x80;
              break;
            case '+':
              v55 |= 1u;
              break;
            case '-':
              v55 |= 4u;
              break;
            case '0':
              v55 |= 8u;
              break;
          }
          goto LABEL_179;
        case 3:
          if ( v4 == 42 )
          {
            int_arg = FUN_00464bbc(&a3);
            v48 = int_arg;
            if ( int_arg >= 0 )
              goto LABEL_179;
            v55 |= 4u;
            v9 = -int_arg;
          }
          else
          {
            v9 = v4 + 10 * v48 - 48;
          }
          v48 = v9;
          goto LABEL_179;
        case 4:
          v54 = 0;
          goto LABEL_179;
        case 5:
          if ( v4 == 42 )
          {
            v54 = FUN_00464bbc(&a3);
            if ( v54 < 0 )
              v54 = -1;
          }
          else
          {
            v54 = v4 + 10 * v54 - 48;
          }
          goto LABEL_179;
        case 6:
          switch ( v4 )
          {
            case 'I':
              if ( *v5 == 54 && v5[1] == 52 )
              {
                BYTE1(v55) |= 0x80u;
                v56 = v5 + 2;
              }
              else
              {
                v43 = 0;
LABEL_42:
                v47 = 0;
                if ( *((char *)crt_ctype_table + 2 * (unsigned __int8)v4 + 1) < 0 )
                {
                  crt_putc_nolock(v4, File, (int)&v51[1]);
                  v4 = *v5;
                  v56 = v5 + 1;
                }
                crt_putc_nolock(v4, File, (int)&v51[1]);
              }
              break;
            case 'h':
              v55 |= 0x20u;
              break;
            case 'l':
              v55 |= 0x10u;
              break;
            case 'w':
              v55 |= 0x800u;
              break;
          }
          goto LABEL_179;
        case 7:
          if ( v4 > 103 )
          {
            switch ( v4 )
            {
              case 'i':
                goto LABEL_119;
              case 'n':
                v23 = (_WORD *)FUN_00464bbc(&a3);
                if ( (v55 & 0x20) != 0 )
                  *v23 = v51[1];
                else
                  *(_DWORD *)v23 = *(_DWORD *)&v51[1];
                v44 = 1;
                goto LABEL_177;
              case 'o':
                v52 = 8;
                if ( (v55 & 0x80u) != 0 )
                  v55 |= 0x200u;
                break;
              default:
                switch ( v4 )
                {
                  case 'p':
                    v54 = 8;
LABEL_110:
                    v45 = 7;
                    break;
                  case 's':
                    goto LABEL_55;
                  case 'u':
                    goto LABEL_120;
                  case 'x':
                    v45 = 39;
                    break;
                  default:
                    goto LABEL_154;
                }
                v52 = 16;
                if ( (v55 & 0x80u) != 0 )
                {
                  LOBYTE(v51[0]) = 48;
                  v49 = 2;
                  HIBYTE(v51[0]) = v45 + 81;
                }
                break;
            }
LABEL_121:
            if ( (v55 & 0x8000) == 0 )
            {
              if ( (v55 & 0x20) != 0 )
              {
                if ( (v55 & 0x40) != 0 )
                  LODWORD(v24) = (__int16)FUN_00464bbc(&a3);
                else
                  LODWORD(v24) = (unsigned __int16)FUN_00464bbc(&a3);
              }
              else
              {
                if ( (v55 & 0x40) == 0 )
                {
                  v24 = (unsigned int)FUN_00464bbc(&a3);
                  goto LABEL_131;
                }
                LODWORD(v24) = FUN_00464bbc(&a3);
              }
              v24 = (int)v24;
            }
            else
            {
              LODWORD(v24) = FUN_00464bc9(&a3);
            }
LABEL_131:
            if ( (v55 & 0x40) != 0 && v24 < 0 )
            {
              BYTE1(v55) |= 1u;
              v50 = -v24;
            }
            else
            {
              v50 = v24;
            }
            if ( (v55 & 0x8000) == 0 )
              HIDWORD(v50) = 0;
            if ( v54 >= 0 )
            {
              v55 &= ~8u;
              if ( v54 > 512 )
                v54 = 512;
            }
            else
            {
              v54 = 1;
            }
            if ( !v50 )
              v49 = 0;
            v53 = (int)&v38;
            while ( 1 )
            {
              v25 = v54--;
              if ( v25 <= 0 && !v50 )
                break;
              v26 = v50 % v52 + 48;
              v50 /= (unsigned __int64)v52;
              if ( v26 > 57 )
                LOBYTE(v26) = v45 + v26;
              v27 = (_BYTE *)v53--;
              *v27 = v26;
            }
            v28 = &v38 - v53++;
            v52 = (int)v28;
            if ( (v55 & 0x200) != 0 && (*(_BYTE *)v53 != 48 || !v28) )
            {
              --v53;
              v19 = (int)(v28 + 1);
              *(_BYTE *)v53 = 48;
              goto LABEL_153;
            }
            goto LABEL_154;
          }
          if ( v4 >= 101 )
            goto LABEL_65;
          if ( v4 > 88 )
          {
            if ( v4 == 90 )
            {
              v16 = (__int16 *)FUN_00464bbc(&a3);
              if ( v16 && (v17 = *((_DWORD *)v16 + 1)) != 0 )
              {
                if ( (v55 & 0x800) != 0 )
                {
                  v18 = (unsigned int)*v16 >> 1;
                  v53 = v17;
                  v52 = v18;
                  v47 = 1;
                  goto LABEL_154;
                }
                v47 = 0;
                v53 = v17;
                v19 = *v16;
              }
              else
              {
                v53 = (int)Str;
                v19 = strlen(Str);
              }
              goto LABEL_153;
            }
            if ( v4 == 99 )
              goto LABEL_69;
            if ( v4 != 100 )
              goto LABEL_154;
LABEL_119:
            v55 |= 0x40u;
LABEL_120:
            v52 = 10;
            goto LABEL_121;
          }
          switch ( v4 )
          {
            case 'X':
              goto LABEL_110;
            case 'C':
              if ( (v55 & 0x830) == 0 )
                v55 |= 0x800u;
LABEL_69:
              if ( (v55 & 0x810) != 0 )
              {
                short_arg = FUN_00464bd9(&a3);
                v52 = wctomb(MbCh, short_arg);
                if ( v52 < 0 )
                  v44 = 1;
              }
              else
              {
                MbCh[0] = FUN_00464bbc(&a3);
                v52 = 1;
              }
              v53 = (int)MbCh;
              break;
            case 'E':
            case 'G':
              v42 = 1;
              v4 += 32;
LABEL_65:
              v55 |= 0x40u;
              v53 = (int)MbCh;
              if ( v54 >= 0 )
              {
                if ( v54 )
                {
                  if ( v54 > 512 )
                    v54 = 512;
                  if ( v54 > 163 )
                  {
                    v20 = malloc(v54 + 349);
                    lpMem = v20;
                    if ( v20 )
                      v53 = (int)v20;
                    else
                      v54 = 163;
                  }
                }
                else
                {
                  v54 = v4 == 103;
                }
              }
              else
              {
                v54 = 6;
              }
              a3 += 8;
              v39 = *(_DWORD *)(a3 - 8);
              v40 = *(_DWORD *)(a3 - 4);
              off_47B1A8();
            case 'S':
              if ( (v55 & 0x830) == 0 )
                v55 |= 0x800u;
LABEL_55:
              v10 = 0x7FFFFFFF;
              if ( v54 != -1 )
                v10 = v54;
              v11 = FUN_00464bbc(&a3);
              v12 = (char *)v11;
              v53 = v11;
              if ( (v55 & 0x810) != 0 )
              {
                if ( !v11 )
                {
                  v12 = (char *)off_47B65C;
                  v53 = (int)off_47B65C;
                }
                v47 = 1;
                for ( i = v12; ; i += 2 )
                {
                  v14 = v10--;
                  if ( !v14 || !*(_WORD *)i )
                    break;
                }
                v19 = (i - v12) >> 1;
              }
              else
              {
                if ( !v11 )
                {
                  v12 = Str;
                  v53 = (int)Str;
                }
                for ( j = v12; ; ++j )
                {
                  v22 = v10--;
                  if ( !v22 || !*j )
                    break;
                }
                v19 = j - v12;
              }
LABEL_153:
              v52 = v19;
              break;
          }
LABEL_154:
          if ( v44 )
            goto LABEL_177;
          v29 = v55;
          if ( (v55 & 0x40) == 0 )
            goto LABEL_163;
          if ( (v55 & 0x100) != 0 )
          {
            LOBYTE(v51[0]) = 45;
LABEL_162:
            v49 = 1;
            goto LABEL_163;
          }
          if ( (v55 & 1) != 0 )
          {
            LOBYTE(v51[0]) = 43;
            goto LABEL_162;
          }
          if ( (v55 & 2) != 0 )
          {
            LOBYTE(v51[0]) = 32;
            goto LABEL_162;
          }
LABEL_163:
          v30 = v48 - v49 - v52;
          if ( (v55 & 0xC) == 0 )
            crt_putc_repeat_nolock(32, v48 - v49 - v52, File, (int)&v51[1]);
          crt_putc_buffer_nolock((int)v51, v49, File, (int)&v51[1]);
          if ( (v29 & 8) != 0 && (v29 & 4) == 0 )
            crt_putc_repeat_nolock(48, v30, File, (int)&v51[1]);
          if ( v47 && v52 > 0 )
          {
            v31 = (wchar_t *)v53;
            v32 = v52 - 1;
            do
            {
              v33 = *v31++;
              v34 = wctomb(v41, v33);
              if ( v34 <= 0 )
                break;
              crt_putc_buffer_nolock((int)v41, v34, File, (int)&v51[1]);
            }
            while ( v32-- );
          }
          else
          {
            crt_putc_buffer_nolock(v53, v52, File, (int)&v51[1]);
          }
          if ( (v55 & 4) != 0 )
            crt_putc_repeat_nolock(32, v30, File, (int)&v51[1]);
LABEL_177:
          if ( lpMem )
          {
            crt_free_base(lpMem);
            lpMem = 0;
          }
LABEL_179:
          v4 = *v56;
          v5 = v56 + 1;
          v6 = *v56++ == 0;
          if ( v6 )
            return *(_DWORD *)&v51[1];
          v3 = v43;
          break;
        default:
          goto LABEL_179;
      }
    }
  }
  return *(_DWORD *)&v51[1];
}

// crt_dosmaperr @ 0x00465D20
// map Win32 error to errno/doserrno
int *__cdecl sub_465D20(unsigned int a1)
{
  int v1; // esi
  void (__cdecl __noreturn **v2)(); // eax
  int *result; // eax

  v1 = 0;
  *crt_doserrno_ptr() = a1;
  v2 = (void (__cdecl __noreturn **)())&crt_dosmaperr_table;
  do
  {
    if ( (void (__cdecl __noreturn *)())a1 == *v2 )
    {
      result = crt_errno_ptr();
      *result = dword_47B7C4[2 * v1];
      return result;
    }
    v2 += 2;
    ++v1;
  }
  while ( v2 < &off_47B928 );
  if ( a1 < 0x13 || a1 > 0x24 )
  {
    if ( a1 < 0xBC || a1 > 0xCA )
    {
      result = crt_errno_ptr();
      *result = 22;
    }
    else
    {
      result = crt_errno_ptr();
      *result = 8;
    }
  }
  else
  {
    result = crt_errno_ptr();
    *result = 13;
  }
  return result;
}

// crt_invalid_parameter_noinfo_noreturn @ 0x00465FA9
// invokes invalid-parameter handler (if set) then terminates
void __thiscall __noreturn sub_465FA9(EXCEPTION_POINTERS *this)
{
  int v1; // [esp-Ch] [ebp-24h] BYREF
  CPPEH_RECORD ms_exc; // [esp+0h] [ebp-18h]

  ms_exc.registration.ScopeTable = stru_46FBB0;
  ms_exc.registration.ExceptionHandler = _except_handler3;
  ms_exc.registration.Next = (struct _EH3_EXCEPTION_REGISTRATION *)NtCurrentTeb()->NtTib.ExceptionList;
  ms_exc.exc_ptr = this;
  ms_exc.old_esp = (DWORD)&v1;
  ms_exc.registration.TryLevel = 0;
  if ( off_47B928 )
  {
    ms_exc.registration.TryLevel = 1;
    off_47B928();
  }
  ms_exc.registration.TryLevel = -1;
  crt_terminate();
}

// crt_calloc @ 0x004667AC
// [binja] int32_t sub_4668ce()
int __cdecl sub_4667AC(int a1, int a2)
{
  SIZE_T v2; // esi
  int result; // eax
  LPVOID v4; // [esp+14h] [ebp-20h]
  size_t v5; // [esp+18h] [ebp-1Ch]

  v2 = a2 * a1;
  v5 = a2 * a1;
  if ( (unsigned int)(a2 * a1) <= 0xFFFFFFE0 )
  {
    if ( !v2 )
      v2 = 1;
    v2 = (v2 + 15) & 0xFFFFFFF0;
  }
  while ( 1 )
  {
    v4 = 0;
    if ( v2 <= 0xFFFFFFE0 )
    {
      if ( crt_heap_mode == 3 )
      {
        if ( v5 > dword_4DA3A0 )
          goto LABEL_14;
        crt_lock(9);
        v4 = (LPVOID)crt_sbh_alloc(v5);
        crt_unlock(9);
        if ( v4 )
        {
          memset(v4, 0, v5);
          goto LABEL_14;
        }
LABEL_15:
        v4 = HeapAlloc(hHeap, 8u, v2);
        goto LABEL_16;
      }
      if ( crt_heap_mode == 2 && v2 <= dword_47DB14 )
      {
        crt_lock(9);
        v4 = (LPVOID)crt_sbh_alloc_units(v2 >> 4);
        crt_unlock(9);
        if ( !v4 )
          goto LABEL_15;
        memset(v4, 0, v2);
      }
LABEL_14:
      if ( v4 )
        return (int)v4;
      goto LABEL_15;
    }
LABEL_16:
    if ( v4 || !dword_4D9A78 )
      return (int)v4;
    result = crt_call_new_handler(v2);
    if ( !result )
      return result;
  }
}

// FUN_00466a61 @ 0x00466A61
// [binja] HMODULE sub_466a61(int32_t* arg1)
char __cdecl sub_466A61(int a1)
{
  HMODULE ModuleHandleA; // eax
  int v2; // ecx

  *(_DWORD *)a1 = 0;
  ModuleHandleA = GetModuleHandleA(0);
  if ( *(_WORD *)ModuleHandleA == 23117 )
  {
    v2 = *((_DWORD *)ModuleHandleA + 15);
    if ( v2 )
    {
      ModuleHandleA = (HMODULE)((char *)ModuleHandleA + v2);
      *(_BYTE *)a1 = *((_BYTE *)ModuleHandleA + 26);
      LOBYTE(ModuleHandleA) = *((_BYTE *)ModuleHandleA + 27);
      *(_BYTE *)(a1 + 1) = (_BYTE)ModuleHandleA;
    }
  }
  return (char)ModuleHandleA;
}

// crt_heap_select @ 0x00466A8E
// selects CRT heap strategy
int sub_466A8E()
{
  int result; // eax
  CHAR *i; // ecx
  char v2; // al
  CHAR *v3; // eax
  CHAR *j; // ecx
  char v5; // al
  char *v6; // eax
  const char *v7; // eax
  const char *v8; // ecx
  CHAR Buffer[4240]; // [esp+4h] [ebp-122Ch] BYREF
  CHAR Filename[260]; // [esp+1094h] [ebp-19Ch] BYREF
  struct _OSVERSIONINFOA VersionInformation; // [esp+1198h] [ebp-98h] BYREF
  _BYTE v12[4]; // [esp+122Ch] [ebp-4h] BYREF

  VersionInformation.dwOSVersionInfoSize = 148;
  if ( GetVersionExA(&VersionInformation)
    && VersionInformation.dwPlatformId == 2
    && VersionInformation.dwMajorVersion >= 5 )
  {
    return 1;
  }
  if ( !GetEnvironmentVariableA("__MSVCRT_HEAP_SELECT", Buffer, 0x1090u) )
    goto LABEL_29;
  for ( i = Buffer; *i; ++i )
  {
    v2 = *i;
    if ( *i >= 97 && v2 <= 122 )
      *i = v2 - 32;
  }
  if ( !strncmp("__GLOBAL_HEAP_SELECTED", Buffer, 0x16u) )
  {
    v3 = Buffer;
  }
  else
  {
    GetModuleFileNameA(0, Filename, 0x104u);
    for ( j = Filename; *j; ++j )
    {
      v5 = *j;
      if ( *j >= 97 && v5 <= 122 )
        *j = v5 - 32;
    }
    v3 = strstr(Buffer, Filename);
  }
  if ( !v3 )
    goto LABEL_29;
  v6 = strchr(v3, 44);
  if ( !v6 )
    goto LABEL_29;
  v7 = v6 + 1;
  v8 = v7;
  while ( *v8 )
  {
    if ( *v8 == 59 )
      *v8 = 0;
    else
      ++v8;
  }
  result = crt_strtol_l(v7, 0, 10);
  if ( result != 2 && result != 3 && result != 1 )
  {
LABEL_29:
    FUN_00466a61((int)v12);
    return 3 - (v12[0] < 6u);
  }
  return result;
}

// crt_heap_init @ 0x00466BD6
// CRT heap init (small/large block selection)
int __cdecl sub_466BD6(int a1)
{
  int v1; // eax
  int v2; // eax

  hHeap = HeapCreate(a1 == 0, 0x1000u, 0);
  if ( !hHeap )
    return 0;
  v1 = crt_heap_select();
  crt_heap_mode = v1;
  if ( v1 == 3 )
  {
    v2 = crt_sbh_init(1016);
  }
  else
  {
    if ( v1 != 2 )
      return 1;
    v2 = crt_sbh_create_region();
  }
  if ( !v2 )
  {
    HeapDestroy(hHeap);
    return 0;
  }
  return 1;
}

// FUN_00466ca6 @ 0x00466CA6
// [binja] int32_t* sub_466ca6(void* arg1, int32_t* arg2)
_DWORD *__cdecl sub_466CA6(_DWORD *a1, int a2)
{
  _DWORD *result; // eax
  int *v3; // esi
  unsigned int v4; // edi
  int v5; // ecx
  char *v6; // ebx
  unsigned int v7; // edx
  _BYTE *v8; // ecx
  unsigned int v9; // ebx
  bool v10; // zf
  _BYTE *v11; // ecx
  unsigned int v12; // ebx
  unsigned int v13; // edx
  unsigned int v14; // ebx
  unsigned int v15; // esi
  unsigned int v16; // esi
  _DWORD *v17; // ecx
  LPVOID *v18; // eax
  _DWORD *v19; // [esp+Ch] [ebp-10h]
  int v20; // [esp+10h] [ebp-Ch]
  int v21; // [esp+14h] [ebp-8h]
  int v22; // [esp+18h] [ebp-4h]
  char *v23; // [esp+28h] [ebp+Ch]
  int *v24; // [esp+28h] [ebp+Ch]
  char v25; // [esp+2Bh] [ebp+Fh]

  result = (_DWORD *)a1[4];
  v3 = (int *)(a2 - 4);
  v4 = (unsigned int)(a2 - a1[3]) >> 15;
  v19 = &result[129 * v4 + 81];
  v5 = *(_DWORD *)(a2 - 4) - 1;
  v22 = v5;
  if ( (v5 & 1) == 0 )
  {
    v6 = (char *)v3 + v5;
    v20 = *(int *)((char *)v3 + v5);
    v21 = *(_DWORD *)(a2 - 8);
    v23 = (char *)v3 + v5;
    if ( (v20 & 1) == 0 )
    {
      v7 = (v20 >> 4) - 1;
      if ( v7 > 0x3F )
        v7 = 63;
      if ( *((_DWORD *)v6 + 1) == *((_DWORD *)v6 + 2) )
      {
        if ( v7 >= 0x20 )
        {
          v11 = (char *)result + v7 + 4;
          v12 = ~(0x80000000 >> (v7 - 32));
          result[v4 + 49] &= v12;
          v10 = (*v11)-- == 1;
          if ( v10 )
            a1[1] &= v12;
        }
        else
        {
          v8 = (char *)result + v7 + 4;
          v9 = ~(0x80000000 >> v7);
          result[v4 + 17] &= v9;
          v10 = (*v8)-- == 1;
          if ( v10 )
            *a1 &= v9;
        }
        v5 = v22;
        v6 = v23;
      }
      v5 += v20;
      *(_DWORD *)(*((_DWORD *)v6 + 2) + 4) = *((_DWORD *)v6 + 1);
      v22 = v5;
      *(_DWORD *)(*((_DWORD *)v23 + 1) + 8) = *((_DWORD *)v23 + 2);
    }
    v13 = (v5 >> 4) - 1;
    if ( v13 > 0x3F )
      v13 = 63;
    if ( (v21 & 1) != 0 )
    {
      v14 = (unsigned int)a1;
    }
    else
    {
      v24 = (int *)((char *)v3 - v21);
      v14 = (v21 >> 4) - 1;
      if ( v14 > 0x3F )
        v14 = 63;
      v22 = v21 + v5;
      v13 = ((v21 + v5) >> 4) - 1;
      if ( v13 > 0x3F )
        v13 = 63;
      if ( v14 != v13 )
      {
        if ( v24[1] == v24[2] )
        {
          if ( v14 >= 0x20 )
          {
            v16 = ~(0x80000000 >> (v14 - 32));
            result[v4 + 49] &= v16;
            v10 = (*((_BYTE *)result + v14 + 4))-- == 1;
            if ( v10 )
              a1[1] &= v16;
          }
          else
          {
            v15 = ~(0x80000000 >> v14);
            result[v4 + 17] &= v15;
            v10 = (*((_BYTE *)result + v14 + 4))-- == 1;
            if ( v10 )
              *a1 &= v15;
          }
        }
        *(_DWORD *)(v24[2] + 4) = v24[1];
        *(_DWORD *)(v24[1] + 8) = v24[2];
      }
      v3 = v24;
    }
    if ( (v21 & 1) != 0 || v14 != v13 )
    {
      v17 = &v19[2 * v13];
      v3[1] = v17[1];
      v3[2] = (int)v17;
      v17[1] = v3;
      *(_DWORD *)(v3[1] + 8) = v3;
      if ( v3[1] == v3[2] )
      {
        v25 = *((_BYTE *)result + v13 + 4);
        *((_BYTE *)result + v13 + 4) = v25 + 1;
        if ( v13 >= 0x20 )
        {
          if ( !v25 )
            a1[1] |= 0x80000000 >> (v13 - 32);
          result[v4 + 49] |= 0x80000000 >> (v13 - 32);
        }
        else
        {
          if ( !v25 )
            *a1 |= 0x80000000 >> v13;
          result[v4 + 17] |= 0x80000000 >> v13;
        }
      }
    }
    *v3 = v22;
    *(int *)((char *)v3 + v22 - 4) = v22;
    result += 129 * v4 + 81;
    v10 = (*v19)-- == 1;
    if ( v10 )
    {
      if ( dword_4DA394 )
      {
        VirtualFree((LPVOID)(*((_DWORD *)dword_4DA394 + 3) + (dword_4DA38C << 15)), 0x8000u, 0x4000u);
        *((_DWORD *)dword_4DA394 + 2) |= 0x80000000 >> dword_4DA38C;
        *(_DWORD *)(*((_DWORD *)dword_4DA394 + 4) + 4 * dword_4DA38C + 196) = 0;
        --*(_BYTE *)(*((_DWORD *)dword_4DA394 + 4) + 67);
        v18 = (LPVOID *)dword_4DA394;
        if ( !*(_BYTE *)(*((_DWORD *)dword_4DA394 + 4) + 67) )
        {
          *((_DWORD *)dword_4DA394 + 1) &= ~1u;
          v18 = (LPVOID *)dword_4DA394;
        }
        if ( v18[2] == (LPVOID)-1 )
        {
          VirtualFree(v18[3], 0, 0x8000u);
          HeapFree(hHeap, 0, *((LPVOID *)dword_4DA394 + 4));
          crt_memmove(
            dword_4DA394,
            (char *)dword_4DA394 + 20,
            (size_t)lpMem + 20 * dword_4DA398 - (_DWORD)dword_4DA394 - 20);
          --dword_4DA398;
          if ( a1 > dword_4DA394 )
            a1 -= 5;
          dword_4DA390 = (int)lpMem;
        }
      }
      dword_4DA38C = v4;
      dword_4DA394 = a1;
      return a1;
    }
  }
  return result;
}

// crt_sbh_create_region @ 0x0046777A
// CRT small-block heap region init
int *sub_46777A()
{
  int *v0; // esi
  _DWORD *v1; // eax
  _DWORD *v2; // edi
  int *v3; // eax
  int v4; // ebp
  int v5; // edx

  if ( dword_47BB00 == -1 )
  {
    v0 = (int *)&off_47BAF0;
  }
  else
  {
    v0 = (int *)HeapAlloc(hHeap, 0, 0x2020u);
    if ( !v0 )
      return 0;
  }
  v1 = VirtualAlloc(0, 0x400000u, 0x2000u, 4u);
  v2 = v1;
  if ( !v1 )
  {
LABEL_19:
    if ( v0 != (int *)&off_47BAF0 )
      HeapFree(hHeap, 0, v0);
    return 0;
  }
  if ( !VirtualAlloc(v1, 0x10000u, 0x1000u, 4u) )
  {
    VirtualFree(v2, 0, 0x8000u);
    goto LABEL_19;
  }
  if ( v0 == (int *)&off_47BAF0 )
  {
    if ( !off_47BAF0 )
      off_47BAF0 = &off_47BAF0;
    if ( !off_47BAF4 )
      off_47BAF4 = &off_47BAF0;
  }
  else
  {
    *v0 = (int)&off_47BAF0;
    v0[1] = (int)off_47BAF4;
    off_47BAF4 = v0;
    *(_DWORD *)v0[1] = v0;
  }
  v0[5] = (int)(v2 + 0x100000);
  v3 = v0 + 6;
  v0[3] = (int)(v0 + 38);
  v0[4] = (int)v2;
  v0[2] = (int)(v0 + 6);
  v4 = 0;
  do
  {
    v5 = v4++ >= 16 ? -1 : 240;
    *v3 = v5;
    v3[1] = 241;
    v3 += 2;
  }
  while ( v4 < 1024 );
  memset(v2, 0, 0x10000u);
  while ( (unsigned int)v2 < v0[4] + 0x10000 )
  {
    *((_BYTE *)v2 + 248) = -1;
    *v2 = v2 + 2;
    v2[1] = 240;
    v2 += 1024;
  }
  return v0;
}

// FUN_004678be @ 0x004678BE
// [binja] BOOL sub_4678be(int32_t* arg1)
_UNKNOWN **__cdecl sub_4678BE(LPVOID *lpMem)
{
  _UNKNOWN **result; // eax

  result = (_UNKNOWN **)VirtualFree(lpMem[4], 0, 0x8000u);
  if ( off_47DB10 == (_UNKNOWN **)lpMem )
  {
    result = (_UNKNOWN **)lpMem[1];
    off_47DB10 = result;
  }
  if ( lpMem == (LPVOID *)&off_47BAF0 )
  {
    dword_47BB00 = -1;
  }
  else
  {
    *(_DWORD *)lpMem[1] = *lpMem;
    *((_DWORD *)*lpMem + 1) = lpMem[1];
    return (_UNKNOWN **)HeapFree(hHeap, 0, lpMem);
  }
  return result;
}

// sub_467914 @ 0x00467914
void __cdecl sub_467914(int a1)
{
  _DWORD *v1; // esi
  _DWORD *v2; // edi
  int i; // ebx
  unsigned int v4; // eax
  _DWORD *v5; // ecx
  _DWORD *v6; // eax
  int j; // edx
  int v8; // [esp+Ch] [ebp-4h]

  v1 = off_47BAF4;
  do
  {
    if ( v1[4] != -1 )
    {
      v8 = 0;
      v2 = v1 + 2052;
      for ( i = 4190208; i >= 0; i -= 4096 )
      {
        if ( *v2 == 240 && VirtualFree((LPVOID)(v1[4] + i), 0x1000u, 0x4000u) )
        {
          *v2 = -1;
          --dword_4D9A70;
          v4 = v1[3];
          if ( !v4 || v4 > (unsigned int)v2 )
            v1[3] = v2;
          ++v8;
          if ( !--a1 )
            break;
        }
        v2 -= 2;
      }
      v5 = v1;
      v1 = (_DWORD *)v1[1];
      if ( v8 && v5[6] == -1 )
      {
        v6 = v5 + 8;
        for ( j = 1; j < 1024; ++j )
        {
          if ( *v6 != -1 )
            break;
          v6 += 2;
        }
        if ( j == 1024 )
          FUN_004678be((LPVOID *)v5);
      }
    }
  }
  while ( v1 != off_47BAF4 && a1 > 0 );
}

// crt_sbh_find_block @ 0x004679D6
// CRT: map a pointer to its small-block heap block header
unsigned int __cdecl sub_4679D6(unsigned int a1, _DWORD *a2, unsigned int *a3)
{
  _UNKNOWN **v3; // ecx

  v3 = &off_47BAF0;
  while ( a1 <= (unsigned int)v3[4] || a1 >= (unsigned int)v3[5] )
  {
    v3 = (_UNKNOWN **)*v3;
    if ( v3 == &off_47BAF0 )
      return 0;
  }
  if ( (a1 & 0xF) == 0 && (a1 & 0xFFF) >= 0x100 )
  {
    *a2 = v3;
    *a3 = a1 & 0xFFFFF000;
    return ((int)(a1 - (a1 & 0xFFFFF000) - 256) >> 4) + (a1 & 0xFFFFF000) + 8;
  }
  return 0;
}

// FUN_00467a2d @ 0x00467A2D
// [binja] void* sub_467a2d(void* arg1, int32_t arg2, char* arg3)
void __cdecl sub_467A2D(int a1, int a2, _BYTE *a3)
{
  _DWORD *v3; // eax
  bool v4; // zf

  v3 = (_DWORD *)(a1 + 8 * ((a2 - *(_DWORD *)(a1 + 16)) >> 12) + 24);
  *v3 += (unsigned __int8)*a3;
  *a3 = 0;
  v4 = *v3 == 240;
  v3[1] = 241;
  if ( v4 && ++dword_4D9A70 == 32 )
    sub_467914(16);
}

// crt_sbh_alloc_units @ 0x00467A72
// allocates small-block heap blocks in 16-byte units
_DWORD *__cdecl sub_467A72(unsigned int a1)
{
  char *v1; // esi
  char *v2; // edx
  char *v3; // edi
  char *v4; // eax
  unsigned int v5; // ebx
  _DWORD *result; // eax
  char *v7; // edi
  _DWORD *v8; // ebx
  _DWORD *v9; // eax
  _DWORD *i; // esi
  _DWORD *v11; // ecx
  _DWORD *v12; // eax
  _UNKNOWN **v13; // eax
  bool v14; // cf
  int *v15; // eax
  int v16; // ecx
  unsigned int Val; // [esp+Ch] [ebp-8h]
  char *v18; // [esp+10h] [ebp-4h]
  char *v19; // [esp+10h] [ebp-4h]
  int v20; // [esp+10h] [ebp-4h]

  v1 = (char *)off_47DB10;
  do
  {
    v2 = (char *)*((_DWORD *)v1 + 4);
    if ( v2 == (char *)-1 )
    {
      v5 = a1;
    }
    else
    {
      v3 = (char *)*((_DWORD *)v1 + 2);
      v4 = &v2[4096 * ((v3 - v1 - 24) >> 3)];
      v18 = v4;
      if ( v3 < v1 + 8216 )
      {
        while ( 1 )
        {
          v5 = a1;
          if ( *(_DWORD *)v3 >= (signed int)a1 && *((_DWORD *)v3 + 1) > a1 )
          {
            result = (_DWORD *)sub_467C7A(v4, *(_DWORD *)v3, a1);
            if ( result )
            {
LABEL_21:
              off_47DB10 = (_UNKNOWN **)v1;
              *(_DWORD *)v3 -= v5;
              *((_DWORD *)v1 + 2) = v3;
              return result;
            }
            v4 = v18;
            *((_DWORD *)v3 + 1) = a1;
          }
          v3 += 8;
          v4 += 4096;
          v18 = v4;
          if ( v3 >= v1 + 8216 )
            goto LABEL_11;
        }
      }
      v5 = a1;
LABEL_11:
      v3 = v1 + 24;
      Val = *((_DWORD *)v1 + 2);
      v19 = (char *)*((_DWORD *)v1 + 4);
      if ( (unsigned int)(v1 + 24) < Val )
      {
        do
        {
          if ( *(_DWORD *)v3 >= (signed int)v5 && *((_DWORD *)v3 + 1) > v5 )
          {
            result = (_DWORD *)sub_467C7A(v19, *(_DWORD *)v3, v5);
            if ( result )
              goto LABEL_21;
            *((_DWORD *)v3 + 1) = v5;
          }
          v19 += 4096;
          v3 += 8;
        }
        while ( (unsigned int)v3 < Val );
      }
    }
    v1 = *(char **)v1;
  }
  while ( v1 != (char *)off_47DB10 );
  v7 = (char *)&off_47BAF0;
  while ( *((_DWORD *)v7 + 4) == -1 || !*((_DWORD *)v7 + 3) )
  {
    v7 = *(char **)v7;
    if ( v7 == (char *)&off_47BAF0 )
    {
      v15 = crt_sbh_create_region();
      if ( v15 )
      {
        v16 = v15[4];
        *(_BYTE *)(v16 + 8) = v5;
        off_47DB10 = (_UNKNOWN **)v15;
        *(_DWORD *)v16 = v16 + v5 + 8;
        *(_DWORD *)(v16 + 4) = 240 - v5;
        v15[6] -= (unsigned __int8)v5;
        return (_DWORD *)(v16 + 256);
      }
      return 0;
    }
  }
  v8 = (_DWORD *)*((_DWORD *)v7 + 3);
  v20 = 0;
  v9 = v8;
  for ( i = (_DWORD *)(*((_DWORD *)v7 + 4) + (((char *)v8 - v7 - 24) >> 3 << 12)); *v9 == -1; ++v20 )
  {
    if ( v20 >= 16 )
      break;
    v9 += 2;
  }
  if ( VirtualAlloc(i, v20 << 12, 0x1000u, 4u) != i )
    return 0;
  v11 = v8;
  if ( v20 > 0 )
  {
    v12 = i + 1;
    do
    {
      *((_BYTE *)v12 + 244) = -1;
      *(v12 - 1) = v12 + 1;
      *v12 = 240;
      *v11 = 240;
      v11[1] = 241;
      v12 += 1024;
      v11 += 2;
      --v20;
    }
    while ( v20 );
  }
  off_47DB10 = (_UNKNOWN **)v7;
  v13 = (_UNKNOWN **)(v7 + 8216);
  while ( 1 )
  {
    v14 = v11 < v13;
    if ( v11 >= v13 )
      break;
    if ( *v11 == -1 )
    {
      v14 = v11 < v13;
      break;
    }
    v11 += 2;
  }
  *((_DWORD *)v7 + 3) = v14 ? v11 : 0;
  *((_BYTE *)i + 8) = a1;
  *((_DWORD *)v7 + 2) = v8;
  *v8 -= a1;
  i[1] -= a1;
  *i = (char *)i + a1 + 8;
  return i + 64;
}

// sub_467C7A @ 0x00467C7A
int __cdecl sub_467C7A(int a1, unsigned int a2, unsigned int a3)
{
  unsigned int v4; // esi
  _BYTE *v5; // edi
  unsigned int v6; // ebx
  _BYTE *v7; // eax
  _BYTE *v8; // eax
  _BYTE *v9; // esi
  _BYTE *v10; // ebx
  unsigned int v11; // esi
  _BYTE *v12; // esi
  _BYTE *v13; // ebx
  unsigned int v14; // eax
  _BYTE *v16; // [esp+Ch] [ebp-4h]
  unsigned int v17; // [esp+18h] [ebp+8h]

  v4 = *(_DWORD *)(a1 + 4);
  v5 = *(_BYTE **)a1;
  v6 = a1 + 248;
  v16 = *(_BYTE **)a1;
  v7 = *(_BYTE **)a1;
  v17 = a1 + 248;
  if ( v4 >= a3 )
  {
    *v5 = a3;
    if ( (unsigned int)&v5[a3] >= v6 )
    {
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)a1 = a1 + 8;
    }
    else
    {
      *(_DWORD *)a1 += a3;
      *(_DWORD *)(a1 + 4) -= a3;
    }
    v8 = v5 + 8;
    return 16 * (_DWORD)v8 - 15 * a1;
  }
  v9 = &v5[v4];
  if ( *v9 )
    v7 = v9;
  if ( (unsigned int)&v7[a3] >= v6 )
  {
LABEL_20:
    v12 = (_BYTE *)(a1 + 8);
    while ( v12 < v5 && (unsigned int)&v12[a3] < v17 )
    {
      if ( *v12 )
      {
        v12 += (unsigned __int8)*v12;
      }
      else
      {
        v13 = v12 + 1;
        v14 = 1;
        while ( !*v13 )
        {
          ++v13;
          ++v14;
        }
        if ( v14 >= a3 )
        {
          if ( (unsigned int)&v12[a3] >= v17 )
          {
            *(_DWORD *)(a1 + 4) = 0;
            *(_DWORD *)a1 = a1 + 8;
          }
          else
          {
            *(_DWORD *)a1 = &v12[a3];
            *(_DWORD *)(a1 + 4) = v14 - a3;
          }
          *v12 = a3;
          v8 = v12 + 8;
          return 16 * (_DWORD)v8 - 15 * a1;
        }
        a2 -= v14;
        if ( a2 < a3 )
          return 0;
        v12 = v13;
      }
    }
    return 0;
  }
  while ( *v7 )
  {
    v7 += (unsigned __int8)*v7;
LABEL_19:
    if ( (unsigned int)&v7[a3] >= v17 )
      goto LABEL_20;
  }
  v10 = v7 + 1;
  v11 = 1;
  while ( !*v10 )
  {
    ++v10;
    ++v11;
  }
  if ( v11 < a3 )
  {
    if ( v7 == v16 )
    {
      *(_DWORD *)(a1 + 4) = v11;
    }
    else
    {
      a2 -= v11;
      if ( a2 < a3 )
        return 0;
    }
    v5 = v16;
    v7 = v10;
    goto LABEL_19;
  }
  if ( (unsigned int)&v7[a3] >= v17 )
  {
    *(_DWORD *)(a1 + 4) = 0;
    *(_DWORD *)a1 = a1 + 8;
  }
  else
  {
    *(_DWORD *)a1 = &v7[a3];
    *(_DWORD *)(a1 + 4) = v11 - a3;
  }
  *v7 = a3;
  v8 = v7 + 8;
  return 16 * (_DWORD)v8 - 15 * a1;
}

// FUN_00467d9e @ 0x00467D9E
// [binja] int32_t sub_467d9e(void* arg1, void** arg2, char* arg3, int32_t arg4)
int __cdecl sub_467D9E(int a1, _DWORD *a2, _BYTE *a3, unsigned int a4)
{
  unsigned int v4; // ecx
  _DWORD *v5; // edi
  _BYTE *v6; // esi
  _BYTE *i; // eax
  bool v8; // zf
  int v9; // eax
  int v11; // [esp+Ch] [ebp-4h]

  v4 = (unsigned __int8)*a3;
  v11 = 0;
  v5 = (_DWORD *)(a1 + 8 * (((int)a2 - *(_DWORD *)(a1 + 16)) >> 12) + 24);
  if ( v4 > a4 )
  {
    *a3 = a4;
    *v5 += v4 - a4;
    v5[1] = 241;
    return 1;
  }
  if ( v4 < a4 )
  {
    v6 = &a3[a4];
    if ( &a3[a4] <= (_BYTE *)a2 + 248 )
    {
      for ( i = &a3[v4]; ; ++i )
      {
        v8 = i == v6;
        if ( i >= v6 )
          break;
        if ( *i )
        {
          v8 = i == v6;
          break;
        }
      }
      if ( v8 )
      {
        *a3 = a4;
        if ( (unsigned int)a3 <= *a2 && (unsigned int)v6 > *a2 )
        {
          if ( v6 >= (_BYTE *)a2 + 248 )
          {
            a2[1] = 0;
            *a2 = a2 + 2;
          }
          else
          {
            v9 = 0;
            *a2 = v6;
            if ( !*v6 )
            {
              do
                ++v9;
              while ( !v6[v9] );
            }
            a2[1] = v9;
          }
        }
        *v5 += v4 - a4;
        return 1;
      }
    }
  }
  return v11;
}

// crt_report_runtime_error @ 0x00468DDC
// formats and displays CRT runtime errors
int *__cdecl sub_468DDC(DWORD NumberOfBytesWritten)
{
  int v1; // ecx
  int *result; // eax
  int v3; // esi
  char *v4; // edi
  const char **v5; // esi
  HANDLE StdHandle; // eax
  const char *v7; // [esp-14h] [ebp-1B8h]
  DWORD v8; // [esp-10h] [ebp-1B4h]
  DWORD *p_NumberOfBytesWritten; // [esp-Ch] [ebp-1B0h]
  int v10; // [esp-8h] [ebp-1ACh]
  CHAR Filename[260]; // [esp+0h] [ebp-1A4h] BYREF
  char Destination[160]; // [esp+104h] [ebp-A0h] BYREF
  int savedregs; // [esp+1A4h] [ebp+0h] BYREF

  v1 = 0;
  result = dword_47DB28;
  do
  {
    if ( NumberOfBytesWritten == *result )
      break;
    result += 2;
    ++v1;
  }
  while ( result < (int *)&dbl_47DBB8 );
  v3 = 2 * v1;
  if ( NumberOfBytesWritten == dword_47DB28[2 * v1] )
  {
    result = (int *)dword_4D99CC;
    if ( dword_4D99CC == 1 || !dword_4D99CC && dword_47B184 == 1 )
    {
      v5 = (const char **)&(&off_47DB2C)[v3];
      v10 = 0;
      p_NumberOfBytesWritten = &NumberOfBytesWritten;
      v8 = strlen(*v5);
      v7 = *v5;
      StdHandle = GetStdHandle(0xFFFFFFF4);
      return (int *)WriteFile(StdHandle, v7, v8, &NumberOfBytesWritten, 0);
    }
    else if ( NumberOfBytesWritten != 252 )
    {
      if ( !GetModuleFileNameA(0, Filename, 0x104u) )
        crt_strcpy(Filename, "<program name unknown>");
      v4 = Filename;
      if ( strlen(Filename) + 1 > 0x3C )
      {
        v4 = (char *)&savedregs + strlen(Filename) - 479;
        strncpy(v4, "...", 3u);
      }
      crt_strcpy(Destination, "Runtime Error!\n\nProgram: ");
      crt_strcat(Destination, v4);
      crt_strcat(Destination, "\n\n");
      crt_strcat(Destination, (&off_47DB2C)[v3]);
      return (int *)FUN_0046d5e3(Destination, "Microsoft Visual C++ Runtime Library", 73744);
    }
  }
  return result;
}

// FUN_0046a318 @ 0x0046A318
// [binja] int32_t sub_46a318(int16_t* arg1, int32_t* arg2)
int __cdecl sub_46A318(int a1, int a2)
{
  return FUN_0046a1ac(a1, a2, &unk_47DCE0);
}

// FUN_0046a32e @ 0x0046A32E
// [binja] int32_t sub_46a32e(int16_t* arg1, int32_t* arg2)
int __cdecl sub_46A32E(int a1, int a2)
{
  return FUN_0046a1ac(a1, a2, &unk_47DCF8);
}

// sub_46A344 @ 0x0046A344
int __cdecl sub_46A344(int a1, int a2)
{
  _BYTE v3[12]; // [esp+0h] [ebp-Ch] BYREF

  crt_fp_parse(v3, &a2, a2, 0, 0, 0, 0);
  return FUN_0046a318((int)v3, a1);
}

// sub_46A371 @ 0x0046A371
int __cdecl sub_46A371(int a1, int a2)
{
  _BYTE v3[12]; // [esp+0h] [ebp-Ch] BYREF

  crt_fp_parse(v3, &a2, a2, 0, 0, 0, 0);
  return FUN_0046a32e((int)v3, a1);
}

// sub_46D66C @ 0x0046D66C
int sub_46D66C()
{
  return 0;
}

// sub_46D6B5 @ 0x0046D6B5
LONG (__stdcall *sub_46D6B5())(struct _EXCEPTION_POINTERS *ExceptionInfo)
{
  LONG (__stdcall *result)(struct _EXCEPTION_POINTERS *); // eax

  result = SetUnhandledExceptionFilter(FUN_0046d66f);
  lpfn = result;
  return result;
}

// sub_46D6C6 @ 0x0046D6C6
LPTOP_LEVEL_EXCEPTION_FILTER sub_46D6C6()
{
  return SetUnhandledExceptionFilter(lpfn);
}
