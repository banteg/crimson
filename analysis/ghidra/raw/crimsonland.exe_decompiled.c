/* Decompiled from: crimsonland.exe */

/* console_input_clear @ 00401030 */

/* clears console input buffer */

void console_input_clear(void)

{
  console_input_ready = 0;
  DAT_0047ea54 = 0;
  DAT_0047e448._0_1_ = 0;
  return;
}



/* console_input_buffer @ 00401050 */

/* returns console input buffer pointer */

char * console_input_buffer(void)

{
  return (char *)&DAT_0047e448;
}



/* console_input_poll @ 00401060 */

/* polls text input and updates console buffer */

int console_input_poll(void)

{
  int iVar1;
  IGrim2D *unaff_retaddr;
  
  iVar1 = (*grim_interface_ptr->vtable->grim_get_key_char)(unaff_retaddr);
  if (console_input_enabled != '\0') {
    if ((iVar1 != 0) && (console_input_ready == '\0')) {
      if (iVar1 == 0xd) {
        console_input_ready = '\x01';
        *(undefined1 *)((int)&DAT_0047e448 + DAT_0047ea54) = 0;
        DAT_0047ea54 = DAT_0047ea54 + 1;
        return 0;
      }
      if (iVar1 == 8) {
        if (0 < DAT_0047ea54) {
          DAT_0047ea54 = DAT_0047ea54 + -1;
        }
        *(undefined1 *)((int)&DAT_0047e448 + DAT_0047ea54) = 0;
        return 0;
      }
      *(char *)((int)&DAT_0047e448 + DAT_0047ea54) = (char)iVar1;
      iVar1 = DAT_0047ea54 + 1;
      if (0x3ff < DAT_0047ea54 + 1) {
        iVar1 = DAT_0047ea54;
      }
      DAT_0047ea54 = iVar1;
      *(undefined1 *)((int)&DAT_0047e448 + iVar1) = 0;
    }
    iVar1 = 0;
  }
  return iVar1;
}



/* FUN_004010f0 @ 004010f0 */

/* [binja] int32_t __stdcall sub_4010f0(int32_t arg1, int32_t arg2, int32_t arg3, int32_t arg4) */

int FUN_004010f0(int arg1,int arg2,int arg3,int arg4)

{
  int iVar1;
  
  iVar1 = arg3 + -1;
  if (-1 < iVar1) {
    do {
      iVar1 = (*(code *)arg4)();
      arg3 = arg3 + -1;
    } while (arg3 != 0);
  }
  return iVar1;
}



/* console_cmd_arg_get @ 00401120 */

/* returns console token N (1..argc-1); returns empty string if out of range */

char * __cdecl console_cmd_arg_get(int index)

{
  if (((0 < console_cmd_argc) && (0 < index)) && (index < console_cmd_argc)) {
    return (&console_cmd_name)[index];
  }
  return PTR_DAT_00471158;
}



/* console_cmd_argc_get @ 00401150 */

/* returns current console token count (argc; includes the command token at index 0) */

int console_cmd_argc_get(void)

{
  return console_cmd_argc;
}



/* FUN_00401170 @ 00401170 */

/* [binja] int32_t sub_401170() */

int FUN_00401170(void)

{
  int *piVar1;
  
  piVar1 = console_init(&console_log_queue);
  return (int)piVar1;
}



/* FUN_00401180 @ 00401180 */

/* [binja] int32_t sub_401180() */

int FUN_00401180(void)

{
  int iVar1;
  
  iVar1 = crt_atexit(&LAB_00401190);
  return iVar1;
}



/* console_clear_log @ 004011a0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* clears console log history and resets scroll state (clear command handler) */

void console_clear_log(void)

{
  undefined4 *ptr;
  
  ptr = console_log_head;
  if (console_log_head != (undefined4 *)0x0) {
    if ((void *)*console_log_head != (void *)0x0) {
      crt_free((void *)*console_log_head);
    }
    *ptr = 0;
    if ((void *)ptr[1] != (void *)0x0) {
      console_log_node_free((void *)ptr[1],'\x01');
    }
    ptr[1] = 0;
    crt_free(ptr);
  }
  console_log_head = (undefined4 *)0x0;
  _DAT_0047eec0 = 0;
  _DAT_0047eec4 = 0;
  return;
}



/* console_log_node_free @ 004011f0 */

/* frees a console log node (text + next chain) and optionally frees the node */

void __thiscall console_log_node_free(void *this,char free_self)

{
  if (*(void **)this != (void *)0x0) {
    crt_free(*(void **)this);
  }
  *(undefined4 *)this = 0;
  if (*(void **)((int)this + 4) != (void *)0x0) {
    console_log_node_free(*(void **)((int)this + 4),'\x01');
  }
  *(undefined4 *)((int)this + 4) = 0;
  if ((free_self & 1U) != 0) {
    crt_free(this);
  }
  return;
}



/* console_cmd_quit @ 00401240 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* sets the quit/exit flag (quit command handler) */

void console_cmd_quit(void)

{
  DAT_0047ea50 = 1;
  return;
}



/* console_cmd_exec @ 00401250 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* executes a script file via console_exec_line (exec command handler) */

void console_cmd_exec(void)

{
  FILE *fp;
  char *pcVar1;
  
  if (console_cmd_argc != 2) {
    console_printf(&console_log_queue,s_exec_<script>_0047118c);
    return;
  }
  fp = crt_fopen(console_cmd_arg1,&DAT_00471160);
  if (fp != (FILE *)0x0) {
    console_printf(&console_log_queue,s_Executing___s__00471164,console_cmd_arg1);
    pcVar1 = crt_fgets(&DAT_0047e848,0x1ff,fp);
    while (pcVar1 != (char *)0x0) {
      pcVar1 = _strchr(&DAT_0047e848,10);
      if (pcVar1 != (char *)0x0) {
        *pcVar1 = '\0';
      }
      DAT_0047ea47 = 0;
      if ((((DAT_0047e848 != '/') && (DAT_0047e849 != '/')) && (DAT_0047e848 != '\n')) &&
         ((DAT_0047e848 != '\0' && (DAT_0047e848 != '#')))) {
        console_exec_line(&console_log_queue,&DAT_0047e848);
      }
      pcVar1 = crt_fgets(&DAT_0047e848,0x1ff,fp);
    }
    crt_fclose(fp);
    return;
  }
  console_printf(&console_log_queue,s_Cannot_open_file___s__00471174,console_cmd_arg1);
  return;
}



/* console_cmd_extend @ 00401340 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* extends console height (extendconsole command handler) */

void console_cmd_extend(void)

{
  longlong lVar1;
  
  lVar1 = __ftol();
  _console_height_px = (int)lVar1;
  return;
}



/* console_cmd_minimize @ 00401360 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* minimizes console height (minimizeconsole command handler) */

void console_cmd_minimize(void)

{
  _console_height_px = 300;
  return;
}



/* console_cmdlist @ 00401370 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* prints registered command names and a count (cmdlist command handler) */

void console_cmdlist(void)

{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = 0;
  for (puVar1 = console_command_list_head; puVar1 != (undefined4 *)0x0;
      puVar1 = (undefined4 *)puVar1[1]) {
    console_printf(&console_log_queue,&DAT_004711ac,*puVar1);
    iVar2 = iVar2 + 1;
  }
  console_printf(&console_log_queue,s__i_commands_0047119c,iVar2);
  return;
}



/* console_vars @ 004013c0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* prints registered cvar names and a count (vars command handler) */

void console_vars(void)

{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = 0;
  for (puVar1 = console_log_queue; puVar1 != (undefined4 *)0x0; puVar1 = (undefined4 *)puVar1[1]) {
    console_printf(&console_log_queue,&DAT_004711ac,*puVar1);
    iVar2 = iVar2 + 1;
  }
  console_printf(&console_log_queue,s__i_variables_004711b0,iVar2);
  return;
}



/* console_echo @ 00401410 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* toggles echo on/off or prints args back into the console (echo command handler) */

void console_echo(void)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  char *pcVar4;
  byte *pbVar5;
  int index;
  bool bVar6;
  
  iVar2 = console_cmd_argc_get();
  if (iVar2 == 2) {
    pbVar3 = (byte *)console_cmd_arg_get(1);
    pbVar5 = &DAT_004711cc;
    do {
      bVar1 = *pbVar5;
      bVar6 = bVar1 < *pbVar3;
      if (bVar1 != *pbVar3) {
LAB_00401455:
        iVar2 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
        goto LAB_0040145a;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar5[1];
      bVar6 = bVar1 < pbVar3[1];
      if (bVar1 != pbVar3[1]) goto LAB_00401455;
      pbVar5 = pbVar5 + 2;
      pbVar3 = pbVar3 + 2;
    } while (bVar1 != 0);
    iVar2 = 0;
LAB_0040145a:
    if (iVar2 == 0) {
      console_echo_enabled = 0;
      return;
    }
  }
  iVar2 = console_cmd_argc_get();
  if (iVar2 == 2) {
    pbVar3 = (byte *)console_cmd_arg_get(1);
    pbVar5 = &DAT_004711c8;
    do {
      bVar1 = *pbVar5;
      bVar6 = bVar1 < *pbVar3;
      if (bVar1 != *pbVar3) {
LAB_004014a9:
        iVar2 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
        goto LAB_004014ae;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar5[1];
      bVar6 = bVar1 < pbVar3[1];
      if (bVar1 != pbVar3[1]) goto LAB_004014a9;
      pbVar5 = pbVar5 + 2;
      pbVar3 = pbVar3 + 2;
    } while (bVar1 != 0);
    iVar2 = 0;
LAB_004014ae:
    if (iVar2 == 0) {
      console_echo_enabled = 1;
      return;
    }
  }
  index = 1;
  iVar2 = console_cmd_argc_get();
  if (1 < iVar2) {
    do {
      pcVar4 = console_cmd_arg_get(index);
      console_printf(&console_log_queue,&DAT_004711c4,pcVar4);
      index = index + 1;
      iVar2 = console_cmd_argc_get();
    } while (index < iVar2);
  }
  console_printf(&console_log_queue,&DAT_004711c0);
  return;
}



/* console_cmd_set @ 00401510 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* sets a cvar from tokens (set command handler) */

void console_cmd_set(void)

{
  undefined4 *puVar1;
  
  if (console_cmd_argc != 3) {
    console_printf(&console_log_queue,s_set_<var>_<value>_004711e4);
    return;
  }
  puVar1 = console_register_cvar(&console_log_queue,console_cmd_arg1,console_cmd_arg2);
  console_printf(&console_log_queue,s___s__set_to___s__004711d0,*puVar1,puVar1[4]);
  return;
}



/* console_init @ 00401560 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* initializes the console state, registers core commands/cvars, and seeds prompt/version strings */

int * __fastcall console_init(int *console_state)

{
  undefined4 *puVar1;
  char *pcVar2;
  
  *(undefined1 *)(console_state + 3) = 1;
  console_state[6] = 300;
  console_state[7] = -0x3c6a0000;
  console_state[9] = 0;
  console_state[2] = 0;
  puVar1 = operator_new(0x24);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1[6] = 0;
    puVar1[7] = 0;
    puVar1[8] = 0;
    pcVar2 = strdup_malloc(s_version_00471264);
    *puVar1 = pcVar2;
    puVar1[1] = 0;
    puVar1[2] = 0;
    puVar1[3] = 0;
    puVar1[4] = 0;
    puVar1[5] = 0;
  }
  *console_state = (int)puVar1;
  puVar1[3] = 0x3f800000;
  pcVar2 = strdup_malloc(&DAT_00471260);
  *(char **)(*console_state + 0x10) = pcVar2;
  *(undefined4 *)(*console_state + 0x14) = 1;
  DAT_0047f4d0 = console_register_cvar(console_state,s_con_monoFont_0047124c,&DAT_0047125c);
  DAT_0047eaa0 = 0;
  _DAT_0047eaa4 = 0;
  _DAT_0047eaa8 = 0;
  _DAT_0047eaac = 0;
  console_cmd_argc = 0;
  console_register_command(console_state,console_cmd_cmdlist,console_cmdlist);
  console_register_command(console_state,&console_cmd_vars,console_vars);
  console_register_command(console_state,&console_cmd_echo,console_echo);
  console_register_command(console_state,&console_cmd_set,console_cmd_set);
  console_register_command(console_state,&console_cmd_quit,console_cmd_quit);
  console_register_command(console_state,console_cmd_clear,console_clear_log);
  console_register_command(console_state,console_cmd_extend,console_cmd_extend);
  console_register_command(console_state,console_cmd_minimize,console_cmd_minimize);
  console_register_command(console_state,&console_cmd_exec,console_cmd_exec);
  puVar1 = operator_new(8);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1[1] = 0;
    *puVar1 = 0;
  }
  console_state[4] = (int)puVar1;
  pcVar2 = strdup_malloc(&DAT_0047f4d8);
  *(char **)console_state[4] = pcVar2;
  console_state[5] = 0;
  return console_state;
}



/* FUN_004016e0 @ 004016e0 */

/* [binja] void __fastcall sub_4016e0(int32_t* arg1) */

void __fastcall FUN_004016e0(int *arg1)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)arg1[2];
  if (puVar1 != (undefined4 *)0x0) {
    if ((void *)*puVar1 != (void *)0x0) {
      crt_free((void *)*puVar1);
    }
    *puVar1 = 0;
    if ((void *)puVar1[1] != (void *)0x0) {
      console_log_node_free((void *)puVar1[1],'\x01');
    }
    puVar1[1] = 0;
    crt_free(puVar1);
  }
  puVar1 = (undefined4 *)*arg1;
  arg1[2] = 0;
  if (puVar1 != (undefined4 *)0x0) {
    if ((void *)*puVar1 != (void *)0x0) {
      crt_free((void *)*puVar1);
    }
    *puVar1 = 0;
    crt_free(puVar1);
  }
  puVar1 = (undefined4 *)arg1[1];
  *arg1 = 0;
  if (puVar1 != (undefined4 *)0x0) {
    if ((void *)*puVar1 != (void *)0x0) {
      crt_free((void *)*puVar1);
    }
    *puVar1 = 0;
    crt_free(puVar1);
  }
  puVar1 = (undefined4 *)arg1[4];
  arg1[1] = 0;
  if (puVar1 != (undefined4 *)0x0) {
    if ((void *)*puVar1 != (void *)0x0) {
      crt_free((void *)*puVar1);
    }
    *puVar1 = 0;
    if ((void *)puVar1[1] != (void *)0x0) {
      console_log_node_free((void *)puVar1[1],'\x01');
    }
    puVar1[1] = 0;
    crt_free(puVar1);
  }
  arg1[4] = 0;
  return;
}



/* console_push_line @ 004017a0 */

/* pushes line into console queue */

char __thiscall console_push_line(void *this,char *line)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 *puVar4;
  char *pcVar5;
  uint uVar6;
  
  uVar6 = (uint)*(byte *)((int)this + 0xc);
  if (*(byte *)((int)this + 0xc) != 0) {
    if (*(int *)((int)this + 0x20) == 0x1000) {
      iVar1 = *(int *)(*(int *)((int)this + 8) + 4);
      iVar2 = *(int *)(iVar1 + 4);
      iVar3 = *(int *)((int)this + 8);
      while (iVar2 != 0) {
        iVar2 = *(int *)(*(int *)(iVar1 + 4) + 4);
        iVar3 = iVar1;
        iVar1 = *(int *)(iVar1 + 4);
      }
      puVar4 = *(undefined4 **)(iVar3 + 4);
      if (puVar4 != (undefined4 *)0x0) {
        if ((void *)*puVar4 != (void *)0x0) {
          crt_free((void *)*puVar4);
        }
        *puVar4 = 0;
        if ((void *)puVar4[1] != (void *)0x0) {
          console_log_node_free((void *)puVar4[1],'\x01');
        }
        puVar4[1] = 0;
        crt_free(puVar4);
      }
      *(undefined4 *)(iVar3 + 4) = 0;
      *(int *)((int)this + 0x20) = *(int *)((int)this + 0x20) + -1;
    }
    puVar4 = operator_new(8);
    if (puVar4 == (undefined4 *)0x0) {
      puVar4 = (undefined4 *)0x0;
    }
    else {
      puVar4[1] = 0;
      *puVar4 = 0;
    }
    pcVar5 = strdup_malloc(line);
    *puVar4 = pcVar5;
    puVar4[1] = *(undefined4 *)((int)this + 8);
    uVar6 = *(int *)((int)this + 0x20) + 1;
    *(undefined4 **)((int)this + 8) = puVar4;
    *(uint *)((int)this + 0x20) = uVar6;
  }
  return (char)uVar6;
}



/* console_printf @ 00401870 */

/* formats then pushes line */

char __cdecl console_printf(void *console_state,char *fmt,...)

{
  char cVar1;
  
  cVar1 = '\0';
  if (*(char *)((int)console_state + 0xc) != '\0') {
    crt_vsprintf(&DAT_0047f2cc,fmt,&stack0x0000000c);
    cVar1 = console_push_line(console_state,&DAT_0047f2cc);
  }
  return cVar1;
}



/* console_set_open @ 004018b0 */

/* sets console_open_flag (console_state+0x28) and console_input_enabled (0x0047f4d4); flushes input
   via Grim2D vtable +0x4c */

void __thiscall console_set_open(void *this,char open)

{
  IGrim2D *unaff_retaddr;
  
  *(char *)((int)this + 0x28) = open;
  console_input_enabled = open;
  (*grim_interface_ptr->vtable->grim_flush_input)(unaff_retaddr);
  return;
}



/* console_history_apply @ 004018d0 */

/* loads a history entry into the input buffer (used by Up/Down navigation) */

void __fastcall console_history_apply(int console_state)

{
  int iVar1;
  char cVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  char *pcVar8;
  char *pcVar9;
  
  iVar7 = 0;
  iVar1 = *(int *)(console_state + 0x14) + -1;
  puVar3 = *(undefined4 **)(console_state + 0x10);
  puVar4 = *(undefined4 **)(console_state + 0x10);
  if (0 < iVar1) {
    do {
      puVar4 = (undefined4 *)puVar3[1];
      if (puVar4 == (undefined4 *)0x0) {
        *(int *)(console_state + 0x14) = iVar7;
        puVar4 = puVar3;
        break;
      }
      iVar7 = iVar7 + 1;
      puVar3 = puVar4;
    } while (iVar7 < iVar1);
  }
  uVar5 = 0xffffffff;
  pcVar8 = (char *)*puVar4;
  do {
    pcVar9 = pcVar8;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar9 = pcVar8 + 1;
    cVar2 = *pcVar8;
    pcVar8 = pcVar9;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  pcVar8 = pcVar9 + -uVar5;
  pcVar9 = (char *)&DAT_0047e448;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar8;
    pcVar8 = pcVar8 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar9 = *pcVar8;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar5 = 0xffffffff;
  pcVar8 = (char *)&DAT_0047e448;
  do {
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    cVar2 = *pcVar8;
    pcVar8 = pcVar8 + 1;
  } while (cVar2 != '\0');
  DAT_0047ea54 = ~uVar5 - 1;
  console_input_ready = 0;
  return;
}



/* console_exec_line @ 00401940 */

/* executes a console command or cvar assignment from a line */

char __thiscall console_exec_line(void *this,char *line)

{
  char cVar1;
  undefined4 *puVar2;
  void *pvVar3;
  char *pcVar4;
  double dVar5;
  char *str;
  
  console_tokenize_line(line);
  if (console_cmd_argc != 0) {
    puVar2 = console_cvar_find(this,console_cmd_name);
    pvVar3 = console_command_find(this,console_cmd_name);
    if (puVar2 == (undefined4 *)0x0) {
      if (pvVar3 == (void *)0x0) {
        cVar1 = console_printf(this,s_Unknown_command___s__0047126c);
        return cVar1;
      }
      cVar1 = (**(code **)((int)pvVar3 + 8))();
      return cVar1;
    }
    if (console_cmd_argc == 2) {
      if ((void *)puVar2[4] != (void *)0x0) {
        crt_free((void *)puVar2[4]);
      }
      puVar2[4] = 0;
      str = console_cmd_arg1;
      pcVar4 = strdup_malloc(console_cmd_arg1);
      puVar2[4] = pcVar4;
      dVar5 = crt_atof_l(console_cmd_arg1,console_cmd_arg1,str);
      puVar2[3] = (float)dVar5;
      if (*(char *)((int)this + 0xc) != '\0') {
        cVar1 = console_printf(this,s___s__set_to___s____ff__00471298,*puVar2,puVar2[4],
                               (double)(float)dVar5);
        return cVar1;
      }
    }
    else if (*(char *)((int)this + 0xc) != '\0') {
      cVar1 = console_printf(this,s___s__is___s____ff__00471284,*puVar2,puVar2[4],
                             (double)(float)puVar2[3]);
      return cVar1;
    }
  }
  return '\0';
}



/* console_update @ 00401a40 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* console update loop: input polling, history, autocomplete, and key handling */

void __fastcall console_update(int console_state)

{
  char cVar1;
  byte bVar2;
  int iVar3;
  char *pcVar4;
  byte *pbVar5;
  undefined4 *puVar6;
  uint uVar7;
  uint uVar8;
  byte *pbVar9;
  uint unaff_EBX;
  uint unaff_EBP;
  uint unaff_ESI;
  char *pcVar10;
  uint unaff_EDI;
  char *pcVar11;
  bool bVar12;
  float10 fVar13;
  uint unaff_retaddr;
  uint in_stack_00000004;
  uint in_stack_00000008;
  uint in_stack_0000000c;
  uint in_stack_00000010;
  uint in_stack_00000014;
  uint in_stack_00000018;
  uint in_stack_0000001c;
  uint in_stack_00000020;
  uint in_stack_00000024;
  
  if (*(char *)(console_state + 0x28) == '\0') {
    _DAT_0047115c = _DAT_0047ea48 * 3.5 + _DAT_0047115c;
    if (1.0 < _DAT_0047115c) {
      _DAT_0047115c = 1.0;
    }
    fVar13 = (float10)fsin(((float10)1.0 - (float10)_DAT_0047115c) * (float10)1.5707964);
    *(float *)(console_state + 0x1c) =
         (float)(fVar13 * (float10)*(int *)(console_state + 0x18) -
                (float10)*(int *)(console_state + 0x18));
    return;
  }
  _DAT_0047115c = _DAT_0047115c - _DAT_0047ea48 * 3.5;
  if (_DAT_0047115c < 0.0) {
    _DAT_0047115c = 0.0;
  }
  fVar13 = (float10)fsin(((float10)1.0 - (float10)_DAT_0047115c) * (float10)1.5707964);
  *(float *)(console_state + 0x1c) =
       (float)(fVar13 * (float10)*(int *)(console_state + 0x18) -
              (float10)*(int *)(console_state + 0x18));
  console_input_poll();
  iVar3 = (*grim_interface_ptr->vtable->grim_is_key_down)((IGrim2D *)0x1d,unaff_EBP);
  if ((char)iVar3 == '\0') {
    iVar3 = (*grim_interface_ptr->vtable->grim_is_key_down)((IGrim2D *)0x9d,unaff_EBX);
    if ((char)iVar3 != '\0') goto LAB_00401ac4;
LAB_00401add:
    iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xc8,unaff_retaddr);
    if ((char)iVar3 != '\0') {
      *(int *)(console_state + 0x14) = *(int *)(console_state + 0x14) + 1;
      console_history_apply(console_state);
    }
  }
  else {
LAB_00401ac4:
    iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xc8,unaff_retaddr);
    if ((char)iVar3 == '\0') goto LAB_00401add;
    *(int *)(console_state + 0x24) = *(int *)(console_state + 0x24) + 1;
  }
  iVar3 = (*grim_interface_ptr->vtable->grim_is_key_down)((IGrim2D *)0x1d,in_stack_00000004);
  if ((char)iVar3 == '\0') {
    iVar3 = (*grim_interface_ptr->vtable->grim_is_key_down)((IGrim2D *)0x9d,in_stack_00000008);
    if ((char)iVar3 != '\0') goto LAB_00401b24;
LAB_00401b3d:
    iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xd0,in_stack_0000000c);
    if ((char)iVar3 != '\0') {
      iVar3 = *(int *)(console_state + 0x14) + -1;
      *(int *)(console_state + 0x14) = iVar3;
      if (iVar3 < 0) {
        *(undefined4 *)(console_state + 0x14) = 0;
      }
      console_history_apply(console_state);
    }
  }
  else {
LAB_00401b24:
    iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xd0,in_stack_0000000c);
    if ((char)iVar3 == '\0') goto LAB_00401b3d;
    *(int *)(console_state + 0x24) = *(int *)(console_state + 0x24) + -1;
  }
  iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xcb,in_stack_00000010);
  if (((char)iVar3 != '\0') && (DAT_0047ea54 = DAT_0047ea54 + -1, DAT_0047ea54 < 0)) {
    DAT_0047ea54 = 0;
  }
  iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xcd,unaff_EDI);
  if ((char)iVar3 != '\0') {
    uVar7 = 0xffffffff;
    DAT_0047ea54 = DAT_0047ea54 + 1;
    pcVar4 = (char *)&DAT_0047e448;
    do {
      if (uVar7 == 0) break;
      uVar7 = uVar7 - 1;
      cVar1 = *pcVar4;
      pcVar4 = pcVar4 + 1;
    } while (cVar1 != '\0');
    if ((int)(~uVar7 - 1) < DAT_0047ea54) {
      uVar7 = 0xffffffff;
      pcVar4 = (char *)&DAT_0047e448;
      do {
        if (uVar7 == 0) break;
        uVar7 = uVar7 - 1;
        cVar1 = *pcVar4;
        pcVar4 = pcVar4 + 1;
      } while (cVar1 != '\0');
      DAT_0047ea54 = ~uVar7 - 1;
    }
  }
  iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xc9,unaff_ESI);
  if ((char)iVar3 != '\0') {
    *(int *)(console_state + 0x24) = *(int *)(console_state + 0x24) + 2;
  }
  iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xd1,in_stack_00000014);
  if (((char)iVar3 != '\0') &&
     (iVar3 = *(int *)(console_state + 0x24) + -2, *(int *)(console_state + 0x24) = iVar3, iVar3 < 0
     )) {
    *(undefined4 *)(console_state + 0x24) = 0;
  }
  iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xc7,in_stack_00000018);
  if ((char)iVar3 != '\0') {
    *(int *)(console_state + 0x24) = *(int *)(console_state + 0x24) + 0x14;
  }
  iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xcf,in_stack_0000001c);
  if ((char)iVar3 != '\0') {
    *(undefined4 *)(console_state + 0x24) = 0;
  }
  iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xf,in_stack_00000020);
  if ((char)iVar3 != '\0') {
    pcVar4 = console_input_buffer();
    console_tokenize_line(pcVar4);
    pcVar4 = console_input_buffer();
    pcVar4 = console_cvar_autocomplete((void *)console_state,pcVar4);
    if (pcVar4 == (char *)0x0) {
      pcVar4 = console_input_buffer();
      pcVar4 = console_command_autocomplete((void *)console_state,pcVar4);
      if (pcVar4 == (char *)0x0) goto LAB_00401cb5;
    }
    uVar7 = 0xffffffff;
    pcVar10 = pcVar4;
    do {
      pcVar11 = pcVar10;
      if (uVar7 == 0) break;
      uVar7 = uVar7 - 1;
      pcVar11 = pcVar10 + 1;
      cVar1 = *pcVar10;
      pcVar10 = pcVar11;
    } while (cVar1 != '\0');
    uVar7 = ~uVar7;
    pcVar10 = pcVar11 + -uVar7;
    pcVar11 = (char *)&DAT_0047e448;
    for (uVar8 = uVar7 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
      *(undefined4 *)pcVar11 = *(undefined4 *)pcVar10;
      pcVar10 = pcVar10 + 4;
      pcVar11 = pcVar11 + 4;
    }
    for (uVar7 = uVar7 & 3; uVar7 != 0; uVar7 = uVar7 - 1) {
      *pcVar11 = *pcVar10;
      pcVar10 = pcVar10 + 1;
      pcVar11 = pcVar11 + 1;
    }
    uVar7 = 0xffffffff;
    do {
      if (uVar7 == 0) break;
      uVar7 = uVar7 - 1;
      cVar1 = *pcVar4;
      pcVar4 = pcVar4 + 1;
    } while (cVar1 != '\0');
    DAT_0047ea54 = ~uVar7 - 1;
  }
LAB_00401cb5:
  if (console_input_ready == '\0') {
    console_input_buffer();
    (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1c,in_stack_00000024);
    return;
  }
  pbVar5 = (byte *)console_input_buffer();
  pbVar9 = (byte *)**(undefined4 **)(console_state + 0x10);
  do {
    bVar2 = *pbVar9;
    bVar12 = bVar2 < *pbVar5;
    if (bVar2 != *pbVar5) {
LAB_00401cf1:
      iVar3 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
      goto LAB_00401cf6;
    }
    if (bVar2 == 0) break;
    bVar2 = pbVar9[1];
    bVar12 = bVar2 < pbVar5[1];
    if (bVar2 != pbVar5[1]) goto LAB_00401cf1;
    pbVar9 = pbVar9 + 2;
    pbVar5 = pbVar5 + 2;
  } while (bVar2 != 0);
  iVar3 = 0;
LAB_00401cf6:
  if (iVar3 != 0) {
    puVar6 = operator_new(8);
    if (puVar6 == (undefined4 *)0x0) {
      puVar6 = (undefined4 *)0x0;
    }
    else {
      puVar6[1] = 0;
      *puVar6 = 0;
    }
    pcVar4 = console_input_buffer();
    pcVar4 = strdup_malloc(pcVar4);
    *puVar6 = pcVar4;
    puVar6[1] = *(undefined4 *)(console_state + 0x10);
    *(undefined4 **)(console_state + 0x10) = puVar6;
  }
  *(undefined4 *)(console_state + 0x14) = 0;
  console_input_buffer();
  console_printf(&console_log_queue,s_>__s_004712b0);
  pcVar4 = console_input_buffer();
  console_exec_line((void *)console_state,pcVar4);
  console_input_clear();
  (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1c,in_stack_00000024);
  return;
}



/* FUN_00401dd0 @ 00401dd0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t __fastcall sub_401dd0(void* arg1) */

int __fastcall FUN_00401dd0(void *arg1)

{
  IGrim2D_vtbl *pIVar1;
  char *pcVar2;
  int iVar3;
  int iVar4;
  IGrim2D *self;
  IGrim2D *unaff_EBX;
  int iVar5;
  float unaff_EBP;
  float unaff_ESI;
  float unaff_EDI;
  float *pfVar6;
  float10 fVar7;
  float10 extraout_ST0;
  float fStack00000004;
  float fStack00000008;
  uint value;
  float fVar8;
  char *pcVar9;
  float fVar10;
  char *pcVar11;
  float in_stack_ffffffec;
  IGrim2D IVar12;
  IGrim2D text;
  undefined4 uStack_4;
  
  iVar4 = *(int *)((int)arg1 + 0x18);
  pcVar2 = (char *)-iVar4;
  fVar10 = (float)(int)pcVar2;
  fVar8 = *(float *)((int)arg1 + 0x1c);
  iVar3 = CONCAT22((short)((uint)pcVar2 >> 0x10),
                   (ushort)(fVar10 < fVar8) << 8 | (ushort)(NAN(fVar10) || NAN(fVar8)) << 10 |
                   (ushort)(fVar10 == fVar8) << 0xe);
  if (fVar10 < fVar8) {
    pfVar6 = *(float **)((int)arg1 + 8);
    iVar3 = ((int)(iVar4 + (iVar4 >> 0x1f & 0xfU)) >> 4) + -2;
    if (*(int *)((int)arg1 + 0x20) <= iVar3) {
      iVar3 = *(int *)((int)arg1 + 0x20);
    }
    pcVar11 = (char *)(((float)iVar4 + *(float *)((int)arg1 + 0x1c)) / (float)iVar4);
    if ((float)pcVar11 <= 1.0) {
      if ((float)pcVar11 < 0.0) {
        pcVar11 = (char *)0x0;
      }
    }
    else {
      pcVar11 = (char *)0x3f800000;
    }
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f19999a,0.6,0.6,(float)pcVar11,unaff_EDI);
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,unaff_ESI);
    uStack_4 = 0x3e400000;
    (*grim_interface_ptr->vtable->grim_draw_rect_filled)
              ((IGrim2D *)&stack0xfffffff0,(float *)screen_width_f,(float)*(int *)((int)arg1 + 0x18)
               ,(float)&stack0xfffffff8);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3dcccccd,0.6,1.0,
               ((float)*(int *)((int)arg1 + 0x18) + *(float *)((int)arg1 + 0x1c)) /
               (float)*(int *)((int)arg1 + 0x18),unaff_EBP);
    IVar12.vtable =
         (IGrim2D_vtbl *)((float)*(int *)((int)arg1 + 0x18) + *(float *)((int)arg1 + 0x1c));
    pcVar9 = (char *)0x40800000;
    uStack_4 = 0x3e600000;
    fStack00000004 = 0.3671875;
    text.vtable = (IGrim2D_vtbl *)0x0;
    fStack00000008 = (float)IVar12.vtable / (float)*(int *)((int)arg1 + 0x18);
    (*grim_interface_ptr->vtable->grim_draw_rect_filled)
              ((IGrim2D *)&stack0xfffffff4,(float *)screen_width_f,4.0,(float)&uStack_4);
    fVar10 = 5.888775e-39;
    (*grim_interface_ptr->vtable->grim_end_batch)(unaff_EBX);
    fVar8 = 2.8026e-45;
    value = 0x15;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,(uint)pcVar9);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,value);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,
               (((float)*(int *)((int)arg1 + 0x18) + *(float *)((int)arg1 + 0x1c)) /
               (float)*(int *)((int)arg1 + 0x18)) * 0.3,fVar8);
    (*grim_interface_ptr->vtable->grim_draw_text_small)
              ((IGrim2D *)((float)screen_width_f - 210.0),
               ((float)*(int *)((int)arg1 + 0x18) + *(float *)((int)arg1 + 0x1c)) - 18.0,
               6.527052e-39,pcVar9);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,
               (((float)*(int *)((int)arg1 + 0x18) + *(float *)((int)arg1 + 0x1c)) /
               (float)*(int *)((int)arg1 + 0x18)) * 0.5,fVar10);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,
               ((float)*(int *)((int)arg1 + 0x18) + *(float *)((int)arg1 + 0x1c)) /
               (float)*(int *)((int)arg1 + 0x18),(float)unaff_EBX);
    if (*(float *)(DAT_0047f4d0 + 0xc) == 0.0) {
      pIVar1 = grim_interface_ptr->vtable;
      pcVar2 = console_input_buffer();
      pcVar9 = (char *)((iVar3 + 1) * 0x10);
      (*pIVar1->grim_draw_text_small_fmt)
                (grim_interface_ptr,10.0,(float)(int)pcVar9 + *(float *)((int)arg1 + 0x1c),
                 &DAT_004712bc,pcVar2);
    }
    else {
      pcVar9 = (char *)((iVar3 + 1) * 0x10);
      text.vtable = (IGrim2D_vtbl *)(float)(int)pcVar9;
      (*grim_interface_ptr->vtable->grim_draw_text_mono)
                ((IGrim2D *)0x41200000,(float)text.vtable + *(float *)((int)arg1 + 0x1c),
                 6.527046e-39,pcVar11);
      pIVar1 = grim_interface_ptr->vtable;
      pcVar11 = console_input_buffer();
      (*pIVar1->grim_draw_text_mono)
                ((IGrim2D *)0x41d00000,(float)pcVar9 + *(float *)((int)arg1 + 0x1c),(float)pcVar11,
                 pcVar2);
    }
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f19999a,0.6,0.7,
               ((float)*(int *)((int)arg1 + 0x18) + *(float *)((int)arg1 + 0x1c)) /
               (float)*(int *)((int)arg1 + 0x18),in_stack_ffffffec);
    for (iVar4 = *(int *)((int)arg1 + 0x24); 0 < iVar4; iVar4 = iVar4 + -1) {
      if (pfVar6 == (float *)0x0) goto LAB_004021ca;
      pfVar6 = (float *)pfVar6[1];
    }
    if (pfVar6 != (float *)0x0) {
      iVar5 = iVar3 << 4;
      iVar4 = iVar5;
      do {
        if (iVar3 < 0) break;
        fVar8 = (float)iVar5 + *(float *)((int)arg1 + 0x1c);
        if (*(float *)(DAT_0047f4d0 + 0xc) == 0.0) {
          (*grim_interface_ptr->vtable->grim_draw_text_small)
                    ((IGrim2D *)0x41200000,fVar8,*pfVar6,(char *)IVar12.vtable);
        }
        else {
          (*grim_interface_ptr->vtable->grim_draw_text_mono)
                    ((IGrim2D *)0x41200000,fVar8,*pfVar6,(char *)IVar12.vtable);
        }
        pfVar6 = (float *)pfVar6[1];
        iVar3 = iVar3 + -1;
        iVar4 = iVar4 + -0x10;
        fStack00000004 = (float)iVar4;
      } while (pfVar6 != (float *)0x0);
    }
LAB_004021ca:
    iVar4 = *(int *)((int)arg1 + 0x18);
    iVar5 = ((int)(iVar4 + (iVar4 >> 0x1f & 0xfU)) >> 4) + -2;
    iVar3 = *(int *)((int)arg1 + 0x20);
    if (iVar5 < *(int *)((int)arg1 + 0x20)) {
      iVar3 = iVar5;
    }
    fVar7 = (float10)fsin((float10)_DAT_0047ea4c * (float10)3.0);
    fStack00000004 = (float)fVar7;
    crt_ci_pow();
    fVar7 = extraout_ST0;
    if (extraout_ST0 < (float10)0.2) {
      fVar7 = (float10)0.2;
    }
    fVar8 = (float)((((float10)iVar4 + (float10)*(float *)((int)arg1 + 0x1c)) / (float10)iVar4) *
                   fVar7);
    if (fVar8 <= 1.0) {
      if (fVar8 < 0.0) {
        fVar8 = 0.0;
      }
    }
    else {
      fVar8 = 1.0;
    }
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,fVar8,(float)IVar12.vtable);
    if (*(float *)(DAT_0047f4d0 + 0xc) == 0.0) {
      fStack00000008 = (float)((iVar3 + 1) * 0x10);
      pIVar1 = grim_interface_ptr->vtable;
      IVar12.vtable = (IGrim2D_vtbl *)&DAT_004712b8;
      pcVar2 = (char *)((float)(int)fStack00000008 + *(float *)((int)arg1 + 0x1c) + 2.0);
      self = (IGrim2D *)console_input_buffer();
      iVar4 = (*pIVar1->grim_measure_text_width)(self,pcVar2);
      (*pIVar1->grim_draw_text_small)
                ((IGrim2D *)((float)iVar4 + 16.0),(float)IVar12.vtable,(float)text.vtable,pcVar9);
    }
    else {
      IVar12.vtable = (IGrim2D_vtbl *)&DAT_004712b8;
      fStack00000008 = (float)(DAT_0047ea54 << 3);
      (*grim_interface_ptr->vtable->grim_draw_text_mono)
                ((IGrim2D *)((float)(int)fStack00000008 + 26.0),
                 (float)((iVar3 + 1) * 0x10) + *(float *)((int)arg1 + 0x1c) + 2.0,6.527035e-39,
                 (char *)text.vtable);
    }
    iVar3 = (*grim_interface_ptr->vtable->grim_set_config_var)
                      ((IGrim2D *)0x15,2,(uint)IVar12.vtable);
  }
  return iVar3;
}



/* console_register_cvar @ 00402350 */

/* registers or updates a console cvar entry (stores string + float value) */

void * __thiscall console_register_cvar(void *this,char *name,char *value)

{
  int iVar1;
  int iVar2;
  void *pvVar3;
  char *pcVar4;
  undefined4 *puVar5;
  char *pcVar6;
  void *this_00;
  double dVar7;
  
  pvVar3 = console_cvar_find(this,name);
  if (pvVar3 != (void *)0x0) {
    if (*(void **)((int)pvVar3 + 0x10) != (void *)0x0) {
      crt_free(*(void **)((int)pvVar3 + 0x10));
    }
    *(undefined4 *)((int)pvVar3 + 0x10) = 0;
    pcVar6 = value;
    pcVar4 = strdup_malloc(value);
    *(char **)((int)pvVar3 + 0x10) = pcVar4;
    dVar7 = crt_atof_l(this_00,value,pcVar6);
    *(float *)((int)pvVar3 + 0xc) = (float)dVar7;
    return pvVar3;
  }
  iVar1 = *(int *)this;
  if (iVar1 == 0) {
    puVar5 = operator_new(0x24);
    if (puVar5 == (undefined4 *)0x0) {
      puVar5 = (undefined4 *)0x0;
    }
    else {
      puVar5[6] = 0;
      puVar5[7] = 0;
      puVar5[8] = 0;
      pcVar6 = strdup_malloc(name);
      *puVar5 = pcVar6;
      puVar5[1] = 0;
      puVar5[2] = 0;
      puVar5[3] = 0;
      puVar5[4] = 0;
      puVar5[5] = 0;
    }
    *(undefined4 **)this = puVar5;
    pcVar6 = value;
    pcVar4 = strdup_malloc(value);
    pvVar3 = *(void **)this;
    *(char **)((int)pvVar3 + 0x10) = pcVar4;
    dVar7 = crt_atof_l(pvVar3,value,pcVar6);
    *(float *)(*(int *)this + 0xc) = (float)dVar7;
    return *(void **)this;
  }
  for (iVar2 = *(int *)(iVar1 + 4); iVar2 != 0; iVar2 = *(int *)(iVar2 + 4)) {
    iVar1 = iVar2;
  }
  puVar5 = operator_new(0x24);
  if (puVar5 == (undefined4 *)0x0) {
    puVar5 = (undefined4 *)0x0;
  }
  else {
    puVar5[6] = 0;
    puVar5[7] = 0;
    puVar5[8] = 0;
    pcVar6 = strdup_malloc(name);
    *puVar5 = pcVar6;
    puVar5[1] = 0;
    puVar5[2] = 0;
    puVar5[3] = 0;
    puVar5[4] = 0;
    puVar5[5] = 0;
  }
  *(undefined4 **)(iVar1 + 4) = puVar5;
  pcVar6 = value;
  pcVar4 = strdup_malloc(value);
  pvVar3 = *(void **)(iVar1 + 4);
  *(char **)((int)pvVar3 + 0x10) = pcVar4;
  dVar7 = crt_atof_l(pvVar3,value,pcVar6);
  *(float *)(*(int *)(iVar1 + 4) + 0xc) = (float)dVar7;
  return *(void **)(iVar1 + 4);
}



/* console_cvar_find @ 00402480 */

/* finds a cvar entry by name */

void * __thiscall console_cvar_find(void *this,char *name)

{
  byte bVar1;
  undefined4 *puVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  bool bVar6;
  
  puVar2 = *(undefined4 **)this;
  do {
    if (puVar2 == (undefined4 *)0x0) {
      return (void *)0x0;
    }
    pbVar5 = (byte *)*puVar2;
    pbVar3 = (byte *)name;
    do {
      bVar1 = *pbVar3;
      bVar6 = bVar1 < *pbVar5;
      if (bVar1 != *pbVar5) {
LAB_004024ba:
        iVar4 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
        goto LAB_004024bf;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar3[1];
      bVar6 = bVar1 < pbVar5[1];
      if (bVar1 != pbVar5[1]) goto LAB_004024ba;
      pbVar3 = pbVar3 + 2;
      pbVar5 = pbVar5 + 2;
    } while (bVar1 != 0);
    iVar4 = 0;
LAB_004024bf:
    if (iVar4 == 0) {
      return puVar2;
    }
    puVar2 = (undefined4 *)puVar2[1];
  } while( true );
}



/* console_cvar_unregister @ 004024e0 */

/* removes a cvar entry by name */

char __thiscall console_cvar_unregister(void *this,char *name)

{
  void *pvVar1;
  void *pvVar2;
  void *pvVar3;
  
  pvVar3 = console_cvar_find(this,name);
  if (pvVar3 != (void *)0x0) {
    pvVar1 = *(void **)this;
    if (pvVar3 == pvVar1) {
      *(undefined4 *)this = *(undefined4 *)((int)pvVar1 + 4);
      return '\x01';
    }
    while (pvVar2 = pvVar1, pvVar2 != (void *)0x0) {
      pvVar1 = *(void **)((int)pvVar2 + 4);
      if (*(void **)((int)pvVar2 + 4) == pvVar3) {
        *(undefined4 *)((int)pvVar2 + 4) = *(undefined4 *)(*(int *)((int)pvVar2 + 4) + 4);
        return '\x01';
      }
    }
  }
  return '\0';
}



/* console_command_unregister @ 00402530 */

/* removes a console command entry by name */

char __thiscall console_command_unregister(void *this,char *name)

{
  void *pvVar1;
  void *pvVar2;
  void *pvVar3;
  
  pvVar3 = console_command_find(this,name);
  if (pvVar3 != (void *)0x0) {
    pvVar1 = *(void **)((int)this + 4);
    if (pvVar3 == pvVar1) {
      *(undefined4 *)((int)this + 4) = *(undefined4 *)((int)pvVar1 + 4);
      return '\x01';
    }
    while (pvVar2 = pvVar1, pvVar2 != (void *)0x0) {
      pvVar1 = *(void **)((int)pvVar2 + 4);
      if (*(void **)((int)pvVar2 + 4) == pvVar3) {
        *(undefined4 *)((int)pvVar2 + 4) = *(undefined4 *)(*(int *)((int)pvVar2 + 4) + 4);
        return '\x01';
      }
    }
  }
  return '\0';
}



/* console_tokenize_line @ 00402580 */

/* splits a console line into tokens */

void console_tokenize_line(char *line)

{
  char cVar1;
  char *pcVar2;
  uint uVar3;
  uint uVar4;
  char **ppcVar5;
  char *pcVar6;
  int iVar7;
  
  console_cmd_argc = 0;
  iVar7 = console_cmd_argc;
  if (line != (char *)0x0) {
    uVar3 = 0xffffffff;
    pcVar2 = line;
    do {
      if (uVar3 == 0) break;
      uVar3 = uVar3 - 1;
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    if (((~uVar3 - 1 < 2) || (*line != '/')) || (line[1] != '/')) {
      uVar3 = 0xffffffff;
      do {
        pcVar2 = line;
        if (uVar3 == 0) break;
        uVar3 = uVar3 - 1;
        pcVar2 = line + 1;
        cVar1 = *line;
        line = pcVar2;
      } while (cVar1 != '\0');
      uVar3 = ~uVar3;
      pcVar2 = pcVar2 + -uVar3;
      pcVar6 = (char *)&DAT_0047eaa0;
      for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
        *(undefined4 *)pcVar6 = *(undefined4 *)pcVar2;
        pcVar2 = pcVar2 + 4;
        pcVar6 = pcVar6 + 4;
      }
      for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
        *pcVar6 = *pcVar2;
        pcVar2 = pcVar2 + 1;
        pcVar6 = pcVar6 + 1;
      }
      pcVar2 = crt_strtok((char *)&DAT_0047eaa0,&DAT_004712d8);
      iVar7 = console_cmd_argc;
      if (pcVar2 != (char *)0x0) {
        iVar7 = 1;
        ppcVar5 = &console_cmd_arg1;
        console_cmd_name = pcVar2;
        while (pcVar2 = crt_strtok((char *)0x0,&DAT_004712d8), pcVar2 != (char *)0x0) {
          *ppcVar5 = pcVar2;
          iVar7 = iVar7 + 1;
          ppcVar5 = ppcVar5 + 1;
        }
      }
    }
  }
  console_cmd_argc = iVar7;
  return;
}



/* console_cvar_autocomplete @ 00402630 */

/* returns exact or prefix-matched cvar name */

char * __thiscall console_cvar_autocomplete(void *this,char *prefix)

{
  char cVar1;
  byte bVar2;
  undefined4 *puVar3;
  byte *pbVar4;
  int iVar5;
  uint uVar6;
  byte *pbVar7;
  undefined4 *puVar8;
  char *pcVar9;
  bool bVar10;
  
  uVar6 = 0xffffffff;
  pcVar9 = prefix;
  do {
    if (uVar6 == 0) break;
    uVar6 = uVar6 - 1;
    cVar1 = *pcVar9;
    pcVar9 = pcVar9 + 1;
  } while (cVar1 != '\0');
  if (~uVar6 - 1 != 0) {
    puVar8 = *(undefined4 **)this;
    for (puVar3 = puVar8; puVar3 != (undefined4 *)0x0; puVar3 = (undefined4 *)puVar3[1]) {
      pbVar7 = (byte *)*puVar3;
      pbVar4 = (byte *)prefix;
      do {
        bVar2 = *pbVar4;
        bVar10 = bVar2 < *pbVar7;
        if (bVar2 != *pbVar7) {
LAB_0040267e:
          iVar5 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
          goto LAB_00402683;
        }
        if (bVar2 == 0) break;
        bVar2 = pbVar4[1];
        bVar10 = bVar2 < pbVar7[1];
        if (bVar2 != pbVar7[1]) goto LAB_0040267e;
        pbVar4 = pbVar4 + 2;
        pbVar7 = pbVar7 + 2;
      } while (bVar2 != 0);
      iVar5 = 0;
LAB_00402683:
      if (iVar5 == 0) {
        return (char *)*puVar3;
      }
    }
    if (puVar8 != (undefined4 *)0x0) {
      do {
        iVar5 = _strncmp(prefix,(char *)*puVar8,~uVar6 - 1);
        if (iVar5 == 0) {
          return (char *)*puVar8;
        }
        puVar8 = (undefined4 *)puVar8[1];
      } while (puVar8 != (undefined4 *)0x0);
      return (char *)0x0;
    }
  }
  return (char *)0x0;
}



/* console_register_command @ 004026e0 */

/* registers a console command and handler */

void __thiscall console_register_command(void *this,char *name,void *handler)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  char *pcVar4;
  
  puVar3 = operator_new(0xc);
  if (puVar3 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)0x0;
  }
  else {
    pcVar4 = strdup_malloc(name);
    *puVar3 = pcVar4;
    puVar3[1] = 0;
    puVar3[2] = 0;
  }
  puVar3[2] = handler;
  iVar1 = *(int *)((int)this + 4);
  if (iVar1 != 0) {
    for (iVar2 = *(int *)(iVar1 + 4); iVar2 != 0; iVar2 = *(int *)(iVar2 + 4)) {
      iVar1 = iVar2;
    }
    *(undefined4 **)(iVar1 + 4) = puVar3;
    return;
  }
  *(undefined4 **)((int)this + 4) = puVar3;
  return;
}



/* console_command_find @ 00402750 */

/* finds a console command entry by name */

void * __thiscall console_command_find(void *this,char *name)

{
  byte bVar1;
  undefined4 *puVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  bool bVar6;
  
  puVar2 = *(undefined4 **)((int)this + 4);
  do {
    if (puVar2 == (undefined4 *)0x0) {
      return (void *)0x0;
    }
    pbVar5 = (byte *)*puVar2;
    pbVar3 = (byte *)name;
    do {
      bVar1 = *pbVar3;
      bVar6 = bVar1 < *pbVar5;
      if (bVar1 != *pbVar5) {
LAB_0040278b:
        iVar4 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
        goto LAB_00402790;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar3[1];
      bVar6 = bVar1 < pbVar5[1];
      if (bVar1 != pbVar5[1]) goto LAB_0040278b;
      pbVar3 = pbVar3 + 2;
      pbVar5 = pbVar5 + 2;
    } while (bVar1 != 0);
    iVar4 = 0;
LAB_00402790:
    if (iVar4 == 0) {
      return puVar2;
    }
    puVar2 = (undefined4 *)puVar2[1];
  } while( true );
}



/* console_command_autocomplete @ 004027b0 */

/* returns exact or prefix-matched command name */

char * __thiscall console_command_autocomplete(void *this,char *prefix)

{
  char cVar1;
  byte bVar2;
  undefined4 *puVar3;
  byte *pbVar4;
  int iVar5;
  uint uVar6;
  byte *pbVar7;
  undefined4 *puVar8;
  char *pcVar9;
  bool bVar10;
  
  uVar6 = 0xffffffff;
  pcVar9 = prefix;
  do {
    if (uVar6 == 0) break;
    uVar6 = uVar6 - 1;
    cVar1 = *pcVar9;
    pcVar9 = pcVar9 + 1;
  } while (cVar1 != '\0');
  if (~uVar6 - 1 != 0) {
    puVar8 = *(undefined4 **)((int)this + 4);
    for (puVar3 = puVar8; puVar3 != (undefined4 *)0x0; puVar3 = (undefined4 *)puVar3[1]) {
      pbVar7 = (byte *)*puVar3;
      pbVar4 = (byte *)prefix;
      do {
        bVar2 = *pbVar4;
        bVar10 = bVar2 < *pbVar7;
        if (bVar2 != *pbVar7) {
LAB_004027ff:
          iVar5 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
          goto LAB_00402804;
        }
        if (bVar2 == 0) break;
        bVar2 = pbVar4[1];
        bVar10 = bVar2 < pbVar7[1];
        if (bVar2 != pbVar7[1]) goto LAB_004027ff;
        pbVar4 = pbVar4 + 2;
        pbVar7 = pbVar7 + 2;
      } while (bVar2 != 0);
      iVar5 = 0;
LAB_00402804:
      if (iVar5 == 0) {
        return (char *)*puVar3;
      }
    }
    if (puVar8 != (undefined4 *)0x0) {
      do {
        iVar5 = _strncmp(prefix,(char *)*puVar8,~uVar6 - 1);
        if (iVar5 == 0) {
          return (char *)*puVar8;
        }
        puVar8 = (undefined4 *)puVar8[1];
      } while (puVar8 != (undefined4 *)0x0);
      return (char *)0x0;
    }
  }
  return (char *)0x0;
}



/* console_flush_log @ 00402860 */

/* flushes console lines to the log file */

int __fastcall console_flush_log(void *console_state,char *filename)

{
  char cVar1;
  char *pcVar2;
  FILE *fp;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  char *in_stack_00000004;
  char *mode;
  
  mode = &DAT_004712dc;
  pcVar2 = game_build_path(in_stack_00000004);
  fp = crt_fopen(pcVar2,mode);
  if (fp == (FILE *)0x0) {
    return 0;
  }
  iVar4 = *(int *)((int)console_state + 0x20);
  do {
    iVar4 = iVar4 + -1;
    if (iVar4 < 0) {
      crt_fflush(fp);
      iVar4 = crt_fclose(fp);
      return CONCAT31((int3)((uint)iVar4 >> 8),1);
    }
    puVar3 = *(undefined4 **)((int)console_state + 8);
    iVar5 = iVar4;
    if (0 < iVar4) {
      do {
        puVar3 = (undefined4 *)puVar3[1];
        iVar5 = iVar5 + -1;
      } while (iVar5 != 0);
    }
    uVar6 = 0xffffffff;
    pcVar2 = (char *)*puVar3;
    do {
      if (uVar6 == 0) break;
      uVar6 = uVar6 - 1;
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    crt_fwrite((char *)*puVar3,~uVar6 - 1,1,fp);
  } while( true );
}



/* config_init_defaults @ 004028f0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* initializes default config globals, key bindings, and name slots */

int config_init_defaults(void)

{
  char cVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  char *pcVar6;
  char (*pacVar7) [27];
  char *pcVar8;
  char (*pacStack_4) [27];
  
  config_blob.reserved0[0x74] = '\0';
  config_blob.reserved0[0x75] = '\0';
  config_blob.reserved0[0x76] = '\0';
  config_blob.reserved0[0x77] = '\0';
  config_blob.reserved0[0x78] = '\0';
  config_blob.reserved0[0x79] = '\0';
  config_blob.reserved0[0x7a] = '\0';
  config_blob.reserved0[0x7b] = '\0';
  config_blob.hardcore = '\0';
  config_blob.full_version = '\x01';
  config_blob.perk_prompt_counter = 0;
  config_blob.reserved8[0] = '\0';
  config_blob.reserved8[1] = '\0';
  config_blob.reserved8[2] = '\0';
  config_blob.reserved8[3] = '?';
  config_blob.reserved6[0] = '\x01';
  config_blob.reserved6[1] = '\0';
  config_blob.reserved6[2] = '\0';
  config_blob.reserved6[3] = '\0';
  config_blob.key_pick_perk = 0x101;
  config_blob.key_reload = 0x102;
  config_blob.reserved7[0] = '\0';
  config_blob.reserved0[0x70] = '\0';
  config_blob.reserved0[0x71] = '\0';
  config_blob.reserved0[0x72] = 0x80;
  config_blob.reserved0[0x73] = '?';
  config_blob.score_load_gate = '\0';
  config_blob.reserved0[0x7c] = '\0';
  iVar4 = 0;
  pacStack_4 = config_blob.saved_names;
  iVar5 = 0x88;
  do {
    uVar2 = 0xffffffff;
    *(int *)(config_blob.reserved0 + iVar5) = iVar4;
    pcVar6 = s_default_0047131c;
    do {
      pcVar8 = pcVar6;
      if (uVar2 == 0) break;
      uVar2 = uVar2 - 1;
      pcVar8 = pcVar6 + 1;
      cVar1 = *pcVar6;
      pcVar6 = pcVar8;
    } while (cVar1 != '\0');
    uVar2 = ~uVar2;
    iVar5 = iVar5 + 4;
    pcVar6 = pcVar8 + -uVar2;
    pacVar7 = pacStack_4;
    for (uVar3 = uVar2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
      *(undefined4 *)*pacVar7 = *(undefined4 *)pcVar6;
      pcVar6 = pcVar6 + 4;
      pacVar7 = (char (*) [27])(*pacVar7 + 4);
    }
    iVar4 = iVar4 + 1;
    for (uVar2 = uVar2 & 3; uVar2 != 0; uVar2 = uVar2 - 1) {
      (*pacVar7)[0] = *pcVar6;
      pcVar6 = pcVar6 + 1;
      pacVar7 = (char (*) [27])(*pacVar7 + 1);
    }
    pacStack_4 = pacStack_4 + 1;
  } while (iVar5 < 0xa8);
  config_blob.reserved0[3] = '\0';
  config_blob.reserved0[2] = '\0';
  pcVar6 = config_blob.player_name;
  for (iVar4 = 8; iVar4 != 0; iVar4 = iVar4 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  uVar2 = 0xffffffff;
  pcVar6 = &default_player_name;
  do {
    pcVar8 = pcVar6;
    if (uVar2 == 0) break;
    uVar2 = uVar2 - 1;
    pcVar8 = pcVar6 + 1;
    cVar1 = *pcVar6;
    pcVar6 = pcVar8;
  } while (cVar1 != '\0');
  uVar2 = ~uVar2;
  pcVar6 = pcVar8 + -uVar2;
  pcVar8 = config_blob.player_name;
  for (uVar3 = uVar2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar6;
    pcVar6 = pcVar6 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar2 = uVar2 & 3; uVar2 != 0; uVar2 = uVar2 - 1) {
    *pcVar8 = *pcVar6;
    pcVar6 = pcVar6 + 1;
    pcVar8 = pcVar8 + 1;
  }
  config_blob.reserved0[0x84] = '\x01';
  config_blob.reserved0[0x85] = '\0';
  config_blob.reserved0[0x86] = '\0';
  config_blob.reserved0[0x87] = '\0';
  config_blob.reserved0[0x80] = '\0';
  config_blob.reserved0[0x81] = '\0';
  config_blob.reserved0[0x82] = '\0';
  config_blob.reserved0[0x83] = '\0';
  config_blob.reserved0[0] = '\0';
  config_blob.reserved0[1] = '\0';
  config_blob.fx_toggle = '\0';
  config_blob.reserved6[0x10] = '\x01';
  config_blob.reserved1[4] = '\0';
  config_blob.reserved1[5] = '\0';
  config_blob.reserved1[6] = '\0';
  config_blob.reserved1[7] = '\0';
  config_blob.reserved1[8] = '\0';
  config_blob.reserved1[9] = '\0';
  config_blob.reserved1[10] = '\0';
  config_blob.reserved1[0xb] = '\0';
  config_blob.reserved0[0x6c] = '\0';
  config_blob.reserved0[0x6d] = '\0';
  config_blob.reserved0[0x6e] = '\0';
  config_blob.reserved0[0x6f] = '\0';
  config_blob.display_bpp = 0x20;
  config_blob.windowed._0_1_ = 0;
  config_blob.reserved0[0x18] = '\x01';
  config_blob.reserved0[0x19] = '\0';
  config_blob.reserved0[0x1a] = '\0';
  config_blob.reserved0[0x1b] = '\0';
  config_blob.reserved0[0xe] = '\x01';
  config_blob.reserved0[0xf] = '\0';
  config_blob.reserved0[0x10] = '\x01';
  config_blob.reserved0[0x1c] = '\x02';
  config_blob.reserved0[0x1d] = '\0';
  config_blob.reserved0[0x1e] = '\0';
  config_blob.reserved0[0x1f] = '\0';
  config_blob.reserved0[0x20] = '\x02';
  config_blob.reserved0[0x21] = '\0';
  config_blob.reserved0[0x22] = '\0';
  config_blob.reserved0[0x23] = '\0';
  config_blob.reserved0[0x44] = '\0';
  config_blob.reserved0[0x45] = '\0';
  config_blob.reserved0[0x46] = '\0';
  config_blob.reserved0[0x47] = '\0';
  config_blob.reserved0[0x48] = '\0';
  config_blob.reserved0[0x49] = '\0';
  config_blob.reserved0[0x4a] = '\0';
  config_blob.reserved0[0x4b] = '\0';
  config_blob.reserved0[0x11] = '\x01';
  config_blob.reserved0[0x14] = '\x01';
  config_blob.reserved0[0x15] = '\0';
  config_blob.reserved0[0x16] = '\0';
  config_blob.reserved0[0x17] = '\0';
  config_blob.keybinds_p1[3] = 0x20;
  config_blob.detail_preset = 5;
  config_blob.reserved1[0xc] = '(';
  config_blob.reserved1[0xd] = '#';
  config_blob.reserved1[0xe] = '\0';
  config_blob.reserved1[0xf] = '\0';
  config_blob.reserved1[0x10] = 'x';
  config_blob.reserved1[0x11] = 'i';
  config_blob.reserved1[0x12] = '\0';
  config_blob.reserved1[0x13] = '\0';
  config_blob.reserved1[0] = 'd';
  config_blob.reserved1[1] = '\0';
  config_blob.reserved1[2] = '\0';
  config_blob.reserved1[3] = '\0';
  config_blob.screen_width = 800;
  config_blob.screen_height = 600;
  config_blob.sfx_volume = 1.0;
  config_blob.music_volume = 1.0;
  config_blob.keybinds_p1[0] = 0x11;
  config_blob.keybinds_p1[1] = 0x1f;
  config_blob.keybinds_p1[2] = 0x1e;
  config_blob.keybinds_p1[4] = 0x100;
  config_blob.keybinds_p1[5] = 0x17e;
  config_blob.keybinds_p1[6] = 0x17e;
  config_blob.keybinds_p1[7] = 0x10;
  config_blob.keybinds_p1[8] = 0x12;
  config_blob.keybinds_p1[9] = 0x13f;
  config_blob.keybinds_p1[10] = 0x140;
  config_blob.keybinds_p1[0xb] = 0x141;
  config_blob.keybinds_p1[0xc] = 0x153;
  config_blob.reserved2[0] = '~';
  config_blob.reserved2[1] = '\x01';
  config_blob.reserved2[2] = '\0';
  config_blob.reserved2[3] = '\0';
  config_blob.reserved2[4] = '~';
  config_blob.reserved2[5] = '\x01';
  config_blob.reserved2[6] = '\0';
  config_blob.reserved2[7] = '\0';
  config_blob.reserved2[8] = '~';
  config_blob.reserved2[9] = '\x01';
  config_blob.reserved2[10] = '\0';
  config_blob.reserved2[0xb] = '\0';
  config_blob.keybinds_p2[0] = 200;
  config_blob.keybinds_p2[1] = 0xd0;
  config_blob.keybinds_p2[2] = 0xcb;
  config_blob.keybinds_p2[3] = 0xcd;
  config_blob.keybinds_p2[4] = 0x9d;
  config_blob.keybinds_p2[5] = 0x17e;
  config_blob.keybinds_p2[6] = 0x17e;
  config_blob.keybinds_p2[7] = 0xd3;
  config_blob.keybinds_p2[8] = 0xd1;
  config_blob.keybinds_p2[9] = 0x13f;
  config_blob.keybinds_p2[10] = 0x140;
  config_blob.keybinds_p2[0xb] = 0x141;
  config_blob.keybinds_p2[0xc] = 0x153;
  config_blob.reserved3[0] = '~';
  config_blob.reserved3[1] = '\x01';
  config_blob.reserved3[2] = '\0';
  config_blob.reserved3[3] = '\0';
  config_blob.reserved3[4] = '~';
  config_blob.reserved3[5] = '\x01';
  config_blob.reserved3[6] = '\0';
  config_blob.reserved3[7] = '\0';
  config_blob.reserved3[8] = '~';
  config_blob.reserved3[9] = '\x01';
  config_blob.reserved3[10] = '\0';
  config_blob.reserved3[0xb] = '\0';
  config_blob.reserved0[4] = '\x01';
  config_blob.reserved0[5] = '\x01';
  return 0x17e;
}



/* game_build_path @ 00402bd0 */

/* builds a game path by combining game_base_path with filename */

char * game_build_path(char *filename)

{
  crt_sprintf(&game_path_buf,s__s__s_00471324,&game_base_path,filename);
  return &game_path_buf;
}



/* register_core_cvars @ 00402c00 */

/* registers built-in cvars */

void register_core_cvars(void)

{
  cv_silentloads = console_register_cvar(&console_log_queue,s_cv_silentloads_00471434,&DAT_0047125c)
  ;
  cv_terrainFilter =
       console_register_cvar(&console_log_queue,s_cv_terrainFilter_00471420,&DAT_0047125c);
  cv_bodiesFade = console_register_cvar(&console_log_queue,s_cv_bodiesFade_00471410,&DAT_0047125c);
  cv_uiTransparency =
       console_register_cvar(&console_log_queue,s_cv_uiTransparency_004713fc,&DAT_0047125c);
  cv_uiPointFilterPanels =
       console_register_cvar(&console_log_queue,s_cv_uiPointFilterPanels_004713e0,&DAT_004713f8);
  cv_enableMousePointAndClickMovement =
       console_register_cvar
                 (&console_log_queue,s_cv_enableMousePointAndClickMovem_004713bc,&DAT_004713f8);
  cv_verbose = console_register_cvar(&console_log_queue,s_cv_verbose_004713b0,&DAT_004713f8);
  cv_terrainBodiesTransparency =
       console_register_cvar
                 (&console_log_queue,s_cv_terrainBodiesTransparency_00471390,&DAT_004713f8);
  cv_uiSmallIndicators =
       console_register_cvar(&console_log_queue,s_cv_uiSmallIndicators_00471378,&DAT_004713f8);
  cv_aimEnhancementFade =
       console_register_cvar(&console_log_queue,s_cv_aimEnhancementFade_00471360,&DAT_00471260);
  cv_friendlyFire =
       console_register_cvar(&console_log_queue,s_cv_friendlyFire_00471350,&DAT_004713f8);
  cv_showFPS = console_register_cvar(&console_log_queue,s_cv_showFPS_00471344,&DAT_004713f8);
  cv_padAimDistMul =
       console_register_cvar(&console_log_queue,s_cv_padAimDistMul_0047132c,&DAT_00471340);
  return;
}



/* FUN_00402d50 @ 00402d50 */

/* [binja] int32_t sub_402d50() */

int FUN_00402d50(void)

{
  IGrim2D_vtbl *pIVar1;
  float h;
  IGrim2D y;
  IGrim2D text;
  int iVar2;
  uint in_stack_ffffffd4;
  float in_stack_ffffffd8;
  IGrim2D *self;
  char *x;
  float afStack_18 [6];
  
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,in_stack_ffffffd4);
  afStack_18[0] = 0.0;
  afStack_18[1] = 0.0;
  afStack_18[2] = 0.0;
  h = (float)(config_blob.screen_height / 2 + -0x1e);
  afStack_18[3] = 0.5;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            ((IGrim2D *)&stack0xffffffe0,(float *)0x435c0000,60.0,(float)afStack_18);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,in_stack_ffffffd8)
  ;
  y.vtable = (IGrim2D_vtbl *)(config_blob.screen_height / 2 + -0x1e);
  afStack_18[0] = (float)(int)y.vtable;
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            ((IGrim2D *)&stack0xffffffe4,(float *)0x435c0000,60.0,h);
  pIVar1 = grim_interface_ptr->vtable;
  text.vtable = (IGrim2D_vtbl *)(config_blob.screen_height / 2 + -8);
  x = s_Please_wait____00471444;
  iVar2 = (*pIVar1->grim_measure_text_width)
                    ((IGrim2D *)s_Please_wait____00471444,(char *)(float)(int)text.vtable);
  afStack_18[0] = (float)(config_blob.screen_width / 2 - iVar2 / 2);
  self = (IGrim2D *)(float)(int)afStack_18[0];
  (*pIVar1->grim_draw_text_small)(self,(float)x,(float)y.vtable,(char *)text.vtable);
  iVar2 = (*grim_interface_ptr->vtable->grim_set_config_var)
                    ((IGrim2D *)0x36,CONCAT31((int3)((uint)self >> 8),1),(uint)x);
  return iVar2;
}



/* demo_setup_variant_0 @ 00402ed0 */

/* demo setup 0: 2P, spawns template 0x38 grid, assigns weapon 0xb */

void demo_setup_variant_0(void)

{
  uint uVar1;
  uint uVar2;
  int local_1c;
  float local_10;
  float local_c;
  float local_8;
  float local_4;
  
  config_blob.reserved0[0x14] = '\x02';
  config_blob.reserved0[0x15] = '\0';
  config_blob.reserved0[0x16] = '\0';
  config_blob.reserved0[0x17] = '\0';
  demo_time_limit_ms = 4000;
  uVar2 = 0;
  local_1c = 0x100;
  do {
    uVar1 = uVar2 & 0x80000001;
    if ((int)uVar1 < 0) {
      uVar1 = (uVar1 - 1 | 0xfffffffe) + 1;
    }
    local_10 = (float)(int)((uVar1 + 2) * 0x40);
    local_c = (float)local_1c;
    creature_spawn_template(0x38,&local_10,-100.0);
    local_8 = (float)(int)(uVar1 * 0x40 + 0x31e);
    local_4 = (float)local_1c;
    creature_spawn_template(0x38,&local_8,-100.0);
    local_1c = local_1c + 0x50;
    uVar2 = uVar2 + 1;
  } while (local_1c < 0x6a0);
  player_pos_x = 0x43e00000;
  player_pos_y = 0x43c00000;
  player_health._pad1[0x14] = '\0';
  player_health._pad1[0x15] = 0x80;
  player_health._pad1[0x16] = '\b';
  player_health._pad1[0x17] = 'D';
  player_health._pad1[0x18] = '\0';
  player_health._pad1[0x19] = 0x80;
  player_health._pad1[0x1a] = '#';
  player_health._pad1[0x1b] = 'D';
  weapon_assign_player(0,0xb);
  weapon_assign_player(1,0xb);
  return;
}



/* demo_setup_variant_2 @ 00402fe0 */

/* demo setup 2: 1P, spawns template 0x41 columns, assigns weapon 0x15 */

void demo_setup_variant_2(void)

{
  float fVar1;
  uint uVar2;
  uint uVar3;
  int local_28;
  float local_20;
  float local_1c;
  float local_18;
  float local_14;
  float local_10;
  float local_c;
  float local_8;
  float local_4;
  
  config_blob.reserved0[0x14] = '\x01';
  config_blob.reserved0[0x15] = '\0';
  config_blob.reserved0[0x16] = '\0';
  config_blob.reserved0[0x17] = '\0';
  demo_time_limit_ms = 5000;
  uVar2 = 0;
  local_28 = 0x80;
  do {
    uVar3 = uVar2 & 0x80000001;
    if ((int)uVar3 < 0) {
      uVar3 = (uVar3 - 1 | 0xfffffffe) + 1;
    }
    local_20 = (float)(int)(uVar3 * 0x40 + 0x20);
    fVar1 = (float)local_28;
    local_1c = fVar1;
    creature_spawn_template(0x41,&local_20,-100.0);
    local_18 = (float)(int)((uVar3 + 2) * 0x40);
    local_14 = fVar1;
    creature_spawn_template(0x41,&local_18,-100.0);
    local_10 = (float)(int)(uVar3 * 0x40 + -0x40);
    local_c = fVar1;
    creature_spawn_template(0x41,&local_10,-100.0);
    local_8 = (float)(int)((uVar3 + 0xc) * 0x40);
    local_4 = fVar1;
    creature_spawn_template(0x41,&local_8,-100.0);
    local_28 = local_28 + 0x3c;
    uVar2 = uVar2 + 1;
  } while (local_28 < 0x350);
  weapon_assign_player(0,0x15);
  return;
}



/* demo_setup_variant_1 @ 004030f0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* demo setup 1: 2P, terrain preset DAT_00484914, templates 0x34/0x35, weapon 5, power-up timer */

void demo_setup_variant_1(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  float local_10;
  float local_c;
  float local_8;
  float local_4;
  
  config_blob.reserved0[0x14] = '\x02';
  config_blob.reserved0[0x15] = '\0';
  config_blob.reserved0[0x16] = '\0';
  config_blob.reserved0[0x17] = '\0';
  terrain_generate(&DAT_00484914);
  demo_time_limit_ms = 5000;
  iVar3 = 0;
  do {
    iVar1 = crt_rand();
    iVar2 = crt_rand();
    local_c = (float)(iVar2 % 899 + 0x40);
    local_10 = (float)(iVar1 % 200 + 0x20);
    creature_spawn_template(0x34,&local_10,-100.0);
    if (iVar3 % 3 != 0) {
      iVar1 = crt_rand();
      iVar2 = crt_rand();
      local_4 = (float)(iVar2 % 899 + 0x40);
      local_8 = (float)(iVar1 % 0x1e + 0x20);
      creature_spawn_template(0x35,&local_8,-100.0);
    }
    iVar3 = iVar3 + 1;
  } while (iVar3 < 0x14);
  player_pos_x = 0x43f50000;
  player_pos_y = 0x43e00000;
  player_health._pad1[0x14] = '\0';
  player_health._pad1[0x15] = '\0';
  player_health._pad1[0x16] = 0xf0;
  player_health._pad1[0x17] = 'C';
  player_health._pad1[0x18] = '\0';
  player_health._pad1[0x19] = '\0';
  player_health._pad1[0x1a] = '\x10';
  player_health._pad1[0x1b] = 'D';
  weapon_assign_player(0,5);
  weapon_assign_player(1,5);
  _bonus_weapon_power_up_timer = 0x41700000;
  return;
}



/* demo_setup_variant_3 @ 00403250 */

/* demo setup 3: 1P, quest-selected terrain, templates 0x24/0x25, weapon 0x12 */

void demo_setup_variant_3(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  float local_10;
  float local_c;
  float local_8;
  float local_4;
  
  config_blob.reserved0[0x14] = '\x01';
  config_blob.reserved0[0x15] = '\0';
  config_blob.reserved0[0x16] = '\0';
  config_blob.reserved0[0x17] = '\0';
  terrain_generate(&quest_selected_meta);
  demo_time_limit_ms = 4000;
  iVar3 = 0;
  do {
    iVar1 = crt_rand();
    iVar2 = crt_rand();
    local_c = (float)(iVar2 % 899 + 0x40);
    local_10 = (float)(iVar1 % 200 + 0x20);
    creature_spawn_template(0x24,&local_10,0.0);
    if (iVar3 % 3 != 0) {
      iVar1 = crt_rand();
      iVar2 = crt_rand();
      local_4 = (float)(iVar2 % 899 + 0x40);
      local_8 = (float)(iVar1 % 0x1e + 0x20);
      creature_spawn_template(0x25,&local_8,0.0);
    }
    iVar3 = iVar3 + 1;
  } while (iVar3 < 0x14);
  player_pos_x = 0x44000000;
  player_pos_y = 0x44000000;
  weapon_assign_player(0,0x12);
  return;
}



/* demo_purchase_interstitial_begin @ 00403370 */

/* demo setup: activates the purchase/upsell interstitial (sets demo_time_limit_ms=10000 and
   demo_purchase_screen_active=1) */

void demo_purchase_interstitial_begin(void)

{
  demo_time_limit_ms = 10000;
  demo_purchase_screen_active = 1;
  return;
}



/* demo_mode_start @ 00403390 */

/* starts demo mode and cycles the demo setup */

int demo_mode_start(void)

{
  int iVar1;
  
  if (game_state_id != 9) {
    game_state_set(9);
  }
  demo_purchase_screen_active = 0;
  demo_mode_active = 1;
  gameplay_reset_state();
  config_blob.reserved0[0x18] = '\x01';
  config_blob.reserved0[0x19] = '\0';
  config_blob.reserved0[0x1a] = '\0';
  config_blob.reserved0[0x1b] = '\0';
  if (demo_variant_index == 0) {
    demo_setup_variant_0();
  }
  else if (demo_variant_index == 1) {
    demo_setup_variant_1();
  }
  else if (demo_variant_index == 2) {
    demo_setup_variant_2();
  }
  else if (demo_variant_index == 3) {
    demo_setup_variant_3();
  }
  else if (demo_variant_index == 4) {
    demo_setup_variant_0();
  }
  else {
    demo_purchase_interstitial_begin();
  }
  iVar1 = demo_variant_index + 1;
  quest_spawn_timeline = 0;
  DAT_0048702c = 0;
  demo_variant_index = iVar1 % 6;
  return iVar1 / 6;
}



/* FUN_00403430 @ 00403430 */

/* [binja] int32_t sub_403430(float* arg1, int32_t arg2, int32_t arg3) */

int __cdecl FUN_00403430(float *arg1,int arg2,int arg3)

{
  if ((((*arg1 - 10.0 < ui_mouse_x) && (arg1[1] - 2.0 < ui_mouse_y)) &&
      (ui_mouse_x < (float)arg3 + *arg1)) &&
     ((ui_mouse_y < (float)arg2 + arg1[1] && (ui_mouse_blocked == '\0')))) {
    return 1;
  }
  return 0;
}



/* ui_mouse_inside_rect @ 004034a0 */

/* returns 1 when the mouse is inside the rect and mouse capture is clear */

int __cdecl ui_mouse_inside_rect(float *xy,int h,int w)

{
  if ((((*xy < ui_mouse_x) && (xy[1] < ui_mouse_y)) && (ui_mouse_x < (float)w + *xy)) &&
     ((ui_mouse_y < (float)h + xy[1] && (ui_mouse_blocked == '\0')))) {
    return 1;
  }
  return 0;
}



/* game_core_init @ 00403500 */

/* initializes core game systems (quests, effects, UI assets) and sets initial state */

int game_core_init(void)

{
  undefined3 extraout_var;
  
  console_printf(&console_log_queue,s_GDI_initializing_UI_elements__00471468);
  quest_database_init();
  effect_defaults_reset();
  ui_menu_assets_init();
  bonus_metadata_init();
  render_pass_mode = 0;
  game_state_set(0);
  console_printf(&console_log_queue,s_Core_Init_done__00471454);
  return CONCAT31(extraout_var,1);
}



/* perk_prompt_update_and_render @ 00403550 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* updates perk prompt timer, animates transforms, and renders the prompt text */

void perk_prompt_update_and_render(void)

{
  IGrim2D_vtbl *pIVar1;
  char *pcVar2;
  int iVar3;
  float unaff_ESI;
  float10 fVar4;
  float10 fVar5;
  undefined1 *x;
  float in_stack_ffffff7c;
  char *in_stack_ffffff80;
  
  if ((demo_mode_active == '\0') && (config_blob.reserved0._24_4_ != 2)) {
    if ((perk_pending_count < 1) || (game_state_id != 9)) {
      perk_prompt_timer = perk_prompt_timer - frame_dt_ms;
      if (perk_prompt_timer < 0) {
        perk_prompt_timer = 0;
      }
    }
    else {
      perk_prompt_timer = perk_prompt_timer + frame_dt_ms;
      if (200 < perk_prompt_timer) {
        perk_prompt_timer = 200;
      }
    }
    if ((config_blob.full_version != '\0') && (0 < perk_prompt_timer)) {
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,(float)perk_prompt_timer * 0.005,unaff_ESI);
      pcVar2 = input_key_name(config_blob.key_pick_perk);
      crt_sprintf(&stack0xffffff84,s_Press__s_to_pick_a_perk_00471488,pcVar2);
      pIVar1 = grim_interface_ptr->vtable;
      x = &stack0xffffff84;
      iVar3 = (*pIVar1->grim_measure_text_width)
                        ((IGrim2D *)&stack0xffffff84,(char *)(_perk_prompt_origin_y + 8.0));
      (*pIVar1->grim_draw_text_small)
                ((IGrim2D *)(float)((config_blob.screen_width - iVar3) + -0x10),(float)x,
                 in_stack_ffffff7c,in_stack_ffffff80);
    }
    DAT_0048f20c = 1;
    fVar4 = ((float10)1.0 - (float10)perk_prompt_timer * (float10)0.005) * (float10)-1.5707964;
    fVar5 = (float10)fcos(fVar4);
    _perk_prompt_transform_cos = (float)fVar5;
    fVar4 = (float10)fsin((float10)(float)fVar4);
    _perk_prompt_transform_sin_neg = (float)-fVar4;
    _perk_prompt_transform_sin = (float)fVar4;
    _perk_prompt_transform_cos_2 = (float)fVar5;
    ui_element_render((ui_element_t *)&DAT_0048f20c);
  }
  return;
}



/* input_key_name @ 004036d0 */

/* maps key codes (DIK/virtual) to display labels */

char * __cdecl input_key_name(int key_code)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  char *pcVar5;
  char *pcVar6;
  
  if (key_code < 0x100) {
    iVar2 = GetKeyNameTextA(key_code << 0x10,(LPSTR)&DAT_004da100,0x3f);
    if (iVar2 != 0) {
      return (char *)&DAT_004da100;
    }
    switch(key_code) {
    case 1:
      return s_DIK_ESCAPE_004718d8;
    case 2:
      return s_DIK_1_004718d0;
    case 3:
      return s_DIK_2_004718c8;
    case 4:
      return s_DIK_3_004718c0;
    case 5:
      return s_DIK_4_004718b8;
    case 6:
      return s_DIK_5_004718b0;
    case 7:
      return s_DIK_6_004718a8;
    case 8:
      return s_DIK_7_004718a0;
    case 9:
      return s_DIK_8_00471898;
    case 10:
      return s_DIK_9_00471890;
    case 0xb:
      return s_DIK_0_00471888;
    case 0xc:
      return s_MINUS_00471880;
    case 0xd:
      return s_EQUALS_00471878;
    case 0xe:
      return &DAT_00471870;
    case 0xf:
      return &DAT_0047186c;
    case 0x10:
      return &DAT_00471868;
    case 0x11:
      return &DAT_00471864;
    case 0x12:
      return &DAT_00471860;
    case 0x13:
      return &DAT_0047185c;
    case 0x14:
      return &DAT_00471858;
    case 0x15:
      return &DAT_00471854;
    case 0x16:
      return &DAT_00471850;
    case 0x17:
      return &DAT_0047184c;
    case 0x18:
      return &DAT_00471848;
    case 0x19:
      return &DAT_00471844;
    case 0x1a:
      return s_LBRACKET_00471838;
    case 0x1b:
      return s_RBRACKET_0047182c;
    case 0x1c:
      return s_RETURN_00471824;
    case 0x1d:
      return s_LCONTROL_00471818;
    case 0x1e:
      return &DAT_00471814;
    case 0x1f:
      return &DAT_00471810;
    case 0x20:
      return &DAT_0047180c;
    case 0x21:
      return &DAT_00471808;
    case 0x22:
      return &DAT_00471804;
    case 0x23:
      return &DAT_00471800;
    case 0x24:
      return &DAT_004717fc;
    case 0x25:
      return &DAT_004717f8;
    case 0x26:
      return &DAT_004717f4;
    case 0x27:
      return s_SEMICOLON_004717e8;
    case 0x28:
      return s_APOSTROPHE_004717dc;
    case 0x29:
      return s_GRAVE_004717d4;
    case 0x2a:
      return s_LSHIFT_004717cc;
    case 0x2b:
      return s_BACKSLASH_004717c0;
    case 0x2c:
      return &DAT_004717bc;
    case 0x2d:
      return &DAT_004717b8;
    case 0x2e:
      return &DAT_004717b4;
    case 0x2f:
      return &DAT_004717b0;
    case 0x30:
      return &DAT_004717ac;
    case 0x31:
      return &DAT_004717a8;
    case 0x32:
      return &DAT_004717a4;
    case 0x33:
      return s_COMMA_0047179c;
    case 0x34:
      return s_PERIOD_00471794;
    case 0x35:
      return s_SLASH_0047178c;
    case 0x36:
      return s_RSHIFT_00471784;
    case 0x37:
      return s_MULTIPLY_00471778;
    case 0x38:
      return s_LMENU_00471770;
    case 0x39:
      return s_SPACE_00471768;
    case 0x3a:
      return s_CAPITAL_00471760;
    case 0x3b:
      return &DAT_0047175c;
    case 0x3c:
      return &DAT_00471758;
    case 0x3d:
      return &DAT_00471754;
    case 0x3e:
      return &DAT_00471750;
    case 0x3f:
      return &DAT_0047174c;
    case 0x40:
      return &DAT_00471748;
    case 0x41:
      return &DAT_00471744;
    case 0x42:
      return &DAT_00471740;
    case 0x43:
      return &DAT_0047173c;
    case 0x44:
      return &DAT_00471738;
    case 0x45:
      return s_NUMLOCK_00471730;
    case 0x46:
      return s_SCROLL_00471728;
    case 0x47:
      return s_NUMPAD7_00471720;
    case 0x48:
      return s_NUMPAD8_00471718;
    case 0x49:
      return s_NUMPAD9_00471710;
    case 0x4a:
      return s_SUBTRACT_00471704;
    case 0x4b:
      return s_NUMPAD4_004716fc;
    case 0x4c:
      return s_NUMPAD5_004716f4;
    case 0x4d:
      return s_NUMPAD6_004716ec;
    case 0x4e:
      return &DAT_004716e8;
    case 0x4f:
      return s_NUMPAD1_004716e0;
    case 0x50:
      return s_NUMPAD2_004716d8;
    case 0x51:
      return s_NUMPAD3_004716d0;
    case 0x52:
      return s_NUMPAD0_004716c8;
    case 0x53:
      return s_DECIMAL_004716c0;
    default:
      return s_Unknown_004714a0;
    case 0x56:
      return s_OEM_102_004716b8;
    case 0x57:
      return &DAT_004716b4;
    case 0x58:
      return &DAT_004716b0;
    case 100:
      return &DAT_004716ac;
    case 0x65:
      return &DAT_004716a8;
    case 0x66:
      return &DAT_004716a4;
    case 0x70:
      return &DAT_0047169c;
    case 0x73:
      return s_ABNT_C1_00471694;
    case 0x79:
      return s_CONVERT_0047168c;
    case 0x7b:
      return s_NOCONVERT_00471680;
    case 0x7d:
      return &DAT_0047167c;
    case 0x7e:
      return s_ABNT_C2_00471674;
    case 0x8d:
      return s_NUMPADEQUALS_00471664;
    case 0x90:
      return s_PREVTRACK_00471658;
    case 0x91:
      return &DAT_00471654;
    case 0x92:
      return s_COLON_0047164c;
    case 0x93:
      return s_UNDERLINE_00471640;
    case 0x94:
      return s_KANJI_00471638;
    case 0x95:
      return &DAT_00471630;
    case 0x96:
      return &DAT_0047162c;
    case 0x97:
      return s_UNLABELED_00471620;
    case 0x99:
      return s_NEXTTRACK_00471614;
    case 0x9c:
      return s_NUMPADENTER_00471608;
    case 0x9d:
      return s_RCONTROL_004715fc;
    case 0xa0:
      return &DAT_004715f4;
    case 0xa1:
      return s_CALCULATOR_004715e8;
    case 0xa2:
      return s_PLAYPAUSE_004715dc;
    case 0xa4:
      return s_MEDIASTOP_004715d0;
    case 0xae:
      return s_VOLUMEDOWN_004715c4;
    case 0xb0:
      return s_VOLUMEUP_004715b8;
    case 0xb2:
      return s_WEBHOME_004715b0;
    case 0xb3:
      return s_NUMPADCOMMA_004715a4;
    case 0xb5:
      return s_DIVIDE_0047159c;
    case 0xb7:
      return s_SYSRQ_00471594;
    case 0xb8:
      return s_RMENU_0047158c;
    case 0xc5:
      return s_PAUSE_00471584;
    case 199:
      return &DAT_0047157c;
    case 200:
      return &DAT_00471578;
    case 0xc9:
      return s_PRIOR_00471570;
    case 0xcb:
      return &DAT_00471568;
    case 0xcd:
      return s_RIGHT_00471560;
    case 0xcf:
      return &DAT_0047155c;
    case 0xd0:
      return &DAT_00471554;
    case 0xd1:
      return &DAT_0047154c;
    case 0xd2:
      return s_INSERT_00471544;
    case 0xd3:
      return s_DELETE_0047153c;
    case 0xdb:
      return &DAT_00471534;
    case 0xdc:
      return &DAT_0047152c;
    case 0xdd:
      return &DAT_00471524;
    case 0xde:
      return s_POWER_0047151c;
    case 0xdf:
      return s_SLEEP_00471514;
    case 0xe3:
      return &DAT_0047150c;
    case 0xe5:
      return s_WEBSEARCH_00471500;
    case 0xe6:
      return s_WEBFAVORITES_004714f0;
    case 0xe7:
      return s_WEBREFRESH_004714e4;
    case 0xe8:
      return s_WEBSTOP_004714dc;
    case 0xe9:
      return s_WEBFORWARD_004714d0;
    case 0xea:
      return s_WEBBACK_004714c8;
    case 0xeb:
      return s_MYCOMPUTER_004714bc;
    case 0xec:
      return &DAT_004714b4;
    case 0xed:
      return s_MEDIASELECT_004714a8;
    }
  }
  if (key_code == 0x100) {
    uVar3 = 0xffffffff;
    pcVar5 = s_Mouse1_00471af4;
    do {
      pcVar6 = pcVar5;
      if (uVar3 == 0) break;
      uVar3 = uVar3 - 1;
      pcVar6 = pcVar5 + 1;
      cVar1 = *pcVar5;
      pcVar5 = pcVar6;
    } while (cVar1 != '\0');
    uVar3 = ~uVar3;
    pcVar5 = pcVar6 + -uVar3;
    pcVar6 = (char *)&DAT_004da100;
    for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
      *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
      pcVar5 = pcVar5 + 4;
      pcVar6 = pcVar6 + 4;
    }
    for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
      *pcVar6 = *pcVar5;
      pcVar5 = pcVar5 + 1;
      pcVar6 = pcVar6 + 1;
    }
    return (char *)&DAT_004da100;
  }
  if (key_code == 0x101) {
    pcVar5 = s_Mouse2_00471aec;
  }
  else {
    if (key_code == 0x102) {
      uVar3 = 0xffffffff;
      pcVar5 = s_Mouse3_00471ae4;
      do {
        pcVar6 = pcVar5;
        if (uVar3 == 0) break;
        uVar3 = uVar3 - 1;
        pcVar6 = pcVar5 + 1;
        cVar1 = *pcVar5;
        pcVar5 = pcVar6;
      } while (cVar1 != '\0');
      uVar3 = ~uVar3;
      pcVar5 = pcVar6 + -uVar3;
      pcVar6 = (char *)&DAT_004da100;
      for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
        *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
        pcVar5 = pcVar5 + 4;
        pcVar6 = pcVar6 + 4;
      }
      for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
        *pcVar6 = *pcVar5;
        pcVar5 = pcVar5 + 1;
        pcVar6 = pcVar6 + 1;
      }
      return (char *)&DAT_004da100;
    }
    if (key_code == 0x103) {
      pcVar5 = s_Mouse4_00471adc;
    }
    else {
      if (key_code == 0x104) {
        uVar3 = 0xffffffff;
        pcVar5 = &DAT_00471ad4;
        do {
          pcVar6 = pcVar5;
          if (uVar3 == 0) break;
          uVar3 = uVar3 - 1;
          pcVar6 = pcVar5 + 1;
          cVar1 = *pcVar5;
          pcVar5 = pcVar6;
        } while (cVar1 != '\0');
        uVar3 = ~uVar3;
        pcVar5 = pcVar6 + -uVar3;
        pcVar6 = (char *)&DAT_004da100;
        for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
          *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
          pcVar5 = pcVar5 + 4;
          pcVar6 = pcVar6 + 4;
        }
        for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
          *pcVar6 = *pcVar5;
          pcVar5 = pcVar5 + 1;
          pcVar6 = pcVar6 + 1;
        }
        return (char *)&DAT_004da100;
      }
      if (key_code == 0x109) {
        pcVar5 = s_MWheelUp_00471ac8;
      }
      else {
        if (key_code == 0x10a) {
          uVar3 = 0xffffffff;
          pcVar5 = s_MWheelDown_00471abc;
          do {
            pcVar6 = pcVar5;
            if (uVar3 == 0) break;
            uVar3 = uVar3 - 1;
            pcVar6 = pcVar5 + 1;
            cVar1 = *pcVar5;
            pcVar5 = pcVar6;
          } while (cVar1 != '\0');
          uVar3 = ~uVar3;
          pcVar5 = pcVar6 + -uVar3;
          pcVar6 = (char *)&DAT_004da100;
          for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
            *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
            pcVar5 = pcVar5 + 4;
            pcVar6 = pcVar6 + 4;
          }
          for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
            *pcVar6 = *pcVar5;
            pcVar5 = pcVar5 + 1;
            pcVar6 = pcVar6 + 1;
          }
          return (char *)&DAT_004da100;
        }
        if (key_code == 0x11f) {
          pcVar5 = s_Joys1_00471ab4;
        }
        else {
          if (key_code == 0x120) {
            uVar3 = 0xffffffff;
            pcVar5 = &DAT_00471aac;
            do {
              pcVar6 = pcVar5;
              if (uVar3 == 0) break;
              uVar3 = uVar3 - 1;
              pcVar6 = pcVar5 + 1;
              cVar1 = *pcVar5;
              pcVar5 = pcVar6;
            } while (cVar1 != '\0');
            uVar3 = ~uVar3;
            pcVar5 = pcVar6 + -uVar3;
            pcVar6 = (char *)&DAT_004da100;
            for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
              *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
              pcVar5 = pcVar5 + 4;
              pcVar6 = pcVar6 + 4;
            }
            for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
              *pcVar6 = *pcVar5;
              pcVar5 = pcVar5 + 1;
              pcVar6 = pcVar6 + 1;
            }
            return (char *)&DAT_004da100;
          }
          if (key_code == 0x121) {
            pcVar5 = s_Joys3_00471aa4;
          }
          else {
            if (key_code == 0x122) {
              uVar3 = 0xffffffff;
              pcVar5 = &DAT_00471a9c;
              do {
                pcVar6 = pcVar5;
                if (uVar3 == 0) break;
                uVar3 = uVar3 - 1;
                pcVar6 = pcVar5 + 1;
                cVar1 = *pcVar5;
                pcVar5 = pcVar6;
              } while (cVar1 != '\0');
              uVar3 = ~uVar3;
              pcVar5 = pcVar6 + -uVar3;
              pcVar6 = (char *)&DAT_004da100;
              for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                pcVar5 = pcVar5 + 4;
                pcVar6 = pcVar6 + 4;
              }
              for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                *pcVar6 = *pcVar5;
                pcVar5 = pcVar5 + 1;
                pcVar6 = pcVar6 + 1;
              }
              return (char *)&DAT_004da100;
            }
            if (key_code == 0x123) {
              pcVar5 = s_Joys5_00471a94;
            }
            else {
              if (key_code == 0x124) {
                uVar3 = 0xffffffff;
                pcVar5 = &DAT_00471a8c;
                do {
                  pcVar6 = pcVar5;
                  if (uVar3 == 0) break;
                  uVar3 = uVar3 - 1;
                  pcVar6 = pcVar5 + 1;
                  cVar1 = *pcVar5;
                  pcVar5 = pcVar6;
                } while (cVar1 != '\0');
                uVar3 = ~uVar3;
                pcVar5 = pcVar6 + -uVar3;
                pcVar6 = (char *)&DAT_004da100;
                for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                  *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                  pcVar5 = pcVar5 + 4;
                  pcVar6 = pcVar6 + 4;
                }
                for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                  *pcVar6 = *pcVar5;
                  pcVar5 = pcVar5 + 1;
                  pcVar6 = pcVar6 + 1;
                }
                return (char *)&DAT_004da100;
              }
              if (key_code == 0x125) {
                pcVar5 = s_Joys7_00471a84;
              }
              else {
                if (key_code == 0x126) {
                  uVar3 = 0xffffffff;
                  pcVar5 = &DAT_00471a7c;
                  do {
                    pcVar6 = pcVar5;
                    if (uVar3 == 0) break;
                    uVar3 = uVar3 - 1;
                    pcVar6 = pcVar5 + 1;
                    cVar1 = *pcVar5;
                    pcVar5 = pcVar6;
                  } while (cVar1 != '\0');
                  uVar3 = ~uVar3;
                  pcVar5 = pcVar6 + -uVar3;
                  pcVar6 = (char *)&DAT_004da100;
                  for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                    *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                    pcVar5 = pcVar5 + 4;
                    pcVar6 = pcVar6 + 4;
                  }
                  for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                    *pcVar6 = *pcVar5;
                    pcVar5 = pcVar5 + 1;
                    pcVar6 = pcVar6 + 1;
                  }
                  return (char *)&DAT_004da100;
                }
                if (key_code == 0x127) {
                  pcVar5 = s_Joys9_00471a74;
                }
                else {
                  if (key_code == 0x128) {
                    uVar3 = 0xffffffff;
                    pcVar5 = &DAT_00471a6c;
                    do {
                      pcVar6 = pcVar5;
                      if (uVar3 == 0) break;
                      uVar3 = uVar3 - 1;
                      pcVar6 = pcVar5 + 1;
                      cVar1 = *pcVar5;
                      pcVar5 = pcVar6;
                    } while (cVar1 != '\0');
                    uVar3 = ~uVar3;
                    pcVar5 = pcVar6 + -uVar3;
                    pcVar6 = (char *)&DAT_004da100;
                    for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                      *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                      pcVar5 = pcVar5 + 4;
                      pcVar6 = pcVar6 + 4;
                    }
                    for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                      *pcVar6 = *pcVar5;
                      pcVar5 = pcVar5 + 1;
                      pcVar6 = pcVar6 + 1;
                    }
                    return (char *)&DAT_004da100;
                  }
                  if (key_code == 0x129) {
                    pcVar5 = s_Joys11_00471a64;
                  }
                  else {
                    if (key_code == 0x12a) {
                      uVar3 = 0xffffffff;
                      pcVar5 = &DAT_00471a5c;
                      do {
                        pcVar6 = pcVar5;
                        if (uVar3 == 0) break;
                        uVar3 = uVar3 - 1;
                        pcVar6 = pcVar5 + 1;
                        cVar1 = *pcVar5;
                        pcVar5 = pcVar6;
                      } while (cVar1 != '\0');
                      uVar3 = ~uVar3;
                      pcVar5 = pcVar6 + -uVar3;
                      pcVar6 = (char *)&DAT_004da100;
                      for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                        *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                        pcVar5 = pcVar5 + 4;
                        pcVar6 = pcVar6 + 4;
                      }
                      for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                        *pcVar6 = *pcVar5;
                        pcVar5 = pcVar5 + 1;
                        pcVar6 = pcVar6 + 1;
                      }
                      return (char *)&DAT_004da100;
                    }
                    if (key_code == 0x131) {
                      pcVar5 = s_JoysUp_00471a54;
                    }
                    else {
                      if (key_code == 0x132) {
                        uVar3 = 0xffffffff;
                        pcVar5 = s_JoysDown_00471a48;
                        do {
                          pcVar6 = pcVar5;
                          if (uVar3 == 0) break;
                          uVar3 = uVar3 - 1;
                          pcVar6 = pcVar5 + 1;
                          cVar1 = *pcVar5;
                          pcVar5 = pcVar6;
                        } while (cVar1 != '\0');
                        uVar3 = ~uVar3;
                        pcVar5 = pcVar6 + -uVar3;
                        pcVar6 = (char *)&DAT_004da100;
                        for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                          *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                          pcVar5 = pcVar5 + 4;
                          pcVar6 = pcVar6 + 4;
                        }
                        for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                          *pcVar6 = *pcVar5;
                          pcVar5 = pcVar5 + 1;
                          pcVar6 = pcVar6 + 1;
                        }
                        return (char *)&DAT_004da100;
                      }
                      if (key_code == 0x133) {
                        pcVar5 = s_JoysLeft_00471a3c;
                      }
                      else {
                        if (key_code == 0x134) {
                          uVar3 = 0xffffffff;
                          pcVar5 = s_JoysRight_00471a30;
                          do {
                            pcVar6 = pcVar5;
                            if (uVar3 == 0) break;
                            uVar3 = uVar3 - 1;
                            pcVar6 = pcVar5 + 1;
                            cVar1 = *pcVar5;
                            pcVar5 = pcVar6;
                          } while (cVar1 != '\0');
                          uVar3 = ~uVar3;
                          pcVar5 = pcVar6 + -uVar3;
                          pcVar6 = (char *)&DAT_004da100;
                          for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                            *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                            pcVar5 = pcVar5 + 4;
                            pcVar6 = pcVar6 + 4;
                          }
                          for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                            *pcVar6 = *pcVar5;
                            pcVar5 = pcVar5 + 1;
                            pcVar6 = pcVar6 + 1;
                          }
                          return (char *)&DAT_004da100;
                        }
                        if (key_code == 0x13f) {
                          pcVar5 = s_JoyAxisX_00471a24;
                        }
                        else {
                          if (key_code == 0x140) {
                            uVar3 = 0xffffffff;
                            pcVar5 = s_JoyAxisY_00471a18;
                            do {
                              pcVar6 = pcVar5;
                              if (uVar3 == 0) break;
                              uVar3 = uVar3 - 1;
                              pcVar6 = pcVar5 + 1;
                              cVar1 = *pcVar5;
                              pcVar5 = pcVar6;
                            } while (cVar1 != '\0');
                            uVar3 = ~uVar3;
                            pcVar5 = pcVar6 + -uVar3;
                            pcVar6 = (char *)&DAT_004da100;
                            for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                              *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                              pcVar5 = pcVar5 + 4;
                              pcVar6 = pcVar6 + 4;
                            }
                            for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                              *pcVar6 = *pcVar5;
                              pcVar5 = pcVar5 + 1;
                              pcVar6 = pcVar6 + 1;
                            }
                            return (char *)&DAT_004da100;
                          }
                          if (key_code == 0x141) {
                            pcVar5 = s_JoyAxisZ_00471a0c;
                          }
                          else {
                            if (key_code == 0x153) {
                              uVar3 = 0xffffffff;
                              pcVar5 = &DAT_00471a04;
                              do {
                                pcVar6 = pcVar5;
                                if (uVar3 == 0) break;
                                uVar3 = uVar3 - 1;
                                pcVar6 = pcVar5 + 1;
                                cVar1 = *pcVar5;
                                pcVar5 = pcVar6;
                              } while (cVar1 != '\0');
                              uVar3 = ~uVar3;
                              pcVar5 = pcVar6 + -uVar3;
                              pcVar6 = (char *)&DAT_004da100;
                              for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                                *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                pcVar5 = pcVar5 + 4;
                                pcVar6 = pcVar6 + 4;
                              }
                              for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                                *pcVar6 = *pcVar5;
                                pcVar5 = pcVar5 + 1;
                                pcVar6 = pcVar6 + 1;
                              }
                              return (char *)&DAT_004da100;
                            }
                            if (key_code == 0x154) {
                              pcVar5 = s_JoyRotY_004719fc;
                            }
                            else {
                              if (key_code == 0x155) {
                                uVar3 = 0xffffffff;
                                pcVar5 = &DAT_004719f4;
                                do {
                                  pcVar6 = pcVar5;
                                  if (uVar3 == 0) break;
                                  uVar3 = uVar3 - 1;
                                  pcVar6 = pcVar5 + 1;
                                  cVar1 = *pcVar5;
                                  pcVar5 = pcVar6;
                                } while (cVar1 != '\0');
                                uVar3 = ~uVar3;
                                pcVar5 = pcVar6 + -uVar3;
                                pcVar6 = (char *)&DAT_004da100;
                                for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                                  *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                  pcVar5 = pcVar5 + 4;
                                  pcVar6 = pcVar6 + 4;
                                }
                                for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                                  *pcVar6 = *pcVar5;
                                  pcVar5 = pcVar5 + 1;
                                  pcVar6 = pcVar6 + 1;
                                }
                                return (char *)&DAT_004da100;
                              }
                              if (key_code == 0x17e) {
                                pcVar5 = s_unbound_004719ec;
                              }
                              else {
                                if (key_code == 0x163) {
                                  uVar3 = 0xffffffff;
                                  pcVar5 = &DAT_004719e0;
                                  do {
                                    pcVar6 = pcVar5;
                                    if (uVar3 == 0) break;
                                    uVar3 = uVar3 - 1;
                                    pcVar6 = pcVar5 + 1;
                                    cVar1 = *pcVar5;
                                    pcVar5 = pcVar6;
                                  } while (cVar1 != '\0');
                                  uVar3 = ~uVar3;
                                  pcVar5 = pcVar6 + -uVar3;
                                  pcVar6 = (char *)&DAT_004da100;
                                  for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                                    *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                    pcVar5 = pcVar5 + 4;
                                    pcVar6 = pcVar6 + 4;
                                  }
                                  for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                                    *pcVar6 = *pcVar5;
                                    pcVar5 = pcVar5 + 1;
                                    pcVar6 = pcVar6 + 1;
                                  }
                                  return (char *)&DAT_004da100;
                                }
                                if (key_code == 0x164) {
                                  pcVar5 = s_RIM1XAxis_004719d4;
                                }
                                else {
                                  if (key_code == 0x165) {
                                    uVar3 = 0xffffffff;
                                    pcVar5 = &DAT_004719c8;
                                    do {
                                      pcVar6 = pcVar5;
                                      if (uVar3 == 0) break;
                                      uVar3 = uVar3 - 1;
                                      pcVar6 = pcVar5 + 1;
                                      cVar1 = *pcVar5;
                                      pcVar5 = pcVar6;
                                    } while (cVar1 != '\0');
                                    uVar3 = ~uVar3;
                                    pcVar5 = pcVar6 + -uVar3;
                                    pcVar6 = (char *)&DAT_004da100;
                                    for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                                      *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                      pcVar5 = pcVar5 + 4;
                                      pcVar6 = pcVar6 + 4;
                                    }
                                    for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                                      *pcVar6 = *pcVar5;
                                      pcVar5 = pcVar5 + 1;
                                      pcVar6 = pcVar6 + 1;
                                    }
                                    return (char *)&DAT_004da100;
                                  }
                                  if (key_code == 0x168) {
                                    pcVar5 = s_RIM0YAxis_004719bc;
                                  }
                                  else {
                                    if (key_code == 0x169) {
                                      uVar3 = 0xffffffff;
                                      pcVar5 = &DAT_004719b0;
                                      do {
                                        pcVar6 = pcVar5;
                                        if (uVar3 == 0) break;
                                        uVar3 = uVar3 - 1;
                                        pcVar6 = pcVar5 + 1;
                                        cVar1 = *pcVar5;
                                        pcVar5 = pcVar6;
                                      } while (cVar1 != '\0');
                                      uVar3 = ~uVar3;
                                      pcVar5 = pcVar6 + -uVar3;
                                      pcVar6 = (char *)&DAT_004da100;
                                      for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                                        *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                        pcVar5 = pcVar5 + 4;
                                        pcVar6 = pcVar6 + 4;
                                      }
                                      for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                                        *pcVar6 = *pcVar5;
                                        pcVar5 = pcVar5 + 1;
                                        pcVar6 = pcVar6 + 1;
                                      }
                                      return (char *)&DAT_004da100;
                                    }
                                    if (key_code == 0x16a) {
                                      pcVar5 = s_RIM2YAxis_004719a4;
                                    }
                                    else {
                                      if (key_code == 0x16d) {
                                        uVar3 = 0xffffffff;
                                        pcVar5 = &DAT_00471998;
                                        do {
                                          pcVar6 = pcVar5;
                                          if (uVar3 == 0) break;
                                          uVar3 = uVar3 - 1;
                                          pcVar6 = pcVar5 + 1;
                                          cVar1 = *pcVar5;
                                          pcVar5 = pcVar6;
                                        } while (cVar1 != '\0');
                                        uVar3 = ~uVar3;
                                        pcVar5 = pcVar6 + -uVar3;
                                        pcVar6 = (char *)&DAT_004da100;
                                        for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                                          *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                          pcVar5 = pcVar5 + 4;
                                          pcVar6 = pcVar6 + 4;
                                        }
                                        for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                                          *pcVar6 = *pcVar5;
                                          pcVar5 = pcVar5 + 1;
                                          pcVar6 = pcVar6 + 1;
                                        }
                                        return (char *)&DAT_004da100;
                                      }
                                      if (key_code == 0x16e) {
                                        pcVar5 = s_RIM0Btn2_0047198c;
                                      }
                                      else {
                                        if (key_code == 0x16f) {
                                          uVar3 = 0xffffffff;
                                          pcVar5 = &DAT_00471980;
                                          do {
                                            pcVar6 = pcVar5;
                                            if (uVar3 == 0) break;
                                            uVar3 = uVar3 - 1;
                                            pcVar6 = pcVar5 + 1;
                                            cVar1 = *pcVar5;
                                            pcVar5 = pcVar6;
                                          } while (cVar1 != '\0');
                                          uVar3 = ~uVar3;
                                          pcVar5 = pcVar6 + -uVar3;
                                          pcVar6 = (char *)&DAT_004da100;
                                          for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
                                            *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                            pcVar5 = pcVar5 + 4;
                                            pcVar6 = pcVar6 + 4;
                                          }
                                          for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                                            *pcVar6 = *pcVar5;
                                            pcVar5 = pcVar5 + 1;
                                            pcVar6 = pcVar6 + 1;
                                          }
                                          return (char *)&DAT_004da100;
                                        }
                                        if (key_code == 0x170) {
                                          pcVar5 = s_RIM0Btn4_00471974;
                                        }
                                        else {
                                          if (key_code == 0x171) {
                                            uVar3 = 0xffffffff;
                                            pcVar5 = &DAT_00471968;
                                            do {
                                              pcVar6 = pcVar5;
                                              if (uVar3 == 0) break;
                                              uVar3 = uVar3 - 1;
                                              pcVar6 = pcVar5 + 1;
                                              cVar1 = *pcVar5;
                                              pcVar5 = pcVar6;
                                            } while (cVar1 != '\0');
                                            uVar3 = ~uVar3;
                                            pcVar5 = pcVar6 + -uVar3;
                                            pcVar6 = (char *)&DAT_004da100;
                                            for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1)
                                            {
                                              *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                              pcVar5 = pcVar5 + 4;
                                              pcVar6 = pcVar6 + 4;
                                            }
                                            for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
                                              *pcVar6 = *pcVar5;
                                              pcVar5 = pcVar5 + 1;
                                              pcVar6 = pcVar6 + 1;
                                            }
                                            return (char *)&DAT_004da100;
                                          }
                                          if (key_code == 0x172) {
                                            pcVar5 = s_RIM1Btn1_0047195c;
                                          }
                                          else {
                                            if (key_code == 0x173) {
                                              uVar3 = 0xffffffff;
                                              pcVar5 = &DAT_00471950;
                                              do {
                                                pcVar6 = pcVar5;
                                                if (uVar3 == 0) break;
                                                uVar3 = uVar3 - 1;
                                                pcVar6 = pcVar5 + 1;
                                                cVar1 = *pcVar5;
                                                pcVar5 = pcVar6;
                                              } while (cVar1 != '\0');
                                              uVar3 = ~uVar3;
                                              pcVar5 = pcVar6 + -uVar3;
                                              pcVar6 = (char *)&DAT_004da100;
                                              for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1
                                                  ) {
                                                *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                                pcVar5 = pcVar5 + 4;
                                                pcVar6 = pcVar6 + 4;
                                              }
                                              for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1)
                                              {
                                                *pcVar6 = *pcVar5;
                                                pcVar5 = pcVar5 + 1;
                                                pcVar6 = pcVar6 + 1;
                                              }
                                              return (char *)&DAT_004da100;
                                            }
                                            if (key_code == 0x174) {
                                              pcVar5 = s_RIM1Btn3_00471944;
                                            }
                                            else {
                                              if (key_code == 0x175) {
                                                uVar3 = 0xffffffff;
                                                pcVar5 = &DAT_00471938;
                                                do {
                                                  pcVar6 = pcVar5;
                                                  if (uVar3 == 0) break;
                                                  uVar3 = uVar3 - 1;
                                                  pcVar6 = pcVar5 + 1;
                                                  cVar1 = *pcVar5;
                                                  pcVar5 = pcVar6;
                                                } while (cVar1 != '\0');
                                                uVar3 = ~uVar3;
                                                pcVar5 = pcVar6 + -uVar3;
                                                pcVar6 = (char *)&DAT_004da100;
                                                for (uVar4 = uVar3 >> 2; uVar4 != 0;
                                                    uVar4 = uVar4 - 1) {
                                                  *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                                  pcVar5 = pcVar5 + 4;
                                                  pcVar6 = pcVar6 + 4;
                                                }
                                                for (uVar3 = uVar3 & 3; uVar3 != 0;
                                                    uVar3 = uVar3 - 1) {
                                                  *pcVar6 = *pcVar5;
                                                  pcVar5 = pcVar5 + 1;
                                                  pcVar6 = pcVar6 + 1;
                                                }
                                                return (char *)&DAT_004da100;
                                              }
                                              if (key_code == 0x176) {
                                                pcVar5 = s_RIM1Btn5_0047192c;
                                              }
                                              else {
                                                if (key_code == 0x177) {
                                                  uVar3 = 0xffffffff;
                                                  pcVar5 = &DAT_00471920;
                                                  do {
                                                    pcVar6 = pcVar5;
                                                    if (uVar3 == 0) break;
                                                    uVar3 = uVar3 - 1;
                                                    pcVar6 = pcVar5 + 1;
                                                    cVar1 = *pcVar5;
                                                    pcVar5 = pcVar6;
                                                  } while (cVar1 != '\0');
                                                  uVar3 = ~uVar3;
                                                  pcVar5 = pcVar6 + -uVar3;
                                                  pcVar6 = (char *)&DAT_004da100;
                                                  for (uVar4 = uVar3 >> 2; uVar4 != 0;
                                                      uVar4 = uVar4 - 1) {
                                                    *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                                    pcVar5 = pcVar5 + 4;
                                                    pcVar6 = pcVar6 + 4;
                                                  }
                                                  for (uVar3 = uVar3 & 3; uVar3 != 0;
                                                      uVar3 = uVar3 - 1) {
                                                    *pcVar6 = *pcVar5;
                                                    pcVar5 = pcVar5 + 1;
                                                    pcVar6 = pcVar6 + 1;
                                                  }
                                                  return (char *)&DAT_004da100;
                                                }
                                                if (key_code == 0x178) {
                                                  pcVar5 = s_RIM2Btn2_00471914;
                                                }
                                                else {
                                                  if (key_code == 0x179) {
                                                    uVar3 = 0xffffffff;
                                                    pcVar5 = &DAT_00471908;
                                                    do {
                                                      pcVar6 = pcVar5;
                                                      if (uVar3 == 0) break;
                                                      uVar3 = uVar3 - 1;
                                                      pcVar6 = pcVar5 + 1;
                                                      cVar1 = *pcVar5;
                                                      pcVar5 = pcVar6;
                                                    } while (cVar1 != '\0');
                                                    uVar3 = ~uVar3;
                                                    pcVar5 = pcVar6 + -uVar3;
                                                    pcVar6 = (char *)&DAT_004da100;
                                                    for (uVar4 = uVar3 >> 2; uVar4 != 0;
                                                        uVar4 = uVar4 - 1) {
                                                      *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
                                                      pcVar5 = pcVar5 + 4;
                                                      pcVar6 = pcVar6 + 4;
                                                    }
                                                    for (uVar3 = uVar3 & 3; uVar3 != 0;
                                                        uVar3 = uVar3 - 1) {
                                                      *pcVar6 = *pcVar5;
                                                      pcVar5 = pcVar5 + 1;
                                                      pcVar6 = pcVar6 + 1;
                                                    }
                                                    return (char *)&DAT_004da100;
                                                  }
                                                  if (key_code == 0x17a) {
                                                    pcVar5 = s_RIM2Btn4_004718fc;
                                                  }
                                                  else {
                                                    if (key_code == 0x17b) {
                                                      uVar3 = 0xffffffff;
                                                      pcVar5 = &DAT_004718f0;
                                                      do {
                                                        pcVar6 = pcVar5;
                                                        if (uVar3 == 0) break;
                                                        uVar3 = uVar3 - 1;
                                                        pcVar6 = pcVar5 + 1;
                                                        cVar1 = *pcVar5;
                                                        pcVar5 = pcVar6;
                                                      } while (cVar1 != '\0');
                                                      uVar3 = ~uVar3;
                                                      pcVar5 = pcVar6 + -uVar3;
                                                      pcVar6 = (char *)&DAT_004da100;
                                                      for (uVar4 = uVar3 >> 2; uVar4 != 0;
                                                          uVar4 = uVar4 - 1) {
                                                        *(undefined4 *)pcVar6 =
                                                             *(undefined4 *)pcVar5;
                                                        pcVar5 = pcVar5 + 4;
                                                        pcVar6 = pcVar6 + 4;
                                                      }
                                                      for (uVar3 = uVar3 & 3; uVar3 != 0;
                                                          uVar3 = uVar3 - 1) {
                                                        *pcVar6 = *pcVar5;
                                                        pcVar5 = pcVar5 + 1;
                                                        pcVar6 = pcVar6 + 1;
                                                      }
                                                      return (char *)&DAT_004da100;
                                                    }
                                                    if (key_code < 0x164) goto LAB_00403e30;
                                                    pcVar5 = s_RawInput___004718e4;
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  uVar3 = 0xffffffff;
  do {
    pcVar6 = pcVar5;
    if (uVar3 == 0) break;
    uVar3 = uVar3 - 1;
    pcVar6 = pcVar5 + 1;
    cVar1 = *pcVar5;
    pcVar5 = pcVar6;
  } while (cVar1 != '\0');
  uVar3 = ~uVar3;
  pcVar5 = pcVar6 + -uVar3;
  pcVar6 = (char *)&DAT_004da100;
  for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
    *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
    pcVar5 = pcVar5 + 4;
    pcVar6 = pcVar6 + 4;
  }
  for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *pcVar6 = *pcVar5;
    pcVar5 = pcVar5 + 1;
    pcVar6 = pcVar6 + 1;
  }
LAB_00403e30:
  return (char *)&DAT_004da100;
}



/* perks_generate_choices @ 004045a0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* builds the current perk choice list */

void perks_generate_choices(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  undefined4 *puVar6;
  
  iVar5 = 0;
  puVar6 = &perk_choice_ids;
  for (iVar3 = 7; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar6 = 0;
    puVar6 = puVar6 + 1;
  }
LAB_004045be:
  if ((((iVar5 == 0) && (_quest_stage_major == *quest_monster_vision_meta)) &&
      (_quest_stage_minor == quest_monster_vision_meta[1])) &&
     (iVar3 = perk_count_get(perk_id_monster_vision), iVar3 == 0)) {
    iVar5 = 1;
    perk_choice_ids = perk_id_monster_vision;
  }
  iVar3 = 0;
LAB_00404603:
  do {
    iVar3 = iVar3 + 1;
    iVar1 = perk_select_random();
    iVar2 = perk_id_pyromaniac;
    (&perk_choice_ids)[iVar5] = iVar1;
    if (iVar1 == iVar2) {
      if (player_health._pad0._668_4_ != 8) goto LAB_00404603;
    }
    iVar2 = perk_count_get(perk_id_death_clock);
    if (((iVar2 == 0) ||
        ((((((iVar2 = (&perk_choice_ids)[iVar5], iVar2 != perk_id_jinxed &&
             (iVar2 != perk_id_breathing_room)) &&
            ((iVar2 != perk_id_grim_deal &&
             ((iVar2 != perk_id_highlander && (iVar2 != perk_id_fatal_lottery)))))) &&
           (iVar2 != DAT_004c2b8c)) &&
          (((iVar2 != perk_id_ammunition_within && (iVar2 != perk_id_infernal_contract)) &&
           (iVar2 != perk_id_regeneration)))) &&
         (((iVar2 != perk_id_greater_regeneration && (iVar2 != perk_id_thick_skinned)) &&
          (iVar2 != perk_id_bandage)))))) &&
       ((((iVar2 = (&perk_choice_ids)[iVar5], iVar2 != perk_id_jinxed &&
          (iVar2 != perk_id_ammunition_within)) &&
         ((iVar2 != perk_id_anxious_loader && (iVar2 != perk_id_monster_vision)))) ||
        (iVar2 = crt_rand(), ((byte)iVar2 & 3) != 1)))) {
      if ((10000 < iVar3) && (((&perk_flags_table)[(&perk_choice_ids)[iVar5] * 0x14] & 4) != 0))
      break;
      piVar4 = &perk_choice_ids;
      for (iVar2 = 0; iVar2 < iVar5; iVar2 = iVar2 + 1) {
        if (*piVar4 == (&perk_choice_ids)[iVar5]) goto LAB_00404603;
        piVar4 = piVar4 + 1;
      }
      if (((((&perk_flags_table)[(&perk_choice_ids)[iVar5] * 0x14] & 4) != 0) ||
          (*(int *)(player_health._pad0 + (&perk_choice_ids)[iVar5] * 4 + 0x94) < 1)) ||
         (29999 < iVar3)) break;
    }
  } while( true );
  if (24999 < iVar3) {
    console_printf(&console_log_queue,s_Perk_Randomizer_failed_to_genera_00471afc);
  }
  iVar5 = iVar5 + 1;
  if (6 < iVar5) {
    if (config_blob.reserved0._24_4_ == 8) {
      perk_choice_ids = perk_id_sharpshooter;
      DAT_004807ec = perk_id_long_distance_runner;
      _DAT_004807f0 = perk_id_evil_eyes;
      _DAT_004807f4 = perk_id_radioactive;
      _DAT_004807f8 = perk_id_fastshot;
      _DAT_004807fc = perk_id_fastshot;
      _DAT_00480800 = perk_id_fastshot;
    }
    return;
  }
  goto LAB_004045be;
}



/* demo_trial_overlay_render @ 004047c0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders the demo trial warning panel and remaining time message */

void __cdecl demo_trial_overlay_render(float *xy,float alpha)

{
  IGrim2D_vtbl *pIVar1;
  IGrim2D *self;
  int iVar2;
  int iVar3;
  int unaff_EBX;
  float unaff_EBP;
  int iVar4;
  float unaff_ESI;
  float unaff_EDI;
  float x;
  int in_stack_fffffedc;
  float in_stack_fffffee0;
  char *pcVar5;
  float in_stack_fffffee4;
  uint value;
  IGrim2D *in_stack_fffffee8;
  float in_stack_fffffeec;
  undefined4 local_110;
  undefined4 local_10c;
  float local_108;
  float local_104;
  float fStack_100;
  float fStack_fc;
  float fStack_f8;
  char acStack_e4 [128];
  char acStack_64 [100];
  
  local_104 = alpha * 0.8;
  DAT_00480850 = 1;
  local_110 = 0;
  local_10c = 0;
  local_108 = 0.0;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            ((IGrim2D *)xy,(float *)0x44000000,256.0,(float)&local_110);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,alpha,unaff_EDI);
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            ((IGrim2D *)xy,(float *)0x44000000,256.0,unaff_ESI);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_EBP);
  pIVar1 = grim_interface_ptr->vtable;
  self = (IGrim2D *)(*pIVar1->grim_get_texture_handle)((IGrim2D *)s_cl_logo_00471f70,(char *)0x0);
  (*pIVar1->grim_bind_texture)(self,unaff_EBX,in_stack_fffffedc);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,in_stack_fffffee0);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(*xy + 72.0),xy[1] + 22.0,371.2,46.4,in_stack_fffffee4);
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_fffffee8);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,*xy + 131.0,xy[1] + 9.0,s_You_ve_been_playing_the_Demo_ver_00471f48)
  ;
  value = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,alpha,in_stack_fffffeec);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,value);
  local_108 = *xy + 26.0;
  local_104 = xy[1] + 80.0;
  iVar2 = FUN_0041df50();
  iVar2 = iVar2 - game_status_blob.game_sequence_id;
  if (0 < DAT_0048084c) {
    iVar2 = 300000 - DAT_0048084c;
  }
  iVar4 = (iVar2 / 1000) / 0x3c;
  iVar3 = (int)((ulonglong)((longlong)iVar4 * 0x77777777) >> 0x20) - iVar4;
  iVar4 = iVar4 + ((iVar3 >> 5) - (iVar3 >> 0x1f)) * 0x3c;
  iVar3 = iVar2 / 1000 + iVar4 * -0x3c;
  iVar2 = (iVar2 + (iVar4 * 0x3c + iVar3) * -1000) / 10;
  if (iVar4 < 0) {
    iVar3 = 0;
    iVar2 = 0;
    pcVar5 = &DAT_00471f44;
    iVar4 = 0;
  }
  else if (iVar3 < 10) {
    pcVar5 = &DAT_00471f44;
  }
  else {
    pcVar5 = &DAT_00471f40;
  }
  crt_sprintf(acStack_64,pcVar5,iVar3);
  if (iVar2 < 10) {
    pcVar5 = s__d__s_0_d_00471f34;
  }
  else {
    pcVar5 = s__d__s__d_00471f28;
  }
  crt_sprintf(acStack_e4,pcVar5,iVar4,acStack_64,iVar2);
  iVar2 = game_is_full_version();
  if ((((char)iVar2 == '\0') && (config_blob.reserved0._24_4_ != 8)) &&
     (game_status_blob.game_sequence_id = game_sequence_get(), x = local_108,
     (int)game_status_blob.game_sequence_id < 0x249f01)) {
    if (DAT_0048084c < 1) {
      if (config_blob.reserved0._24_4_ == 3) goto LAB_00404b1b;
    }
    else if ((config_blob.reserved0._24_4_ == 3) &&
            (fStack_100 = (float)(DAT_0048084c / 1000), (float)(int)fStack_100 * 0.016666668 <= 5.0)
            ) {
LAB_00404b1b:
      if ((game_state_id == 9) && ((1 < _quest_stage_major || (10 < _quest_stage_minor)))) {
        local_104 = local_104 - 6.0;
        if (DAT_0048084c < 1) {
          (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                    (grim_interface_ptr,local_108,local_104,
                     s_You_ve_completed_all_Quest_mode_l_00471ee0);
          local_104 = local_104 + 18.0;
          (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                    (grim_interface_ptr,x,local_104,s_However__you_still_have__s_time_l_00471e94,
                     acStack_e4);
          local_104 = local_104 + 18.0;
          (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                    (grim_interface_ptr,x,local_104,&DAT_0047f4d8);
          local_104 = local_104 + 14.0;
        }
        else {
          local_104 = local_104 + 6.0;
          (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                    (grim_interface_ptr,local_108,local_104,
                     s_You_ve_completed_all_Quest_mode_l_00471ee0);
          local_104 = local_104 + 18.0;
        }
        (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                  (grim_interface_ptr,x,local_104,s_If_you_would_like_to_have_unlimi_00471e48);
        local_104 = local_104 + 18.0;
        (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                  (grim_interface_ptr,x,local_104,s_please_upgrade_to_the_full_versi_00471e14);
        local_104 = local_104 + 22.0;
        (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                  (grim_interface_ptr,x,local_104,s_The_full_version_features_unrest_00471ddc);
        local_104 = local_104 + 18.0;
        (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                  (grim_interface_ptr,x,local_104,s_game_modes_and_be_able_to_post_y_00471d94);
        local_104 = local_104 + 18.0;
        goto LAB_00404ee5;
      }
    }
  }
  x = local_108;
  if ((iVar4 < 1) && (iVar3 < 1)) {
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,local_108,local_104,s_Trial_time_is_up__If_you_would_l_00471d44);
    local_104 = local_104 + 18.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,x,local_104,s_all_features__please_upgrade_to_t_00471cf4);
    local_104 = local_104 + 18.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,x,local_104,s_is_very_easy_and_takes_just_minu_00471ccc);
    local_104 = local_104 + 24.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,x,local_104,s_Buy_the_full_version_to_gain_unr_00471c90);
    local_104 = local_104 + 18.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,x,local_104,s_game_modes_and_be_able_to_post_y_00471d94);
    local_104 = local_104 + 18.0;
  }
  else {
    local_104 = local_104 - 7.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,local_108,local_104,s_You_have_used_up_your_play_time_i_00471c48,
               acStack_e4);
    local_104 = local_104 + 16.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,x,local_104,s_have__s_time_left_to_play_Quest_m_00471c14,
               acStack_e4);
    local_104 = local_104 + 22.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,x,local_104,s_If_you_would_like_to_have_unlimi_00471e48);
    local_104 = local_104 + 16.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,x,local_104,s_please_upgrade_to_the_full_versi_00471bc4);
    local_104 = local_104 + 16.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,x,local_104,s_and_takes_just_minutes__00471ba8);
    local_104 = local_104 + 22.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,x,local_104,s_Buy_the_full_version_to_gain_unr_00471c90);
    local_104 = local_104 + 16.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,x,local_104,s_game_modes_and_be_able_to_post_y_00471d94);
    local_104 = local_104 + 16.0;
  }
LAB_00404ee5:
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,x,local_104,s_it_now__You_ll_have_a_great_time_00471b84);
  if ((DAT_0047f62c & 1) == 0) {
    DAT_0047f62c = DAT_0047f62c | 1;
    ui_button_maybe_later.enabled = '\x01';
    ui_button_maybe_later.force_wide = '\0';
    ui_button_maybe_later.force_small = '\0';
    ui_button_maybe_later.alpha = 1.0;
    ui_button_maybe_later.click_anim = 0;
    ui_button_maybe_later.label = (char *)0x0;
    ui_button_maybe_later.hovered = '\0';
    ui_button_maybe_later.activated = '\0';
    ui_button_maybe_later.hover_anim = 0;
    crt_atexit(&DAT_00405150);
  }
  ui_button_maybe_later.label = s_Maybe_later_00471b78;
  if ((DAT_0047f62c & 2) == 0) {
    DAT_0047f62c = DAT_0047f62c | 2;
    ui_button_table_a.enabled = '\x01';
    ui_button_table_a.force_wide = '\0';
    ui_button_table_a.force_small = '\0';
    ui_button_table_a.alpha = 1.0;
    ui_button_table_a.click_anim = 0;
    ui_button_table_a.label = (char *)0x0;
    ui_button_table_a.hovered = '\0';
    ui_button_table_a.activated = '\0';
    ui_button_table_a.hover_anim = 0;
    crt_atexit(&DAT_00405140);
  }
  ui_button_table_a.label = s_Purchase_00471b6c;
  if ((DAT_0047f62c & 4) == 0) {
    DAT_0047f62c = DAT_0047f62c | 4;
    ui_button_already_paid.enabled = '\x01';
    ui_button_already_paid.force_wide = '\0';
    ui_button_already_paid.force_small = '\0';
    ui_button_already_paid.alpha = 1.0;
    ui_button_already_paid.click_anim = 0;
    ui_button_already_paid.label = (char *)0x0;
    ui_button_already_paid.hovered = '\0';
    ui_button_already_paid.activated = '\0';
    ui_button_already_paid.hover_anim = 0;
    crt_atexit(&DAT_00405130);
  }
  ui_button_already_paid.label = s_Already_paid_00471b5c;
  fStack_fc = *xy + 22.0;
  local_108 = fStack_fc + 6.0;
  local_104 = xy[1] + 212.0 + 6.0;
  fStack_100 = local_104;
  iVar2 = ui_button_update(&local_108,&ui_button_table_a);
  if ((char)iVar2 != '\0') {
    shareware_offer_seen_latch = 1;
    DAT_0047ea50 = 1;
    ShellExecuteA((HWND)0x0,&DAT_00471b38,s_http___buy_crimsonland_com_00471b40,(LPCSTR)0x0,
                  (LPCSTR)0x0,1);
  }
  fStack_fc = fStack_fc + 326.0;
  fStack_f8 = fStack_100;
  iVar2 = ui_button_update(&fStack_fc,&ui_button_maybe_later);
  if ((char)iVar2 != '\0') {
    ui_transition_direction = 0;
    game_state_pending = 0;
    render_pass_mode = 0;
    sfx_mute_all(music_track_intro_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    sfx_play_exclusive(music_track_crimson_theme_id);
  }
  return;
}



/* ui_render_keybind_help @ 00405160 */

/* renders the in-game key bindings help overlay */

void __cdecl ui_render_keybind_help(float *xy,float alpha)

{
  float *pfVar1;
  IGrim2D_vtbl *pIVar2;
  float fVar3;
  char *pcVar4;
  float unaff_ESI;
  float unaff_EDI;
  uint uVar5;
  float fVar6;
  float fStack_1c;
  float fStack_18;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  float local_4;
  
  local_4 = alpha * 0.8;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            ((IGrim2D *)xy,(float *)0x44000000,256.0,(float)&local_10);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,alpha,unaff_EDI);
  fVar6 = 256.0;
  uVar5 = 0x44000000;
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            ((IGrim2D *)xy,(float *)0x44000000,256.0,unaff_ESI);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f4ccccd,uVar5);
  (*grim_interface_ptr->vtable->grim_draw_text_mono_fmt)
            (grim_interface_ptr,*xy + 16.0,xy[1] + 16.0,s_key_info_00471ffc);
  uVar5 = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,alpha,fVar6);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,uVar5);
  fVar6 = *xy + 32.0;
  fVar3 = xy[1] + 50.0;
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,fVar6,fVar3,s_Level_Up__00471ff0);
  pIVar2 = grim_interface_ptr->vtable;
  pcVar4 = input_key_name(config_blob.key_pick_perk);
  (*pIVar2->grim_draw_text_small_fmt)
            (grim_interface_ptr,fVar6 + 128.0,fVar3,s__s_or_SPACE_BAR_or_KeyPadAdd_00471fd0,pcVar4);
  fVar3 = fVar3 + 18.0;
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,fVar6,fVar3,s_Reload__00471fc8);
  pIVar2 = grim_interface_ptr->vtable;
  pcVar4 = input_key_name(config_blob.key_reload);
  (*pIVar2->grim_draw_text_small_fmt)(grim_interface_ptr,fVar6 + 128.0,fVar3,&DAT_00471fc4,pcVar4);
  xy = (float *)0x0;
  fStack_18 = fVar3 + 18.0 + 20.0;
  fStack_1c = fVar6;
  do {
    if (xy == (float *)0x1) {
      fVar6 = fStack_1c + 256.0;
      fStack_1c = fVar6;
    }
    pfVar1 = (float *)((int)xy + 1);
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,fVar6,fStack_18,s_Player__d_00471fb8,pfVar1);
    fStack_18 = fStack_18 + 22.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,fVar6,fStack_18,&DAT_00471fb4);
    fVar3 = fStack_1c + 64.0;
    pIVar2 = grim_interface_ptr->vtable;
    pcVar4 = input_key_name(config_blob.keybinds_p1[(int)xy * 5]);
    (*pIVar2->grim_draw_text_small_fmt)(grim_interface_ptr,fVar3,fStack_18,&DAT_00471fc4,pcVar4);
    fStack_18 = fStack_18 + 16.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,fVar6,fStack_18,s_Down__00471fac);
    pIVar2 = grim_interface_ptr->vtable;
    pcVar4 = input_key_name(config_blob.keybinds_p1[(int)xy * 5 + 1]);
    (*pIVar2->grim_draw_text_small_fmt)(grim_interface_ptr,fVar3,fStack_18,&DAT_00471fc4,pcVar4);
    fStack_18 = fStack_18 + 16.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,fVar6,fStack_18,s_Left__00471fa4);
    pIVar2 = grim_interface_ptr->vtable;
    pcVar4 = input_key_name(config_blob.keybinds_p1[(int)xy * 5 + 2]);
    (*pIVar2->grim_draw_text_small_fmt)(grim_interface_ptr,fVar3,fStack_18,&DAT_00471fc4,pcVar4);
    fStack_18 = fStack_18 + 16.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,fVar6,fStack_18,s_Right__00471f9c);
    pIVar2 = grim_interface_ptr->vtable;
    pcVar4 = input_key_name(config_blob.keybinds_p1[(int)xy * 5 + 3]);
    (*pIVar2->grim_draw_text_small_fmt)(grim_interface_ptr,fVar3,fStack_18,&DAT_00471fc4,pcVar4);
    fStack_18 = fStack_18 + 16.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,fVar6,fStack_18,s_Fire__00471f94);
    pIVar2 = grim_interface_ptr->vtable;
    pcVar4 = input_key_name(config_blob.keybinds_p1[(int)xy * 5 + 4]);
    (*pIVar2->grim_draw_text_small_fmt)(grim_interface_ptr,fVar3,fStack_18,&DAT_00471fc4,pcVar4);
    if (xy == (float *)0x0) {
      fStack_18 = fStack_18 - 94.0;
    }
    xy = pfVar1;
  } while ((int)pfVar1 < 2);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,fStack_1c - 20.0,fStack_18 + 32.0,
             s_Press_F1_to_return_to_game_00471f78);
  return;
}



/* perk_apply @ 004055e0 */

/* applies perk effects and increments perk counter */

void __cdecl perk_apply(int perk_id)

{
  float fVar1;
  uint uVar2;
  float *pfVar3;
  int iVar4;
  uchar *puVar5;
  player_state_t *ppVar6;
  creature_t *pcVar7;
  int iVar8;
  bool bVar9;
  longlong lVar10;
  
  sfx_play(sfx_ui_bonus);
  bVar9 = perk_id == perk_id_instant_winner;
  *(int *)(player_health._pad0 + perk_id * 4 + 0x94) =
       *(int *)(player_health._pad0 + perk_id * 4 + 0x94) + 1;
  iVar4 = config_blob.reserved0._20_4_;
  if (bVar9) {
    player_health._pad0._136_4_ = player_health._pad0._136_4_ + 0x9c4;
  }
  else if (perk_id == perk_id_fatal_lottery) {
    uVar2 = crt_rand();
    iVar4 = config_blob.reserved0._20_4_;
    if ((uVar2 & 1) == 0) {
      player_health._pad0._136_4_ = player_health._pad0._136_4_ + 10000;
    }
    else {
      player_health._pad0[0] = '\0';
      player_health._pad0[1] = '\0';
      player_health._pad0[2] = 0x80;
      player_health._pad0[3] = 0xbf;
    }
  }
  else if (perk_id == perk_id_lifeline_50_50) {
    bVar9 = false;
    pcVar7 = &creature_pool;
    do {
      if ((((bVar9) && (pcVar7->active != '\0')) && (pcVar7->health <= 500.0)) &&
         ((pcVar7->flags & 4) == 0)) {
        pcVar7->active = '\0';
        effect_spawn_burst(&pcVar7->pos_x,4);
      }
      pcVar7 = pcVar7 + 1;
      bVar9 = (bool)(bVar9 ^ 1);
      iVar4 = config_blob.reserved0._20_4_;
    } while ((int)pcVar7 < 0x4aa338);
  }
  else if (perk_id == perk_id_thick_skinned) {
    if (0 < (int)config_blob.reserved0._20_4_) {
      ppVar6 = &player_health;
      iVar8 = config_blob.reserved0._20_4_;
      do {
        if ((0.0 < *(float *)ppVar6->_pad0) &&
           (fVar1 = *(float *)ppVar6->_pad0 - *(float *)ppVar6->_pad0 * 0.33333334,
           *(float *)ppVar6->_pad0 = fVar1, fVar1 <= 0.0)) {
          ppVar6->_pad0[0] = '\0';
          ppVar6->_pad0[1] = '\0';
          ppVar6->_pad0[2] = 0x80;
          ppVar6->_pad0[3] = '?';
        }
        ppVar6 = ppVar6 + 1;
        iVar8 = iVar8 + -1;
      } while (iVar8 != 0);
    }
  }
  else if (perk_id == perk_id_breathing_room) {
    if (0 < (int)config_blob.reserved0._20_4_) {
      ppVar6 = &player_health;
      iVar8 = config_blob.reserved0._20_4_;
      do {
        iVar8 = iVar8 + -1;
        *(float *)ppVar6->_pad0 = *(float *)ppVar6->_pad0 - *(float *)ppVar6->_pad0 * 0.6666667;
        ppVar6 = ppVar6 + 1;
      } while (iVar8 != 0);
    }
    pfVar3 = &creature_pool.hitbox_size;
    do {
      if (((creature_t *)(pfVar3 + -4))->active != '\0') {
        *pfVar3 = *pfVar3 - frame_dt;
      }
      pfVar3 = pfVar3 + 0x26;
    } while ((int)pfVar3 < 0x4aa348);
    bonus_spawn_guard = 0;
  }
  else if (perk_id == perk_id_random_weapon) {
    iVar4 = 0;
    do {
      iVar8 = weapon_pick_random_available();
      iVar4 = iVar4 + 1;
      if ((iVar8 != 1) && (iVar8 != player_health._pad0._668_4_)) break;
    } while (iVar4 < 100);
    weapon_assign_player(0,iVar8);
    iVar4 = config_blob.reserved0._20_4_;
  }
  if (perk_id == perk_id_infernal_contract) {
    player_health._pad0._144_4_ = player_health._pad0._144_4_ + 3;
    perk_pending_count = perk_pending_count + 3;
    if (0.0 < (float)player_health._pad0._0_4_) {
      player_health._pad0[0] = 0xcd;
      player_health._pad0[1] = 0xcc;
      player_health._pad0[2] = 0xcc;
      player_health._pad0[3] = '=';
    }
    if (0.0 < player2_health) {
      player2_health = 0.1;
    }
  }
  if (perk_id == perk_id_grim_deal) {
    lVar10 = __ftol();
    player_health._pad0[0] = '\0';
    player_health._pad0[1] = '\0';
    player_health._pad0[2] = 0x80;
    player_health._pad0[3] = 0xbf;
    player_health._pad0._136_4_ = player_health._pad0._136_4_ + (int)lVar10;
  }
  if ((perk_id == perk_id_ammo_maniac) && (iVar8 = 0, 0 < iVar4)) {
    puVar5 = player_health._pad0 + 0x29c;
    do {
      weapon_assign_player(iVar8,*(int *)puVar5);
      iVar8 = iVar8 + 1;
      puVar5 = puVar5 + 0x360;
      iVar4 = config_blob.reserved0._20_4_;
    } while (iVar8 < (int)config_blob.reserved0._20_4_);
  }
  iVar8 = perk_id_regeneration;
  if (perk_id == perk_id_death_clock) {
    puVar5 = player_health._pad0 + perk_id_greater_regeneration * 4 + 0x94;
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = player_health._pad0 + iVar8 * 4 + 0x94;
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    if (0 < iVar4) {
      ppVar6 = &player_health;
      iVar8 = iVar4;
      do {
        if (0.0 < *(float *)ppVar6->_pad0) {
          ppVar6->_pad0[0] = '\0';
          ppVar6->_pad0[1] = '\0';
          ppVar6->_pad0[2] = 200;
          ppVar6->_pad0[3] = 'B';
        }
        ppVar6 = ppVar6 + 1;
        iVar8 = iVar8 + -1;
      } while (iVar8 != 0);
    }
  }
  if ((perk_id == perk_id_bandage) && (iVar8 = 0, 0 < iVar4)) {
    ppVar6 = &player_health;
    do {
      iVar4 = crt_rand();
      fVar1 = ((float)(iVar4 % 0x32) + 1.0) * *(float *)ppVar6->_pad0;
      *(float *)ppVar6->_pad0 = fVar1;
      if (100.0 < fVar1) {
        ppVar6->_pad0[0] = '\0';
        ppVar6->_pad0[1] = '\0';
        ppVar6->_pad0[2] = 200;
        ppVar6->_pad0[3] = 'B';
      }
      effect_spawn_burst((float *)(ppVar6[-1]._pad1 + 0x14),8);
      iVar8 = iVar8 + 1;
      ppVar6 = ppVar6 + 1;
      iVar4 = config_blob.reserved0._20_4_;
    } while (iVar8 < (int)config_blob.reserved0._20_4_);
  }
  if ((perk_id == perk_id_my_favourite_weapon) && (0 < iVar4)) {
    puVar5 = player_health._pad0 + 0x2a0;
    do {
      iVar4 = iVar4 + -1;
      *(float *)puVar5 = *(float *)puVar5 + 2.0;
      puVar5 = puVar5 + 0x360;
    } while (iVar4 != 0);
  }
  if (perk_id == perk_id_plaguebearer) {
    player_plaguebearer_active = 1;
  }
  return;
}



/* gameplay_render_world @ 00405960 */

/* world render pass: updates gameplay fade and draws fx queue, creatures, players, projectiles,
   bonuses */

void gameplay_render_world(void)

{
  float a;
  int player_index;
  uchar *puVar1;
  
  a = (float)(DAT_0048eb48 - DAT_0048eb4c);
  ui_transition_alpha = (float)ui_elements_timeline / (float)(int)a;
  if (quest_unlock_index_full < 0x28) {
    if (player_health._pad0._668_4_ == 0x1d) {
      weapon_assign_player(0,1);
    }
    if (player2_weapon_id == 0x1d) {
      weapon_assign_player(1,1);
    }
  }
  player_index = 0;
  puVar1 = player_health._pad0 + 0x29c;
  do {
    if ((*(int *)puVar1 == 0x19) && (DAT_00486fb8 != 0x19)) {
      weapon_assign_player(player_index,1);
    }
    if ((*(int *)puVar1 == 0x18) && (DAT_00486fb8 != 0x18)) {
      weapon_assign_player(player_index,1);
    }
    puVar1 = puVar1 + 0x360;
    player_index = player_index + 1;
  } while ((int)puVar1 < 0x491230);
  if (DAT_00487241 == '\0') {
    if (((game_state_id == 9) || (game_state_id == 6)) ||
       ((((game_state_id == 8 || ((game_state_id == 0xc || (game_state_id == 7)))) &&
         (ui_transition_direction != '\0')) ||
        ((((game_state_pending == 9 || (game_state_pending == 6)) || (game_state_pending == 5)) ||
         ((game_state_pending == 2 || (game_state_pending == 3)))))))) {
LAB_00405a7f:
      ui_transition_alpha = 1.0;
      goto LAB_00405a89;
    }
    if (game_state_id != 5) {
      if (((game_state_id != 2) && (game_state_id != 3)) &&
         ((game_state_pending != 0x15 &&
          (((game_state_pending != 7 && (game_state_pending != 8)) && (game_state_pending != 0xc))))
         )) goto LAB_00405a89;
      goto LAB_00405a7f;
    }
    if (game_state_pending != 0) goto LAB_00405a7f;
  }
  else {
LAB_00405a89:
    if ((game_state_id != 5) || (game_state_pending != 0)) goto LAB_00405ab3;
  }
  a = (float)(DAT_0048eb48 - DAT_0048eb4c);
  ui_transition_alpha = (float)ui_elements_timeline / (float)(int)a;
LAB_00405ab3:
  if (ui_transition_alpha <= 1.0) {
    if (ui_transition_alpha < 0.0) {
      ui_transition_alpha = 0.0;
    }
  }
  else {
    ui_transition_alpha = 1.0;
  }
  fx_queue_render();
  terrain_render();
  render_overlay_player_index = 0;
  if (0 < (int)config_blob.reserved0._20_4_) {
    do {
      if (*(float *)(&player_health)[render_overlay_player_index]._pad0 <= 0.0) {
        player_render_overlays();
      }
      render_overlay_player_index = render_overlay_player_index + 1;
    } while (render_overlay_player_index < (int)config_blob.reserved0._20_4_);
  }
  creature_render_all();
  render_overlay_player_index = 0;
  if (0 < (int)config_blob.reserved0._20_4_) {
    do {
      if (0.0 < *(float *)(&player_health)[render_overlay_player_index]._pad0) {
        player_render_overlays();
      }
      render_overlay_player_index = render_overlay_player_index + 1;
    } while (render_overlay_player_index < (int)config_blob.reserved0._20_4_);
  }
  projectile_render();
  bonus_render();
  if (0.0 < screen_fade_alpha) {
    (*grim_interface_ptr->vtable->grim_draw_fullscreen_color)
              ((IGrim2D *)0x0,0.0,0.0,screen_fade_alpha,a);
  }
  return;
}



/* perk_selection_screen_update @ 00405be0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* perk selection screen: list choices, preview text, and selection handling */

void perk_selection_screen_update(void)

{
  int x;
  undefined4 *puVar1;
  int iVar2;
  float unaff_EBX;
  float unaff_EBP;
  int *piVar3;
  float unaff_ESI;
  int *item;
  float unaff_EDI;
  longlong lVar4;
  float unaff_retaddr;
  int y;
  int w;
  uint value;
  char *text;
  undefined4 uStack_1c;
  float local_18;
  float local_14;
  float local_10;
  float local_c;
  float fStack_8;
  float local_4;
  
  gameplay_render_world();
  ui_elements_update_and_render();
  local_4 = _DAT_0048c634 + DAT_0048c658;
  local_14 = local_4 + 40.0;
  local_18 = _DAT_0048c620 + DAT_0048c654 + _DAT_0048c630 + 180.0 + 44.0;
  local_10 = local_18;
  local_c = local_14;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_EDI);
  w = 0x20;
  y = 0x80;
  iVar2 = DAT_0048f800;
  lVar4 = __ftol();
  x = (int)lVar4;
  lVar4 = __ftol();
  ui_draw_textured_quad((int)lVar4,x,y,w,iVar2);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.5,unaff_ESI);
  if (*(int *)(player_health._pad0 + perk_id_perk_master * 4 + 0x94) < 1) {
    if (0 < *(int *)(player_health._pad0 + perk_id_perk_expert * 4 + 0x94)) {
      (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                (grim_interface_ptr,local_10 - 26.0,local_c - 8.0,
                 s_extra_perk_sponsored_by_the_Perk_00472018);
      uStack_1c = 0;
    }
  }
  else {
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,local_10 - 28.0,local_c - 8.0,
               s_extra_perks_sponsored_by_the_Per_00472040);
    uStack_1c = 0;
  }
  if (*(int *)(player_health._pad0 + perk_id_perk_expert * 4 + 0x94) < 1) {
    local_c = local_c + 50.0;
  }
  else {
    local_c = local_c + 40.0;
    local_18 = 18.0;
  }
  if ((DAT_004807c8 & 1) == 0) {
    DAT_004807c8 = DAT_004807c8 | 1;
    _DAT_00480298 = 0x3e8c8c8d;
    _DAT_0048029c = 0x3f34b4b5;
    _DAT_004802a0 = 0x3f70f0f1;
    _DAT_004802a4 = 0x3f19999a;
    crt_atexit(&DAT_00406170);
  }
  if ((DAT_004807c8 & 2) == 0) {
    DAT_004807c8 = DAT_004807c8 | 2;
    _DAT_00480310 = 0x3e8c8c8d;
    _DAT_00480314 = 0x3f34b4b5;
    _DAT_00480318 = 0x3f70f0f1;
    _DAT_0048031c = 0x3f800000;
    crt_atexit(&DAT_00406160);
  }
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_EBP);
  if ((DAT_004807c8 & 4) == 0) {
    DAT_004807c8 = DAT_004807c8 | 4;
    iVar2 = 10;
    puVar1 = &DAT_004800b4;
    do {
      *(undefined1 *)((int)puVar1 + -6) = 1;
      *puVar1 = 0x3f800000;
      puVar1[-3] = 0;
      *(undefined1 *)(puVar1 + -2) = 0;
      *(undefined1 *)((int)puVar1 + -7) = 0;
      puVar1[-1] = 0;
      puVar1 = puVar1 + 4;
      iVar2 = iVar2 + -1;
    } while (iVar2 != 0);
    crt_atexit(&DAT_00406150);
  }
  iVar2 = 0;
  if (0 < (int)local_18) {
    item = &DAT_004800a8;
    piVar3 = &perk_choice_ids;
    do {
      *item = (&perk_name_table)[*piVar3 * 5];
      ui_menu_item_update(&local_c,item);
      if ((char)item[1] != '\0') {
        uStack_1c = 0x1000000;
        DAT_0048089c = iVar2;
      }
      fStack_8 = fStack_8 + local_14;
      iVar2 = iVar2 + 1;
      piVar3 = piVar3 + 1;
      item = item + 4;
    } while (iVar2 < (int)local_18);
  }
  fStack_8 = fStack_8 + 32.0;
  if (5 < (int)local_18) {
    fStack_8 = fStack_8 - 20.0;
  }
  local_c = local_c - 28.0;
  text = (char *)0x3f800000;
  value = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_EBX);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,value);
  (*grim_interface_ptr->vtable->grim_draw_text_small)
            ((IGrim2D *)(local_10 + 16.0),local_c,
             *(float *)(&perk_desc_table + (&perk_choice_ids)[DAT_0048089c] * 0x14),text);
  if ((DAT_004807c8 & 8) == 0) {
    DAT_004807c8 = DAT_004807c8 | 8;
    DAT_00480096 = 1;
    DAT_004800a5 = 0;
    DAT_004800a4 = 0;
    _DAT_004800a0 = 0x3f800000;
    _DAT_0048009c = 0;
    _DAT_00480090 = (char *)0x0;
    DAT_00480094 = 0;
    DAT_00480095 = 0;
    _DAT_00480098 = 0;
    crt_atexit(&DAT_00406140);
  }
  _DAT_00480090 = s_Cancel_00472010;
  if ((DAT_004807c8 & 0x10) == 0) {
    DAT_004807c8 = DAT_004807c8 | 0x10;
    DAT_00480826 = 1;
    DAT_00480835 = 0;
    DAT_00480834 = 0;
    _DAT_00480830 = 0x3f800000;
    _DAT_0048082c = 0;
    _DAT_00480820 = (char *)0x0;
    DAT_00480824 = 0;
    DAT_00480825 = 0;
    _DAT_00480828 = 0;
    crt_atexit(&DAT_00406130);
  }
  local_14 = local_4 + 162.0;
  _DAT_00480820 = s_Select_00472008;
  local_10 = unaff_retaddr + 276.0;
  iVar2 = ui_button_update(&local_14,(ui_button_t *)&DAT_00480090);
  if ((char)iVar2 != '\0') {
    ui_transition_direction = 0;
    game_state_pending = 9;
  }
  perk_prompt_update_and_render();
  ui_cursor_render();
  if (((uStack_1c._3_1_ != '\0') && (-1 < DAT_0048089c)) &&
     ((&DAT_004800ad)[DAT_0048089c * 0x10] != '\0')) {
    sfx_play(sfx_ui_buttonclick);
    perk_apply((&perk_choice_ids)[DAT_0048089c]);
    perk_pending_count = perk_pending_count + -1;
    ui_transition_direction = 0;
    game_state_pending = 9;
    perk_choices_dirty = 1;
  }
  return;
}



/* format_ordinal @ 00406180 */

/* formats an integer as an English ordinal (e.g. 1st/2nd/3rd/4th) into a global scratch buffer */

char * format_ordinal(int n)

{
  int iVar1;
  undefined *puVar2;
  
  if ((n < 8) || (0x14 < n)) {
    iVar1 = n % 10;
    if (iVar1 != 0) {
      if (iVar1 == 1) {
        puVar2 = &DAT_00472080;
        goto LAB_004061c7;
      }
      if (iVar1 == 2) {
        puVar2 = &DAT_0047207c;
        goto LAB_004061c7;
      }
      if (iVar1 == 3) {
        puVar2 = &DAT_00472078;
        goto LAB_004061c7;
      }
    }
  }
  puVar2 = &DAT_00472074;
LAB_004061c7:
  crt_sprintf(&DAT_004802c8,&DAT_0047206c,n,puVar2);
  return &DAT_004802c8;
}



/* ui_draw_clock_gauge @ 004061e0 */

/* draws the 32x32 clock gauge at the current transform */

void ui_draw_clock_gauge(void)

{
  float x;
  IGrim2D *unaff_EBX;
  float unaff_ESI;
  float unaff_EDI;
  float unaff_retaddr;
  int stage;
  IGrim2D *in_stack_00000004;
  float in_stack_00000008;
  float in_stack_0000000c;
  IGrim2D *in_stack_00000010;
  int in_stack_00000014;
  float fStack0000001c;
  int in_stack_00000020;
  int iStack00000024;
  uint in_stack_ffffffe8;
  int in_stack_ffffffec;
  float in_stack_fffffff0;
  uint value;
  
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,in_stack_ffffffe8);
  (*grim_interface_ptr->vtable->grim_bind_texture)(ui_clock_table_texture,0,in_stack_ffffffec);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,in_stack_fffffff0);
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000010,unaff_EDI);
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,unaff_ESI);
  (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_EBX);
  x = (float)in_stack_00000014;
  value = 0x42000000;
  fStack0000001c = x;
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(float)(int)in_stack_00000010,x,32.0,32.0,unaff_retaddr);
  stage = 0x4062ad;
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000004);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,value);
  (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7cc,0,stage);
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_00000004);
  iStack00000024 = in_stack_00000020 / 1000;
  (*grim_interface_ptr->vtable->grim_set_rotation)
            ((IGrim2D *)((float)iStack00000024 * 0.10471976),in_stack_00000008);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(float)(int)in_stack_00000010,x,32.0,32.0,in_stack_0000000c);
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000010);
  return;
}



/* FUN_00406350 @ 00406350 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_406350() */

int FUN_00406350(void)

{
  float fVar1;
  int extraout_EAX;
  IGrim2D_vtbl *pIVar2;
  float unaff_EBX;
  char *fmt;
  float value;
  char *fmt_00;
  float fVar3;
  
  gameplay_render_world();
  ui_elements_update_and_render();
  fVar3 = 1.0;
  value = 1.0;
  fVar1 = _DAT_0048dbc8 + DAT_0048dbfc + _DAT_0048dbd8 + 180.0;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_EBX);
  if (DAT_00487234 == -1) {
    DAT_00487234 = 0;
  }
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f4ccccd,(uint)value);
  if (config_blob.hardcore == '\0') {
    fmt_00 = s_Congratulations__004722c8;
  }
  else {
    fmt_00 = s_Incredible__004722b8;
  }
  (*grim_interface_ptr->vtable->grim_draw_text_mono_fmt)
            (grim_interface_ptr,unaff_EBX,(fVar1 + 44.0) - 10.0,fmt_00);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,(uint)unaff_EBX);
  if (config_blob.hardcore == '\0') {
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)fmt_00,fVar3,s_You_ve_completed_all_the_levels_b_00472288);
    fVar3 = fVar3 + 14.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)fmt_00,fVar3,s_isn_t_over_yet__With_all_of_the_u_00472258);
    fVar3 = fVar3 + 14.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)fmt_00,fVar3,s_and_weapons_your_Survival_is_jus_00472228);
    fVar3 = fVar3 + 14.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)fmt_00,fVar3,s_You_can_also_replay_the_quests_i_004721fc);
    fVar3 = fVar3 + 14.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)fmt_00,fVar3,s_As_an_additional_reward_for_your_004721d0);
    fVar3 = fVar3 + 14.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)fmt_00,fVar3,s_playing__a_completely_new_and_di_004721a0);
    fmt = s_mode_is_unlocked_for_you__Typ_o__00472174;
    pIVar2 = grim_interface_ptr->vtable;
  }
  else {
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)fmt_00,fVar3,s_You_ve_done_the_thing_we_all_tho_00472148);
    fVar3 = fVar3 + 14.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)fmt_00,fVar3,s_virtually_impossible__To_reward_y_00472120);
    fVar3 = fVar3 + 14.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)fmt_00,fVar3,s_efforts_a_new_weapon_has_been_un_004720f8);
    fVar3 = fVar3 + 14.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)fmt_00,fVar3,s_for_you__Splitter_Gun__004720e0);
    fVar3 = fVar3 + 14.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)fmt_00,fVar3,&DAT_0047f4d8);
    fmt = &DAT_0047f4d8;
    pIVar2 = grim_interface_ptr->vtable;
  }
  fVar3 = fVar3 + 14.0;
  (*pIVar2->grim_draw_text_small_fmt)(grim_interface_ptr,(float)fmt_00,fVar3,fmt);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,(float)fmt_00,fVar3 + 14.0 + 8.0,
             s_Good_luck_with_your_battles__tro_004720b8);
  if ((DAT_00480321 & 1) == 0) {
    DAT_00480321 = DAT_00480321 | 1;
    DAT_0047f5e6 = 1;
    DAT_0047f5f5 = 0;
    DAT_0047f5f4 = 0;
    _DAT_0047f5f0 = 0x3f800000;
    _DAT_0047f5ec = 0;
    _DAT_0047f5e0 = (char *)0x0;
    DAT_0047f5e4 = 0;
    DAT_0047f5e5 = '\0';
    _DAT_0047f5e8 = 0;
    crt_atexit(&DAT_00406ae0);
  }
  _DAT_0047f5e0 = s_Survival_004720ac;
  if ((DAT_00480321 & 2) == 0) {
    DAT_00480321 = DAT_00480321 | 2;
    DAT_00480286 = 1;
    DAT_00480295 = 0;
    DAT_00480294 = 0;
    _DAT_00480290 = 0x3f800000;
    _DAT_0048028c = 0;
    _DAT_00480280 = (char *)0x0;
    DAT_00480284 = 0;
    DAT_00480285 = '\0';
    _DAT_00480288 = 0;
    crt_atexit(&DAT_00406ad0);
  }
  _DAT_00480280 = s_Rush_004720a0;
  if ((DAT_00480321 & 4) == 0) {
    DAT_00480321 = DAT_00480321 | 4;
    DAT_0048032e = 1;
    DAT_0048033d = 0;
    DAT_0048033c = 0;
    _DAT_00480338 = 0x3f800000;
    _DAT_00480334 = 0;
    _DAT_00480328 = (char *)0x0;
    DAT_0048032c = 0;
    DAT_0048032d = '\0';
    _DAT_00480330 = 0;
    crt_atexit(&DAT_00406ac0);
  }
  _DAT_00480328 = s_Typ_o_Shooter_00472090;
  if ((DAT_00480321 & 8) == 0) {
    DAT_00480321 = DAT_00480321 | 8;
    DAT_0048026e = 1;
    DAT_0048027d = 0;
    DAT_0048027c = 0;
    _DAT_00480278 = 0x3f800000;
    _DAT_00480274 = 0;
    _DAT_00480268 = (char *)0x0;
    DAT_0048026c = 0;
    DAT_0048026d = '\0';
    _DAT_00480270 = 0;
    crt_atexit(&DAT_00406ab0);
  }
  _DAT_00480268 = s_Main_Menu_00472084;
  ui_button_update((float *)&stack0xffffffdc,(ui_button_t *)&DAT_0047f5e0);
  ui_button_update((float *)&stack0xffffffdc,(ui_button_t *)&DAT_00480280);
  ui_button_update((float *)&stack0xffffffdc,(ui_button_t *)&DAT_00480328);
  ui_button_update((float *)&stack0xffffffdc,(ui_button_t *)&DAT_00480268);
  if (DAT_00480285 != '\0') {
    ui_transition_direction = 0;
    game_state_pending = 9;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    config_blob.reserved0[0x18] = '\x02';
    config_blob.reserved0[0x19] = '\0';
    config_blob.reserved0[0x1a] = '\0';
    config_blob.reserved0[0x1b] = '\0';
  }
  if (DAT_0047f5e5 != '\0') {
    ui_transition_direction = 0;
    game_state_pending = 9;
    config_blob.reserved0[0x18] = '\x01';
    config_blob.reserved0[0x19] = '\0';
    config_blob.reserved0[0x1a] = '\0';
    config_blob.reserved0[0x1b] = '\0';
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
  }
  if (DAT_0048032d != '\0') {
    render_pass_mode = 0;
    ui_transition_direction = 0;
    game_state_pending = 0x12;
    config_blob.reserved0[0x18] = '\x04';
    config_blob.reserved0[0x19] = '\0';
    config_blob.reserved0[0x1a] = '\0';
    config_blob.reserved0[0x1b] = '\0';
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    DAT_0048702c = 1;
  }
  if (DAT_0048026d != '\0') {
    sfx_mute_all(music_track_extra_0);
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_play_exclusive(music_track_crimson_theme_id);
    ui_transition_direction = 0;
    game_state_pending = 0;
    ui_sign_crimson_update_disabled = 0;
  }
  ui_cursor_render();
  return extraout_EAX;
}



/* FUN_00406af0 @ 00406af0 */

/* [binja] int32_t sub_406af0() */

int FUN_00406af0(void)

{
  int extraout_EAX;
  float unaff_retaddr;
  
  if ((render_pass_mode == '\0') && (game_state_id != 5)) {
    terrain_render();
  }
  else {
    gameplay_render_world();
  }
  (*grim_interface_ptr->vtable->grim_draw_fullscreen_color)
            ((IGrim2D *)0x0,0.0,0.0,screen_fade_alpha,unaff_retaddr);
  ui_elements_update_and_render();
  perk_prompt_update_and_render();
  ui_cursor_render();
  return extraout_EAX;
}



/* perks_update_effects @ 00406b40 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* updates perk timers/effects (regen, shields, evil eyes, jinxed, bonus timers) */

void perks_update_effects(void)

{
  player_state_t *ppVar1;
  float *pos;
  int iVar2;
  uint uVar3;
  int iVar4;
  longlong lVar5;
  undefined4 *puVar6;
  float fVar7;
  undefined4 local_8;
  undefined4 local_4;
  
  iVar2 = perk_count_get(perk_id_regeneration);
  if (((iVar2 != 0) && (uVar3 = crt_rand(), (uVar3 & 1) != 0)) &&
     (iVar2 = config_blob.reserved0._20_4_, 0 < (int)config_blob.reserved0._20_4_)) {
    do {
      if ((((float)player_health._pad0._0_4_ < 100.0) && (0.0 < (float)player_health._pad0._0_4_))
         && (player_health._pad0._0_4_ = (float)player_health._pad0._0_4_ + frame_dt,
            100.0 < (float)player_health._pad0._0_4_)) {
        player_health._pad0._0_4_ = 100.0;
      }
      iVar2 = iVar2 + -1;
    } while (iVar2 != 0);
  }
  _DAT_004808a4 = _DAT_004808a4 - frame_dt;
  if (_DAT_004808a4 < 0.0) {
    _DAT_004808a4 = 0.25;
    if (0 < *(int *)(player_health._pad0 + perk_id_lean_mean_exp_machine * 4 + 0x94)) {
      player_health._pad0._136_4_ =
           player_health._pad0._136_4_ +
           *(int *)(player_health._pad0 + perk_id_lean_mean_exp_machine * 4 + 0x94) * 10;
    }
  }
  render_overlay_player_index = 0;
  if (0 < (int)config_blob.reserved0._20_4_) {
    do {
      iVar2 = perk_count_get(perk_id_death_clock);
      if (iVar2 != 0) {
        ppVar1 = &player_health + render_overlay_player_index;
        if (*(float *)(&player_health)[render_overlay_player_index]._pad0 <= 0.0) {
          ppVar1->_pad0[0] = '\0';
          ppVar1->_pad0[1] = '\0';
          ppVar1->_pad0[2] = '\0';
          ppVar1->_pad0[3] = '\0';
        }
        else {
          *(float *)ppVar1->_pad0 = *(float *)ppVar1->_pad0 - frame_dt * 3.3333333;
        }
      }
      if (*(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2f4) <= 0.0) {
        ppVar1 = &player_health + render_overlay_player_index;
        ppVar1->_pad0[0x2f4] = '\0';
        ppVar1->_pad0[0x2f5] = '\0';
        ppVar1->_pad0[0x2f6] = '\0';
        ppVar1->_pad0[0x2f7] = '\0';
      }
      else {
        *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2f4) =
             *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2f4) - frame_dt;
      }
      if (*(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2f8) <= 0.0) {
        ppVar1 = &player_health + render_overlay_player_index;
        ppVar1->_pad0[0x2f8] = '\0';
        ppVar1->_pad0[0x2f9] = '\0';
        ppVar1->_pad0[0x2fa] = '\0';
        ppVar1->_pad0[0x2fb] = '\0';
      }
      else {
        *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2f8) =
             *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2f8) - frame_dt;
      }
      if (*(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2f0) <= 0.0) {
        ppVar1 = &player_health + render_overlay_player_index;
        ppVar1->_pad0[0x2f0] = '\0';
        ppVar1->_pad0[0x2f1] = '\0';
        ppVar1->_pad0[0x2f2] = '\0';
        ppVar1->_pad0[0x2f3] = '\0';
      }
      else {
        *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2f0) =
             *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2f0) - frame_dt;
      }
      render_overlay_player_index = render_overlay_player_index + 1;
    } while (render_overlay_player_index < (int)config_blob.reserved0._20_4_);
  }
  DAT_00487268 = -1;
  if (((0 < *(int *)(player_health._pad0 + perk_id_doctor * 4 + 0x94)) ||
      (0 < *(int *)(player_health._pad0 + perk_id_pyrokinetic * 4 + 0x94))) ||
     (0 < *(int *)(player_health._pad0 + perk_id_evil_eyes * 4 + 0x94))) {
    player_health._pad0[0x2e8] = 0xff;
    player_health._pad0[0x2e9] = 0xff;
    player_health._pad0[0x2ea] = 0xff;
    player_health._pad0[0x2eb] = 0xff;
    iVar2 = creature_find_in_radius((float *)(player_health._pad0 + 0x2c),12.0,0);
    if (iVar2 != -1) {
      iVar4 = perk_count_get(perk_id_doctor);
      if (iVar4 != 0) {
        DAT_00487268 = iVar2;
      }
      iVar4 = perk_count_get(perk_id_pyrokinetic);
      if (iVar4 != 0) {
        fVar7 = (&creature_pool)[iVar2].collision_timer - frame_dt;
        (&creature_pool)[iVar2].collision_timer = fVar7;
        if (fVar7 < 0.0) {
          (&creature_pool)[iVar2].collision_timer = 0.5;
          pos = &(&creature_pool)[iVar2].pos_x;
          puVar6 = &local_8;
          fVar7 = 0.8;
          local_8 = 0;
          local_4 = 0;
          iVar4 = crt_rand();
          fx_spawn_particle(pos,(float)(iVar4 % 0x274) * 0.01,puVar6,fVar7);
          puVar6 = &local_8;
          local_8 = 0;
          local_4 = 0;
          fVar7 = 0.6;
          iVar4 = crt_rand();
          fx_spawn_particle(pos,(float)(iVar4 % 0x274) * 0.01,puVar6,fVar7);
          puVar6 = &local_8;
          local_8 = 0;
          local_4 = 0;
          fVar7 = 0.4;
          iVar4 = crt_rand();
          fx_spawn_particle(pos,(float)(iVar4 % 0x274) * 0.01,puVar6,fVar7);
          puVar6 = &local_8;
          local_8 = 0;
          local_4 = 0;
          fVar7 = 0.3;
          iVar4 = crt_rand();
          fx_spawn_particle(pos,(float)(iVar4 % 0x274) * 0.01,puVar6,fVar7);
          puVar6 = &local_8;
          local_8 = 0;
          local_4 = 0;
          fVar7 = 0.2;
          iVar4 = crt_rand();
          fx_spawn_particle(pos,(float)(iVar4 % 0x274) * 0.01,puVar6,fVar7);
          fx_queue_add_random(pos);
        }
      }
      iVar4 = perk_count_get(perk_id_evil_eyes);
      if (iVar4 != 0) {
        player_health._pad0._744_4_ = iVar2;
      }
    }
  }
  iVar2 = perk_count_get(perk_id_evil_eyes);
  if (iVar2 == 0) {
    player_health._pad0[0x2e8] = 0xff;
    player_health._pad0[0x2e9] = 0xff;
    player_health._pad0[0x2ea] = 0xff;
    player_health._pad0[0x2eb] = 0xff;
  }
  if (((_DAT_004aaf1c < 0.0) || (_DAT_004aaf1c = _DAT_004aaf1c - frame_dt, _DAT_004aaf1c < 0.0)) &&
     (0 < *(int *)(player_health._pad0 + perk_id_jinxed * 4 + 0x94))) {
    iVar2 = crt_rand();
    if (iVar2 % 10 == 3) {
      player_health._pad0._0_4_ = (float)player_health._pad0._0_4_ - 5.0;
      fx_queue_add_random((float *)&player_pos_x);
      fx_queue_add_random((float *)&player_pos_x);
    }
    iVar2 = crt_rand();
    _DAT_004aaf1c = (float)(iVar2 % 0x14) * 0.1 + _DAT_004aaf1c + 2.0;
    if (_bonus_freeze_timer <= 0.0) {
      iVar2 = crt_rand();
      render_overlay_player_index = 0;
      iVar2 = iVar2 % 0x17f;
      do {
        if ((&creature_pool)[iVar2].active != '\0') break;
        iVar2 = crt_rand();
        iVar2 = iVar2 % 0x17f;
        render_overlay_player_index = render_overlay_player_index + 1;
      } while (render_overlay_player_index < 10);
      render_overlay_player_index = 0;
      if ((&creature_pool)[iVar2].active != '\0') {
        fVar7 = frame_dt * 20.0;
        (&creature_pool)[iVar2].health = -1.0;
        (&creature_pool)[iVar2].hitbox_size = (&creature_pool)[iVar2].hitbox_size - fVar7;
        lVar5 = __ftol();
        player_health._pad0._136_4_ = SUB84(lVar5,0);
        sfx_play_panned(sfx_trooper_inpain_01_alias_1);
      }
    }
  }
  return;
}



/* quest_mode_update @ 004070e0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* quest mode update: spawn timeline, stage completion, and transitions */

void quest_mode_update(void)

{
  uint uVar1;
  int iVar2;
  IGrim2D *unaff_retaddr;
  
  if ((console_open_flag != '\0') || (render_pass_mode == '\0')) goto LAB_00407129;
  uVar1 = creatures_none_active();
  if ((char)uVar1 == '\0') {
LAB_00407104:
    quest_spawn_timeline = quest_spawn_timeline + frame_dt_ms;
  }
  else {
    iVar2 = quest_spawn_table_empty();
    if ((char)iVar2 == '\0') goto LAB_00407104;
  }
  DAT_00487244 = DAT_00487244 + frame_dt_ms;
LAB_00407129:
  quest_spawn_timeline_update();
  if (demo_mode_active == '\0') {
    uVar1 = creatures_none_active();
    if ((char)uVar1 != '\0') {
      iVar2 = quest_spawn_table_empty();
      if ((char)iVar2 != '\0') {
        _bonus_reflex_boost_timer = 0;
        if (DAT_00487088 < 0) {
          sfx_mute_all(music_track_extra_0);
          iVar2 = _quest_stage_minor + _quest_stage_major * 10;
          game_status_blob.quest_play_counts[iVar2 + 0x28] =
               game_status_blob.quest_play_counts[iVar2 + 0x28] + 1;
          DAT_00487088 = frame_dt_ms;
          return;
        }
        if ((800 < DAT_00487088) && (DAT_00487088 < 0x353)) {
          sfx_play(sfx_questhit);
          DAT_00487088 = frame_dt_ms + 0x353;
          return;
        }
        if ((2000 < DAT_00487088) && (DAT_00487088 < 0x803)) {
          DAT_00487088 = 0x803;
          sfx_play_exclusive(music_track_crimsonquest_id);
          DAT_00487088 = DAT_00487088 + frame_dt_ms;
          (&sfx_volume_table)[music_track_crimsonquest_id] = 0;
          return;
        }
        if (0x9c4 < DAT_00487088) {
          iVar2 = _quest_stage_minor + -10 + _quest_stage_major * 10;
          if (quest_unlock_index < iVar2) {
            quest_unlock_index = iVar2;
          }
          if ((config_blob.hardcore != '\0') && (quest_unlock_index_full < iVar2)) {
            quest_unlock_index_full = iVar2;
          }
          game_save_status();
          game_state_pending = 8;
          ui_transition_direction = 0;
          (*grim_interface_ptr->vtable->grim_flush_input)(unaff_retaddr);
          console_input_poll();
          highscore_active_record.score_xp = 0;
        }
        DAT_00487088 = DAT_00487088 + frame_dt_ms;
      }
    }
  }
  return;
}



/* rush_mode_update @ 004072b0 */

/* rush mode update: spawns edge waves and handles demo exit */

void rush_mode_update(void)

{
  int iVar1;
  float10 fVar2;
  float local_20;
  float local_1c;
  float local_18;
  float local_14;
  float local_10;
  float local_c;
  float local_8;
  undefined4 local_4;
  
  player_health._pad0[0x29c] = '\x02';
  player_health._pad0[0x29d] = '\0';
  player_health._pad0[0x29e] = '\0';
  player_health._pad0[0x29f] = '\0';
  player_health._pad0[0x2a8] = '\0';
  player_health._pad0[0x2a9] = '\0';
  player_health._pad0[0x2aa] = 0xf0;
  player_health._pad0[0x2ab] = 'A';
  player2_weapon_id = 2;
  player2_ammo = 0x41f00000;
  if (console_open_flag == '\0') {
    survival_spawn_cooldown = survival_spawn_cooldown - config_blob.reserved0._20_4_ * frame_dt_ms;
    while (survival_spawn_cooldown < 0) {
      survival_spawn_cooldown = survival_spawn_cooldown + 0xfa;
      fVar2 = (float10)(int)(highscore_active_record.survival_elapsed_ms + 1);
      local_4 = 0x3f800000;
      local_10 = (float)(fVar2 * (float10)8.333333e-06 + (float10)0.3);
      local_c = (float)(fVar2 * (float10)10000.0 + (float10)0.3);
      fVar2 = (float10)fsin(fVar2 * (float10)0.000100000005);
      local_8 = (float)(fVar2 + (float10)0.3);
      if (0.0 <= local_10) {
        if (1.0 < local_10) {
          local_10 = 1.0;
        }
      }
      else {
        local_10 = 0.0;
      }
      if (0.0 <= local_c) {
        if (1.0 < local_c) {
          local_c = 1.0;
        }
      }
      else {
        local_c = 0.0;
      }
      if (0.0 <= local_8) {
        if (1.0 < local_8) {
          local_8 = 1.0;
        }
      }
      else {
        local_8 = 0.0;
      }
      local_20 = (float)terrain_texture_width + 64.0;
      fVar2 = (float10)fcos((float10)(int)highscore_active_record.survival_elapsed_ms *
                            (float10)0.001);
      local_1c = (float)((float10)terrain_texture_height * (float10)0.5 + fVar2 * (float10)256.0);
      iVar1 = creature_spawn(&local_20,&local_10,2);
      local_18 = -64.0;
      fVar2 = (float10)fsin((float10)(int)highscore_active_record.survival_elapsed_ms *
                            (float10)0.001);
      (&creature_pool)[iVar1].ai_mode = 8;
      local_14 = (float)((float10)terrain_texture_height * (float10)0.5 + fVar2 * (float10)256.0);
      iVar1 = creature_spawn(&local_18,&local_10,3);
      (&creature_pool)[iVar1].ai_mode = 8;
      (&creature_pool)[iVar1].flags = (&creature_pool)[iVar1].flags | 0x80;
      (&creature_pool)[iVar1].move_speed = (&creature_pool)[iVar1].move_speed * 1.4;
    }
    if ((demo_mode_active != '\0') && (demo_time_limit_ms < quest_spawn_timeline)) {
      render_pass_mode = 0;
      demo_mode_start();
    }
  }
  return;
}



/* survival_spawn_creature @ 00407510 */

/* spawns a creature at the given position, selecting type/stats based on DAT_0049095c */

void __cdecl survival_spawn_creature(float *pos)

{
  float fVar1;
  float fVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  float *pfVar6;
  
  iVar3 = creature_alloc_slot();
  (&creature_pool)[iVar3].pos_x = *pos;
  (&creature_pool)[iVar3].pos_y = pos[1];
  (&creature_pool)[iVar3].collision_flag = '\0';
  (&creature_pool)[iVar3].collision_timer = 0.0;
  (&creature_pool)[iVar3].ai_mode = 0;
  iVar4 = crt_rand();
  iVar4 = iVar4 % 10;
  if ((int)player_health._pad0._136_4_ < 12000) {
    if (iVar4 < 9) {
      (&creature_pool)[iVar3].type_id = 2;
    }
    else {
      (&creature_pool)[iVar3].type_id = 3;
    }
  }
  else if ((int)player_health._pad0._136_4_ < 25000) {
    if (iVar4 < 4) {
      (&creature_pool)[iVar3].type_id = 0;
    }
    else {
      (&creature_pool)[iVar3].type_id = 3;
    }
    if (8 < iVar4) {
      (&creature_pool)[iVar3].type_id = 2;
    }
  }
  else if ((int)player_health._pad0._136_4_ < 42000) {
    if (iVar4 < 5) {
      (&creature_pool)[iVar3].type_id = 2;
    }
    else {
      uVar5 = crt_rand();
      uVar5 = uVar5 & 0x80000001;
      if ((int)uVar5 < 0) {
        uVar5 = (uVar5 - 1 | 0xfffffffe) + 1;
      }
      (&creature_pool)[iVar3].type_id = uVar5 + 3;
    }
  }
  else if ((int)player_health._pad0._136_4_ < 50000) {
    (&creature_pool)[iVar3].type_id = 2;
  }
  else if ((int)player_health._pad0._136_4_ < 90000) {
    (&creature_pool)[iVar3].type_id = 4;
  }
  else {
    if (109999 < (int)player_health._pad0._136_4_) {
      if (iVar4 < 6) {
        (&creature_pool)[iVar3].type_id = 2;
        goto LAB_00407611;
      }
      if (iVar4 < 9) {
        (&creature_pool)[iVar3].type_id = 4;
        goto LAB_00407611;
      }
    }
    (&creature_pool)[iVar3].type_id = 0;
  }
LAB_00407611:
  iVar4 = crt_rand();
  if (((byte)iVar4 & 0x1f) == 2) {
    (&creature_pool)[iVar3].type_id = 3;
  }
  iVar4 = crt_rand();
  (&creature_pool)[iVar3].active = '\x01';
  *(undefined1 *)&(&creature_pool)[iVar3].force_target = 0;
  (&creature_pool)[iVar3].hitbox_size = 16.0;
  (&creature_pool)[iVar3].vel_x = 0.0;
  (&creature_pool)[iVar3].vel_y = 0.0;
  (&creature_pool)[iVar3].size = (float)(iVar4 % 0x14 + 0x2c);
  iVar4 = crt_rand();
  (&creature_pool)[iVar3].heading = (float)(iVar4 % 0x13a) * 0.01;
  iVar4 = (&creature_pool)[iVar3].type_id;
  (&creature_pool)[iVar3].move_speed =
       (float)((int)player_health._pad0._136_4_ / 4000) * 0.045 + 0.9;
  if (iVar4 == 3) {
    fVar1 = (&creature_pool)[iVar3].move_speed;
    (&creature_pool)[iVar3].flags = (&creature_pool)[iVar3].flags | 0x80;
    (&creature_pool)[iVar3].move_speed = fVar1 * 1.3;
  }
  uVar5 = crt_rand();
  iVar4 = (&creature_pool)[iVar3].type_id;
  (&creature_pool)[iVar3].health =
       (float)(int)player_health._pad0._136_4_ * 0.00125 + (float)(uVar5 & 0xf) + 52.0;
  if (iVar4 == 0) {
    fVar1 = (&creature_pool)[iVar3].move_speed * 0.6;
    (&creature_pool)[iVar3].move_speed = fVar1;
    if (fVar1 < 1.3) {
      (&creature_pool)[iVar3].move_speed = 1.3;
    }
    (&creature_pool)[iVar3].health = (&creature_pool)[iVar3].health * 1.5;
  }
  if (3.5 < (&creature_pool)[iVar3].move_speed) {
    (&creature_pool)[iVar3].move_speed = 3.5;
  }
  (&creature_pool)[iVar3].attack_cooldown = 0.0;
  (&creature_pool)[iVar3].reward_value = 0.0;
  if ((int)player_health._pad0._136_4_ < 50000) {
    (&creature_pool)[iVar3].tint_r =
         1.0 - 1.0 / ((float)((int)player_health._pad0._136_4_ / 1000) + 10.0);
    iVar4 = crt_rand();
    (&creature_pool)[iVar3].tint_g =
         ((float)(iVar4 % 10) * 0.01 + 0.9) -
         1.0 / ((float)((int)player_health._pad0._136_4_ / 10000) + 10.0);
    iVar4 = crt_rand();
    (&creature_pool)[iVar3].tint_b = (float)(iVar4 % 10) * 0.01 + 0.7;
  }
  else if ((int)player_health._pad0._136_4_ < 100000) {
    (&creature_pool)[iVar3].tint_r =
         0.9 - 1.0 / ((float)((int)player_health._pad0._136_4_ / 1000) + 10.0);
    iVar4 = crt_rand();
    (&creature_pool)[iVar3].tint_g =
         ((float)(iVar4 % 10) * 0.01 + 0.8) -
         1.0 / ((float)((int)player_health._pad0._136_4_ / 10000) + 10.0);
    iVar4 = crt_rand();
    (&creature_pool)[iVar3].tint_b =
         (float)(player_health._pad0._136_4_ + -50000) * 6e-06 + (float)(iVar4 % 10) * 0.01 + 0.7;
  }
  else {
    (&creature_pool)[iVar3].tint_r =
         1.0 - 1.0 / ((float)((int)player_health._pad0._136_4_ / 1000) + 10.0);
    iVar4 = crt_rand();
    (&creature_pool)[iVar3].tint_g =
         ((float)(iVar4 % 10) * 0.01 + 0.9) -
         1.0 / ((float)((int)player_health._pad0._136_4_ / 10000) + 10.0);
    iVar4 = crt_rand();
    fVar1 = ((float)(iVar4 % 10) * 0.01 + 1.0) -
            (float)(player_health._pad0._136_4_ + -100000) * 3e-06;
    (&creature_pool)[iVar3].tint_b = fVar1;
    if (fVar1 < 0.5) {
      (&creature_pool)[iVar3].tint_b = 0.5;
    }
  }
  pfVar6 = &(&creature_pool)[iVar3].tint_r;
  fVar1 = (&creature_pool)[iVar3].size;
  (&creature_pool)[iVar3].tint_a = 1.0;
  (&creature_pool)[iVar3].contact_damage = fVar1 * 0.0952381;
  if ((&creature_pool)[iVar3].reward_value == 0.0) {
    iVar4 = crt_rand();
    (&creature_pool)[iVar3].reward_value =
         (&creature_pool)[iVar3].health * 0.4 +
         (&creature_pool)[iVar3].contact_damage * 0.8 +
         (&creature_pool)[iVar3].move_speed * 5.0 + (float)(iVar4 % 10 + 10);
  }
  iVar4 = crt_rand();
  if (iVar4 % 0xb4 < 2) {
    *pfVar6 = 0.9;
    (&creature_pool)[iVar3].health = 65.0;
    (&creature_pool)[iVar3].tint_g = 0.4;
    (&creature_pool)[iVar3].reward_value = 320.0;
    (&creature_pool)[iVar3].tint_b = 0.4;
    (&creature_pool)[iVar3].tint_a = 1.0;
  }
  else {
    iVar4 = crt_rand();
    if (iVar4 % 0xf0 < 2) {
      *pfVar6 = 0.4;
      (&creature_pool)[iVar3].health = 85.0;
      (&creature_pool)[iVar3].tint_g = 0.9;
      (&creature_pool)[iVar3].reward_value = 420.0;
      (&creature_pool)[iVar3].tint_b = 0.4;
      (&creature_pool)[iVar3].tint_a = 1.0;
    }
    else {
      iVar4 = crt_rand();
      if (iVar4 % 0x168 < 2) {
        *pfVar6 = 0.4;
        (&creature_pool)[iVar3].health = 125.0;
        (&creature_pool)[iVar3].tint_g = 0.4;
        (&creature_pool)[iVar3].reward_value = 520.0;
        (&creature_pool)[iVar3].tint_b = 0.9;
        (&creature_pool)[iVar3].tint_a = 1.0;
      }
    }
  }
  iVar4 = crt_rand();
  if (iVar4 % 0x528 < 4) {
    fVar1 = (&creature_pool)[iVar3].health;
    *pfVar6 = 0.84;
    (&creature_pool)[iVar3].health = fVar1 + 230.0;
    (&creature_pool)[iVar3].tint_g = 0.24;
    (&creature_pool)[iVar3].size = 80.0;
    (&creature_pool)[iVar3].tint_b = 0.89;
    (&creature_pool)[iVar3].reward_value = 600.0;
    (&creature_pool)[iVar3].tint_a = 1.0;
  }
  else {
    iVar4 = crt_rand();
    if (iVar4 % 0x654 < 4) {
      fVar1 = (&creature_pool)[iVar3].health;
      *pfVar6 = 0.94;
      (&creature_pool)[iVar3].health = fVar1 + 2230.0;
      (&creature_pool)[iVar3].tint_g = 0.84;
      (&creature_pool)[iVar3].size = 85.0;
      (&creature_pool)[iVar3].tint_b = 0.29;
      (&creature_pool)[iVar3].reward_value = 900.0;
      (&creature_pool)[iVar3].tint_a = 1.0;
    }
  }
  fVar1 = (&creature_pool)[iVar3].reward_value;
  fVar2 = (&creature_pool)[iVar3].health;
  (&creature_pool)[iVar3].state_flag = '\x01';
  (&creature_pool)[iVar3].max_health = fVar2;
  (&creature_pool)[iVar3].reward_value = fVar1 * 0.8;
  if (0.0 <= *pfVar6) {
    if (1.0 < *pfVar6) {
      *pfVar6 = 1.0;
    }
  }
  else {
    *pfVar6 = 0.0;
  }
  if (0.0 <= (&creature_pool)[iVar3].tint_g) {
    if (1.0 < (&creature_pool)[iVar3].tint_g) {
      (&creature_pool)[iVar3].tint_g = 1.0;
    }
  }
  else {
    (&creature_pool)[iVar3].tint_g = 0.0;
  }
  if (0.0 <= (&creature_pool)[iVar3].tint_b) {
    if (1.0 < (&creature_pool)[iVar3].tint_b) {
      (&creature_pool)[iVar3].tint_b = 1.0;
    }
  }
  else {
    (&creature_pool)[iVar3].tint_b = 0.0;
  }
  if ((&creature_pool)[iVar3].tint_a < 0.0) {
    (&creature_pool)[iVar3].tint_a = 0.0;
    return;
  }
  if (1.0 < (&creature_pool)[iVar3].tint_a) {
    (&creature_pool)[iVar3].tint_a = 1.0;
  }
  return;
}



/* survival_update @ 00407cd0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* main survival mode update: timers, scripted spawns, and enemy wave spawning */

void survival_update(void)

{
  float fVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  float *pfVar7;
  float local_48;
  float local_44;
  float local_40;
  float local_3c;
  float local_38;
  float local_34;
  float local_30;
  float local_2c;
  float local_28;
  float local_24;
  float local_20;
  undefined4 local_1c;
  float local_18;
  float local_14;
  float local_10;
  float local_c;
  float local_8;
  float local_4;
  
  if (console_open_flag != '\0') {
    return;
  }
  quest_spawn_timeline = quest_spawn_timeline + frame_dt_ms;
  if (demo_mode_active != '\0') {
    if (quest_spawn_timeline <= demo_time_limit_ms) {
      return;
    }
    render_pass_mode = 0;
    demo_mode_start();
    return;
  }
  if (config_blob.reserved0._20_4_ == 1) {
    if ((((survival_reward_damage_seen == '\0') && (survival_reward_fire_seen == '\0')) &&
        (64000 < (int)highscore_active_record.survival_elapsed_ms)) &&
       (survival_reward_handout_enabled != '\0')) {
      if (player_health._pad0._668_4_ == 1) {
        weapon_assign_player(0,0x18);
        DAT_00486fb8 = 0x18;
      }
      survival_reward_handout_enabled = '\0';
      survival_reward_damage_seen = '\x01';
      survival_reward_fire_seen = '\x01';
    }
    if (((survival_recent_death_count == 3) && (survival_reward_fire_seen == '\0')) &&
       ((local_44 = (_DAT_00486ffc + _DAT_00486ff4 + survival_recent_death_pos_y) * 0.33333334,
        fVar1 = player_pos_x -
                (_survival_recent_death_pos_x + _DAT_00486ff0 + _DAT_00486ff8) * 0.33333334,
        SQRT(fVar1 * fVar1 + (player_pos_y - local_44) * (player_pos_y - local_44)) < 16.0 &&
        ((float)player_health._pad0._0_4_ < 15.0)))) {
      weapon_assign_player(0,0x19);
      DAT_00486fb8 = 0x19;
      survival_reward_fire_seen = '\x01';
      survival_reward_handout_enabled = '\0';
    }
  }
  if (survival_spawn_stage == 0) {
    if ((int)player_health._pad0._144_4_ < 5) goto LAB_004082d6;
    survival_spawn_stage = 1;
    local_48 = -164.0;
    local_44 = 512.0;
    creature_spawn_template(0x12,&local_48,3.1415927);
    local_48 = 1188.0;
    local_44 = 512.0;
    creature_spawn_template(0x12,&local_48,3.1415927);
  }
  if (survival_spawn_stage == 1) {
    if ((int)player_health._pad0._144_4_ < 9) goto LAB_004082d6;
    survival_spawn_stage = 2;
    local_48 = 1088.0;
    local_44 = 512.0;
    creature_spawn_template(0x2c,&local_48,3.1415927);
  }
  if (survival_spawn_stage == 2) {
    if ((int)player_health._pad0._144_4_ < 0xb) goto LAB_004082d6;
    survival_spawn_stage = 3;
    local_48 = 0.0;
    do {
      fVar1 = local_48;
      local_40 = 1088.0;
      local_3c = (float)(int)local_48 * 42.666668 + 256.0;
      creature_spawn_template(0x35,&local_40,3.1415927);
      local_48 = (float)((int)fVar1 + 1);
    } while ((int)local_48 < 0xc);
  }
  if (survival_spawn_stage == 3) {
    if ((int)player_health._pad0._144_4_ < 0xd) goto LAB_004082d6;
    survival_spawn_stage = 4;
    local_48 = 0.0;
    do {
      fVar1 = local_48;
      local_40 = 1088.0;
      local_3c = (float)(int)local_48 * 64.0 + 384.0;
      creature_spawn_template(0x2b,&local_40,3.1415927);
      local_48 = (float)((int)fVar1 + 1);
    } while ((int)local_48 < 4);
  }
  if (survival_spawn_stage == 4) {
    if ((int)player_health._pad0._144_4_ < 0xf) goto LAB_004082d6;
    survival_spawn_stage = 5;
    local_48 = 0.0;
    do {
      fVar1 = local_48;
      local_40 = 1088.0;
      local_3c = (float)(int)local_48 * 64.0 + 384.0;
      creature_spawn_template(0x38,&local_40,3.1415927);
      local_48 = (float)((int)fVar1 + 1);
    } while ((int)local_48 < 4);
    local_48 = 0.0;
    do {
      fVar1 = local_48;
      local_40 = -64.0;
      local_3c = (float)(int)local_48 * 64.0 + 384.0;
      creature_spawn_template(0x38,&local_40,3.1415927);
      local_48 = (float)((int)fVar1 + 1);
    } while ((int)local_48 < 4);
  }
  if (survival_spawn_stage == 5) {
    if ((int)player_health._pad0._144_4_ < 0x11) goto LAB_004082d6;
    survival_spawn_stage = 6;
    local_40 = 1088.0;
    local_3c = 512.0;
    creature_spawn_template(0x3a,&local_40,3.1415927);
  }
  if (survival_spawn_stage == 6) {
    if ((int)player_health._pad0._144_4_ < 0x13) goto LAB_004082d6;
    survival_spawn_stage = 7;
    local_40 = 640.0;
    local_3c = 512.0;
    creature_spawn_template(1,&local_40,3.1415927);
  }
  if (survival_spawn_stage == 7) {
    if ((int)player_health._pad0._144_4_ < 0x15) goto LAB_004082d6;
    survival_spawn_stage = 8;
    local_40 = 384.0;
    local_3c = 256.0;
    creature_spawn_template(1,&local_40,3.1415927);
    local_40 = 640.0;
    local_3c = 768.0;
    creature_spawn_template(1,&local_40,3.1415927);
  }
  if (survival_spawn_stage == 8) {
    if ((int)player_health._pad0._144_4_ < 0x1a) goto LAB_004082d6;
    survival_spawn_stage = 9;
    local_48 = 0.0;
    do {
      fVar1 = local_48;
      local_40 = 1088.0;
      local_3c = (float)(int)local_48 * 64.0 + 384.0;
      creature_spawn_template(0x3c,&local_40,3.1415927);
      local_48 = (float)((int)fVar1 + 1);
    } while ((int)local_48 < 4);
    local_48 = 0.0;
    do {
      fVar1 = local_48;
      local_40 = -64.0;
      local_3c = (float)(int)local_48 * 64.0 + 384.0;
      creature_spawn_template(0x3c,&local_40,3.1415927);
      local_48 = (float)((int)fVar1 + 1);
    } while ((int)local_48 < 4);
  }
  if ((survival_spawn_stage == 9) && (0x1f < (int)player_health._pad0._144_4_)) {
    survival_spawn_stage = 10;
    local_40 = 1088.0;
    local_3c = 512.0;
    creature_spawn_template(0x3a,&local_40,3.1415927);
    local_40 = -64.0;
    local_3c = 512.0;
    creature_spawn_template(0x3a,&local_40,3.1415927);
    local_48 = 0.0;
    do {
      fVar1 = local_48;
      local_3c = -64.0;
      local_40 = (float)(int)local_48 * 64.0 + 384.0;
      creature_spawn_template(0x3c,&local_40,3.1415927);
      local_48 = (float)((int)fVar1 + 1);
    } while ((int)local_48 < 4);
    local_48 = 0.0;
    do {
      fVar1 = local_48;
      local_3c = 1088.0;
      local_40 = (float)(int)local_48 * 64.0 + 384.0;
      creature_spawn_template(0x3c,&local_40,3.1415927);
      local_48 = (float)((int)fVar1 + 1);
    } while ((int)local_48 < 4);
  }
LAB_004082d6:
  survival_spawn_cooldown = survival_spawn_cooldown - config_blob.reserved0._20_4_ * frame_dt_ms;
  render_overlay_player_index = 0;
joined_r0x004082fb:
  if (-1 < survival_spawn_cooldown) {
    config_blob.reserved0[0x14] = config_blob.reserved0[0x14];
    config_blob.reserved0[0x15] = config_blob.reserved0[0x15];
    config_blob.reserved0[0x16] = config_blob.reserved0[0x16];
    config_blob.reserved0[0x17] = config_blob.reserved0[0x17];
    player_health._pad0[0] = player_health._pad0[0];
    player_health._pad0[1] = player_health._pad0[1];
    player_health._pad0[2] = player_health._pad0[2];
    player_health._pad0[3] = player_health._pad0[3];
    player_health._pad0[0x90] = player_health._pad0[0x90];
    player_health._pad0[0x91] = player_health._pad0[0x91];
    player_health._pad0[0x92] = player_health._pad0[0x92];
    player_health._pad0[0x93] = player_health._pad0[0x93];
    player_health._pad0[0x29c] = player_health._pad0[0x29c];
    player_health._pad0[0x29d] = player_health._pad0[0x29d];
    player_health._pad0[0x29e] = player_health._pad0[0x29e];
    player_health._pad0[0x29f] = player_health._pad0[0x29f];
    return;
  }
  iVar5 = 500 - (int)highscore_active_record.survival_elapsed_ms / 0x708;
  if (iVar5 < 0) {
    uVar6 = 1U - iVar5 >> 1;
    iVar5 = iVar5 + uVar6 * 2;
    do {
      uVar2 = crt_rand();
      iVar3 = terrain_texture_height;
      iVar4 = terrain_texture_width;
      switch(uVar2 & 3) {
      case 0:
        iVar3 = crt_rand();
        local_48 = (float)(iVar3 % iVar4);
        local_3c = -40.0;
        pfVar7 = &local_40;
        local_40 = (float)(int)local_48;
        break;
      case 1:
        iVar3 = crt_rand();
        local_48 = (float)(iVar3 % iVar4);
        pfVar7 = &local_38;
        local_38 = (float)(int)local_48;
        local_34 = (float)terrain_texture_height + 40.0;
        break;
      case 2:
        iVar4 = crt_rand();
        local_48 = (float)(iVar4 % iVar3);
        pfVar7 = &local_30;
        local_30 = -40.0;
        local_2c = (float)(int)local_48;
        break;
      case 3:
        iVar4 = crt_rand();
        local_48 = (float)(iVar4 % iVar3);
        pfVar7 = &local_28;
        local_24 = (float)(int)local_48;
        local_28 = (float)terrain_texture_width + 40.0;
        break;
      default:
        goto switchD_00408344_default;
      }
      survival_spawn_creature(pfVar7);
switchD_00408344_default:
      uVar6 = uVar6 - 1;
    } while (uVar6 != 0);
  }
  if (iVar5 < 1) {
    iVar5 = 1;
  }
  survival_spawn_cooldown = survival_spawn_cooldown + iVar5;
  uVar6 = crt_rand();
  iVar4 = terrain_texture_height;
  iVar5 = terrain_texture_width;
  switch(uVar6 & 3) {
  case 0:
    iVar4 = crt_rand();
    local_48 = (float)(iVar4 % iVar5);
    local_1c = 0xc2200000;
    pfVar7 = &local_20;
    local_20 = (float)(int)local_48;
    break;
  case 1:
    iVar4 = crt_rand();
    local_48 = (float)(iVar4 % iVar5);
    pfVar7 = &local_18;
    local_18 = (float)(int)local_48;
    local_14 = (float)terrain_texture_height + 40.0;
    break;
  case 2:
    iVar5 = crt_rand();
    local_48 = (float)(iVar5 % iVar4);
    pfVar7 = &local_10;
    local_10 = -40.0;
    local_c = (float)(int)local_48;
    break;
  case 3:
    iVar5 = crt_rand();
    local_48 = (float)(iVar5 % iVar4);
    pfVar7 = &local_8;
    local_4 = (float)(int)local_48;
    local_8 = (float)terrain_texture_width + 40.0;
    break;
  default:
    goto joined_r0x004082fb;
  }
  survival_spawn_creature(pfVar7);
  goto joined_r0x004082fb;
}



/* tutorial_prompt_dialog @ 00408530 */

/* renders tutorial prompt text + Repeat/Play/Skip buttons and handles selections */

void __cdecl tutorial_prompt_dialog(char *text,float alpha)

{
  float w;
  int iVar1;
  char *pcVar2;
  int iVar3;
  IGrim2D *unaff_EBX;
  float unaff_EBP;
  float unaff_ESI;
  int iVar4;
  char *unaff_EDI;
  uchar *puVar5;
  longlong lVar6;
  float in_stack_0000000c;
  char cStack00000010;
  float in_stack_00000014;
  char in_stack_00000018;
  IGrim2D IStack_1c;
  IGrim2D IStack_18;
  float fStack_14;
  float fStack_10;
  undefined4 uStack_c;
  float fStack_8;
  undefined4 uStack_4;
  
  iVar1 = (*grim_interface_ptr->vtable->grim_measure_text_width)((IGrim2D *)text,unaff_EDI);
  iVar4 = 1;
  pcVar2 = _strchr(text,10);
  if (pcVar2 != (char *)0x0) {
    iVar4 = 2;
  }
  if (cStack00000010 != '\0') {
    iVar4 = 4;
  }
  lVar6 = __ftol();
  iVar3 = (int)lVar6;
  IStack_1c.vtable = (IGrim2D_vtbl *)(float)iVar3;
  w = (float)(iVar4 * 0x10 + 6);
  uStack_c = 0;
  fStack_8 = 0.0;
  uStack_4 = 0;
  IStack_18.vtable = (IGrim2D_vtbl *)0x42800000;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            (&IStack_1c,(float *)(float)(iVar1 + 0x28),w,(float)&uStack_c);
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_0000000c,unaff_ESI);
  fStack_14 = 64.0;
  IStack_18.vtable = IStack_1c.vtable;
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            (&IStack_18,(float *)(float)(iVar1 + 0x28),w,unaff_EBP);
  fStack_8 = in_stack_00000014 * 0.9;
  fStack_14 = 1.0;
  uStack_c = 0x3f800000;
  uStack_4 = 0x3f800000;
  fStack_10 = 1.0;
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,(float)(iVar3 + 0x14),68.0,_cStack00000010);
  if ((DAT_00480148 & 1) == 0) {
    DAT_00480148 = DAT_00480148 | 1;
    ui_button_table_b.enabled = '\x01';
    ui_button_table_b.force_wide = '\0';
    ui_button_table_b.force_small = '\0';
    ui_button_table_b.alpha = 1.0;
    ui_button_table_b.click_anim = 0;
    ui_button_table_b.label = (char *)0x0;
    ui_button_table_b.hovered = '\0';
    ui_button_table_b.activated = '\0';
    ui_button_table_b.hover_anim = 0;
    crt_atexit(&DAT_00408980);
  }
  ui_button_table_b.label = s_Repeat_tutorial_004722f8;
  if ((DAT_00480148 & 2) == 0) {
    DAT_00480148 = DAT_00480148 | 2;
    ui_button_table_c.enabled = '\x01';
    ui_button_table_c.force_wide = '\0';
    ui_button_table_c.force_small = '\0';
    ui_button_table_c.alpha = 1.0;
    ui_button_table_c.click_anim = 0;
    ui_button_table_c.label = (char *)0x0;
    ui_button_table_c.hovered = '\0';
    ui_button_table_c.activated = '\0';
    ui_button_table_c.hover_anim = 0;
    crt_atexit(&DAT_00408970);
  }
  ui_button_table_c.label = s_Play_a_game_004722ec;
  if (in_stack_00000018 == '\0') {
    ui_button_table_c.alpha = (float)(tutorial_stage_timer + -1000) * 0.001;
    if (ui_button_table_c.alpha <= 1.0) {
      if (ui_button_table_c.alpha < 0.0) {
        ui_button_table_c.alpha = 0.0;
      }
    }
    else {
      ui_button_table_c.alpha = 1.0;
    }
    fStack_10 = (float)(config_blob.screen_height + -0x32);
    ui_button_table_c.label = s_Skip_tutorial_004722dc;
    fStack_14 = 10.0;
    ui_button_update(&fStack_14,&ui_button_table_c);
    if (ui_button_table_c.activated != '\0') {
      ui_sign_crimson_update_disabled = 0;
      game_state_pending = 1;
      render_pass_mode = 0;
      ui_transition_direction = 0;
      (*grim_interface_ptr->vtable->grim_flush_input)(unaff_EBX);
      console_input_poll();
      tutorial_stage_transition_timer = 0xfffffc18;
    }
  }
  else {
    ui_button_table_c.alpha = in_stack_00000014;
    fStack_14 = (float)(iVar3 + 0x20);
    ui_button_table_b.alpha = in_stack_00000014;
    fStack_10 = 90.0;
    ui_button_update(&fStack_14,&ui_button_table_c);
    fStack_14 = (float)(iVar3 + 0xc0);
    fStack_10 = 90.0;
    ui_button_update(&fStack_14,&ui_button_table_b);
    if (ui_button_table_c.activated != '\0') {
      ui_sign_crimson_update_disabled = 0;
      game_state_pending = 1;
      render_pass_mode = 0;
      ui_transition_direction = 0;
      (*grim_interface_ptr->vtable->grim_flush_input)(unaff_EBX);
      console_input_poll();
      tutorial_stage_transition_timer = 0xfffffc18;
    }
    if (ui_button_table_b.activated != '\0') {
      player_health._pad0[0x90] = '\x01';
      player_health._pad0[0x91] = '\0';
      player_health._pad0[0x92] = '\0';
      player_health._pad0[0x93] = '\0';
      puVar5 = player_health._pad0 + 0x94;
      for (iVar1 = 0x80; iVar1 != 0; iVar1 = iVar1 + -1) {
        puVar5[0] = '\0';
        puVar5[1] = '\0';
        puVar5[2] = '\0';
        puVar5[3] = '\0';
        puVar5 = puVar5 + 4;
      }
      tutorial_stage_transition_timer = 0xfffffc18;
      perk_pending_count = 0;
      tutorial_stage_timer = 2000;
      return;
    }
  }
  return;
}



/* tutorial_timeline_update @ 00408990 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* drives tutorial stage timing, messages, and scripted spawns */

void tutorial_timeline_update(void)

{
  char *pcVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  IGrim2D *unaff_EBX;
  IGrim2D *unaff_ESI;
  float unaff_EDI;
  IGrim2D *in_stack_ffffffa4;
  float alpha;
  float afStack_54 [4];
  char *local_44;
  char *local_40 [4];
  undefined *local_30;
  undefined *local_2c;
  char *local_28;
  char *local_24 [4];
  char *local_14;
  char *local_10;
  char *local_c;
  char *local_8;
  undefined *local_4;
  
  if (console_open_flag != '\0') {
    return;
  }
  tutorial_stage_timer = tutorial_stage_timer + frame_dt_ms;
  quest_spawn_timeline = quest_spawn_timeline + frame_dt_ms;
  local_44 = s_This_is_the_speed_powerup__it_ma_004726c4;
  local_40[0] = s_This_is_a_weapon_powerup__Pickin_00472664;
  local_40[1] = s_This_powerup_doubles_all_experie_00472614;
  local_40[2] = s_This_is_the_nuke_powerup__pickin_004725b8;
  local_40[3] = s_Reflex_Boost_powerup_slows_down_t_0047256c;
  local_30 = &tutorial_empty_string;
  local_2c = &tutorial_empty_string;
  local_28 = s_In_this_tutorial_you_ll_learn_ho_00472534;
  local_24[0] = s_First_learn_to_move_by_pushing_t_00472504;
  local_24[1] = s_Now_pick_up_the_bonuses_by_walki_004724d4;
  local_24[2] = s_Now_learn_to_shoot_and_move_at_t_00472480;
  local_24[3] = s_Now__move_the_mouse_to_aim_at_th_00472454;
  local_14 = s_It_will_help_you_to_move_and_sho_00472408;
  local_10 = s_Now_let_s_learn_about_Perks__You_0047238c;
  local_c = s_Perks_can_give_you_extra_abiliti_00472340;
  local_8 = s_Great__Now_you_are_ready_to_star_00472308;
  local_4 = &tutorial_empty_string;
  player_health._pad0[0] = '\0';
  player_health._pad0[1] = '\0';
  player_health._pad0[2] = 200;
  player_health._pad0[3] = 'B';
  if (tutorial_stage_index != 6) {
    player_health._pad0[0x88] = '\0';
    player_health._pad0[0x89] = '\0';
    player_health._pad0[0x8a] = '\0';
    player_health._pad0[0x8b] = '\0';
  }
  if (tutorial_stage_transition_timer < -1) {
    tutorial_stage_transition_timer = tutorial_stage_transition_timer + frame_dt_ms;
    if (tutorial_stage_transition_timer < -1) goto LAB_00408aa2;
    tutorial_stage_index = tutorial_stage_index + 1;
    if (tutorial_stage_index == 9) {
      tutorial_stage_index = 0;
    }
    tutorial_stage_transition_timer = 0;
  }
  else {
    if (-1 < tutorial_stage_transition_timer) {
      tutorial_stage_transition_timer = tutorial_stage_transition_timer + frame_dt_ms;
    }
LAB_00408aa2:
    if (1000 < tutorial_stage_transition_timer) {
      tutorial_stage_transition_timer = -1;
    }
  }
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_EDI);
  iVar2 = tutorial_stage_transition_timer;
  if (tutorial_stage_transition_timer < 0) {
    if (tutorial_stage_transition_timer < -1) {
      iVar2 = -tutorial_stage_transition_timer;
      goto LAB_00408aeb;
    }
    alpha = 1.0;
LAB_00408b06:
    if (tutorial_stage_index != 5) goto LAB_00408b78;
    if ((5000 < tutorial_stage_timer) && (-2 < tutorial_stage_transition_timer)) {
      alpha = 1.0 - (float)(tutorial_stage_timer + -5000) * 0.001;
    }
LAB_00408b66:
    if (tutorial_stage_timer < 0x1771) goto LAB_00408b78;
    alpha = 0.0;
  }
  else {
LAB_00408aeb:
    alpha = (float)iVar2 * 0.001;
    if (1.0 <= alpha) goto LAB_00408b06;
    if (tutorial_stage_index == 5) goto LAB_00408b66;
LAB_00408b78:
    if (alpha <= 1.0) {
      if (alpha < 0.0) {
        alpha = 0.0;
      }
    }
    else {
      alpha = 1.0;
    }
    if ((tutorial_stage_index < 0) || ((tutorial_stage_index == 6 && (perk_pending_count < 1))))
    goto LAB_00408be2;
  }
  tutorial_prompt_dialog(local_24[tutorial_stage_index],alpha);
LAB_00408be2:
  if (DAT_004808b0 == '\0') {
    if ((((tutorial_hint_bonus_ptr != (char *)0x0) && (*tutorial_hint_bonus_ptr == '\0')) &&
        (*(float *)(tutorial_hint_bonus_ptr + 0x24) <= 0.0)) &&
       ((*(uint *)(tutorial_hint_bonus_ptr + 0x8c) & 0x400) != 0)) {
      _DAT_004712f4 = (int)*(short *)(tutorial_hint_bonus_ptr + 0x78);
      _DAT_004712f8 = (int)*(short *)(tutorial_hint_bonus_ptr + 0x7a);
      DAT_004808b0 = '\x01';
      afStack_54[0] = 128.0;
      creature_spawn_template(0x24,(float *)&stack0xffffffa8,3.1415927);
      alpha = 152.0;
      afStack_54[0] = 160.0;
      creature_spawn_template(0x26,(float *)&stack0xffffffa8,3.1415927);
      tutorial_hint_index = tutorial_hint_index + 1;
    }
    tutorial_hint_alpha = tutorial_hint_alpha + frame_dt_ms * -3;
  }
  else {
    tutorial_hint_alpha = tutorial_hint_alpha + frame_dt_ms * 3;
  }
  if (tutorial_hint_alpha < 0x3e9) {
    if (tutorial_hint_alpha < 0) {
      tutorial_hint_alpha = 0;
    }
  }
  else {
    tutorial_hint_alpha = 1000;
  }
  if ((-1 < tutorial_hint_index) && (*local_40[tutorial_hint_index] != -0x59)) {
    tutorial_prompt_dialog(local_40[tutorial_hint_index],(float)tutorial_hint_alpha * 0.001);
  }
  if (tutorial_stage_index == 0) {
    if ((6000 < tutorial_stage_timer) && (tutorial_stage_transition_timer == -1)) {
      tutorial_repeat_spawn_count = 0;
      tutorial_hint_index = tutorial_stage_transition_timer;
      DAT_004808b0 = '\0';
      tutorial_stage_transition_timer = -1000;
      return;
    }
  }
  else {
    if (tutorial_stage_index == 1) {
      piVar3 = &player_health.input.move_key_backward;
      do {
        iVar2 = (*grim_interface_ptr->vtable->grim_is_key_active)
                          ((IGrim2D *)((player_input_t *)(piVar3 + -1))->move_key_forward,
                           (int)unaff_ESI);
        if ((char)iVar2 == '\0') {
          unaff_ESI = (IGrim2D *)*piVar3;
          iVar2 = (*grim_interface_ptr->vtable->grim_is_key_active)(unaff_ESI,(int)unaff_EBX);
          if ((char)iVar2 != '\0') goto LAB_00408dca;
          unaff_EBX = (IGrim2D *)piVar3[1];
          unaff_ESI = (IGrim2D *)0x408db0;
          iVar2 = (*grim_interface_ptr->vtable->grim_is_key_active)
                            (unaff_EBX,(int)in_stack_ffffffa4);
          if ((char)iVar2 != '\0') goto LAB_00408dca;
          in_stack_ffffffa4 = (IGrim2D *)piVar3[2];
          unaff_EBX = (IGrim2D *)0x408dc6;
          iVar2 = (*grim_interface_ptr->vtable->grim_is_key_active)(in_stack_ffffffa4,(int)alpha);
          if ((char)iVar2 != '\0') goto LAB_00408dca;
        }
        else {
LAB_00408dca:
          if (tutorial_stage_transition_timer == -1) {
            tutorial_stage_transition_timer = -1000;
            sfx_play(sfx_ui_levelup);
            afStack_54[3] = 260.0;
            local_44 = (char *)0x43820000;
            bonus_pool = 1;
            bonus_time_left = 0x42c80000;
            bonus_time_max = 0x42c80000;
            bonus_state = 0;
            bonus_amount = 500;
            bonus_pos_x = 0x43820000;
            bonus_pos_y = 0x43820000;
            effect_spawn_burst((float *)&bonus_pos_x,0xc);
            afStack_54[3] = 600.0;
            local_44 = (char *)0x43c80000;
            DAT_00482964 = 1;
            DAT_0048296c = 0x42c80000;
            DAT_00482970 = bonus_time_left;
            DAT_00482968 = 0;
            _DAT_0048297c = 1000;
            DAT_00482974 = 0x44160000;
            DAT_00482978 = 0x43c80000;
            effect_spawn_burst((float *)&DAT_00482974,0xc);
            afStack_54[3] = 300.0;
            local_44 = (char *)0x43c80000;
            _DAT_00482980 = 1;
            DAT_00482988 = 0x42c80000;
            _DAT_0048298c = bonus_time_left;
            DAT_00482984 = 0;
            _DAT_00482998 = 500;
            _DAT_00482990 = 0x43960000;
            _DAT_00482994 = 0x43c80000;
            effect_spawn_burst((float *)&DAT_00482990,0xc);
            return;
          }
        }
        piVar3 = piVar3 + 0xd8;
        if (0x49129f < (int)piVar3) {
          return;
        }
      } while( true );
    }
    if (tutorial_stage_index == 2) {
      iVar2 = 0;
      piVar3 = &bonus_pool;
      do {
        if (*piVar3 != 0) break;
        piVar3 = piVar3 + 7;
        iVar2 = iVar2 + 1;
      } while ((int)piVar3 < 0x482b08);
      if ((iVar2 == 0x10) && (tutorial_stage_transition_timer == -1)) {
        tutorial_stage_transition_timer = -1000;
        sfx_play(sfx_ui_levelup);
        return;
      }
    }
    else {
      if (tutorial_stage_index == 3) {
        piVar3 = &player_health.input.fire_key;
        do {
          iVar2 = (*grim_interface_ptr->vtable->grim_is_key_active)
                            ((IGrim2D *)*piVar3,(int)unaff_ESI);
          if (((char)iVar2 != '\0') && (tutorial_stage_transition_timer == -1)) {
            unaff_ESI = (IGrim2D *)0x3f800000;
            tutorial_stage_transition_timer = -1000;
            sfx_play(sfx_ui_levelup);
            afStack_54[0] = -164.0;
            afStack_54[1] = 412.0;
            creature_spawn_template(0x24,afStack_54,3.1415927);
            afStack_54[2] = -184.0;
            afStack_54[3] = 512.0;
            creature_spawn_template(0x26,afStack_54 + 2,3.1415927);
            local_44 = (char *)0xc31a0000;
            local_40[0] = (char *)0x44190000;
            creature_spawn_template(0x24,(float *)&local_44,3.1415927);
          }
          piVar3 = piVar3 + 0xd8;
        } while ((int)piVar3 < 0x4912ac);
        return;
      }
      if (tutorial_stage_index == 4) {
        uVar4 = creatures_none_active();
        if (((char)uVar4 != '\0') && (tutorial_stage_transition_timer == -1)) {
          tutorial_stage_timer = 1000;
          tutorial_stage_transition_timer = -1000;
          sfx_play(sfx_ui_levelup);
          tutorial_repeat_spawn_count = 0;
          afStack_54[3] = 1188.0;
          local_44 = (char *)0x43ce0000;
          creature_spawn_template(0x24,afStack_54 + 3,3.1415927);
          afStack_54[3] = 1208.0;
          local_44 = (char *)0x44000000;
          creature_spawn_template(0x26,afStack_54 + 3,3.1415927);
          afStack_54[3] = 1178.0;
          local_44 = (char *)0x44190000;
          creature_spawn_template(0x24,afStack_54 + 3,3.1415927);
          return;
        }
      }
      else if (tutorial_stage_index == 5) {
        iVar2 = 0;
        piVar3 = &bonus_pool;
        do {
          if (*piVar3 != 0) break;
          piVar3 = piVar3 + 7;
          iVar2 = iVar2 + 1;
        } while ((int)piVar3 < 0x482b08);
        if ((iVar2 == 0x10) && (uVar4 = creatures_none_active(), (char)uVar4 != '\0')) {
          tutorial_repeat_spawn_count = tutorial_repeat_spawn_count + 1;
          if ((int)tutorial_repeat_spawn_count < 8) {
            DAT_004808b0 = '\0';
            if ((tutorial_repeat_spawn_count & 1) == 0) {
              if ((int)tutorial_repeat_spawn_count < 6) {
                afStack_54[3] = 1056.0;
                local_44 = (char *)0x44840000;
                tutorial_hint_bonus_ptr = creature_spawn_template(0x27,afStack_54 + 3,3.1415927);
              }
              afStack_54[3] = 1188.0;
              local_44 = (char *)0x448e0000;
              creature_spawn_template(0x24,afStack_54 + 3,3.1415927);
              afStack_54[3] = 1208.0;
              local_44 = (char *)0x44000000;
              creature_spawn_template(0x26,afStack_54 + 3,3.1415927);
              afStack_54[3] = 1178.0;
            }
            else {
              if ((int)tutorial_repeat_spawn_count < 6) {
                afStack_54[3] = -32.0;
                local_44 = (char *)0x44840000;
                tutorial_hint_bonus_ptr = creature_spawn_template(0x27,afStack_54 + 3,3.1415927);
              }
              afStack_54[3] = -164.0;
              local_44 = (char *)0x43ce0000;
              creature_spawn_template(0x24,afStack_54 + 3,3.1415927);
              afStack_54[3] = -184.0;
              local_44 = (char *)0x44000000;
              creature_spawn_template(0x26,afStack_54 + 3,3.1415927);
              afStack_54[3] = -154.0;
            }
            local_44 = (char *)0x44190000;
            creature_spawn_template(0x24,afStack_54 + 3,3.1415927);
            if (tutorial_repeat_spawn_count == 4) {
              afStack_54[3] = 512.0;
              local_44 = (char *)0x44840000;
              creature_spawn_template(0x40,afStack_54 + 3,3.1415927);
            }
            if ((int)tutorial_repeat_spawn_count < 6) {
              pcVar1 = tutorial_hint_bonus_ptr;
              switch(tutorial_repeat_spawn_count) {
              case 1:
                pcVar1[0x78] = '\r';
                pcVar1[0x79] = '\0';
                pcVar1 = tutorial_hint_bonus_ptr;
                pcVar1[0x7a] = -1;
                pcVar1[0x7b] = -1;
                return;
              case 2:
                pcVar1[0x78] = '\x03';
                pcVar1[0x79] = '\0';
                pcVar1 = tutorial_hint_bonus_ptr;
                pcVar1[0x7a] = '\x05';
                pcVar1[0x7b] = '\0';
                return;
              case 3:
                pcVar1[0x78] = '\x06';
                pcVar1[0x79] = '\0';
                pcVar1 = tutorial_hint_bonus_ptr;
                pcVar1[0x7a] = -1;
                pcVar1[0x7b] = -1;
                return;
              case 4:
                pcVar1[0x78] = '\x05';
                pcVar1[0x79] = '\0';
                pcVar1 = tutorial_hint_bonus_ptr;
                pcVar1[0x7a] = -1;
                pcVar1[0x7b] = -1;
                return;
              case 5:
                pcVar1[0x78] = '\t';
                pcVar1[0x79] = '\0';
                pcVar1 = tutorial_hint_bonus_ptr;
                pcVar1[0x7a] = -1;
                pcVar1[0x7b] = -1;
                return;
              }
            }
          }
          else if (tutorial_stage_transition_timer == -1) {
            tutorial_stage_transition_timer = -1000;
            sfx_play(sfx_ui_levelup);
            player_health._pad0[0x88] = 0xb8;
            player_health._pad0[0x89] = '\v';
            player_health._pad0[0x8a] = '\0';
            player_health._pad0[0x8b] = '\0';
            return;
          }
        }
      }
      else if (tutorial_stage_index == 6) {
        if ((perk_pending_count < 1) && (tutorial_stage_transition_timer == -1)) {
          tutorial_stage_transition_timer = -1000;
          afStack_54[3] = -164.0;
          local_44 = (char *)0x43ce0000;
          creature_spawn_template(0x24,afStack_54 + 3,3.1415927);
          afStack_54[3] = -184.0;
          local_44 = (char *)0x44000000;
          creature_spawn_template(0x26,afStack_54 + 3,3.1415927);
          afStack_54[3] = -154.0;
          local_44 = (char *)0x44190000;
          creature_spawn_template(0x24,afStack_54 + 3,3.1415927);
          afStack_54[3] = -32.0;
          local_44 = (char *)0xc2000000;
          creature_spawn_template(0x28,afStack_54 + 3,3.1415927);
          afStack_54[3] = 1188.0;
          local_44 = (char *)0x43ce0000;
          creature_spawn_template(0x24,afStack_54 + 3,3.1415927);
          afStack_54[3] = 1208.0;
          local_44 = (char *)0x44000000;
          creature_spawn_template(0x26,afStack_54 + 3,3.1415927);
          afStack_54[3] = 1178.0;
          local_44 = (char *)0x44190000;
          creature_spawn_template(0x24,afStack_54 + 3,3.1415927);
          return;
        }
      }
      else if (tutorial_stage_index == 7) {
        iVar2 = 0;
        piVar3 = &bonus_pool;
        do {
          if (*piVar3 != 0) break;
          piVar3 = piVar3 + 7;
          iVar2 = iVar2 + 1;
        } while ((int)piVar3 < 0x482b08);
        if (((iVar2 == 0x10) && (uVar4 = creatures_none_active(), (char)uVar4 != '\0')) &&
           (tutorial_stage_transition_timer == -1)) {
          tutorial_stage_transition_timer = -1000;
        }
      }
    }
  }
  return;
}



/* camera_update @ 00409500 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* updates camera offsets and screen shake */

void camera_update(void)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  
  if (_camera_shake_timer <= 0.0) {
    _camera_shake_offset_x = 0.0;
    _camera_shake_offset_y = 0.0;
  }
  else {
    _camera_shake_timer = _camera_shake_timer - frame_dt * 3.0;
    if (_camera_shake_timer < 0.0) {
      camera_shake_pulses = camera_shake_pulses + -1;
      if (camera_shake_pulses < 1) {
        _camera_shake_timer = 0.0;
      }
      else {
        _camera_shake_timer = 0.1;
        if (time_scale_active != '\0') {
          _camera_shake_timer = 0.06;
        }
        iVar1 = crt_rand();
        iVar4 = camera_shake_pulses * 0x3c;
        iVar2 = crt_rand();
        iVar1 = iVar1 % (iVar4 / 0x14) + iVar2 % 10;
        uVar3 = crt_rand();
        if ((uVar3 & 1) == 0) {
          iVar1 = -iVar1;
        }
        _camera_shake_offset_x = (float)iVar1;
        iVar1 = crt_rand();
        iVar4 = camera_shake_pulses * 0x3c;
        iVar2 = crt_rand();
        iVar1 = iVar1 % (iVar4 / 0x14) + iVar2 % 10;
        uVar3 = crt_rand();
        if ((uVar3 & 1) == 0) {
          _camera_shake_offset_y = (float)-iVar1;
        }
        else {
          _camera_shake_offset_y = (float)iVar1;
        }
      }
    }
  }
  if (config_blob.reserved0._20_4_ == 1) {
    _camera_offset_x =
         (float)(config_blob.screen_width / 2) - (&player_pos_x)[render_overlay_player_index * 0xd8]
    ;
    _camera_offset_y =
         (float)(config_blob.screen_height / 2) -
         (&player_pos_y)[render_overlay_player_index * 0xd8];
    goto LAB_004097e4;
  }
  if (0.0 < (float)player_health._pad0._0_4_) {
    if (player2_health <= 0.0) goto LAB_00409716;
  }
  else {
    if (0.0 < player2_health) {
      _camera_offset_x = (float)(config_blob.screen_width / 2) - (float)player_health._pad1._20_4_;
      _camera_offset_y = (float)(config_blob.screen_height / 2) - (float)player_health._pad1._24_4_;
      goto LAB_004097e4;
    }
LAB_00409716:
    if (0.0 < (float)player_health._pad0._0_4_) {
      _camera_offset_x = (float)(config_blob.screen_width / 2) - player_pos_x;
      _camera_offset_y = (float)(config_blob.screen_height / 2) - player_pos_y;
      goto LAB_004097e4;
    }
    if (player2_health <= 0.0) goto LAB_004097e4;
  }
  if (0.0 < (float)player_health._pad0._0_4_) {
    _camera_offset_x =
         (float)(config_blob.screen_width / 2) -
         (player_pos_x - (player_pos_x - (float)player_health._pad1._20_4_) * 0.5);
    _camera_offset_y =
         (float)(config_blob.screen_height / 2) -
         (player_pos_y - (player_pos_y - (float)player_health._pad1._24_4_) * 0.5);
  }
LAB_004097e4:
  _camera_offset_x = _camera_offset_x + _camera_shake_offset_x;
  _camera_offset_y = _camera_offset_y + _camera_shake_offset_y;
  if (-1.0 < _camera_offset_x) {
    _camera_offset_x = -1.0;
  }
  if (-1.0 < _camera_offset_y) {
    _camera_offset_y = -1.0;
  }
  if (_camera_offset_x < (float)(config_blob.screen_width - terrain_texture_width)) {
    _camera_offset_x = (float)(config_blob.screen_width - terrain_texture_width);
  }
  if ((float)(config_blob.screen_height - terrain_texture_height) <= _camera_offset_y) {
    return;
  }
  _camera_offset_y = (float)(config_blob.screen_height - terrain_texture_height);
  return;
}



/* bonus_apply @ 00409890 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* applies a picked bonus to the player and spawns related effects */

void __cdecl bonus_apply(int player_index,int *bonus_entry)

{
  player_state_t *ppVar1;
  float fVar2;
  float fVar3;
  int iVar4;
  uchar *puVar5;
  int iVar6;
  uint uVar7;
  float *pfVar8;
  creature_t *pcVar9;
  float10 fVar10;
  int iVar11;
  int owner_id;
  float local_10 [4];
  
  sfx_play(sfx_ui_bonus);
  local_10[0] = 1.0;
  iVar4 = perk_count_get(perk_id_bonus_economist);
  if (iVar4 != 0) {
    local_10[0] = 1.5;
  }
  iVar4 = *bonus_entry;
  if (iVar4 == 3) {
    weapon_assign_player(player_index,bonus_entry[6]);
  }
  else if (iVar4 == 0xc) {
    ppVar1 = &player_health + player_index;
    if ((*(float *)(&player_health)[player_index]._pad0 < 100.0) &&
       (fVar2 = *(float *)ppVar1->_pad0 + 10.0, *(float *)ppVar1->_pad0 = fVar2, 100.0 < fVar2)) {
      ppVar1->_pad0[0] = '\0';
      ppVar1->_pad0[1] = '\0';
      ppVar1->_pad0[2] = 200;
      ppVar1->_pad0[3] = 'B';
    }
  }
  else if (iVar4 == 9) {
    if (_bonus_reflex_boost_timer <= 0.0) {
      FUN_0041a810(DAT_00485484,DAT_0048548c,&bonus_reflex_boost_timer,0);
    }
    _bonus_reflex_boost_timer = (float)bonus_entry[6] * local_10[0] + _bonus_reflex_boost_timer;
    if (0 < (int)config_blob.reserved0._20_4_) {
      puVar5 = player_health._pad0 + 0x2a8;
      iVar4 = config_blob.reserved0._20_4_;
      do {
        *(undefined4 *)puVar5 = *(undefined4 *)(puVar5 + -8);
        puVar5[4] = '\0';
        puVar5[5] = '\0';
        puVar5[6] = '\0';
        puVar5[7] = '\0';
        puVar5 = puVar5 + 0x360;
        iVar4 = iVar4 + -1;
      } while (iVar4 != 0);
    }
    local_10[1] = 0.6;
    local_10[0] = 0.6;
    _effect_template_color_g = 0x3f19999a;
    local_10[2] = 1.0;
    local_10[3] = 1.0;
    _effect_template_color_r = 0x3f19999a;
    _effect_template_flags = 0x19;
    _effect_template_color_b = 0x3f800000;
    _effect_template_color_a = 0x3f800000;
    _effect_template_lifetime = 0x3e800000;
    _effect_template_age = 0;
    _effect_template_half_width = 0x42000000;
    _effect_template_half_height = 0x42000000;
    _effect_template_rotation = 0.0;
    effect_template_vel_x = 0.0;
    effect_template_vel_y = 0.0;
    _effect_template_scale_step = 0x42480000;
    effect_spawn(1,(float *)(bonus_entry + 4));
    _effect_template_rotation = 0.0;
    effect_template_vel_x = 0.0;
    effect_template_vel_y = 0.0;
  }
  else if (iVar4 == 4) {
    if (_bonus_weapon_power_up_timer <= 0.0) {
      FUN_0041a810(DAT_00485420,DAT_00485428,&bonus_weapon_power_up_timer,0);
    }
    _bonus_weapon_power_up_timer =
         (float)bonus_entry[6] * local_10[0] + _bonus_weapon_power_up_timer;
    ppVar1 = &player_health + player_index;
    ppVar1->_pad0[0x3c] = '\0';
    ppVar1->_pad0[0x3d] = '\0';
    ppVar1->_pad0[0x3e] = '\0';
    ppVar1->_pad0[0x3f] = '\0';
    ppVar1 = &player_health + player_index;
    ppVar1->_pad0[0x2b0] = '\0';
    ppVar1->_pad0[0x2b1] = '\0';
    ppVar1->_pad0[0x2b2] = '\0';
    ppVar1->_pad0[0x2b3] = '\0';
    ppVar1 = &player_health + player_index;
    ppVar1->_pad0[0x2ac] = '\0';
    ppVar1->_pad0[0x2ad] = '\0';
    ppVar1->_pad0[0x2ae] = '\0';
    ppVar1->_pad0[0x2af] = '\0';
    *(undefined4 *)((&player_health)[player_index]._pad0 + 0x2a8) =
         *(undefined4 *)((&player_health)[player_index]._pad0 + 0x2a0);
  }
  else if (iVar4 == 0xd) {
    if (((float)player_health._pad0._752_4_ <= 0.0) && (player2_speed_bonus_timer <= 0.0)) {
      FUN_0041a810(DAT_004854d4,DAT_004854dc,0x490bc4,&player2_speed_bonus_timer);
    }
    *(float *)((&player_health)[player_index]._pad0 + 0x2f0) =
         (float)bonus_entry[6] * local_10[0] +
         *(float *)((&player_health)[player_index]._pad0 + 0x2f0);
  }
  else if (iVar4 == 0xb) {
    if (_bonus_freeze_timer <= 0.0) {
      FUN_0041a810(DAT_004854ac,DAT_004854b4,&bonus_freeze_timer,0);
    }
    pfVar8 = &creature_pool.pos_x;
    _bonus_freeze_timer = (float)bonus_entry[6] * local_10[0] + _bonus_freeze_timer;
    do {
      if ((((creature_t *)(pfVar8 + -5))->active != '\0') && (pfVar8[4] <= 0.0)) {
        iVar4 = 8;
        do {
          iVar6 = crt_rand();
          effect_spawn_freeze_shard(pfVar8,(float)(iVar6 % 0x264) * 0.01);
          iVar4 = iVar4 + -1;
        } while (iVar4 != 0);
        iVar4 = crt_rand();
        effect_spawn_freeze_shatter(pfVar8,(float)(iVar4 % 0x264) * 0.01);
        ((creature_t *)(pfVar8 + -5))->active = '\0';
      }
      pfVar8 = pfVar8 + 0x26;
    } while ((int)pfVar8 < 0x4aa34c);
    local_10[0] = 0.3;
    local_10[1] = 0.5;
    local_10[2] = 0.8;
    local_10[3] = 1.0;
    _effect_template_color_r = 0x3e99999a;
    _effect_template_flags = 0x19;
    _effect_template_color_g = 0x3f000000;
    _effect_template_color_b = 0x3f4ccccd;
    _effect_template_color_a = 0x3f800000;
    _effect_template_lifetime = 0x3e800000;
    _effect_template_age = 0;
    _effect_template_half_width = 0x42000000;
    _effect_template_half_height = 0x42000000;
    _effect_template_rotation = 0.0;
    effect_template_vel_x = 0.0;
    effect_template_vel_y = 0.0;
    _effect_template_scale_step = 0x42480000;
    effect_spawn(1,(float *)(bonus_entry + 4));
    sfx_play_panned(sfx_shockwave);
    _effect_template_rotation = 0.0;
    effect_template_vel_x = 0.0;
    effect_template_vel_y = 0.0;
  }
  else if (iVar4 == 10) {
    if (((float)player_health._pad0._756_4_ <= 0.0) && (player2_shield_timer <= 0.0)) {
      FUN_0041a810(DAT_00485498,DAT_004854a0,0x490bc8,&player2_shield_timer);
    }
    *(float *)((&player_health)[player_index]._pad0 + 0x2f4) =
         (float)bonus_entry[6] * local_10[0] +
         *(float *)((&player_health)[player_index]._pad0 + 0x2f4);
  }
  else if (iVar4 == 7) {
    bonus_spawn_guard = 1;
    if (*(float *)((int)cv_friendlyFire + 0xc) == 0.0) {
      iVar4 = -100;
    }
    else {
      iVar4 = -1 - player_index;
    }
    pfVar8 = (float *)(bonus_entry + 4);
    shock_chain_links_left = 0x20;
    iVar6 = creature_find_nearest(pfVar8,-1,0.0);
    fVar10 = (float10)fpatan((float10)(&creature_pool)[iVar6].pos_y - (float10)(float)bonus_entry[5]
                             ,(float10)(&creature_pool)[iVar6].pos_x - (float10)*pfVar8);
    shock_chain_projectile_id =
         projectile_spawn(pfVar8,(float)((fVar10 - (float10)1.5707964) - (float10)3.1415927),0x15,
                          iVar4);
    bonus_spawn_guard = 0;
    sfx_play_panned(sfx_shock_hit_01);
  }
  else if (iVar4 == 8) {
    bonus_spawn_guard = 1;
    if (*(float *)((int)cv_friendlyFire + 0xc) == 0.0) {
      iVar4 = -100;
    }
    else {
      iVar4 = -1 - player_index;
    }
    player_index = 0;
    do {
      projectile_spawn((float *)(bonus_entry + 4),(float)player_index * 0.3926991,9,iVar4);
      player_index = player_index + 1;
    } while (player_index < 0x10);
    bonus_spawn_guard = 0;
    sfx_play_panned(sfx_explosion_medium);
  }
  else if (iVar4 == 0xe) {
    if (((float)player_health._pad0._760_4_ <= 0.0) && (player2_fire_bullets_timer <= 0.0)) {
      FUN_0041a810(DAT_004854e8,DAT_004854f0,0x490bcc,&player2_fire_bullets_timer);
    }
    *(float *)((&player_health)[player_index]._pad0 + 0x2f8) =
         local_10[0] * 5.0 + *(float *)((&player_health)[player_index]._pad0 + 0x2f8);
    ppVar1 = &player_health + player_index;
    ppVar1->_pad0[0x3c] = '\0';
    ppVar1->_pad0[0x3d] = '\0';
    ppVar1->_pad0[0x3e] = '\0';
    ppVar1->_pad0[0x3f] = '\0';
    ppVar1 = &player_health + player_index;
    ppVar1->_pad0[0x2b0] = '\0';
    ppVar1->_pad0[0x2b1] = '\0';
    ppVar1->_pad0[0x2b2] = '\0';
    ppVar1->_pad0[0x2b3] = '\0';
    ppVar1 = &player_health + player_index;
    ppVar1->_pad0[0x2ac] = '\0';
    ppVar1->_pad0[0x2ad] = '\0';
    ppVar1->_pad0[0x2ae] = '\0';
    ppVar1->_pad0[0x2af] = '\0';
    *(undefined4 *)((&player_health)[player_index]._pad0 + 0x2a8) =
         *(undefined4 *)((&player_health)[player_index]._pad0 + 0x2a0);
  }
  else if (iVar4 == 2) {
    if (_bonus_energizer_timer <= 0.0) {
      FUN_0041a810(DAT_004853f8,DAT_00485400,&bonus_energizer_timer,0);
    }
    _bonus_energizer_timer = local_10[0] * 8.0 + _bonus_energizer_timer;
  }
  else if (iVar4 == 6) {
    if (_bonus_double_xp_timer <= 0.0) {
      FUN_0041a810(DAT_00485448,DAT_00485450,&bonus_double_xp_timer,0);
    }
    _bonus_double_xp_timer = local_10[0] * 6.0 + _bonus_double_xp_timer;
  }
  else if (iVar4 == 5) {
    uVar7 = crt_rand();
    iVar4 = (uVar7 & 3) + 4;
    if (iVar4 != 0) {
      do {
        owner_id = -100;
        iVar11 = 1;
        iVar6 = crt_rand();
        iVar6 = projectile_spawn((float *)(bonus_entry + 4),(float)(iVar6 % 0x274) * 0.01,iVar11,
                                 owner_id);
        if (iVar6 != -1) {
          iVar11 = crt_rand();
          (&projectile_pool)[iVar6].speed_scale =
               ((float)(iVar11 % 0x32) * 0.01 + 0.5) * (&projectile_pool)[iVar6].speed_scale;
        }
        iVar4 = iVar4 + -1;
      } while (iVar4 != 0);
    }
    iVar11 = -100;
    iVar6 = 6;
    pfVar8 = (float *)(bonus_entry + 4);
    iVar4 = crt_rand();
    projectile_spawn(pfVar8,(float)(iVar4 % 0x274) * 0.01,iVar6,iVar11);
    iVar11 = -100;
    iVar6 = 6;
    iVar4 = crt_rand();
    projectile_spawn(pfVar8,(float)(iVar4 % 0x274) * 0.01,iVar6,iVar11);
    effect_spawn_explosion_burst(pfVar8,1.0);
    camera_shake_pulses = 0x14;
    _camera_shake_timer = 0x3e4ccccd;
    bonus_spawn_guard = 1;
    iVar4 = 0;
    pcVar9 = &creature_pool;
    do {
      if ((((pcVar9->active != '\0') && (ABS(pcVar9->pos_x - *pfVar8) <= 256.0)) &&
          (ABS(pcVar9->pos_y - (float)bonus_entry[5]) <= 256.0)) &&
         (fVar2 = pcVar9->pos_x - *pfVar8, fVar3 = pcVar9->pos_y - (float)bonus_entry[5],
         fVar2 = 256.0 - SQRT(fVar3 * fVar3 + fVar2 * fVar2), 0.0 < fVar2)) {
        local_10[0] = 0.0;
        local_10[1] = 0.0;
        creature_apply_damage(iVar4,fVar2 * 5.0,3,local_10);
      }
      pcVar9 = pcVar9 + 1;
      iVar4 = iVar4 + 1;
    } while ((int)pcVar9 < 0x4aa338);
    bonus_spawn_guard = 0;
    sfx_play_panned(sfx_explosion_large);
    sfx_play_panned(sfx_shockwave);
  }
  else if (iVar4 == 1) {
    player_health._pad0._136_4_ = player_health._pad0._136_4_ + bonus_entry[6];
  }
  local_10[0] = 0.4;
  local_10[1] = 0.5;
  local_10[2] = 1.0;
  local_10[3] = 0.5;
  _effect_template_color_r = 0x3ecccccd;
  _effect_template_flags = 0x1d;
  _effect_template_color_g = 0x3f000000;
  _effect_template_color_b = 0x3f800000;
  _effect_template_color_a = 0x3f000000;
  _effect_template_lifetime = 0x3ecccccd;
  _effect_template_half_width = 0x42000000;
  _effect_template_half_height = 0x42000000;
  if (*bonus_entry != 5) {
    iVar4 = 0xc;
    do {
      uVar7 = crt_rand();
      _effect_template_rotation = (float)(uVar7 & 0x7f) * 0.049087387;
      uVar7 = crt_rand();
      uVar7 = uVar7 & 0x8000007f;
      if ((int)uVar7 < 0) {
        uVar7 = (uVar7 - 1 | 0xffffff80) + 1;
      }
      effect_template_vel_x = (float)(int)(uVar7 - 0x40);
      uVar7 = crt_rand();
      uVar7 = uVar7 & 0x8000007f;
      if ((int)uVar7 < 0) {
        uVar7 = (uVar7 - 1 | 0xffffff80) + 1;
      }
      effect_template_vel_y = (float)(int)(uVar7 - 0x40);
      _effect_template_scale_step = 0x3dcccccd;
      effect_spawn(0,(float *)(bonus_entry + 4));
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
  }
  return;
}



/* bonus_update @ 0040a320 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* updates bonus lifetimes and handles player pickups */

void bonus_update(void)

{
  char cVar1;
  float fVar2;
  int iVar3;
  float *pfVar4;
  
  if (render_pass_mode != '\0') {
    pfVar4 = (float *)&bonus_time_left;
    iVar3 = config_blob.reserved0._20_4_;
    do {
      if (pfVar4[-2] != 0.0) {
        cVar1 = *(char *)(pfVar4 + -1);
        if (cVar1 == '\0') {
          fVar2 = *pfVar4 - frame_dt;
        }
        else {
          fVar2 = *pfVar4 - frame_dt * 3.0;
        }
        *pfVar4 = fVar2;
        if ((cVar1 == '\0') && (config_blob.reserved0._24_4_ == 8)) {
          *pfVar4 = 5.0;
        }
        if (*pfVar4 < 0.0) {
          pfVar4[-2] = 0.0;
        }
        if (cVar1 == '\0') {
          render_overlay_player_index = 0;
          if (0 < iVar3) {
            do {
              if (SQRT((pfVar4[3] - (float)(&player_pos_y)[render_overlay_player_index * 0xd8]) *
                       (pfVar4[3] - (float)(&player_pos_y)[render_overlay_player_index * 0xd8]) +
                       (pfVar4[2] - (float)(&player_pos_x)[render_overlay_player_index * 0xd8]) *
                       (pfVar4[2] - (float)(&player_pos_x)[render_overlay_player_index * 0xd8])) <
                  26.0) {
                bonus_apply(render_overlay_player_index,(int *)(pfVar4 + -2));
                iVar3 = config_blob.reserved0._20_4_;
                *(undefined1 *)(pfVar4 + -1) = 1;
                *pfVar4 = 0.5;
              }
              render_overlay_player_index = render_overlay_player_index + 1;
            } while (render_overlay_player_index < iVar3);
          }
        }
      }
      pfVar4 = pfVar4 + 7;
    } while ((int)pfVar4 < 0x482b10);
    render_overlay_player_index = 0;
    if (_bonus_freeze_timer <= 0.0) {
      _bonus_freeze_timer = 0.0;
    }
    else {
      _bonus_freeze_timer = _bonus_freeze_timer - frame_dt;
    }
    if (_bonus_double_xp_timer <= 0.0) {
      _bonus_double_xp_timer = 0.0;
    }
    else {
      _bonus_double_xp_timer = _bonus_double_xp_timer - frame_dt;
    }
    if (0.0 <= _DAT_004aaf2c) {
      _DAT_004aaf2c = (_DAT_004aaf2c + 1.0) * frame_dt * 1.8 + _DAT_004aaf2c;
    }
  }
  return;
}



/* ui_draw_clock_gauge_at @ 0040a4c0 */

/* draws the clock gauge at a position when progress > 0 */

void __cdecl ui_draw_clock_gauge_at(float *xy,float radius,float progress)

{
  if (0.0 < progress) {
    __ftol();
    __ftol();
    __ftol();
    ui_draw_clock_gauge();
  }
  return;
}



/* ui_render_aim_indicators @ 0040a510 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders aim reticles, reload gauges, and player HUD indicators */

void ui_render_aim_indicators(void)

{
  IGrim2D_vtbl *pIVar1;
  IGrim2D *unaff_EBX;
  float unaff_ESI;
  int iVar2;
  IGrim2D *unaff_EDI;
  float10 fVar3;
  float10 fVar4;
  uint value;
  IGrim2D *pIVar5;
  float fVar6;
  float in_stack_ffffffb0;
  float in_stack_ffffffb4;
  undefined *in_stack_ffffffb8;
  float fVar7;
  float fVar8;
  float a;
  
  if (demo_mode_active == '\0') {
    if ((DAT_00480340 & 1) == 0) {
      in_stack_ffffffb8 = &DAT_0040aaa0;
      DAT_00480340 = DAT_00480340 | 1;
      in_stack_ffffffb4 = 5.936756e-39;
      crt_atexit(&DAT_0040aaa0);
    }
    if ((DAT_00480340 & 2) == 0) {
      in_stack_ffffffb8 = &DAT_0040aa90;
      DAT_00480340 = DAT_00480340 | 2;
      in_stack_ffffffb4 = 5.936808e-39;
      crt_atexit(&DAT_0040aa90);
    }
    value = 0x13;
    fVar6 = 7.00649e-45;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)in_stack_ffffffb0);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,value);
    render_overlay_player_index = 0;
    iVar2 = config_blob.reserved0._20_4_;
    if (0 < (int)config_blob.reserved0._20_4_) {
      do {
        if (0.0 < *(float *)(&player_health)[render_overlay_player_index]._pad0) {
          fVar7 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2c) -
                  (float)(&player_pos_x)[render_overlay_player_index * 0xd8];
          fVar8 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x30) -
                  (float)(&player_pos_y)[render_overlay_player_index * 0xd8];
          fVar7 = SQRT(fVar7 * fVar7 + fVar8 * fVar8) *
                  *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x294) * 0.5;
          if (fVar7 < 6.0) {
            fVar7 = 6.0;
          }
          (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x3f000000,0.5,0.5,0.5,fVar6);
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x0,0.0,0.1,0.3,in_stack_ffffffb0);
          aim_screen_x = _camera_offset_x +
                         *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2c);
          aim_screen_y = _camera_offset_y +
                         *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x30);
          fVar8 = unaff_ESI;
          pIVar5 = (IGrim2D *)aim_screen_x;
          a = aim_screen_y;
          (*grim_interface_ptr->vtable->grim_draw_circle_filled)
                    ((IGrim2D *)aim_screen_x,aim_screen_y,unaff_ESI,in_stack_ffffffb4);
          (*grim_interface_ptr->vtable->grim_bind_texture)(bullet_trail_texture,0,(int)fVar7);
          (*grim_interface_ptr->vtable->grim_set_uv)
                    ((IGrim2D *)0x3f000000,0.0,0.5,1.0,(float)unaff_EDI);
          in_stack_ffffffb0 = 1.0;
          fVar6 = 5.937391e-39;
          (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.55,fVar8);
          (*grim_interface_ptr->vtable->grim_draw_circle_outline)
                    ((IGrim2D *)aim_screen_x,aim_screen_y,unaff_ESI,(float)unaff_EBX);
          in_stack_ffffffb4 = 5.93748e-39;
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f800000,0.7,0.1,0.8,(float)pIVar5);
          aim_screen_x = _camera_offset_x +
                         *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2c);
          aim_screen_y = _camera_offset_y +
                         *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x30);
          ui_draw_clock_gauge_at
                    (&aim_screen_x,48.0,
                     *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2ac) /
                     *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2b4));
          unaff_EBX = (IGrim2D *)0x3f800000;
          unaff_ESI = 1.0;
          unaff_EDI = (IGrim2D *)0x3f800000;
          in_stack_ffffffb8 = (undefined *)0x40a7cd;
          (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.7,a);
          iVar2 = config_blob.reserved0._20_4_;
        }
        render_overlay_player_index = render_overlay_player_index + 1;
      } while (render_overlay_player_index < iVar2);
    }
    render_overlay_player_index = 0;
    if (0 < iVar2) {
      do {
        if ((0.0 < *(float *)(&player_health)[render_overlay_player_index]._pad0) &&
           (config_blob.reserved0[render_overlay_player_index + 4] != '\0')) {
          (*grim_interface_ptr->vtable->grim_set_rotation)
                    (*(IGrim2D **)((&player_health)[render_overlay_player_index]._pad0 + 8),fVar6);
          (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7d8,0,(int)in_stack_ffffffb0);
          (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,in_stack_ffffffb4);
          if (config_blob.reserved0._20_4_ == 2) {
            if (render_overlay_player_index == 0) {
              pIVar1 = grim_interface_ptr->vtable;
              fVar7 = 0.6;
              fVar6 = 0.9;
              pIVar5 = (IGrim2D *)0x3f4ccccd;
              goto LAB_0040a8dc;
            }
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)0x3f800000,0.9,0.8,0.6,(float)in_stack_ffffffb8);
          }
          else {
            fVar7 = 0.3;
            fVar6 = 1.0;
            pIVar1 = grim_interface_ptr->vtable;
            pIVar5 = (IGrim2D *)0x3f800000;
LAB_0040a8dc:
            (*pIVar1->grim_set_color)(pIVar5,fVar6,1.0,fVar7,(float)in_stack_ffffffb8);
          }
          (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_EDI);
          if (*(int *)(config_blob.reserved0 + render_overlay_player_index * 4 + 0x1c) == 4) {
            fVar6 = _camera_offset_x +
                    *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x300);
            aim_screen_y = (_camera_offset_y +
                           *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x304))
                           - 16.0;
          }
          else {
            fVar3 = (float10)*(float *)((&player_health)[render_overlay_player_index]._pad0 + 8) -
                    (float10)1.5707964;
            fVar4 = (float10)fcos(fVar3);
            fVar3 = (float10)fsin(fVar3);
            fVar6 = _camera_offset_x + (float)(&player_pos_x)[render_overlay_player_index * 0xd8] +
                    (float)fVar4 * 60.0;
            aim_screen_y = (float)((fVar3 * (float10)60.0 +
                                   (float10)(_camera_offset_y +
                                            (float)(&player_pos_y)
                                                   [render_overlay_player_index * 0xd8])) -
                                  (float10)16.0);
          }
          aim_screen_x = fVar6 - 16.0;
          unaff_EDI = (IGrim2D *)0x42000000;
          in_stack_ffffffb8 = (undefined *)0x42000000;
          fVar6 = 5.938417e-39;
          in_stack_ffffffb0 = aim_screen_x;
          in_stack_ffffffb4 = aim_screen_y;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)aim_screen_x,aim_screen_y,32.0,32.0,unaff_ESI);
          unaff_ESI = 5.938437e-39;
          (*grim_interface_ptr->vtable->grim_end_batch)(unaff_EBX);
          iVar2 = config_blob.reserved0._20_4_;
        }
        render_overlay_player_index = render_overlay_player_index + 1;
      } while (render_overlay_player_index < iVar2);
    }
    render_overlay_player_index = 0;
    if (0 < iVar2) {
      do {
        if (0.0 < *(float *)(&player_health)[render_overlay_player_index]._pad0) {
          ui_render_aim_enhancement();
          iVar2 = config_blob.reserved0._20_4_;
        }
        render_overlay_player_index = render_overlay_player_index + 1;
      } while (render_overlay_player_index < iVar2);
    }
    render_overlay_player_index = 0;
  }
  return;
}



/* gameplay_update_and_render @ 0040aab0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* main gameplay frame loop for state 9 (timers, updates, renders, UI) */

void gameplay_update_and_render(void)

{
  int iVar1;
  player_state_t *ppVar2;
  uint unaff_EBX;
  int unaff_EBP;
  float unaff_ESI;
  IGrim2D *unaff_EDI;
  longlong lVar3;
  float unaff_retaddr;
  float in_stack_00000004;
  float in_stack_00000008;
  float in_stack_0000000c;
  float in_stack_00000010;
  float key;
  
  key = frame_dt;
  if (time_scale_active != '\0') {
    _time_scale_factor = 0.3;
    if (_bonus_reflex_boost_timer < 1.0) {
      _time_scale_factor = (1.0 - _bonus_reflex_boost_timer) * 0.7 + 0.3;
    }
    frame_dt = _time_scale_factor * frame_dt;
    lVar3 = __ftol();
    frame_dt_ms = (int)lVar3;
  }
  if (demo_mode_active == '\0') {
    iVar1 = game_is_full_version();
    if (((char)iVar1 == '\0') && (config_blob.reserved0._24_4_ != 8)) {
      game_status_blob.game_sequence_id = game_sequence_get();
      if ((int)game_status_blob.game_sequence_id < 0x249f01) {
        if (DAT_0048084c < 1) {
          if (config_blob.reserved0._24_4_ != 3) goto LAB_0040abea;
        }
        else if ((config_blob.reserved0._24_4_ != 3) ||
                (5.0 < (float)(DAT_0048084c / 1000) * 0.016666668)) goto LAB_0040abae;
        if ((game_state_id != 9) || ((_quest_stage_major < 2 && (_quest_stage_minor < 0xb))))
        goto LAB_0040abea;
      }
LAB_0040abae:
      frame_dt_ms = 0;
      frame_dt = 0.0;
      goto LAB_0040abf9;
    }
LAB_0040abea:
    if (game_paused_flag != '\0') goto LAB_0040abae;
LAB_0040ac01:
    if (console_open_flag == '\0') {
      perks_update_effects();
    }
  }
  else {
LAB_0040abf9:
    if (game_paused_flag == '\0') goto LAB_0040ac01;
  }
  effects_update();
  if (((demo_mode_active == '\0') && (iVar1 = game_is_full_version(), (char)iVar1 == '\0')) &&
     (config_blob.reserved0._24_4_ != 8)) {
    game_status_blob.game_sequence_id = game_sequence_get();
    if ((int)game_status_blob.game_sequence_id < 0x249f01) {
      if (DAT_0048084c < 1) {
        if (config_blob.reserved0._24_4_ != 3) goto LAB_0040aca0;
      }
      else if ((config_blob.reserved0._24_4_ != 3) ||
              (5.0 < (float)(DAT_0048084c / 1000) * 0.016666668)) goto LAB_0040acbb;
      if ((game_state_id != 9) || ((_quest_stage_major < 2 && (_quest_stage_minor < 0xb))))
      goto LAB_0040aca0;
    }
  }
  else {
LAB_0040aca0:
    if ((game_paused_flag == '\0') && (game_state_id == 9)) {
      creature_update_all();
      projectile_update();
    }
  }
LAB_0040acbb:
  if (((demo_mode_active == '\0') && (iVar1 = game_is_full_version(), (char)iVar1 == '\0')) &&
     (config_blob.reserved0._24_4_ != 8)) {
    game_status_blob.game_sequence_id = game_sequence_get();
    if ((int)game_status_blob.game_sequence_id < 0x249f01) {
      if (DAT_0048084c < 1) {
        if (config_blob.reserved0._24_4_ != 3) goto LAB_0040ad54;
      }
      else if ((config_blob.reserved0._24_4_ != 3) ||
              (5.0 < (float)(DAT_0048084c / 1000) * 0.016666668)) goto LAB_0040ad8e;
      if ((game_state_id != 9) || ((_quest_stage_major < 2 && (_quest_stage_minor < 0xb))))
      goto LAB_0040ad54;
    }
  }
  else {
LAB_0040ad54:
    if ((game_paused_flag == '\0') &&
       ((game_state_id == 9 &&
        (render_overlay_player_index = 0, 0 < (int)config_blob.reserved0._20_4_)))) {
      do {
        player_update();
        render_overlay_player_index = render_overlay_player_index + 1;
      } while (render_overlay_player_index < (int)config_blob.reserved0._20_4_);
    }
  }
LAB_0040ad8e:
  render_overlay_player_index = 0;
  if (config_blob.reserved0._24_4_ == 1) {
    survival_update();
  }
  if (config_blob.reserved0._24_4_ == 2) {
    rush_mode_update();
  }
  if (config_blob.reserved0._24_4_ == 3) {
    quest_mode_update();
  }
  highscore_active_record.score_xp._0_1_ = player_health._pad0[0x88];
  highscore_active_record.score_xp._1_1_ = player_health._pad0[0x89];
  highscore_active_record.score_xp._2_1_ = player_health._pad0[0x8a];
  highscore_active_record.score_xp._3_1_ = player_health._pad0[0x8b];
  if ((console_open_flag == '\0') && (game_paused_flag == '\0')) {
    if (0.0 < _bonus_weapon_power_up_timer) {
      _bonus_weapon_power_up_timer = _bonus_weapon_power_up_timer - frame_dt;
    }
    if (0.0 < _bonus_energizer_timer) {
      _bonus_energizer_timer = _bonus_energizer_timer - frame_dt;
    }
    time_scale_active = 0.0 < _bonus_reflex_boost_timer;
    if ((bool)time_scale_active) {
      _bonus_reflex_boost_timer = _bonus_reflex_boost_timer - frame_dt;
    }
    highscore_active_record.survival_elapsed_ms =
         highscore_active_record.survival_elapsed_ms + frame_dt_ms;
    (&DAT_0048708c)[player_health._pad0._668_4_] =
         (&DAT_0048708c)[player_health._pad0._668_4_] + frame_dt_ms;
  }
  camera_update();
  gameplay_render_world();
  if (config_blob.reserved0._24_4_ == 8) {
    tutorial_timeline_update();
  }
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_ESI);
  if (demo_mode_active == '\0') {
    if ((((float)player_health._pad0._0_4_ <= 0.0) && (player_death_timer < 0.0)) &&
       ((config_blob.reserved0._20_4_ == 1 ||
        ((player2_health <= 0.0 && ((float)player_health._pad1._16_4_ < 0.0)))))) {
      render_pass_mode = 0;
      ui_transition_direction = 0;
      game_state_pending = (-(uint)(config_blob.reserved0._24_4_ != 3) & 0xfffffffb) + 0xc;
      (*grim_interface_ptr->vtable->grim_flush_input)(unaff_EDI);
      console_input_poll();
      sfx_mute_all(music_track_extra_0);
      sfx_mute_all(music_track_crimson_theme_id);
      sfx_mute_all(music_track_shortie_monk_id);
      sfx_play_exclusive(music_track_shortie_monk_id);
    }
  }
  else {
    ppVar2 = &player_health;
    do {
      ppVar2->_pad0[0] = '\0';
      ppVar2->_pad0[1] = '\0';
      ppVar2->_pad0[2] = 200;
      ppVar2->_pad0[3] = 'B';
      ppVar2 = ppVar2 + 1;
    } while ((int)ppVar2 < 0x490f94);
  }
  if (config_blob.reserved0._24_4_ != 2) {
    crt_ci_pow();
    lVar3 = __ftol();
    if (1000 - (int)lVar3 < (int)player_health._pad0._136_4_) {
      perk_pending_count = perk_pending_count + 1;
      config_blob.perk_prompt_counter = config_blob.perk_prompt_counter + 1;
      if (0x32 < config_blob.perk_prompt_counter) {
        config_blob.perk_prompt_counter = 0;
        config_blob.full_version = '\0';
      }
      sfx_play(sfx_ui_levelup);
      player_health._pad0._144_4_ = player_health._pad0._144_4_ + 1;
    }
  }
  if ((console_open_flag == '\0') && (game_paused_flag == '\0')) {
    if (perk_prompt_hover_active == '\0') {
      iVar1 = -frame_dt_ms;
    }
    else {
      iVar1 = frame_dt_ms * 3;
    }
    perk_prompt_pulse = perk_prompt_pulse + iVar1 * 2;
    if (perk_prompt_pulse < 0) {
      perk_prompt_pulse = 0;
    }
    else if (1000 < perk_prompt_pulse) {
      perk_prompt_pulse = 1000;
    }
  }
  if (((((demo_mode_active == '\0') && (game_paused_flag == '\0')) && (mouse_button_down == '\0'))
      && ((config_blob.reserved0._24_4_ != 2 && (0 < perk_pending_count)))) &&
     ((0.0 < (float)player_health._pad0._0_4_ ||
      ((config_blob.reserved0._20_4_ == 2 && (0.0 < player2_health)))))) {
    unaff_retaddr = ui_mouse_x - _perk_prompt_origin_x;
    in_stack_00000004 = ui_mouse_y - _perk_prompt_origin_y;
    if (game_state_pending != 6) {
      iVar1 = (*grim_interface_ptr->vtable->grim_is_key_active)
                        ((IGrim2D *)config_blob.key_pick_perk,unaff_EBP);
      if ((char)iVar1 == '\0') {
        unaff_EBP = 0x39;
        iVar1 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x39,unaff_EBX);
        if ((char)iVar1 != '\0') goto LAB_0040b1af;
        unaff_EBX = 0x4e;
        unaff_EBP = 0x40b145;
        iVar1 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x4e,(uint)key);
        if ((char)iVar1 != '\0') goto LAB_0040b1af;
        if ((((in_stack_0000000c <= perk_prompt_bounds_min_x) ||
             (in_stack_00000010 <= perk_prompt_bounds_min_y)) ||
            (_perk_prompt_bounds_max_x <= in_stack_0000000c)) ||
           (_perk_prompt_bounds_max_y <= in_stack_00000010)) {
          perk_prompt_hover_active = '\0';
          goto LAB_0040b1d3;
        }
        perk_prompt_hover_active = '\x01';
        iVar1 = input_primary_just_pressed();
        if ((char)iVar1 == '\0') goto LAB_0040b1d3;
      }
      else {
LAB_0040b1af:
        perk_prompt_pulse = 1000;
      }
      if (perk_choices_dirty != '\0') {
        perks_generate_choices();
        perk_choices_dirty = '\0';
      }
      game_state_set(6);
    }
  }
LAB_0040b1d3:
  iVar1 = (*grim_interface_ptr->vtable->grim_is_mouse_button_down)((IGrim2D *)0x0,unaff_EBP);
  mouse_button_down = (char)iVar1 != '\0';
  bonus_update();
  frame_dt = unaff_retaddr;
  lVar3 = __ftol();
  frame_dt_ms = (int)lVar3;
  if (((demo_mode_active == '\0') && (perk_prompt_update_and_render(), demo_mode_active == '\0')) &&
     ((iVar1 = game_is_full_version(), (char)iVar1 == '\0' && (config_blob.reserved0._24_4_ != 8))))
  {
    game_status_blob.game_sequence_id = game_sequence_get();
    if ((int)game_status_blob.game_sequence_id < 0x249f01) {
      if (DAT_0048084c < 1) {
        if (config_blob.reserved0._24_4_ != 3) goto LAB_0040b2ad;
      }
      else if ((config_blob.reserved0._24_4_ != 3) ||
              (in_stack_00000004 = (float)(DAT_0048084c / 1000),
              5.0 < (float)(int)in_stack_00000004 * 0.016666668)) goto LAB_0040b2b2;
      if ((game_state_id != 9) || ((_quest_stage_major < 2 && (_quest_stage_minor < 0xb))))
      goto LAB_0040b2ad;
    }
  }
  else {
LAB_0040b2ad:
    ui_render_aim_indicators();
  }
LAB_0040b2b2:
  hud_update_and_render();
  ui_elements_update_and_render();
  iVar1 = game_is_full_version();
  if ((char)iVar1 == '\0') {
    if (((demo_mode_active == '\0') && (iVar1 = game_is_full_version(), (char)iVar1 == '\0')) &&
       (config_blob.reserved0._24_4_ != 8)) {
      game_status_blob.game_sequence_id = game_sequence_get();
      if ((int)game_status_blob.game_sequence_id < 0x249f01) {
        if (DAT_0048084c < 1) {
          if (config_blob.reserved0._24_4_ != 3) goto LAB_0040b3bd;
        }
        else if ((config_blob.reserved0._24_4_ != 3) ||
                (in_stack_00000004 = (float)(DAT_0048084c / 1000),
                5.0 < (float)(int)in_stack_00000004 * 0.016666668)) goto LAB_0040b35f;
        if ((game_state_id != 9) || ((_quest_stage_major < 2 && (_quest_stage_minor < 0xb))))
        goto LAB_0040b3bd;
      }
LAB_0040b35f:
      DAT_00480898 = DAT_00480898 + frame_dt_ms;
      in_stack_00000004 = (float)config_blob.screen_width * 0.5 - 256.0;
      in_stack_00000008 = (float)config_blob.screen_height * 0.5 - 128.0;
      demo_trial_overlay_render(&stack0x00000004,1.0);
      DAT_00480850 = 1;
    }
    else {
LAB_0040b3bd:
      DAT_00480898 = DAT_00480898 - frame_dt_ms;
      DAT_00480850 = 0;
    }
    if (DAT_00480898 < 0) {
      DAT_00480898 = 0;
    }
    else if (1000 < DAT_00480898) {
      DAT_00480898 = 1000;
    }
  }
  iVar1 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x3b,unaff_EBX);
  if ((char)iVar1 != '\0') {
    game_paused_flag = game_paused_flag == '\0';
  }
  iVar1 = game_is_full_version();
  if (((char)iVar1 == '\0') && (config_blob.reserved0._24_4_ != 8)) {
    game_status_blob.game_sequence_id = game_sequence_get();
    if ((int)game_status_blob.game_sequence_id < 0x249f01) {
      if (DAT_0048084c < 1) {
        if (config_blob.reserved0._24_4_ != 3) goto LAB_0040b4bc;
      }
      else if ((config_blob.reserved0._24_4_ != 3) ||
              (in_stack_00000008 = (float)(DAT_0048084c / 1000),
              5.0 < (float)(int)in_stack_00000008 * 0.016666668)) goto LAB_0040b494;
      if ((game_state_id != 9) || ((_quest_stage_major < 2 && (_quest_stage_minor < 0xb))))
      goto LAB_0040b4bc;
    }
LAB_0040b494:
    game_paused_flag = '\0';
LAB_0040b49a:
    DAT_00487284 = DAT_00487284 + frame_dt_ms * -4;
  }
  else {
LAB_0040b4bc:
    if (game_paused_flag == '\0') goto LAB_0040b49a;
    DAT_00487284 = DAT_00487284 + frame_dt_ms * 2;
  }
  if (DAT_00487284 < 0) {
    DAT_00487284 = 0;
  }
  else {
    if (DAT_00487284 < 0x3e9) {
      if (DAT_00487284 < 1) goto LAB_0040b52d;
    }
    else {
      DAT_00487284 = 1000;
    }
    in_stack_00000008 = (float)config_blob.screen_width * 0.5 - 256.0;
    in_stack_0000000c = (float)config_blob.screen_height * 0.5 - 128.0;
    ui_render_keybind_help(&stack0x00000008,(float)DAT_00487284 * 0.001);
  }
LAB_0040b52d:
  iVar1 = game_is_full_version();
  if ((char)iVar1 != '\0') {
    return;
  }
  if (config_blob.reserved0._24_4_ == 8) {
    return;
  }
  game_status_blob.game_sequence_id = game_sequence_get();
  if ((int)game_status_blob.game_sequence_id < 0x249f01) {
    if (DAT_0048084c < 1) {
      if (config_blob.reserved0._24_4_ != 3) {
        return;
      }
    }
    else if ((config_blob.reserved0._24_4_ != 3) ||
            (in_stack_00000008 = (float)(DAT_0048084c / 1000),
            5.0 < (float)(int)in_stack_00000008 * 0.016666668)) goto LAB_0040b5b4;
    if (game_state_id != 9) {
      return;
    }
    if ((_quest_stage_major < 2) && (_quest_stage_minor < 0xb)) {
      return;
    }
  }
LAB_0040b5b4:
  if (demo_mode_active == '\0') {
    ui_cursor_render();
  }
  return;
}



/* FUN_0040b5d0 @ 0040b5d0 */

/* [binja] int32_t* sub_40b5d0() */

int * FUN_0040b5d0(void)

{
  undefined4 *puVar1;
  float *pfVar2;
  projectile_t *ppVar3;
  player_state_t *ppVar4;
  
  puVar1 = &bonus_pool;
  do {
    *puVar1 = 0;
    puVar1 = puVar1 + 7;
  } while ((int)puVar1 < 0x482b08);
  pfVar2 = &creature_pool.health;
  do {
    ((creature_t *)(pfVar2 + -9))->active = '\0';
    *pfVar2 = -1.0;
    pfVar2 = pfVar2 + 0x26;
  } while ((int)pfVar2 < 0x4aa35c);
  ppVar3 = &projectile_pool;
  do {
    ppVar3->active = '\0';
    ppVar3 = ppVar3 + 1;
  } while ((int)ppVar3 < 0x493eb8);
  ppVar4 = &player_health;
  do {
    ppVar4[-1]._pad1[0] = '\0';
    ppVar4->_pad0[0] = '\0';
    ppVar4->_pad0[1] = '\0';
    ppVar4->_pad0[2] = 0x80;
    ppVar4->_pad0[3] = 0xbf;
    ppVar4 = ppVar4 + 1;
  } while ((int)ppVar4 < 0x490f94);
  return (int *)ppVar4;
}



/* FUN_0040b630 @ 0040b630 */

void FUN_0040b630(void)

{
  uchar uVar1;
  mod_interface_t *unaff_EBX;
  mod_interface_t *unaff_retaddr;
  
  if (plugin_interface_ptr == (mod_interface_t *)0x0) {
    game_state_pending = 0x14;
    ui_transition_direction = '\0';
    ui_elements_update_and_render();
    DAT_00471304 = '\x01';
    return;
  }
  if ((game_state_id == 0x16) && (DAT_00471304 != '\0')) {
    DAT_00471304 = '\0';
    DAT_004824d1 = '\0';
    sfx_mute_all(music_track_extra_0);
    FUN_0040b5d0();
    (*plugin_interface_ptr->vtable->Init)(unaff_EBX);
    (plugin_interface_ptr->parms).fields.onPause = '\0';
  }
  else {
    uVar1 = (*plugin_interface_ptr->vtable->Frame)(frame_dt_ms,(int)unaff_EBX);
    if (uVar1 == '\0') {
      DAT_004824d1 = '\0';
      (*plugin_interface_ptr->vtable->Shutdown)(unaff_retaddr);
      sfx_mute_all(music_track_extra_0);
      plugin_interface_ptr = (mod_interface_t *)0x0;
      FreeLibrary(DAT_004824d8);
      DAT_004824d8 = (HMODULE)0x0;
      DAT_00471304 = '\x01';
      game_state_pending = 0x14;
      ui_transition_direction = '\0';
    }
    else {
      DAT_004824d1 = '\x01';
    }
  }
  ui_elements_update_and_render();
  if (((ui_transition_direction == '\0') && (game_state_id == 0x16)) ||
     ((plugin_interface_ptr != (mod_interface_t *)0x0 &&
      ((DAT_004824d1 != '\0' && ((plugin_interface_ptr->parms).fields.drawMouseCursor != '\0'))))))
  {
    ui_cursor_render();
  }
  return;
}



/* demo_purchase_screen_update @ 0040b740 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* demo upsell screen: feature list, purchase link, and exit handling */

void demo_purchase_screen_update(void)

{
  char cVar1;
  IGrim2D_vtbl *pIVar2;
  float *y;
  int iVar3;
  IGrim2D *pIVar4;
  int iVar5;
  float fVar6;
  float h;
  float unaff_EBX;
  float unaff_EBP;
  uint unaff_ESI;
  uint unaff_EDI;
  float10 fVar7;
  longlong lVar8;
  float unaff_retaddr;
  float in_stack_00000004;
  char *text;
  float in_stack_0000000c;
  char *in_stack_00000010;
  float in_stack_00000014;
  char *in_stack_00000018;
  float in_stack_00000020;
  float in_stack_00000024;
  IGrim2D in_stack_00000028;
  float *in_stack_0000002c;
  float in_stack_00000030;
  float fStack00000034;
  IGrim2D IStack00000038;
  float fStack0000003c;
  undefined4 in_stack_00000040;
  undefined4 in_stack_00000044;
  undefined4 in_stack_00000048;
  float in_stack_0000004c;
  uint uVar9;
  float in_stack_ffffffd4;
  float in_stack_ffffffd8;
  undefined1 *handle;
  float in_stack_ffffffe4;
  float fVar10;
  IGrim2D *in_stack_ffffffec;
  int iVar11;
  float in_stack_fffffff0;
  int iVar12;
  char *in_stack_fffffff4;
  char *in_stack_fffffff8;
  char *text_00;
  char *in_stack_fffffffc;
  
  if ((ui_transition_direction != '\0') && (iVar3 = game_is_full_version(), (char)iVar3 != '\0')) {
    ui_transition_direction = '\0';
    game_state_pending = 0;
    demo_mode_active = 1;
    config_load_presets();
    sfx_mute_all(music_track_intro_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_play_exclusive(music_track_crimson_theme_id);
    ui_elements_update_and_render();
    ui_cursor_render();
    return;
  }
  if ((demo_purchase_screen_active == '\0') &&
     (((iVar3 = input_primary_just_pressed(), (char)iVar3 != '\0' ||
       (iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1,unaff_EDI),
       (char)iVar3 != '\0')) ||
      (iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x39,unaff_ESI),
      (char)iVar3 != '\0')))) {
    demo_purchase_screen_active = '\x01';
    demo_time_limit_ms = 16000;
  }
  if ((DAT_00480320 & 1) == 0) {
    DAT_00480320 = DAT_00480320 | 1;
    DAT_004802b6 = 1;
    DAT_004802c5 = 0;
    DAT_004802c4 = 0;
    _DAT_004802c0 = 0x3f800000;
    _DAT_004802bc = 0;
    _DAT_004802b0 = (char *)0x0;
    DAT_004802b4 = 0;
    DAT_004802b5 = 0;
    _DAT_004802b8 = 0;
    crt_atexit(&DAT_0040c1b0);
  }
  _DAT_004802b0 = s_Maybe_later_00471b78;
  if ((DAT_00480320 & 2) == 0) {
    DAT_00480320 = DAT_00480320 | 2;
    DAT_0047f67e = 1;
    DAT_0047f68d = 0;
    DAT_0047f68c = 0;
    _DAT_0047f688 = 0x3f800000;
    _DAT_0047f684 = 0;
    _DAT_0047f678 = (char *)0x0;
    DAT_0047f67c = 0;
    DAT_0047f67d = 0;
    _DAT_0047f680 = 0;
    crt_atexit(&DAT_0040c1a0);
  }
  _DAT_0047f678 = s_Purchase_00471b6c;
  fVar10 = 1.0;
  if ((float)quest_spawn_timeline * 0.016 < 20.0) {
    fVar10 = (float)quest_spawn_timeline * 0.016 * 0.05;
  }
  if (demo_time_limit_ms + -500 < quest_spawn_timeline) {
    in_stack_ffffffec = (IGrim2D *)(demo_time_limit_ms - quest_spawn_timeline);
    fVar10 = (float)(int)in_stack_ffffffec * 0.002;
  }
  uVar9 = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,fVar10,unaff_EBP);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f4ccccd,uVar9);
  handle = &DAT_0047f4d8;
  if (demo_purchase_screen_active == '\0') {
    if (quest_spawn_timeline == 0) {
      demo_upsell_message_index = (demo_upsell_message_index + 1) % 5;
    }
  }
  else {
    ui_pulse_timer_ms = ui_pulse_timer_ms + frame_dt_ms;
    h = (float)(ui_pulse_timer_ms % 1000);
    fVar7 = (float10)fsin((float10)(int)h * (float10)6.2831855);
    fVar6 = (float)(fVar7 * fVar7);
    (*grim_interface_ptr->vtable->grim_set_color_slot)((IGrim2D *)0x0,0,0.0,0.0,1.0,fVar10);
    (*grim_interface_ptr->vtable->grim_set_color_slot)((IGrim2D *)0x1,0,0.0,0.3,1.0,unaff_EBP);
    (*grim_interface_ptr->vtable->grim_set_color_slot)
              ((IGrim2D *)0x2,0,0.4,in_stack_ffffffe4 * 0.55,in_stack_ffffffe4,unaff_EBX);
    (*grim_interface_ptr->vtable->grim_set_color_slot)
              ((IGrim2D *)0x3,0,0.4,0.4,1.0,in_stack_ffffffd4);
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,in_stack_ffffffd8);
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,0.5,0.5,fVar6);
    pIVar2 = grim_interface_ptr->vtable;
    pIVar4 = (IGrim2D *)
             (*pIVar2->grim_get_texture_handle)((IGrim2D *)s_backplasma_0047296c,(char *)0x0);
    (*pIVar2->grim_bind_texture)(pIVar4,(int)handle,(int)in_stack_ffffffe4);
    (*grim_interface_ptr->vtable->grim_draw_quad)
              ((IGrim2D *)0x0,0.0,(float)config_blob.screen_width,(float)config_blob.screen_height,h
              );
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_ffffffec);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,1.0,in_stack_fffffff0);
    iVar3 = (*grim_interface_ptr->vtable->grim_get_texture_handle)
                      ((IGrim2D *)s_mockup_00472964,in_stack_fffffff4);
    iVar12 = 0x100;
    iVar5 = config_blob.screen_height / 2 + -0x8c;
    iVar11 = 0x200;
    lVar8 = __ftol();
    ui_draw_textured_quad((int)lVar8,iVar5,iVar11,iVar12,iVar3);
    iVar3 = (*grim_interface_ptr->vtable->grim_get_texture_handle)
                      ((IGrim2D *)s_cl_logo_00471f70,in_stack_fffffff8);
    iVar12 = 0x40;
    iVar5 = config_blob.screen_height / 2;
    iVar11 = 0x200;
    lVar8 = __ftol();
    ui_draw_textured_quad(config_blob.screen_width / 2 + -0x100,(int)lVar8,iVar11,iVar12,iVar3);
    text_00 = (char *)0x3f800000;
    uVar9 = 0x3f800000;
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,1.0,(float)in_stack_fffffffc);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f19999a,uVar9);
    text = (char *)(float)(config_blob.screen_height / 2 + -0x68);
    lVar8 = __ftol();
    pIVar4 = (IGrim2D *)(float)(int)lVar8;
    (*grim_interface_ptr->vtable->grim_draw_text_small)(pIVar4,(float)text,6.535096e-39,text_00);
    (*grim_interface_ptr->vtable->grim_draw_text_small)
              (pIVar4,in_stack_0000000c + 28.0,6.535062e-39,in_stack_fffffffc);
    in_stack_00000028.vtable = (IGrim2D_vtbl *)((float)in_stack_00000010 + 15.0);
    pIVar2 = grim_interface_ptr->vtable;
    fVar6 = (float)(*pIVar2->grim_measure_text_width)
                             ((IGrim2D *)s_Full_version_features__00472918,(char *)0x3f800000);
    (*pIVar2->grim_draw_rect_outline)
              (&stack0x00000028,(float *)(float)(int)fVar6,unaff_retaddr,in_stack_00000004);
    in_stack_00000018 = (char *)((float)pIVar4 + 22.0);
    pIVar2 = (IGrim2D_vtbl *)(float)((int)lVar8 + 8);
    in_stack_00000028.vtable = pIVar2;
    (*grim_interface_ptr->vtable->grim_draw_text_small)
              ((IGrim2D *)pIVar2,(float)in_stack_00000018,6.534989e-39,text);
    fVar10 = (float)(iVar5 + -200) + 22.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)pIVar2,fVar10,s__The_varied_weapon_arsenal_consi_004728ac);
    fVar10 = fVar10 + 17.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)pIVar2,fVar10,s_weapons_that_allow_you_to_deal_d_00472870);
    fVar10 = fVar10 + 17.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)pIVar2,fVar10,s_fire_and_electricity__00472858);
    fVar10 = fVar10 + 22.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)pIVar2,fVar10,s__Over_40_game_altering_Perks__00472838);
    fVar10 = fVar10 + 22.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)pIVar2,fVar10,s__40_insane_Levels_that_give_you_00472818);
    fVar10 = fVar10 + 18.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)pIVar2,fVar10,s_hours_of_intense_and_fun_gamepla_004727f4);
    (*grim_interface_ptr->vtable->grim_draw_text_small)
              ((IGrim2D *)pIVar2,fVar10 + 22.0,6.534585e-39,(char *)(in_stack_0000000c + 28.0));
    (*grim_interface_ptr->vtable->grim_draw_text_small)
              (pIVar4,in_stack_00000020 + 22.0 + 22.0,6.534518e-39,in_stack_00000010);
    in_stack_00000024 = fVar6 + 17.0 + 17.0 + 22.0;
    IStack00000038.vtable = (IGrim2D_vtbl *)(float)(config_blob.screen_width / 2 + 0x80);
    fStack00000034 = (float)in_stack_00000028.vtable * 0.3;
    in_stack_00000028.vtable = (IGrim2D_vtbl *)(config_blob.screen_height / 2 + 0x66);
    fStack0000003c = (float)(int)in_stack_00000028.vtable + fStack00000034 + 50.0;
    iVar3 = ui_button_update((float *)&stack0x00000038,(ui_button_t *)&DAT_0047f678);
    if ((char)iVar3 != '\0') {
      shareware_offer_seen_latch = '\x01';
      DAT_0047ea50 = 1;
      ShellExecuteA((HWND)0x0,&DAT_00471b38,s_http___buy_crimsonland_com_00471b40,(LPCSTR)0x0,
                    (LPCSTR)0x0,1);
      return;
    }
    IStack00000038.vtable = (IGrim2D_vtbl *)(float)(config_blob.screen_width / 2 + 0x80);
    in_stack_00000028.vtable = (IGrim2D_vtbl *)(config_blob.screen_height / 2 + 0x66);
    fStack0000003c = (float)(int)in_stack_00000028.vtable + fStack00000034 + 90.0;
    iVar3 = ui_button_update((float *)&stack0x00000038,(ui_button_t *)&DAT_004802b0);
    if ((char)iVar3 != '\0') {
      if (shareware_offer_seen_latch != '\0') {
        DAT_0047ea50 = 1;
      }
      ui_transition_direction = '\0';
      game_state_pending = 0;
      demo_mode_active = 1;
      if (shareware_offer_seen_latch != '\0') {
        demo_mode_active = 1;
        ui_transition_direction = '\0';
        game_state_pending = 0;
        return;
      }
      config_load_presets();
      sfx_mute_all(music_track_intro_id);
      sfx_mute_all(music_track_crimsonquest_id);
      sfx_play_exclusive(music_track_crimson_theme_id);
      return;
    }
    quest_spawn_timeline = quest_spawn_timeline + frame_dt_ms;
    if (demo_time_limit_ms < quest_spawn_timeline) {
      render_pass_mode = 0;
      demo_mode_start();
    }
    if (demo_purchase_screen_active != '\0') goto LAB_0040c103;
  }
  y = in_stack_0000002c;
  uVar9 = 0xffffffff;
  do {
    if (uVar9 == 0) break;
    uVar9 = uVar9 - 1;
    cVar1 = *(char *)in_stack_0000002c;
    in_stack_0000002c = (float *)((int)in_stack_0000002c + 1);
  } while (cVar1 != '\0');
  in_stack_00000040 = 0;
  in_stack_00000044 = 0;
  in_stack_00000048 = 0;
  fVar10 = (float)(~uVar9 - 1) * 12.8;
  IStack00000038.vtable = (IGrim2D_vtbl *)0x42700000;
  in_stack_0000002c = (float *)(((float)quest_spawn_timeline / (float)demo_time_limit_ms) * fVar10);
  in_stack_0000004c = in_stack_00000030 * 0.5;
  fStack00000034 = in_stack_00000024 + 50.0;
  fStack0000003c = fStack00000034 - 4.0;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            (&stack0x00000038,(float *)(fVar10 + 12.0),30.0,(float)&stack0x00000040);
  in_stack_0000004c = in_stack_00000030 * 0.8;
  fStack0000003c = in_stack_00000024 + 72.0;
  in_stack_00000040 = 0x3f000000;
  in_stack_00000044 = 0x3dcccccd;
  in_stack_00000048 = 0x3dcccccd;
  IStack00000038.vtable = (IGrim2D_vtbl *)0x42800000;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            (&stack0x00000038,in_stack_0000002c,3.0,(float)&stack0x00000040);
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000030,in_stack_00000014);
  (*grim_interface_ptr->vtable->grim_draw_text_mono)
            ((IGrim2D *)0x42480000,(float)IStack00000038.vtable,(float)y,in_stack_00000018);
LAB_0040c103:
  ui_elements_update_and_render();
  ui_cursor_render();
  return;
}



/* console_hotkey_update @ 0040c1c0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* per-frame input/update function; contains console hotkey block (DIK_GRAVE) at 0x0040c360 and
   DIK_F12 check; entry identified via WinDbg */

void console_hotkey_update(void)

{
  IGrim2D_vtbl *pIVar1;
  int iVar2;
  char *pcVar3;
  FILE *fp;
  float *pfVar4;
  float fVar5;
  undefined *unaff_EBX;
  IGrim2D *unaff_ESI;
  uint uVar6;
  float10 extraout_ST0;
  float10 extraout_ST0_00;
  float10 extraout_ST0_01;
  float10 extraout_ST0_02;
  float10 extraout_ST0_03;
  float10 extraout_ST0_04;
  float10 extraout_ST0_05;
  float10 extraout_ST0_06;
  float10 extraout_ST0_07;
  longlong lVar7;
  float unaff_retaddr;
  char *in_stack_00000004;
  float in_stack_00000008;
  uint in_stack_0000000c;
  float fStack00000010;
  IGrim2D in_stack_00000020;
  float in_stack_00000024;
  float in_stack_00000028;
  float in_stack_0000002c;
  float in_stack_00000030;
  undefined4 in_stack_00000034;
  uint uVar8;
  uint uVar9;
  IGrim2D *in_stack_ffffffd8;
  IGrim2D *in_stack_ffffffdc;
  int in_stack_ffffffe0;
  int in_stack_ffffffe4;
  int in_stack_ffffffe8;
  float a;
  IGrim2D *pIVar10;
  IGrim2D IVar11;
  IGrim2D *in_stack_fffffff8;
  float in_stack_fffffffc;
  
  (*grim_interface_ptr->vtable->grim_get_frame_dt)(unaff_ESI);
  frame_dt = (float)extraout_ST0;
  if (quest_unlock_index < 0x28) {
    config_blob.hardcore = '\0';
  }
  iVar2 = game_is_full_version();
  if ((char)iVar2 == '\0') {
    if ((int)game_status_blob.game_sequence_id < 0) {
      game_status_blob.game_sequence_id = 1200000;
    }
    game_status_blob.game_sequence_id = game_sequence_get();
    config_blob.hardcore = '\0';
  }
  uVar9 = 0x40c218;
  iVar2 = game_is_full_version();
  if ((char)iVar2 != '\0') {
    _DAT_0048823c = &LAB_00447350;
    shareware_offer_seen_latch = '\0';
  }
  if (DAT_00486faa == '\0') {
    uVar9 = 0x40c239;
    iVar2 = game_is_full_version();
    if ((char)iVar2 != '\0') {
      DAT_004875c4 = DAT_004875c4 + 60.0;
      DAT_004875b8 = DAT_00488218;
      DAT_004875bc = DAT_0048821c;
      DAT_00486faa = '\x01';
      DAT_00488208 = 0;
      _DAT_004875c0 = _DAT_004875c0 - 20.0;
    }
  }
  if (audio_suspend_flag == '\0') {
    pIVar10 = (IGrim2D *)&stack0xfffffff4;
    uVar9 = 0x57;
    uVar8 = 0x40c2a4;
    pcVar3 = (char *)(*grim_interface_ptr->vtable->grim_get_config_var)
                               (pIVar10,(uint *)0x57,(int)unaff_EBX);
    if (*pcVar3 != '\0') {
      if ((render_pass_mode == '\0') || (config_blob.reserved0._24_4_ != 3)) {
        unaff_EBX = (undefined *)0x40c31b;
        terrain_generate_random();
      }
      else {
        uVar9 = _quest_stage_minor - 1;
        uVar6 = _quest_stage_major - 1;
        if (9 < (int)uVar9) {
          uVar9 = uVar9 % 10;
        }
        if (3 < (int)uVar6) {
          uVar6 = uVar6 + (uVar6 >> 2) * -4;
        }
        unaff_EBX = &quest_selected_meta + (uVar6 + uVar9 * 10) * 0x2c;
        uVar9 = 0x40c311;
        terrain_generate(unaff_EBX);
      }
      (*grim_interface_ptr->vtable->grim_set_config_var)
                ((IGrim2D *)0x57,uVar8 & 0xffffff00,(uint)pIVar10);
    }
  }
  iVar2 = game_is_full_version();
  if (((char)iVar2 == '\0') && (10 < quest_unlock_index)) {
    quest_unlock_index = 10;
  }
  if (audio_suspend_flag != '\0') {
    audio_resume_all();
    return;
  }
  DAT_00480848 = DAT_00480848 + frame_dt_ms;
  iVar2 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x29,uVar9);
  if ((char)iVar2 != '\0') {
    console_set_open(&console_log_queue,console_open_flag == '\0');
  }
  console_update(0x47eea0);
  iVar2 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x58,(uint)unaff_EBX);
  if ((char)iVar2 != '\0') {
    do {
      if (DAT_004808c4 < 10) {
        pcVar3 = s_shot_00_d_bmp_004729b8;
      }
      else if (DAT_004808c4 < 100) {
        pcVar3 = s_shot_0_d_bmp_004729a8;
      }
      else {
        pcVar3 = s_shot__d_bmp_0047299c;
      }
      crt_sprintf(&DAT_0047f634,pcVar3,DAT_004808c4);
      fp = crt_fopen(&DAT_0047f634,&file_mode_read_binary);
      if (fp != (FILE *)0x0) {
        crt_fclose(fp);
      }
      DAT_004808c4 = DAT_004808c4 + 1;
    } while (fp != (FILE *)0x0);
    (*grim_interface_ptr->vtable->grim_check_device)((IGrim2D *)&DAT_0047f634);
  }
  if ((demo_mode_active == '\0') && (DAT_00480850 == '\0')) {
    game_status_blob.game_sequence_id = game_sequence_get();
    iVar2 = game_state_id;
    if ((console_open_flag == '\0') && ((render_pass_mode != '\0' && (game_state_id == 9)))) {
      lVar7 = __ftol();
      game_status_blob.game_sequence_id = game_status_blob.game_sequence_id + (int)lVar7;
    }
    if ((DAT_0048084c < 1) || (console_open_flag != '\0')) goto LAB_0040c4b7;
    if (render_pass_mode != '\0') {
      if ((iVar2 == 9) && (config_blob.reserved0._24_4_ != 8)) {
        lVar7 = __ftol();
        DAT_0048084c = DAT_0048084c + (int)lVar7;
      }
      goto LAB_0040c4b7;
    }
  }
  else {
LAB_0040c4b7:
    if (((render_pass_mode != '\0') && (iVar2 = perk_count_get(perk_id_reflex_boosted), iVar2 != 0))
       && (game_state_id == 9)) {
      frame_dt = frame_dt * 0.9;
    }
  }
  _DAT_0047ea4c = _DAT_0047ea4c + frame_dt;
  _DAT_0047ea48 = frame_dt;
  lVar7 = __ftol();
  frame_dt_ms = (int)lVar7;
  if (((console_open_flag == '\0') && (render_pass_mode != '\0')) &&
     ((game_state_id == 9 && (config_blob.reserved0._24_4_ != 8)))) {
    DAT_0048718c = DAT_0048718c + frame_dt_ms;
  }
  if (DAT_0048702c == '\0') {
    screen_fade_alpha = screen_fade_alpha - (frame_dt + frame_dt);
  }
  else {
    screen_fade_alpha = frame_dt * 10.0 + screen_fade_alpha;
  }
  if (0.0 <= screen_fade_alpha) {
    if (1.0 < screen_fade_alpha) {
      screen_fade_alpha = 1.0;
    }
  }
  else {
    screen_fade_alpha = 0.0;
  }
  if (console_open_flag != '\0') {
    frame_dt = 0.0;
  }
  (*grim_interface_ptr->vtable->grim_get_mouse_dx)(in_stack_ffffffd8);
  if ((extraout_ST0_00 == (float10)0.0) ||
     ((*grim_interface_ptr->vtable->grim_get_mouse_dy)(in_stack_ffffffdc),
     extraout_ST0_01 == (float10)0.0)) {
    DAT_004871cb = 0;
  }
  else {
    DAT_004871cb = 1;
    ui_mouse_blocked = 0;
    DAT_004808c8 = 0;
  }
  pIVar10 = (IGrim2D *)0x0;
  (*grim_interface_ptr->vtable->grim_get_config_float)
            ((IGrim2D *)player_health.input.axis_aim_x,in_stack_ffffffe0);
  fVar5 = (float)extraout_ST0_02;
  (*grim_interface_ptr->vtable->grim_get_config_float)
            ((IGrim2D *)player_health.input.axis_aim_y,in_stack_ffffffe4);
  if ((float10)0.2 <
      SQRT((float10)(float)pIVar10 * (float10)(float)pIVar10 + extraout_ST0_03 * extraout_ST0_03)) {
    in_stack_fffffffc = (float)extraout_ST0_03;
    in_stack_fffffff8 = pIVar10;
  }
  (*grim_interface_ptr->vtable->grim_get_config_float)
            ((IGrim2D *)player_health.input.axis_move_x,in_stack_ffffffe8);
  IVar11.vtable = (IGrim2D_vtbl *)(float)extraout_ST0_04;
  (*grim_interface_ptr->vtable->grim_get_config_float)
            ((IGrim2D *)player_health.input.axis_move_y,(int)fVar5);
  if ((float10)0.2 <
      SQRT((float10)(float)in_stack_fffffff8 * (float10)(float)in_stack_fffffff8 +
           extraout_ST0_05 * extraout_ST0_05)) {
    unaff_retaddr = unaff_retaddr + (float)in_stack_fffffff8;
    in_stack_00000004 = (char *)(float)((float10)(float)in_stack_00000004 + extraout_ST0_05);
  }
  if (0.2 < SQRT(unaff_retaddr * unaff_retaddr + (float)in_stack_00000004 * (float)in_stack_00000004
                )) {
    DAT_004808c8 = 1;
  }
  if (game_state_id == 9) {
    DAT_004808c8 = 0;
LAB_0040c71b:
    (*grim_interface_ptr->vtable->grim_get_mouse_dx)(pIVar10);
    ui_mouse_x = (float)(extraout_ST0_06 * (float10)(float)config_blob.reserved8 +
                         extraout_ST0_06 * (float10)(float)config_blob.reserved8 +
                        (float10)ui_mouse_x);
    (*grim_interface_ptr->vtable->grim_get_mouse_dy)((IGrim2D *)IVar11.vtable);
    pfVar4 = (float *)&DAT_004871f4;
    ui_mouse_y = (float)(extraout_ST0_07 * (float10)(float)config_blob.reserved8 +
                         extraout_ST0_07 * (float10)(float)config_blob.reserved8 +
                        (float10)ui_mouse_y);
    do {
      *pfVar4 = ui_mouse_x;
      pfVar4[1] = ui_mouse_y;
      pfVar4 = pfVar4 + 2;
    } while ((int)pfVar4 < 0x487204);
  }
  else {
    if (DAT_004808c8 != 1) goto LAB_0040c71b;
    ui_mouse_x = (float)config_blob.reserved8 * frame_dt * unaff_retaddr * 540.0 + ui_mouse_x;
    ui_mouse_y = (float)config_blob.reserved8 * frame_dt * (float)in_stack_00000004 * 540.0 +
                 ui_mouse_y;
  }
  if (ui_mouse_x < 0.0) {
    ui_mouse_x = 0.0;
  }
  if (ui_mouse_y < 0.0) {
    ui_mouse_y = 0.0;
  }
  if ((float)(config_blob.screen_width + -1) < ui_mouse_x) {
    ui_mouse_x = (float)(config_blob.screen_width + -1);
  }
  fVar5 = (float)(config_blob.screen_height + -1);
  if ((float)(int)fVar5 < ui_mouse_y) {
    ui_mouse_y = (float)(int)fVar5;
  }
  if ((game_state_id == 0x16) || (DAT_004824d1 != '\0')) {
    FUN_0040b630();
  }
  else if (game_state_id == 9) {
    if (demo_purchase_screen_active == '\0') {
      gameplay_update_and_render();
    }
    else {
      (*grim_interface_ptr->vtable->grim_clear_color)
                ((IGrim2D *)0x0,0.0,0.0,0.0,(float)in_stack_fffffff8);
    }
    if (demo_mode_active != '\0') {
LAB_0040c8a0:
      demo_purchase_screen_update();
    }
    if (audio_suspend_flag != '\0') {
      return;
    }
  }
  else {
    if (game_state_id == 0x18) {
      gameplay_update_and_render();
      goto LAB_0040c8a0;
    }
    if (game_state_id == 6) {
      perk_selection_screen_update();
    }
    else if (game_state_id == 7) {
      game_over_screen_update();
    }
    else if (game_state_id == 8) {
      quest_results_screen_update();
    }
    else if (game_state_id == 0xc) {
      quest_failed_screen_update();
    }
    else if (game_state_id == 0x12) {
      survival_gameplay_update_and_render();
    }
    else if (game_state_id == 0x15) {
      FUN_00406350();
    }
    else {
      demo_purchase_screen_active = '\0';
      FUN_00406af0();
    }
  }
  IVar11.vtable = (IGrim2D_vtbl *)0x3f800000;
  uVar9 = 0x40000000;
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,2.0,1.0,(float)in_stack_fffffff8);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,uVar9);
  pIVar10 = (IGrim2D *)0x3f19999a;
  uVar8 = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,0.6,(float)IVar11.vtable);
  uVar9 = 0x3ecccccd;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3ecccccd,uVar8);
  a = 5.949756e-39;
  iVar2 = game_is_full_version();
  if ((char)iVar2 == '\0') {
    a = 0.6;
    uVar9 = 0x3e99999a;
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,0.3,0.3,0.6,(float)pIVar10);
  }
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3ee66666,uVar9);
  if (*(float *)((int)cv_showFPS + 0xc) != 0.0) {
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.6,a);
    (*grim_interface_ptr->vtable->grim_get_fps)(pIVar10);
    lVar7 = __ftol();
    pIVar1 = grim_interface_ptr->vtable;
    if ((int)lVar7 < 400) {
      (*pIVar1->grim_get_fps)((IGrim2D *)IVar11.vtable);
      __ftol();
      pcVar3 = &DAT_00471f40;
      fVar5 = (float)(config_blob.screen_width + -0x2d);
    }
    else {
      (*pIVar1->grim_get_fps)((IGrim2D *)IVar11.vtable);
      __ftol();
      pcVar3 = &DAT_00472990;
      fVar5 = (float)(config_blob.screen_width + -0x33);
    }
    (*pIVar1->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)(int)fVar5,(float)(config_blob.screen_height + -0x18),
               pcVar3);
  }
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,0.6,(float)in_stack_fffffff8);
  FUN_00401dd0(&console_log_queue);
  crt_rand();
  audio_update();
  iVar2 = (*grim_interface_ptr->vtable->grim_was_key_pressed)
                    ((IGrim2D *)0x1,(uint)in_stack_fffffffc);
  if ((((char)iVar2 != '\0') && ((render_pass_mode != '\0' || (game_state_id == 0x16)))) &&
     ((game_state_id == 9 || ((game_state_id == 0x16 || (game_state_id == 0x12)))))) {
    ui_transition_direction = 0;
    game_state_pending = 5;
    if (plugin_interface_ptr != (mod_interface_t *)0x0) {
      (plugin_interface_ptr->parms).fields.onPause = '\x01';
    }
  }
  if (DAT_00471308 == 0xffffffff) {
    uVar9 = crt_rand();
    DAT_00471308 = uVar9 & 0x8000001f;
    if ((int)DAT_00471308 < 0) {
      DAT_00471308 = (DAT_00471308 - 1 | 0xffffffe0) + 1;
    }
  }
  if ((((game_state_id == 4) && (render_pass_mode == '\0')) && (local_system_time._2_2_ == 3)) &&
     ((local_system_day == 3 && (DAT_00471308 == 3)))) {
    DAT_00471308 = 0xffffffff;
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3e4ccccd,1.0,0.6,0.5,fVar5);
    pcVar3 = s_Orbes_Volantes_Exstare_00472978;
    fVar5 = 5.0;
    pIVar1 = grim_interface_ptr->vtable;
    uVar9 = crt_rand();
    uVar9 = uVar9 & 0x8000003f;
    if ((int)uVar9 < 0) {
      uVar9 = (uVar9 - 1 | 0xffffffc0) + 1;
    }
    in_stack_0000000c = uVar9 + 0x10;
    (*pIVar1->grim_draw_text_small)
              ((IGrim2D *)(float)(int)in_stack_0000000c,fVar5,(float)pcVar3,in_stack_00000004);
  }
  iVar2 = game_is_full_version();
  if ((char)iVar2 == '\0') {
    if (demo_mode_active == '\0') {
      iVar2 = FUN_0041df50();
      fStack00000010 = (float)(int)game_status_blob.game_sequence_id / (float)iVar2;
      if (1.0 < fStack00000010) {
        fStack00000010 = 1.0;
      }
      in_stack_00000024 = (float)(config_blob.screen_height + -7);
      in_stack_00000028 = 0.0;
      in_stack_0000002c = 0.0;
      in_stack_00000030 = 0.0;
      in_stack_00000034 = 0x3f000000;
      in_stack_00000020.vtable = (IGrim2D_vtbl *)0x0;
      (*grim_interface_ptr->vtable->grim_draw_rect_filled)
                (&stack0x00000020,(float *)(float)config_blob.screen_width,8.0,
                 (float)&stack0x00000028);
      in_stack_00000028 = fStack00000010;
      in_stack_00000030 = fStack00000010 * 4.0 + 1.0;
      in_stack_0000002c = 0.9 / in_stack_00000030;
      in_stack_00000034 = 0x3f000000;
      in_stack_00000020.vtable = (IGrim2D_vtbl *)0x40000000;
      in_stack_00000030 = 0.5 / in_stack_00000030;
      in_stack_00000024 = (float)(config_blob.screen_height + -5);
      (*grim_interface_ptr->vtable->grim_draw_rect_filled)
                (&stack0x00000020,(float *)((float)(config_blob.screen_width + -4) * fStack00000010)
                 ,3.0,(float)&stack0x00000028);
      goto LAB_0040cd14;
    }
LAB_0040cd20:
    if (game_state_pending == 0) {
      iVar2 = ui_elements_max_timeline();
      if (iVar2 == 0) {
        fStack00000010 = 1.0;
      }
      else {
        fStack00000010 = 1.0 - (float)ui_elements_timeline / (float)iVar2;
      }
      fStack00000010 = fStack00000010 * fStack00000010;
      if (game_state_prev == 0x18) {
        fStack00000010 = 1.0 - fStack00000010;
        demo_purchase_screen_active = '\0';
      }
      if (0.0 <= fStack00000010) {
        if (1.0 < fStack00000010) {
          fStack00000010 = 1.0;
        }
      }
      else {
        fStack00000010 = 0.0;
      }
      (*grim_interface_ptr->vtable->grim_draw_fullscreen_color)
                ((IGrim2D *)0x0,0.0,0.0,fStack00000010,in_stack_00000008);
    }
  }
  else {
LAB_0040cd14:
    if (demo_mode_active != '\0') goto LAB_0040cd20;
  }
  if (game_state_pending == 10) {
    iVar2 = ui_elements_max_timeline();
    if (iVar2 == 0) {
      fStack00000010 = 1.0;
    }
    else {
      fStack00000010 = 1.0 - (float)ui_elements_timeline / (float)iVar2;
    }
    if (game_state_prev == 0x16) {
      fStack00000010 = 1.0 - fStack00000010;
    }
    if (0.0 <= fStack00000010) {
      if (1.0 < fStack00000010) {
        fStack00000010 = 1.0;
      }
    }
    else {
      fStack00000010 = 0.0;
    }
    (*grim_interface_ptr->vtable->grim_draw_fullscreen_color)
              ((IGrim2D *)0x0,0.0,0.0,fStack00000010,in_stack_00000008);
  }
  iVar2 = (*grim_interface_ptr->vtable->grim_is_key_down)((IGrim2D *)0x10,(uint)in_stack_00000008);
  if (((char)iVar2 == '\0') ||
     (iVar2 = (*grim_interface_ptr->vtable->grim_is_key_down)((IGrim2D *)0x38,in_stack_0000000c),
     (char)iVar2 == '\0')) {
    if (DAT_0047ea50 == '\0') goto LAB_0040cf06;
  }
  else {
    DAT_0047ea50 = '\x01';
  }
  iVar2 = game_is_full_version();
  if ((char)iVar2 != '\0') {
    config_sync_from_grim();
    return;
  }
  if (shareware_offer_seen_latch != '\0') {
    return;
  }
  iVar2 = game_is_full_version();
  if ((char)iVar2 != '\0') {
    return;
  }
  config_sync_from_grim();
  demo_mode_start();
  sfx_mute_all(music_track_crimson_theme_id);
  sfx_mute_all(music_track_extra_0);
  sfx_mute_all(music_track_intro_id);
  sfx_play_exclusive(music_track_shortie_monk_id);
  DAT_0047ea50 = '\0';
  shareware_offer_seen_latch = '\x01';
LAB_0040cf06:
  if (DAT_004d7a24 != '\0') {
    DAT_004d7a24 = '\0';
    FUN_00402d50();
    FUN_00402d50();
    audio_suspend_all();
    game_is_full_version();
  }
  if (DAT_004d7a25 != '\0') {
    DAT_004d7a25 = '\0';
    FUN_00402d50();
    FUN_00402d50();
    audio_suspend_all();
    game_is_full_version();
  }
  if (DAT_004d7a26 != '\0') {
    DAT_004d7a26 = '\0';
    FUN_00402d50();
    FUN_00402d50();
    audio_suspend_all();
    game_is_full_version();
  }
  if ((((DAT_004d11f0 == 0) && (DAT_004d11f8 != '\0')) && (DAT_004d11f4 != 0)) &&
     ((game_state_id != 0xe || (DAT_00480838 != '\0')))) {
    Sleep(100);
    return;
  }
  return;
}



/* credits_line_set @ 0040d000 */

/* stores a credits line string + flags into the credits line table */

void __cdecl credits_line_set(int index,char *text,int flags)

{
  char *pcVar1;
  
  (&credits_line_table_flags)[index * 2] = flags;
  if ((void *)(&credits_line_table_ptrs)[index * 2] != (void *)0x0) {
    crt_free((void *)(&credits_line_table_ptrs)[index * 2]);
  }
  pcVar1 = strdup_malloc(text);
  (&credits_line_table_ptrs)[index * 2] = pcVar1;
  DAT_004811b8 = index;
  return;
}



/* credits_line_clear_flag @ 0040d040 */

/* walks backward to find the last line with flag 0x4 and clears it (penalty for wrong click; plays
   sfx) */

void __cdecl credits_line_clear_flag(int index)

{
  byte *pbVar1;
  
  if (-1 < index) {
    pbVar1 = (byte *)(&credits_line_table_flags + index * 2);
    while ((*pbVar1 & 4) == 0) {
      index = index + -1;
      pbVar1 = pbVar1 + -8;
      if (index < 0) {
        return;
      }
    }
    (&credits_line_table_flags)[index * 2] = (&credits_line_table_flags)[index * 2] & 0xfffffffb;
    sfx_play(sfx_trooper_inpain_01);
  }
  return;
}



/* credits_build_lines @ 0040d090 */

/* populates credits line table with headings, names, and hint lines */

void credits_build_lines(void)

{
  credits_line_set(0,&DAT_0047f4d8,0);
  credits_line_set(1,s_Crimsonland_00472d5c,1);
  credits_line_set(2,&DAT_0047f4d8,0);
  credits_line_set(3,&DAT_0047f4d8,0);
  credits_line_set(4,s_Game_Design__00472d4c,1);
  credits_line_set(5,s_Tero_Alatalo_00472d3c,0);
  credits_line_set(6,&DAT_0047f4d8,0);
  credits_line_set(7,s_Programming__00472d2c,1);
  credits_line_set(8,s_Tero_Alatalo_00472d3c,0);
  credits_line_set(9,&DAT_0047f4d8,0);
  credits_line_set(10,s_Producer__00472d20,1);
  credits_line_set(0xb,s_Zach_Young_00472d14,0);
  credits_line_set(0xc,&DAT_0047f4d8,0);
  credits_line_set(0xd,s_2D_Art__00472d0c,1);
  credits_line_set(0xe,s_Tero_Alatalo_00472d3c,0);
  credits_line_set(0xf,&DAT_0047f4d8,0);
  credits_line_set(0x10,s_3D_Modelling__00472cfc,1);
  credits_line_set(0x11,s_Tero_Alatalo_00472d3c,0);
  credits_line_set(0x12,s_Timo_Palonen_00472cec,0);
  credits_line_set(0x13,&DAT_0047f4d8,0);
  credits_line_set(0x14,s_Music__00472ce4,1);
  credits_line_set(0x15,&DAT_00472ccc,0);
  credits_line_set(0x16,s_Ville_Eriksson_00472cbc,0);
  credits_line_set(0x17,&DAT_0047f4d8,0);
  credits_line_set(0x18,s_Sound_Effects__00472cac,1);
  credits_line_set(0x19,s_Ion_Hardie_00472ca0,0);
  credits_line_set(0x1a,s_Tero_Alatalo_00472d3c,0);
  credits_line_set(0x1b,&DAT_00472ccc,0);
  credits_line_set(0x1c,s_Ville_Eriksson_00472cbc,0);
  credits_line_set(0x1d,&DAT_0047f4d8,0);
  credits_line_set(0x1e,s_Manual__00472c98,1);
  credits_line_set(0x1f,s_Miikka_Kulmala_00472c88,0);
  credits_line_set(0x20,s_Zach_Young_00472d14,0);
  credits_line_set(0x21,&DAT_0047f4d8,0);
  credits_line_set(0x22,s_Special_thanks_to__00472c74,1);
  credits_line_set(0x23,&DAT_00472c58,0);
  credits_line_set(0x24,s_Peter_Hajba___Remedy_00472c40,0);
  credits_line_set(0x25,&DAT_0047f4d8,0);
  credits_line_set(0x26,s_Play_testers__00472c30,1);
  credits_line_set(0x27,s_Avraham_Petrosyan_00472c1c,0);
  credits_line_set(0x28,s_Bryce_Baker_00472c10,0);
  credits_line_set(0x29,s_Dan_Ruskin_00472c04,0);
  credits_line_set(0x2a,s_Dirk_Bunk_00472bf8,0);
  credits_line_set(0x2b,s_Eric_Dallaire_00472be8,0);
  credits_line_set(0x2c,s_Erik_Van_Pelt_00472bd8,0);
  credits_line_set(0x2d,s_Ernie_Ramirez_00472bc8,0);
  credits_line_set(0x2e,s_Ion_Hardie_00472ca0,0);
  credits_line_set(0x2f,s_James_C__Smith_00472bb8,0);
  credits_line_set(0x30,s_Jarkko_Forsbacka_00472ba4,0);
  credits_line_set(0x31,s_Jeff_McAteer_00472b94,0);
  credits_line_set(0x32,s_Juha_Alatalo_00472b84,0);
  credits_line_set(0x33,s_Kalle_Hahl_00472b78,0);
  credits_line_set(0x34,s_Lars_Brubaker_00472b68,0);
  credits_line_set(0x35,s_Lee_Cooper_00472b5c,0);
  credits_line_set(0x36,s_Markus_Lassila_00472b4c,0);
  credits_line_set(0x37,s_Matti_Alanen_00472b3c,0);
  credits_line_set(0x38,s_Miikka_Kulmala_00472c88,0);
  credits_line_set(0x39,s_Mika_Alatalo_00472b2c,0);
  credits_line_set(0x3a,s_Mike_Colonnese_00472b1c,0);
  credits_line_set(0x3b,s_Simon_Hallam_00472b0c,0);
  credits_line_set(0x3c,s_Toni_Nurminen_00472afc,0);
  credits_line_set(0x3d,&DAT_00472ccc,0);
  credits_line_set(0x3e,s_Ville_Eriksson_00472cbc,0);
  credits_line_set(0x3f,&DAT_00472aec,0);
  credits_line_set(0x40,s_Zach_Young_00472d14,0);
  credits_line_set(0x41,&DAT_0047f4d8,0);
  credits_line_set(0x42,s_Greeting_to__00472adc,0);
  credits_line_set(0x42,s_Chaos__00472ad4,0);
  credits_line_set(0x42,s_Matricks_00472ac8,0);
  credits_line_set(0x42,s_Muzzy_00472ac0,0);
  credits_line_set(0x42,&DAT_0047f4d8,0);
  credits_line_set(0x43,&DAT_0047f4d8,0);
  credits_line_set(0x44,s_2003__c__10tons_entertainment_00472aa0,0);
  credits_line_set(0x45,s_10tons_logo_by_00472a90,0);
  credits_line_set(0x46,s_Pasi_Heinonen_00472a80,0);
  credits_line_set(0x47,&DAT_0047f4d8,0);
  credits_line_set(0x48,&DAT_0047f4d8,0);
  credits_line_set(0x49,&DAT_0047f4d8,0);
  credits_line_set(0x4a,s_Uses_Vorbis_Audio_Decompression_00472a60,0);
  credits_line_set(0x4b,s_2003__c__Xiph_Org_Foundation_00472a40,0);
  credits_line_set(0x4c,s__see_vorbis_txt__00472a2c,0);
  credits_line_set(0x4d,&DAT_0047f4d8,0);
  credits_line_set(0x4e,&DAT_0047f4d8,0);
  credits_line_set(0x4f,&DAT_0047f4d8,0);
  credits_line_set(0x50,&DAT_0047f4d8,0);
  credits_line_set(0x51,&DAT_0047f4d8,0);
  credits_line_set(0x52,&DAT_0047f4d8,0);
  credits_line_set(0x53,&DAT_0047f4d8,0);
  credits_secret_line_base_index = 0x54;
  credits_line_set(0x54,&DAT_0047f4d8,0);
  credits_line_set(0x55,&DAT_0047f4d8,0);
  credits_line_set(0x56,&DAT_0047f4d8,0);
  credits_line_set(0x57,s_You_can_stop_watching_now__00472a10,0);
  credits_line_set(0x58,&DAT_0047f4d8,0);
  credits_line_set(0x59,&DAT_0047f4d8,0);
  credits_line_set(0x5a,&DAT_0047f4d8,0);
  credits_line_set(0x5b,&DAT_0047f4d8,0);
  credits_line_set(0x5c,&DAT_0047f4d8,0);
  credits_line_set(0x5d,&DAT_0047f4d8,0);
  credits_line_set(0x5e,&DAT_0047f4d8,0);
  credits_line_set(0x5f,&DAT_0047f4d8,0);
  credits_line_set(0x60,&DAT_0047f4d8,0);
  credits_line_set(0x61,&DAT_0047f4d8,0);
  credits_line_set(0x62,&DAT_0047f4d8,0);
  credits_line_set(99,&DAT_0047f4d8,0);
  credits_line_set(100,&DAT_0047f4d8,0);
  credits_line_set(0x65,&DAT_0047f4d8,0);
  credits_line_set(0x66,&DAT_0047f4d8,0);
  credits_line_set(0x67,&DAT_0047f4d8,0);
  credits_line_set(0x68,&DAT_0047f4d8,0);
  credits_line_set(0x69,&DAT_0047f4d8,0);
  credits_line_set(0x6a,&DAT_0047f4d8,0);
  credits_line_set(0x6b,&DAT_0047f4d8,0);
  credits_line_set(0x6c,&DAT_0047f4d8,0);
  credits_line_set(0x6d,&DAT_0047f4d8,0);
  credits_line_set(0x6e,&DAT_0047f4d8,0);
  credits_line_set(0x6f,&DAT_0047f4d8,0);
  credits_line_set(0x70,&DAT_0047f4d8,0);
  credits_line_set(0x71,&DAT_0047f4d8,0);
  credits_line_set(0x72,&DAT_0047f4d8,0);
  credits_line_set(0x73,&DAT_0047f4d8,0);
  credits_line_set(0x74,&DAT_0047f4d8,0);
  credits_line_set(0x75,&DAT_0047f4d8,0);
  credits_line_set(0x76,&DAT_0047f4d8,0);
  credits_line_set(0x77,s_Click_the_ones_with_the_round_on_004729ec,0);
  credits_line_set(0x78,s____and_be_patient___004729d6 + 2,0);
  credits_line_set(0x79,&DAT_0047f4d8,0);
  credits_line_set(0x7a,&DAT_0047f4d8,0);
  credits_line_set(0x7b,&DAT_0047f4d8,0);
  credits_line_set(0x7c,&DAT_0047f4d8,0);
  credits_line_set(0x7d,&DAT_0047f4d8,0);
  return;
}



/* credits_screen_update @ 0040d800 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* credits screen update/render loop; clicks flag lines containing 'o' (lowercase) and misclicks
   clear the last flagged line; when all 'o' lines are flagged, sets DAT_004811c4 and injects secret
   lines at DAT_004811bc; Secret button sets game_state_pending=0x1a (AlienZooKeeper) */

void credits_screen_update(void)

{
  uint uVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  int iVar5;
  int iVar6;
  char *pcVar7;
  IGrim2D_vtbl *pIVar8;
  char *unaff_EBX;
  char *unaff_EBP;
  float unaff_ESI;
  int iVar9;
  undefined4 *puVar10;
  float unaff_EDI;
  longlong lVar11;
  IGrim2D *self;
  float fVar12;
  float g;
  float fStack_20;
  char *pcStack_c;
  float fStack_8;
  float fStack_4;
  
  if ((DAT_00480978 & 1) == 0) {
    DAT_00480978 = DAT_00480978 | 1;
    DAT_004811a6 = 1;
    DAT_004811b5 = 0;
    DAT_004811b4 = 0;
    _DAT_004811b0 = 0x3f800000;
    _DAT_004811ac = 0;
    _credits_back_button = (undefined *)0x0;
    DAT_004811a4 = 0;
    credits_back_button_clicked = '\0';
    _DAT_004811a8 = 0;
    crt_atexit(&DAT_0040df60);
  }
  if ((DAT_00480978 & 2) == 0) {
    DAT_00480978 = DAT_00480978 | 2;
    DAT_0048118e = 1;
    DAT_0048119d = 0;
    DAT_0048119c = 0;
    _DAT_00481198 = 0x3f800000;
    _DAT_00481194 = 0;
    _credits_secret_button = (char *)0x0;
    DAT_0048118c = 0;
    credits_secret_button_clicked = '\0';
    _DAT_00481190 = 0;
    crt_atexit(&DAT_0040df50);
  }
  fVar3 = DAT_00489e1c + _DAT_00489df8;
  fStack_4 = _DAT_00489dfc + DAT_00489e20;
  _credits_secret_button = menu_label_secret;
  pcStack_c = (char *)(fStack_4 + 40.0 + 10.0);
  if (DAT_00487234 == 0) {
    DAT_00487234 = 1;
    credits_build_lines();
    _DAT_004811c0 = 0.0;
    DAT_00481184 = 0;
  }
  else if (DAT_00487234 == 1) {
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_ESI);
    if (DAT_004811b8 + 2 < DAT_00481184) {
      _DAT_004811c0 = 0.0;
      DAT_00481184 = 0;
    }
    fStack_8 = fStack_8 - 4.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)pcStack_c + 4.0,fStack_8,menu_label_credits);
    fStack_8 = (fStack_8 + 20.0) - 6.0;
    _DAT_004811c0 = frame_dt + _DAT_004811c0;
    lVar11 = __ftol();
    DAT_00481184 = (int)lVar11 + -0xf;
    DAT_00481180 = (int)lVar11 + 1;
    if (DAT_004811b8 < DAT_00481180) {
      DAT_00481180 = DAT_004811b8;
    }
    for (fVar4 = _DAT_004811c0 * 16.0; 16.0 < fVar4; fVar4 = fVar4 - 16.0) {
    }
    iVar5 = 0;
    if (DAT_00481180 != DAT_00481184 && -1 < DAT_00481180 - DAT_00481184) {
      do {
        iVar9 = DAT_00481184 + iVar5;
        if (iVar9 < 0) {
          iVar9 = 0;
        }
        iVar6 = (*grim_interface_ptr->vtable->grim_measure_text_width)
                          ((IGrim2D *)(&credits_line_table_ptrs)[iVar9 * 2],unaff_EBP);
        fVar2 = ((float)(int)fVar4 + fStack_4) - (fVar3 + 300.0);
        fVar12 = (fStack_4 - 16.0) + 24.0;
        if (fVar12 <= fVar2) {
          fVar12 = ((float)(((DAT_00481180 - DAT_00481184) + -1) * 0x10) + fStack_4) - 24.0;
          if (fVar12 < fVar2) {
            fStack_20 = (fVar12 - fVar2) * 0.041666668 + 1.0;
            goto LAB_0040db8e;
          }
          fStack_20 = 1.0;
        }
        else {
          fStack_20 = 1.0 - (fVar12 - fVar2) * 0.041666668;
LAB_0040db8e:
          if (fStack_20 <= 1.0) {
            if (fStack_20 < 0.0) {
              fStack_20 = 0.0;
            }
          }
          else {
            fStack_20 = 1.0;
          }
        }
        iVar6 = ui_mouse_inside_rect((float *)&stack0x00000000,0x10,iVar6);
        if (((char)iVar6 != '\0') && (iVar6 = input_primary_just_pressed(), (char)iVar6 != '\0')) {
          pcVar7 = _strchr((char *)(&credits_line_table_ptrs)[iVar9 * 2],0x6f);
          if (pcVar7 == (char *)0x0) {
            credits_line_clear_flag(iVar9);
          }
          else {
            if ((*(byte *)(&credits_line_table_flags + iVar9 * 2) & 4) == 0) {
              sfx_play(sfx_ui_bonus);
            }
            (&credits_line_table_flags)[iVar9 * 2] = (&credits_line_table_flags)[iVar9 * 2] | 4;
          }
        }
        uVar1 = (&credits_line_table_flags)[iVar9 * 2];
        if ((uVar1 & 4) == 0) {
          pIVar8 = grim_interface_ptr->vtable;
          if ((uVar1 & 1) == 0) {
            fVar12 = 0.5;
            goto LAB_0040dcc6;
          }
          g = 1.0;
          fVar12 = 1.0;
          self = (IGrim2D *)0x3f800000;
        }
        else {
          pIVar8 = grim_interface_ptr->vtable;
          if ((uVar1 & 1) == 0) {
            fVar12 = 0.7;
LAB_0040dcc6:
            g = 0.7;
            self = (IGrim2D *)0x3ecccccd;
          }
          else {
            g = 0.9;
            fVar12 = 1.0;
            self = (IGrim2D *)0x3f666666;
          }
        }
        (*pIVar8->grim_set_color)(self,fVar12,g,fStack_20,unaff_EDI);
        unaff_EDI = (float)(&credits_line_table_ptrs)[iVar9 * 2];
        unaff_EBP = pcStack_c;
        (*grim_interface_ptr->vtable->grim_draw_text_small)
                  ((IGrim2D *)((fStack_4 + 140.0) - fVar2),(float)pcStack_c,unaff_EDI,unaff_EBX);
        iVar5 = iVar5 + 1;
      } while (iVar5 < DAT_00481180 - DAT_00481184);
    }
    pcStack_c = (char *)((float)pcStack_c + 100.0);
    _credits_back_button = &DAT_00472e80;
    fStack_8 = fStack_8 + 250.0;
    ui_button_update((float *)&pcStack_c,(ui_button_t *)&credits_back_button);
    puVar10 = &credits_line_table_ptrs;
    do {
      if ((((char *)*puVar10 != (char *)0x0) &&
          (pcVar7 = _strchr((char *)*puVar10,0x6f), pcVar7 != (char *)0x0)) &&
         ((*(byte *)(puVar10 + 1) & 4) == 0)) goto LAB_0040d970;
      iVar5 = credits_secret_line_base_index;
      puVar10 = puVar10 + 2;
    } while ((int)puVar10 < 0x481180);
    if (credits_secret_unlock_flag == '\0') {
      credits_secret_unlock_flag = '\x01';
      (&credits_line_table_flags)[credits_secret_line_base_index * 2] =
           (&credits_line_table_flags)[credits_secret_line_base_index * 2] | 4;
      (&credits_line_table_flags)[(iVar5 + 1) * 2] = (&DAT_0048098c)[iVar5 * 2] | 4;
      (&credits_line_table_flags)[(iVar5 + 2) * 2] = (&DAT_0048098c)[(iVar5 + 1) * 2] | 4;
      (&credits_line_table_flags)[(iVar5 + 3) * 2] = (&DAT_0048098c)[(iVar5 + 2) * 2] | 4;
      (&credits_line_table_flags)[(iVar5 + 4) * 2] = (&DAT_0048098c)[(iVar5 + 3) * 2] | 4;
      (&credits_line_table_flags)[(iVar5 + 5) * 2] = (&DAT_0048098c)[(iVar5 + 4) * 2] | 4;
      (&credits_line_table_flags)[(iVar5 + 6) * 2] = (&DAT_0048098c)[(iVar5 + 5) * 2] | 4;
      (&credits_line_table_flags)[(iVar5 + 7) * 2] = (&DAT_0048098c)[(iVar5 + 6) * 2] | 4;
      iVar9 = iVar5 + 8;
      (&credits_line_table_flags)[iVar9 * 2] = (&DAT_0048098c)[(iVar5 + 7) * 2] | 4;
      (&DAT_0048098c)[iVar9 * 2] = (&DAT_0048098c)[iVar9 * 2] | 4;
      pcVar7 = strdup_malloc(s_Inside_Dead_Let_Mighty_Blood_00472e60);
      (&credits_line_table_ptrs)[iVar5 * 2] = pcVar7;
      pcVar7 = strdup_malloc(s_Do_Firepower_See_Mark_Of_00472e44);
      (&credits_line_table_ptrs)[(iVar5 + 1) * 2] = pcVar7;
      pcVar7 = strdup_malloc(s_The_Sacrifice_Old_Center_00472e28);
      (&credits_line_table_ptrs)[(iVar5 + 2) * 2] = pcVar7;
      pcVar7 = strdup_malloc(s_Yourself_Ground_First_For_00472e0c);
      (&credits_line_table_ptrs)[(iVar5 + 3) * 2] = pcVar7;
      pcVar7 = strdup_malloc(s_Triangle_Cube_Last_Not_Flee_00472df0);
      (&credits_line_table_ptrs)[(iVar5 + 4) * 2] = pcVar7;
      pcVar7 = strdup_malloc(s_0001001110000010101110011_00472dd4);
      (&credits_line_table_ptrs)[(iVar5 + 5) * 2] = pcVar7;
      pcVar7 = strdup_malloc(s_0101001011100010010101100_00472db8);
      (&credits_line_table_ptrs)[(iVar5 + 6) * 2] = pcVar7;
      pcVar7 = strdup_malloc(s_011111001000111_00472da8);
      (&credits_line_table_ptrs)[(iVar5 + 7) * 2] = pcVar7;
      pcVar7 = strdup_malloc(s__4_bits_for_index__<__OOOPS_I_me_00472d7c);
      (&credits_line_table_ptrs)[(iVar5 + 8) * 2] = pcVar7;
      crt_free((void *)(&DAT_00480988)[(iVar5 + 8) * 2]);
      pcVar7 = strdup_malloc(s__4_bits_for_index__00472d68);
      (&credits_line_table_ptrs)[(iVar5 + 9) * 2] = pcVar7;
    }
    fStack_4 = (float)pcStack_c + 94.0;
    ui_button_update(&fStack_4,(ui_button_t *)&credits_secret_button);
  }
LAB_0040d970:
  if (credits_back_button_clicked != '\0') {
    ui_transition_direction = 0;
    game_state_pending = 4;
    FUN_00446140();
  }
  if (credits_secret_button_clicked != '\0') {
    ui_transition_direction = 0;
    game_state_pending = 0x1a;
    FUN_00446140();
  }
  iVar5 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1,(uint)unaff_EBX);
  if ((char)iVar5 != '\0') {
    ui_transition_direction = 0;
    game_state_pending = 4;
    FUN_00446140();
  }
  return;
}



/* mod_api_init @ 0040dfa0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* initializes the mod API context (writes mod_api_context.vtable = &mod_api_vtable at 0x0046f3e4;
   see cl_mod_sdk_v1/ClMod.h) */

void mod_api_init(void)

{
  mod_api_context.vtable = &mod_api_vtable;
  _DAT_00481ae8 = 1;
  return;
}



/* mod_api_core_printf @ 0040e000 */

/* mod API vtable 0x00: clAPI_t::CORE_Printf (writes to OutputDebugStringA) */

void __cdecl mod_api_core_printf(char *fmt,...)

{
  char local_ffc [4092];
  
  crt_vsprintf(local_ffc,fmt,&stack0x00000008);
  OutputDebugStringA(local_ffc);
  return;
}



/* mod_api_core_get_var @ 0040e040 */

/* mod API vtable 0x04: clAPI_t::CORE_GetVar (returns a 3-pointer var_t view:
   id/stringValue/floatValue) */

mod_var_t * mod_api_core_get_var(char *id)

{
  undefined4 *puVar1;
  
  puVar1 = console_cvar_find(&console_log_queue,id);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = console_register_cvar(&console_log_queue,id,&DAT_0047125c);
  }
  puVar1[8] = puVar1 + 3;
  ((mod_var_t *)(puVar1 + 6))->id = (char *)*puVar1;
  puVar1[7] = puVar1[4];
  return (mod_var_t *)(puVar1 + 6);
}



/* mod_api_core_del_var @ 0040e080 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x08: clAPI_t::CORE_DelVar */

uchar mod_api_core_del_var(char *id)

{
  uchar uVar1;
  
  uVar1 = console_cvar_unregister(&console_log_queue,id);
  return uVar1;
}



/* mod_api_core_execute @ 0040e0a0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x0c: clAPI_t::CORE_Execute */

void mod_api_core_execute(char *string)

{
  console_exec_line(&console_log_queue,string);
  return;
}



/* mod_api_core_add_command @ 0040e0c0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x10: clAPI_t::CORE_AddCommand */

void mod_api_core_add_command(char *id,void *cmd)

{
  console_register_command(&console_log_queue,id,cmd);
  return;
}



/* mod_api_core_del_command @ 0040e0e0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x14: clAPI_t::CORE_DelCommand */

uchar mod_api_core_del_command(char *id)

{
  uchar uVar1;
  
  uVar1 = console_command_unregister(&console_log_queue,id);
  return uVar1;
}



/* mod_api_core_get_extension @ 0040e100 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x18: clAPI_t::CORE_GetExtension (handles "grimgfx", "grimsfx", "IDirect3D8") */

void * mod_api_core_get_extension(char *ext)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  char *pcVar5;
  int unaff_EDI;
  bool bVar6;
  IGrim2D aIStack_10 [4];
  
  pbVar4 = &DAT_00472f48;
  pbVar2 = (byte *)ext;
  do {
    bVar1 = *pbVar2;
    bVar6 = bVar1 < *pbVar4;
    if (bVar1 != *pbVar4) {
LAB_0040e139:
      iVar3 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
      goto LAB_0040e13e;
    }
    if (bVar1 == 0) break;
    bVar1 = pbVar2[1];
    bVar6 = bVar1 < pbVar4[1];
    if (bVar1 != pbVar4[1]) goto LAB_0040e139;
    pbVar2 = pbVar2 + 2;
    pbVar4 = pbVar4 + 2;
  } while (bVar1 != 0);
  iVar3 = 0;
LAB_0040e13e:
  if (iVar3 == 0) {
    return grim_interface_ptr;
  }
  pbVar4 = &DAT_00472f40;
  pbVar2 = (byte *)ext;
  do {
    bVar1 = *pbVar2;
    bVar6 = bVar1 < *pbVar4;
    if (bVar1 != *pbVar4) {
LAB_0040e17f:
      iVar3 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
      goto LAB_0040e184;
    }
    if (bVar1 == 0) break;
    bVar1 = pbVar2[1];
    bVar6 = bVar1 < pbVar4[1];
    if (bVar1 != pbVar4[1]) goto LAB_0040e17f;
    pbVar2 = pbVar2 + 2;
    pbVar4 = pbVar4 + 2;
  } while (bVar1 != 0);
  iVar3 = 0;
LAB_0040e184:
  if (iVar3 != 0) {
    pcVar5 = s_IDirect3D8_00472f34;
    do {
      bVar1 = *ext;
      bVar6 = bVar1 < (byte)*pcVar5;
      if (bVar1 != *pcVar5) {
LAB_0040e1b7:
        iVar3 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
        goto LAB_0040e1bc;
      }
      if (bVar1 == 0) break;
      bVar1 = ((byte *)ext)[1];
      bVar6 = bVar1 < ((byte *)pcVar5)[1];
      if (bVar1 != ((byte *)pcVar5)[1]) goto LAB_0040e1b7;
      ext = (char *)((byte *)ext + 2);
      pcVar5 = (char *)((byte *)pcVar5 + 2);
    } while (bVar1 != 0);
    iVar3 = 0;
LAB_0040e1bc:
    if (iVar3 == 0) {
      iVar3 = (*grim_interface_ptr->vtable->grim_get_config_var)(aIStack_10,(uint *)0x51,unaff_EDI);
      return *(void **)(iVar3 + 0xc);
    }
  }
  return (void *)0x0;
}



/* mod_api_gfx_clear @ 0040e1f0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x1c: clAPI_t::GFX_Clear (bridges to grim_clear_color) */

void mod_api_gfx_clear(float r,float g,float b,float a)

{
  float unaff_retaddr;
  
  (*grim_interface_ptr->vtable->grim_clear_color)((IGrim2D *)r,g,b,a,unaff_retaddr);
  return;
}



/* mod_api_gfx_get_string_width @ 0040e220 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x20: clAPI_t::GFX_GetStringWidth (bridges to grim_measure_text_width) */

int mod_api_gfx_get_string_width(char *string)

{
  int iVar1;
  char *unaff_retaddr;
  
  iVar1 = (*grim_interface_ptr->vtable->grim_measure_text_width)((IGrim2D *)string,unaff_retaddr);
  return iVar1;
}



/* mod_api_gfx_printf @ 0040e240 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x24: clAPI_t::GFX_Printf */

void mod_api_gfx_printf(float x,float y,char *fmt,...)

{
  char *unaff_retaddr;
  char *in_stack_00000010;
  
  crt_vsprintf(&DAT_004d9d00,in_stack_00000010,&stack0x00000014);
  (*grim_interface_ptr->vtable->grim_draw_text_small)
            ((IGrim2D *)y,(float)fmt,7.127654e-39,unaff_retaddr);
  return;
}



/* mod_api_gfx_load_texture @ 0040e280 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x28: clAPI_t::GFX_LoadTexture (loads under mods\\ and prefixes CLM_) */

int mod_api_gfx_load_texture(char *filename)

{
  int iVar1;
  char acStack_208 [260];
  char acStack_104 [260];
  
  crt_sprintf(acStack_208,s_mods__s_00472f58,filename);
  crt_sprintf(acStack_104,s_CLM__s_00472f50,filename);
  iVar1 = texture_get_or_load(acStack_104,acStack_208);
  return iVar1;
}



/* mod_api_gfx_free_texture @ 0040e2e0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x2c: clAPI_t::GFX_FreeTexture (bridges to grim_destroy_texture) */

uchar mod_api_gfx_free_texture(int texId)

{
  int unaff_retaddr;
  
  (*grim_interface_ptr->vtable->grim_destroy_texture)((IGrim2D *)texId,unaff_retaddr);
  return '\x01';
}



/* mod_api_gfx_set_texture @ 0040e300 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x30: clAPI_t::GFX_SetTexture (bridges to grim_bind_texture(handle, 0)) */

void mod_api_gfx_set_texture(int texId)

{
  int unaff_retaddr;
  
  (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)texId,0,unaff_retaddr);
  return;
}



/* mod_api_gfx_set_color @ 0040e320 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x3c: clAPI_t::GFX_SetColor (bridges to grim_set_color) */

void mod_api_gfx_set_color(float r,float g,float b,float a)

{
  float unaff_retaddr;
  
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)r,g,b,a,unaff_retaddr);
  return;
}



/* mod_api_gfx_set_subset @ 0040e350 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x40: clAPI_t::GFX_SetSubset (bridges to grim_set_uv) */

void mod_api_gfx_set_subset(float x1,float y1,float x2,float y2)

{
  float unaff_retaddr;
  
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)x1,y1,x2,y2,unaff_retaddr);
  return;
}



/* mod_api_gfx_set_texture_filter @ 0040e380 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x34: clAPI_t::GFX_SetTextureFilter (bridges to grim_set_config_var(21, filter))
    */

void mod_api_gfx_set_texture_filter(int filter)

{
  uint in_stack_fffffff4;
  
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,filter,in_stack_fffffff4);
  return;
}



/* mod_api_gfx_set_blend_mode @ 0040e3a0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x38: clAPI_t::GFX_SetBlendMode (bridges to grim_set_config_var(19, src) and (20,
   dst)) */

void mod_api_gfx_set_blend_mode(int src,int dst)

{
  uint value;
  uint in_stack_fffffff4;
  uint uStack_4;
  
  value = 0x14;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,dst,in_stack_fffffff4);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,uStack_4,value);
  return;
}



/* mod_api_gfx_begin @ 0040e3e0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x44: clAPI_t::GFX_Begin (bridges to grim_begin_batch) */

void mod_api_gfx_begin(void)

{
  IGrim2D *unaff_retaddr;
  
  (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_retaddr);
  DAT_004824d0 = 1;
  return;
}



/* mod_api_gfx_end @ 0040e400 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x48: clAPI_t::GFX_End (bridges to grim_end_batch) */

void mod_api_gfx_end(void)

{
  IGrim2D *unaff_retaddr;
  
  (*grim_interface_ptr->vtable->grim_end_batch)(unaff_retaddr);
  DAT_004824d0 = 0;
  return;
}



/* mod_api_gfx_quad @ 0040e420 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x4c: clAPI_t::GFX_Quad (bridges to grim_draw_quad) */

void mod_api_gfx_quad(float x,float y,float w,float h)

{
  float unaff_retaddr;
  float in_stack_00000014;
  
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,unaff_retaddr);
  (*grim_interface_ptr->vtable->grim_draw_quad)((IGrim2D *)y,w,h,in_stack_00000014,x);
  if (DAT_004824d0 == '\0') {
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)y);
  }
  return;
}



/* mod_api_gfx_quad_rot @ 0040e470 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x50: clAPI_t::GFX_QuadRot */

void mod_api_gfx_quad_rot(float x,float y,float w,float h,float a)

{
  float unaff_retaddr;
  
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)a,unaff_retaddr);
  (*grim_interface_ptr->vtable->grim_draw_quad_rotated_matrix)((IGrim2D *)y,w,h,a,x);
  if (DAT_004824d0 == '\0') {
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)y);
  }
  return;
}



/* mod_api_gfx_draw_quads @ 0040e4c0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x54: clAPI_t::GFX_DrawQuads */

void mod_api_gfx_draw_quads(mod_vertex2_t *v,int numQuads)

{
  IGrim2D *self;
  float *in_stack_0000000c;
  IGrim2D *in_stack_fffffff8;
  
  if (DAT_004824d0 == '\0') {
    (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_fffffff8);
  }
  self = (IGrim2D *)0x0;
  (*grim_interface_ptr->vtable->grim_submit_vertices_offset)
            ((IGrim2D *)numQuads,in_stack_0000000c,(int)&stack0xfffffffc,(float *)0x0);
  if (DAT_004824d0 == '\0') {
    (*grim_interface_ptr->vtable->grim_end_batch)(self);
  }
  return;
}



/* mod_api_sfx_load_sample @ 0040e530 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x58: clAPI_t::SFX_LoadSample (loads under mods\\) */

int mod_api_sfx_load_sample(char *filename)

{
  int iVar1;
  char acStack_104 [260];
  
  crt_sprintf(acStack_104,s_mods__s_00472f58,filename);
  iVar1 = sfx_load_sample(acStack_104);
  return iVar1;
}



/* mod_api_sfx_free_sample @ 0040e560 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x5c: clAPI_t::SFX_FreeSample */

uchar mod_api_sfx_free_sample(int sfxId)

{
  int iVar1;
  
  iVar1 = sfx_release_sample(sfxId);
  return (uchar)iVar1;
}



/* mod_api_sfx_play_sample @ 0040e570 */

/* mod API vtable 0x60: clAPI_t::SFX_PlaySample */

void mod_api_sfx_play_sample(int sfxId,float pan,float volume)

{
  sfx_play_panned((float)sfxId);
  return;
}



/* mod_api_sfx_load_tune @ 0040e5b0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x64: clAPI_t::SFX_LoadTune (loads under mods\\) */

int mod_api_sfx_load_tune(char *filename)

{
  int iVar1;
  char acStack_104 [260];
  
  crt_sprintf(acStack_104,s_mods__s_00472f58,filename);
  iVar1 = music_load_track(acStack_104);
  return iVar1;
}



/* mod_api_sfx_free_tune @ 0040e5e0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x68: clAPI_t::SFX_FreeTune */

uchar mod_api_sfx_free_tune(int tuneId)

{
  int iVar1;
  
  iVar1 = music_release_track(tuneId);
  return (uchar)iVar1;
}



/* mod_api_sfx_play_tune @ 0040e5f0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x6c: clAPI_t::SFX_PlayTune */

void mod_api_sfx_play_tune(int tuneId)

{
  sfx_play_exclusive(tuneId);
  return;
}



/* mod_api_sfx_stop_tune @ 0040e600 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x70: clAPI_t::SFX_StopTune */

void mod_api_sfx_stop_tune(int tuneId)

{
  sfx_mute_all(tuneId);
  return;
}



/* mod_api_inp_get_pressed_char @ 0040e610 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x7c: clAPI_t::INP_GetPressedChar (bridges to grim_get_key_char) */

char mod_api_inp_get_pressed_char(void)

{
  int iVar1;
  IGrim2D *in_stack_00000004;
  
                    /* WARNING: Could not recover jumptable at 0x0040e618. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*grim_interface_ptr->vtable->grim_get_key_char)(in_stack_00000004);
  return (char)iVar1;
}



/* mod_api_inp_get_analog @ 0040e620 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x78: clAPI_t::INP_GetAnalog */

float mod_api_inp_get_analog(int key)

{
  float10 extraout_ST0;
  int unaff_retaddr;
  
  if (key == 0x163) {
    return ui_mouse_x;
  }
  if (key == 0x164) {
    return ui_mouse_y;
  }
  (*grim_interface_ptr->vtable->grim_get_config_float)((IGrim2D *)key,unaff_retaddr);
  return (float)extraout_ST0;
}



/* mod_api_inp_key_down @ 0040e660 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x74: clAPI_t::INP_KeyDown (uses grim_is_key_active) */

uchar mod_api_inp_key_down(int key)

{
  int iVar1;
  int unaff_retaddr;
  
  if (key == 1) {
    return '\0';
  }
  iVar1 = (*grim_interface_ptr->vtable->grim_is_key_active)((IGrim2D *)key,unaff_retaddr);
  return (uchar)iVar1;
}



/* mod_api_inp_get_key_name @ 0040e680 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* mod API vtable 0x80: clAPI_t::INP_GetKeyName */

char * mod_api_inp_get_key_name(int key)

{
  char *pcVar1;
  
  pcVar1 = input_key_name(key);
  return pcVar1;
}



/* mod_api_cl_enter_menu @ 0040e690 */

/* mod API vtable 0x84: clAPI_t::CL_EnterMenu (only handles "game_pause") */

void mod_api_cl_enter_menu(char *menu)

{
  byte bVar1;
  char *pcVar2;
  int iVar3;
  bool bVar4;
  
  if (menu != (char *)0x0) {
    pcVar2 = s_game_pause_00472f60;
    do {
      bVar1 = *pcVar2;
      bVar4 = bVar1 < (byte)*menu;
      if (bVar1 != *menu) {
LAB_0040e6c7:
        iVar3 = (1 - (uint)bVar4) - (uint)(bVar4 != 0);
        goto LAB_0040e6cc;
      }
      if (bVar1 == 0) break;
      bVar1 = ((byte *)pcVar2)[1];
      bVar4 = bVar1 < ((byte *)menu)[1];
      if (bVar1 != ((byte *)menu)[1]) goto LAB_0040e6c7;
      pcVar2 = (char *)((byte *)pcVar2 + 2);
      menu = (char *)((byte *)menu + 2);
    } while (bVar1 != 0);
    iVar3 = 0;
LAB_0040e6cc:
    if (iVar3 == 0) {
      if (plugin_interface_ptr != (mod_interface_t *)0x0) {
        (plugin_interface_ptr->parms).fields.onPause = '\x01';
      }
      ui_transition_direction = 0;
      game_state_pending = 5;
    }
  }
  return;
}



/* mod_load_info @ 0040e700 */

/* loads mods\%s, calls CMOD_GetInfo, copies the info struct to DAT_00481c88, and returns it */

void * mod_load_info(void)

{
  FARPROC pFVar1;
  undefined4 *puVar2;
  int iVar3;
  char *pcVar4;
  mod_info_t *pmVar5;
  char local_200 [512];
  
  crt_sprintf(local_200,s_mods__s_00472f58);
  console_printf(&console_log_queue,s_CMOD____s__00472fec,local_200);
  DAT_004824d8 = LoadLibraryA(local_200);
  if (DAT_004824d8 == (HMODULE)0x0) {
    console_printf(&console_log_queue,s_CMOD__Load_library_failed__00472fd0);
    return (void *)0x0;
  }
  pFVar1 = GetProcAddress(DAT_004824d8,s_CMOD_GetInfo_00472fc0);
  if (pFVar1 != (FARPROC)0x0) {
    if ((DAT_004819c8 & 1) == 0) {
      DAT_004819c8 = DAT_004819c8 | 1;
      mod_info_block.version = 1.0;
      mod_info_block.usesApiVersion = 3;
      pmVar5 = &mod_info_block;
      for (iVar3 = 8; iVar3 != 0; iVar3 = iVar3 + -1) {
        pmVar5->name[0] = '\0';
        pmVar5->name[1] = '\0';
        pmVar5->name[2] = '\0';
        pmVar5->name[3] = '\0';
        pmVar5 = (mod_info_t *)(pmVar5->name + 4);
      }
      pcVar4 = mod_info_block.author;
      for (iVar3 = 8; iVar3 != 0; iVar3 = iVar3 + -1) {
        pcVar4[0] = '\0';
        pcVar4[1] = '\0';
        pcVar4[2] = '\0';
        pcVar4[3] = '\0';
        pcVar4 = pcVar4 + 4;
      }
      crt_atexit(&DAT_0040e850);
    }
    puVar2 = (undefined4 *)(*pFVar1)();
    if (puVar2 == (undefined4 *)0x0) {
      console_printf(&console_log_queue,s_CMOD__bad_CMOD_GetInfo_function_00472f84);
    }
    else {
      pmVar5 = &mod_info_block;
      for (iVar3 = 0x12; iVar3 != 0; iVar3 = iVar3 + -1) {
        *(undefined4 *)pmVar5->name = *puVar2;
        puVar2 = puVar2 + 1;
        pmVar5 = (mod_info_t *)(pmVar5->name + 4);
      }
    }
    FreeLibrary(DAT_004824d8);
    console_printf(&console_log_queue,s_CMOD__mod_enum___s__00472f6c,&mod_info_block);
    return &mod_info_block;
  }
  console_printf(&console_log_queue,s_CMOD_GetInfo_failed__00472fa8);
  FreeLibrary(DAT_004824d8);
  return (void *)0x0;
}



/* mod_load_mod @ 0040e860 */

/* loads mods\%s, calls CMOD_GetMod, wires the mod context (offset +4), and returns the mod
   interface pointer */

void * mod_load_mod(void)

{
  FARPROC pFVar1;
  void *pvVar2;
  char local_200 [512];
  
  crt_sprintf(local_200,s_mods__s_00472f58);
  console_printf(&console_log_queue,s_CMOD____s__00472fec,local_200);
  DAT_004824d8 = LoadLibraryA(local_200);
  if (DAT_004824d8 == (HMODULE)0x0) {
    console_printf(&console_log_queue,s_CMOD__Load_library_failed__00472fd0);
    return (void *)0x0;
  }
  pFVar1 = GetProcAddress(DAT_004824d8,s_CMOD_GetMod_00473044);
  if (pFVar1 == (FARPROC)0x0) {
    console_printf(&console_log_queue,s_CMOD__CMOD_GetMod_failed__00473028);
    FreeLibrary(DAT_004824d8);
    return (void *)0x0;
  }
  pvVar2 = (void *)(*pFVar1)();
  if (pvVar2 == (void *)0x0) {
    console_printf(&console_log_queue,s_CMOD__bad_CMOD_GetMod_function_00473008);
  }
  else {
    *(mod_api_t **)((int)pvVar2 + 4) = &mod_api_context;
  }
  console_printf(&console_log_queue,s_CMOD_GetMod_ok_00472ff8);
  return pvVar2;
}



/* mods_any_available @ 0040e940 */

/* returns true if any mods\*.dll exist */

bool mods_any_available(void)

{
  HANDLE handle;
  int iVar1;
  int iVar2;
  uint local_118 [70];
  
  iVar2 = 0;
  handle = crt_findfirst(s_mods___dll_00473050,local_118);
  if ((handle != (HANDLE)0xffffffff) && (&stack0x00000000 != (undefined1 *)0x104)) {
    do {
      iVar2 = iVar2 + 1;
      iVar1 = crt_findnext(handle,local_118);
    } while (iVar1 == 0);
  }
  crt_findclose(handle);
  return iVar2 != 0;
}



/* credits_secret_match3_find @ 0040f400 */

/* scans a 6x6 board for a 3-in-a-row match; writes start index (row-major; leftmost/topmost) +
   orientation (0=vertical, 1=horizontal) */

uint __cdecl credits_secret_match3_find(int *board,int *out_idx,uchar *out_dir)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int local_4;
  
  local_4 = 0;
  iVar4 = 2;
  piVar2 = board;
  do {
    iVar3 = 0;
    piVar5 = piVar2;
    do {
      iVar1 = *piVar5;
      if (-1 < iVar1) {
        iVar6 = 1;
        if (board[iVar4 + iVar3 + -1] == iVar1) {
          iVar6 = 2;
        }
        if (board[iVar4 + iVar3] == iVar1) {
          iVar6 = iVar6 + 1;
        }
        if (iVar6 == 3) {
          *out_idx = iVar3 + local_4 * 6;
          *out_dir = '\x01';
          return CONCAT31((int3)((uint)out_dir >> 8),1);
        }
      }
      iVar3 = iVar3 + 1;
      piVar5 = piVar5 + 1;
    } while (iVar3 < 4);
    iVar4 = iVar4 + 6;
    local_4 = local_4 + 1;
    piVar2 = piVar2 + 6;
    if (0x25 < iVar4) {
      iVar4 = 0;
      do {
        iVar3 = 0;
        piVar2 = board;
        do {
          iVar1 = *piVar2;
          if (-1 < iVar1) {
            iVar6 = 1;
            if (piVar2[6] == iVar1) {
              iVar6 = 2;
            }
            if (piVar2[0xc] == iVar1) {
              iVar6 = iVar6 + 1;
            }
            if (iVar6 == 3) {
              *out_idx = iVar4 + iVar3 * 6;
              *out_dir = '\0';
              return CONCAT31((int3)((uint)out_idx >> 8),1);
            }
          }
          iVar3 = iVar3 + 1;
          piVar2 = piVar2 + 6;
        } while (iVar3 < 4);
        iVar4 = iVar4 + 1;
        board = board + 1;
        if (5 < iVar4) {
          return (uint)piVar2 & 0xffffff00;
        }
      } while( true );
    }
  } while( true );
}



/* credits_secret_alien_zookeeper_update @ 0040f4f0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* updates and renders the AlienZooKeeper credits secret; drives match-3 board state and UI */

void credits_secret_alien_zookeeper_update(void)

{
  IGrim2D_vtbl *pIVar1;
  int iVar2;
  float unaff_EBX;
  float unaff_EBP;
  IGrim2D *unaff_ESI;
  int iVar3;
  int *piVar4;
  int *piVar5;
  float unaff_EDI;
  float10 fVar6;
  IGrim2D IVar7;
  float fVar8;
  uint uVar9;
  char *h;
  float a;
  float fVar10;
  IGrim2D *in_stack_ffffffac;
  float *in_stack_ffffffb0;
  uchar *out_dir;
  int iStack_48;
  IGrim2D IStack_44;
  float fStack_40;
  IGrim2D IStack_3c;
  IGrim2D IStack_38;
  IGrim2D IStack_34;
  IGrim2D IStack_30;
  float fStack_2c;
  IGrim2D_vtbl *pIStack_28;
  float fStack_24;
  float fStack_20;
  float fStack_1c;
  float fStack_18;
  float fStack_14;
  float fStack_10;
  IGrim2D_vtbl *pIStack_c;
  undefined4 uStack_8;
  IGrim2D IStack_4;
  
  fStack_1c = _DAT_00489dfc + DAT_00489e20;
  a = 1.0;
  uVar9 = 0x3f800000;
  IStack_38.vtable = (IGrim2D_vtbl *)(DAT_00489e1c + _DAT_00489df8 + 300.0);
  IStack_34.vtable = (IGrim2D_vtbl *)(fStack_1c + 40.0);
  IStack_30.vtable = (IGrim2D_vtbl *)(((float)IStack_38.vtable + _DAT_00489de8) - 80.0);
  fStack_2c = (float)IStack_34.vtable + 10.0;
  pIStack_28 = IStack_30.vtable;
  fStack_24 = fStack_2c;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_EDI);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f4ccccd,uVar9);
  h = s_AlienZooKeeper_00473128;
  fVar10 = (float)IStack_30.vtable - 14.0;
  IVar7.vtable = IStack_34.vtable;
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,(float)IStack_34.vtable,fVar10,s_AlienZooKeeper_00473128);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3ee66666,(uint)IVar7.vtable);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,(float)IStack_3c.vtable + 12.0,(float)IStack_38.vtable + 10.0,
             s_a_puzzle_game_unfinished_0047310c);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,(float)IStack_3c.vtable + 18.0,(float)IStack_38.vtable + 23.0,
             s___or_something_more__004730f4);
  fVar8 = 0.8;
  uVar9 = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.8,fVar10);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3ed70a3d,uVar9);
  credits_secret_anim_time_ms = credits_secret_anim_time_ms + frame_dt_ms;
  if (0 < credits_secret_timer_ms) {
    credits_secret_timer_ms = credits_secret_timer_ms - frame_dt_ms;
    if (0 < credits_secret_timer_ms) goto LAB_0040f6cc;
    sfx_play(sfx_trooper_die_01);
  }
  if (credits_secret_timer_ms < 0) {
    credits_secret_timer_ms = 0;
  }
LAB_0040f6cc:
  IStack_3c.vtable = (IGrim2D_vtbl *)(IStack_3c.vtable + 40.0);
  fStack_40 = fStack_40 + 22.0;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.7,fVar8);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,(float)IStack_3c.vtable + 124.0,(float)IStack_38.vtable - 16.0,
             s_score___d_004730e8,credits_secret_score);
  fStack_1c = 0.0;
  fStack_18 = 0.0;
  fStack_14 = 0.0;
  fStack_10 = 0.6;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            (&IStack_3c,(float *)0x43400000,192.0,(float)&fStack_1c);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,fVar10);
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            (&IStack_38,(float *)0x43400000,192.0,(float)h);
  IStack_3c.vtable = (IGrim2D_vtbl *)(credits_secret_timer_ms / 100);
  if (0xc0 < (int)IStack_3c.vtable) {
    IStack_3c.vtable = (IGrim2D_vtbl *)0xc0;
  }
  IStack_44.vtable = IStack_34.vtable;
  fStack_40 = (float)IStack_30.vtable + 200.0;
  fStack_14 = 0.2;
  fStack_10 = 0.6;
  pIStack_c = (IGrim2D_vtbl *)0x3f800000;
  uStack_8 = 0x3f19999a;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            (&IStack_44,(float *)(float)(int)IStack_3c.vtable,6.0,(float)&fStack_14);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,a);
  IStack_38.vtable = IStack_30.vtable;
  IStack_34.vtable = (IGrim2D_vtbl *)(fStack_2c + 200.0);
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            (&IStack_38,(float *)0x43400000,6.0,unaff_EDI);
  iStack_48 = 0;
  iVar3 = 0;
  do {
    out_dir = (uchar *)0x0;
    do {
      if (credits_secret_selected_index == iVar3) {
        fStack_18 = (float)iStack_48;
        pIStack_c = (IGrim2D_vtbl *)0x3e4ccccd;
        uStack_8 = 0x3ecccccd;
        IStack_4.vtable = (IGrim2D_vtbl *)0x3f333333;
        IStack_38.vtable = (IGrim2D_vtbl *)(fStack_18 * 32.0);
        fStack_40 = (float)IStack_38.vtable + (float)pIStack_28;
        IStack_34.vtable = (IGrim2D_vtbl *)((float)(int)out_dir * 32.0 + fStack_2c + 4.0);
        IStack_30.vtable = (IGrim2D_vtbl *)(fStack_40 + 4.0);
        (*grim_interface_ptr->vtable->grim_draw_rect_filled)
                  (&IStack_34,(float *)0x41c00000,24.0,(float)&pIStack_c);
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,1.0,(float)unaff_ESI);
        unaff_ESI = (IGrim2D *)0x41c00000;
        (*grim_interface_ptr->vtable->grim_draw_rect_outline)
                  (&IStack_30,(float *)0x41c00000,24.0,unaff_EBP);
      }
      out_dir = out_dir + 1;
      iVar3 = iVar3 + 1;
    } while ((int)out_dir < 6);
    iStack_48 = iStack_48 + 1;
  } while (iVar3 < 0x24);
  (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_ESI);
  (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_004827b0,0,(int)unaff_EBP);
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,unaff_EBX);
  IStack_3c.vtable = (IGrim2D_vtbl *)0x0;
  pIStack_28 = (IGrim2D_vtbl *)0x0;
  IStack_30.vtable = (IGrim2D_vtbl *)0x0;
  piVar4 = &credits_secret_board;
  do {
    fStack_40 = 0.0;
    IStack_38.vtable = (IGrim2D_vtbl *)0x0;
    do {
      IVar7.vtable = IStack_38.vtable;
      if (*piVar4 != -3) {
        uVar9 = credits_secret_anim_time_ms / 0x32 + *piVar4 * 2 & 0x8000001f;
        if ((int)uVar9 < 0) {
          uVar9 = (uVar9 - 1 | 0xffffffe0) + 1;
        }
        (*grim_interface_ptr->vtable->grim_set_atlas_frame)
                  ((IGrim2D *)0x8,uVar9,(int)in_stack_ffffffac);
        iVar3 = *piVar4;
        if (iVar3 == 0) {
          fVar8 = 0.5;
          fVar10 = 0.5;
          pIVar1 = grim_interface_ptr->vtable;
LAB_0040fae2:
          (*pIVar1->grim_set_color)((IGrim2D *)0x3f800000,fVar10,fVar8,1.0,(float)in_stack_ffffffb0)
          ;
        }
        else if (iVar3 == 1) {
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f000000,0.5,1.0,1.0,(float)in_stack_ffffffb0);
        }
        else {
          if (iVar3 == 2) {
            fVar8 = 1.0;
            fVar10 = 0.5;
            pIVar1 = grim_interface_ptr->vtable;
            goto LAB_0040fae2;
          }
          if (iVar3 == 3) {
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)0x3f000000,1.0,1.0,1.0,(float)in_stack_ffffffb0);
          }
          else if (iVar3 == 4) {
            fVar8 = 0.5;
            fVar10 = 1.0;
            pIVar1 = grim_interface_ptr->vtable;
            goto LAB_0040fae2;
          }
        }
        in_stack_ffffffb0 = (float *)0x42000000;
        in_stack_ffffffac = (IGrim2D *)0x42000000;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)((float)(int)IStack_30.vtable + fStack_18),
                   (float)(int)fStack_20 + fStack_14,32.0,32.0,(float)out_dir);
        if (0 < credits_secret_timer_ms) {
          out_dir = (uchar *)0x20;
          in_stack_ffffffac = &IStack_4;
          in_stack_ffffffb0 = (float *)0x20;
          IStack_4.vtable = (IGrim2D_vtbl *)((float)(int)IStack_34.vtable * 32.0 + fStack_14);
          iVar3 = ui_mouse_inside_rect((float *)in_stack_ffffffac,0x20,0x20);
          if ((char)iVar3 != '\0') {
            out_dir = (uchar *)0x40fb7b;
            iVar3 = input_primary_just_pressed();
            if ((char)iVar3 != '\0') {
              out_dir = (uchar *)0x3f800000;
              in_stack_ffffffac = (IGrim2D *)0x40fb94;
              in_stack_ffffffb0 = (float *)sfx_ui_clink_01;
              sfx_play(sfx_ui_clink_01);
              if (credits_secret_selected_index == -1) {
                credits_secret_selected_index =
                     (int)&(IStack_34.vtable)->grim_release + (int)fStack_24;
              }
              else {
                iVar3 = *piVar4;
                *piVar4 = (&credits_secret_board)[credits_secret_selected_index];
                (&credits_secret_board)[credits_secret_selected_index] = iVar3;
                out_dir = (uchar *)((int)&IStack_38.vtable + 3);
                in_stack_ffffffb0 = &fStack_2c;
                in_stack_ffffffac = (IGrim2D *)&credits_secret_board;
                credits_secret_selected_index = -1;
                fStack_2c = 0.0;
                IStack_38.vtable = IStack_38.vtable & 0xffffff;
                uVar9 = credits_secret_match3_find
                                  (&credits_secret_board,(int *)in_stack_ffffffb0,out_dir);
                if ((char)uVar9 != '\0') {
                  (&credits_secret_board)[(int)fStack_2c] = 0xfffffffd;
                  if (IStack_38.vtable._3_1_ == '\0') {
                    *(undefined4 *)(&credits_secret_match_mask_v0 + (int)fStack_2c * 4) = 0xfffffffd
                    ;
                    *(undefined4 *)(&credits_secret_match_mask_v1 + (int)fStack_2c * 4) = 0xfffffffd
                    ;
                  }
                  else {
                    (&credits_secret_match_mask_h0)[(int)fStack_2c] = 0xfffffffd;
                    (&credits_secret_match_mask_h1)[(int)fStack_2c] = 0xfffffffd;
                  }
                  credits_secret_score = (undefined4 *)((int)credits_secret_score + 1);
                  out_dir = (uchar *)0x3f800000;
                  in_stack_ffffffac = (IGrim2D *)0x40fc38;
                  in_stack_ffffffb0 = (float *)sfx_ui_bonus;
                  sfx_play(sfx_ui_bonus);
                  credits_secret_timer_ms = credits_secret_timer_ms + 2000;
                }
              }
            }
          }
        }
      }
      IStack_38.vtable = (IGrim2D_vtbl *)&(IVar7.vtable)->grim_set_config_var;
      fStack_40 = (float)((int)fStack_40 + 1);
      piVar4 = piVar4 + 1;
    } while ((int)IStack_38.vtable < 0xc0);
    IStack_3c.vtable = (IGrim2D_vtbl *)((int)&(IStack_3c.vtable)->grim_release + 1);
    IStack_30.vtable = (IGrim2D_vtbl *)((int)&(IStack_30.vtable)->grim_set_paused + 2);
    pIStack_28 = (IGrim2D_vtbl *)&pIStack_28->grim_set_config_var;
    if (0x481a7b < (int)piVar4) {
      (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_ffffffac);
      if (credits_secret_timer_ms == 0) {
        uVar9 = 0x3f800000;
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,1.0,(float)in_stack_ffffffb0);
        (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f800000,uVar9);
        fVar6 = (float10)fcos((float10)credits_secret_anim_time_ms * (float10)0.005);
        if ((float10)0.0 < fVar6) {
          (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                    (grim_interface_ptr,fStack_20 + 38.0,(fStack_1c + 96.0) - 22.0,
                     s_Game_Over_004730dc);
        }
      }
      piVar4 = &credits_secret_board;
      do {
        iVar3 = 6;
        do {
          if (*piVar4 == -1) {
            iVar2 = crt_rand();
            *piVar4 = iVar2 % 5;
          }
          piVar4 = piVar4 + 1;
          iVar3 = iVar3 + -1;
        } while (iVar3 != 0);
      } while ((int)piVar4 < 0x481a7c);
      if ((credits_secret_flags & 1) == 0) {
        credits_secret_flags = credits_secret_flags | 1;
        DAT_004819d6 = 1;
        DAT_004819e5 = 0;
        DAT_004819e4 = 0;
        _DAT_004819e0 = 0x3f800000;
        _DAT_004819dc = 0;
        _credits_secret_reset_button = (char *)0x0;
        DAT_004819d4 = 0;
        DAT_004819d5 = 0;
        _DAT_004819d8 = 0;
        crt_atexit(&DAT_0040ff40);
      }
      fStack_10 = fStack_18 + 38.0;
      _credits_secret_reset_button = s_Reset_004730d4;
      IStack_30.vtable = (IGrim2D_vtbl *)(fStack_14 + 256.0);
      pIStack_c = IStack_30.vtable;
      iVar3 = ui_button_update(&fStack_10,(ui_button_t *)&credits_secret_reset_button);
      if ((char)iVar3 != '\0') {
        pIStack_28 = (IGrim2D_vtbl *)0x0;
        IStack_44.vtable = IStack_44.vtable & 0xffffff;
        do {
          piVar4 = &credits_secret_board;
          do {
            iVar3 = 6;
            piVar5 = piVar4;
            do {
              iVar2 = crt_rand();
              piVar4 = piVar5 + 1;
              iVar3 = iVar3 + -1;
              *piVar5 = iVar2 % 5;
              piVar5 = piVar4;
            } while (iVar3 != 0);
          } while ((int)piVar4 < 0x481a7c);
          uVar9 = credits_secret_match3_find
                            (&credits_secret_board,(int *)&pIStack_28,
                             (uchar *)((int)&IStack_44.vtable + 3));
        } while ((char)uVar9 != '\0');
        credits_secret_selected_index = -1;
        credits_secret_score = (undefined4 *)0x0;
        credits_secret_timer_ms = 0x2580;
      }
      if ((credits_secret_flags & 2) == 0) {
        credits_secret_flags = credits_secret_flags | 2;
        DAT_00481bc6 = 1;
        DAT_00481bd5 = 0;
        DAT_00481bd4 = 0;
        _DAT_00481bd0 = 0x3f800000;
        _DAT_00481bcc = 0;
        _credits_secret_back_button = (undefined *)0x0;
        DAT_00481bc4 = 0;
        DAT_00481bc5 = 0;
        _DAT_00481bc8 = 0;
        crt_atexit(&DAT_0040ff30);
      }
      fStack_10 = fStack_18 + 138.0;
      _credits_secret_back_button = &DAT_00472e80;
      pIStack_c = IStack_30.vtable;
      iVar3 = ui_button_update(&fStack_10,(ui_button_t *)&credits_secret_back_button);
      if ((char)iVar3 != '\0') {
        ui_transition_direction = 0;
        game_state_pending = 4;
      }
      return;
    }
  } while( true );
}



/* FUN_0040ff50 @ 0040ff50 */

/* [binja] int32_t sub_40ff50(int32_t arg1) */

int __cdecl FUN_0040ff50(int arg1)

{
  int iVar1;
  
  iVar1 = arg1 % 0x3c;
  if (iVar1 < 10) {
    crt_sprintf(&DAT_00482624,s__d_0_d_00473150,arg1 / 0x3c,iVar1);
    return 0x482624;
  }
  crt_sprintf(&DAT_00482624,s__d__d_00473148,arg1 / 0x3c,iVar1);
  return 0x482624;
}



/* game_over_screen_update @ 0040ffc0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* game over flow: high score entry, results text, and navigation buttons */

void game_over_screen_update(void)

{
  char cVar1;
  float fVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  float *unaff_EBX;
  float *unaff_EBP;
  uint unaff_ESI;
  undefined4 *puVar7;
  char *pcVar8;
  IGrim2D *unaff_EDI;
  highscore_record_t *phVar9;
  undefined4 *puVar10;
  char *pcVar11;
  highscore_record_t *phVar12;
  longlong lVar13;
  float unaff_retaddr;
  float fStack00000004;
  int y;
  int w;
  float local_10;
  float local_c;
  float local_8;
  float local_4;
  
  if ((DAT_004825fc & 1) == 0) {
    DAT_004825fc = DAT_004825fc | 1;
    DAT_004825ae = 1;
    DAT_004825bd = 0;
    DAT_004825bc = 0;
    _DAT_004825b8 = 0x3f800000;
    _DAT_004825b4 = 0;
    _DAT_004825a8 = (undefined *)0x0;
    DAT_004825ac = 0;
    DAT_004825ad = '\0';
    _DAT_004825b0 = 0;
    crt_atexit(&DAT_004107d0);
  }
  if ((DAT_004825fc & 2) == 0) {
    DAT_004825fc = DAT_004825fc | 2;
    _DAT_004825a0 = 0x3f800000;
    _DAT_00482590 = &DAT_0048256c;
    DAT_00482594 = 0;
    _DAT_00482598 = 0x18;
    _DAT_0048259c = 0x60;
    crt_atexit(&DAT_004107c0);
  }
  _bonus_reflex_boost_timer = 0;
  if ((ui_transition_direction != '\0') && (DAT_0048724d != '\0')) {
    DAT_0048724d = '\0';
    DAT_00487234 = 1;
  }
  if ((((game_state_id == 7) && (game_state_pending == 0x19)) && (ui_transition_direction != '\0'))
     && (iVar3 = sfx_is_unmuted(music_track_shortie_monk_id), (char)iVar3 == '\0')) {
    sfx_play_exclusive(music_track_shortie_monk_id);
  }
  gameplay_render_world();
  ui_elements_update_and_render();
  perk_prompt_update_and_render();
  local_4 = _DAT_0048cc64 + DAT_0048cc88;
  local_10 = DAT_0048cc84 + _DAT_0048cc60 + 180.0;
  fVar2 = local_4 + 40.0;
  w = 0x40;
  local_8 = (_DAT_0048cc50 + local_10 + 44.0) - 10.0;
  y = 0x100;
  iVar3 = DAT_0048f7f8;
  local_c = fVar2;
  lVar13 = __ftol();
  iVar6 = (int)lVar13;
  lVar13 = __ftol();
  ui_draw_textured_quad((int)lVar13,iVar6,y,w,iVar3);
  if (DAT_00487234 == -1) {
    highscore_load_table();
    DAT_004825a4 = highscore_rank_index();
    highscore_active_record.game_mode_id = config_blob.reserved0[0x18];
    (*grim_interface_ptr->vtable->grim_flush_input)(unaff_EDI);
    console_input_poll();
    (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1c,unaff_ESI);
    if (DAT_004825a4 < 100) {
      uVar4 = 0xffffffff;
      DAT_00487234 = 0;
      phVar12 = &highscore_active_record;
      do {
        phVar9 = phVar12;
        if (uVar4 == 0) break;
        uVar4 = uVar4 - 1;
        phVar9 = (highscore_record_t *)(phVar12->player_name + 1);
        pcVar8 = phVar12->player_name;
        phVar12 = phVar9;
      } while (*pcVar8 != '\0');
      uVar4 = ~uVar4;
      _DAT_00482598 = 0x14;
      _DAT_00482590 = &DAT_0048256c;
      puVar7 = (undefined4 *)((int)phVar9 - uVar4);
      puVar10 = &DAT_0048256c;
      for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
        *puVar10 = *puVar7;
        puVar7 = puVar7 + 1;
        puVar10 = puVar10 + 1;
      }
      for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
        *(undefined1 *)puVar10 = *(undefined1 *)puVar7;
        puVar7 = (undefined4 *)((int)puVar7 + 1);
        puVar10 = (undefined4 *)((int)puVar10 + 1);
      }
      uVar4 = 0xffffffff;
      phVar12 = &highscore_active_record;
      do {
        if (uVar4 == 0) break;
        uVar4 = uVar4 - 1;
        pcVar8 = phVar12->player_name;
        phVar12 = (highscore_record_t *)(phVar12->player_name + 1);
      } while (*pcVar8 != '\0');
      DAT_00482594 = ~uVar4 - 1;
LAB_00410232:
      local_10 = local_10 + 8.0;
      DAT_00496604 = 0x3f800000;
      local_c = local_c + 84.0;
      (*grim_interface_ptr->vtable->grim_set_color_ptr)((IGrim2D *)&DAT_004965f8,unaff_EBP);
      (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                (grim_interface_ptr,local_c + 42.0,local_8,s_State_your_name__trooper__00473190);
      local_8 = local_8 + 40.0;
      DAT_00496604 = 0x3f333333;
      _DAT_004825a8 = &DAT_0047318c;
      local_4 = local_c + 170.0;
      ui_button_update(&local_4,(ui_button_t *)&DAT_004825a8);
      _DAT_0048259c = 0xa6;
      iVar3 = ui_text_input_update(&local_c,(int *)&DAT_00482590);
      if (((char)iVar3 != '\0') || (DAT_004825ad != '\0')) {
        uVar4 = 0xffffffff;
        iVar3 = 0;
        pcVar8 = (char *)&DAT_0048256c;
        do {
          if (uVar4 == 0) break;
          uVar4 = uVar4 - 1;
          cVar1 = *pcVar8;
          pcVar8 = pcVar8 + 1;
        } while (cVar1 != '\0');
        iVar6 = ~uVar4 - 1;
        if (0 < iVar6) {
          if (0 < iVar6) {
            do {
              if (*(char *)((int)&DAT_0048256c + iVar3) != ' ') break;
              iVar3 = iVar3 + 1;
            } while (iVar3 < iVar6);
          }
          if (*(char *)((int)&DAT_0048256c + iVar3) != '\0') {
            DAT_00487234 = 1;
            sfx_play(sfx_ui_typeenter);
            phVar12 = &highscore_active_record;
            for (iVar3 = 7; iVar3 != 0; iVar3 = iVar3 + -1) {
              phVar12->player_name[0] = '\0';
              phVar12->player_name[1] = '\0';
              phVar12->player_name[2] = '\0';
              phVar12->player_name[3] = '\0';
              phVar12 = (highscore_record_t *)(phVar12->player_name + 4);
            }
            uVar4 = 0xffffffff;
            pcVar8 = (char *)&DAT_0048256c;
            do {
              pcVar11 = pcVar8;
              if (uVar4 == 0) break;
              uVar4 = uVar4 - 1;
              pcVar11 = pcVar8 + 1;
              cVar1 = *pcVar8;
              pcVar8 = pcVar11;
            } while (cVar1 != '\0');
            uVar4 = ~uVar4;
            _DAT_00482590 = &DAT_0048256c;
            pcVar8 = pcVar11 + -uVar4;
            phVar12 = &highscore_active_record;
            for (uVar5 = uVar4 >> 2; iVar3 = DAT_00482594, uVar5 != 0; uVar5 = uVar5 - 1) {
              *(undefined4 *)phVar12->player_name = *(undefined4 *)pcVar8;
              pcVar8 = pcVar8 + 4;
              phVar12 = (highscore_record_t *)(phVar12->player_name + 4);
            }
            player_name_length = DAT_00482594;
            for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
              phVar12->player_name[0] = *pcVar8;
              pcVar8 = pcVar8 + 1;
              phVar12 = (highscore_record_t *)(phVar12->player_name + 1);
            }
            highscore_active_record.player_name[iVar3] = '\0';
            highscore_save_active();
            highscore_load_table();
            goto LAB_004103c2;
          }
        }
        DAT_004825ad = '\0';
        sfx_play(sfx_shock_hit_01);
      }
LAB_004103c2:
      local_8 = local_8 + 60.0;
      (*grim_interface_ptr->vtable->grim_set_color_ptr)((IGrim2D *)&DAT_004965f8,unaff_EBX);
      if (DAT_004825a4 < 100) {
        fStack00000004 = local_4 + 16.0;
        ui_text_input_render(&stack0x00000000,6.652423e-39,1.0);
        ui_cursor_render();
        return;
      }
      goto LAB_00410782;
    }
    DAT_00487234 = 1;
  }
  else {
    if (DAT_00487234 == 0) goto LAB_00410232;
    if (DAT_00487234 != 1) goto LAB_00410782;
  }
  local_10 = unaff_retaddr + 30.0;
  _DAT_00482590 = &DAT_0048256c;
  if (DAT_004825a4 < 100) {
    local_c = fVar2 + 64.0;
  }
  else {
    local_c = fVar2 + 62.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,local_10 + 8.0,local_c,s_Score_too_low_for_top_d__00473170,100);
    local_c = local_c + 6.0;
  }
  local_8 = local_10;
  local_4 = local_c + 16.0;
  ui_text_input_render(&local_8,6.652423e-39,1.0);
  local_c = local_c + 146.0;
  if ((DAT_004825fc & 4) == 0) {
    DAT_004825fc = DAT_004825fc | 4;
    DAT_0048250e = 1;
    DAT_0048251d = 0;
    DAT_0048251c = 0;
    _DAT_00482518 = 0x3f800000;
    _DAT_00482514 = 0;
    _DAT_00482508 = (char *)0x0;
    DAT_0048250c = 0;
    DAT_0048250d = '\0';
    _DAT_00482510 = 0;
    crt_atexit(&DAT_004107b0);
  }
  _DAT_00482508 = s_Play_Again_00473164;
  if ((DAT_004825fc & 8) == 0) {
    DAT_004825fc = DAT_004825fc | 8;
    DAT_00482556 = 1;
    DAT_00482565 = 0;
    DAT_00482564 = 0;
    _DAT_00482560 = 0x3f800000;
    _DAT_0048255c = 0;
    _DAT_00482550 = (char *)0x0;
    DAT_00482554 = 0;
    DAT_00482555 = '\0';
    _DAT_00482558 = 0;
    crt_atexit(&DAT_004107a0);
  }
  _DAT_00482550 = s_High_scores_00473158;
  if ((DAT_004825fc & 0x10) == 0) {
    DAT_004825fc = DAT_004825fc | 0x10;
    DAT_0048253e = 1;
    DAT_0048254d = 0;
    DAT_0048254c = 0;
    _DAT_00482548 = 0x3f800000;
    _DAT_00482544 = 0;
    _DAT_00482538 = (char *)0x0;
    DAT_0048253c = 0;
    DAT_0048253d = '\0';
    _DAT_00482540 = 0;
    crt_atexit(&DAT_00410790);
  }
  _DAT_00482538 = s_Main_Menu_00472084;
  local_10 = (local_10 - 4.0) + 26.0;
  ui_button_update(&local_10,(ui_button_t *)&DAT_00482508);
  local_c = local_c + 32.0;
  ui_button_update(&local_10,(ui_button_t *)&DAT_00482550);
  local_c = local_c + 32.0;
  ui_button_update(&local_10,(ui_button_t *)&DAT_00482538);
  local_c = local_c + 32.0;
  if (DAT_0048250d != '\0') {
    ui_transition_direction = '\0';
    game_state_pending = 9;
    if (config_blob.reserved0._24_4_ == 4) {
      game_state_pending = 0x12;
    }
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
  }
  if (DAT_00482555 != '\0') {
    DAT_00487258._0_1_ = config_blob.reserved0[0x18];
    DAT_00487258._1_1_ = config_blob.reserved0[0x19];
    DAT_00487258._2_1_ = config_blob.reserved0[0x1a];
    DAT_00487258._3_1_ = config_blob.reserved0[0x1b];
    DAT_0048724d = '\x01';
    DAT_00487250 = _quest_stage_major;
    DAT_00487254 = _quest_stage_minor;
    DAT_0048725c = config_blob.hardcore;
    ui_transition_direction = '\0';
    game_state_pending = 0xe;
  }
  if (DAT_0048253d != '\0') {
    sfx_mute_all(music_track_extra_0);
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_play_exclusive(music_track_crimson_theme_id);
    ui_transition_direction = '\0';
    game_state_pending = 0;
    ui_sign_crimson_update_disabled = 0;
  }
LAB_00410782:
  ui_cursor_render();
  return;
}



/* quest_failed_screen_update @ 004107e0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* quest failure screen: retry options and navigation */

void quest_failed_screen_update(void)

{
  float fVar1;
  int iVar2;
  int x;
  IGrim2D_vtbl *pIVar3;
  char *unaff_EBX;
  uint unaff_ESI;
  IGrim2D *unaff_EDI;
  longlong lVar4;
  float unaff_retaddr;
  int y;
  int w;
  char *y_00;
  float local_c;
  float local_8;
  float local_4;
  
  _bonus_reflex_boost_timer = 0;
  if ((((game_state_id == 0xc) && (game_state_pending == 0x19)) && (ui_transition_direction != '\0')
      ) && (iVar2 = sfx_is_unmuted(music_track_shortie_monk_id), (char)iVar2 == '\0')) {
    sfx_play_exclusive(music_track_shortie_monk_id);
  }
  gameplay_render_world();
  ui_elements_update_and_render();
  perk_prompt_update_and_render();
  local_4 = _DAT_0048dbdc + DAT_0048dc00;
  fVar1 = local_4 + 40.0;
  w = 0x40;
  local_8 = (_DAT_0048dbc8 + DAT_0048dbfc + _DAT_0048dbd8 + 180.0 + 44.0) - 10.0;
  y = 0x100;
  iVar2 = DAT_0048f7f8;
  local_c = fVar1;
  lVar4 = __ftol();
  x = (int)lVar4;
  lVar4 = __ftol();
  ui_draw_textured_quad((int)lVar4,x,y,w,iVar2);
  if (DAT_00487234 == -1) {
    highscore_load_table();
    DAT_00482604 = highscore_rank_index();
    highscore_active_record.game_mode_id = config_blob.reserved0[0x18];
    (*grim_interface_ptr->vtable->grim_flush_input)(unaff_EDI);
    console_input_poll();
    (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1c,unaff_ESI);
    DAT_00487234 = 0;
  }
  else if (DAT_00487234 != 0) goto LAB_00410cc1;
  local_c = fVar1 + 70.0 + 16.0;
  switch(DAT_00487194) {
  default:
    y_00 = s_Quest_failed__try_again__004731bc;
    pIVar3 = grim_interface_ptr->vtable;
    break;
  case 1:
    y_00 = s_You_didn_t_make_it__do_try_again_00473244;
    pIVar3 = grim_interface_ptr->vtable;
    break;
  case 2:
    y_00 = s_Third_time_no_good__00473230;
    pIVar3 = grim_interface_ptr->vtable;
    break;
  case 3:
    y_00 = s_No_luck_this_time__have_another_g_0047320c;
    pIVar3 = grim_interface_ptr->vtable;
    break;
  case 4:
    y_00 = s_Persistence_will_be_rewared__004731ec;
    pIVar3 = grim_interface_ptr->vtable;
    break;
  case 5:
    y_00 = s_Try_one_more_time__004731d8;
    pIVar3 = grim_interface_ptr->vtable;
  }
  (*pIVar3->grim_draw_text_small)((IGrim2D *)(unaff_retaddr + 30.0),local_c,(float)y_00,unaff_EBX);
  local_8 = local_8 + 16.0;
  local_c = local_c + 6.0;
  local_4 = local_c + 4.0;
  ui_text_input_render(&local_4,6.652423e-39,1.0);
  local_8 = local_8 + 98.0;
  local_c = local_c + 16.0;
  if ((DAT_004825d8 & 1) == 0) {
    DAT_004825d8 = DAT_004825d8 | 1;
    DAT_00482686 = 1;
    DAT_00482695 = 0;
    DAT_00482694 = 0;
    _DAT_00482690 = 0x3f800000;
    _DAT_0048268c = 0;
    _DAT_00482680 = (char *)0x0;
    DAT_00482684 = 0;
    DAT_00482685 = '\0';
    _DAT_00482688 = 0;
    crt_atexit(&DAT_00410d10);
  }
  _DAT_00482680 = s_Play_Again_00473164;
  if ((DAT_004825d8 & 2) == 0) {
    DAT_004825d8 = DAT_004825d8 | 2;
    DAT_0048269e = 1;
    DAT_004826ad = 0;
    DAT_004826ac = 0;
    _DAT_004826a8 = 0x3f800000;
    _DAT_004826a4 = 0;
    _DAT_00482698 = (char *)0x0;
    DAT_0048269c = 0;
    DAT_0048269d = '\0';
    _DAT_004826a0 = 0;
    crt_atexit(&DAT_00410d00);
  }
  _DAT_00482698 = s_Play_Another_004731ac;
  if ((DAT_004825d8 & 4) == 0) {
    DAT_004825d8 = DAT_004825d8 | 4;
    DAT_004824f6 = 1;
    DAT_00482505 = 0;
    DAT_00482504 = 0;
    _DAT_00482500 = 0x3f800000;
    _DAT_004824fc = 0;
    _DAT_004824f0 = (char *)0x0;
    DAT_004824f4 = 0;
    DAT_004824f5 = '\0';
    _DAT_004824f8 = 0;
    crt_atexit(&DAT_00410cf0);
  }
  _DAT_004824f0 = s_Main_Menu_00472084;
  ui_button_update(&local_c,(ui_button_t *)&DAT_00482680);
  local_8 = local_8 + 32.0;
  ui_button_update(&local_c,(ui_button_t *)&DAT_00482698);
  local_8 = local_8 + 32.0;
  ui_button_update(&local_c,(ui_button_t *)&DAT_004824f0);
  local_8 = local_8 + 32.0;
  if (DAT_00482685 != '\0') {
    DAT_00487194 = DAT_00487194 + 1;
    ui_transition_direction = '\0';
    game_state_pending = 9;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    render_pass_mode = 0;
  }
  if (DAT_0048269d != '\0') {
    DAT_00487194 = 0;
    ui_transition_direction = '\0';
    game_state_pending = 0xb;
    ui_sign_crimson_update_disabled = 0;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    sfx_play_exclusive(music_track_crimson_theme_id);
  }
  if (DAT_004824f5 != '\0') {
    DAT_00487194 = 0;
    sfx_mute_all(music_track_extra_0);
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_play_exclusive(music_track_crimson_theme_id);
    ui_transition_direction = '\0';
    game_state_pending = 0;
    ui_sign_crimson_update_disabled = 0;
  }
LAB_00410cc1:
  ui_cursor_render();
  return;
}



/* quest_results_screen_update @ 00410d20 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* quest/campaign results screen: final time, perk bonus, high score entry, and buttons */

void quest_results_screen_update(void)

{
  char cVar1;
  IGrim2D_vtbl *pIVar2;
  float fVar3;
  int iVar4;
  float fVar5;
  char *pcVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  float unaff_EBX;
  float *unaff_EBP;
  IGrim2D *unaff_ESI;
  undefined4 *puVar10;
  float unaff_EDI;
  highscore_record_t *phVar11;
  undefined4 *puVar12;
  char *pcVar13;
  highscore_record_t *phVar14;
  longlong lVar15;
  float unaff_retaddr;
  float in_stack_00000004;
  float in_stack_00000008;
  float in_stack_0000000c;
  int y;
  float fVar16;
  int w;
  float a;
  float a_00;
  float h;
  IGrim2D *self;
  float b;
  IGrim2D a_01;
  float local_10;
  float local_8;
  float local_4;
  
  _bonus_reflex_boost_timer = 0;
  DAT_00487194 = 0;
  if ((((game_state_id == 8) && (game_state_pending == 0x19)) && (ui_transition_direction != '\0'))
     && (iVar4 = sfx_is_unmuted(music_track_shortie_monk_id), (char)iVar4 == '\0')) {
    sfx_play_exclusive(music_track_crimsonquest_id);
  }
  gameplay_render_world();
  ui_elements_update_and_render();
  if ((DAT_00482568 & 1) == 0) {
    DAT_00482568 = DAT_00482568 | 1;
    DAT_00482526 = 1;
    DAT_00482535 = 0;
    DAT_00482534 = 0;
    _DAT_00482530 = 1.0;
    _DAT_0048252c = 0;
    _DAT_00482520 = (undefined *)0x0;
    DAT_00482524 = 0;
    DAT_00482525 = '\0';
    _DAT_00482528 = 0;
    crt_atexit(&DAT_00412070);
  }
  if ((DAT_00482568 & 2) == 0) {
    DAT_00482568 = DAT_00482568 | 2;
    _DAT_004826f8 = 1.0;
    _DAT_004826e8 = &DAT_004825dc;
    DAT_004826ec = 0;
    _DAT_004826f0 = 0x18;
    _DAT_004826f4 = 0x60;
    crt_atexit(&DAT_00412060);
  }
  local_4 = _DAT_0048dbdc + DAT_0048dc00;
  w = 0x40;
  y = 0x100;
  a_01.vtable = (IGrim2D_vtbl *)(DAT_0048dbfc + _DAT_0048dbd8 + 180.0);
  fVar3 = local_4 + 40.0;
  fVar16 = (float)a_01.vtable + _DAT_0048dbc8 + 40.0;
  iVar4 = DAT_0048f804;
  fVar5 = fVar3;
  lVar15 = __ftol();
  iVar9 = (int)lVar15;
  lVar15 = __ftol();
  ui_draw_textured_quad((int)lVar15,iVar9,y,w,iVar4);
  fVar3 = fVar3 + 56.0;
  local_8 = fVar16;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_EDI);
  if (((game_state_prev == 0xe) && (ui_transition_direction != '\0')) && (DAT_0048724d != '\0')) {
    DAT_0048724d = '\0';
    DAT_00487234 = 2;
  }
  else {
    if (DAT_00487234 == -2) {
      iVar4 = _quest_stage_minor + -0xb + _quest_stage_major * 10;
      DAT_00482700 = (&quest_unlock_weapon_id)[iVar4 * 0xb];
      DAT_00482704 = (&quest_unlock_perk_id)[iVar4 * 0xb];
      lVar15 = __ftol();
      fVar5 = (float)lVar15;
      player_health._pad0._0_4_ = (BADTYPE)(int)fVar5;
      lVar15 = __ftol();
      iVar4 = (int)lVar15;
      if (config_blob.reserved0._20_4_ == 2) {
        DAT_00482600 = iVar4;
        lVar15 = __ftol();
        iVar4 = iVar4 + (int)lVar15;
      }
      DAT_0048270c = (quest_spawn_timeline + perk_pending_count * -1000) - iVar4;
      highscore_active_record.survival_elapsed_ms = DAT_0048270c;
      if (DAT_0048270c == 0) {
        highscore_active_record.survival_elapsed_ms = 1;
      }
      DAT_00482708 = 0;
      DAT_00482600 = iVar4;
      highscore_record_init();
      DAT_00482724 = 700;
      DAT_00487234 = DAT_00487234 + 1;
      DAT_00482710 = 0;
      DAT_00482714 = 0;
      DAT_00482718 = 0;
      DAT_0048271c = 0;
      DAT_00482720 = 0;
    }
    if (DAT_00487234 == -1) {
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,1.0,(float)unaff_ESI);
      local_4 = local_4 + 40.0;
      DAT_00482724 = DAT_00482724 - frame_dt_ms;
      if (DAT_00482724 < 1) {
        if (DAT_0048271c < 3) {
          if (DAT_0048271c == 0) {
            DAT_00482710 = DAT_00482710 + 2000;
            DAT_00482724 = 0x28;
            sfx_play(sfx_ui_clink_01);
            DAT_00482720 = DAT_00482710;
            if (quest_spawn_timeline <= (int)DAT_00482710) {
              DAT_0048271c = DAT_0048271c + 1;
              DAT_00482710 = quest_spawn_timeline;
              DAT_00482720 = DAT_00482710;
            }
          }
          else if (DAT_0048271c == 1) {
            DAT_00482714 = DAT_00482714 + 1000;
            DAT_00482724 = 0x96;
            sfx_play(sfx_ui_clink_01);
            DAT_00482720 = DAT_00482720 - 1000;
            if (DAT_00482600 <= DAT_00482714) {
              DAT_00482714 = DAT_00482600;
              DAT_0048271c = DAT_0048271c + 1;
            }
          }
          else if (DAT_0048271c == 2) {
            DAT_00482718 = DAT_00482718 + 1;
            DAT_00482724 = 300;
            sfx_play(sfx_ui_clink_01);
            DAT_00482720 = DAT_00482720 - 1000;
            if (perk_pending_count <= DAT_00482718) {
              DAT_00482718 = perk_pending_count;
              DAT_0048271c = DAT_0048271c + 1;
              DAT_00482724 = 1000;
              highscore_active_record.survival_elapsed_ms = DAT_0048270c;
              DAT_00482720 = DAT_0048270c;
            }
          }
        }
        else if (DAT_0048271c == 3) {
          DAT_00482724 = 0x32;
          DAT_00482708 = DAT_00482708 + 1;
        }
      }
      local_10 = 1.0 - (float)DAT_00482708 * 0.1;
      if (0.0 <= local_10) {
        if (1.0 < local_10) {
          local_10 = 1.0;
        }
      }
      else {
        local_10 = 0.0;
      }
      local_8 = local_8 + 32.0;
      local_4 = local_4 + 20.0;
      if (DAT_0048271c == 0) {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3dcccccd,0.8,0.1,local_10,(float)unaff_EBP);
      }
      else {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,local_10 * 0.4,(float)unaff_EBP);
      }
      (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                (grim_interface_ptr,local_4,unaff_retaddr,s_Base_Time__004732f4);
      pIVar2 = grim_interface_ptr->vtable;
      iVar4 = FUN_0040ff50((int)DAT_00482710 / 1000);
      fVar16 = 5.976118e-39;
      (*pIVar2->grim_draw_text_small_fmt)
                (grim_interface_ptr,local_4 + 132.0,unaff_retaddr,&DAT_00471fc4,iVar4);
      if (DAT_0048271c == 1) {
        self = (IGrim2D *)0x3dcccccd;
        h = 0.8;
        a_00 = 0.1;
        a = 5.976203e-39;
        b = local_10;
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3dcccccd,0.8,0.1,local_10,unaff_EBX);
      }
      else {
        b = fVar3 * 0.4;
        self = (IGrim2D *)0x3f800000;
        h = 1.0;
        a_00 = 1.0;
        a = 5.976258e-39;
        (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,b,unaff_EBX);
      }
      if (DAT_0048271c < 1) {
        unaff_EBX = local_8 * 0.2;
        b = 1.0;
        self = (IGrim2D *)0x3f800000;
        h = 1.0;
        a_00 = 5.976329e-39;
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,unaff_EBX,(float)a_01.vtable);
      }
      (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                (grim_interface_ptr,unaff_EBX,(float)a_01.vtable,s_Life_Bonus__004732e8);
      pIVar2 = grim_interface_ptr->vtable;
      iVar4 = FUN_0040ff50(DAT_00482714 / 1000);
      (*pIVar2->grim_draw_text_small_fmt)
                (grim_interface_ptr,unaff_EBX + 132.0,(float)a_01.vtable,&DAT_00471fc4,iVar4);
      if (DAT_0048271c == 2) {
        (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3dcccccd,0.8,0.1,local_10,fVar16)
        ;
      }
      else {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,(float)self * 0.4,fVar16);
      }
      if (DAT_0048271c < 2) {
        (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,b * 0.2,a);
      }
      (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                (grim_interface_ptr,fVar5,local_10,s_Unpicked_Perk_Bonus__004732d0);
      pIVar2 = grim_interface_ptr->vtable;
      iVar4 = FUN_0040ff50(DAT_00482718);
      (*pIVar2->grim_draw_text_small_fmt)
                (grim_interface_ptr,fVar5 + 132.0,local_10,&DAT_00471fc4,iVar4);
      (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,local_10,a_00);
      (*grim_interface_ptr->vtable->grim_draw_rect_outline)
                ((IGrim2D *)&stack0xffffffe8,(float *)0x43280000,1.0,h);
      local_8 = local_8 + 8.0;
      (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                (grim_interface_ptr,fVar3,local_8,s_Final_Time__004732c4);
      pIVar2 = grim_interface_ptr->vtable;
      iVar4 = FUN_0040ff50((int)DAT_00482720 / 1000);
      (*pIVar2->grim_draw_text_small_fmt)
                (grim_interface_ptr,fVar3 + 132.0,local_8,&DAT_00471fc4,iVar4);
      local_8 = local_8 + 20.0;
      (*grim_interface_ptr->vtable->grim_flush_input)(self);
      (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1c,(uint)b);
      if ((DAT_00487234 == -1) &&
         ((iVar4 = (*grim_interface_ptr->vtable->grim_was_key_pressed)
                             ((IGrim2D *)0x39,(uint)unaff_EBX), (char)iVar4 != '\0' ||
          (iVar4 = input_primary_just_pressed(), (char)iVar4 != '\0')))) {
        DAT_00487234 = DAT_00487234 + 1;
        perk_prompt_update_and_render();
        ui_cursor_render();
        return;
      }
      if (10 < DAT_00482708) {
        DAT_00482708 = 0;
        DAT_00487234 = DAT_00487234 + 1;
        perk_prompt_update_and_render();
        ui_cursor_render();
        return;
      }
      goto LAB_00412007;
    }
    if (DAT_00487234 == 0) {
      highscore_load_table();
      DAT_00482620 = highscore_rank_index();
      (*grim_interface_ptr->vtable->grim_flush_input)(unaff_ESI);
      (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1c,(uint)unaff_EBP);
      if (99 < DAT_00482620) {
        DAT_004826ec = 0;
        _DAT_004826f0 = 0;
        _DAT_004826e8 = &DAT_004825dc;
        DAT_00487234 = 2;
        perk_prompt_update_and_render();
        ui_cursor_render();
        return;
      }
      uVar7 = 0xffffffff;
      _DAT_004826f0 = 0x14;
      phVar14 = &highscore_active_record;
      do {
        phVar11 = phVar14;
        if (uVar7 == 0) break;
        uVar7 = uVar7 - 1;
        phVar11 = (highscore_record_t *)(phVar14->player_name + 1);
        pcVar6 = phVar14->player_name;
        phVar14 = phVar11;
      } while (*pcVar6 != '\0');
      uVar7 = ~uVar7;
      _DAT_004826e8 = &DAT_004825dc;
      DAT_00487234 = 1;
      puVar10 = (undefined4 *)((int)phVar11 - uVar7);
      puVar12 = (undefined4 *)&DAT_004825dc;
      for (uVar8 = uVar7 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
        *puVar12 = *puVar10;
        puVar10 = puVar10 + 1;
        puVar12 = puVar12 + 1;
      }
      for (uVar7 = uVar7 & 3; uVar7 != 0; uVar7 = uVar7 - 1) {
        *(undefined1 *)puVar12 = *(undefined1 *)puVar10;
        puVar10 = (undefined4 *)((int)puVar10 + 1);
        puVar12 = (undefined4 *)((int)puVar12 + 1);
      }
      uVar7 = 0xffffffff;
      phVar14 = &highscore_active_record;
      do {
        if (uVar7 == 0) break;
        uVar7 = uVar7 - 1;
        pcVar6 = phVar14->player_name;
        phVar14 = (highscore_record_t *)(phVar14->player_name + 1);
      } while (*pcVar6 != '\0');
      DAT_004826ec = ~uVar7 - 1;
      perk_prompt_update_and_render();
      ui_cursor_render();
      return;
    }
    if (DAT_00487234 == 1) {
      if (DAT_00482708 < 500) {
        DAT_00482708 = DAT_00482708 + frame_dt_ms;
      }
      else {
        DAT_00482708 = 500;
      }
      DAT_00496604 = (float)DAT_00482708 * 0.002;
      local_8 = local_8 + 22.0;
      (*grim_interface_ptr->vtable->grim_set_color_ptr)((IGrim2D *)&DAT_004965f8,(float *)unaff_ESI)
      ;
      (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                (grim_interface_ptr,local_8 + 42.0,local_4,s_State_your_name_trooper__004732a8);
      local_4 = local_4 + 32.0;
      DAT_00496604 = 0.7;
      fVar5 = local_8 + 170.0;
      _DAT_004826f4 = 0xa6;
      _DAT_00482520 = &DAT_0047318c;
      in_stack_00000004 = local_4 - 8.0;
      _DAT_00482530 = fVar16;
      _DAT_004826f8 = fVar16;
      ui_button_update((float *)&stack0x00000000,(ui_button_t *)&DAT_00482520);
      iVar4 = ui_text_input_update(&local_8,(int *)&DAT_004826e8);
      if (((char)iVar4 != '\0') || (DAT_00482525 != '\0')) {
        uVar7 = 0xffffffff;
        iVar4 = 0;
        pcVar6 = &DAT_004825dc;
        do {
          if (uVar7 == 0) break;
          uVar7 = uVar7 - 1;
          cVar1 = *pcVar6;
          pcVar6 = pcVar6 + 1;
        } while (cVar1 != '\0');
        iVar9 = ~uVar7 - 1;
        if (0 < iVar9) {
          if (0 < iVar9) {
            do {
              if ((&DAT_004825dc)[iVar4] != ' ') break;
              iVar4 = iVar4 + 1;
            } while (iVar4 < iVar9);
          }
          if ((&DAT_004825dc)[iVar4] != '\0') {
            DAT_00487234 = 2;
            sfx_play(sfx_ui_typeenter);
            iVar4 = DAT_004826ec;
            uVar7 = 0xffffffff;
            pcVar6 = &DAT_004825dc;
            do {
              pcVar13 = pcVar6;
              if (uVar7 == 0) break;
              uVar7 = uVar7 - 1;
              pcVar13 = pcVar6 + 1;
              cVar1 = *pcVar6;
              pcVar6 = pcVar13;
            } while (cVar1 != '\0');
            uVar7 = ~uVar7;
            player_name_length = DAT_004826ec;
            pcVar6 = pcVar13 + -uVar7;
            phVar14 = &highscore_active_record;
            for (uVar8 = uVar7 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
              *(undefined4 *)phVar14->player_name = *(undefined4 *)pcVar6;
              pcVar6 = pcVar6 + 4;
              phVar14 = (highscore_record_t *)(phVar14->player_name + 4);
            }
            DAT_004826ec = 0;
            _DAT_004826f0 = 0;
            for (uVar7 = uVar7 & 3; uVar7 != 0; uVar7 = uVar7 - 1) {
              phVar14->player_name[0] = *pcVar6;
              pcVar6 = pcVar6 + 1;
              phVar14 = (highscore_record_t *)(phVar14->player_name + 1);
            }
            highscore_active_record.player_name[iVar4] = '\0';
            _DAT_004826e8 = &DAT_004825dc;
            highscore_save_active();
            highscore_load_table();
            goto LAB_00411906;
          }
        }
        DAT_00482525 = '\0';
        sfx_play(sfx_shock_hit_01);
      }
LAB_00411906:
      local_4 = local_4 + 30.0;
      (*grim_interface_ptr->vtable->grim_set_color_ptr)((IGrim2D *)&DAT_004965f8,unaff_EBP);
      in_stack_00000004 = local_4 + 26.0;
      in_stack_00000008 = fVar5 + 16.0;
      ui_text_input_render(&stack0x00000004,6.652423e-39,fVar3);
      perk_prompt_update_and_render();
      ui_cursor_render();
      return;
    }
    if (DAT_00487234 != 2) goto LAB_00412007;
  }
  if (DAT_00482708 < 500) {
    DAT_00482708 = DAT_00482708 + frame_dt_ms;
  }
  else {
    DAT_00482708 = 500;
  }
  fVar16 = (float)DAT_00482708 * 0.002;
  fVar5 = fVar16;
  local_8 = fVar3;
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,fVar16,(float)unaff_ESI);
  if (99 < DAT_00482620) {
    local_4 = local_4 + 6.0;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,local_8 + 8.0,local_4,s_Score_too_low_for_top_d__00473170,100);
    local_4 = local_4 + 6.0;
  }
  fVar3 = local_8;
  in_stack_00000004 = local_4 + 16.0;
  ui_text_input_render(&stack0x00000000,6.652423e-39,fVar16);
  local_4 = local_4 + 78.0 + 6.0;
  if (DAT_00482700 != 0) {
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,0.7,(float)unaff_EBP);
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,local_4,fVar3 + 1.0,s_Weapon_unlocked__00473294);
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.9,unaff_EBX);
    pIVar2 = grim_interface_ptr->vtable;
    pcVar6 = weapon_table_entry((&quest_unlock_weapon_id)
                                [(_quest_stage_minor + -0xb + _quest_stage_major * 10) * 0xb]);
    (*pIVar2->grim_draw_text_small_fmt)
              (grim_interface_ptr,fVar3 + 14.0,in_stack_00000004,&DAT_00471fc4,pcVar6);
    in_stack_00000004 = in_stack_00000004 + 16.0;
  }
  if (DAT_00482704 != perk_id_antiperk) {
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,0.7,(float)a_01.vtable);
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,in_stack_00000004,in_stack_00000008 + 1.0,
               s_Perk_unlocked__00473284);
    in_stack_00000008 = in_stack_00000008 + 14.0;
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.9,fVar5);
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,in_stack_00000008,in_stack_0000000c,&DAT_00471fc4);
    in_stack_0000000c = in_stack_0000000c + 16.0;
  }
  if ((DAT_00482568 & 4) == 0) {
    DAT_00482568 = DAT_00482568 | 4;
    DAT_004825c6 = 1;
    DAT_004825d5 = 0;
    DAT_004825d4 = 0;
    _DAT_004825d0 = 1.0;
    _DAT_004825cc = 0;
    _DAT_004825c0 = (char *)0x0;
    DAT_004825c4 = 0;
    DAT_004825c5 = '\0';
    _DAT_004825c8 = 0;
    crt_atexit(&DAT_00412050);
  }
  _DAT_004825c0 = s_Play_Next_00473278;
  if ((DAT_00482568 & 8) == 0) {
    DAT_00482568 = DAT_00482568 | 8;
    DAT_0048260e = 1;
    DAT_0048261d = 0;
    DAT_0048261c = 0;
    _DAT_00482618 = 1.0;
    _DAT_00482614 = 0;
    _DAT_00482608 = (char *)0x0;
    DAT_0048260c = 0;
    DAT_0048260d = '\0';
    _DAT_00482610 = 0;
    crt_atexit(&DAT_00412040);
  }
  _DAT_00482608 = s_Play_Again_00473164;
  if ((DAT_00482568 & 0x10) == 0) {
    DAT_00482568 = DAT_00482568 | 0x10;
    DAT_0048266e = 1;
    DAT_0048267d = 0;
    DAT_0048267c = 0;
    _DAT_00482678 = 1.0;
    _DAT_00482674 = 0;
    _DAT_00482668 = (char *)0x0;
    DAT_0048266c = 0;
    DAT_0048266d = '\0';
    _DAT_00482670 = 0;
    crt_atexit(&DAT_00412030);
  }
  _DAT_00482668 = s_High_scores_00473158;
  if ((DAT_00482568 & 0x20) == 0) {
    DAT_00482568 = DAT_00482568 | 0x20;
    DAT_004826b6 = 1;
    DAT_004826c5 = 0;
    DAT_004826c4 = 0;
    _DAT_004826c0 = 1.0;
    _DAT_004826bc = 0;
    _DAT_004826b0 = (char *)0x0;
    DAT_004826b4 = 0;
    DAT_004826b5 = '\0';
    _DAT_004826b8 = 0;
    crt_atexit(&DAT_00412020);
  }
  in_stack_00000004 = in_stack_00000004 + 6.0;
  _DAT_004826b0 = s_Main_Menu_00472084;
  if ((_quest_stage_major == 5) && (_quest_stage_minor == 10)) {
    _DAT_004825c0 = s_Show_End_Note_00473268;
  }
  _DAT_00482678 = local_8;
  _DAT_004825d0 = local_8;
  _DAT_00482618 = local_8;
  _DAT_004826c0 = local_8;
  ui_button_update((float *)&stack0x00000000,(ui_button_t *)&DAT_004825c0);
  in_stack_00000004 = in_stack_00000004 + 32.0;
  ui_button_update((float *)&stack0x00000000,(ui_button_t *)&DAT_00482608);
  in_stack_00000004 = in_stack_00000004 + 32.0;
  ui_button_update((float *)&stack0x00000000,(ui_button_t *)&DAT_00482668);
  in_stack_00000004 = in_stack_00000004 + 32.0;
  ui_button_update((float *)&stack0x00000000,(ui_button_t *)&DAT_004826b0);
  in_stack_00000004 = in_stack_00000004 + 32.0;
  if (DAT_004825c5 != '\0') {
    if ((_quest_stage_major == 5) && (_quest_stage_minor == 10)) {
      render_pass_mode = 0;
      game_state_pending = 0x15;
      ui_transition_direction = '\0';
    }
    else {
      sfx_mute_all(music_track_extra_0);
      sfx_mute_all(music_track_crimson_theme_id);
      sfx_mute_all(music_track_shortie_monk_id);
      _quest_stage_minor = _quest_stage_minor + 1;
      ui_transition_direction = '\0';
      game_state_pending = 9;
      render_pass_mode = 0;
    }
  }
  if (DAT_0048260d != '\0') {
    ui_transition_direction = '\0';
    game_state_pending = 9;
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_mute_all(music_track_extra_0);
    render_pass_mode = 0;
  }
  if (DAT_0048266d != '\0') {
    DAT_00487258._0_1_ = config_blob.reserved0[0x18];
    DAT_00487258._1_1_ = config_blob.reserved0[0x19];
    DAT_00487258._2_1_ = config_blob.reserved0[0x1a];
    DAT_00487258._3_1_ = config_blob.reserved0[0x1b];
    DAT_0048724d = '\x01';
    DAT_00487250 = _quest_stage_major;
    DAT_00487254 = _quest_stage_minor;
    DAT_0048725c = config_blob.hardcore;
    ui_transition_direction = '\0';
    game_state_pending = 0xe;
  }
  if (DAT_004826b5 != '\0') {
    sfx_mute_all(music_track_extra_0);
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_play_exclusive(music_track_crimson_theme_id);
    ui_transition_direction = '\0';
    game_state_pending = 0;
    ui_sign_crimson_update_disabled = 0;
  }
LAB_00412007:
  perk_prompt_update_and_render();
  ui_cursor_render();
  return;
}



/* FUN_004120b0 @ 004120b0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_4120b0() */

int FUN_004120b0(void)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  char *pcVar5;
  char *pcVar6;
  highscore_record_t *phVar7;
  
  phVar7 = &highscore_active_record;
  for (iVar2 = 0x12; iVar2 != 0; iVar2 = iVar2 + -1) {
    phVar7->player_name[0] = '\0';
    phVar7->player_name[1] = '\0';
    phVar7->player_name[2] = '\0';
    phVar7->player_name[3] = '\0';
    phVar7 = (highscore_record_t *)(phVar7->player_name + 4);
  }
  uVar3 = 0xffffffff;
  pcVar5 = &default_player_name;
  do {
    pcVar6 = pcVar5;
    if (uVar3 == 0) break;
    uVar3 = uVar3 - 1;
    pcVar6 = pcVar5 + 1;
    cVar1 = *pcVar5;
    pcVar5 = pcVar6;
  } while (cVar1 != '\0');
  uVar3 = ~uVar3;
  pcVar5 = pcVar6 + -uVar3;
  phVar7 = &highscore_active_record;
  for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
    *(undefined4 *)phVar7->player_name = *(undefined4 *)pcVar5;
    pcVar5 = pcVar5 + 4;
    phVar7 = (highscore_record_t *)(phVar7->player_name + 4);
  }
  for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    phVar7->player_name[0] = *pcVar5;
    pcVar5 = pcVar5 + 1;
    phVar7 = (highscore_record_t *)(phVar7->player_name + 1);
  }
  highscore_active_record.flags = '\0';
  highscore_active_record.sentinel_pipe = '|';
  highscore_active_record.sentinel_ff = 0xff;
  uVar3 = crt_rand();
  uVar3 = uVar3 & 0xfee050f;
  highscore_active_record.reserved0[0] = (char)uVar3;
  highscore_active_record.reserved0[1] = (char)(uVar3 >> 8);
  highscore_active_record.reserved0[2] = (char)(uVar3 >> 0x10);
  highscore_active_record.reserved0[3] = (char)(uVar3 >> 0x18);
  _bonus_energizer_timer = 0;
  survival_spawn_stage = 0;
  _DAT_00487028 = 0;
  DAT_00487194 = 0;
  demo_mode_active = 0;
  DAT_00486faa = 0;
  quest_unlock_index = 0;
  creature_active_count = 0;
  DAT_0048718c = 0;
  DAT_00487088 = 0xffffffff;
  _quest_stage_major = 1;
  _quest_stage_minor = 1;
  return 1;
}



/* FUN_00412190 @ 00412190 */

/* [binja] int32_t sub_412190() */

int FUN_00412190(void)

{
  int extraout_EAX;
  
  crt_ehvec_ctor(&quest_selected_meta,0x2c,0x32,&LAB_004121b0,&LAB_004121e0);
  return extraout_EAX;
}



/* FUN_004121f0 @ 004121f0 */

/* [binja] int32_t sub_4121f0() */

int FUN_004121f0(void)

{
  int iVar1;
  
  iVar1 = crt_atexit(&LAB_00412200);
  return iVar1;
}



/* FUN_00412360 @ 00412360 */

/* [binja] int32_t sub_412360() */

int FUN_00412360(void)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  uchar *puVar6;
  char *pcVar7;
  char *pcVar8;
  highscore_record_t *phVar9;
  
  puVar6 = &highscore_table.sentinel_pipe;
  iVar5 = 100;
  do {
    phVar9 = (highscore_record_t *)(puVar6 + -0x46);
    for (iVar2 = 0x12; iVar2 != 0; iVar2 = iVar2 + -1) {
      phVar9->player_name[0] = '\0';
      phVar9->player_name[1] = '\0';
      phVar9->player_name[2] = '\0';
      phVar9->player_name[3] = '\0';
      phVar9 = (highscore_record_t *)(phVar9->player_name + 4);
    }
    uVar3 = 0xffffffff;
    pcVar7 = &default_player_name;
    do {
      pcVar8 = pcVar7;
      if (uVar3 == 0) break;
      uVar3 = uVar3 - 1;
      pcVar8 = pcVar7 + 1;
      cVar1 = *pcVar7;
      pcVar7 = pcVar8;
    } while (cVar1 != '\0');
    uVar3 = ~uVar3;
    pcVar7 = pcVar8 + -uVar3;
    phVar9 = (highscore_record_t *)(puVar6 + -0x46);
    for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
      *(undefined4 *)phVar9->player_name = *(undefined4 *)pcVar7;
      pcVar7 = pcVar7 + 4;
      phVar9 = (highscore_record_t *)(phVar9->player_name + 4);
    }
    for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
      phVar9->player_name[0] = *pcVar7;
      pcVar7 = pcVar7 + 1;
      phVar9 = (highscore_record_t *)(phVar9->player_name + 1);
    }
    puVar6[-2] = '\0';
    *puVar6 = '|';
    puVar6[1] = 0xff;
    uVar3 = crt_rand();
    *(uint *)(puVar6 + -0xe) = uVar3 & 0xfee050f;
    puVar6 = puVar6 + 0x48;
    iVar5 = iVar5 + -1;
    if (iVar5 == 0) {
      return uVar3 & 0xfee050f;
    }
  } while( true );
}



/* FUN_004123d0 @ 004123d0 */

/* [binja] int32_t sub_4123d0() */

int FUN_004123d0(void)

{
  int extraout_EAX;
  
  crt_ehvec_ctor(&bonus_meta_label,0x14,0xf,&LAB_004123f0,FUN_00412410);
  return extraout_EAX;
}



/* FUN_00412410 @ 00412410 */

/* [binja] void* __fastcall sub_412410(int32_t* arg1) */

void * __fastcall FUN_00412410(int *arg1)

{
  void *extraout_EAX;
  void *extraout_EAX_00;
  void *pvVar1;
  
  pvVar1 = (void *)0x0;
  if ((void *)*arg1 != (void *)0x0) {
    crt_free((void *)*arg1);
    pvVar1 = extraout_EAX;
  }
  if ((void *)arg1[1] != (void *)0x0) {
    crt_free((void *)arg1[1]);
    pvVar1 = extraout_EAX_00;
  }
  return pvVar1;
}



/* FUN_00412440 @ 00412440 */

/* [binja] int32_t sub_412440() */

int FUN_00412440(void)

{
  int iVar1;
  
  iVar1 = crt_atexit(&LAB_00412450);
  return iVar1;
}



/* bonus_pick_random_type @ 00412470 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* rolls a bonus id while respecting timers, perks, quest stage, and enabled flags */

uint bonus_pick_random_type(void)

{
  bool bVar1;
  bool bVar2;
  char *pcVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  int local_4;
  
  local_4 = 0;
  bVar2 = false;
  pcVar3 = &bonus_state;
  do {
    if ((*(int *)(pcVar3 + -4) == 0xe) && (*pcVar3 == '\0')) {
      bVar2 = true;
    }
    pcVar3 = pcVar3 + 0x1c;
  } while ((int)pcVar3 < 0x482b0c);
  do {
    iVar4 = crt_rand();
    iVar4 = iVar4 % 0xa2;
    uVar6 = (uint)(iVar4 + 1 < 0xe);
    if ((uVar6 == 0) && (iVar4 + -0xc < 2)) {
      uVar6 = 2;
    }
    iVar4 = iVar4 + -0xd;
    uVar7 = uVar6;
    if (uVar6 == 2) {
      uVar6 = crt_rand();
      if ((uVar6 & 0x3f) != 0) {
        uVar6 = 0;
LAB_004124e2:
        uVar5 = 3;
        do {
          uVar7 = uVar5;
          if (iVar4 < 0xb) break;
          iVar4 = iVar4 + -10;
          uVar5 = uVar5 + 1;
          uVar7 = uVar6;
        } while ((int)uVar5 < 0xf);
      }
    }
    else if (uVar6 == 0) goto LAB_004124e2;
    if ((shock_chain_links_left < 1) || (uVar7 != 7)) {
      if (config_blob.reserved0._24_4_ == 3) {
        if ((((config_blob.hardcore == '\0') || (_quest_stage_major != 3)) &&
            (_quest_stage_major != 2)) || ((_quest_stage_minor != 10 || (uVar7 != 5)))) {
          if ((config_blob.hardcore != '\0') && (_quest_stage_major == 2)) {
            if (_quest_stage_minor == 10) {
joined_r0x00412584:
              if (uVar7 == 0xb) goto LAB_00412613;
            }
            goto LAB_0041258a;
          }
          if (_quest_stage_major == 4) {
            if (_quest_stage_minor != 10) goto LAB_0041258a;
            if (uVar7 != 5) goto joined_r0x00412584;
          }
          else if (((_quest_stage_major != 5) || (_quest_stage_minor != 10)) || (uVar7 != 5))
          goto LAB_0041258a;
        }
      }
      else {
LAB_0041258a:
        if ((((_bonus_freeze_timer <= 0.0) || (uVar7 != 0xb)) &&
            (((((float)player_health._pad0._756_4_ <= 0.0 && (player2_shield_timer <= 0.0)) ||
              (uVar7 != 10)) &&
             ((iVar4 = perk_count_get(perk_id_my_favourite_weapon), iVar4 == 0 || (uVar7 != 3))))))
           && (((iVar4 = perk_count_get(perk_id_death_clock), iVar4 == 0 || (uVar7 != 0xc)) &&
               (((uVar7 != 3 || (!bVar2)) && ((&bonus_meta_enabled)[uVar7 * 0x14] != '\0')))))) {
          return uVar7;
        }
      }
    }
LAB_00412613:
    bVar1 = 99 < local_4;
    local_4 = local_4 + 1;
    if (bVar1) {
      return 1;
    }
  } while( true );
}



/* bonus_metadata_init @ 00412660 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* builds bonus metadata table (labels, descriptions, durations) */

void bonus_metadata_init(void)

{
  uint3 extraout_ECX;
  uint3 extraout_ECX_00;
  uint3 extraout_ECX_01;
  uint3 extraout_ECX_02;
  uint3 extraout_ECX_03;
  uint3 extraout_ECX_04;
  uint3 extraout_ECX_05;
  uint3 extraout_ECX_06;
  uint3 extraout_ECX_07;
  uint3 extraout_ECX_08;
  uint3 extraout_ECX_09;
  uint3 extraout_ECX_10;
  uint3 extraout_ECX_11;
  uint3 extraout_ECX_12;
  
  DAT_004853e4 = strdup_malloc(s_Points_00473604);
  _DAT_004853e8 = FUN_0042fd00(extraout_ECX,s_You_gain_some_experience_points__004735e0,0x100);
  _DAT_004853ec = 0xc;
  _DAT_004853f4 = 500;
  DAT_004853f0 = 1;
  _DAT_0048540c = strdup_malloc(s_Weapon_004735d8);
  _DAT_00485410 = FUN_0042fd00(extraout_ECX_00,s_You_get_a_new_weapon__004735c0,0x100);
  _DAT_00485414 = 0xffffffff;
  _DAT_0048541c = 3;
  _DAT_00485434 = strdup_malloc(&DAT_004735b8);
  _DAT_00485438 = FUN_0042fd00(extraout_ECX_01,s_An_amazing_explosion_of_ATOMIC_p_00473590,0x100);
  _DAT_0048543c = 1;
  DAT_00485448 = strdup_malloc(s_Double_Experience_0047357c);
  _DAT_0048544c = FUN_0042fd00(extraout_ECX_02,s_Every_experience_point_you_get_i_00473534,0x100);
  DAT_00485450 = 4;
  _DAT_00485470 = strdup_malloc(s_Fireblast_00473528);
  _DAT_00485474 = FUN_0042fd00(extraout_ECX_03,s_Fireballs_all_over_the_place__00473508,0x100);
  _DAT_00485478 = 2;
  _DAT_0048545c = strdup_malloc(s_Shock_Chain_004734fc);
  _DAT_00485460 = FUN_0042fd00(extraout_ECX_04,s_Chain_of_shocks_shock_the_crowd__004734d8,0x100);
  _DAT_00485464 = 3;
  DAT_00485484 = strdup_malloc(s_Reflex_Boost_004734c8);
  _DAT_00485488 = FUN_0042fd00(extraout_ECX_05,s_You_get_more_time_to_react_as_th_00473494,0x100);
  DAT_0048548c = 5;
  _DAT_00485494 = 3;
  DAT_00485498 = strdup_malloc(s_Shield_0047348c);
  _DAT_0048549c = FUN_0042fd00(extraout_ECX_06,s_Force_field_protects_you_for_a_w_00473464,0x100);
  DAT_004854a0 = 6;
  _DAT_004854a8 = 7;
  DAT_004854ac = strdup_malloc(s_Freeze_0047345c);
  _DAT_004854b0 = FUN_0042fd00(extraout_ECX_07,s_Monsters_are_frozen__00473444,0x100);
  DAT_004854b4 = 8;
  _DAT_004854bc = 5;
  DAT_004854d4 = strdup_malloc(s_Speed_0047343c);
  _DAT_004854d8 = FUN_0042fd00(extraout_ECX_08,s_Your_movement_speed_increases_fo_00473410,0x100);
  DAT_004854dc = 9;
  _DAT_004854e4 = 8;
  DAT_004853f8 = strdup_malloc(s_Energizer_00473404);
  _DAT_004853fc = FUN_0042fd00(extraout_ECX_09,s_Suddenly_monsters_run_away_from_y_004733c8,0x100);
  DAT_00485400 = 10;
  _DAT_00485408 = 8;
  DAT_00485420 = strdup_malloc(s_Weapon_Power_Up_004733b8);
  _DAT_00485424 = FUN_0042fd00(extraout_ECX_10,s_Your_firerate_and_load_time_incr_0047337c,0x100);
  DAT_00485428 = 7;
  _DAT_00485430 = 10;
  DAT_004854e8 = strdup_malloc(s_Fire_Bullets_0047336c);
  _DAT_004854ec = FUN_0042fd00(extraout_ECX_11,s_For_few_seconds____make_them_cou_00473348,0x100);
  DAT_004854f0 = 0xb;
  _DAT_004854f8 = 4;
  _DAT_004854c0 = strdup_malloc(s_MediKit_00473340);
  _DAT_004854c4 =
       FUN_0042fd00(extraout_ECX_12,s__You_regain_some_of_your_health__0047331b + 1,0x100);
  _DAT_004854d0 = 10;
  _DAT_004854c8 = 0xe;
  return;
}



/* FUN_00412940 @ 00412940 */

/* [binja] char* sub_412940() */

char * FUN_00412940(void)

{
  char *pcVar1;
  
  pcVar1 = &bonus_meta_enabled;
  do {
    *pcVar1 = '\x01';
    pcVar1 = pcVar1 + 0x14;
  } while ((int)pcVar1 < 0x485508);
  bonus_meta_enabled = 0;
  return pcVar1;
}



/* game_mode_label @ 00412960 */

/* returns a display label for the current game mode */

char * game_mode_label(void)

{
  char cVar1;
  uint uVar2;
  uint uVar3;
  char *pcVar4;
  char *pcVar5;
  
  if (config_blob.reserved0._24_4_ == 2) {
    pcVar4 = &DAT_00473614;
  }
  else {
    if (config_blob.reserved0._24_4_ == 1) {
      uVar2 = 0xffffffff;
      pcVar4 = s_Survival_004720ac;
      do {
        pcVar5 = pcVar4;
        if (uVar2 == 0) break;
        uVar2 = uVar2 - 1;
        pcVar5 = pcVar4 + 1;
        cVar1 = *pcVar4;
        pcVar4 = pcVar5;
      } while (cVar1 != '\0');
      uVar2 = ~uVar2;
      pcVar4 = pcVar5 + -uVar2;
      pcVar5 = (char *)&DAT_004854fc;
      for (uVar3 = uVar2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
        *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
        pcVar4 = pcVar4 + 4;
        pcVar5 = pcVar5 + 4;
      }
      for (uVar2 = uVar2 & 3; uVar2 != 0; uVar2 = uVar2 - 1) {
        *pcVar5 = *pcVar4;
        pcVar4 = pcVar4 + 1;
        pcVar5 = pcVar5 + 1;
      }
      return (char *)&DAT_004854fc;
    }
    if (config_blob.reserved0._24_4_ == 3) {
      pcVar4 = s_Quests_0047360c;
    }
    else {
      if (config_blob.reserved0._24_4_ == 4) {
        uVar2 = 0xffffffff;
        pcVar4 = s_Typ_o_Shooter_00472090;
        do {
          pcVar5 = pcVar4;
          if (uVar2 == 0) break;
          uVar2 = uVar2 - 1;
          pcVar5 = pcVar4 + 1;
          cVar1 = *pcVar4;
          pcVar4 = pcVar5;
        } while (cVar1 != '\0');
        uVar2 = ~uVar2;
        pcVar4 = pcVar5 + -uVar2;
        pcVar5 = (char *)&DAT_004854fc;
        for (uVar3 = uVar2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
          *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
          pcVar4 = pcVar4 + 4;
          pcVar5 = pcVar5 + 4;
        }
        for (uVar2 = uVar2 & 3; uVar2 != 0; uVar2 = uVar2 - 1) {
          *pcVar5 = *pcVar4;
          pcVar4 = pcVar4 + 1;
          pcVar5 = pcVar5 + 1;
        }
        return (char *)&DAT_004854fc;
      }
      pcVar4 = s_Unknown_004714a0;
    }
  }
  uVar2 = 0xffffffff;
  do {
    pcVar5 = pcVar4;
    if (uVar2 == 0) break;
    uVar2 = uVar2 - 1;
    pcVar5 = pcVar4 + 1;
    cVar1 = *pcVar4;
    pcVar4 = pcVar5;
  } while (cVar1 != '\0');
  uVar2 = ~uVar2;
  pcVar4 = pcVar5 + -uVar2;
  pcVar5 = (char *)&DAT_004854fc;
  for (uVar3 = uVar2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
    pcVar4 = pcVar4 + 4;
    pcVar5 = pcVar5 + 4;
  }
  for (uVar2 = uVar2 & 3; uVar2 != 0; uVar2 = uVar2 - 1) {
    *pcVar5 = *pcVar4;
    pcVar4 = pcVar4 + 1;
    pcVar5 = pcVar5 + 1;
  }
  return (char *)&DAT_004854fc;
}



/* game_sequence_load @ 00412a10 */

/* reads the sequence value from registry */

void game_sequence_load(void)

{
  LONG LVar1;
  HKEY local_8;
  uint local_4;
  
  LVar1 = RegCreateKeyExA((HKEY)0x80000002,(LPCSTR)&DAT_004852d0,0,(LPSTR)0x0,0,0xf003f,
                          (LPSECURITY_ATTRIBUTES)0x0,(PHKEY)&local_8,(LPDWORD)0x0);
  if (LVar1 == 0) {
    reg_read_dword_default(local_8,s_sequence_0047361c,&local_4,0);
    if (game_status_blob.game_sequence_id < local_4) {
      game_status_blob.game_sequence_id = local_4;
    }
    RegCloseKey((HKEY)local_8);
  }
  return;
}



/* game_save_status @ 00412a80 */

/* writes registry state and saves status file */

void game_save_status(void)

{
  char cVar1;
  LONG LVar2;
  char *path;
  FILE *fp;
  char cVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  char *mode;
  HKEY local_8;
  int local_4;
  
  LVar2 = RegCreateKeyExA((HKEY)0x80000002,(LPCSTR)&DAT_004852d0,0,(LPSTR)0x0,0,0xf003f,
                          (LPSECURITY_ATTRIBUTES)0x0,(PHKEY)&local_8,(LPDWORD)0x0);
  uVar6 = game_status_blob.game_sequence_id;
  if (LVar2 == 0) {
    reg_write_dword(local_8,s_sequence_0047361c,game_status_blob.game_sequence_id);
    reg_write_dword(local_8,s_dataPathId_0047367c,uVar6 * 0xd + 3 >> 1);
    reg_write_dword(local_8,s_transferFailed_0047366c,0);
    RegCloseKey((HKEY)local_8);
  }
  mode = &file_mode_write_binary;
  path = game_build_path(game_status_filename);
  fp = crt_fopen(path,mode);
  if (fp != (FILE *)0x0) {
    game_status_blob.quest_unlock_index = (ushort)quest_unlock_index;
    local_4 = 0;
    iVar4 = 0;
    game_status_blob.quest_unlock_index_full = (ushort)quest_unlock_index_full;
    uVar6 = 0;
    do {
      cVar1 = *(char *)((int)game_status_blob.weapon_usage_counts + iVar4 + -4);
      iVar5 = (cVar1 * 7 + iVar4) * (int)cVar1 + uVar6;
      cVar3 = (char)iVar4;
      uVar6 = uVar6 + 0x6f;
      local_4 = local_4 + 0xd + iVar5;
      *(char *)((int)game_status_blob.weapon_usage_counts + iVar4 + -4) =
           ((cVar3 * '\a' + '\x0f') * cVar3 + '\x03') * cVar3 + cVar1 + 'o';
      iVar4 = iVar4 + 1;
    } while (uVar6 < 0x10b18);
    crt_fwrite(&game_status_blob,0x268,1,fp);
    crt_fwrite(&local_4,4,1,fp);
    crt_fclose(fp);
    if (*(float *)((int)cv_verbose + 0xc) != 0.0) {
      console_printf(&console_log_queue,s_GAME_SaveStatus_OK__00473644);
    }
    game_load_status();
    game_sequence_load();
    game_sequence_load();
    return;
  }
  console_printf(&console_log_queue,s_GAME_SaveStatus_FAILED__00473628);
  game_sequence_load();
  return;
}



/* game_load_status @ 00412c10 */

/* loads status file; regenerates on failure */

void game_load_status(void)

{
  char cVar1;
  char *path;
  FILE *fp;
  long lVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  char *mode;
  int local_4;
  
  mode = &file_mode_read_binary;
  path = game_build_path(game_status_filename);
  fp = crt_fopen(path,mode);
  uVar5 = 0;
  if (fp == (FILE *)0x0) {
    console_printf(&console_log_queue,s_GAME_LoadStatus_FAILED__004736a0);
    console_printf(&console_log_queue,s_Generating_new_file___00473688);
    game_status_blob.quest_unlock_index = 0;
    game_status_blob.quest_unlock_index_full = 0;
    game_sequence_load();
    game_save_status();
    game_sequence_load();
  }
  else {
    crt_fseek(fp,0,2);
    lVar2 = crt_ftell(fp);
    if (lVar2 != 0x26c) {
      crt_fclose(fp);
      console_printf(&console_log_queue,s_GAME_LoadStatus_FAILED__invalid_f_00473700);
      game_sequence_load();
      return;
    }
    crt_fseek(fp,0,0);
    crt_fread(&game_status_blob,0x268,1,fp);
    local_4 = 0;
    crt_fread(&local_4,4,1,fp);
    iVar6 = 0;
    iVar3 = 0;
    do {
      cVar1 = (char)iVar3;
      cVar1 = *(char *)((int)game_status_blob.weapon_usage_counts + iVar3 + -4) +
              (-0x6f - ((cVar1 * '\a' + '\x0f') * cVar1 + '\x03') * cVar1);
      *(char *)((int)game_status_blob.weapon_usage_counts + iVar3 + -4) = cVar1;
      iVar4 = (cVar1 * 7 + iVar3) * (int)cVar1 + uVar5;
      uVar5 = uVar5 + 0x6f;
      iVar3 = iVar3 + 1;
      iVar6 = iVar6 + 0xd + iVar4;
    } while (uVar5 < 0x10b18);
    if (iVar6 != local_4) {
      crt_fclose(fp);
      console_printf(&console_log_queue,s_GAME_LoadStatus_FAILED__check_su_004736d4);
      game_sequence_load();
      return;
    }
    quest_unlock_index_full = (uint)game_status_blob._0_4_ >> 0x10;
    quest_unlock_index = game_status_blob._0_4_ & 0xffff;
    crt_fclose(fp);
    if (*(float *)((int)cv_verbose + 0xc) != 0.0) {
      console_printf(&console_log_queue,s_GAME_LoadStatus_OK__004736bc);
      return;
    }
  }
  return;
}



/* gameplay_reset_state @ 00412dc0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* resets gameplay/session globals, pools, and availability tables */

void gameplay_reset_state(void)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  uint uVar3;
  uchar *puVar4;
  projectile_t *ppVar5;
  sprite_effect_t *psVar6;
  secondary_projectile_t *psVar7;
  int iVar8;
  int iVar9;
  char *unaff_EBX;
  char *unaff_ESI;
  int *piVar10;
  int *piVar11;
  char *unaff_EDI;
  char *unaff_retaddr;
  undefined4 uStack00000004;
  float fStack00000010;
  float fStack00000014;
  char *in_stack_fffffff8;
  char *in_stack_fffffffc;
  
  puVar2 = &bonus_hud_slot_y;
  DAT_0048727c = 0;
  do {
    puVar2[6] = 0x40a00000;
    *(undefined1 *)(puVar2 + -1) = 0;
    *puVar2 = 0;
    puVar2[5] = 1;
    puVar2[4] = s_Empty_00473764;
    puVar2[1] = 0x3f800000;
    puVar2 = puVar2 + 8;
  } while ((int)puVar2 < 0x48f78c);
  quest_spawn_timeline = 0;
  shock_chain_links_left = 0;
  DAT_00486fb8 = 1;
  creature_spawned_count = 0;
  survival_recent_death_count = 0;
  survival_reward_damage_seen = 0;
  survival_reward_fire_seen = 0;
  DAT_00486fa9 = 1;
  survival_reward_handout_enabled = 1;
  tutorial_stage_index = 0xffffffff;
  tutorial_stage_timer = 0;
  tutorial_stage_transition_timer = 0xfffffc18;
  DAT_00487088 = 0xffffffff;
  _bonus_double_xp_timer = 0;
  survival_spawn_stage = 0;
  camera_shake_pulses = 0;
  FUN_00412940();
  _DAT_00482940 = 6;
  _creature_type_texture =
       (*grim_interface_ptr->vtable->grim_get_texture_handle)
                 ((IGrim2D *)s_zombie_0047375c,unaff_EDI);
  _creature_type_sfx_b0 = sfx_zombie_attack_01;
  _creature_type_sfx_b1 = sfx_zombie_attack_02;
  _creature_type_sfx_a0 = sfx_zombie_die_01;
  _creature_type_sfx_a1 = sfx_zombie_die_02;
  _DAT_00482748 = 0x3f800000;
  _creature_type_anim_rate = 0x3f99999a;
  _creature_type_sfx_a2 = sfx_zombie_die_03;
  _creature_type_sfx_a3 = sfx_zombie_die_04;
  _creature_type_base_frame = 0x20;
  _creature_type_corpse_frame = 0;
  _DAT_0048276c =
       (*grim_interface_ptr->vtable->grim_get_texture_handle)
                 ((IGrim2D *)s_lizard_00473754,unaff_ESI);
  _DAT_00482784 = sfx_lizard_attack_02;
  _DAT_00482780 = sfx_lizard_attack_01;
  _DAT_00482770 = sfx_lizard_die_01;
  _DAT_00482778 = sfx_lizard_die_03;
  _DAT_0048278c = 0x3f800000;
  _DAT_004827a0 = 0x3fcccccd;
  _DAT_00482774 = sfx_lizard_die_02;
  _DAT_0048277c = sfx_lizard_die_04;
  _DAT_004827ac = 1;
  _DAT_004827a4 = 0x10;
  _DAT_004827a8 = 3;
  _DAT_004827f4 =
       (*grim_interface_ptr->vtable->grim_get_texture_handle)
                 ((IGrim2D *)s_spider_sp1_00473748,unaff_EBX);
  _DAT_00482808 = sfx_spider_attack_01;
  _DAT_0048280c = sfx_spider_attack_02;
  _DAT_00482814 = 0x3f800000;
  _DAT_00482828 = 0x3fc00000;
  _DAT_004827f8 = sfx_spider_die_01;
  _DAT_004827fc = sfx_spider_die_02;
  _DAT_00482800 = sfx_spider_die_03;
  _DAT_00482804 = sfx_spider_die_04;
  _DAT_00482834 = 1;
  _DAT_0048282c = 0x10;
  _DAT_00482830 = 1;
  _DAT_00482838 =
       (*grim_interface_ptr->vtable->grim_get_texture_handle)
                 ((IGrim2D *)s_spider_sp2_0047373c,in_stack_fffffff8);
  _DAT_00482850 = sfx_spider_attack_02;
  _DAT_0048284c = sfx_spider_attack_01;
  _DAT_0048283c = sfx_spider_die_01;
  _DAT_00482844 = sfx_spider_die_03;
  _DAT_00482858 = 0x3f800000;
  _DAT_0048286c = 0x3fc00000;
  _DAT_00482840 = sfx_spider_die_02;
  _DAT_00482848 = sfx_spider_die_04;
  _DAT_00482878 = 1;
  _DAT_00482870 = 0x10;
  _DAT_00482874 = 2;
  DAT_004827b0 = (*grim_interface_ptr->vtable->grim_get_texture_handle)
                           ((IGrim2D *)s_alien_00473734,in_stack_fffffffc);
  _DAT_004827c4 = sfx_alien_attack_01;
  _DAT_004827c8 = sfx_alien_attack_02;
  _DAT_004827b4 = sfx_alien_die_01;
  _DAT_004827b8 = sfx_alien_die_02;
  _DAT_004827bc = sfx_alien_die_03;
  _DAT_004827c0 = sfx_alien_die_04;
  _DAT_00482880 = sfx_trooper_die_01;
  _DAT_004827d0 = 0x3f800000;
  _DAT_004827e4 = 0x3faccccd;
  _DAT_004827f0 = 0;
  _DAT_004827e8 = 0x20;
  _DAT_004827ec = 4;
  _DAT_00482884 = sfx_trooper_die_02;
  _DAT_00482888 = sfx_trooper_die_03;
  _DAT_004828b8 = 7;
  DAT_0048287c = (*grim_interface_ptr->vtable->grim_get_texture_handle)
                           ((IGrim2D *)s_trooper_0047372c,unaff_retaddr);
  _camera_offset_x = (float)terrain_texture_width * 0.5;
  perk_choices_dirty = 1;
  bonus_spawn_guard = 0;
  puVar2 = &DAT_0048708c;
  for (iVar9 = 0x40; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  _camera_offset_y = (float)terrain_texture_height * 0.5;
  fStack00000010 = _camera_offset_x;
  fStack00000014 = _camera_offset_y;
  weapon_table_init();
  weapon_refresh_available();
  perks_rebuild_available();
  effect_defaults_reset();
  perk_pending_count = 0;
  survival_spawn_cooldown = 0;
  creatures_any_active_flag = 0;
  time_scale_active = 0;
  _time_scale_factor = 0x3f800000;
  _bonus_reflex_boost_timer = 0;
  _bonus_weapon_power_up_timer = 0;
  _bonus_energizer_timer = 0;
  plaguebearer_infection_count = 0;
  DAT_00487268 = 0xffffffff;
  highscore_active_record.full_version_marker = '\0';
  highscore_active_record.survival_elapsed_ms = 0;
  highscore_active_record.score_xp = 0;
  highscore_active_record.quest_stage_minor = '\0';
  highscore_active_record.quest_stage_major = '\0';
  highscore_active_record.game_mode_id = '\0';
  highscore_active_record.most_used_weapon_id = '\0';
  highscore_active_record.creature_kill_count = 0;
  highscore_active_record.shots_hit = 0;
  highscore_active_record.shots_fired = 0;
  highscore_active_record.date_checksum = '\0';
  highscore_active_record.year_offset = '\0';
  highscore_active_record.month = '\0';
  highscore_active_record.day = '\0';
  highscore_active_record.flags = '\0';
  uVar3 = crt_rand();
  highscore_active_record.reserved0._0_4_ = uVar3 & 0xfee050f;
  _DAT_004aaf24 = 0;
  _bonus_freeze_timer = 0;
  _DAT_004aaf1c = 0;
  _DAT_004aaf2c = 0xbf800000;
  perk_prompt_timer = 0;
  projectile_reset_pools();
  FUN_0041fc80();
  fStack00000010 = -1.0;
  DAT_004871d0 = 0;
  fStack00000014 = -1.0;
  DAT_004871d4 = 0;
  puVar4 = player_health._pad0 + 0x2ec;
  do {
    puVar4[0x14] = '\0';
    puVar4[0x15] = '\0';
    puVar4[0x16] = 0x80;
    puVar4[0x17] = 0xbf;
    puVar4[0x18] = '\0';
    puVar4[0x19] = '\0';
    puVar4[0x1a] = 0x80;
    puVar4[0x1b] = 0xbf;
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = 200;
    puVar4[3] = 'B';
    puVar4[0xc] = '\0';
    puVar4[0xd] = '\0';
    puVar4[0xe] = '\0';
    puVar4[0xf] = '\0';
    puVar4 = puVar4 + 0x360;
  } while ((int)puVar4 < 0x491280);
  puVar2 = &bonus_pool;
  do {
    *puVar2 = 0;
    puVar2 = puVar2 + 7;
  } while ((int)puVar2 < 0x482b08);
  ppVar5 = &projectile_pool;
  do {
    ppVar5->active = '\0';
    ppVar5 = ppVar5 + 1;
  } while ((int)ppVar5 < 0x493eb8);
  psVar6 = &sprite_effect_pool;
  do {
    *(undefined1 *)&psVar6->active = 0;
    psVar6 = psVar6 + 1;
  } while ((int)psVar6 < 0x49aa20);
  psVar7 = &secondary_projectile_pool;
  do {
    psVar7->active = '\0';
    psVar7 = (secondary_projectile_t *)&psVar7[1].angle;
  } while ((int)psVar7 < 0x4965d8);
  iVar9 = 0;
  piVar10 = &creature_pool.target_player;
  do {
    uVar1 = config_blob.reserved0._20_4_;
    piVar10[-0xe] = 0;
    ((creature_t *)(piVar10 + -0x1c))->active = '\0';
    if (uVar1 == 0) {
      *(undefined1 *)piVar10 = 0;
    }
    else {
      *(char *)piVar10 = (char)(iVar9 % (int)uVar1);
    }
    *(uchar *)(piVar10 + -0x1a) = '\x01';
    piVar10[7] = 0;
    iVar8 = crt_rand();
    piVar11 = piVar10 + 0x26;
    fStack00000010 = (float)(iVar8 % 0x1f);
    iVar9 = iVar9 + 1;
    piVar10[9] = (int)(float)(int)fStack00000010;
    piVar10 = piVar11;
  } while ((int)piVar11 < 0x4aa3a8);
  puVar2 = &creature_spawn_slot_owner;
  do {
    *puVar2 = 0;
    puVar2 = puVar2 + 6;
  } while ((int)puVar2 < 0x4852d0);
  fx_queue_rotated = 0;
  fx_queue_count = 0;
  highscore_active_record.full_version_marker = '\0';
  highscore_active_record.survival_elapsed_ms = 0;
  highscore_active_record.score_xp = 0;
  highscore_active_record.quest_stage_minor = '\0';
  highscore_active_record.quest_stage_major = '\0';
  highscore_active_record.game_mode_id = '\0';
  highscore_active_record.most_used_weapon_id = '\0';
  highscore_active_record.creature_kill_count = 0;
  highscore_active_record.shots_hit = 0;
  highscore_active_record.shots_fired = 0;
  highscore_active_record.date_checksum = '\0';
  highscore_active_record.year_offset = '\0';
  highscore_active_record.month = '\0';
  highscore_active_record.day = '\0';
  highscore_active_record.flags = '\0';
  uStack00000004 = 0x413412;
  uVar3 = crt_rand();
  highscore_active_record.reserved0._0_4_ = uVar3 & 0xfee050f;
  uStack00000004 = 0x413421;
  terrain_generate_random();
  return;
}



/* player_start_reload @ 00413430 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* starts reload for the active player, sets timers, and plays SFX */

void player_start_reload(void)

{
  float fVar1;
  int iVar2;
  int iVar3;
  
  if (((&player_health)[render_overlay_player_index]._pad0[0x2a4] == '\0') ||
     ((iVar3 = perk_count_get(perk_id_ammunition_within), iVar3 == 0 &&
      (iVar3 = perk_count_get(perk_id_regression_bullets), iVar3 == 0)))) {
    iVar3 = render_overlay_player_index;
    if ((&player_health)[render_overlay_player_index]._pad0[0x2a4] == '\0') {
      sfx_play_panned((float)(&weapon_table)
                             [*(int *)((&player_health)[render_overlay_player_index]._pad0 + 0x29c)]
                             .reload_sfx_id);
      iVar3 = render_overlay_player_index;
      (&player_health)[render_overlay_player_index]._pad0[0x2a4] = '\x01';
    }
    iVar2 = perk_id_fastloader;
    fVar1 = (&weapon_table)[*(int *)((&player_health)[iVar3]._pad0 + 0x29c)].reload_time;
    *(float *)((&player_health)[iVar3]._pad0 + 0x2ac) = fVar1;
    if (0 < *(int *)(player_health._pad0 + iVar2 * 4 + 0x94)) {
      *(float *)((&player_health)[iVar3]._pad0 + 0x2ac) = fVar1 * 0.7;
    }
    if (0.0 < _bonus_weapon_power_up_timer) {
      *(float *)((&player_health)[iVar3]._pad0 + 0x2ac) =
           *(float *)((&player_health)[iVar3]._pad0 + 0x2ac) * 0.6;
    }
    *(undefined4 *)((&player_health)[iVar3]._pad0 + 0x2b4) =
         *(undefined4 *)((&player_health)[iVar3]._pad0 + 0x2ac);
  }
  return;
}



/* FUN_00413540 @ 00413540 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl FUN_00413540(float param_1)

{
  float fVar1;
  int iVar2;
  float fVar3;
  float fVar4;
  
  iVar2 = render_overlay_player_index;
  fVar1 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 8);
  while (fVar1 < 0.0) {
    fVar1 = *(float *)((&player_health)[iVar2]._pad0 + 8) + 6.2831855;
    *(float *)((&player_health)[iVar2]._pad0 + 8) = fVar1;
  }
  fVar1 = *(float *)((&player_health)[iVar2]._pad0 + 8);
  while (6.2831855 < fVar1) {
    fVar1 = *(float *)((&player_health)[iVar2]._pad0 + 8) - 6.2831855;
    *(float *)((&player_health)[iVar2]._pad0 + 8) = fVar1;
  }
  fVar3 = ABS(param_1 - *(float *)((&player_health)[iVar2]._pad0 + 8));
  fVar1 = *(float *)((&player_health)[iVar2]._pad0 + 8);
  if (*(float *)((&player_health)[iVar2]._pad0 + 8) < param_1) {
    fVar1 = param_1;
  }
  fVar4 = *(float *)((&player_health)[iVar2]._pad0 + 8);
  if (param_1 < *(float *)((&player_health)[iVar2]._pad0 + 8)) {
    fVar4 = param_1;
  }
  fVar4 = ABS((6.2831855 - fVar1) + fVar4);
  fVar1 = fVar4;
  if (fVar3 < fVar4) {
    fVar1 = fVar3;
  }
  if (fVar3 <= fVar4) {
    if (*(float *)((&player_health)[iVar2]._pad0 + 8) < param_1) {
      _DAT_00487198 = frame_dt * fVar1 * 5.0;
      goto LAB_00413686;
    }
  }
  else if (param_1 < *(float *)((&player_health)[iVar2]._pad0 + 8)) {
    _DAT_00487198 = frame_dt * fVar1 * 5.0;
    goto LAB_00413686;
  }
  _DAT_00487198 = frame_dt * fVar1 * -5.0;
LAB_00413686:
  *(float *)((&player_health)[iVar2]._pad0 + 8) =
       _DAT_00487198 + *(float *)((&player_health)[iVar2]._pad0 + 8);
  return;
}



/* player_update @ 004136b0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* per-player gameplay update: movement, firing, status timers, and effects */

void player_update(void)

{
  IGrim2D *pos;
  undefined4 uVar1;
  float fVar2;
  uchar uVar3;
  float fVar4;
  IGrim2D IVar5;
  bool bVar6;
  player_state_t *ppVar7;
  int iVar8;
  bool bVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  float *pfVar13;
  creature_t *pcVar14;
  IGrim2D_vtbl *pIVar15;
  uchar *unaff_EBP;
  IGrim2D *unaff_EDI;
  int iVar16;
  float10 fVar17;
  float10 fVar18;
  float10 extraout_ST0;
  float10 extraout_ST0_00;
  float10 extraout_ST0_01;
  float10 extraout_ST0_02;
  longlong lVar19;
  IGrim2D *in_stack_ffffff90;
  float in_stack_ffffff94;
  IGrim2D *in_stack_ffffff98;
  float *in_stack_ffffff9c;
  int type_id;
  int iVar20;
  uchar *puVar21;
  IGrim2D *pIVar22;
  IGrim2D *delta;
  float fVar23;
  undefined4 local_44;
  float local_40;
  int local_3c;
  float local_38;
  uchar *local_34;
  float *local_30;
  float *pfStack_2c;
  float local_28;
  float local_24;
  IGrim2D_vtbl *local_20;
  float *local_1c;
  IGrim2D local_18;
  float *local_14;
  IGrim2D local_10;
  IGrim2D local_c;
  float fStack_8;
  float fStack_4;
  
  iVar8 = render_overlay_player_index;
  if (console_open_flag != '\0') {
    return;
  }
  (&DAT_004871f4)[render_overlay_player_index * 2] = ui_mouse_x;
  (&DAT_004871f8)[iVar8 * 2] = ui_mouse_y;
  iVar16 = iVar8 * 0x360;
  local_28 = (float)(&player_pos_x)[iVar8 * 0xd8];
  pos = (IGrim2D *)(&player_pos_x + iVar8 * 0xd8);
  local_24 = (float)(&player_pos_y)[iVar8 * 0xd8];
  if (*(float *)(&player_health)[iVar8]._pad0 <= 0.0) {
    (&player_death_timer)[iVar8 * 0xd8] =
         (float)(&player_death_timer)[iVar8 * 0xd8] - frame_dt * 20.0;
    return;
  }
  if (0.0 < *(float *)((&player_health)[iVar8]._pad0 + 0x2f0)) {
    *(float *)((&player_health)[iVar8]._pad0 + 0x38) =
         *(float *)((&player_health)[iVar8]._pad0 + 0x38) + 1.0;
  }
  if (((*(int *)((&player_health)[iVar8]._pad0 + 0x2ec) != 0x42c80000) &&
      (*(float *)(&player_health)[iVar8]._pad0 < 20.0)) &&
     (fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x2ec) - frame_dt,
     *(float *)((&player_health)[iVar8]._pad0 + 0x2ec) = fVar23, fVar23 < 0.0)) {
    fVar17 = (float10)fcos(((float10)*(float *)((&player_health)[iVar8]._pad0 + 0x2dc) +
                           (float10)1.5707964) - (float10)0.5);
    fVar18 = (float10)fsin(((float10)*(float *)((&player_health)[iVar8]._pad0 + 0x2dc) +
                           (float10)1.5707964) - (float10)0.5);
    fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x2dc);
    local_18.vtable = (IGrim2D_vtbl *)(float)(fVar17 * (float10)-6.0 + (float10)(float)pos->vtable);
    local_14 = (float *)((float)(fVar18 * (float10)-6.0) + (float)(&player_pos_y)[iVar8 * 0xd8]);
    effect_spawn_blood_splatter((float *)&local_18,fVar23,0.0);
    in_stack_ffffff90 = &local_18;
    in_stack_ffffff94 = fVar23;
    effect_spawn_blood_splatter((float *)in_stack_ffffff90,fVar23,0.0);
    effect_spawn_blood_splatter((float *)&local_18,fVar23,0.0);
    uVar10 = crt_rand();
    in_stack_ffffff9c = (float *)((uVar10 & 1) + sfx_bloodspill_01);
    in_stack_ffffff98 = (IGrim2D *)0x41382d;
    sfx_play_panned((float)in_stack_ffffff9c);
    ppVar7 = &player_health + iVar8;
    ppVar7->_pad0[0x2ec] = '\0';
    ppVar7->_pad0[0x2ed] = '\0';
    ppVar7->_pad0[0x2ee] = 0x80;
    ppVar7->_pad0[0x2ef] = '?';
  }
  local_34 = (&player_health)[iVar8]._pad0 + 0x2d8;
  IVar5.vtable = (IGrim2D_vtbl *)(*(IGrim2D_vtbl **)local_34 - (frame_dt + frame_dt));
  *(IGrim2D_vtbl **)local_34 = IVar5.vtable;
  if ((float)IVar5.vtable < 0.0) {
    *(IGrim2D_vtbl **)local_34 = (IGrim2D_vtbl *)0x0;
  }
  if (_bonus_weapon_power_up_timer <= 0.0) {
    fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x2b0) - frame_dt;
  }
  else {
    fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x2b0) - frame_dt * 1.5;
  }
  *(float *)((&player_health)[iVar8]._pad0 + 0x2b0) = fVar23;
  if (*(float *)((&player_health)[iVar8]._pad0 + 0x2b0) < 0.0) {
    ppVar7 = &player_health + iVar8;
    ppVar7->_pad0[0x2b0] = '\0';
    ppVar7->_pad0[0x2b1] = '\0';
    ppVar7->_pad0[0x2b2] = '\0';
    ppVar7->_pad0[0x2b3] = '\0';
  }
  iVar11 = perk_count_get(perk_id_man_bomb);
  if (iVar11 == 0) {
    ppVar7 = &player_health + iVar8;
    ppVar7->_pad0[0x7c] = '\0';
    ppVar7->_pad0[0x7d] = '\0';
    ppVar7->_pad0[0x7e] = '\0';
    ppVar7->_pad0[0x7f] = '\0';
  }
  else {
    fVar23 = frame_dt + *(float *)((&player_health)[iVar8]._pad0 + 0x7c);
    *(float *)((&player_health)[iVar8]._pad0 + 0x7c) = fVar23;
    if (_DAT_00473310 < fVar23) {
      if (*(float *)((int)cv_friendlyFire + 0xc) == 0.0) {
        iVar11 = -100;
      }
      else {
        iVar11 = -1 - render_overlay_player_index;
      }
      local_38 = 0.0;
      do {
        iVar20 = iVar11;
        if (((uint)local_38 & 1) == 0) {
          type_id = 0x16;
          iVar12 = crt_rand();
        }
        else {
          type_id = 0x15;
          iVar12 = crt_rand();
        }
        in_stack_ffffff94 = 5.98991e-39;
        projectile_spawn((float *)pos,
                         ((float)(int)local_38 * 0.7853982 + (float)(iVar12 % 0x32) * 0.01) - 0.25,
                         type_id,iVar20);
        local_38 = (float)((int)local_38 + 1);
      } while ((int)local_38 < 8);
      in_stack_ffffff98 = (IGrim2D *)0x41398e;
      in_stack_ffffff9c = (float *)sfx_explosion_small;
      sfx_play_panned(sfx_explosion_small);
      *(float *)((&player_health)[iVar8]._pad0 + 0x7c) =
           *(float *)((&player_health)[iVar8]._pad0 + 0x7c) - _DAT_00473310;
      _DAT_00473310 = 4.0;
    }
  }
  iVar11 = perk_count_get(perk_id_living_fortress);
  if (iVar11 == 0) {
    ppVar7 = &player_health + iVar8;
    ppVar7->_pad0[0x80] = '\0';
    ppVar7->_pad0[0x81] = '\0';
    ppVar7->_pad0[0x82] = '\0';
    ppVar7->_pad0[0x83] = '\0';
  }
  else {
    fVar23 = frame_dt + *(float *)((&player_health)[iVar8]._pad0 + 0x80);
    *(float *)((&player_health)[iVar8]._pad0 + 0x80) = fVar23;
    if (30.0 < fVar23) {
      ppVar7 = &player_health + iVar8;
      ppVar7->_pad0[0x80] = '\0';
      ppVar7->_pad0[0x81] = '\0';
      ppVar7->_pad0[0x82] = 0xf0;
      ppVar7->_pad0[0x83] = 'A';
    }
  }
  iVar11 = perk_count_get(perk_id_fire_caugh);
  if (iVar11 == 0) {
    ppVar7 = &player_health + iVar8;
    ppVar7->_pad0[0x84] = '\0';
    ppVar7->_pad0[0x85] = '\0';
    ppVar7->_pad0[0x86] = '\0';
    ppVar7->_pad0[0x87] = '\0';
  }
  else {
    fVar23 = frame_dt + *(float *)((&player_health)[iVar8]._pad0 + 0x84);
    *(float *)((&player_health)[iVar8]._pad0 + 0x84) = fVar23;
    if (_DAT_00473314 < fVar23) {
      if (*(float *)((int)cv_friendlyFire + 0xc) == 0.0) {
        local_40 = -NAN;
      }
      else {
        local_40 = (float)(-1 - render_overlay_player_index);
      }
      sfx_play_panned(DAT_004d9050);
      sfx_play_panned(DAT_004d7fd8);
      iVar20 = render_overlay_player_index;
      local_38 = *(float *)((&player_health)[iVar8]._pad0 + 0x2dc);
      fVar17 = ((float10)local_38 - (float10)1.5707964) - (float10)0.150915;
      fVar18 = (float10)fcos(fVar17);
      local_1c = *(float **)((&player_health)[render_overlay_player_index]._pad0 + 0x30);
      local_20 = *(IGrim2D_vtbl **)((&player_health)[render_overlay_player_index]._pad0 + 0x2c);
      iVar11 = render_overlay_player_index * 0xd8;
      local_18.vtable = (IGrim2D_vtbl *)(float)(fVar18 * (float10)16.0);
      fVar17 = (float10)fsin(fVar17);
      local_14 = (float *)(float)(fVar17 * (float10)16.0);
      local_c.vtable =
           (IGrim2D_vtbl *)
           ((float)local_1c - (float)(&player_pos_y)[render_overlay_player_index * 0xd8]);
      local_10.vtable = (IGrim2D_vtbl *)(local_20 - (float)(&player_pos_x)[iVar11]);
      fVar17 = FUN_00417660((float *)&local_10);
      local_30 = (float *)(float)(fVar17 * (float10)0.5);
      uVar10 = crt_rand();
      fVar23 = (float)(uVar10 & 0x1ff) * 0.012271847;
      uVar10 = crt_rand();
      local_44 = uVar10 & 0x1ff;
      fVar17 = (float10)(float)local_30 *
               (float10)*(float *)((&player_health)[iVar20]._pad0 + 0x294) * (float10)local_44 *
               (float10)0.001953125;
      fVar18 = (float10)fcos((float10)fVar23);
      local_20 = (IGrim2D_vtbl *)(float)(fVar18 * fVar17 + (float10)(float)local_20);
      fVar18 = (float10)fsin((float10)fVar23);
      local_1c = (float *)(float)(fVar18 * fVar17 + (float10)(float)local_1c);
      pfVar13 = FUN_00417640(&player_pos_x + iVar11,(float *)&local_30,(float *)&local_20,
                             (float *)unaff_EBP);
      fVar17 = (float10)fpatan((float10)pfVar13[1],(float10)*pfVar13);
      in_stack_ffffff98 = &local_10;
      in_stack_ffffff9c = (float *)(float)(fVar17 - (float10)1.5707964);
      local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
      local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
      local_30 = in_stack_ffffff9c;
      projectile_spawn((float *)in_stack_ffffff98,(float)in_stack_ffffff9c,0x2d,(int)local_40);
      fVar17 = (float10)fcos((float10)local_38);
      in_stack_ffffff90 = &local_10;
      in_stack_ffffff94 = 1.0;
      local_10.vtable = (IGrim2D_vtbl *)(float)(fVar17 * (float10)25.0);
      fVar17 = (float10)fsin((float10)local_38);
      local_c.vtable = (IGrim2D_vtbl *)(float)(fVar17 * (float10)25.0);
      local_14 = (float *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
      local_18.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
      iVar11 = fx_spawn_sprite((float *)&local_18,(float *)in_stack_ffffff90,1.0);
      (&sprite_effect_pool)[iVar11].color_r = 0.5;
      (&sprite_effect_pool)[iVar11].color_g = 0.5;
      (&sprite_effect_pool)[iVar11].color_b = 0.5;
      (&sprite_effect_pool)[iVar11].color_a = 0.413;
      *(float *)((&player_health)[iVar8]._pad0 + 0x84) =
           *(float *)((&player_health)[iVar8]._pad0 + 0x84) - _DAT_00473314;
      uVar10 = crt_rand();
      local_30 = (float *)(uVar10 & 0x80000003);
      if ((int)local_30 < 0) {
        local_30 = (float *)(((int)local_30 - 1U | 0xfffffffc) + 1);
      }
      _DAT_00473314 = (float)(int)local_30 + 2.0;
    }
  }
  iVar11 = perk_count_get(perk_id_hot_tempered);
  if (iVar11 == 0) {
    ppVar7 = &player_health + iVar8;
    ppVar7->_pad0[0x78] = '\0';
    ppVar7->_pad0[0x79] = '\0';
    ppVar7->_pad0[0x7a] = '\0';
    ppVar7->_pad0[0x7b] = '\0';
  }
  else {
    fVar23 = frame_dt + *(float *)((&player_health)[iVar8]._pad0 + 0x78);
    *(float *)((&player_health)[iVar8]._pad0 + 0x78) = fVar23;
    if (_DAT_00473318 < fVar23) {
      if (*(float *)((int)cv_friendlyFire + 0xc) == 0.0) {
        iVar11 = -100;
      }
      else {
        iVar11 = -1 - render_overlay_player_index;
      }
      local_38 = 0.0;
      do {
        if (((uint)local_38 & 1) == 0) {
          iVar20 = 0xb;
        }
        else {
          iVar20 = 9;
        }
        in_stack_ffffff94 = 5.991191e-39;
        projectile_spawn((float *)pos,(float)(int)local_38 * 0.7853982,iVar20,iVar11);
        local_38 = (float)((int)local_38 + 1);
      } while ((int)local_38 < 8);
      in_stack_ffffff98 = (IGrim2D *)0x413d20;
      in_stack_ffffff9c = (float *)sfx_explosion_small;
      sfx_play_panned(sfx_explosion_small);
      *(float *)((&player_health)[iVar8]._pad0 + 0x78) =
           *(float *)((&player_health)[iVar8]._pad0 + 0x78) - _DAT_00473318;
      uVar10 = crt_rand();
      local_30 = (float *)(uVar10 & 0x80000007);
      if ((int)local_30 < 0) {
        local_30 = (float *)(((int)local_30 - 1U | 0xfffffff8) + 1);
      }
      _DAT_00473318 = (float)(int)local_30 + 2.0;
    }
  }
  if (_DAT_004aaf34 <= 0.0) {
    _DAT_00473a40 = frame_dt * 0.8 + _DAT_00473a40;
    if (1.0 < _DAT_00473a40) {
      _DAT_00473a40 = 1.0;
    }
  }
  else {
    _DAT_00473a40 = _DAT_00473a40 - frame_dt;
    if (_DAT_00473a40 < 0.3) {
      _DAT_00473a40 = 0.3;
    }
  }
  fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x38);
  local_18.vtable = (IGrim2D_vtbl *)0x0;
  local_14 = (float *)0x0;
  *(undefined4 *)(&player_move_dx + iVar16) = 0;
  *(undefined4 *)(&player_move_dy + iVar16) = 0;
  if (time_scale_active != '\0') {
    frame_dt = (0.6 / _time_scale_factor) * frame_dt;
  }
  pIVar22 = pos;
  if (((demo_mode_active == '\0') &&
      (*(int *)(config_blob.reserved0 + render_overlay_player_index * 4 + 0x1c) != 5)) &&
     (*(int *)(config_blob.reserved0 + render_overlay_player_index * 4 + 0x44) != 5)) {
LAB_00413f2d:
    iVar11 = *(int *)(config_blob.reserved0 + render_overlay_player_index * 4 + 0x1c);
    if (iVar11 == 5) goto LAB_00414c7f;
    if (iVar11 == 4) {
      iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                         ((IGrim2D *)config_blob.key_reload,(int)unaff_EBP);
      if ((char)iVar11 != '\0') {
        local_10.vtable =
             (IGrim2D_vtbl *)
             ((float)(&DAT_004871f8)[render_overlay_player_index * 2] - _camera_offset_y);
        local_14 = (float *)((float)(&DAT_004871f4)[render_overlay_player_index * 2] -
                            _camera_offset_x);
        *(float **)((&player_health)[iVar8]._pad0 + 0x300) = local_14;
        *(IGrim2D_vtbl **)((&player_health)[iVar8]._pad0 + 0x304) = local_10.vtable;
      }
      if (*(int *)((&player_health)[iVar8]._pad0 + 0x300) != -0x40800000) {
        fVar17 = (float10)(float)(&player_pos_y)[iVar8 * 0xd8] -
                 (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x304);
        fVar18 = (float10)(float)pos->vtable -
                 (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x300);
        if ((float10)20.0 < SQRT(fVar17 * fVar17 + fVar18 * fVar18)) {
          fVar17 = (float10)fpatan(fVar17,fVar18);
          fVar17 = fVar17 - (float10)1.5707964;
          if (fVar17 < (float10)0.0) {
            do {
              fVar17 = fVar17 + (float10)6.2831855;
            } while (fVar17 < (float10)0.0);
          }
          local_34 = (uchar *)(float)fVar17;
          if (fVar17 != (float10)-1.0) {
            fVar17 = (float10)FUN_00413540((float)local_34);
            if (*(int *)(player_health._pad0 + perk_id_long_distance_runner * 4 + 0x94) < 1) {
              fVar23 = frame_dt * 5.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
              *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar23;
              if (2.0 < fVar23) {
                ppVar7 = &player_health + iVar8;
                ppVar7->_pad0[0x44] = '\0';
                ppVar7->_pad0[0x45] = '\0';
                ppVar7->_pad0[0x46] = '\0';
                ppVar7->_pad0[0x47] = '@';
              }
            }
            else {
              if (*(float *)((&player_health)[iVar8]._pad0 + 0x44) < 2.0) {
                *(float *)((&player_health)[iVar8]._pad0 + 0x44) =
                     frame_dt * 4.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
              }
              fVar23 = frame_dt + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
              *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar23;
              if (2.8 < fVar23) {
                builtin_memcpy((&player_health)[iVar8]._pad0 + 0x44,"333@",4);
              }
            }
            if ((*(int *)((&player_health)[iVar8]._pad0 + 0x29c) == 7) &&
               (0.8 < *(float *)((&player_health)[iVar8]._pad0 + 0x44))) {
              ppVar7 = &player_health + iVar8;
              ppVar7->_pad0[0x44] = 0xcd;
              ppVar7->_pad0[0x45] = 0xcc;
              ppVar7->_pad0[0x46] = 'L';
              ppVar7->_pad0[0x47] = '?';
            }
            delta = &local_c;
            puVar21 = (uchar *)(float)((float10)3.1415927 - fVar17);
            fVar17 = (float10)fcos((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                                   (float10)1.5707964);
            *(float *)(&player_move_dx + iVar16) =
                 (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                         (float10)(float)puVar21 * (float10)local_38 * (float10)7.957747);
            fVar17 = (float10)fsin((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                                   (float10)1.5707964);
            *(float *)(&player_move_dy + iVar16) =
                 (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                         (float10)(float)puVar21 * (float10)local_38 * (float10)7.957747);
            fStack_8 = frame_dt * *(float *)(&player_move_dy + iVar16);
            local_c.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dx + iVar16));
            in_stack_ffffff9c = (float *)render_overlay_player_index;
            unaff_EBP = local_34;
            local_34 = puVar21;
            goto LAB_00414f1c;
          }
        }
      }
      fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x44) - frame_dt * 15.0;
      *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar23;
      if (fVar23 < 0.0) {
        ppVar7 = &player_health + iVar8;
        ppVar7->_pad0[0x44] = '\0';
        ppVar7->_pad0[0x45] = '\0';
        ppVar7->_pad0[0x46] = '\0';
        ppVar7->_pad0[0x47] = '\0';
      }
      fVar17 = (float10)fcos((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                             (float10)1.5707964);
      *(float *)(&player_move_dx + iVar16) =
           (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                   (float10)local_38 * (float10)25.0);
      fVar17 = (float10)fsin((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                             (float10)1.5707964);
      *(float *)(&player_move_dy + iVar16) =
           (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                   (float10)local_38 * (float10)25.0);
      fStack_8 = frame_dt * *(float *)(&player_move_dy + iVar16);
      local_c.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dx + iVar16));
      pIVar22 = (IGrim2D *)render_overlay_player_index;
      delta = pos;
      unaff_EBP = (uchar *)&local_c;
      goto LAB_00414f1c;
    }
    if (iVar11 == 3) {
      (*grim_interface_ptr->vtable->grim_get_config_float)
                ((IGrim2D *)(&player_health)[iVar8].input.axis_move_y,(int)unaff_EBP);
      unaff_EBP = (uchar *)(&player_health)[iVar8].input.axis_move_x;
      (*grim_interface_ptr->vtable->grim_get_config_float)((IGrim2D *)unaff_EBP,(int)unaff_EDI);
      local_18.vtable = (IGrim2D_vtbl *)(float)-extraout_ST0_00;
      local_14 = local_30;
      local_34 = (uchar *)(float)-extraout_ST0;
      if (0.2 < SQRT((float)local_30 * (float)local_30 +
                     (float)local_18.vtable * (float)local_18.vtable)) {
        unaff_EDI = &local_18;
        unaff_EBP = (uchar *)&local_18;
        thunk_FUN_00452f1d();
        fVar17 = (float10)fpatan((float10)(float)local_1c,(float10)(float)local_20);
        fVar17 = fVar17 - (float10)1.5707964;
        if (fVar17 < (float10)0.0) {
          do {
            fVar17 = fVar17 + (float10)6.2831855;
          } while (fVar17 < (float10)0.0);
        }
        local_38 = (float)fVar17;
        if (fVar17 != (float10)-1.0) {
          fVar17 = (float10)FUN_00413540(local_38);
          if (*(int *)(player_health._pad0 + perk_id_long_distance_runner * 4 + 0x94) < 1) {
            fVar2 = frame_dt * 5.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
            *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
            if (2.0 < fVar2) {
              ppVar7 = &player_health + iVar8;
              ppVar7->_pad0[0x44] = '\0';
              ppVar7->_pad0[0x45] = '\0';
              ppVar7->_pad0[0x46] = '\0';
              ppVar7->_pad0[0x47] = '@';
            }
          }
          else {
            if (*(float *)((&player_health)[iVar8]._pad0 + 0x44) < 2.0) {
              *(float *)((&player_health)[iVar8]._pad0 + 0x44) =
                   frame_dt * 4.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
            }
            fVar2 = frame_dt + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
            *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
            if (2.8 < fVar2) {
              builtin_memcpy((&player_health)[iVar8]._pad0 + 0x44,"333@",4);
            }
          }
          if ((*(int *)((&player_health)[iVar8]._pad0 + 0x29c) == 7) &&
             (0.8 < *(float *)((&player_health)[iVar8]._pad0 + 0x44))) {
            ppVar7 = &player_health + iVar8;
            ppVar7->_pad0[0x44] = 0xcd;
            ppVar7->_pad0[0x45] = 0xcc;
            ppVar7->_pad0[0x46] = 'L';
            ppVar7->_pad0[0x47] = '?';
          }
          delta = &local_10;
          fVar18 = (float10)fcos((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                                 (float10)1.5707964);
          *(float *)(&player_move_dx + iVar16) =
               (float)(fVar18 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                       (float10)(float)((float10)3.1415927 - fVar17) * (float10)fVar23 *
                      (float10)7.957747);
          fVar18 = (float10)fsin((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                                 (float10)1.5707964);
          *(float *)(&player_move_dy + iVar16) =
               (float)(fVar18 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                       (float10)(float)((float10)3.1415927 - fVar17) * (float10)fVar23 *
                      (float10)7.957747);
          local_c.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dy + iVar16));
          local_10.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dx + iVar16));
          in_stack_ffffff9c = (float *)render_overlay_player_index;
          goto LAB_00414f1c;
        }
      }
      fVar2 = *(float *)((&player_health)[iVar8]._pad0 + 0x44) - frame_dt * 15.0;
      *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
      if (fVar2 < 0.0) {
        ppVar7 = &player_health + iVar8;
        ppVar7->_pad0[0x44] = '\0';
        ppVar7->_pad0[0x45] = '\0';
        ppVar7->_pad0[0x46] = '\0';
        ppVar7->_pad0[0x47] = '\0';
      }
      delta = &local_10;
      fVar17 = (float10)fcos((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                             (float10)1.5707964);
      *(float *)(&player_move_dx + iVar16) =
           (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                   (float10)fVar23 * (float10)25.0);
      fVar17 = (float10)fsin((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                             (float10)1.5707964);
      *(float *)(&player_move_dy + iVar16) =
           (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                   (float10)fVar23 * (float10)25.0);
      local_c.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dy + iVar16));
      local_10.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dx + iVar16));
      in_stack_ffffff9c = (float *)render_overlay_player_index;
      goto LAB_00414f1c;
    }
    if (iVar11 == 1) {
      bVar9 = false;
      if (*(float *)((&player_health)[iVar8]._pad0 + 0x2e0) < 1.0) {
        ppVar7 = &player_health + iVar8;
        ppVar7->_pad0[0x2e0] = '\0';
        ppVar7->_pad0[0x2e1] = '\0';
        ppVar7->_pad0[0x2e2] = 0x80;
        ppVar7->_pad0[0x2e3] = '?';
      }
      if (7.0 < *(float *)((&player_health)[iVar8]._pad0 + 0x2e0)) {
        ppVar7 = &player_health + iVar8;
        ppVar7->_pad0[0x2e0] = '\0';
        ppVar7->_pad0[0x2e1] = '\0';
        ppVar7->_pad0[0x2e2] = 0xe0;
        ppVar7->_pad0[0x2e3] = '@';
      }
      pIVar22 = (IGrim2D *)(&player_health)[iVar8].input.turn_key_left;
      iVar20 = 0x414473;
      iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)(pIVar22,(int)unaff_EBP);
      if ((char)iVar11 == '\0') {
        if (config_blob.reserved0._20_4_ == 1) {
          unaff_EBP = (uchar *)CONCAT31((int3)((uint)iVar11 >> 8),player_alt_turn_key_left._0_1_);
          pIVar22 = (IGrim2D *)0x414495;
          iVar11 = (*grim_interface_ptr->vtable->grim_is_key_down)
                             ((IGrim2D *)unaff_EBP,(uint)unaff_EDI);
          if ((char)iVar11 != '\0') goto LAB_00414520;
        }
        iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                           ((IGrim2D *)(&player_health)[iVar8].input.turn_key_right,
                            (int)in_stack_ffffff98);
        if ((char)iVar11 != '\0') {
LAB_004144dc:
          fVar2 = frame_dt * 10.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x2e0);
          *(float *)((&player_health)[iVar8]._pad0 + 0x2e0) = fVar2;
          *(float *)((&player_health)[iVar8]._pad0 + 8) =
               fVar2 * frame_dt * 0.5 + *(float *)((&player_health)[iVar8]._pad0 + 8);
          fVar2 = frame_dt * *(float *)((&player_health)[iVar8]._pad0 + 0x2e0) * 0.5 +
                  *(float *)((&player_health)[iVar8]._pad0 + 0x2dc);
          goto LAB_00414562;
        }
        if (config_blob.reserved0._20_4_ == 1) {
          iVar11 = (*grim_interface_ptr->vtable->grim_is_key_down)
                             ((IGrim2D *)
                              CONCAT31((int3)((uint)iVar11 >> 8),player_alt_turn_key_right._0_1_),
                              (uint)in_stack_ffffff9c);
          if ((char)iVar11 != '\0') goto LAB_004144dc;
        }
      }
      else {
LAB_00414520:
        fVar2 = frame_dt * 10.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x2e0);
        *(float *)((&player_health)[iVar8]._pad0 + 0x2e0) = fVar2;
        *(float *)((&player_health)[iVar8]._pad0 + 8) =
             *(float *)((&player_health)[iVar8]._pad0 + 8) - fVar2 * frame_dt * 0.5;
        fVar2 = *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) -
                frame_dt * *(float *)((&player_health)[iVar8]._pad0 + 0x2e0) * 0.5;
LAB_00414562:
        *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) = fVar2;
        bVar9 = true;
      }
      local_40 = 1.0;
      iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                         ((IGrim2D *)(&player_health)[iVar8].input.move_key_forward,iVar20);
      if ((char)iVar11 == '\0') {
        if (config_blob.reserved0._20_4_ == 1) {
          iVar11 = (*grim_interface_ptr->vtable->grim_is_key_down)
                             ((IGrim2D *)
                              CONCAT31((int3)((uint)iVar11 >> 8),player_alt_move_key_forward._0_1_),
                              (uint)pIVar22);
          if ((char)iVar11 != '\0') goto LAB_00414750;
        }
        iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                           ((IGrim2D *)(&player_health)[iVar8].input.move_key_backward,
                            (int)unaff_EBP);
        if ((char)iVar11 == '\0') {
          if (config_blob.reserved0._20_4_ == 1) {
            unaff_EBP = (uchar *)CONCAT31((int3)((uint)iVar11 >> 8),
                                          player_alt_move_key_backward._0_1_);
            iVar11 = (*grim_interface_ptr->vtable->grim_is_key_down)
                               ((IGrim2D *)unaff_EBP,(uint)unaff_EDI);
            if ((char)iVar11 != '\0') goto LAB_0041467b;
          }
          if (!bVar9) {
            ppVar7 = &player_health + iVar8;
            ppVar7->_pad0[0x2e0] = '\0';
            ppVar7->_pad0[0x2e1] = '\0';
            ppVar7->_pad0[0x2e2] = 0x80;
            ppVar7->_pad0[0x2e3] = '?';
          }
          fVar2 = *(float *)((&player_health)[iVar8]._pad0 + 0x44) - frame_dt * 15.0;
          *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
          if (fVar2 < 0.0) {
            ppVar7 = &player_health + iVar8;
            ppVar7->_pad0[0x44] = '\0';
            ppVar7->_pad0[0x45] = '\0';
            ppVar7->_pad0[0x46] = '\0';
            ppVar7->_pad0[0x47] = '\0';
          }
          fVar17 = (float10)fcos((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                                 (float10)1.5707964);
          *(float *)(&player_move_dx + iVar16) =
               (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                       (float10)fVar23 * (float10)25.0);
          fVar17 = (float10)fsin((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                                 (float10)1.5707964);
          *(float *)(&player_move_dy + iVar16) =
               (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                       (float10)fVar23 * (float10)25.0);
          local_c.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dy + iVar16));
          local_10.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dx + iVar16));
        }
        else {
LAB_0041467b:
          if (*(int *)(player_health._pad0 + perk_id_long_distance_runner * 4 + 0x94) < 1) {
            fVar2 = frame_dt * 5.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
            *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
            if (2.0 < fVar2) {
              ppVar7 = &player_health + iVar8;
              ppVar7->_pad0[0x44] = '\0';
              ppVar7->_pad0[0x45] = '\0';
              ppVar7->_pad0[0x46] = '\0';
              ppVar7->_pad0[0x47] = '@';
            }
          }
          else {
            if (*(float *)((&player_health)[iVar8]._pad0 + 0x44) < 2.0) {
              *(float *)((&player_health)[iVar8]._pad0 + 0x44) =
                   frame_dt * 4.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
            }
            fVar2 = frame_dt + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
            *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
            if (2.8 < fVar2) {
              builtin_memcpy((&player_health)[iVar8]._pad0 + 0x44,"333@",4);
            }
          }
          local_38 = -1.0;
          fVar17 = (float10)fcos((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                                 (float10)1.5707964);
          *(float *)(&player_move_dx + iVar16) =
               (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                       (float10)fVar23 * (float10)-25.0);
          fVar17 = (float10)fsin((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                                 (float10)1.5707964);
          *(float *)(&player_move_dy + iVar16) =
               (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                       (float10)fVar23 * (float10)-25.0);
          local_c.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dy + iVar16));
          local_10.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dx + iVar16));
        }
      }
      else {
LAB_00414750:
        if (*(int *)(player_health._pad0 + perk_id_long_distance_runner * 4 + 0x94) < 1) {
          fVar2 = frame_dt * 5.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
          *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
          if (2.0 < fVar2) {
            ppVar7 = &player_health + iVar8;
            ppVar7->_pad0[0x44] = '\0';
            ppVar7->_pad0[0x45] = '\0';
            ppVar7->_pad0[0x46] = '\0';
            ppVar7->_pad0[0x47] = '@';
          }
        }
        else {
          if (*(float *)((&player_health)[iVar8]._pad0 + 0x44) < 2.0) {
            *(float *)((&player_health)[iVar8]._pad0 + 0x44) =
                 frame_dt * 4.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
          }
          fVar2 = frame_dt + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
          *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
          if (2.8 < fVar2) {
            builtin_memcpy((&player_health)[iVar8]._pad0 + 0x44,"333@",4);
          }
        }
        if ((*(int *)((&player_health)[iVar8]._pad0 + 0x29c) == 7) &&
           (0.8 < *(float *)((&player_health)[iVar8]._pad0 + 0x44))) {
          ppVar7 = &player_health + iVar8;
          ppVar7->_pad0[0x44] = 0xcd;
          ppVar7->_pad0[0x45] = 0xcc;
          ppVar7->_pad0[0x46] = 'L';
          ppVar7->_pad0[0x47] = '?';
        }
        fVar17 = (float10)fcos((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                               (float10)1.5707964);
        *(float *)(&player_move_dx + iVar16) =
             (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                     (float10)fVar23 * (float10)25.0);
        fVar17 = (float10)fsin((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                               (float10)1.5707964);
        *(float *)(&player_move_dy + iVar16) =
             (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                     (float10)fVar23 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dy + iVar16));
        local_10.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dx + iVar16));
      }
      player_apply_move_with_spawn_avoidance
                (render_overlay_player_index,(float *)pos,(float *)&local_10);
      fVar23 = local_38 * *(float *)((&player_health)[iVar8]._pad0 + 0x44) * frame_dt;
      goto LAB_00414f2d;
    }
    if (iVar11 == 2) {
      pIVar22 = (IGrim2D *)(&player_health)[iVar8].input.turn_key_left;
      local_40 = -1.0;
      puVar21 = (uchar *)0x414881;
      iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)(pIVar22,(int)unaff_EBP);
      if ((char)iVar11 == '\0') {
        if (config_blob.reserved0._20_4_ == 1) {
          pIVar22 = (IGrim2D *)0x4148a2;
          unaff_EBP = player_alt_turn_key_left;
          iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                             ((IGrim2D *)player_alt_turn_key_left,(int)unaff_EDI);
          if ((char)iVar11 != '\0') goto LAB_004148a6;
        }
      }
      else {
LAB_004148a6:
        unaff_EBP = (uchar *)0x4096cbe4;
      }
      iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                         ((IGrim2D *)(&player_health)[iVar8].input.turn_key_right,
                          (int)in_stack_ffffff90);
      if (((char)iVar11 == '\0') && (config_blob.reserved0._20_4_ == 1)) {
        (*grim_interface_ptr->vtable->grim_is_key_active)
                  ((IGrim2D *)player_alt_turn_key_right,(int)in_stack_ffffff94);
      }
      iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                         ((IGrim2D *)(&player_health)[iVar8].input.move_key_forward,
                          (int)in_stack_ffffff98);
      if (((((char)iVar11 != '\0') ||
           ((config_blob.reserved0._20_4_ == 1 &&
            (in_stack_ffffff98 = player_alt_move_key_forward,
            iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                               (player_alt_move_key_forward,(int)in_stack_ffffff9c),
            (char)iVar11 != '\0')))) &&
          (iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                              ((IGrim2D *)(&player_health)[iVar8].input.turn_key_left,
                               (int)in_stack_ffffff98), (char)iVar11 == '\0')) &&
         ((((config_blob.reserved0._20_4_ != 1 ||
            (iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                                ((IGrim2D *)player_alt_turn_key_left,(int)in_stack_ffffff9c),
            (char)iVar11 == '\0')) &&
           (iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                               ((IGrim2D *)(&player_health)[iVar8].input.turn_key_right,(int)puVar21
                               ), (char)iVar11 == '\0')) && (config_blob.reserved0._20_4_ == 1)))) {
        puVar21 = player_alt_turn_key_right;
        (*grim_interface_ptr->vtable->grim_is_key_active)
                  ((IGrim2D *)player_alt_turn_key_right,(int)pIVar22);
      }
      iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                         ((IGrim2D *)(&player_health)[iVar8].input.move_key_backward,(int)puVar21);
      if (((char)iVar11 == '\0') &&
         ((config_blob.reserved0._20_4_ != 1 ||
          (puVar21 = player_alt_move_key_backward,
          iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                             ((IGrim2D *)player_alt_move_key_backward,(int)pIVar22),
          (char)iVar11 == '\0')))) {
        fVar2 = *(float *)((&player_health)[iVar8]._pad0 + 0x44) - frame_dt * 15.0;
        *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
        if (fVar2 < 0.0) {
          ppVar7 = &player_health + iVar8;
          ppVar7->_pad0[0x44] = '\0';
          ppVar7->_pad0[0x45] = '\0';
          ppVar7->_pad0[0x46] = '\0';
          ppVar7->_pad0[0x47] = '\0';
        }
        fVar17 = (float10)fcos((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                               (float10)1.5707964);
        *(float *)(&player_move_dx + iVar16) =
             (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                     (float10)fVar23 * (float10)25.0);
        fVar17 = (float10)fsin((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                               (float10)1.5707964);
        *(float *)(&player_move_dy + iVar16) =
             (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                     (float10)fVar23 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dy + iVar16));
        local_10.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dx + iVar16));
      }
      else {
        iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                           ((IGrim2D *)(&player_health)[iVar8].input.turn_key_left,(int)puVar21);
        if (((char)iVar11 == '\0') &&
           ((config_blob.reserved0._20_4_ != 1 ||
            (iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                                ((IGrim2D *)player_alt_turn_key_left,(int)pIVar22),
            (char)iVar11 == '\0')))) {
          iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                             ((IGrim2D *)(&player_health)[iVar8].input.turn_key_right,(int)unaff_EBP
                             );
          if (((char)iVar11 == '\0') &&
             ((config_blob.reserved0._20_4_ != 1 ||
              (unaff_EBP = player_alt_turn_key_right,
              iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                                 ((IGrim2D *)player_alt_turn_key_right,(int)unaff_EDI),
              (char)iVar11 == '\0')))) {
            local_40 = 3.1415927;
          }
          else {
            local_40 = 2.3561945;
          }
        }
        else {
          local_40 = 3.926991;
        }
        fVar17 = (float10)FUN_00413540(local_40);
        *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) =
             _DAT_00487198 + *(float *)((&player_health)[iVar8]._pad0 + 0x2dc);
        if (*(int *)(player_health._pad0 + perk_id_long_distance_runner * 4 + 0x94) < 1) {
          fVar2 = frame_dt * 5.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
          *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
          if (2.0 < fVar2) {
            ppVar7 = &player_health + iVar8;
            ppVar7->_pad0[0x44] = '\0';
            ppVar7->_pad0[0x45] = '\0';
            ppVar7->_pad0[0x46] = '\0';
            ppVar7->_pad0[0x47] = '@';
          }
        }
        else {
          if (*(float *)((&player_health)[iVar8]._pad0 + 0x44) < 2.0) {
            *(float *)((&player_health)[iVar8]._pad0 + 0x44) =
                 frame_dt * 4.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
          }
          fVar2 = frame_dt + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
          *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
          if (2.8 < fVar2) {
            builtin_memcpy((&player_health)[iVar8]._pad0 + 0x44,"333@",4);
          }
        }
        if ((*(int *)((&player_health)[iVar8]._pad0 + 0x29c) == 7) &&
           (0.8 < *(float *)((&player_health)[iVar8]._pad0 + 0x44))) {
          ppVar7 = &player_health + iVar8;
          ppVar7->_pad0[0x44] = 0xcd;
          ppVar7->_pad0[0x45] = 0xcc;
          ppVar7->_pad0[0x46] = 'L';
          ppVar7->_pad0[0x47] = '?';
        }
        fVar18 = (float10)fcos((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                               (float10)1.5707964);
        *(float *)(&player_move_dx + iVar16) =
             (float)(fVar18 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                     (float10)(float)((float10)3.1415927 - fVar17) * (float10)fVar23 *
                    (float10)7.957747);
        fVar18 = (float10)fsin((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                               (float10)1.5707964);
        *(float *)(&player_move_dy + iVar16) =
             (float)(fVar18 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                     (float10)(float)((float10)3.1415927 - fVar17) * (float10)fVar23 *
                    (float10)7.957747);
        local_c.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dy + iVar16));
        local_10.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dx + iVar16));
      }
      player_apply_move_with_spawn_avoidance
                (render_overlay_player_index,(float *)pos,(float *)&local_10);
      *(float *)((&player_health)[iVar8]._pad0 + 0x70) =
           frame_dt * *(float *)((&player_health)[iVar8]._pad0 + 0x44) * 19.0 +
           *(float *)((&player_health)[iVar8]._pad0 + 0x70);
    }
  }
  else {
    if (*(int *)((&player_health)[iVar8]._pad0 + 0x2fc) < 0) {
      ppVar7 = &player_health + iVar8;
      ppVar7->_pad0[0x2fc] = '\0';
      ppVar7->_pad0[0x2fd] = '\0';
      ppVar7->_pad0[0x2fe] = '\0';
      ppVar7->_pad0[0x2ff] = '\0';
    }
    iVar11 = *(int *)((&player_health)[iVar8]._pad0 + 0x2fc);
    if (((&creature_pool)[iVar11].active == '\0') || ((&creature_pool)[iVar11].health <= 0.0)) {
      pfVar13 = (float *)0x47c35000;
    }
    else {
      fVar2 = (float)(&player_pos_y)[iVar8 * 0xd8] - (&creature_pool)[iVar11].pos_y;
      fVar4 = (float)pos->vtable - (&creature_pool)[iVar11].pos_x;
      pfVar13 = (float *)SQRT(fVar2 * fVar2 + fVar4 * fVar4);
    }
    iVar11 = 0;
    pcVar14 = &creature_pool;
    do {
      if (((pcVar14->active != '\0') && (0.0 < pcVar14->health)) &&
         (fVar4 = (float)(&player_pos_y)[iVar8 * 0xd8] - pcVar14->pos_y,
         fVar2 = (float)pos->vtable - pcVar14->pos_x,
         local_30 = (float *)SQRT(fVar4 * fVar4 + fVar2 * fVar2),
         (float)local_30 < (float)pfVar13 - 64.0)) {
        *(int *)((&player_health)[iVar8]._pad0 + 0x2fc) = iVar11;
        pfVar13 = local_30;
      }
      pcVar14 = pcVar14 + 1;
      iVar11 = iVar11 + 1;
    } while ((int)pcVar14 < 0x4aa338);
    if (demo_mode_active == '\0') goto LAB_00413f2d;
LAB_00414c7f:
    if ((*(int *)((&player_health)[iVar8]._pad0 + 0x2fc) < 0) ||
       ((&creature_pool)[*(int *)((&player_health)[iVar8]._pad0 + 0x2fc)].health <= 0.0)) {
      fVar17 = (float10)fpatan((float10)(float)(&player_pos_y)[iVar8 * 0xd8] - (float10)512.0,
                               (float10)(float)pos->vtable - (float10)512.0);
      fVar17 = fVar17 + (float10)3.1415927;
    }
    else {
      fVar2 = (float)pos->vtable - 512.0;
      if (SQRT(((float)(&player_pos_y)[iVar8 * 0xd8] - 512.0) *
               ((float)(&player_pos_y)[iVar8 * 0xd8] - 512.0) + fVar2 * fVar2) <= 300.0) {
        local_14 = (float *)((float)(&player_pos_y)[iVar8 * 0xd8] -
                            (&creature_pool)[*(int *)((&player_health)[iVar8]._pad0 + 0x2fc)].pos_y)
        ;
        local_18.vtable =
             (IGrim2D_vtbl *)
             (pos->vtable - (&creature_pool)[*(int *)((&player_health)[iVar8]._pad0 + 0x2fc)].pos_x)
        ;
      }
      else {
        local_14 = (float *)((float)(&player_pos_y)[iVar8 * 0xd8] - 512.0);
        local_18.vtable = (IGrim2D_vtbl *)(pos->vtable - 512.0);
      }
      fVar17 = (float10)fpatan((float10)(float)local_14,(float10)(float)local_18.vtable);
      fVar17 = fVar17 - (float10)1.5707964;
      local_20 = local_18.vtable;
      local_1c = local_14;
    }
    if (fVar17 == (float10)-1.0) {
      fVar2 = *(float *)((&player_health)[iVar8]._pad0 + 0x44) - frame_dt * 15.0;
      *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
      if (fVar2 < 0.0) {
        ppVar7 = &player_health + iVar8;
        ppVar7->_pad0[0x44] = '\0';
        ppVar7->_pad0[0x45] = '\0';
        ppVar7->_pad0[0x46] = '\0';
        ppVar7->_pad0[0x47] = '\0';
      }
      delta = &local_10;
      fVar17 = (float10)fcos((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                             (float10)1.5707964);
      *(float *)(&player_move_dx + iVar16) =
           (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                   (float10)fVar23 * (float10)25.0);
      fVar17 = (float10)fsin((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                             (float10)1.5707964);
      *(float *)(&player_move_dy + iVar16) =
           (float)(fVar17 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                   (float10)fVar23 * (float10)25.0);
      local_c.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dy + iVar16));
      local_10.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dx + iVar16));
      in_stack_ffffff9c = (float *)render_overlay_player_index;
    }
    else {
      fVar17 = (float10)FUN_00413540((float)fVar17);
      if (*(int *)(player_health._pad0 + perk_id_long_distance_runner * 4 + 0x94) < 1) {
        fVar2 = frame_dt * 5.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
        *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
        if (2.0 < fVar2) {
          ppVar7 = &player_health + iVar8;
          ppVar7->_pad0[0x44] = '\0';
          ppVar7->_pad0[0x45] = '\0';
          ppVar7->_pad0[0x46] = '\0';
          ppVar7->_pad0[0x47] = '@';
        }
      }
      else {
        if (*(float *)((&player_health)[iVar8]._pad0 + 0x44) < 2.0) {
          *(float *)((&player_health)[iVar8]._pad0 + 0x44) =
               frame_dt * 4.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
        }
        fVar2 = frame_dt + *(float *)((&player_health)[iVar8]._pad0 + 0x44);
        *(float *)((&player_health)[iVar8]._pad0 + 0x44) = fVar2;
        if (2.8 < fVar2) {
          builtin_memcpy((&player_health)[iVar8]._pad0 + 0x44,"333@",4);
        }
      }
      if ((*(int *)((&player_health)[iVar8]._pad0 + 0x29c) == 7) &&
         (0.8 < *(float *)((&player_health)[iVar8]._pad0 + 0x44))) {
        ppVar7 = &player_health + iVar8;
        ppVar7->_pad0[0x44] = 0xcd;
        ppVar7->_pad0[0x45] = 0xcc;
        ppVar7->_pad0[0x46] = 'L';
        ppVar7->_pad0[0x47] = '?';
      }
      delta = &local_10;
      fVar18 = (float10)fcos((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                             (float10)1.5707964);
      *(float *)(&player_move_dx + iVar16) =
           (float)(fVar18 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                   (float10)(float)((float10)3.1415927 - fVar17) * (float10)fVar23 *
                  (float10)7.957747);
      fVar18 = (float10)fsin((float10)*(float *)((&player_health)[iVar8]._pad0 + 8) -
                             (float10)1.5707964);
      *(float *)(&player_move_dy + iVar16) =
           (float)(fVar18 * (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x44) *
                   (float10)(float)((float10)3.1415927 - fVar17) * (float10)fVar23 *
                  (float10)7.957747);
      local_c.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dy + iVar16));
      local_10.vtable = (IGrim2D_vtbl *)(frame_dt * *(float *)(&player_move_dx + iVar16));
      in_stack_ffffff9c = (float *)render_overlay_player_index;
    }
LAB_00414f1c:
    player_apply_move_with_spawn_avoidance((int)in_stack_ffffff9c,(float *)pIVar22,(float *)delta);
    fVar23 = frame_dt * *(float *)((&player_health)[iVar8]._pad0 + 0x44);
LAB_00414f2d:
    *(float *)((&player_health)[iVar8]._pad0 + 0x70) =
         fVar23 * 19.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x70);
  }
  if (time_scale_active != '\0') {
    frame_dt = _time_scale_factor * frame_dt * 1.6666666;
  }
  iVar11 = perk_count_get(perk_id_sharpshooter);
  if (iVar11 == 0) {
    fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x294) - frame_dt * 0.4;
    *(float *)((&player_health)[iVar8]._pad0 + 0x294) = fVar23;
    if (fVar23 < 0.01) {
      ppVar7 = &player_health + iVar8;
      ppVar7->_pad0[0x294] = '\n';
      ppVar7->_pad0[0x295] = 0xd7;
      ppVar7->_pad0[0x296] = '#';
      ppVar7->_pad0[0x297] = '<';
    }
  }
  else {
    fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x294) - (frame_dt + frame_dt);
    *(float *)((&player_health)[iVar8]._pad0 + 0x294) = fVar23;
    if (fVar23 < 0.25) {
      ppVar7 = &player_health + iVar8;
      ppVar7->_pad0[0x294] = '\0';
      ppVar7->_pad0[0x295] = '\0';
      ppVar7->_pad0[0x296] = 0x80;
      ppVar7->_pad0[0x297] = '>';
    }
    builtin_memcpy((&player_health)[iVar8]._pad0 + 0x294,"\n<",4);
  }
  iVar11 = perk_count_get(perk_id_anxious_loader);
  if ((((iVar11 != 0) && (iVar11 = input_primary_just_pressed(), (char)iVar11 != '\0')) &&
      (0.0 < *(float *)((&player_health)[iVar8]._pad0 + 0x2ac))) &&
     (fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x2ac) - 0.05,
     *(float *)((&player_health)[iVar8]._pad0 + 0x2ac) = fVar23, fVar23 <= 0.0)) {
    *(float *)((&player_health)[iVar8]._pad0 + 0x2ac) = frame_dt * 0.8;
  }
  if ((*(float *)((&player_health)[iVar8]._pad0 + 0x2ac) - frame_dt < 0.0) &&
     (0.0 <= *(float *)((&player_health)[iVar8]._pad0 + 0x2ac))) {
    *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2a8) =
         *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2a0);
  }
  local_38 = 1.0;
  if (((float)pos->vtable == local_28) && ((float)(&player_pos_y)[iVar8 * 0xd8] == local_24)) {
    iVar11 = perk_count_get(perk_id_stationary_reloader);
    if (iVar11 != 0) {
      local_38 = 3.0;
    }
  }
  else {
    ppVar7 = &player_health + iVar8;
    ppVar7->_pad0[0x7c] = '\0';
    ppVar7->_pad0[0x7d] = '\0';
    ppVar7->_pad0[0x7e] = '\0';
    ppVar7->_pad0[0x7f] = '\0';
    ppVar7 = &player_health + iVar8;
    ppVar7->_pad0[0x80] = '\0';
    ppVar7->_pad0[0x81] = '\0';
    ppVar7->_pad0[0x82] = '\0';
    ppVar7->_pad0[0x83] = '\0';
  }
  iVar11 = perk_count_get(perk_id_angry_reloader);
  if (((iVar11 == 0) || (*(float *)((&player_health)[iVar8]._pad0 + 0x2b4) <= 0.5)) ||
     (fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x2b4) * 0.5,
     *(float *)((&player_health)[iVar8]._pad0 + 0x2ac) <= fVar23)) {
    *(float *)((&player_health)[iVar8]._pad0 + 0x2ac) =
         *(float *)((&player_health)[iVar8]._pad0 + 0x2ac) - local_38 * frame_dt;
  }
  else {
    fVar2 = *(float *)((&player_health)[iVar8]._pad0 + 0x2ac) - local_38 * frame_dt;
    *(float *)((&player_health)[iVar8]._pad0 + 0x2ac) = fVar2;
    if (fVar2 <= fVar23) {
      bonus_spawn_guard = 1;
      if (*(float *)((int)cv_friendlyFire + 0xc) == 0.0) {
        local_38 = -NAN;
      }
      else {
        local_38 = (float)(-1 - render_overlay_player_index);
      }
      lVar19 = __ftol();
      pfVar13 = (float *)(7 - (int)lVar19);
      local_3c = 0;
      local_30 = pfVar13;
      if (0 < (int)pfVar13) {
        local_30 = (float *)(6.2831855 / (float)(int)pfVar13);
        do {
          projectile_spawn((float *)pos,(float)local_3c * (float)local_30 + 0.1,0xb,(int)local_38);
          local_3c = local_3c + 1;
        } while (local_3c < (int)pfVar13);
      }
      bonus_spawn_guard = 0;
      sfx_play_panned(sfx_explosion_small);
    }
  }
  if (*(float *)((&player_health)[iVar8]._pad0 + 0x2ac) < 0.0) {
    ppVar7 = &player_health + iVar8;
    ppVar7->_pad0[0x2ac] = '\0';
    ppVar7->_pad0[0x2ad] = '\0';
    ppVar7->_pad0[0x2ae] = '\0';
    ppVar7->_pad0[0x2af] = '\0';
  }
  if ((((demo_mode_active == '\0') &&
       (iVar11 = perk_count_get(perk_id_alternate_weapon), iVar11 == 0)) &&
      ((*(int *)(config_blob.reserved0 + render_overlay_player_index * 4 + 0x1c) != 4 &&
       ((iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                            ((IGrim2D *)config_blob.key_reload,(int)unaff_EBP), (char)iVar11 != '\0'
        && (*(float *)((&player_health)[iVar8]._pad0 + 0x2ac) == 0.0)))))) &&
     (config_blob.reserved0._20_4_ == 1)) {
    unaff_EBP = (uchar *)0x41527e;
    player_start_reload();
  }
  if ((demo_mode_active == '\0') &&
     (iVar11 = *(int *)(config_blob.reserved0 + render_overlay_player_index * 4 + 0x44), iVar11 != 5
     )) {
    if (iVar11 == 0) {
      local_14 = (float *)((float)(&DAT_004871f8)[render_overlay_player_index * 2] -
                          _camera_offset_y);
      local_18.vtable =
           (IGrim2D_vtbl *)
           ((float)(&DAT_004871f4)[render_overlay_player_index * 2] - _camera_offset_x);
      *(IGrim2D_vtbl **)((&player_health)[iVar8]._pad0 + 0x2c) = local_18.vtable;
      *(float **)((&player_health)[iVar8]._pad0 + 0x30) = local_14;
    }
    else {
      if (iVar11 != 4) {
        if (iVar11 == 3) {
          fVar17 = (float10)(float)(&DAT_004871f8)[render_overlay_player_index * 2] - (float10)200.0
          ;
          local_20 = (IGrim2D_vtbl *)
                     ((float)(&DAT_004871f4)[render_overlay_player_index * 2] - 200.0);
          local_1c = (float *)(float)fVar17;
          if (((float)local_20 != 0.0) || (fVar17 != (float10)0.0)) {
            fVar17 = (float10)fpatan(fVar17,(float10)(float)local_20);
            *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) = (float)(fVar17 + (float10)1.5707964)
            ;
            fVar17 = (fVar17 + (float10)1.5707964) - (float10)1.5707964;
            local_30 = (float *)(float)fVar17;
            fVar17 = (float10)fcos(fVar17);
            fVar18 = (float10)fsin((float10)(float)local_30);
            local_c.vtable = (IGrim2D_vtbl *)(float)fVar18;
            local_14 = (float *)((float)local_c.vtable * 60.0 + (float)(&player_pos_y)[iVar8 * 0xd8]
                                );
            local_18.vtable =
                 (IGrim2D_vtbl *)(float)(fVar17 * (float10)60.0 + (float10)(float)pos->vtable);
            *(IGrim2D_vtbl **)((&player_health)[iVar8]._pad0 + 0x2c) = local_18.vtable;
            *(float **)((&player_health)[iVar8]._pad0 + 0x30) = local_14;
          }
          if (30.0 < SQRT((float)local_20 * (float)local_20 + (float)local_1c * (float)local_1c)) {
            thunk_FUN_00452f1d();
            iVar11 = render_overlay_player_index;
            local_14 = (float *)(local_24 * 30.0);
            local_20 = (IGrim2D_vtbl *)(local_28 * 30.0 + 200.0);
            local_1c = (float *)((float)local_14 + 200.0);
            (&DAT_004871f4)[render_overlay_player_index * 2] = local_20;
            (&DAT_004871f8)[iVar11 * 2] = local_1c;
          }
        }
        else if (iVar11 == 1) {
          if ((*(int *)(config_blob.reserved0 + render_overlay_player_index * 4 + 0x1c) == 1) ||
             (*(int *)(config_blob.reserved0 + render_overlay_player_index * 4 + 0x1c) == 2)) {
            iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                               ((IGrim2D *)(&player_health)[iVar8].input.aim_key_right,
                                (int)unaff_EBP);
            if ((char)iVar11 != '\0') {
              *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) =
                   frame_dt * 3.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x2dc);
            }
            unaff_EBP = (uchar *)(&player_health)[iVar8].input.aim_key_left;
            iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                               ((IGrim2D *)unaff_EBP,(int)unaff_EDI);
            if ((char)iVar11 != '\0') {
              *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) =
                   *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) - frame_dt * 3.0;
            }
            fVar17 = (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x2dc) - (float10)1.5707964
            ;
            local_28 = (float)fVar17;
            fVar17 = (float10)fcos(fVar17);
            fVar18 = (float10)fsin((float10)local_28);
            fStack_4 = (float)fVar18;
            local_c.vtable =
                 (IGrim2D_vtbl *)(fStack_4 * 60.0 + (float)(&player_pos_y)[iVar8 * 0xd8]);
            local_10.vtable =
                 (IGrim2D_vtbl *)(float)(fVar17 * (float10)60.0 + (float10)(float)pos->vtable);
            *(IGrim2D_vtbl **)((&player_health)[iVar8]._pad0 + 0x2c) = local_10.vtable;
            *(IGrim2D_vtbl **)((&player_health)[iVar8]._pad0 + 0x30) = local_c.vtable;
          }
        }
        else {
          bVar9 = FUN_0041e8d0();
          if (bVar9) {
            *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) =
                 *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) - frame_dt * 4.0;
          }
          bVar9 = FUN_0041e8f0();
          if (bVar9) {
            *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) =
                 frame_dt * 4.0 + *(float *)((&player_health)[iVar8]._pad0 + 0x2dc);
          }
          fVar17 = (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x2dc) - (float10)1.5707964;
          local_30 = (float *)(float)fVar17;
          fVar17 = (float10)fcos(fVar17);
          fVar18 = (float10)fsin((float10)(float)local_30);
          local_c.vtable = (IGrim2D_vtbl *)(float)fVar18;
          local_14 = (float *)((float)local_c.vtable * 60.0 + (float)(&player_pos_y)[iVar8 * 0xd8]);
          local_18.vtable =
               (IGrim2D_vtbl *)(float)(fVar17 * (float10)60.0 + (float10)(float)pos->vtable);
          *(IGrim2D_vtbl **)((&player_health)[iVar8]._pad0 + 0x2c) = local_18.vtable;
          *(float **)((&player_health)[iVar8]._pad0 + 0x30) = local_14;
        }
        goto LAB_0041572e;
      }
      (*grim_interface_ptr->vtable->grim_get_config_float)
                ((IGrim2D *)(&player_health)[iVar8].input.axis_aim_y,(int)unaff_EBP);
      local_34 = (uchar *)(float)extraout_ST0_01;
      (*grim_interface_ptr->vtable->grim_get_config_float)
                ((IGrim2D *)(&player_health)[iVar8].input.axis_aim_x,(int)unaff_EDI);
      local_18.vtable = (IGrim2D_vtbl *)(float)extraout_ST0_02;
      local_14 = local_30;
      local_30 = (float *)SQRT((float)local_30 * (float)local_30 +
                               (float)local_18.vtable * (float)local_18.vtable);
      if (1.0 < (float)local_30) {
        local_30 = (float *)0x3f800000;
      }
      unaff_EDI = &local_18;
      unaff_EBP = (uchar *)&local_18;
      thunk_FUN_00452f1d();
      fVar23 = local_38 * *(float *)((int)cv_padAimDistMul + 0xc) + 42.0;
      local_10.vtable = (IGrim2D_vtbl *)(fVar23 * local_20);
      local_14 = (float *)(fVar23 * (float)local_1c + (float)(&player_pos_y)[iVar8 * 0xd8]);
      local_18.vtable = (IGrim2D_vtbl *)((float)local_10.vtable + pos->vtable);
      *(IGrim2D_vtbl **)((&player_health)[iVar8]._pad0 + 0x2c) = local_18.vtable;
      *(float **)((&player_health)[iVar8]._pad0 + 0x30) = local_14;
    }
    fVar17 = (float10)fpatan((float10)(float)(&player_pos_y)[iVar8 * 0xd8] -
                             (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x30),
                             (float10)(float)pos->vtable -
                             (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x2c));
    *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) = (float)(fVar17 - (float10)1.5707964);
  }
  else {
    puVar21 = (&player_health)[iVar8]._pad0 + 0x2c;
    local_1c = (float *)((&creature_pool)[*(int *)((&player_health)[iVar8]._pad0 + 0x2fc)].pos_y -
                        *(float *)((&player_health)[iVar8]._pad0 + 0x30));
    local_20 = (IGrim2D_vtbl *)
               ((&creature_pool)[*(int *)((&player_health)[iVar8]._pad0 + 0x2fc)].pos_x -
               *(float *)puVar21);
    local_38 = SQRT((float)local_1c * (float)local_1c + (float)local_20 * (float)local_20);
    if (4.0 <= local_38) {
      thunk_FUN_00452f1d();
      fVar23 = local_40 * 6.0 * frame_dt;
      local_18.vtable = (IGrim2D_vtbl *)(local_28 * fVar23);
      *(float *)puVar21 = (float)local_18.vtable + *(float *)puVar21;
      *(float *)((&player_health)[iVar8]._pad0 + 0x30) =
           fVar23 * local_24 + *(float *)((&player_health)[iVar8]._pad0 + 0x30);
    }
    else {
      iVar11 = *(int *)((&player_health)[iVar8]._pad0 + 0x2fc);
      *(float *)puVar21 = (&creature_pool)[iVar11].pos_x;
      *(float *)((&player_health)[iVar8]._pad0 + 0x30) = (&creature_pool)[iVar11].pos_y;
    }
  }
LAB_0041572e:
  fVar17 = (float10)fpatan((float10)(float)(&player_pos_y)[iVar8 * 0xd8] -
                           (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x30),
                           (float10)(float)pos->vtable -
                           (float10)*(float *)((&player_health)[iVar8]._pad0 + 0x2c));
  puVar21 = (&player_health)[iVar8]._pad0 + 0x2b0;
  bVar9 = false;
  bVar6 = false;
  *(float *)((&player_health)[iVar8]._pad0 + 0x2dc) = (float)(fVar17 - (float10)1.5707964);
  if ((*(float *)puVar21 <= 0.0) && (*(float *)((&player_health)[iVar8]._pad0 + 0x2ac) == 0.0)) {
    bVar9 = true;
    (&player_health)[iVar8]._pad0[0x2a4] = '\0';
  }
  if (((*(float *)puVar21 <= 0.0) && (0 < *(int *)((&player_health)[iVar8]._pad0 + 0x88))) &&
     ((iVar11 = perk_count_get(perk_id_regression_bullets), iVar11 != 0 ||
      (iVar11 = perk_count_get(perk_id_ammunition_within), iVar11 != 0)))) {
    bVar6 = true;
  }
  iVar11 = perk_count_get(perk_id_alternate_weapon);
  if (iVar11 != 0) {
    if (((DAT_0048719c < 1) || (DAT_0048719c = DAT_0048719c - frame_dt_ms, DAT_0048719c < 1)) &&
       (iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                           ((IGrim2D *)config_blob.key_reload,(int)unaff_EBP), (char)iVar11 != '\0')
       ) {
      iVar11 = *(int *)((&player_health)[iVar8]._pad0 + 0x2b8);
      *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2b8) =
           *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x29c);
      unaff_EBP = (uchar *)0x3f800000;
      *(int *)((&player_health)[iVar8]._pad0 + 0x29c) = iVar11;
      uVar1 = *(undefined4 *)((&player_health)[iVar8]._pad0 + 700);
      *(undefined4 *)((&player_health)[iVar8]._pad0 + 700) =
           *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2a0);
      *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2a0) = uVar1;
      uVar3 = (&player_health)[iVar8]._pad0[0x2c0];
      (&player_health)[iVar8]._pad0[0x2c0] = (&player_health)[iVar8]._pad0[0x2a4];
      (&player_health)[iVar8]._pad0[0x2a4] = uVar3;
      uVar1 = *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2c4);
      *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2c4) =
           *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2a8);
      *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2a8) = uVar1;
      uVar1 = *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2c8);
      *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2c8) =
           *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2ac);
      *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2ac) = uVar1;
      fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x2cc);
      *(float *)((&player_health)[iVar8]._pad0 + 0x2cc) = *(float *)puVar21;
      *(float *)puVar21 = fVar23;
      uVar1 = *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2d0);
      *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2d0) =
           *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2b4);
      *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2b4) = uVar1;
      sfx_play_panned((float)(&weapon_table)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c)].
                             reload_sfx_id);
      *(float *)puVar21 = *(float *)puVar21 + 0.1;
      DAT_0048719c = 200;
    }
    else {
      iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                         ((IGrim2D *)config_blob.key_reload,(int)unaff_EBP);
      if ((char)iVar11 == '\0') {
        DAT_0048719c = 0;
      }
    }
  }
  if (((!bVar9) && (!bVar6)) ||
     ((iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)
                          ((IGrim2D *)(&player_health)[iVar8].input.fire_key,(int)unaff_EBP),
      (char)iVar11 == '\0' && (local_44._3_1_ == '\0')))) goto LAB_0041753e;
  survival_reward_fire_seen = 1;
  if (!bVar9) {
    iVar11 = perk_count_get(perk_id_regression_bullets);
    if (iVar11 == 0) {
      iVar11 = perk_count_get(perk_id_ammunition_within);
      if (iVar11 != 0) {
        if ((&weapon_ammo_class)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c) * 0x1f] == 1) {
          fVar23 = 0.15;
        }
        else {
          fVar23 = 1.0;
        }
        player_take_damage(render_overlay_player_index,fVar23);
      }
    }
    else if ((&weapon_ammo_class)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c) * 0x1f] == 1) {
      lVar19 = __ftol();
      *(int *)((&player_health)[iVar8]._pad0 + 0x88) = (int)lVar19;
    }
    else {
      lVar19 = __ftol();
      *(int *)((&player_health)[iVar8]._pad0 + 0x88) = (int)lVar19;
    }
    if (*(int *)((&player_health)[iVar8]._pad0 + 0x88) < 0) {
      ppVar7 = &player_health + iVar8;
      ppVar7->_pad0[0x88] = '\0';
      ppVar7->_pad0[0x89] = '\0';
      ppVar7->_pad0[0x8a] = '\0';
      ppVar7->_pad0[0x8b] = '\0';
    }
  }
  fVar23 = (float)((float10)local_38 - (float10)1.5707964);
  fVar17 = ((float10)local_38 - (float10)1.5707964) - (float10)0.150915;
  fVar18 = (float10)fcos(fVar17);
  local_1c = (float *)(float)(fVar18 * (float10)16.0);
  fVar17 = (float10)fsin(fVar17);
  local_18.vtable = (IGrim2D_vtbl *)(float)(fVar17 * (float10)16.0);
  if (((&weapon_table)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c)].flags & 1) != 0) {
    uVar10 = crt_rand();
    pfStack_2c = (float *)(uVar10 & 0x3f);
    fVar2 = (float)(int)pfStack_2c * 0.01 + local_38;
    uVar10 = crt_rand();
    pfStack_2c = (float *)(uVar10 & 0x3f);
    local_c.vtable = (IGrim2D_vtbl *)0x3f800000;
    fStack_8 = 1.0;
    fStack_4 = 1.0;
    _effect_template_color_r = 0x3f800000;
    _effect_template_flags = 0x1c5;
    fVar17 = (float10)(int)pfStack_2c * (float10)0.022727273 + (float10)1.0;
    fVar18 = (float10)fcos((float10)fVar2);
    _effect_template_color_g = 0x3f800000;
    _effect_template_color_b = 0x3f800000;
    _effect_template_color_a = 0x3f19999a;
    _effect_template_lifetime = 0x3e19999a;
    _effect_template_age = 0;
    local_14 = (float *)(float)(fVar18 * fVar17);
    fVar18 = (float10)fsin((float10)fVar2);
    local_10.vtable = (IGrim2D_vtbl *)(float)(fVar18 * fVar17);
    uVar10 = crt_rand();
    _effect_template_half_height = 0x40000000;
    pfStack_2c = (float *)((uVar10 & 0x3f) - 0x20);
    _effect_template_half_width = 0x40000000;
    _effect_template_rotation = (float)(int)pfStack_2c * 0.1;
    effect_template_vel_x = (float)local_14 * 100.0;
    effect_template_vel_y = (float)local_10.vtable * 100.0;
    iVar11 = crt_rand();
    _effect_template_scale_step = 0;
    pfStack_2c = (float *)(iVar11 % 0x14);
    _effect_template_rotation_step = ((float)(int)pfStack_2c * 0.1 - 1.0) * 14.0;
    fStack_8 = (float)local_18.vtable + (float)(&player_pos_y)[iVar8 * 0xd8];
    local_c.vtable = (IGrim2D_vtbl *)((float)local_1c + pos->vtable);
    effect_spawn(0x12,(float *)&local_c);
  }
  if (1.0 < *local_30) {
    *local_30 = 1.0;
  }
  iVar11 = render_overlay_player_index;
  local_34 = (uchar *)0x3f800000;
  if (*(float *)((int)cv_friendlyFire + 0xc) == 0.0) {
    iVar20 = -100;
  }
  else {
    iVar20 = -1 - render_overlay_player_index;
  }
  local_10.vtable = *(IGrim2D_vtbl **)((&player_health)[render_overlay_player_index]._pad0 + 0x30);
  local_14 = *(float **)((&player_health)[render_overlay_player_index]._pad0 + 0x2c);
  fStack_8 = (float)local_10.vtable - (float)(&player_pos_y)[render_overlay_player_index * 0xd8];
  local_c.vtable =
       (IGrim2D_vtbl *)
       ((float)local_14 - (float)(&player_pos_x)[render_overlay_player_index * 0xd8]);
  fVar17 = FUN_00417660((float *)&local_c);
  local_24 = (float)(fVar17 * (float10)0.5);
  uVar10 = crt_rand();
  pfStack_2c = (float *)(uVar10 & 0x1ff);
  fVar2 = (float)(int)pfStack_2c;
  uVar10 = crt_rand();
  pfStack_2c = (float *)(uVar10 & 0x1ff);
  fVar17 = (float10)local_24 * (float10)*(float *)((&player_health)[iVar11]._pad0 + 0x294) *
           (float10)(int)pfStack_2c * (float10)0.001953125;
  fVar18 = (float10)fcos((float10)(fVar2 * 0.012271847));
  local_14 = (float *)(float)(fVar18 * fVar17 + (float10)(float)local_14);
  fVar18 = (float10)fsin((float10)(fVar2 * 0.012271847));
  fpatan((float10)(float)(&player_pos_y)[iVar11 * 0xd8] -
         (fVar18 * fVar17 + (float10)(float)local_10.vtable),
         (float10)(float)(&player_pos_x)[iVar11 * 0xd8] - (float10)(float)local_14);
  iVar11 = (*grim_interface_ptr->vtable->grim_is_key_active)((IGrim2D *)0x22,(int)unaff_EDI);
  if ((char)iVar11 != '\0') {
    ppVar7 = &player_health + iVar8;
    ppVar7->_pad0[0x2f8] = '\0';
    ppVar7->_pad0[0x2f9] = '\0';
    ppVar7->_pad0[0x2fa] = ' ';
    ppVar7->_pad0[0x2fb] = 'A';
  }
  if (*(float *)((&player_health)[iVar8]._pad0 + 0x2f8) <= 0.0) {
    *(float *)((&player_health)[iVar8]._pad0 + 0x2b0) =
         (&weapon_table)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c)].shot_cooldown;
    *pfStack_2c = (&weapon_table)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c)].spread_heat +
                  *pfStack_2c;
    iVar11 = *(int *)((&player_health)[iVar8]._pad0 + 0x29c);
    iVar12 = crt_rand();
    sfx_play_panned((float)(iVar12 % (&weapon_table)[iVar11].shot_sfx_variant_count +
                           (&weapon_table)[iVar11].shot_sfx_base_id));
    iVar11 = *(int *)((&player_health)[iVar8]._pad0 + 0x29c);
    if (iVar11 == 0x18) {
      fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
      fStack_8 = (float)local_18.vtable + (float)pos->vtable;
      projectile_spawn(&fStack_8,fVar23,0x18,iVar20);
      fVar17 = (float10)fcos((float10)1.0);
      fStack_8 = (float)(fVar17 * (float10)25.0);
      fVar18 = (float10)fsin((float10)1.0);
      fStack_4 = (float)(fVar18 * (float10)25.0);
      local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
      local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
      iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
      (&sprite_effect_pool)[iVar16].color_r = 0.5;
      (&sprite_effect_pool)[iVar16].color_g = 0.5;
      (&sprite_effect_pool)[iVar16].color_b = 0.5;
      (&sprite_effect_pool)[iVar16].color_a = 0.23;
      local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
      local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
LAB_0041600e:
      local_34 = (uchar *)(float)fVar18;
      local_38 = (float)fVar17;
      fStack_4 = (float)local_34 * 15.0;
      fStack_8 = local_38 * 15.0;
      iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,2.0);
      (&sprite_effect_pool)[iVar16].color_r = 0.5;
      (&sprite_effect_pool)[iVar16].color_g = 0.5;
      (&sprite_effect_pool)[iVar16].color_b = 0.5;
      (&sprite_effect_pool)[iVar16].color_a = 0.213;
    }
    else {
      if (iVar11 == 1) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,1,iVar20);
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)25.0);
        fVar18 = (float10)fsin((float10)1.0);
        fStack_4 = (float)(fVar18 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.23;
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        goto LAB_0041600e;
      }
      if (iVar11 == 2) {
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)25.0);
        fVar18 = (float10)fsin((float10)1.0);
        local_34 = (uchar *)(float)fVar18;
        fStack_4 = (float)(fVar18 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
        fStack_8 = (float)fVar17 * 15.0;
        fStack_4 = (float)local_34 * 15.0;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.23;
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,2.0);
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.213;
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,2,iVar20);
      }
      else if (iVar11 == 3) {
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)25.0);
        fVar18 = (float10)fsin((float10)1.0);
        fStack_4 = (float)(fVar18 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
        fStack_8 = (float)fVar17 * 15.0;
        fStack_4 = (float)fVar18 * 15.0;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.25;
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,2.0);
        local_34 = (uchar *)0xc;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.223;
        do {
          iVar12 = 3;
          fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
          fStack_8 = (float)local_18.vtable + (float)pos->vtable;
          iVar16 = iVar20;
          iVar11 = crt_rand();
          local_20 = (IGrim2D_vtbl *)(iVar11 % 200 + -100);
          iVar16 = projectile_spawn(&fStack_8,(float)(int)local_20 * 0.0013 + fVar23,iVar12,iVar16);
          iVar11 = crt_rand();
          local_20 = (IGrim2D_vtbl *)(iVar11 % 100);
          local_34 = (uchar *)((int)local_34 + -1);
          (&projectile_pool)[iVar16].speed_scale = (float)(int)local_20 * 0.01 + 1.0;
        } while (local_34 != (uchar *)0x0);
        local_34 = (uchar *)0x0;
      }
      else if (iVar11 == 0x14) {
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)15.0);
        fVar17 = (float10)fsin((float10)1.0);
        fStack_4 = (float)(fVar17 * (float10)15.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,2.0);
        local_34 = (uchar *)0x4;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.223;
        do {
          iVar12 = 3;
          fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
          fStack_8 = (float)local_18.vtable + (float)pos->vtable;
          iVar16 = iVar20;
          iVar11 = crt_rand();
          local_20 = (IGrim2D_vtbl *)(iVar11 % 200 + -100);
          iVar16 = projectile_spawn(&fStack_8,(float)(int)local_20 * 0.0013 + fVar23,iVar12,iVar16);
          iVar11 = crt_rand();
          local_20 = (IGrim2D_vtbl *)(iVar11 % 100);
          local_34 = (uchar *)((int)local_34 + -1);
          (&projectile_pool)[iVar16].speed_scale = (float)(int)local_20 * 0.01 + 1.0;
        } while (local_34 != (uchar *)0x0);
        local_34 = (uchar *)0x0;
      }
      else if (iVar11 == 4) {
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)25.0);
        fVar18 = (float10)fsin((float10)1.0);
        fStack_4 = (float)(fVar18 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
        fStack_8 = (float)fVar17 * 15.0;
        fStack_4 = (float)fVar18 * 15.0;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.26;
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,2.0);
        local_34 = (uchar *)0xc;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.233;
        do {
          iVar12 = 3;
          fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
          fStack_8 = (float)local_18.vtable + (float)pos->vtable;
          iVar16 = iVar20;
          iVar11 = crt_rand();
          local_20 = (IGrim2D_vtbl *)(iVar11 % 200 + -100);
          iVar16 = projectile_spawn(&fStack_8,(float)(int)local_20 * 0.004 + fVar23,iVar12,iVar16);
          iVar11 = crt_rand();
          local_20 = (IGrim2D_vtbl *)(iVar11 % 100);
          local_34 = (uchar *)((int)local_34 + -1);
          (&projectile_pool)[iVar16].speed_scale = (float)(int)local_20 * 0.01 + 1.0;
        } while (local_34 != (uchar *)0x0);
        local_34 = (uchar *)0x0;
      }
      else if (iVar11 == 8) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        fx_spawn_particle(&fStack_8,local_38,&player_move_dx + iVar16,1.0);
        local_30 = (float *)0x3dcccccd;
      }
      else if (iVar11 == 0x10) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        iVar16 = fx_spawn_particle(&fStack_8,local_38,&player_move_dx + iVar16,1.0);
        if (iVar16 != -1) {
          *(undefined1 *)&(&particle_pool)[iVar16].style_id = 2;
        }
        local_30 = (float *)0x3dcccccd;
      }
      else if (iVar11 == 0xf) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        iVar16 = fx_spawn_particle(&fStack_8,local_38,&player_move_dx + iVar16,1.0);
        if (iVar16 != -1) {
          *(undefined1 *)&(&particle_pool)[iVar16].style_id = 1;
        }
        local_30 = (float *)0x3d4ccccd;
      }
      else if (iVar11 == 5) {
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)25.0);
        fVar18 = (float10)fsin((float10)1.0);
        local_34 = (uchar *)(float)fVar18;
        fStack_4 = (float)(fVar18 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
        fStack_8 = (float)fVar17 * 15.0;
        fStack_4 = (float)local_34 * 15.0;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.23;
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,2.0);
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.213;
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,5,iVar20);
      }
      else if (iVar11 == 9) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,9,iVar20);
      }
      else if (iVar11 == 10) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23 - 0.31415927,9,iVar20);
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23 - 0.5235988,0xb,iVar20);
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,9,iVar20);
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23 + 0.5235988,0xb,iVar20);
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23 + 0.31415927,9,iVar20);
      }
      else if (iVar11 == 0x13) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,0x13,iVar20);
      }
      else if (iVar11 == 0x19) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,0x19,iVar20);
      }
      else if (iVar11 == 0x1d) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,0x1d,iVar20);
      }
      else if (iVar11 == 0x15) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,0x15,iVar20);
      }
      else if (iVar11 == 0x16) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,0x16,iVar20);
      }
      else if (iVar11 == 0x17) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,0x17,iVar20);
      }
      else if (iVar11 == 0x1c) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,0x1c,iVar20);
      }
      else if (iVar11 == 0x1f) {
        local_34 = (uchar *)0x8;
        do {
          iVar12 = 0x16;
          fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
          fStack_8 = (float)local_18.vtable + (float)pos->vtable;
          iVar16 = iVar20;
          iVar11 = crt_rand();
          local_20 = (IGrim2D_vtbl *)(iVar11 % 200 + -100);
          iVar16 = projectile_spawn(&fStack_8,(float)(int)local_20 * 0.0026 + fVar23,iVar12,iVar16);
          iVar11 = crt_rand();
          local_20 = (IGrim2D_vtbl *)(iVar11 % 0x50);
          local_34 = (uchar *)((int)local_34 + -1);
          (&projectile_pool)[iVar16].speed_scale = (float)(int)local_20 * 0.01 + 1.4;
        } while (local_34 != (uchar *)0x0);
        local_34 = (uchar *)0x0;
      }
      else if (iVar11 == 0xb) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,0xb,iVar20);
      }
      else if (iVar11 == 0x1e) {
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)25.0);
        fVar18 = (float10)fsin((float10)1.0);
        fStack_4 = (float)(fVar18 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
        fStack_8 = (float)fVar17 * 15.0;
        fStack_4 = (float)fVar18 * 15.0;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.33;
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,2.0);
        local_34 = (uchar *)0x6;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.263;
        do {
          iVar12 = 6;
          fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
          fStack_8 = (float)local_18.vtable + (float)pos->vtable;
          iVar16 = iVar20;
          iVar11 = crt_rand();
          local_20 = (IGrim2D_vtbl *)(iVar11 % 200 + -100);
          iVar16 = projectile_spawn(&fStack_8,(float)(int)local_20 * 0.002 + fVar23,iVar12,iVar16);
          iVar11 = crt_rand();
          local_20 = (IGrim2D_vtbl *)(iVar11 % 0x50);
          local_34 = (uchar *)((int)local_34 + -1);
          (&projectile_pool)[iVar16].speed_scale = (float)(int)local_20 * 0.01 + 1.4;
        } while (local_34 != (uchar *)0x0);
        local_34 = (uchar *)0x0;
      }
      else if (iVar11 == 6) {
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)25.0);
        fVar18 = (float10)fsin((float10)1.0);
        local_34 = (uchar *)(float)fVar18;
        fStack_4 = (float)(fVar18 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
        fStack_8 = (float)fVar17 * 15.0;
        fStack_4 = (float)local_34 * 15.0;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.33;
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,2.0);
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.263;
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,6,iVar20);
      }
      else if (iVar11 == 0xc) {
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)25.0);
        fVar18 = (float10)fsin((float10)1.0);
        local_34 = (uchar *)(float)fVar18;
        fStack_4 = (float)(fVar18 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
        fStack_8 = (float)fVar17 * 15.0;
        fStack_4 = (float)local_34 * 15.0;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.34;
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,2.0);
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.283;
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        fx_spawn_secondary_projectile(&fStack_8,fVar23,1);
      }
      else if (iVar11 == 0x11) {
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)25.0);
        fVar18 = (float10)fsin((float10)1.0);
        fStack_4 = (float)(fVar18 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
        fStack_8 = (float)fVar17 * 15.0;
        fStack_4 = (float)fVar18 * 15.0;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.34;
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,2.0);
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.283;
        fVar2 = *(float *)((&player_health)[iVar8]._pad0 + 0x2a8) * 1.0471976;
        pIVar15 = (IGrim2D_vtbl *)0x0;
        local_34 = (uchar *)((fVar23 - 3.1415927) -
                            fVar2 * *(float *)((&player_health)[iVar8]._pad0 + 0x2a8) * 0.5);
        if (0.0 < *(float *)((&player_health)[iVar8]._pad0 + 0x2a8)) {
          do {
            fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
            fStack_8 = (float)local_18.vtable + (float)pos->vtable;
            fx_spawn_secondary_projectile(&fStack_8,(float)local_34,2);
            local_34 = (uchar *)((float)local_34 + fVar2);
            pIVar15 = (IGrim2D_vtbl *)((int)&pIVar15->grim_release + 1);
            local_20 = pIVar15;
          } while ((float)(int)pIVar15 < *(float *)((&player_health)[iVar8]._pad0 + 0x2a8));
        }
        local_30 = *(float **)((&player_health)[iVar8]._pad0 + 0x2a8);
      }
      else if (iVar11 == 0x12) {
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)25.0);
        fVar17 = (float10)fsin((float10)1.0);
        fStack_4 = (float)(fVar17 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.34;
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        fx_spawn_secondary_projectile(&fStack_8,fVar23,4);
      }
      else if (iVar11 == 0xd) {
        fVar17 = (float10)fcos((float10)1.0);
        fStack_8 = (float)(fVar17 * (float10)25.0);
        fVar18 = (float10)fsin((float10)1.0);
        local_34 = (uchar *)(float)fVar18;
        fStack_4 = (float)(fVar18 * (float10)25.0);
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
        fStack_8 = (float)fVar17 * 15.0;
        fStack_4 = (float)local_34 * 15.0;
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.31;
        local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
        local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
        iVar16 = fx_spawn_sprite((float *)&local_10,&fStack_8,2.0);
        (&sprite_effect_pool)[iVar16].color_r = 0.5;
        (&sprite_effect_pool)[iVar16].color_g = 0.5;
        (&sprite_effect_pool)[iVar16].color_b = 0.5;
        (&sprite_effect_pool)[iVar16].color_a = 0.243;
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        fx_spawn_secondary_projectile(&fStack_8,fVar23,2);
      }
      else if (iVar11 == 7) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,1,iVar20);
      }
      else if (iVar11 == 0xe) {
        local_34 = (uchar *)0xe;
        do {
          iVar11 = 0xb;
          fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
          fStack_8 = (float)local_18.vtable + (float)pos->vtable;
          iVar16 = iVar20;
          uVar10 = crt_rand();
          local_20 = (IGrim2D_vtbl *)((uVar10 & 0xff) - 0x80);
          iVar16 = projectile_spawn(&fStack_8,(float)(int)local_20 * 0.002 + fVar23,iVar11,iVar16);
          iVar11 = crt_rand();
          local_20 = (IGrim2D_vtbl *)(iVar11 % 100);
          local_34 = (uchar *)((int)local_34 + -1);
          (&projectile_pool)[iVar16].speed_scale = (float)(int)local_20 * 0.01 + 1.0;
        } while (local_34 != (uchar *)0x0);
        local_34 = (uchar *)0x0;
      }
      else if (iVar11 == 0x29) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,0x29,iVar20);
      }
      else if (iVar11 == 0x2b) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,fVar23,0x2b,iVar20);
      }
      else if (iVar11 == 0x2a) {
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        fx_spawn_particle_slow(&fStack_8,fVar23 - 1.5707964);
        local_30 = (float *)0x3e19999a;
      }
    }
    iVar16 = perk_count_get(perk_id_sharpshooter);
    if (iVar16 == 0) {
      *(float *)((&player_health)[iVar8]._pad0 + 0x294) =
           (&weapon_table)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c)].spread_heat * 1.3 +
           *(float *)((&player_health)[iVar8]._pad0 + 0x294);
    }
    if (_bonus_reflex_boost_timer <= 0.0) {
      *(float *)((&player_health)[iVar8]._pad0 + 0x2a8) =
           *(float *)((&player_health)[iVar8]._pad0 + 0x2a8) - (float)local_30;
    }
  }
  else {
    sfx_play_panned(DAT_004d9050);
    sfx_play_panned(DAT_004d7fd8);
    if ((&weapon_table)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c)].pellet_count == 1) {
      *(undefined4 *)((&player_health)[iVar8]._pad0 + 0x2b0) = DAT_004d9040;
      fVar2 = _DAT_004d9048;
    }
    else {
      *(float *)((&player_health)[iVar8]._pad0 + 0x2b0) =
           (&weapon_table)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c)].shot_cooldown;
      fVar2 = (&weapon_table)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c)].spread_heat;
    }
    iVar16 = 0;
    *pfStack_2c = fVar2 + *pfStack_2c;
    if (0 < (&weapon_table)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c)].pellet_count) {
      do {
        iVar11 = crt_rand();
        local_20 = (IGrim2D_vtbl *)((float)(iVar11 % 200 + -100) * 0.0015 + fVar23);
        fStack_4 = (float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8];
        fStack_8 = (float)local_18.vtable + (float)pos->vtable;
        projectile_spawn(&fStack_8,(float)local_20,0x2d,iVar20);
        iVar16 = iVar16 + 1;
      } while (iVar16 < (&weapon_table)[*(int *)((&player_health)[iVar8]._pad0 + 0x29c)].
                        pellet_count);
    }
    fVar17 = (float10)fcos((float10)1.0);
    fStack_8 = (float)(fVar17 * (float10)25.0);
    fVar17 = (float10)fsin((float10)1.0);
    fStack_4 = (float)(fVar17 * (float10)25.0);
    local_c.vtable = (IGrim2D_vtbl *)((float)local_14 + (float)(&player_pos_y)[iVar8 * 0xd8]);
    local_10.vtable = (IGrim2D_vtbl *)(local_18.vtable + pos->vtable);
    iVar11 = fx_spawn_sprite((float *)&local_10,&fStack_8,1.0);
    iVar16 = perk_id_sharpshooter;
    (&sprite_effect_pool)[iVar11].color_r = 0.5;
    (&sprite_effect_pool)[iVar11].color_g = 0.5;
    (&sprite_effect_pool)[iVar11].color_b = 0.5;
    (&sprite_effect_pool)[iVar11].color_a = 0.413;
    iVar16 = perk_count_get(iVar16);
    if (iVar16 == 0) {
      *(float *)((&player_health)[iVar8]._pad0 + 0x294) =
           _DAT_004d9048 * 1.3 + *(float *)((&player_health)[iVar8]._pad0 + 0x294);
    }
  }
  if (0.48 < *(float *)((&player_health)[iVar8]._pad0 + 0x294)) {
    ppVar7 = &player_health + iVar8;
    ppVar7->_pad0[0x294] = 0x8f;
    ppVar7->_pad0[0x295] = 0xc2;
    ppVar7->_pad0[0x296] = 0xf5;
    ppVar7->_pad0[0x297] = '>';
  }
  if (0 < *(int *)(player_health._pad0 + perk_id_fastshot * 4 + 0x94)) {
    *(float *)((&player_health)[iVar8]._pad0 + 0x2b0) =
         *(float *)((&player_health)[iVar8]._pad0 + 0x2b0) * 0.88;
  }
  if (0 < *(int *)(player_health._pad0 + perk_id_sharpshooter * 4 + 0x94)) {
    *(float *)((&player_health)[iVar8]._pad0 + 0x2b0) =
         *(float *)((&player_health)[iVar8]._pad0 + 0x2b0) * 1.05;
  }
  if (*(float *)((&player_health)[iVar8]._pad0 + 0x2a8) <= 0.0) {
    player_start_reload();
  }
LAB_0041753e:
  fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x70);
  while (14.0 < fVar23) {
    fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x70) - 14.0;
    *(float *)((&player_health)[iVar8]._pad0 + 0x70) = fVar23;
  }
  fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x70);
  while (fVar23 < 0.0) {
    fVar23 = *(float *)((&player_health)[iVar8]._pad0 + 0x70) + 14.0;
    *(float *)((&player_health)[iVar8]._pad0 + 0x70) = fVar23;
  }
  if (0.0 < *(float *)((&player_health)[iVar8]._pad0 + 0x2f0)) {
    *(float *)((&player_health)[iVar8]._pad0 + 0x38) =
         *(float *)((&player_health)[iVar8]._pad0 + 0x38) - 1.0;
  }
  pIVar15 = (IGrim2D_vtbl *)(*(float *)((&player_health)[iVar8]._pad0 + 0x10) * 0.5);
  if ((float)pos->vtable < (float)pIVar15) {
    pos->vtable = pIVar15;
  }
  if ((float)terrain_texture_width - (float)pIVar15 < (float)pos->vtable) {
    pos->vtable = (IGrim2D_vtbl *)((float)terrain_texture_width - (float)pIVar15);
  }
  pfVar13 = (float *)(&player_pos_y + iVar8 * 0xd8);
  if ((float)(&player_pos_y)[iVar8 * 0xd8] < (float)pIVar15) {
    *pfVar13 = (float)pIVar15;
  }
  if ((float)terrain_texture_height - (float)pIVar15 < *pfVar13) {
    *pfVar13 = (float)terrain_texture_height - (float)pIVar15;
  }
  if (0.8 < (float)*(IGrim2D_vtbl **)local_34) {
    *(IGrim2D_vtbl **)local_34 = (IGrim2D_vtbl *)0x3f4ccccd;
  }
  return;
}



/* FUN_00417640 @ 00417640 */

/* [binja] float* __thiscall sub_417640(float* arg1, float* arg2, float* arg3) */

float * __thiscall FUN_00417640(void *this,float *arg1,float *arg2,float *arg3)

{
  float fVar1;
  float fVar2;
  
  fVar1 = *(float *)((int)this + 4);
  fVar2 = arg2[1];
  *arg1 = *(float *)this - *arg2;
  arg1[1] = fVar1 - fVar2;
  return arg1;
}



/* FUN_00417660 @ 00417660 */

float10 __cdecl FUN_00417660(float *param_1)

{
  return SQRT((float10)param_1[1] * (float10)param_1[1] + (float10)*param_1 * (float10)*param_1);
}



/* FUN_00417690 @ 00417690 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_417690() */

int FUN_00417690(void)

{
  undefined *puVar1;
  undefined4 *puVar2;
  int iVar3;
  
  puVar1 = &DAT_0048f808;
  iVar3 = 8;
  do {
    FUN_00417a90(puVar1);
    puVar1 = puVar1 + 0x1c;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  puVar1 = &DAT_0048f8f0;
  _DAT_0048f8ec = 4;
  iVar3 = 8;
  do {
    FUN_00417a90(puVar1);
    puVar1 = puVar1 + 0x1c;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  _DAT_0048f9d4 = 4;
  puVar1 = &DAT_0048f9d8;
  iVar3 = 8;
  do {
    FUN_00417a90(puVar1);
    puVar1 = puVar1 + 0x1c;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  _DAT_0048fabc = 4;
  puVar2 = &DAT_0048fac0;
  iVar3 = 8;
  do {
    FUN_00417a90(puVar2);
    puVar2 = puVar2 + 7;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  _DAT_0048fba4 = 4;
  puVar2 = &DAT_0048fba8;
  iVar3 = 8;
  do {
    FUN_00417a90(puVar2);
    puVar2 = puVar2 + 7;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  _DAT_0048fc8c = 4;
  puVar2 = &DAT_0048fc90;
  iVar3 = 8;
  do {
    FUN_00417a90(puVar2);
    puVar2 = puVar2 + 7;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  _DAT_0048fd74 = 4;
  FUN_004010f0(0x48fd78,0x1c,8,0x417a90);
  _DAT_0048fe5c = 4;
  FUN_004010f0(0x48fe60,0x1c,8,0x417a90);
  _DAT_0048ff44 = 4;
  FUN_004010f0(0x48ff48,0x1c,8,0x417a90);
  _DAT_0049002c = 4;
  FUN_004010f0(0x490030,0x1c,8,0x417a90);
  _DAT_00490114 = 4;
  FUN_004010f0(0x490118,0x1c,8,0x417a90);
  _DAT_004901fc = 4;
  iVar3 = FUN_004010f0(0x490200,0x1c,8,0x417a90);
  _DAT_004902e4 = 4;
  return iVar3;
}



/* FUN_00417a90 @ 00417a90 */

undefined4 __fastcall FUN_00417a90(undefined4 param_1)

{
  return param_1;
}



/* FUN_00417aa0 @ 00417aa0 */

/* [binja] void* __fastcall sub_417aa0(void* arg1) */

void * __fastcall FUN_00417aa0(void *arg1)

{
  *(undefined4 *)((int)arg1 + 0xe4) = 4;
  return arg1;
}



/* FUN_00417ab0 @ 00417ab0 */

/* [binja] char* __fastcall sub_417ab0(char* arg1) */

char * __fastcall FUN_00417ab0(char *arg1)

{
  arg1[0x120] = '\x04';
  arg1[0x121] = '\0';
  arg1[0x122] = '\0';
  arg1[0x123] = '\0';
  arg1[0x208] = '\x04';
  arg1[0x209] = '\0';
  arg1[0x20a] = '\0';
  arg1[0x20b] = '\0';
  arg1[0x2f0] = '\x04';
  arg1[0x2f1] = '\0';
  arg1[0x2f2] = '\0';
  arg1[0x2f3] = '\0';
  arg1[0x2f8] = '\0';
  arg1[0x2f9] = '\0';
  arg1[0x2fa] = '\0';
  arg1[0x2fb] = '\0';
  arg1[0x314] = '\0';
  arg1[0x38] = '\0';
  arg1[0x39] = '\0';
  arg1[0x3a] = '\0';
  arg1[0x3b] = '\0';
  arg1[0x34] = '\0';
  arg1[0x35] = '\0';
  arg1[0x36] = '\0';
  arg1[0x37] = '\0';
  *arg1 = '\0';
  return arg1;
}



/* ui_draw_textured_quad @ 00417ae0 */

/* binds a texture and draws a screen-space quad */

void ui_draw_textured_quad(int texture_id,int x,int y,int w,int h)

{
  int unaff_retaddr;
  float h_00;
  uint value;
  float w_00;
  
  (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)h,0,unaff_retaddr);
  h_00 = 1.0;
  value = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)texture_id);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,value);
  w_00 = (float)w;
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(float)texture_id,(float)x,(float)y,w_00,h_00);
  (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)texture_id);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,(uint)w_00);
  return;
}



/* terrain_generate @ 00417b80 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* generates terrain texture into a render target using a level descriptor */

void __cdecl terrain_generate(void *desc)

{
  IGrim2D_vtbl *pIVar1;
  IGrim2D_vtbl *pIVar2;
  IGrim2D *pIVar3;
  int iVar4;
  float unaff_EBX;
  IGrim2D *unaff_EBP;
  IGrim2D *unaff_ESI;
  int iVar5;
  float unaff_EDI;
  float in_stack_00000008;
  IGrim2D *in_stack_0000000c;
  int in_stack_00000010;
  IGrim2D in_stack_00000014;
  float in_stack_00000018;
  IGrim2D_vtbl *in_stack_0000001c;
  int in_stack_00000020;
  uint uVar6;
  float fVar7;
  uint uVar8;
  float a;
  uint value;
  undefined4 in_stack_ffffffcc;
  float a_00;
  IGrim2D *in_stack_ffffffd0;
  IGrim2D *in_stack_ffffffd4;
  float in_stack_ffffffd8;
  float fVar9;
  IGrim2D *pIVar10;
  IGrim2D *self;
  IGrim2D self_00;
  float in_stack_fffffff8;
  
  fVar9 = 1.0 / (float)config_blob.reserved0._112_4_;
  pIVar10 = (IGrim2D *)0x0;
  _camera_offset_x = 0;
  self_00.vtable = (IGrim2D_vtbl *)0x0;
  _camera_offset_y = 0;
  if (terrain_texture_failed != '\0') {
    terrain_render_target = (float)(&DAT_0048f548)[*(int *)((int)desc + 0x10)];
    return;
  }
  value = 0x12;
  a_00 = (float)CONCAT31((int3)((uint)in_stack_ffffffcc >> 8),1);
  (*grim_interface_ptr->vtable->grim_set_config_var)
            ((IGrim2D *)0x12,(uint)a_00,(uint)in_stack_ffffffd0);
  uVar8 = 0x13;
  a = 7.00649e-45;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,value);
  uVar6 = 0x14;
  fVar7 = 8.40779e-45;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar8);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,uVar6);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,fVar7);
  (*grim_interface_ptr->vtable->grim_set_render_target)((IGrim2D *)terrain_render_target,uVar8);
  (*grim_interface_ptr->vtable->grim_clear_color)((IGrim2D *)0x3e7cfcfd,0.21960784,0.09803922,1.0,a)
  ;
  self = pIVar10;
  (*grim_interface_ptr->vtable->grim_bind_texture)
            ((IGrim2D *)(&DAT_0048f548)[(int)pIVar10[4].vtable],0,value);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f333333,0.7,0.7,0.9,a_00);
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_ffffffd0);
  iVar5 = 0;
  iVar4 = terrain_texture_height * terrain_texture_width * 800;
  if (0 < (int)(iVar4 + (iVar4 >> 0x1f & 0x7ffffU)) >> 0x13) {
    pIVar3 = (IGrim2D *)((float)unaff_EBP * 128.0);
    do {
      pIVar1 = grim_interface_ptr->vtable;
      iVar4 = crt_rand();
      (*pIVar1->grim_set_rotation)
                ((IGrim2D *)((float)(iVar4 % 0x13a) * 0.01),(float)in_stack_ffffffd4);
      iVar4 = crt_rand();
      fVar9 = (float)(iVar4 % (terrain_texture_width + 0x80)) - 64.0;
      iVar4 = crt_rand();
      self_00.vtable =
           (IGrim2D_vtbl *)(((float)(iVar4 % (terrain_texture_width + 0x80)) - 64.0) * unaff_EBX);
      in_stack_fffffff8 = fVar9 * unaff_EBX;
      in_stack_ffffffd4 = pIVar3;
      (*grim_interface_ptr->vtable->grim_draw_quad_xy)
                ((IGrim2D *)&stack0xfffffff4,(float *)pIVar3,(float)pIVar3,in_stack_ffffffd8);
      iVar5 = iVar5 + 1;
      iVar4 = terrain_texture_height * terrain_texture_width * 800;
    } while (iVar5 < (int)(iVar4 + (iVar4 >> 0x1f & 0x7ffffU)) >> 0x13);
  }
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_ffffffd4);
  (*grim_interface_ptr->vtable->grim_bind_texture)
            ((IGrim2D *)(&DAT_0048f548)[(int)pIVar10[5].vtable],0,(int)in_stack_ffffffd8);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f333333,0.7,0.7,0.9,unaff_EDI);
  (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_ESI);
  iVar5 = 0;
  iVar4 = terrain_texture_height * terrain_texture_width * 0x23;
  if (0 < (int)(iVar4 + (iVar4 >> 0x1f & 0x7ffffU)) >> 0x13) {
    pIVar3 = (IGrim2D *)((float)self_00.vtable * 128.0);
    in_stack_0000000c = pIVar3;
    do {
      pIVar1 = grim_interface_ptr->vtable;
      iVar4 = crt_rand();
      in_stack_0000000c = (IGrim2D *)(iVar4 % 0x13a);
      (*pIVar1->grim_set_rotation)
                ((IGrim2D *)((float)(int)in_stack_0000000c * 0.01),(float)unaff_EBP);
      in_stack_00000010 = crt_rand();
      in_stack_00000010 = in_stack_00000010 % (terrain_texture_width + 0x80);
      fVar7 = (float)in_stack_00000010;
      in_stack_00000010 = crt_rand();
      in_stack_00000010 = in_stack_00000010 % (terrain_texture_width + 0x80);
      desc = (void *)(((float)in_stack_00000010 - 64.0) * in_stack_fffffff8);
      in_stack_00000008 = (fVar7 - 64.0) * in_stack_fffffff8;
      unaff_EBP = pIVar3;
      (*grim_interface_ptr->vtable->grim_draw_quad_xy)
                ((IGrim2D *)&desc,(float *)pIVar3,(float)pIVar3,unaff_EBX);
      iVar5 = iVar5 + 1;
      iVar4 = terrain_texture_height * terrain_texture_width * 0x23;
    } while (iVar5 < (int)(iVar4 + (iVar4 >> 0x1f & 0x7ffffU)) >> 0x13);
  }
  (*grim_interface_ptr->vtable->grim_end_batch)(unaff_EBP);
  (*grim_interface_ptr->vtable->grim_bind_texture)
            ((IGrim2D *)(&DAT_0048f548)[(int)pIVar10[6].vtable],0,(int)unaff_EBX);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f333333,0.7,0.7,0.6,fVar9);
  pIVar10 = (IGrim2D *)0x417fa5;
  (*grim_interface_ptr->vtable->grim_begin_batch)(self);
  iVar5 = 0;
  iVar4 = terrain_texture_height * terrain_texture_width * 0xf;
  if (0 < (int)(iVar4 + (iVar4 >> 0x1f & 0x7ffffU)) >> 0x13) {
    pIVar1 = (IGrim2D_vtbl *)((float)desc * 128.0);
    in_stack_0000001c = pIVar1;
    do {
      pIVar2 = grim_interface_ptr->vtable;
      iVar4 = crt_rand();
      in_stack_0000001c = (IGrim2D_vtbl *)(iVar4 % 0x13a);
      (*pIVar2->grim_set_rotation)
                ((IGrim2D *)((float)(int)in_stack_0000001c * 0.01),(float)self_00.vtable);
      in_stack_00000020 = crt_rand();
      in_stack_00000020 = in_stack_00000020 % (terrain_texture_width + 0x80);
      in_stack_0000000c = (IGrim2D *)((float)in_stack_00000020 - 64.0);
      in_stack_00000020 = crt_rand();
      in_stack_00000020 = in_stack_00000020 % (terrain_texture_width + 0x80);
      pIVar10 = &stack0x00000014;
      in_stack_00000014.vtable =
           (IGrim2D_vtbl *)(((float)in_stack_00000020 - 64.0) * in_stack_00000008);
      in_stack_00000018 = (float)in_stack_0000000c * in_stack_00000008;
      self_00.vtable = pIVar1;
      (*grim_interface_ptr->vtable->grim_draw_quad_xy)
                (pIVar10,(float *)pIVar1,(float)pIVar1,in_stack_fffffff8);
      iVar5 = iVar5 + 1;
      iVar4 = terrain_texture_height * terrain_texture_width * 0xf;
    } while (iVar5 < (int)(iVar4 + (iVar4 >> 0x1f & 0x7ffffU)) >> 0x13);
  }
  (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)self_00.vtable);
  in_stack_0000000c = (IGrim2D *)0x0;
  in_stack_00000010 = 0;
  _camera_offset_x = 0;
  _camera_offset_y = 0;
  uVar6 = 0x13;
  fVar9 = 7.00649e-45;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)pIVar10);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar6);
  uVar8 = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,fVar9);
  uVar6 = 0x13;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,1,uVar8);
  uVar8 = 0x13;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,uVar6);
  uVar6 = 0x14;
  iVar4 = 6;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar8);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,uVar6);
  (*grim_interface_ptr->vtable->grim_set_render_target)((IGrim2D *)0xffffffff,iVar4);
  return;
}



/* terrain_generate_random @ 004181b0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* selects a terrain variant and generates the terrain texture */

void terrain_generate_random(void)

{
  IGrim2D_vtbl *pIVar1;
  IGrim2D_vtbl *pIVar2;
  float self;
  float self_00;
  int iVar3;
  int iVar4;
  int iVar5;
  float fVar6;
  float unaff_EBX;
  IGrim2D_vtbl *unaff_EBP;
  IGrim2D *unaff_ESI;
  int iVar7;
  float unaff_EDI;
  undefined4 uStack00000004;
  IGrim2D in_stack_00000008;
  float in_stack_0000000c;
  uint uVar8;
  float v1;
  uint uVar9;
  float a;
  uint value;
  undefined4 in_stack_ffffffbc;
  float a_00;
  IGrim2D *in_stack_ffffffc0;
  IGrim2D *in_stack_ffffffc4;
  float h;
  IGrim2D *pIVar10;
  IGrim2D *in_stack_ffffffe0;
  IGrim2D_vtbl *self_01;
  IGrim2D h_00;
  float fStack_c;
  IGrim2D IStack_8;
  float local_4;
  
  fVar6 = 1.0 / (float)config_blob.reserved0._112_4_;
  _DAT_0048f53c = crt_rand();
  _DAT_0048f53c = _DAT_0048f53c % 7;
  _DAT_0048f540 = crt_rand();
  _DAT_0048f540 = _DAT_0048f540 % 7;
  h = 6.015923e-39;
  crt_rand();
  self_00 = DAT_0048f54c;
  self = DAT_0048f548;
  _DAT_0048f53c = 0;
  _DAT_0048f540 = 1;
  _DAT_0048f544 = 0;
  local_4 = DAT_0048f548;
  if (0x27 < game_status_blob.quest_unlock_index) {
    h = 6.016e-39;
    iVar3 = crt_rand();
    if (((byte)iVar3 & 7) == 3) {
      terrain_generate(&DAT_00484c84);
      return;
    }
  }
  if (0x1d < game_status_blob.quest_unlock_index) {
    h = 6.01606e-39;
    iVar3 = crt_rand();
    if (((byte)iVar3 & 7) == 3) {
      terrain_generate(&DAT_00484acc);
      return;
    }
  }
  if (0x13 < game_status_blob.quest_unlock_index) {
    h = 6.01612e-39;
    iVar3 = crt_rand();
    if (((byte)iVar3 & 7) == 3) {
      terrain_generate(&DAT_00484914);
      return;
    }
  }
  h_00.vtable = (IGrim2D_vtbl *)0x0;
  _camera_offset_y = 0;
  self_01 = (IGrim2D_vtbl *)0x0;
  _camera_offset_x = 0;
  if (terrain_texture_failed == '\0') {
    value = 0x12;
    a_00 = (float)CONCAT31((int3)((uint)in_stack_ffffffbc >> 8),1);
    (*grim_interface_ptr->vtable->grim_set_config_var)
              ((IGrim2D *)0x12,(uint)a_00,(uint)in_stack_ffffffc0);
    uVar9 = 0x13;
    a = 7.00649e-45;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,value);
    uVar8 = 0x14;
    v1 = 8.40779e-45;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar9);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,uVar8);
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,v1);
    (*grim_interface_ptr->vtable->grim_set_render_target)(terrain_render_target,uVar9);
    (*grim_interface_ptr->vtable->grim_clear_color)
              ((IGrim2D *)0x3e7cfcfd,0.21960784,0.09803922,1.0,a);
    (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)self,0,value);
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f333333,0.7,0.7,0.9,a_00);
    (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_ffffffc0);
    iVar7 = 0;
    iVar3 = terrain_texture_height * terrain_texture_width * 800;
    if (0 < (int)(iVar3 + (iVar3 >> 0x1f & 0x7ffffU)) >> 0x13) {
      pIVar10 = (IGrim2D *)((float)unaff_EBP * 128.0);
      do {
        pIVar1 = grim_interface_ptr->vtable;
        iVar3 = crt_rand();
        unaff_EBX = (float)(iVar3 % 0x13a);
        (*pIVar1->grim_set_rotation)
                  ((IGrim2D *)((float)(int)unaff_EBX * 0.01),(float)in_stack_ffffffc4);
        iVar3 = crt_rand();
        in_stack_ffffffe0 = (IGrim2D *)((float)(iVar3 % (terrain_texture_width + 0x80)) - 64.0);
        iVar3 = crt_rand();
        fVar6 = (float)(iVar3 % (terrain_texture_width + 0x80));
        h_00.vtable = (IGrim2D_vtbl *)(((float)(int)fVar6 - 64.0) * unaff_EBX);
        in_stack_ffffffc4 = pIVar10;
        (*grim_interface_ptr->vtable->grim_draw_quad_xy)
                  ((IGrim2D *)&stack0xffffffe8,(float *)pIVar10,(float)pIVar10,h);
        iVar7 = iVar7 + 1;
        iVar3 = terrain_texture_height * terrain_texture_width * 800;
      } while (iVar7 < (int)(iVar3 + (iVar3 >> 0x1f & 0x7ffffU)) >> 0x13);
    }
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_ffffffc4);
    (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)self_00,0,(int)h);
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f333333,0.7,0.7,0.9,unaff_EDI);
    (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_ESI);
    iVar7 = 0;
    iVar3 = terrain_texture_height * terrain_texture_width * 0x23;
    if (0 < (int)(iVar3 + (iVar3 >> 0x1f & 0x7ffffU)) >> 0x13) {
      pIVar1 = (IGrim2D_vtbl *)((float)self_01 * 128.0);
      h_00.vtable = pIVar1;
      do {
        pIVar2 = grim_interface_ptr->vtable;
        iVar3 = crt_rand();
        (*pIVar2->grim_set_rotation)((IGrim2D *)((float)(iVar3 % 0x13a) * 0.01),(float)unaff_EBP);
        iVar4 = crt_rand();
        iVar3 = terrain_texture_width + 0x80;
        iVar5 = crt_rand();
        IStack_8.vtable =
             (IGrim2D_vtbl *)
             (((float)(iVar5 % (terrain_texture_width + 0x80)) - 64.0) * h_00.vtable);
        local_4 = ((float)(iVar4 % iVar3) - 64.0) * (float)h_00.vtable;
        unaff_EBP = pIVar1;
        (*grim_interface_ptr->vtable->grim_draw_quad_xy)
                  (&IStack_8,(float *)pIVar1,(float)pIVar1,unaff_EBX);
        iVar7 = iVar7 + 1;
        iVar3 = terrain_texture_height * terrain_texture_width * 0x23;
      } while (iVar7 < (int)(iVar3 + (iVar3 >> 0x1f & 0x7ffffU)) >> 0x13);
    }
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)unaff_EBP);
    (*grim_interface_ptr->vtable->grim_bind_texture)
              ((IGrim2D *)in_stack_00000008.vtable,0,(int)unaff_EBX);
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f333333,0.7,0.7,0.6,fVar6);
    pIVar10 = (IGrim2D *)0x418670;
    (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_ffffffe0);
    iVar7 = 0;
    iVar3 = terrain_texture_height * terrain_texture_width * 0xf;
    if (0 < (int)(iVar3 + (iVar3 >> 0x1f & 0x7ffffU)) >> 0x13) {
      pIVar1 = (IGrim2D_vtbl *)(fStack_c * 128.0);
      IStack_8.vtable = pIVar1;
      do {
        pIVar2 = grim_interface_ptr->vtable;
        iVar3 = crt_rand();
        local_4 = (float)(iVar3 % 0x13a);
        (*pIVar2->grim_set_rotation)((IGrim2D *)((float)(int)local_4 * 0.01),(float)self_01);
        iVar3 = crt_rand();
        local_4 = (float)(iVar3 % (terrain_texture_width + 0x80)) - 64.0;
        iVar3 = crt_rand();
        pIVar10 = &stack0x00000008;
        in_stack_00000008.vtable =
             (IGrim2D_vtbl *)
             (((float)(iVar3 % (terrain_texture_width + 0x80)) - 64.0) * IStack_8.vtable);
        in_stack_0000000c = local_4 * (float)IStack_8.vtable;
        self_01 = pIVar1;
        (*grim_interface_ptr->vtable->grim_draw_quad_xy)
                  (pIVar10,(float *)pIVar1,(float)pIVar1,(float)h_00.vtable);
        iVar7 = iVar7 + 1;
        iVar3 = terrain_texture_height * terrain_texture_width * 0xf;
      } while (iVar7 < (int)(iVar3 + (iVar3 >> 0x1f & 0x7ffffU)) >> 0x13);
    }
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)self_01);
    uStack00000004 = 0;
    _camera_offset_x = 0;
    _camera_offset_y = 0;
    uVar8 = 0x13;
    fVar6 = 7.00649e-45;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)pIVar10);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar8);
    uVar9 = 0x3f800000;
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,fVar6);
    uVar8 = 0x13;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,1,uVar9);
    uVar9 = 0x13;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,uVar8);
    uVar8 = 0x14;
    iVar3 = 6;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar9);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,uVar8);
    (*grim_interface_ptr->vtable->grim_set_render_target)((IGrim2D *)0xffffffff,iVar3);
    if (*(float *)((int)cv_verbose + 0xc) != 0.0) {
      console_printf(&console_log_queue,s_____Generated_terrain__0047377a + 2);
    }
  }
  return;
}



/* terrain_render @ 004188a0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders the terrain layer from terrain_render_target (ground RT) with UV scrolling; honors
   cv_terrainFilter (point filter when value==2.0); tiles fallback when texture missing */

void terrain_render(void)

{
  float u0;
  int iVar1;
  int iVar2;
  IGrim2D *unaff_EBP;
  float unaff_ESI;
  int iVar3;
  float unaff_EDI;
  int iVar4;
  float fVar5;
  uint uVar6;
  IGrim2D *value;
  uint in_stack_ffffffdc;
  IGrim2D *pIVar7;
  undefined4 uVar8;
  float in_stack_ffffffe0;
  uint value_00;
  float in_stack_ffffffe4;
  int iStack_8;
  
  if (*(int *)((int)cv_terrainFilter + 0xc) == 0x40000000) {
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,in_stack_ffffffdc);
  }
  pIVar7 = (IGrim2D *)0x0;
  if (terrain_texture_failed == '\0') {
    (*grim_interface_ptr->vtable->grim_bind_texture)(terrain_render_target,0,(int)in_stack_ffffffe0)
    ;
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,in_stack_ffffffe4);
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_EDI);
    pIVar7 = (IGrim2D *)-(_camera_offset_x / (float)terrain_texture_width);
    u0 = -(_camera_offset_y / (float)terrain_texture_height);
    fVar5 = (float)config_blob.screen_width / (float)terrain_texture_width + (float)pIVar7;
    (*grim_interface_ptr->vtable->grim_set_uv)
              (pIVar7,u0,fVar5,(float)config_blob.screen_height / (float)terrain_texture_height + u0
               ,unaff_ESI);
    (*grim_interface_ptr->vtable->grim_draw_fullscreen_quad)((IGrim2D *)0x0);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,(uint)fVar5);
    return;
  }
  uVar6 = 0x4188f2;
  value = terrain_render_target;
  (*grim_interface_ptr->vtable->grim_bind_texture)(terrain_render_target,0,(int)in_stack_ffffffe0);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x12,uVar6 & 0xffffff00,(uint)value)
  ;
  (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar7);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,in_stack_ffffffe0)
  ;
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,in_stack_ffffffe4);
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,unaff_EDI);
  uVar6 = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,unaff_ESI);
  iVar4 = 0;
  iVar1 = (int)(terrain_texture_height + (terrain_texture_height >> 0x1f & 0xffU)) >> 8;
  if (iVar1 != -1 && -1 < iVar1 + 1) {
    fVar5 = 0.0;
    iVar1 = terrain_texture_width;
    do {
      iVar3 = 0;
      iVar2 = (int)(iVar1 + (iVar1 >> 0x1f & 0xffU)) >> 8;
      if (iVar2 != -1 && -1 < iVar2 + 1) {
        do {
          uVar6 = 0x43800000;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)((float)iStack_8 + _camera_offset_x),fVar5 + _camera_offset_y,256.0,
                     256.0,unaff_ESI);
          iVar3 = iVar3 + 1;
          iVar1 = terrain_texture_width;
        } while (iVar3 < ((int)(terrain_texture_width + (terrain_texture_width >> 0x1f & 0xffU)) >>
                         8) + 1);
      }
      iVar4 = iVar4 + 1;
      fVar5 = (float)((int)fVar5 + 0x100);
    } while (iVar4 < ((int)(terrain_texture_height + (terrain_texture_height >> 0x1f & 0xffU)) >> 8)
                     + 1);
  }
  (*grim_interface_ptr->vtable->grim_end_batch)(unaff_EBP);
  value_00 = 0x15;
  uVar8 = 0x418a6e;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,uVar6);
  (*grim_interface_ptr->vtable->grim_set_config_var)
            ((IGrim2D *)0x12,CONCAT31((int3)((uint)uVar8 >> 8),1),value_00);
  return;
}



/* creature_render_type @ 00418b60 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders active creatures matching type_id using 8x8 atlases and animation strips */

void __cdecl creature_render_type(int type_id)

{
  float fVar1;
  float fVar2;
  int iVar3;
  int atlas_size;
  IGrim2D_vtbl *pIVar4;
  float unaff_EBP;
  IGrim2D *unaff_ESI;
  float *pfVar5;
  int unaff_EDI;
  int iVar6;
  longlong lVar7;
  float unaff_retaddr;
  float in_stack_00000008;
  float in_stack_00000010;
  IGrim2D *pIVar8;
  IGrim2D *self;
  uint uVar9;
  IGrim2D *pIVar10;
  IGrim2D *self_00;
  IGrim2D *rgba;
  IGrim2D IStack_18;
  float fStack_14;
  IGrim2D IStack_10;
  float fStack_c;
  float fStack_8;
  float fStack_4;
  
  iVar6 = type_id * 0x44;
  (*grim_interface_ptr->vtable->grim_bind_texture)
            (*(IGrim2D **)(&creature_type_texture + iVar6),0,unaff_EDI);
  rgba = (IGrim2D *)0x3f800000;
  self_00 = (IGrim2D *)0x3f800000;
  pIVar10 = (IGrim2D *)0x0;
  self = (IGrim2D *)0x0;
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)unaff_ESI);
  if (config_blob.reserved0[0xe] != '\0') {
    rgba = (IGrim2D *)0x418bc1;
    unaff_ESI = (IGrim2D *)perk_id_monster_vision;
    iVar3 = perk_count_get(perk_id_monster_vision);
    if (iVar3 == 0) {
      uVar9 = 0x13;
      pIVar10 = (IGrim2D *)0x1;
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,1,(uint)self_00);
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar9);
      self = (IGrim2D *)0x418c0a;
      (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar10);
      pfVar5 = &creature_pool.hitbox_size;
      do {
        if ((((creature_t *)(pfVar5 + -4))->active != '\0') && (pfVar5[0x17] == (float)type_id)) {
          fVar1 = pfVar5[0x1f];
          fStack_14 = pfVar5[0xb];
          IStack_10.vtable = (IGrim2D_vtbl *)pfVar5[0xc];
          fStack_c = pfVar5[0xd];
          fStack_8 = pfVar5[0xe] * 0.4;
          if ((((uint)fVar1 & 4) == 0) || (((uint)fVar1 & 0x40) != 0)) {
            if (16.0 <= *pfVar5) {
              lVar7 = __ftol();
              iVar3 = (int)lVar7;
              if ((((&creature_type_anim_flags)[iVar6] & 1) != 0) && (0xf < iVar3)) {
                iVar3 = 0x1f - iVar3;
              }
            }
            else if (0.0 <= *pfVar5) {
              lVar7 = __ftol();
              iVar3 = (int)lVar7;
            }
            else {
              iVar3 = *(int *)(&creature_type_base_frame + iVar6) + 0xf;
              fStack_8 = *pfVar5 * 0.5 + fStack_8;
              if (fStack_8 < 0.0) {
                fStack_8 = 0.0;
              }
            }
            if (((uint)fVar1 & 0x10) != 0) {
              iVar3 = iVar3 + 0x20;
            }
            (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x8,iVar3,(int)self_00);
          }
          else {
            lVar7 = __ftol();
            uVar9 = (uint)lVar7 & 0x8000000f;
            if ((int)uVar9 < 0) {
              uVar9 = (uVar9 - 1 | 0xfffffff0) + 1;
            }
            if (7 < (int)uVar9) {
              uVar9 = 0xf - uVar9;
            }
            (*grim_interface_ptr->vtable->grim_set_atlas_frame)
                      ((IGrim2D *)0x8,*(int *)(&creature_type_base_frame + iVar6) + 0x10 + uVar9,
                       (int)self_00);
            if ((*pfVar5 < 0.0) && (fStack_4 = *pfVar5 * 0.1 + fStack_4, fStack_4 < 0.0)) {
              fStack_4 = 0.0;
            }
          }
          fStack_4 = fStack_4 * in_stack_00000008;
          (*grim_interface_ptr->vtable->grim_set_color_ptr)(&IStack_10,(float *)rgba);
          (*grim_interface_ptr->vtable->grim_set_rotation)
                    ((IGrim2D *)(pfVar5[7] - 1.5707964),(float)unaff_ESI);
          fVar1 = pfVar5[9] * 0.5 + 0.7;
          self_00 = (IGrim2D *)((_camera_offset_y + pfVar5[2]) - fVar1);
          rgba = (IGrim2D *)(pfVar5[9] * 1.07);
          self = (IGrim2D *)0x418e37;
          unaff_ESI = rgba;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)((_camera_offset_x + pfVar5[1]) - fVar1),(float)self_00,(float)rgba,
                     (float)rgba,unaff_EBP);
          type_id = (int)in_stack_00000010;
        }
        pfVar5 = pfVar5 + 0x26;
      } while ((int)pfVar5 < 0x4aa348);
      pIVar10 = (IGrim2D *)0x418e5b;
      (*grim_interface_ptr->vtable->grim_end_batch)(self_00);
    }
  }
  uVar9 = 0x13;
  pIVar8 = (IGrim2D *)0x5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)self);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar9);
  uVar9 = 0x418e99;
  (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar8);
  if (_bonus_energizer_timer <= 0.0) {
    iVar3 = 0x49bfcc;
    do {
      if ((*(char *)(iVar3 + -0x94) != '\0') && (*(float *)(iVar3 + -0x28) == fStack_8)) {
        uVar9 = *(uint *)(iVar3 + -8);
        IStack_18.vtable = *(IGrim2D_vtbl **)(iVar3 + -0x54);
        fStack_14 = *(float *)(iVar3 + -0x50);
        IStack_10.vtable = *(IGrim2D_vtbl **)(iVar3 + -0x4c);
        if (((uVar9 & 4) == 0) || ((uVar9 & 0x40) != 0)) {
          if (16.0 <= *(float *)(iVar3 + -0x84)) {
            lVar7 = __ftol();
            atlas_size = (int)lVar7;
            if ((((&creature_type_anim_flags)[iVar6] & 1) != 0) && (0xf < atlas_size)) {
              atlas_size = 0x1f - atlas_size;
            }
          }
          else if (0.0 <= *(float *)(iVar3 + -0x84)) {
            lVar7 = __ftol();
            atlas_size = (int)lVar7;
          }
          else {
            atlas_size = *(int *)(&creature_type_base_frame + iVar6) + 0xf;
            IStack_10.vtable = (IGrim2D_vtbl *)(*(float *)(iVar3 + -0x84) * 0.1 + IStack_10.vtable);
            if ((float)IStack_10.vtable < 0.0) {
              IStack_10.vtable = (IGrim2D_vtbl *)0x0;
            }
          }
          if ((uVar9 & 0x10) != 0) {
            atlas_size = atlas_size + 0x20;
          }
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x8,atlas_size,(int)self);
        }
        else {
          lVar7 = __ftol();
          uVar9 = (uint)lVar7 & 0x8000000f;
          if ((int)uVar9 < 0) {
            uVar9 = (uVar9 - 1 | 0xfffffff0) + 1;
          }
          if (7 < (int)uVar9) {
            uVar9 = 0xf - uVar9;
          }
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)
                    ((IGrim2D *)0x8,*(int *)(&creature_type_base_frame + iVar6) + 0x10 + uVar9,
                     (int)self);
          if ((*(float *)(iVar3 + -0x84) < 0.0) &&
             (fStack_c = *(float *)(iVar3 + -0x84) * 0.1 + fStack_c, fStack_c < 0.0)) {
            fStack_c = 0.0;
          }
        }
        fStack_c = fStack_c * unaff_retaddr;
        (*grim_interface_ptr->vtable->grim_set_color_ptr)(&IStack_18,(float *)pIVar10);
        (*grim_interface_ptr->vtable->grim_set_rotation)
                  ((IGrim2D *)(*(float *)(iVar3 + -0x68) - 1.5707964),(float)self_00);
        fVar1 = *(float *)(iVar3 + -0x60) * 0.5;
        pIVar10 = *(IGrim2D **)(iVar3 + -0x60);
        self = (IGrim2D *)((_camera_offset_y + *(float *)(iVar3 + -0x7c)) - fVar1);
        uVar9 = 0x419399;
        self_00 = pIVar10;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)((_camera_offset_x + *(float *)(iVar3 + -0x80)) - fVar1),(float)self,
                   (float)pIVar10,(float)pIVar10,(float)rgba);
        if ((*(float *)(iVar3 + -0x84) < -10.0) &&
           (*(undefined1 *)(iVar3 + -0x94) = 0, (*(byte *)(iVar3 + -8) & 4) != 0)) {
          (&creature_spawn_slot_owner)[*(int *)(iVar3 + -0x1c) * 6] = 0;
        }
      }
      iVar3 = iVar3 + 0x98;
    } while (iVar3 < 0x4aa3cc);
  }
  else {
    pfVar5 = &creature_pool.max_health;
    do {
      if ((((creature_t *)(pfVar5 + -10))->active != '\0') && (pfVar5[0x11] == (float)type_id)) {
        if (500.0 <= *pfVar5) {
          IStack_18.vtable = (IGrim2D_vtbl *)pfVar5[6];
          fStack_14 = pfVar5[7];
          IStack_10.vtable = (IGrim2D_vtbl *)pfVar5[8];
        }
        else {
          fVar1 = _bonus_energizer_timer;
          if (1.0 <= _bonus_energizer_timer) {
            fVar1 = 1.0;
          }
          fVar2 = 1.0 - fVar1;
          IStack_18.vtable = (IGrim2D_vtbl *)(fVar2 * pfVar5[6] + fVar1 * 0.5);
          fStack_14 = fVar2 * pfVar5[7] + fVar1;
          IStack_10.vtable = (IGrim2D_vtbl *)(fVar2 * pfVar5[8] + fVar1);
        }
        fVar1 = pfVar5[0x19];
        if ((((uint)fVar1 & 4) == 0) || (((uint)fVar1 & 0x40) != 0)) {
          if (16.0 <= pfVar5[-6]) {
            lVar7 = __ftol();
            iVar3 = (int)lVar7;
            if ((((&creature_type_anim_flags)[iVar6] & 1) != 0) && (0xf < iVar3)) {
              iVar3 = 0x1f - iVar3;
            }
          }
          else if (0.0 <= pfVar5[-6]) {
            unaff_ESI = (IGrim2D *)(*(int *)(&creature_type_base_frame + iVar6) + 0xf);
            lVar7 = __ftol();
            iVar3 = (int)lVar7;
          }
          else {
            iVar3 = *(int *)(&creature_type_base_frame + iVar6) + 0xf;
            IStack_10.vtable = (IGrim2D_vtbl *)(pfVar5[-6] * 0.1 + IStack_10.vtable);
            if ((float)IStack_10.vtable < 0.0) {
              IStack_10.vtable = (IGrim2D_vtbl *)0x0;
            }
          }
          if (((uint)fVar1 & 0x10) != 0) {
            iVar3 = iVar3 + 0x20;
          }
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x8,iVar3,(int)self);
        }
        else {
          lVar7 = __ftol();
          uVar9 = (uint)lVar7 & 0x8000000f;
          if ((int)uVar9 < 0) {
            uVar9 = (uVar9 - 1 | 0xfffffff0) + 1;
          }
          if (7 < (int)uVar9) {
            uVar9 = 0xf - uVar9;
          }
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)
                    ((IGrim2D *)0x8,*(int *)(&creature_type_base_frame + iVar6) + 0x10 + uVar9,
                     (int)self);
          if ((pfVar5[-6] < 0.0) && (fStack_c = pfVar5[-6] * 0.1 + fStack_c, fStack_c < 0.0)) {
            fStack_c = 0.0;
          }
        }
        fStack_c = fStack_c * unaff_retaddr;
        (*grim_interface_ptr->vtable->grim_set_color_ptr)(&IStack_18,(float *)pIVar10);
        (*grim_interface_ptr->vtable->grim_set_rotation)
                  ((IGrim2D *)(pfVar5[1] - 1.5707964),(float)self_00);
        pIVar10 = (IGrim2D *)pfVar5[3];
        self = (IGrim2D *)((_camera_offset_y + pfVar5[-4]) - pfVar5[3] * 0.5);
        uVar9 = 0x41912e;
        self_00 = pIVar10;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)((_camera_offset_x + pfVar5[-5]) - pfVar5[3] * 0.5),(float)self,
                   (float)pIVar10,(float)pIVar10,(float)rgba);
        if ((pfVar5[-6] < -10.0) &&
           (iVar3 = (int)pfVar5[0x19], ((creature_t *)(pfVar5 + -10))->active = '\0',
           (iVar3 & 4) != 0)) {
          (&creature_spawn_slot_owner)[(int)pfVar5[0x14] * 6] = 0;
        }
      }
      pfVar5 = pfVar5 + 0x26;
    } while ((int)pfVar5 < 0x4aa360);
  }
  pIVar8 = (IGrim2D *)0x4193eb;
  (*grim_interface_ptr->vtable->grim_end_batch)(self);
  if (config_blob.fx_toggle != '\0') {
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar9);
    fStack_14 = 1.0;
    IStack_18.vtable = (IGrim2D_vtbl *)0x3f800000;
    uVar9 = 0x41945e;
    (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar8);
    pfVar5 = &creature_pool.hitbox_size;
    do {
      if (((((creature_t *)(pfVar5 + -4))->active != '\0') && (pfVar5[0x17] == fStack_8)) &&
         (0.0 < pfVar5[10])) {
        IStack_10.vtable = (IGrim2D_vtbl *)(pfVar5[10] * 5.0);
        if (1.0 < (float)IStack_10.vtable) {
          IStack_10.vtable = (IGrim2D_vtbl *)0x3f800000;
        }
        fVar1 = pfVar5[0x1f];
        if ((((uint)fVar1 & 4) == 0) || (((uint)fVar1 & 0x40) != 0)) {
          if (16.0 <= *pfVar5) {
            lVar7 = __ftol();
            iVar3 = (int)lVar7;
            if ((((&creature_type_anim_flags)[iVar6] & 1) != 0) && (0xf < iVar3)) {
              iVar3 = 0x1f - iVar3;
            }
            if (((uint)fVar1 & 0x10) != 0) {
              iVar3 = iVar3 + 0x20;
            }
          }
          else if (0.0 <= *pfVar5) {
            lVar7 = __ftol();
            iVar3 = (int)lVar7;
          }
          else {
            iVar3 = *(int *)(&creature_type_base_frame + iVar6) + 0xf;
          }
          pIVar4 = grim_interface_ptr->vtable;
        }
        else {
          lVar7 = __ftol();
          uVar9 = (uint)lVar7 & 0x8000000f;
          if ((int)uVar9 < 0) {
            uVar9 = (uVar9 - 1 | 0xfffffff0) + 1;
          }
          if (7 < (int)uVar9) {
            uVar9 = 0xf - uVar9;
          }
          pIVar4 = grim_interface_ptr->vtable;
          iVar3 = *(int *)(&creature_type_base_frame + iVar6) + 0x10 + uVar9;
        }
        (*pIVar4->grim_set_atlas_frame)((IGrim2D *)0x8,iVar3,(int)self);
        fStack_c = fStack_c * unaff_retaddr;
        (*grim_interface_ptr->vtable->grim_set_color_ptr)(&IStack_18,(float *)pIVar10);
        (*grim_interface_ptr->vtable->grim_set_rotation)
                  ((IGrim2D *)(pfVar5[7] - 1.5707964),(float)self_00);
        self = (IGrim2D *)((_camera_offset_x + pfVar5[1]) - pfVar5[9] * 0.5);
        pIVar10 = (IGrim2D *)((_camera_offset_y + pfVar5[2]) - pfVar5[9] * 0.5);
        uVar9 = 0x419619;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  (self,(float)pIVar10,pfVar5[9],pfVar5[9],(float)rgba);
        self_00 = (IGrim2D *)pfVar5[9];
        rgba = self_00;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  (self,(float)pIVar10,(float)self_00,(float)self_00,(float)unaff_ESI);
      }
      pfVar5 = pfVar5 + 0x26;
    } while ((int)pfVar5 < 0x4aa348);
    (*grim_interface_ptr->vtable->grim_end_batch)(self);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar9);
  }
  return;
}



/* creature_render_all @ 00419680 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* creature render pass: overlays + per-type draws via creature_render_type */

void creature_render_all(void)

{
  IGrim2D *unaff_ESI;
  float *pfVar1;
  IGrim2D *unaff_EDI;
  float unaff_retaddr;
  uint uVar2;
  int iVar3;
  float in_stack_ffffffe4;
  float in_stack_ffffffe8;
  IGrim2D *in_stack_ffffffec;
  float fVar4;
  IGrim2D *self;
  IGrim2D *self_00;
  IGrim2D *radians;
  IGrim2D *in_stack_fffffffc;
  
  if ((((0.0 < ui_transition_alpha) && (game_state_id != 0x14)) && (game_state_id != 0x16)) &&
     ((game_state_prev != 0x14 && (game_state_prev != 0x16)))) {
    uVar2 = 0x13;
    iVar3 = 5;
    radians = (IGrim2D *)ui_transition_alpha;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)in_stack_ffffffe4);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar2);
    (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,iVar3);
    effect_select_texture(0x10);
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x0,0.0,0.0,1.0,in_stack_ffffffe4);
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,in_stack_ffffffe8);
    (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_ffffffec);
    pfVar1 = &creature_pool.hitbox_size;
    do {
      if (((creature_t *)(pfVar1 + -4))->active != '\0') {
        iVar3 = perk_count_get(perk_id_monster_vision);
        if (iVar3 != 0) {
          if ((0.0 <= *pfVar1) || (fVar4 = (*pfVar1 + 10.0) * 0.1, 1.0 < fVar4)) {
            fVar4 = 1.0;
          }
          else if (fVar4 < 0.0) {
            fVar4 = 0.0;
          }
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f800000,1.0,0.0,fVar4 * (float)radians,(float)unaff_EDI);
          unaff_EDI = (IGrim2D *)0x42b40000;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)((_camera_offset_x + pfVar1[1]) - 45.0),
                     (_camera_offset_y + pfVar1[2]) - 45.0,90.0,90.0,(float)unaff_ESI);
        }
        if (*(uchar *)((int)pfVar1 + -7) != '\0') {
          if (0.0 <= *pfVar1) {
            fVar4 = 1.0;
          }
          else {
            fVar4 = (*pfVar1 + 10.0) * 0.1;
          }
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x0,0.0,0.0,fVar4 * (float)radians,(float)unaff_EDI);
          unaff_EDI = (IGrim2D *)0x42a00000;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)((_camera_offset_x + pfVar1[1]) - 40.0),
                     (_camera_offset_y + pfVar1[2]) - 40.0,80.0,80.0,(float)unaff_ESI);
        }
        if (((uint)pfVar1[0x1f] & 1) != 0) {
          if (0.0 <= *pfVar1) {
            fVar4 = 1.0;
          }
          else {
            fVar4 = (*pfVar1 + 10.0) * 0.1;
          }
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f800000,0.0,0.0,fVar4 * (float)radians,(float)unaff_EDI);
          unaff_EDI = (IGrim2D *)0x42700000;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)((_camera_offset_x + pfVar1[1]) - 30.0),
                     (_camera_offset_y + pfVar1[2]) - 30.0,60.0,60.0,(float)unaff_ESI);
        }
      }
      pfVar1 = pfVar1 + 0x26;
    } while ((int)pfVar1 < 0x4aa348);
    (*grim_interface_ptr->vtable->grim_end_batch)(unaff_EDI);
    fVar4 = 0.0;
    self_00 = in_stack_fffffffc;
    creature_render_type(0);
    creature_render_type(3);
    creature_render_type(4);
    creature_render_type(2);
    creature_render_type(1);
    if (0.0 < _bonus_freeze_timer) {
      uVar2 = 0x13;
      iVar3 = 5;
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)in_stack_fffffffc);
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar2);
      (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,iVar3);
      effect_select_texture(0xe);
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x0,0.0,0.0,1.0,(float)in_stack_fffffffc);
      (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,fVar4);
      self = (IGrim2D *)0x419a81;
      (*grim_interface_ptr->vtable->grim_begin_batch)(self_00);
      fVar4 = 0.0;
      pfVar1 = &creature_pool.size;
      do {
        if (((creature_t *)(pfVar1 + -0xd))->active != '\0') {
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f800000,1.0,1.0,unaff_retaddr,(float)unaff_ESI);
          (*grim_interface_ptr->vtable->grim_set_rotation)
                    ((IGrim2D *)((float)(int)unaff_retaddr * 0.01 + pfVar1[-2]),(float)radians);
          unaff_ESI = (IGrim2D *)*pfVar1;
          self = (IGrim2D *)((_camera_offset_x + pfVar1[-8]) - *pfVar1 * 0.5);
          radians = unaff_ESI;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    (self,(_camera_offset_y + pfVar1[-7]) - *pfVar1 * 0.5,(float)unaff_ESI,
                     (float)unaff_ESI,fVar4);
        }
        pfVar1 = pfVar1 + 0x26;
        fVar4 = (float)((int)fVar4 + 1);
      } while ((int)pfVar1 < 0x4aa36c);
      (*grim_interface_ptr->vtable->grim_end_batch)(unaff_ESI);
      uVar2 = 0x13;
      in_stack_fffffffc = (IGrim2D *)0x5;
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)self);
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar2);
    }
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x0,1.0,1.0,1.0,(float)in_stack_fffffffc);
  }
  return;
}



/* ui_element_set_rect @ 00419ba0 */

/* sets element quad vertices/UVs for a size and offset */

void __cdecl ui_element_set_rect(ui_element_t *element,float width,float height,float *offset)

{
  float fVar1;
  float fVar2;
  _func_1 *p_Var3;
  uchar *puVar4;
  int iVar5;
  
  fVar1 = 1.0 / width;
  element->active = '\0';
  element->enabled = '\0';
  element->_pad0[0] = 0x80;
  element->_pad0[1] = '?';
  element->_pad0[2] = '\0';
  element->_pad0[3] = '\0';
  element->_pad0[4] = 0x80;
  element->_pad0[5] = '?';
  p_Var3 = (_func_1 *)(1.0 / height);
  element->pos_y = width - 1.0;
  element->_pad1[0] = '\0';
  element->_pad1[1] = '\0';
  element->_pad1[2] = 0x80;
  element->_pad1[3] = '?';
  element->quad0[6] = 1.0;
  element->quad0[7] = height - 1.0;
  *(float *)element->_pad2 = width - 1.0;
  element->quad0[0] = height - 1.0;
  *(float *)(element->_pad0 + 0x12) = fVar1;
  fVar2 = 1.0 - fVar1;
  element->pos_x = (float)p_Var3;
  *(float *)(element->_pad1 + 0x10) = fVar2;
  element->on_activate = p_Var3;
  element->quad0[0xb] = fVar1;
  element->quad0[4] = fVar2;
  element->quad0[0xc] = fVar2;
  element->quad0[5] = 1.0 - (float)p_Var3;
  iVar5 = 4;
  puVar4 = element->_pad0 + 2;
  do {
    *(float *)(puVar4 + 0xc) = -NAN;
    *(float *)(puVar4 + 4) = 0.5;
    *(float *)(puVar4 + 8) = 1.0;
    iVar5 = iVar5 + -1;
    *(float *)(puVar4 + -4) = *(float *)(puVar4 + -4) + *offset;
    *(float *)puVar4 = *(float *)puVar4 + offset[1];
    puVar4 = puVar4 + 0x1c;
  } while (iVar5 != 0);
  return;
}



/* ui_element_load @ 00419d00 */

/* loads a UI element JAZ asset and logs failures */

void __cdecl ui_element_load(ui_element_t *element,char *jaz_path)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  char *unaff_ESI;
  char *pcVar5;
  char *unaff_EDI;
  char *pcVar6;
  int in_stack_0000000c;
  IGrim2D aIStack_fc [63];
  
  uVar3 = 0xffffffff;
  pcVar5 = jaz_path;
  do {
    pcVar6 = pcVar5;
    if (uVar3 == 0) break;
    uVar3 = uVar3 - 1;
    pcVar6 = pcVar5 + 1;
    cVar1 = *pcVar5;
    pcVar5 = pcVar6;
  } while (cVar1 != '\0');
  uVar3 = ~uVar3;
  pcVar5 = pcVar6 + -uVar3;
  pcVar6 = &stack0xffffff00;
  for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
    *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
    pcVar5 = pcVar5 + 4;
    pcVar6 = pcVar6 + 4;
  }
  for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *pcVar6 = *pcVar5;
    pcVar5 = pcVar5 + 1;
    pcVar6 = pcVar6 + 1;
  }
  uVar3 = 0xffffffff;
  pcVar5 = jaz_path;
  do {
    if (uVar3 == 0) break;
    uVar3 = uVar3 - 1;
    cVar1 = *pcVar5;
    pcVar5 = pcVar5 + 1;
  } while (cVar1 != '\0');
  *(undefined1 *)((int)aIStack_fc + (~uVar3 - 9)) = 0;
  if (*(float *)((int)cv_silentloads + 0xc) == 0.0) {
    console_printf(&console_log_queue,s_Loading_uiElement__s_004737b4,&stack0xffffff00);
  }
  (*grim_interface_ptr->vtable->grim_load_texture)((IGrim2D *)&stack0xffffff00,jaz_path,unaff_EDI);
  iVar2 = (*grim_interface_ptr->vtable->grim_get_texture_handle)(aIStack_fc,unaff_ESI);
  *(int *)(in_stack_0000000c + 0xe0) = iVar2;
  aIStack_fc[0].vtable = (IGrim2D_vtbl *)(aIStack_fc + 1);
  if (iVar2 == -1) {
    console_printf(&console_log_queue,s___FAILED_Loading_uiElement__s_00473794);
  }
  return;
}



/* ui_menu_assets_init @ 00419dd0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* loads menu UI elements and seeds layout copies */

void ui_menu_assets_init(void)

{
  float *pfVar1;
  float *pfVar2;
  int iVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  float local_8 [2];
  
  ui_element_load((ui_element_t *)&DAT_0048fac0,s_ui_ui_signCrimson_jaz_004737f4);
  local_8[0] = -577.44;
  local_8[1] = -62.0;
  ui_element_set_rect((ui_element_t *)&DAT_0048fac0,573.44,143.36,local_8);
  ui_element_load((ui_element_t *)&DAT_0048fba8,s_ui_ui_menuItem_jaz_004737e0);
  local_8[0] = -72.0;
  local_8[1] = -60.0;
  ui_element_set_rect((ui_element_t *)&DAT_0048fba8,512.0,64.0,local_8);
  ui_element_load((ui_element_t *)&DAT_0048fc90,s_ui_ui_menuPanel_jaz_004737cc);
  local_8[0] = 20.0;
  local_8[1] = -82.0;
  ui_element_set_rect((ui_element_t *)&DAT_0048fc90,512.0,256.0,local_8);
  puVar4 = &DAT_0048fc90;
  puVar5 = &DAT_0048fd78;
  for (iVar3 = 0x3a; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar5 = *puVar4;
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 1;
  }
  _DAT_0048fe5c = 8;
  puVar4 = &DAT_0048fdcc;
  puVar5 = &DAT_0048fe3c;
  for (iVar3 = 7; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar5 = *puVar4;
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 1;
  }
  puVar4 = &DAT_0048fdb0;
  puVar5 = &DAT_0048fe20;
  for (iVar3 = 7; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar5 = *puVar4;
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 1;
  }
  DAT_0048fdb4 = DAT_0048fdb4 - 116.0;
  DAT_0048fdd0 = DAT_0048fdd0 - 116.0;
  _DAT_0048fdc8 = 0x3f020000;
  _DAT_0048fde4 = 0x3f020000;
  puVar4 = &DAT_0048fdcc;
  puVar5 = &DAT_0048fde8;
  for (iVar3 = 7; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar5 = *puVar4;
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 1;
  }
  puVar4 = &DAT_0048fdb0;
  puVar5 = &DAT_0048fe04;
  for (iVar3 = 7; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar5 = *puVar4;
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 1;
  }
  DAT_0048fdec = DAT_0048fdec + 124.0;
  DAT_0048fe08 = DAT_0048fe08 + 124.0;
  DAT_0048fe24 = DAT_0048fe24 + 124.0;
  _DAT_0048fe00 = 0x3f160000;
  _DAT_0048fe1c = 0x3f160000;
  DAT_0048fe40 = DAT_0048fe40 + 124.0;
  pfVar1 = (float *)&DAT_0048fd78;
  do {
    pfVar1[1] = pfVar1[1];
    pfVar2 = pfVar1 + 7;
    *pfVar1 = *pfVar1 - 84.0;
    pfVar1 = pfVar2;
  } while ((int)pfVar2 < 0x48fe58);
  puVar4 = &DAT_0048fd78;
  puVar5 = &DAT_0048fe60;
  for (iVar3 = 0x3a; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar5 = *puVar4;
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 1;
  }
  _DAT_0048fed4 = DAT_0048fdec - 100.0;
  _DAT_0048fef0 = _DAT_0048fef0 - 100.0;
  _DAT_0048ff0c = _DAT_0048ff0c - 100.0;
  _DAT_0048ff28 = _DAT_0048ff28 - 100.0;
  ui_menu_layout_init();
  return;
}



/* ui_cursor_render @ 0041a040 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders the in-game cursor/crosshair sprites */

void ui_cursor_render(void)

{
  IGrim2D_vtbl *pIVar1;
  float unaff_EDI;
  float10 fVar2;
  float10 extraout_ST0;
  float unaff_retaddr;
  float fVar3;
  IGrim2D *in_stack_00000004;
  IGrim2D *in_stack_00000008;
  float in_stack_0000000c;
  IGrim2D *in_stack_00000010;
  uint uVar4;
  int iVar5;
  float in_stack_ffffffe8;
  IGrim2D *in_stack_ffffffec;
  float in_stack_fffffff0;
  float extraout_var;
  float fVar6;
  
  _DAT_004902e8 = frame_dt + _DAT_004902e8;
  uVar4 = 0x13;
  _DAT_004902ec = frame_dt * 1.1 + _DAT_004902ec;
  iVar5 = 5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)in_stack_ffffffe8);
  fVar6 = extraout_var;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar4);
  (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,iVar5);
  effect_select_texture(0xd);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,in_stack_ffffffe8)
  ;
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_ffffffec);
  fVar2 = (float10)fsin((float10)_DAT_004902ec);
  pIVar1 = grim_interface_ptr->vtable;
  fVar3 = (float)fVar2;
  crt_ci_pow();
  (*pIVar1->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,(float)((extraout_ST0 + (float10)2.0) * (float10)0.32),
             in_stack_fffffff0);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(ui_mouse_x - 28.0),ui_mouse_y - 28.0,64.0,64.0,unaff_EDI);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(ui_mouse_x - 10.0),ui_mouse_y - 18.0,64.0,64.0,fVar3);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(ui_mouse_x - 18.0),ui_mouse_y - 10.0,64.0,64.0,fVar6);
  fVar6 = 128.0;
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)((ui_mouse_x - 64.0) + 16.0),(ui_mouse_y - 64.0) + 16.0,128.0,128.0,
             unaff_retaddr);
  fVar3 = 6.027486e-39;
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000004);
  uVar4 = 0x13;
  iVar5 = 5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)fVar6);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar4);
  (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f798,0,iVar5);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,fVar6);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,fVar3);
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,(float)in_stack_00000004);
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_00000008);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(ui_mouse_x - 2.0),ui_mouse_y - 2.0,32.0,32.0,in_stack_0000000c);
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000010);
  return;
}



/* ui_render_aim_enhancement @ 0041a320 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders the aim enhancement overlay (cv_aimEnhancementFade-driven) */

void ui_render_aim_enhancement(void)

{
  IGrim2D *unaff_ESI;
  float *unaff_retaddr;
  float *h;
  IGrim2D *in_stack_00000004;
  uint uVar1;
  int iVar2;
  float in_stack_fffffff0;
  IGrim2D *in_stack_fffffff4;
  float v1;
  float in_stack_fffffff8;
  float a;
  
  _DAT_004902f0 = frame_dt + _DAT_004902f0;
  uVar1 = 0x13;
  _DAT_004902f4 = frame_dt * 0.6 + _DAT_004902f4;
  iVar2 = 5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)in_stack_fffffff0);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar1);
  (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,iVar2);
  effect_select_texture(0xd);
  if (1.0 < *(float *)((int)cv_aimEnhancementFade + 0xc)) {
    *(undefined4 *)((int)cv_aimEnhancementFade + 0xc) = 0x3f800000;
  }
  if (*(float *)((int)cv_aimEnhancementFade + 0xc) < 0.0) {
    *(undefined4 *)((int)cv_aimEnhancementFade + 0xc) = 0;
  }
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,*(float *)((int)cv_aimEnhancementFade + 0xc),
             in_stack_fffffff0);
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_fffffff4);
  v1 = 64.0;
  h = unaff_retaddr;
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(*unaff_retaddr - 32.0),unaff_retaddr[1] - 32.0,64.0,64.0,in_stack_fffffff8)
  ;
  a = 6.028249e-39;
  (*grim_interface_ptr->vtable->grim_end_batch)(unaff_ESI);
  uVar1 = 0x13;
  iVar2 = 5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)v1);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar1);
  (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f79c,0,iVar2);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,v1);
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,*(float *)((int)cv_aimEnhancementFade + 0xc),a);
  (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_ESI);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(*unaff_retaddr - 10.0),unaff_retaddr[1] - 10.0,20.0,20.0,(float)h);
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000004);
  return;
}



/* ui_elements_update_and_render @ 0041a530 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* advances UI timeline, handles transitions, updates + renders all UI elements */

void ui_elements_update_and_render(void)

{
  int iVar1;
  ui_element_t **ppuVar2;
  float10 fVar3;
  float10 fVar4;
  uint in_stack_fffffff0;
  uint value;
  float in_stack_fffffff4;
  float in_stack_fffffff8;
  
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,in_stack_fffffff0);
  if (console_open_flag == '\0') {
    iVar1 = frame_dt_ms;
    if (ui_transition_direction == '\0') {
      iVar1 = -frame_dt_ms;
    }
    ui_elements_timeline = ui_elements_timeline + iVar1;
  }
  if (ui_elements_timeline < 0) {
    ui_elements_timeline = 0;
    if ((demo_mode_active != '\0') && (game_state_pending == 0)) {
      terrain_generate_random();
    }
    game_state_set(game_state_pending);
    game_state_pending = 0x19;
  }
  iVar1 = ui_elements_max_timeline();
  if (iVar1 < ui_elements_timeline) {
    if ((game_state_id == 0) && (demo_mode_active != '\0')) {
      demo_mode_active = '\0';
      config_load_presets();
    }
    fVar3 = (float10)fcos((float10)0.0);
    ui_sign_crimson_update_disabled = 1;
    _DAT_00487594 = (float)fVar3;
    fVar4 = (float10)fsin((float10)0.0);
    _DAT_00487598 = (float)-fVar4;
    _DAT_0048759c = (float)fVar4;
    _DAT_004875a0 = (float)fVar3;
    ui_elements_timeline = ui_elements_max_timeline();
  }
  if (game_state_id != 9) {
    ppuVar2 = &ui_element_table_start;
    do {
      ui_element_update(*ppuVar2);
      ui_element_render(*ppuVar2);
      ppuVar2 = ppuVar2 + -1;
    } while (0x48f167 < (int)ppuVar2);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,1.0,in_stack_fffffff4);
    if (game_state_id == 10) {
      DAT_0047ea50 = 1;
    }
    value = 0x3f800000;
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,1.0,in_stack_fffffff8);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,value);
  }
  return;
}



/* ui_draw_progress_bar @ 0041a6d0 */

/* draws a filled progress bar with a tinted background */

void __cdecl ui_draw_progress_bar(float *xy,float width,float ratio,float *rgba)

{
  IGrim2D local_18;
  float local_14;
  float local_10;
  float local_c;
  float local_8;
  float local_4;
  
  if (0.0 <= ratio) {
    if (1.0 < ratio) {
      ratio = 1.0;
    }
  }
  else {
    ratio = 0.0;
  }
  local_10 = *rgba * 0.6;
  local_c = rgba[1] * 0.6;
  local_8 = rgba[2] * 0.6;
  local_4 = rgba[3] * 0.4;
  local_18.vtable = (IGrim2D_vtbl *)*xy;
  local_14 = xy[1];
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            (&local_18,(float *)width,4.0,(float)&local_10);
  local_18.vtable = (IGrim2D_vtbl *)(*xy + 1.0);
  local_14 = xy[1] + 1.0;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            (&local_18,(float *)((width - 2.0) * ratio),2.0,(float)rgba);
  return;
}



/* FUN_0041a810 @ 0041a810 */

void __cdecl
FUN_0041a810(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  undefined1 *puVar4;
  char *pcVar5;
  int *piVar6;
  
  iVar2 = 0;
  pcVar5 = &bonus_hud_slot_active;
  do {
    if (*pcVar5 == '\0') {
      iVar3 = iVar2 * 0x20;
      (&bonus_hud_slot_timer_ptr)[iVar2 * 8] = param_3;
      (&bonus_hud_slot_icon_id)[iVar2 * 8] = param_2;
      uVar1 = config_blob.reserved0._20_4_;
      *(undefined4 *)(&bonus_hud_slot_alt_timer_ptr + iVar3) = param_4;
      (&bonus_hud_slot_active)[iVar3] = 1;
      (&bonus_hud_slot_y)[iVar2 * 8] = 0xc3380000;
      (&bonus_hud_slot_label)[iVar2 * 8] = param_1;
      if ((int)uVar1 < 2) {
        *(undefined4 *)(&bonus_hud_slot_alt_timer_ptr + iVar3) = 0;
      }
      iVar2 = 0;
      piVar6 = &bonus_hud_slot_timer_ptr;
      do {
        if ((char)piVar6[-3] != '\0') {
          iVar3 = 0x10;
          puVar4 = &DAT_0048f788;
          do {
            if ((*piVar6 == *(int *)(puVar4 + 0xc)) && (iVar2 != iVar3)) {
              *puVar4 = 0;
            }
            puVar4 = puVar4 + -0x20;
            iVar3 = iVar3 + -1;
          } while (0x48f587 < (int)puVar4);
        }
        piVar6 = piVar6 + 8;
        iVar2 = iVar2 + 1;
      } while ((int)piVar6 < 0x48f794);
      return;
    }
    pcVar5 = pcVar5 + 0x20;
    iVar2 = iVar2 + 1;
  } while ((int)pcVar5 < 0x48f788);
  return;
}



/* bonus_hud_slot_update_and_render @ 0041a8b0 */

/* updates bonus HUD slot animation and renders icon/timers */

void __cdecl bonus_hud_slot_update_and_render(float *xy,int slot)

{
  float fVar1;
  float fVar2;
  int iVar3;
  IGrim2D_vtbl *pIVar4;
  char *pcVar5;
  float unaff_EBX;
  float fVar6;
  float unaff_ESI;
  int iVar7;
  int unaff_EDI;
  float *pfVar8;
  bool bVar9;
  int unaff_retaddr;
  float in_stack_0000000c;
  char *in_stack_00000010;
  float fStack00000014;
  float *in_stack_00000018;
  float fStack0000001c;
  float fStack00000020;
  undefined4 uStack00000024;
  float in_stack_00000028;
  undefined4 uStack0000002c;
  undefined4 in_stack_00000038;
  float in_stack_ffffffe8;
  IGrim2D *in_stack_ffffffec;
  float in_stack_fffffff0;
  IGrim2D *in_stack_fffffff4;
  float in_stack_fffffff8;
  int in_stack_fffffffc;
  
  iVar7 = slot * 0x20;
  if ((&bonus_hud_slot_active)[iVar7] != '\0') {
    if ((0.0 < *(float *)(&bonus_hud_slot_timer_ptr)[slot * 8]) ||
       ((*(float **)(&bonus_hud_slot_alt_timer_ptr + iVar7) != (float *)0x0 &&
        (0.0 < **(float **)(&bonus_hud_slot_alt_timer_ptr + iVar7))))) {
      fVar6 = frame_dt * 350.0 + (float)(&bonus_hud_slot_y)[slot * 8];
    }
    else {
      fVar6 = (float)(&bonus_hud_slot_y)[slot * 8] - frame_dt * 320.0;
    }
    (&bonus_hud_slot_y)[slot * 8] = fVar6;
    if (-2.0 < (float)(&bonus_hud_slot_y)[slot * 8]) {
      (&bonus_hud_slot_y)[slot * 8] = 0xc0000000;
    }
    if ((float)(&bonus_hud_slot_y)[slot * 8] < -184.0) {
      iVar3 = 0xf;
      if (slot < 0x10) {
        pcVar5 = &DAT_0048f768;
        bVar9 = slot == 0xf;
        do {
          if (bVar9) {
            (&bonus_hud_slot_active)[iVar7] = '\0';
          }
          else if (*pcVar5 != '\0') break;
          iVar3 = iVar3 + -1;
          pcVar5 = pcVar5 + -0x20;
          bVar9 = slot == iVar3;
        } while (slot <= iVar3);
      }
      *xy = *xy + 52.0;
      return;
    }
    if (*(float *)((int)cv_uiSmallIndicators + 0xc) == 0.0) {
      (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7c4,0,unaff_EDI);
      (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,unaff_ESI);
      (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,unaff_EBX);
      fVar6 = (float)in_stack_00000018 * 0.7;
      fStack00000014 = fVar6;
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,fVar6,in_stack_ffffffe8);
      (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_ffffffec);
      (*grim_interface_ptr->vtable->grim_draw_quad)
                ((IGrim2D *)(&bonus_hud_slot_y)[slot * 8],*in_stack_00000018 - 11.0,182.0,53.0,
                 in_stack_fffffff0);
      (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_fffffff4);
      pfVar8 = in_stack_00000018;
    }
    else {
      (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7c4,0,unaff_EDI);
      (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,unaff_ESI);
      (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,unaff_EBX);
      fVar6 = (float)in_stack_00000018 * 0.7;
      fStack00000014 = fVar6;
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,fVar6,in_stack_ffffffe8);
      (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_ffffffec);
      (*grim_interface_ptr->vtable->grim_draw_quad)
                ((IGrim2D *)(((float)(&bonus_hud_slot_y)[slot * 8] - 100.0) + 4.0),
                 *in_stack_00000018 + 5.0,182.0,26.5,in_stack_fffffff0);
      (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_fffffff4);
      pfVar8 = in_stack_00000018;
    }
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000028,in_stack_fffffff8);
    (*grim_interface_ptr->vtable->grim_bind_texture)(bonus_texture,0,in_stack_fffffffc);
    (*grim_interface_ptr->vtable->grim_set_atlas_frame)
              ((IGrim2D *)0x4,(&bonus_hud_slot_icon_id)[slot * 8],unaff_retaddr);
    (*grim_interface_ptr->vtable->grim_draw_quad)
              ((IGrim2D *)((float)(&bonus_hud_slot_y)[slot * 8] - 1.0),*pfVar8,32.0,32.0,(float)xy);
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)slot);
    if (*(float *)((int)cv_uiSmallIndicators + 0xc) != 0.0) {
      if (*(int *)(&bonus_hud_slot_alt_timer_ptr + iVar7) == 0) {
        fVar1 = (float)(&bonus_hud_slot_y)[slot * 8];
        uStack0000002c = in_stack_00000038;
        fStack0000001c = *pfVar8 + 21.0;
        fVar2 = *(float *)(&bonus_hud_slot_timer_ptr)[slot * 8];
      }
      else {
        in_stack_00000018 = (float *)((float)(&bonus_hud_slot_y)[slot * 8] + 36.0);
        uStack0000002c = in_stack_00000038;
        fStack00000020 = 0.1;
        uStack00000024 = 0x3e99999a;
        in_stack_00000028 = 0.6;
        fStack0000001c = ((*pfVar8 + 21.0) - 4.0) - 4.0;
        ui_draw_progress_bar
                  ((float *)&stack0x00000018,32.0,
                   *(float *)(&bonus_hud_slot_timer_ptr)[slot * 8] * 0.05,&stack0x00000020);
        fVar1 = (float)(&bonus_hud_slot_y)[slot * 8];
        fStack0000001c = *pfVar8 + 23.0;
        uStack0000002c = in_stack_00000038;
        fVar2 = **(float **)(&bonus_hud_slot_alt_timer_ptr + iVar7);
      }
      fStack0000001c = fStack0000001c - 4.0;
      in_stack_00000018 = (float *)(fVar1 + 36.0);
      slot = (int)&stack0x00000020;
      xy = (float *)(fVar2 * 0.05);
      in_stack_00000028 = 0.6;
      uStack00000024 = 0x3e99999a;
      fStack00000020 = 0.1;
      ui_draw_progress_bar((float *)&stack0x00000018,32.0,(float)xy,(float *)slot);
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,fVar6,in_stack_0000000c);
      *pfVar8 = *pfVar8 + 52.0;
      return;
    }
    if (*(int *)(&bonus_hud_slot_alt_timer_ptr + iVar7) == 0) {
      in_stack_00000018 = (float *)((float)(&bonus_hud_slot_y)[slot * 8] + 36.0);
      uStack0000002c = in_stack_00000038;
      fStack0000001c = *pfVar8 + 21.0;
      fStack00000020 = 0.1;
      uStack00000024 = 0x3e99999a;
      in_stack_00000028 = 0.6;
      ui_draw_progress_bar
                ((float *)&stack0x00000018,100.0,
                 *(float *)(&bonus_hud_slot_timer_ptr)[slot * 8] * 0.05,&stack0x00000020);
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,fVar6,in_stack_0000000c);
      in_stack_0000000c = (float)(&bonus_hud_slot_label)[slot * 8];
      pIVar4 = grim_interface_ptr->vtable;
      fVar6 = *pfVar8 + 6.0;
    }
    else {
      in_stack_00000018 = (float *)((float)(&bonus_hud_slot_y)[slot * 8] + 36.0);
      uStack0000002c = in_stack_00000038;
      fStack00000020 = 0.1;
      fStack0000001c = (*pfVar8 + 21.0) - 4.0;
      uStack00000024 = 0x3e99999a;
      in_stack_00000028 = 0.6;
      ui_draw_progress_bar
                ((float *)&stack0x00000018,100.0,
                 *(float *)(&bonus_hud_slot_timer_ptr)[slot * 8] * 0.05,&stack0x00000020);
      in_stack_00000018 = (float *)((float)(&bonus_hud_slot_y)[slot * 8] + 36.0);
      fStack0000001c = *pfVar8 + 23.0;
      uStack0000002c = in_stack_00000038;
      fStack00000020 = 0.1;
      uStack00000024 = 0x3e99999a;
      in_stack_00000028 = 0.6;
      ui_draw_progress_bar
                ((float *)&stack0x00000018,100.0,
                 **(float **)(&bonus_hud_slot_alt_timer_ptr + iVar7) * 0.05,&stack0x00000020);
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,fVar6,in_stack_0000000c);
      in_stack_0000000c = (float)(&bonus_hud_slot_label)[slot * 8];
      pIVar4 = grim_interface_ptr->vtable;
      fVar6 = *pfVar8 + 2.0;
    }
    (*pIVar4->grim_draw_text_small)
              ((IGrim2D *)((float)(&bonus_hud_slot_y)[slot * 8] + 36.0),fVar6,in_stack_0000000c,
               in_stack_00000010);
    *pfVar8 = *pfVar8 + 52.0;
  }
  return;
}



/* ui_render_hud @ 0041aed0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders the in-game HUD (health, weapon icons, player UI) */

void ui_render_hud(void)

{
  char cVar1;
  float fVar2;
  undefined4 uVar3;
  IGrim2D *pIVar4;
  int *piVar5;
  IGrim2D_vtbl *pIVar6;
  float unaff_EBX;
  int unaff_EBP;
  int unaff_ESI;
  int iVar7;
  int iVar8;
  float unaff_EDI;
  int iVar9;
  char *pcVar10;
  float10 fVar11;
  float10 extraout_ST0;
  float10 fVar12;
  float10 fVar13;
  float10 extraout_ST0_00;
  float10 extraout_ST0_01;
  float10 extraout_ST0_02;
  float10 extraout_ST0_03;
  longlong lVar14;
  int unaff_retaddr;
  float in_stack_00000004;
  float in_stack_00000008;
  float in_stack_0000000c;
  IGrim2D *in_stack_00000010;
  char *in_stack_00000014;
  IGrim2D *in_stack_00000018;
  IGrim2D *in_stack_0000001c;
  IGrim2D *in_stack_00000020;
  IGrim2D *in_stack_00000024;
  float in_stack_00000028;
  float in_stack_0000002c;
  float in_stack_00000030;
  float *in_stack_00000034;
  weapon_stats_t *in_stack_00000038;
  IGrim2D *in_stack_0000003c;
  float in_stack_00000040;
  IGrim2D *in_stack_00000044;
  char *in_stack_00000048;
  IGrim2D *in_stack_0000004c;
  IGrim2D *in_stack_00000050;
  IGrim2D *in_stack_00000054;
  IGrim2D *in_stack_00000058;
  IGrim2D *in_stack_0000005c;
  char *in_stack_00000060;
  IGrim2D *in_stack_00000064;
  weapon_stats_t *in_stack_00000068;
  IGrim2D *in_stack_0000006c;
  IGrim2D *in_stack_00000070;
  float in_stack_00000074;
  IGrim2D *in_stack_00000078;
  int in_stack_0000007c;
  int in_stack_00000080;
  float in_stack_00000084;
  IGrim2D *in_stack_00000088;
  float in_stack_0000008c;
  int in_stack_00000090;
  IGrim2D in_stack_00000094;
  float in_stack_00000098;
  int in_stack_0000009c;
  float in_stack_000000a0;
  int in_stack_000000a4;
  undefined4 in_stack_000000a8;
  float in_stack_000000ac;
  uint uVar15;
  float fVar16;
  float in_stack_ffffffcc;
  float in_stack_ffffffd0;
  IGrim2D *in_stack_ffffffd4;
  IGrim2D *in_stack_ffffffdc;
  int in_stack_ffffffe0;
  float in_stack_ffffffe4;
  float in_stack_ffffffe8;
  IGrim2D *in_stack_ffffffec;
  float in_stack_fffffff0;
  float in_stack_fffffff4;
  IGrim2D *in_stack_fffffff8;
  IGrim2D *in_stack_fffffffc;
  
  if ((0.0 <= *(float *)((int)cv_uiTransparency + 0xc)) &&
     (*(float *)((int)cv_uiTransparency + 0xc) <= 1.0)) {
    in_stack_00000004 = in_stack_00000004 * *(float *)((int)cv_uiTransparency + 0xc);
  }
  fVar16 = 0.0;
  uVar15 = 0x41af18;
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,unaff_EDI);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,uVar15);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,fVar16);
  fVar16 = in_stack_00000004 * 0.7;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,fVar16,unaff_EDI);
  pIVar6 = grim_interface_ptr->vtable;
  pIVar4 = (IGrim2D *)(*pIVar6->grim_get_texture_handle)((IGrim2D *)s_iGameUI_00473894,(char *)0x0);
  (*pIVar6->grim_bind_texture)(pIVar4,unaff_ESI,unaff_EBP);
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,unaff_EBX);
  (*grim_interface_ptr->vtable->grim_set_uv)
            ((IGrim2D *)0x3b000000,0.015625,0.9980469,0.984375,in_stack_ffffffcc);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,in_stack_ffffffd0);
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_ffffffd4);
  uVar15 = 0x42800000;
  (*grim_interface_ptr->vtable->grim_draw_quad)((IGrim2D *)0x0,0.0,512.0,64.0,fVar16);
  fVar16 = 6.032496e-39;
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_ffffffdc);
  if (DAT_004871b0 != '\0') {
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,uVar15);
    if (config_blob.reserved0._20_4_ == 1) {
      in_stack_0000000c = 21.0;
      in_stack_00000018 = (IGrim2D *)0x41a80000;
    }
    else {
      in_stack_0000000c = 12.0;
      in_stack_00000018 = (IGrim2D *)0x41400000;
    }
    in_stack_00000014 = (char *)0x41d80000;
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000020 * 0.8,fVar16);
    pIVar6 = grim_interface_ptr->vtable;
    pIVar4 = (IGrim2D *)(*pIVar6->grim_get_texture_handle)((IGrim2D *)s_iHeart_0047388c,(char *)0x0)
    ;
    (*pIVar6->grim_bind_texture)(pIVar4,(int)in_stack_ffffffdc,in_stack_ffffffe0);
    (*grim_interface_ptr->vtable->grim_set_uv)
              ((IGrim2D *)0x3d000000,0.03125,0.96875,0.96875,in_stack_ffffffe4);
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,in_stack_ffffffe8);
    (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_ffffffec);
    in_stack_00000008 = 2.0;
    if (config_blob.reserved0._20_4_ == 1) {
      if ((float)player_health._pad0._0_4_ < 30.0) {
        in_stack_00000008 = 5.0;
      }
      fVar11 = (float10)fsin((float10)_DAT_0047ea4c * (float10)in_stack_00000008);
      crt_ci_pow();
      fVar12 = extraout_ST0 * (float10)4.0 + (float10)14.0;
      pIVar6 = grim_interface_ptr->vtable;
      in_stack_00000004 = (float)(fVar12 + fVar12);
      fVar13 = (float10)in_stack_00000030 - fVar12;
      fVar16 = in_stack_00000004;
    }
    else {
      if ((float)player_health._pad0._0_4_ < 30.0) {
        in_stack_00000008 = 5.0;
      }
      fVar11 = (float10)fsin((float10)_DAT_0047ea4c * (float10)in_stack_00000008);
      crt_ci_pow();
      fVar12 = (extraout_ST0_00 * (float10)4.0 + (float10)14.0) * (float10)0.5;
      in_stack_00000004 = (float)(fVar12 + fVar12);
      (*grim_interface_ptr->vtable->grim_draw_quad)
                ((IGrim2D *)(float)((float10)in_stack_0000002c - fVar12),
                 (float)((float10)in_stack_00000030 - fVar12),in_stack_00000004,in_stack_00000004,
                 in_stack_fffffff0);
      if (30.0 <= player2_health) {
        fVar12 = (float10)in_stack_0000000c;
      }
      else {
        fVar12 = (float10)5.0;
      }
      fVar12 = (float10)fsin((float10)_DAT_0047ea4c * fVar12 + (float10)1.5707964);
      in_stack_00000024 = (IGrim2D *)(float)fVar12;
      crt_ci_pow();
      pIVar6 = grim_interface_ptr->vtable;
      fVar12 = (extraout_ST0_01 * (float10)4.0 + (float10)14.0) * (float10)0.5;
      in_stack_00000008 = (float)(fVar12 + fVar12);
      fVar13 = ((float10)(float)in_stack_00000034 - fVar12) + (float10)15.0;
      fVar16 = in_stack_00000008;
      in_stack_fffffff0 = in_stack_00000008;
    }
    in_stack_00000020 = (IGrim2D *)(float)fVar11;
    (*pIVar6->grim_draw_quad)
              ((IGrim2D *)(float)((float10)in_stack_00000030 - fVar12),(float)fVar13,fVar16,
               in_stack_fffffff0,in_stack_fffffff4);
    in_stack_fffffff4 = 6.033398e-39;
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_fffffff8);
  }
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,(uint)in_stack_fffffff0);
  if (DAT_004871b1 != '\0') {
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_0000003c * 0.8,in_stack_fffffff4);
    (*grim_interface_ptr->vtable->grim_bind_texture)
              (ui_weapon_icons_texture,0,(int)in_stack_fffffff8);
    (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_fffffffc);
    if (config_blob.reserved0._20_4_ == 1) {
      (*grim_interface_ptr->vtable->grim_set_sub_rect)
                ((IGrim2D *)0x8,2,1,(&weapon_table)[player_health._pad0._668_4_].hud_icon_id << 1,
                 unaff_retaddr);
      fVar16 = 32.0;
      pIVar6 = grim_interface_ptr->vtable;
    }
    else {
      (*grim_interface_ptr->vtable->grim_set_sub_rect)
                ((IGrim2D *)0x8,2,1,(&weapon_table)[player_health._pad0._668_4_].hud_icon_id << 1,
                 unaff_retaddr);
      (*grim_interface_ptr->vtable->grim_draw_quad)
                ((IGrim2D *)0x435c0000,4.0,32.0,16.0,in_stack_00000004);
      (*grim_interface_ptr->vtable->grim_set_sub_rect)
                ((IGrim2D *)0x8,2,1,(&weapon_table)[player2_weapon_id].hud_icon_id << 1,
                 (int)in_stack_00000008);
      in_stack_00000008 = 16.0;
      in_stack_00000004 = 32.0;
      fVar16 = 20.0;
      pIVar6 = grim_interface_ptr->vtable;
    }
    (*pIVar6->grim_draw_quad)
              ((IGrim2D *)0x435c0000,fVar16,in_stack_00000004,in_stack_00000008,in_stack_0000000c);
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000010);
    in_stack_00000010 = (IGrim2D *)0x3f800000;
    in_stack_0000000c = 1.0;
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)in_stack_00000014);
  }
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,(uint)in_stack_0000000c);
  if (DAT_004871b0 != '\0') {
    (*grim_interface_ptr->vtable->grim_bind_texture)
              ((IGrim2D *)DAT_0048f7c0,0,(int)in_stack_00000010);
    (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)in_stack_00000014);
    if (config_blob.reserved0._20_4_ == 1) {
      in_stack_00000058 = (IGrim2D *)0x41800000;
    }
    else {
      in_stack_00000058 = (IGrim2D *)0x40c00000;
    }
    in_stack_00000054 = (IGrim2D *)0x42800000;
    render_overlay_player_index = 0;
    if (0 < (int)config_blob.reserved0._20_4_) {
      in_stack_00000038 = (weapon_stats_t *)((float)in_stack_00000060 * 0.5);
      in_stack_00000048 = (char *)((float)in_stack_00000060 * 0.8);
      do {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000038,(float)in_stack_00000018);
        (*grim_interface_ptr->vtable->grim_set_uv)
                  ((IGrim2D *)0x0,0.0,1.0,1.0,(float)in_stack_0000001c);
        in_stack_00000050 = (IGrim2D *)(render_overlay_player_index << 4);
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)0x42800000,(float)(int)in_stack_00000050 + (float)in_stack_00000060,
                   120.0,9.0,(float)in_stack_00000020);
        in_stack_0000003c =
             (IGrim2D *)(*(float *)(&player_health)[render_overlay_player_index]._pad0 * 0.01);
        if ((float)in_stack_0000003c <= 1.0) {
          if ((float)in_stack_0000003c < 0.0) {
            in_stack_0000003c = (IGrim2D *)0x0;
          }
        }
        else {
          in_stack_0000003c = (IGrim2D *)0x3f800000;
        }
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000048,(float)in_stack_00000024);
        (*grim_interface_ptr->vtable->grim_set_uv)
                  ((IGrim2D *)0x0,0.0,in_stack_00000040,1.0,in_stack_00000028);
        in_stack_00000024 = (IGrim2D *)((float)in_stack_00000044 * 120.0);
        in_stack_00000028 = 9.0;
        in_stack_0000005c = (IGrim2D *)(render_overlay_player_index << 4);
        in_stack_00000020 = (IGrim2D *)((float)(int)in_stack_0000005c + (float)in_stack_0000006c);
        in_stack_0000001c = (IGrim2D *)0x42800000;
        in_stack_00000018 = (IGrim2D *)0x41b606;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)0x42800000,(float)in_stack_00000020,(float)in_stack_00000024,9.0,
                   in_stack_0000002c);
        render_overlay_player_index = render_overlay_player_index + 1;
      } while (render_overlay_player_index < (int)config_blob.reserved0._20_4_);
    }
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000018);
  }
  if (DAT_004871b1 != '\0') {
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,(float)in_stack_0000001c);
    in_stack_0000001c = (IGrim2D *)0x3f800000;
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)in_stack_00000020);
    if (config_blob.reserved0._20_4_ == 1) {
      in_stack_00000054 = (IGrim2D *)0x43960000;
      in_stack_00000058 = (IGrim2D *)0x41200000;
      in_stack_00000064 = (IGrim2D *)0x41200000;
      in_stack_00000060 = (char *)0x43960000;
    }
    else {
      in_stack_00000054 = (IGrim2D *)0x43910000;
      in_stack_00000058 = (IGrim2D *)0x40800000;
      in_stack_00000064 = (IGrim2D *)0x40800000;
      in_stack_00000060 = (char *)0x43910000;
    }
    render_overlay_player_index = 0;
    if (0 < (int)config_blob.reserved0._20_4_) {
      do {
        iVar9 = (&weapon_ammo_class)
                [*(int *)((&player_health)[render_overlay_player_index]._pad0 + 0x29c) * 0x1f];
        if (iVar9 == 1) {
          in_stack_00000014 = s_ui_ui_indFire_jaz_00473878;
          pIVar6 = grim_interface_ptr->vtable;
        }
        else if (iVar9 == 0) {
          in_stack_00000014 = s_ui_ui_indBullet_jaz_00473864;
          pIVar6 = grim_interface_ptr->vtable;
        }
        else if (iVar9 == 2) {
          in_stack_00000014 = s_ui_ui_indRocket_jaz_00473850;
          pIVar6 = grim_interface_ptr->vtable;
        }
        else {
          in_stack_00000014 = s_ui_ui_indElectric_jaz_00473838;
          pIVar6 = grim_interface_ptr->vtable;
        }
        pIVar4 = (IGrim2D *)
                 (*pIVar6->grim_get_texture_handle)((IGrim2D *)in_stack_00000014,(char *)0x0);
        (*pIVar6->grim_bind_texture)(pIVar4,(int)in_stack_0000001c,(int)in_stack_00000020);
        (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_00000024);
        lVar14 = __ftol();
        iVar9 = (int)lVar14;
        if (0x1e < iVar9) {
          iVar9 = 0x14;
        }
        lVar14 = __ftol();
        in_stack_00000024 = (IGrim2D *)0x3f800000;
        in_stack_00000020 = (IGrim2D *)0x3f800000;
        in_stack_0000001c = (IGrim2D *)0x0;
        (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,in_stack_00000028);
        iVar7 = 0;
        if (0 < iVar9) {
          in_stack_00000044 = (IGrim2D *)0x0;
          do {
            if (iVar7 < (int)lVar14) {
              in_stack_00000028 = in_stack_00000074;
            }
            else {
              in_stack_00000028 = in_stack_00000074 * 0.3;
            }
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000028,in_stack_0000002c);
            in_stack_0000002c = 16.0;
            in_stack_00000028 = 6.0;
            in_stack_00000060 = (char *)(render_overlay_player_index * 0xe);
            in_stack_00000024 =
                 (IGrim2D *)((float)(int)in_stack_00000060 + (float)in_stack_00000070);
            in_stack_00000020 =
                 (IGrim2D *)((float)(int)in_stack_00000048 + (float)in_stack_0000006c);
            in_stack_0000001c = (IGrim2D *)0x41b823;
            (*grim_interface_ptr->vtable->grim_draw_quad)
                      (in_stack_00000020,(float)in_stack_00000024,6.0,16.0,in_stack_00000030);
            iVar7 = iVar7 + 1;
            in_stack_0000004c = (IGrim2D *)((int)&in_stack_0000004c[1].vtable + 2);
          } while (iVar7 < iVar9);
        }
        (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_0000001c);
        if (iVar9 < (int)lVar14) {
          in_stack_0000001c = in_stack_0000003c;
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_0000003c,(float)in_stack_00000020
                    );
          (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,0x3f800000);
          in_stack_0000004c = (IGrim2D *)(iVar7 * 6);
          (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                    (grim_interface_ptr,
                     (float)(int)in_stack_0000004c + (float)in_stack_00000058 + 8.0,
                     (float)(render_overlay_player_index * 0xe) + (float)in_stack_0000005c + 1.0,
                     &DAT_00473830);
        }
        render_overlay_player_index = render_overlay_player_index + 1;
      } while (render_overlay_player_index < (int)config_blob.reserved0._20_4_);
    }
  }
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000038,(float)in_stack_0000001c);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,0x3f800000);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,0x15);
  iVar9 = 0x4e;
  if (DAT_004871b3 != '\0') {
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,0x15);
    (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7c4,0,2);
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,2.94273e-44);
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,1.4013e-45);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000038,1.0);
    (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)in_stack_00000038);
    in_stack_00000034 = (float *)0x0;
    if (quest_spawn_timeline < 1000) {
      in_stack_0000004c = (IGrim2D *)(1000 - quest_spawn_timeline);
      in_stack_00000034 = (float *)((float)(int)in_stack_0000004c * -0.128);
    }
    (*grim_interface_ptr->vtable->grim_draw_quad)
              ((IGrim2D *)((float)in_stack_00000034 - 90.0),67.0,182.0,53.0,(float)in_stack_0000001c
              );
    (*grim_interface_ptr->vtable->grim_draw_quad)
              ((IGrim2D *)0xc2a00000,107.0,182.0,53.0,(float)in_stack_00000020);
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000024);
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,1.09301e-43);
    fVar16 = in_stack_00000074 * 0.9;
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,fVar16,in_stack_0000002c);
    (*grim_interface_ptr->vtable->grim_bind_texture)
              (ui_clock_table_texture,0,(int)in_stack_00000030);
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,(float)in_stack_00000034);
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)in_stack_00000038);
    (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_0000003c);
    in_stack_00000070 = (IGrim2D *)((float)in_stack_00000058 + 2.0);
    (*grim_interface_ptr->vtable->grim_draw_quad)(in_stack_00000070,78.0,32.0,32.0,fVar16);
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000044);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,0x42000000);
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,fVar16,6.036497e-39)
    ;
    (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7cc,0,(int)in_stack_00000044);
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)in_stack_00000048);
    (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_0000004c);
    in_stack_00000080 = quest_spawn_timeline / 1000;
    (*grim_interface_ptr->vtable->grim_set_rotation)
              ((IGrim2D *)((float)in_stack_00000080 * 0.10471976),(float)in_stack_00000050);
    (*grim_interface_ptr->vtable->grim_draw_quad)
              (in_stack_00000070,78.0,32.0,32.0,(float)in_stack_00000054);
    in_stack_00000054 = (IGrim2D *)0x41bc25;
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000058);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,0x42000000);
    in_stack_00000050 = (IGrim2D *)((quest_spawn_timeline / 1000) % 0x3c);
    if ((int)in_stack_00000050 < 10) {
      in_stack_00000048 = s__d_0_d_00473150;
    }
    else {
      in_stack_00000048 = s__d__d_00473148;
    }
    in_stack_0000004c = (IGrim2D *)((quest_spawn_timeline / 1000) / 0x3c);
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)in_stack_0000006c + 32.0,86.0,in_stack_00000048);
    (*grim_interface_ptr->vtable->grim_set_config_var)
              ((IGrim2D *)0x18,0x3ee66666,(uint)in_stack_00000048);
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,18.0,122.0,s_Progress_00473824);
    if ((DAT_0048f528 & 1) == 0) {
      DAT_0048f528 = DAT_0048f528 | 1;
      _DAT_004871a0 = 0x3e4ccccd;
      _DAT_004871a4 = 0x3f4ccccd;
      _DAT_004871a8 = 0x3e99999a;
      _DAT_004871ac = 1.0;
      crt_atexit(&DAT_0041ca80);
    }
    _DAT_004871ac = (float)in_stack_00000094.vtable * 0.8;
    in_stack_0000007c = 0;
    _DAT_004902fc = 0;
    if (0 < quest_spawn_count) {
      piVar5 = &quest_spawn_table.count;
      iVar9 = quest_spawn_count;
      do {
        iVar7 = *piVar5;
        piVar5 = piVar5 + 6;
        in_stack_0000007c = in_stack_0000007c + iVar7;
        iVar9 = iVar9 + -1;
      } while (iVar9 != 0);
    }
    in_stack_0000007c = creature_spawned_count + in_stack_0000007c;
    in_stack_00000088 = (IGrim2D *)0x41200000;
    DAT_004902f8 = (float)(int)highscore_active_record.creature_kill_count /
                   (float)in_stack_0000007c;
    in_stack_0000008c = 139.0;
    ui_draw_progress_bar((float *)&stack0x00000088,70.0,DAT_004902f8,(float *)&DAT_004871a0);
    iVar9 = 0x9e;
    in_stack_00000064 = (IGrim2D *)0x9e;
    if (DAT_00487244 < 500) {
      in_stack_0000007c = DAT_00487244 * 2;
      in_stack_0000005c = (IGrim2D *)((float)in_stack_0000007c * 0.001);
LAB_0041bde3:
      if (1.0 < (float)in_stack_0000005c) {
LAB_0041bdf8:
        in_stack_0000005c = (IGrim2D *)0x3f800000;
      }
    }
    else {
      if (DAT_00487244 < 0x5dc) goto LAB_0041bdf8;
      if (DAT_00487244 < 2000) {
        in_stack_0000007c = DAT_00487244 * 2 + -3000;
        in_stack_0000005c = (IGrim2D *)(1.0 - (float)in_stack_0000007c * 0.001);
        goto LAB_0041bde3;
      }
      in_stack_0000005c = (IGrim2D *)0x0;
    }
    in_stack_00000048 = (char *)((float)in_stack_0000005c * (float)in_stack_00000094.vtable);
    in_stack_00000044 = (IGrim2D *)0x3f800000;
    in_stack_00000040 = 1.0;
    in_stack_0000003c = (IGrim2D *)0x3f800000;
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000048,(float)in_stack_0000004c);
    in_stack_0000006c = (IGrim2D *)in_stack_00000048;
    if (0.0 <= (float)in_stack_00000060) {
      in_stack_00000064 = (IGrim2D *)0x3f4ccccd;
      uVar15 = 0xffffffff;
      pcVar10 = *(char **)(&quest_meta_name +
                          (_quest_stage_minor + -0xb + _quest_stage_major * 10) * 0x2c);
      do {
        if (uVar15 == 0) break;
        uVar15 = uVar15 - 1;
        cVar1 = *pcVar10;
        pcVar10 = pcVar10 + 1;
      } while (cVar1 != '\0');
      in_stack_0000008c = (float)(~uVar15 - 1);
      if (config_blob.screen_width < 0x281) {
        in_stack_00000064 = (IGrim2D *)0x3f400000;
      }
      (*grim_interface_ptr->vtable->grim_set_config_var)
                ((IGrim2D *)0x18,(uint)in_stack_00000064,0x3f800000);
      fVar16 = *(float *)(&quest_meta_name +
                         (_quest_stage_minor + -0xb + _quest_stage_major * 10) * 0x2c);
      in_stack_00000078 =
           (IGrim2D *)
           ((float)(config_blob.screen_width / 2) -
           (float)(int)in_stack_00000084 * (float)in_stack_0000005c * 8.0);
      in_stack_00000084 = (float)(config_blob.screen_height / 2 + -0x20);
      fVar2 = (float)(int)in_stack_00000084;
      (*grim_interface_ptr->vtable->grim_draw_text_mono)
                (in_stack_00000078,fVar2,fVar16,in_stack_00000048);
      in_stack_00000060 = (char *)((float)in_stack_00000060 - 0.2);
      (*grim_interface_ptr->vtable->grim_set_config_var)
                ((IGrim2D *)0x18,(uint)in_stack_00000060,(uint)fVar2);
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000064 * 0.5,fVar16);
      if (10 < _quest_stage_minor) {
        _quest_stage_major = _quest_stage_major + 1;
        _quest_stage_minor = _quest_stage_minor + -10;
      }
      crt_sprintf(&DAT_0048f788,s__d__d_0047381c);
      in_stack_00000084 = (float)(config_blob.screen_height / 2 + -0x20);
      in_stack_00000044 = (IGrim2D *)&DAT_0048f788;
      uVar15 = 0xffffffff;
      pcVar10 = &DAT_0048f788;
      do {
        if (uVar15 == 0) break;
        uVar15 = uVar15 - 1;
        cVar1 = *pcVar10;
        pcVar10 = pcVar10 + 1;
      } while (cVar1 != '\0');
      in_stack_00000040 =
           ((float)in_stack_0000005c * 23.36 + (float)(int)in_stack_00000084) -
           (float)in_stack_0000005c * 16.0;
      in_stack_00000068 = (weapon_stats_t *)(~uVar15 - 1);
      in_stack_0000006c = (IGrim2D *)0x0;
      in_stack_0000003c =
           (IGrim2D *)
           ((((float)in_stack_00000078 - (float)in_stack_00000068 * (float)in_stack_0000005c * 8.0)
            - (float)in_stack_0000005c * 32.0) - 4.0);
      (*grim_interface_ptr->vtable->grim_draw_text_mono_fmt)
                (grim_interface_ptr,(float)in_stack_0000003c,in_stack_00000040,&DAT_0048f788);
    }
    if (0 < DAT_00487088) {
      if (DAT_00487088 < 500) {
        in_stack_00000058 = (IGrim2D *)((float)DAT_00487088 * 0.002);
LAB_0041c0be:
        if ((float)in_stack_00000058 <= 1.0) {
          if ((float)in_stack_00000058 < 0.0) goto LAB_0041c0ee;
        }
        else {
          in_stack_00000058 = (IGrim2D *)0x3f800000;
        }
      }
      else if (DAT_00487088 < 0x5dc) {
        in_stack_00000058 = (IGrim2D *)0x3f800000;
      }
      else {
        if (DAT_00487088 < 0x9c4) {
          in_stack_00000084 = (float)(2000 - DAT_00487088);
          in_stack_00000058 = (IGrim2D *)((float)(int)in_stack_00000084 * 0.002 + 1.0);
          goto LAB_0041c0be;
        }
LAB_0041c0ee:
        in_stack_00000058 = (IGrim2D *)0x0;
      }
      (*grim_interface_ptr->vtable->grim_set_config_var)
                ((IGrim2D *)0x18,0x3f800000,(uint)in_stack_0000003c);
      in_stack_00000054 = (IGrim2D *)((float)DAT_00487088 * 0.0004 * 0.13 + 0.95);
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000050 * (float)in_stack_00000088,
                 in_stack_00000040);
      (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7a0,0,(int)in_stack_00000044);
      (*grim_interface_ptr->vtable->grim_set_uv)
                ((IGrim2D *)0x0,0.0,1.0,1.0,(float)in_stack_00000048);
      in_stack_00000048 = (char *)((float)in_stack_00000060 * 32.0);
      in_stack_00000044 = (IGrim2D *)((float)in_stack_00000060 * 256.0);
      in_stack_00000040 = (float)(config_blob.screen_height / 2) - (float)in_stack_00000060 * 16.0;
      in_stack_00000088 = (IGrim2D *)(config_blob.screen_width / 2);
      in_stack_0000003c =
           (IGrim2D *)((float)(int)in_stack_00000088 - (float)in_stack_00000060 * 128.0);
      (*grim_interface_ptr->vtable->grim_draw_quad)
                (in_stack_0000003c,in_stack_00000040,(float)in_stack_00000044,
                 (float)in_stack_00000048,(float)in_stack_0000004c);
      in_stack_0000004c = (IGrim2D *)0x41c201;
      (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000050);
    }
  }
  if (DAT_004871b4 != '\0') {
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,(uint)in_stack_0000003c);
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,in_stack_00000040);
    fVar16 = in_stack_0000008c * 0.9;
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,fVar16,(float)in_stack_00000044);
    (*grim_interface_ptr->vtable->grim_bind_texture)
              (ui_clock_table_texture,0,(int)in_stack_00000048);
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,(float)in_stack_0000004c);
    in_stack_00000040 = 0.0;
    in_stack_0000003c = (IGrim2D *)0x41c2b5;
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)in_stack_00000050);
    (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_00000054);
    (*grim_interface_ptr->vtable->grim_draw_quad)((IGrim2D *)0x435c0000,2.0,32.0,32.0,fVar16);
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_0000005c);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,0x42000000);
    in_stack_00000048 = (char *)0x3f800000;
    in_stack_00000044 = (IGrim2D *)0x41c329;
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,fVar16,6.039242e-39)
    ;
    (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7cc,0,(int)in_stack_0000005c);
    in_stack_0000004c = (IGrim2D *)0x41c35b;
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)in_stack_00000060);
    (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_00000064);
    in_stack_000000a4 = (int)highscore_active_record.survival_elapsed_ms / 1000;
    (*grim_interface_ptr->vtable->grim_set_rotation)
              ((IGrim2D *)((float)in_stack_000000a4 * 0.10471976),(float)in_stack_00000068);
    (*grim_interface_ptr->vtable->grim_draw_quad)
              ((IGrim2D *)0x435c0000,2.0,32.0,32.0,(float)in_stack_0000006c);
    in_stack_0000006c = (IGrim2D *)0x41c3d0;
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000070);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,0x42000000);
    in_stack_00000068 = in_stack_00000038;
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000038,6.039552e-39);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,0x3f800000);
    in_stack_00000064 = (IGrim2D *)((int)highscore_active_record.survival_elapsed_ms / 1000);
    in_stack_00000060 = s__d_seconds_00473810;
    in_stack_0000005c = (IGrim2D *)0x41200000;
    in_stack_00000058 = (IGrim2D *)0x437f0000;
    in_stack_00000054 = grim_interface_ptr;
    in_stack_00000050 = (IGrim2D *)0x41c454;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,255.0,10.0,s__d_seconds_00473810);
  }
  if (DAT_004871b2 == '\0') goto LAB_0041c783;
  (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7c4,0,(int)in_stack_00000048);
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,(float)in_stack_0000004c);
  in_stack_0000003c = (IGrim2D *)0x41c4a6;
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)in_stack_00000050);
  in_stack_00000044 = (IGrim2D *)0x3f800000;
  in_stack_00000040 = 6.039893e-39;
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000038,(float)in_stack_00000054);
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_00000058);
  in_stack_00000098 = (float)(iVar9 + -0x12);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)0xc2880000,(float)(int)in_stack_00000098,182.0,53.0,(float)in_stack_0000005c
            );
  (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)in_stack_00000060);
  if (player_health._pad0._136_4_ == 0) {
    survival_xp_smoothed._0_1_ = player_health._pad0[0x88];
    survival_xp_smoothed._1_1_ = player_health._pad0[0x89];
    survival_xp_smoothed._2_1_ = player_health._pad0[0x8a];
    survival_xp_smoothed._3_1_ = player_health._pad0[0x8b];
  }
  else if (survival_xp_smoothed < (int)player_health._pad0._136_4_) {
    iVar7 = frame_dt_ms / 2;
    if (iVar7 < 1) {
      iVar7 = 1;
    }
    uVar15 = survival_xp_smoothed - player_health._pad0._136_4_ >> 0x1f;
    iVar8 = (survival_xp_smoothed - player_health._pad0._136_4_ ^ uVar15) - uVar15;
    if (1000 < iVar8) {
      iVar7 = iVar7 * (iVar8 / 100);
    }
    survival_xp_smoothed = survival_xp_smoothed + iVar7;
    if ((int)player_health._pad0._136_4_ < survival_xp_smoothed) {
LAB_0041c5bf:
      survival_xp_smoothed._0_1_ = player_health._pad0[0x88];
      survival_xp_smoothed._1_1_ = player_health._pad0[0x89];
      survival_xp_smoothed._2_1_ = player_health._pad0[0x8a];
      survival_xp_smoothed._3_1_ = player_health._pad0[0x8b];
    }
  }
  else if ((int)player_health._pad0._136_4_ < survival_xp_smoothed) {
    iVar7 = frame_dt_ms / 2;
    if (iVar7 < 1) {
      iVar7 = 1;
    }
    uVar15 = survival_xp_smoothed - player_health._pad0._136_4_ >> 0x1f;
    iVar8 = (survival_xp_smoothed - player_health._pad0._136_4_ ^ uVar15) - uVar15;
    if (1000 < iVar8) {
      iVar7 = iVar7 * (iVar8 / 100);
    }
    survival_xp_smoothed = survival_xp_smoothed - iVar7;
    if (survival_xp_smoothed < (int)player_health._pad0._136_4_) goto LAB_0041c5bf;
  }
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_000000ac * 0.9,(float)in_stack_00000064);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,0x3f800000);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,4.0,(float)(int)in_stack_00000078,&DAT_0047380c);
  in_stack_0000009c = iVar9 + -4;
  in_stack_00000048 = (char *)0x41c659;
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,26.0,(float)in_stack_0000009c,&DAT_00471f40);
  DAT_00496604 = in_stack_000000a8;
  (*grim_interface_ptr->vtable->grim_set_color_ptr)
            ((IGrim2D *)&DAT_004965f8,(float *)(in_stack_000000ac * 0.9));
  in_stack_000000a0 = (float)(iVar9 + 1);
  in_stack_0000004c = (IGrim2D *)0x41c6a7;
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,85.0,(float)(int)in_stack_000000a0,&DAT_00471f40);
  uVar3 = player_health._pad0._144_4_;
  DAT_00496604 = 0x3f333333;
  in_stack_000000a0 = (float)(player_health._pad0._144_4_ + -1);
  crt_ci_pow();
  lVar14 = __ftol();
  iVar7 = 1000 - (int)lVar14;
  if (uVar3 == 1) {
    iVar7 = 0;
  }
  in_stack_00000090 = in_stack_00000080;
  in_stack_00000098 = (float)(iVar9 + 0xd);
  in_stack_000000a0 = (float)(player_health._pad0._136_4_ - iVar7);
  in_stack_00000084 = 0.1;
  in_stack_00000088 = (IGrim2D *)0x3e99999a;
  in_stack_0000008c = 0.6;
  in_stack_00000094.vtable = (IGrim2D_vtbl *)0x41d00000;
  crt_ci_pow();
  in_stack_000000a0 = (float)extraout_ST0_02;
  lVar14 = __ftol();
  in_stack_00000054 = &stack0x00000094;
  in_stack_000000a0 = (float)((1000 - (int)lVar14) - iVar7);
  in_stack_0000005c = (IGrim2D *)(float)(extraout_ST0_03 / (float10)(int)in_stack_000000a0);
  in_stack_00000058 = (IGrim2D *)0x42580000;
  in_stack_00000050 = (IGrim2D *)0x41c779;
  ui_draw_progress_bar((float *)in_stack_00000054,54.0,(float)in_stack_0000005c,&stack0x00000084);
  in_stack_0000007c = iVar9 + 0x2b;
LAB_0041c783:
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,(uint)in_stack_0000003c);
  in_stack_00000078 = (IGrim2D *)(float)(int)in_stack_00000058;
  iVar9 = 0;
  do {
    in_stack_00000034 = (float *)&stack0x00000078;
    bonus_hud_slot_update_and_render(in_stack_00000034,iVar9);
    iVar9 = iVar9 + 1;
  } while (iVar9 < 0x10);
  lVar14 = __ftol();
  pIVar4 = (IGrim2D *)((int)lVar14 + 1);
  render_overlay_player_index = 0;
  if (0 < (int)config_blob.reserved0._20_4_) {
    iVar9 = (int)lVar14 + -5;
    in_stack_00000058 = pIVar4;
    in_stack_00000060 = (char *)iVar9;
    do {
      if (0.0 < (float)(&DAT_004871d0)[render_overlay_player_index]) {
        fVar16 = (float)(&DAT_004871d0)[render_overlay_player_index];
        if (1.0 <= fVar16) {
          fVar2 = 1.4;
        }
        else {
          fVar2 = 0.5;
        }
        (&DAT_004871d0)[render_overlay_player_index] =
             (float)(&DAT_004871d0)[render_overlay_player_index] - frame_dt * fVar2;
        if (1.0 < fVar16) {
          fVar16 = 2.0 - fVar16;
        }
        if (fVar16 < 0.0) {
          fVar16 = 0.0;
        }
        in_stack_00000034 = (float *)0x3f800000;
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,fVar16 * (float)in_stack_00000088 * 0.8,
                   in_stack_00000040);
        (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7c4,0,(int)in_stack_00000044);
        (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,(float)in_stack_00000048);
        (*grim_interface_ptr->vtable->grim_set_uv)
                  ((IGrim2D *)0x0,0.0,1.0,1.0,(float)in_stack_0000004c);
        (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_00000050);
        in_stack_00000090 = iVar9 + -0xc;
        in_stack_00000048 = (char *)(float)in_stack_00000090;
        in_stack_00000044 = (IGrim2D *)0xc1400000;
        in_stack_00000040 = 6.041435e-39;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)0xc1400000,(float)in_stack_00000048,182.0,53.0,
                   (float)in_stack_00000054);
        (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000058);
        (*grim_interface_ptr->vtable->grim_bind_texture)
                  (ui_weapon_icons_texture,0,(int)in_stack_0000005c);
        in_stack_00000050 = (IGrim2D *)0x8;
        in_stack_0000004c = (IGrim2D *)0x41c96e;
        (*grim_interface_ptr->vtable->grim_set_sub_rect)
                  ((IGrim2D *)0x8,2,1,
                   (&weapon_table)
                   [*(int *)((&player_health)[render_overlay_player_index]._pad0 + 0x29c)].
                   hud_icon_id << 1,(int)in_stack_00000060);
        (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_00000064);
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)0x42d20000,(float)(int)in_stack_00000088,60.0,30.0,
                   (float)in_stack_00000068);
        (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_0000006c);
        (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,0x41f00000);
        in_stack_00000058 = (IGrim2D *)0x3f800000;
        in_stack_00000054 = (IGrim2D *)0x41c9e9;
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000098,6.041658e-39);
        in_stack_00000064 = (IGrim2D *)(float)(int)in_stack_00000084;
        in_stack_00000068 =
             &weapon_table + *(int *)((&player_health)[render_overlay_player_index]._pad0 + 0x29c);
        in_stack_00000060 = (char *)0x41000000;
        in_stack_0000005c = (IGrim2D *)0x41ca27;
        (*grim_interface_ptr->vtable->grim_draw_text_small)
                  ((IGrim2D *)0x41000000,(float)in_stack_00000064,(float)in_stack_00000068,
                   (char *)in_stack_0000006c);
        pIVar4 = pIVar4 + 8;
        iVar9 = iVar9 + 0x20;
        in_stack_00000088 = pIVar4;
        in_stack_00000090 = iVar9;
      }
      render_overlay_player_index = render_overlay_player_index + 1;
    } while (render_overlay_player_index < (int)config_blob.reserved0._20_4_);
  }
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,(uint)in_stack_00000034);
  render_overlay_player_index = 0;
  return;
}



/* hud_update_and_render @ 0041ca90 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* updates HUD flags/targets and renders the HUD */

void hud_update_and_render(void)

{
  float fVar1;
  float unaff_EBX;
  float local_28;
  float local_20;
  float local_1c;
  float local_14;
  float local_10;
  float local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  fVar1 = (float)ui_elements_timeline / (float)(DAT_0048eb48 - DAT_0048eb4c);
  if ((1.0 < fVar1) || (fVar1 == 1.0)) {
    DAT_00487241 = 0;
  }
  if (DAT_00487268 != -1) {
    local_14 = _camera_offset_y + (&creature_pool)[DAT_00487268].pos_y;
    local_28 = (&creature_pool)[DAT_00487268].health / (&creature_pool)[DAT_00487268].max_health;
    if (local_28 <= 1.0) {
      if (local_28 < 0.0) {
        local_28 = 0.0;
      }
    }
    else {
      local_28 = 1.0;
    }
    local_8 = 0x3e4ccccd;
    local_10 = (1.0 - local_28) * 0.9 + 0.1;
    local_4 = 0x3f333333;
    local_c = local_28 * 0.9 + 0.1;
    local_20 = (_camera_offset_x + (&creature_pool)[DAT_00487268].pos_x) - 32.0;
    local_1c = local_14 + 32.0;
    ui_draw_progress_bar(&local_20,64.0,local_28,&local_10);
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_EBX);
  }
  if (config_blob.reserved0._24_4_ == 3) {
    DAT_004871b0 = 1;
    DAT_004871b1 = 1;
    DAT_004871b2 = 1;
    DAT_004871b3 = 1;
  }
  else {
    if (config_blob.reserved0._24_4_ == 1) {
      DAT_004871b0 = 1;
      DAT_004871b1 = 1;
      DAT_004871b2 = 1;
    }
    else {
      if (config_blob.reserved0._24_4_ == 2) {
        DAT_004871b0 = 1;
        DAT_004871b1 = 0;
        DAT_004871b2 = 0;
        DAT_004871b3 = 0;
        DAT_004871b4 = 1;
        goto LAB_0041cc88;
      }
      if (config_blob.reserved0._24_4_ == 4) {
        DAT_004871b0 = 1;
        DAT_004871b1 = 0;
        DAT_004871b2 = 1;
        DAT_004871b3 = 0;
        DAT_004871b4 = 1;
        goto LAB_0041cc88;
      }
      DAT_004871b0 = 0;
      DAT_004871b1 = 0;
      DAT_004871b2 = 0;
    }
    DAT_004871b3 = 0;
  }
  DAT_004871b4 = 0;
LAB_0041cc88:
  if (demo_mode_active == '\0') {
    ui_render_hud();
  }
  return;
}



/* dx_get_version @ 0041ccb0 */

/* query DirectX version */

int __cdecl dx_get_version(int *version,char *out,int out_len)

{
  char *dst;
  int size;
  char cVar1;
  int iVar2;
  int local_4;
  
  size = out_len;
  dst = out;
  if (version != (int *)0x0) {
    *version = 0;
  }
  if ((out != (char *)0x0) && (0 < out_len)) {
    *out = '\0';
  }
  out_len = 0;
  local_4 = 0;
  out = (char *)CONCAT31(out._1_3_,0x20);
  iVar2 = FUN_0041cdb0();
  if (iVar2 < 0) {
    iVar2 = FUN_0041cfe0(&out_len,&local_4,(char *)&out);
    if (iVar2 < 0) {
      return -0x7fffbffb;
    }
  }
  iVar2 = crt_tolower((int)(char)out);
  cVar1 = (char)iVar2;
  out = (char *)CONCAT31(out._1_3_,cVar1);
  if (version != (int *)0x0) {
    iVar2 = (out_len * 0x100 + local_4) * 0x100;
    if (('`' < cVar1) && (cVar1 < '{')) {
      iVar2 = iVar2 + -0x60 + (int)cVar1;
    }
    *version = iVar2;
  }
  if ((dst != (char *)0x0) && (0 < size)) {
    if (cVar1 == ' ') {
      crt_snprintf(dst,size,s__d__d_0047381c,out_len,local_4);
      dst[size + -1] = '\0';
      return 0;
    }
    crt_snprintf(dst,size,s__d__d_c_0047389c,out_len,local_4,(int)cVar1);
    dst[size + -1] = '\0';
  }
  return 0;
}



/* FUN_0041cdb0 @ 0041cdb0 */

/* WARNING: Removing unreachable block (ram,0x0041ce9f) */
/* WARNING: Removing unreachable block (ram,0x0041cea7) */
/* WARNING: Removing unreachable block (ram,0x0041cead) */
/* WARNING: Removing unreachable block (ram,0x0041cf52) */
/* WARNING: Removing unreachable block (ram,0x0041cf5a) */
/* WARNING: Enum "tagCALLCONV": Some values do not have unique names */

int FUN_0041cdb0(void)

{
  HRESULT HVar1;
  HRESULT HVar2;
  int iVar3;
  char cVar4;
  int *unaff_EDI;
  undefined4 uStack_74;
  int *piVar5;
  wchar_t *pwStack_64;
  wchar_t *pwStack_60;
  undefined2 uVar6;
  undefined4 uVar7;
  undefined4 lpWideCharStr;
  undefined2 uVar8;
  undefined4 local_3c;
  undefined4 uStack_38;
  _union_2156 local_34;
  undefined4 *puStack_24;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  HVar1 = CoInitialize((LPVOID)0x0);
  local_34._0_4_ = (wchar_t *)0x0;
  local_3c = (uint)(-1 < HVar1) << 0x18;
  HVar2 = CoCreateInstance((IID *)&DAT_0046f5c8,(LPUNKNOWN)0x0,1,(IID *)&DAT_0046f5b8,
                           (LPVOID *)&local_34);
  if (HVar2 < 0) {
    cVar4 = '\0';
  }
  else {
    local_10 = 0x10;
    local_c = 0x6f;
    local_8 = 0;
    local_4 = 0;
    uVar7 = local_34._0_4_;
    iVar3 = (**(code **)(*(int *)local_34._0_4_ + 0xc))();
    if (-1 < iVar3) {
      uStack_38 = (int *)0x0;
      iVar3 = (**(code **)(*(int *)local_3c + 0x10))();
      if (-1 < iVar3) {
        lpWideCharStr = &stack0xffffffc0;
        iVar3 = (**(code **)(iRam00000000 + 0x14))();
        if (iVar3 < 0) {
          cVar4 = (char)lpWideCharStr;
          pwStack_60 = (wchar_t *)0x41cf96;
          (**(code **)(*unaff_EDI + 8))();
          pwStack_60 = (wchar_t *)uVar7;
          pwStack_64 = (wchar_t *)0x41cfa0;
          (**(code **)(*(int *)pwStack_60 + 8))();
        }
        else {
          pwStack_60 = (wchar_t *)0x41ce7f;
          pwStack_64 = (wchar_t *)uVar7;
          VariantInit((VARIANTARG *)&local_34.field0);
          pwStack_60 = u_dwDirectXVersionMajor_00473900;
          uVar7 = pwStack_64;
          (**(code **)(*(int *)pwStack_64 + 0x20))();
          uVar8 = (undefined2)uVar7;
          VariantClear((VARIANTARG *)&stack0xffffffc0);
          piVar5 = (int *)&stack0xffffffc0;
          uVar7 = uStack_38;
          iVar3 = (**(code **)(*(int *)uStack_38 + 0x20))();
          uVar6 = (undefined2)uVar7;
          if (((-1 < iVar3) && (uVar8 == 0x13)) && (puStack_24 != (undefined4 *)0x0)) {
            *puStack_24 = unaff_EDI;
          }
          VariantClear((VARIANTARG *)&stack0xffffffb4);
          iVar3 = (**(code **)(*(int *)pwStack_64 + 0x20))
                            (pwStack_64,u_szDirectXVersionLetter_004738a4,&stack0xffffffb4);
          uStack_74 = uStack_38;
          if (((-1 < iVar3) && (uVar6 == 8)) && ((LPCWCH)lpWideCharStr != (LPCWCH)0x0)) {
            WideCharToMultiByte(0,0,(LPCWCH)lpWideCharStr,-1,(LPSTR)&pwStack_64,10,(LPCCH)0x0,
                                (LPBOOL)0x0);
            if ((undefined1 *)local_34._8_4_ != (undefined1 *)0x0) {
              *(undefined1 *)local_34._8_4_ = pwStack_64._0_1_;
            }
            uStack_74._3_1_ = (undefined1)((uint)uStack_38 >> 0x18);
            uStack_74._0_3_ = CONCAT12(1,(short)uStack_38);
          }
          VariantClear((VARIANTARG *)&stack0xffffffa8);
          cVar4 = (char)uStack_74;
          (**(code **)(u_dwDirectXVersionMinor_004738d4._0_4_ + 8))
                    (u_dwDirectXVersionMinor_004738d4);
          (**(code **)(*piVar5 + 8))(piVar5);
          (**(code **)(*(int *)uStack_74 + 8))(uStack_74);
        }
        goto LAB_0041cfb6;
      }
    }
    cVar4 = (char)unaff_EDI;
    (**(code **)(*(int *)local_3c + 8))();
  }
LAB_0041cfb6:
  if (-1 < HVar1) {
    CoUninitialize();
  }
  return (-(uint)(cVar4 != '\0') & 0x7fffbffb) + 0x80004005;
}



/* FUN_0041cfe0 @ 0041cfe0 */

/* [binja] int32_t sub_41cfe0(int32_t* arg1, int32_t* arg2, char* arg3) */

int __cdecl FUN_0041cfe0(int *arg1,int *arg2,char *arg3)

{
  char cVar1;
  bool bVar2;
  UINT UVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  char *pcVar7;
  char *pcVar8;
  char *pcVar9;
  undefined8 uVar10;
  uint local_408;
  uint local_404;
  char local_400 [512];
  CHAR local_200 [259];
  undefined1 local_fd;
  
  bVar2 = false;
  UVar3 = GetSystemDirectoryA(local_200,0x104);
  if (UVar3 == 0) goto LAB_0041db13;
  uVar4 = 0xffffffff;
  local_fd = 0;
  pcVar7 = local_200;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = local_400;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar4 = 0xffffffff;
  pcVar7 = s__ddraw_dll_004739ac;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  iVar6 = -1;
  pcVar7 = local_400;
  do {
    pcVar8 = pcVar7;
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    pcVar8 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar1 != '\0');
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = pcVar8 + -1;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar6 = FUN_0041db50((uint)local_400,(int *)&local_408);
  if (-1 < iVar6) {
    uVar10 = FUN_0041dc10(4,2,0,0x5f);
    iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
    if (-1 < iVar6) {
      if (arg1 != (int *)0x0) {
        *arg1 = 1;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 0;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = ' ';
      }
      bVar2 = true;
    }
    uVar10 = FUN_0041dc10(4,3,0,0x448);
    iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
    if (-1 < iVar6) {
      if (arg1 != (int *)0x0) {
        *arg1 = 2;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 0;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = ' ';
      }
      bVar2 = true;
    }
    uVar10 = FUN_0041dc10(4,4,0,0x44);
    iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
    if (-1 < iVar6) {
      if (arg1 != (int *)0x0) {
        *arg1 = 3;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 0;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = ' ';
      }
      bVar2 = true;
    }
  }
  uVar4 = 0xffffffff;
  pcVar7 = local_200;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = local_400;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar4 = 0xffffffff;
  pcVar7 = &DAT_0047399c;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  iVar6 = -1;
  pcVar7 = local_400;
  do {
    pcVar8 = pcVar7;
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    pcVar8 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar1 != '\0');
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = pcVar8 + -1;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar6 = FUN_0041db50((uint)local_400,(int *)&local_408);
  if (-1 < iVar6) {
    uVar10 = FUN_0041dc10(4,4,0,0x46);
    iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
    if (-1 < iVar6) {
      if (arg1 != (int *)0x0) {
        *arg1 = 3;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 0;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = 'a';
      }
      bVar2 = true;
    }
  }
  uVar4 = 0xffffffff;
  pcVar7 = local_200;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = local_400;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar4 = 0xffffffff;
  pcVar7 = s__ddraw_dll_004739ac;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  iVar6 = -1;
  pcVar7 = local_400;
  do {
    pcVar8 = pcVar7;
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    pcVar8 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar1 != '\0');
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = pcVar8 + -1;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar6 = FUN_0041db50((uint)local_400,(int *)&local_408);
  if (-1 < iVar6) {
    uVar10 = FUN_0041dc10(4,5,0,0x9b);
    iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
    if (-1 < iVar6) {
      if (arg1 != (int *)0x0) {
        *arg1 = 5;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 0;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = ' ';
      }
      bVar2 = true;
    }
    uVar10 = FUN_0041dc10(4,6,0,0x13e);
    iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
    if (-1 < iVar6) {
      if (arg1 != (int *)0x0) {
        *arg1 = 6;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 0;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = ' ';
      }
      bVar2 = true;
    }
    uVar10 = FUN_0041dc10(4,6,0,0x1b4);
    iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
    if (-1 < iVar6) {
      if (arg1 != (int *)0x0) {
        *arg1 = 6;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 1;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = ' ';
      }
      bVar2 = true;
    }
  }
  uVar4 = 0xffffffff;
  pcVar7 = local_200;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = local_400;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar4 = 0xffffffff;
  pcVar7 = &DAT_00473990;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  iVar6 = -1;
  pcVar7 = local_400;
  do {
    pcVar8 = pcVar7;
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    pcVar8 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar1 != '\0');
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = pcVar8 + -1;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar6 = FUN_0041db50((uint)local_400,(int *)&local_408);
  if (-1 < iVar6) {
    uVar10 = FUN_0041dc10(4,6,3,0x206);
    iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
    if (-1 < iVar6) {
      if (arg1 != (int *)0x0) {
        *arg1 = 6;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 1;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = 'a';
      }
      bVar2 = true;
    }
  }
  uVar4 = 0xffffffff;
  pcVar7 = local_200;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = local_400;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar4 = 0xffffffff;
  pcVar7 = s__ddraw_dll_004739ac;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  iVar6 = -1;
  pcVar7 = local_400;
  do {
    pcVar8 = pcVar7;
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    pcVar8 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar1 != '\0');
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = pcVar8 + -1;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar6 = FUN_0041db50((uint)local_400,(int *)&local_408);
  if (-1 < iVar6) {
    uVar10 = FUN_0041dc10(4,7,0,700);
    iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
    if (-1 < iVar6) {
      if (arg1 != (int *)0x0) {
        *arg1 = 7;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 0;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = ' ';
      }
      bVar2 = true;
    }
  }
  uVar4 = 0xffffffff;
  pcVar7 = local_200;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = local_400;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar4 = 0xffffffff;
  pcVar7 = s__dinput_dll_00473984;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  iVar6 = -1;
  pcVar7 = local_400;
  do {
    pcVar8 = pcVar7;
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    pcVar8 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar1 != '\0');
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = pcVar8 + -1;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar6 = FUN_0041db50((uint)local_400,(int *)&local_408);
  if (-1 < iVar6) {
    uVar10 = FUN_0041dc10(4,7,0,0x2cc);
    iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
    if (-1 < iVar6) {
      if (arg1 != (int *)0x0) {
        *arg1 = 7;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 0;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = 'a';
      }
      bVar2 = true;
    }
  }
  uVar4 = 0xffffffff;
  pcVar7 = local_200;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = local_400;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar4 = 0xffffffff;
  pcVar7 = s__ddraw_dll_004739ac;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  iVar6 = -1;
  pcVar7 = local_400;
  do {
    pcVar8 = pcVar7;
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    pcVar8 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar1 != '\0');
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = pcVar8 + -1;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar6 = FUN_0041db50((uint)local_400,(int *)&local_408);
  if (-1 < iVar6) {
    if (local_404 >> 0x10 == 4) {
      uVar10 = FUN_0041dc10(4,8,0,400);
      iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
      if (iVar6 < 0) goto LAB_0041d692;
LAB_0041d6c4:
      if (arg1 != (int *)0x0) {
        *arg1 = 8;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 0;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = ' ';
      }
      bVar2 = true;
    }
    else {
LAB_0041d692:
      if (local_404 >> 0x10 == 5) {
        uVar10 = FUN_0041dc10(5,1,0x8d2,400);
        iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
        if (-1 < iVar6) goto LAB_0041d6c4;
      }
    }
  }
  uVar4 = 0xffffffff;
  pcVar7 = local_200;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = local_400;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar4 = 0xffffffff;
  pcVar7 = &DAT_00473978;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  iVar6 = -1;
  pcVar7 = local_400;
  do {
    pcVar8 = pcVar7;
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    pcVar8 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar1 != '\0');
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = pcVar8 + -1;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar6 = FUN_0041db50((uint)local_400,(int *)&local_408);
  if (-1 < iVar6) {
    if (local_404 >> 0x10 == 4) {
      uVar10 = FUN_0041dc10(4,8,1,0x371);
      iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
      if (iVar6 < 0) goto LAB_0041d79c;
LAB_0041d7d0:
      if (arg1 != (int *)0x0) {
        *arg1 = 8;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 1;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = ' ';
      }
      bVar2 = true;
    }
    else {
LAB_0041d79c:
      if (local_404 >> 0x10 == 5) {
        uVar10 = FUN_0041dc10(5,1,0xa28,0x371);
        iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
        if (-1 < iVar6) goto LAB_0041d7d0;
      }
    }
    if (local_404 >> 0x10 == 4) {
      uVar10 = FUN_0041dc10(4,8,1,0x385);
      iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
      if (iVar6 < 0) goto LAB_0041d84c;
LAB_0041d87e:
      if (arg1 != (int *)0x0) {
        *arg1 = 8;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 1;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = 'a';
      }
      bVar2 = true;
    }
    else {
LAB_0041d84c:
      if (local_404 >> 0x10 == 5) {
        uVar10 = FUN_0041dc10(5,1,0xa28,0x385);
        iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
        if (-1 < iVar6) goto LAB_0041d87e;
      }
    }
  }
  uVar4 = 0xffffffff;
  pcVar7 = local_200;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = local_400;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar4 = 0xffffffff;
  pcVar7 = &DAT_00473968;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  iVar6 = -1;
  pcVar7 = local_400;
  do {
    pcVar8 = pcVar7;
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    pcVar8 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar1 != '\0');
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = pcVar8 + -1;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar6 = FUN_0041db50((uint)local_400,(int *)&local_408);
  if (-1 < iVar6) {
    uVar10 = FUN_0041dc10(6,3,1,0x375);
    iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
    if (-1 < iVar6) {
      if (arg1 != (int *)0x0) {
        *arg1 = 8;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 1;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = 'b';
      }
      bVar2 = true;
    }
  }
  uVar4 = 0xffffffff;
  pcVar7 = local_200;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = local_400;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar4 = 0xffffffff;
  pcVar7 = s__dpnet_dll_0047395c;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  iVar6 = -1;
  pcVar7 = local_400;
  do {
    pcVar8 = pcVar7;
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    pcVar8 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar1 != '\0');
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = pcVar8 + -1;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar6 = FUN_0041db50((uint)local_400,(int *)&local_408);
  if (-1 < iVar6) {
    if (local_404 >> 0x10 == 4) {
      uVar10 = FUN_0041dc10(4,9,0,0x86);
      iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
      if (iVar6 < 0) goto LAB_0041da0b;
LAB_0041da3d:
      if (arg1 != (int *)0x0) {
        *arg1 = 8;
      }
      if (arg2 != (int *)0x0) {
        *arg2 = 2;
      }
      if (arg3 != (char *)0x0) {
        *arg3 = ' ';
      }
      bVar2 = true;
    }
    else {
LAB_0041da0b:
      if (local_404 >> 0x10 == 5) {
        uVar10 = FUN_0041dc10(5,2,0xe5d,0x86);
        iVar6 = FUN_0041dc50(local_408,local_404,(uint)uVar10,(uint)((ulonglong)uVar10 >> 0x20));
        if (-1 < iVar6) goto LAB_0041da3d;
      }
    }
  }
  uVar4 = 0xffffffff;
  pcVar7 = local_200;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = local_400;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  uVar4 = 0xffffffff;
  pcVar7 = &DAT_00473950;
  do {
    pcVar9 = pcVar7;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar9 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar9;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  iVar6 = -1;
  pcVar7 = local_400;
  do {
    pcVar8 = pcVar7;
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    pcVar8 = pcVar7 + 1;
    cVar1 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar1 != '\0');
  pcVar7 = pcVar9 + -uVar4;
  pcVar9 = pcVar8 + -1;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar6 = FUN_0041db50((uint)local_400,(int *)&local_408);
  if (-1 < iVar6) {
    if (arg1 != (int *)0x0) {
      *arg1 = 9;
    }
    if (arg2 != (int *)0x0) {
      *arg2 = 0;
    }
    if (arg3 == (char *)0x0) {
      return 0;
    }
    *arg3 = ' ';
    return 0;
  }
  if (bVar2) {
    return 0;
  }
LAB_0041db13:
  if (arg1 != (int *)0x0) {
    *arg1 = 0;
  }
  if (arg2 != (int *)0x0) {
    *arg2 = 0;
  }
  if (arg3 != (char *)0x0) {
    *arg3 = ' ';
  }
  return 0;
}



/* FUN_0041db50 @ 0041db50 */

/* [binja] int32_t sub_41db50(uint32_t arg1, int32_t* arg2) */

int __cdecl FUN_0041db50(uint arg1,int *arg2)

{
  uint lptstrFilename;
  int *piVar1;
  void *lpData;
  WINBOOL WVar2;
  DWORD local_4;
  
  piVar1 = arg2;
  lptstrFilename = arg1;
  if ((arg1 == 0) || (arg2 == (int *)0x0)) {
    return -0x7ff8ffa9;
  }
  arg1 = GetFileVersionInfoSizeA((LPCSTR)arg1,&local_4);
  if (arg1 != 0) {
    lpData = operator_new(arg1);
    if (lpData == (void *)0x0) {
      return -0x7ff8fff2;
    }
    WVar2 = GetFileVersionInfoA((LPCSTR)lptstrFilename,0,arg1,lpData);
    if (WVar2 != 0) {
      arg2 = (int *)0x0;
      WVar2 = VerQueryValueA(lpData,&DAT_004739b8,&arg2,&arg1);
      if ((WVar2 != 0) && (arg2 != (int *)0x0)) {
        piVar1[1] = arg2[2];
        *piVar1 = arg2[3];
        crt_free(lpData);
        return 0;
      }
    }
    crt_free(lpData);
  }
  return -0x7fffbffb;
}



/* FUN_0041dc10 @ 0041dc10 */

undefined8 __cdecl FUN_0041dc10(int param_1,uint param_2,int param_3,uint param_4)

{
  return CONCAT44(param_1 << 0x10 | param_2 & 0xffff,param_3 << 0x10 | param_4 & 0xffff);
}



/* FUN_0041dc50 @ 0041dc50 */

int __cdecl FUN_0041dc50(uint param_1,uint param_2,uint param_3,uint param_4)

{
  if (param_4 < param_2) {
    return 1;
  }
  if (param_2 < param_4) {
    return -1;
  }
  if (param_3 < param_1) {
    return 1;
  }
  return -(uint)(param_1 < param_3);
}



/* grim_load_interface @ 0041dc80 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* load grim DLL and fetch GRIM_GetInterface */

int __cdecl grim_load_interface(char *dll_name)

{
  char cVar1;
  FARPROC pFVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  char *pcVar6;
  char *pcVar7;
  
  _DAT_00490304 = LoadLibraryA(dll_name);
  if (_DAT_00490304 == (HMODULE)0x0) {
    return 0;
  }
  pFVar2 = GetProcAddress(_DAT_00490304,s_GRIM__GetInterface_004739bc);
  uVar4 = 0xffffffff;
  do {
    pcVar6 = dll_name;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar6 = dll_name + 1;
    cVar1 = *dll_name;
    dll_name = pcVar6;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar6 = pcVar6 + -uVar4;
  pcVar7 = (char *)&DAT_00490308;
  for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar7 = *(undefined4 *)pcVar6;
    pcVar6 = pcVar6 + 4;
    pcVar7 = pcVar7 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar7 = *pcVar6;
    pcVar6 = pcVar6 + 1;
    pcVar7 = pcVar7 + 1;
  }
  if (pFVar2 == (FARPROC)0x0) {
    return 0;
  }
  iVar3 = (*pFVar2)();
  return iVar3;
}



/* vorbis_mem_read @ 0041dce0 */

/* ov_open_callbacks read hook for memory-backed OGG data */

uint __cdecl vorbis_mem_read(void *dst,uint size,uint count,void *datasource)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  undefined4 *puVar5;
  
  if (*(uint *)((int)datasource + -8) <= *(uint *)((int)datasource + -4)) {
    *(undefined4 *)((int)datasource + -4) = 0;
  }
  iVar1 = *(int *)((int)datasource + -4);
  uVar4 = size * count;
  uVar2 = uVar4;
  if (*(uint *)((int)datasource + -8) < uVar4 + iVar1) {
    uVar2 = *(uint *)((int)datasource + -8) - iVar1;
  }
  puVar5 = (undefined4 *)(iVar1 + (int)datasource);
  for (uVar3 = uVar2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined4 *)dst = *puVar5;
    puVar5 = puVar5 + 1;
    dst = (undefined4 *)((int)dst + 4);
  }
  for (uVar3 = uVar2 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined1 *)dst = *(undefined1 *)puVar5;
    puVar5 = (undefined4 *)((int)puVar5 + 1);
    dst = (undefined4 *)((int)dst + 1);
  }
  *(uint *)((int)datasource + -4) = *(int *)((int)datasource + -4) + uVar4;
  return uVar2;
}



/* vorbis_mem_tell @ 0041dda0 */

/* ov_open_callbacks tell hook (returns current offset) */

int __cdecl vorbis_mem_tell(void *datasource)

{
  return *(int *)((int)datasource + -4);
}



/* vorbis_pcm_seek @ 0041ddb0 */

/* wrapper around ov_pcm_seek for memory stream */

int __thiscall vorbis_pcm_seek(void *this,void *stream,uint sample_offset)

{
  int iVar1;
  uint unaff_retaddr;
  
  iVar1 = ov_pcm_seek((OggVorbis_File *)((int)this + 0x10),(ulonglong)unaff_retaddr << 0x20);
  return iVar1;
}



/* vorbis_mem_open @ 0041ddd0 */

/* open OGG/Vorbis data from a memory buffer (sets callbacks) */

int __thiscall vorbis_mem_open(void *this,void *stream,void *buffer,uint size)

{
  OggVorbis_File *vf;
  int iVar1;
  uint uVar2;
  vorbis_info *pvVar3;
  int *piVar4;
  ogg_int64_t oVar5;
  longlong lVar6;
  undefined8 uVar7;
  
  *(code **)this = vorbis_mem_read;
  *(undefined1 **)((int)this + 4) = &LAB_0041dd40;
  *(undefined1 **)((int)this + 8) = &LAB_0041dd90;
  *(code **)((int)this + 0xc) = vorbis_mem_tell;
  *(undefined4 *)((int)this + 0x2e0) = 0;
  *(void **)((int)this + 0x2ec) = stream;
  *(void **)stream = buffer;
  *(undefined4 *)(*(int *)((int)this + 0x2ec) + 4) = 0;
  vf = (OggVorbis_File *)((int)this + 0x10);
  iVar1 = ov_open_callbacks((void *)(*(int *)((int)this + 0x2ec) + 8),vf,(char *)0x0,0,
                            *(ov_callbacks *)this);
  if (iVar1 < 0) {
    uVar2 = FUN_00461fd5((byte *)s_Input_does_not_appear_to_be_an_O_004739d0);
    return uVar2 & 0xffffff00;
  }
  pvVar3 = ov_info(vf,-1);
  piVar4 = (int *)((int)this + 0x2f0);
  for (iVar1 = 8; iVar1 != 0; iVar1 = iVar1 + -1) {
    *piVar4 = pvVar3->version;
    pvVar3 = (vorbis_info *)&pvVar3->channels;
    piVar4 = piVar4 + 1;
  }
  oVar5 = ov_pcm_total(vf,-1);
  lVar6 = __allmul((uint)oVar5,(int)((ulonglong)oVar5 >> 0x20),*(uint *)((int)this + 0x2f4),
                   (int)*(uint *)((int)this + 0x2f4) >> 0x1f);
  lVar6 = __allmul((uint)lVar6,(int)((ulonglong)lVar6 >> 0x20),0x10,0);
  uVar7 = __alldiv((uint)lVar6,(uint)((ulonglong)lVar6 >> 0x20),8,0);
  *(int *)((int)this + 0x2e4) = (int)uVar7;
  iVar1 = vorbis_mem_tell((void *)(*(int *)((int)this + 0x2ec) + 8));
  *(int *)((int)this + 0x2e8) = iVar1;
  return CONCAT31((int3)((uint)iVar1 >> 8),1);
}



/* vorbis_mem_close @ 0041dee0 */

/* frees memory buffer and ov_clear */

void __fastcall vorbis_mem_close(void *stream)

{
  crt_free(*(void **)((int)stream + 0x2ec));
  ov_clear((OggVorbis_File *)((int)stream + 0x10));
  return;
}



/* vorbis_read_pcm16 @ 0041df00 */

/* decode PCM16 samples via ov_read */

int __thiscall vorbis_read_pcm16(void *this,void *stream,char *dst,int bytes)

{
  uint uVar1;
  
  uVar1 = ov_read((OggVorbis_File *)((int)this + 0x10),stream,(int)dst,0,2,1,
                  (int *)((int)this + 0x2e0));
  if (uVar1 == 0) {
    return 0;
  }
  return uVar1 & ((int)uVar1 < 0) - 1;
}



/* game_is_full_version @ 0041df40 */

/* returns non-zero when full version/unlimited mode is enabled */

int game_is_full_version(void)

{
  undefined4 in_EAX;
  
  return CONCAT31((int3)((uint)in_EAX >> 8),1);
}



/* FUN_0041df50 @ 0041df50 */

undefined4 FUN_0041df50(void)

{
  return 2400000;
}



/* game_sequence_get @ 0041df60 */

/* returns the saved game_sequence_id */

int game_sequence_get(void)

{
  return game_status_blob.game_sequence_id;
}



/* FUN_0041e270 @ 0041e270 */

/* [binja] int32_t sub_41e270(float* arg1, float* arg2) */

int __cdecl FUN_0041e270(float *arg1,float *arg2)

{
  *arg1 = *arg1 + *arg2;
  arg1[1] = arg2[1] + arg1[1];
  return 0;
}



/* player_apply_move_with_spawn_avoidance @ 0041e290 */

/* applies movement delta (scaled by alternate-weapon perk) and resolves collisions with creature
   spawn slots */

void __cdecl player_apply_move_with_spawn_avoidance(int player_index,float *pos,float *delta)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  int iVar5;
  int *piVar6;
  
  iVar5 = perk_count_get(perk_id_alternate_weapon);
  if (iVar5 != 0) {
    *delta = *delta * 0.8;
    delta[1] = delta[1] * 0.8;
  }
  piVar6 = &creature_spawn_slot_owner;
  *pos = *pos + *delta;
  pos[1] = delta[1] + pos[1];
  do {
    iVar5 = *piVar6;
    if ((iVar5 != 0) &&
       (fVar3 = (*(float *)(iVar5 + 0x34) + *(float *)((&player_health)[player_index]._pad0 + 0x10))
                * 0.33333334, fVar1 = *(float *)(iVar5 + 0x14) - *pos,
       fVar2 = *(float *)(iVar5 + 0x18) - pos[1], SQRT(fVar1 * fVar1 + fVar2 * fVar2) <= fVar3)) {
      *pos = *pos - *delta;
      fVar1 = pos[1];
      fVar2 = delta[1];
      pos[1] = fVar1 - fVar2;
      fVar4 = *(float *)(iVar5 + 0x14) - *pos;
      fVar1 = *(float *)(iVar5 + 0x18) - (fVar1 - fVar2);
      fVar2 = *pos + *delta;
      if (fVar3 < SQRT(fVar4 * fVar4 + fVar1 * fVar1)) {
        *pos = fVar2;
        fVar1 = *(float *)(iVar5 + 0x14) - fVar2;
        fVar4 = *(float *)(iVar5 + 0x18) - pos[1];
        if (SQRT(fVar1 * fVar1 + fVar4 * fVar4) <= fVar3) {
          *pos = fVar2 - *delta;
          fVar1 = delta[1] + pos[1];
          pos[1] = fVar1;
          fVar4 = *(float *)(iVar5 + 0x14) - *pos;
          fVar2 = *(float *)(iVar5 + 0x18) - fVar1;
          if (SQRT(fVar4 * fVar4 + fVar2 * fVar2) <= fVar3) {
            pos[1] = fVar1 - delta[1];
          }
        }
      }
      else {
        *pos = fVar2;
        pos[1] = delta[1] + pos[1];
      }
    }
    piVar6 = piVar6 + 6;
  } while ((int)piVar6 < 0x4852d0);
  return;
}



/* vec2_add_inplace @ 0041e400 */

/* adds delta XY into pos; unused param_1 in decompile */

void __cdecl vec2_add_inplace(int unused,float *pos,float *delta)

{
  *pos = *pos + *delta;
  pos[1] = delta[1] + pos[1];
  return;
}



/* fx_queue_add @ 0041e840 */

/* pushes a quad entry into DAT_004aaf18 (capped at 0x80); returns 1 on success */

int __cdecl fx_queue_add(int effect_id,float *pos,float w,float h,float rotation,float *rgba)

{
  fx_queue_entry_t *pfVar1;
  int iVar2;
  int iVar3;
  uint3 uVar4;
  int iVar5;
  
  iVar2 = fx_queue_count;
  iVar3 = fx_queue_count * 0x28;
  iVar5 = fx_queue_count + 1;
  (&fx_queue)[fx_queue_count].pos_x = *pos;
  (&fx_queue)[fx_queue_count].pos_y = pos[1];
  (&fx_queue)[fx_queue_count].color_r = *rgba;
  (&fx_queue)[fx_queue_count].color_g = rgba[1];
  (&fx_queue)[fx_queue_count].color_b = rgba[2];
  pfVar1 = &fx_queue + fx_queue_count;
  fx_queue_count = iVar5;
  pfVar1->color_a = rgba[3];
  (&fx_queue)[iVar2].width = w;
  (&fx_queue)[iVar2].height = h;
  (&fx_queue)[iVar2].rotation = rotation;
  (&fx_queue)[iVar2].effect_id = effect_id;
  uVar4 = (uint3)((uint)iVar3 >> 8);
  if (0x7f < iVar5) {
    fx_queue_count = 0x7f;
    return (uint)uVar4 << 8;
  }
  return CONCAT31(uVar4,1);
}



/* FUN_0041e8d0 @ 0041e8d0 */

bool FUN_0041e8d0(void)

{
  int iVar1;
  int unaff_retaddr;
  
  iVar1 = (*grim_interface_ptr->vtable->grim_get_joystick_pov)((IGrim2D *)0x0,unaff_retaddr);
  return iVar1 == config_blob.reserved1._16_4_;
}



/* FUN_0041e8f0 @ 0041e8f0 */

bool FUN_0041e8f0(void)

{
  int iVar1;
  int unaff_retaddr;
  
  iVar1 = (*grim_interface_ptr->vtable->grim_get_joystick_pov)((IGrim2D *)0x0,unaff_retaddr);
  return iVar1 == config_blob.reserved1._12_4_;
}



/* creature_handle_death @ 0041e910 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* death handler: bonus spawns, split-on-death, score, and cleanup */

void __cdecl creature_handle_death(int creature_id,bool keep_corpse)

{
  float *pos;
  creature_t *pcVar1;
  uchar uVar2;
  uchar uVar3;
  uchar uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  creature_t *pcVar8;
  creature_t *pcVar9;
  longlong lVar10;
  
  pcVar1 = &creature_pool + creature_id;
  if (((&creature_pool)[creature_id].flags & 0x400U) != 0) {
    bonus_spawn_at(&(&creature_pool)[creature_id].pos_x,
                   (int)(short)(&creature_pool)[creature_id].link_index,
                   (int)*(short *)((int)&(&creature_pool)[creature_id].link_index + 2));
  }
  if (survival_recent_death_count < 6) {
    if (survival_recent_death_count < 3) {
      *(float *)(&survival_recent_death_pos_x + survival_recent_death_count * 8) =
           (&creature_pool)[creature_id].pos_x;
      (&survival_recent_death_pos_y)[survival_recent_death_count * 2] =
           (&creature_pool)[creature_id].pos_y;
    }
    survival_recent_death_count = survival_recent_death_count + 1;
    if (survival_recent_death_count == 3) {
      survival_reward_fire_seen = 0;
      survival_reward_handout_enabled = 0;
    }
  }
  if (pcVar1->active != '\0') {
    if (((&creature_pool)[creature_id].flags & 4) != 0) {
      (&creature_spawn_slot_owner)[(&creature_pool)[creature_id].link_index * 6] = 0;
    }
    if ((((&creature_pool)[creature_id].flags & 8) != 0) &&
       (35.0 < (&creature_pool)[creature_id].size)) {
      iVar5 = creature_alloc_slot();
      pcVar8 = pcVar1;
      pcVar9 = &creature_pool + iVar5;
      for (iVar7 = 0x26; iVar7 != 0; iVar7 = iVar7 + -1) {
        uVar2 = pcVar8->_pad0[0];
        uVar3 = pcVar8->_pad0[1];
        uVar4 = pcVar8->_pad0[2];
        pcVar9->active = pcVar8->active;
        pcVar9->_pad0[0] = uVar2;
        pcVar9->_pad0[1] = uVar3;
        pcVar9->_pad0[2] = uVar4;
        pcVar8 = (creature_t *)&pcVar8->phase_seed;
        pcVar9 = (creature_t *)&pcVar9->phase_seed;
      }
      uVar6 = crt_rand();
      (&creature_pool)[iVar5].phase_seed = (float)(uVar6 & 0xff);
      (&creature_pool)[iVar5].heading = (&creature_pool)[creature_id].heading - 1.5707964;
      (&creature_pool)[iVar5].health = (&creature_pool)[creature_id].max_health * 0.25;
      (&creature_pool)[iVar5].reward_value = (&creature_pool)[iVar5].reward_value * 0.6666667;
      (&creature_pool)[iVar5].size = (&creature_pool)[iVar5].size - 8.0;
      (&creature_pool)[iVar5].move_speed = (&creature_pool)[iVar5].move_speed + 0.1;
      (&creature_pool)[iVar5].contact_damage = (&creature_pool)[iVar5].contact_damage * 0.7;
      (&creature_pool)[iVar5].hitbox_size = 16.0;
      iVar5 = creature_alloc_slot();
      pcVar8 = pcVar1;
      pcVar9 = &creature_pool + iVar5;
      for (iVar7 = 0x26; iVar7 != 0; iVar7 = iVar7 + -1) {
        uVar2 = pcVar8->_pad0[0];
        uVar3 = pcVar8->_pad0[1];
        uVar4 = pcVar8->_pad0[2];
        pcVar9->active = pcVar8->active;
        pcVar9->_pad0[0] = uVar2;
        pcVar9->_pad0[1] = uVar3;
        pcVar9->_pad0[2] = uVar4;
        pcVar8 = (creature_t *)&pcVar8->phase_seed;
        pcVar9 = (creature_t *)&pcVar9->phase_seed;
      }
      uVar6 = crt_rand();
      (&creature_pool)[iVar5].phase_seed = (float)(uVar6 & 0xff);
      (&creature_pool)[iVar5].heading = (&creature_pool)[creature_id].heading + 1.5707964;
      (&creature_pool)[iVar5].health = (&creature_pool)[creature_id].max_health * 0.25;
      (&creature_pool)[iVar5].size = (&creature_pool)[iVar5].size - 8.0;
      (&creature_pool)[iVar5].move_speed = (&creature_pool)[iVar5].move_speed + 0.1;
      (&creature_pool)[iVar5].reward_value = (&creature_pool)[iVar5].reward_value * 0.6666667;
      (&creature_pool)[iVar5].hitbox_size = 16.0;
      (&creature_pool)[iVar5].contact_damage = (&creature_pool)[iVar5].contact_damage * 0.7;
      effect_spawn_burst(&(&creature_pool)[creature_id].pos_x,8);
    }
    if (keep_corpse) {
      (&creature_pool)[creature_id].hitbox_size =
           (&creature_pool)[creature_id].hitbox_size - frame_dt;
    }
    else {
      pcVar1->active = '\0';
    }
    iVar5 = perk_id_bloody_mess_quick_learner;
    if (*(int *)(player_health._pad0 + perk_id_bloody_mess_quick_learner * 4 + 0x94) < 1) {
      lVar10 = __ftol();
      player_health._pad0._136_4_ = SUB84(lVar10,0);
    }
    else {
      lVar10 = __ftol();
      player_health._pad0._136_4_ = player_health._pad0._136_4_ + (int)lVar10;
    }
    if (0.0 < _bonus_double_xp_timer) {
      if (*(int *)(player_health._pad0 + iVar5 * 4 + 0x94) < 1) {
        lVar10 = __ftol();
        player_health._pad0._136_4_ = SUB84(lVar10,0);
      }
      else {
        lVar10 = __ftol();
        player_health._pad0._136_4_ = player_health._pad0._136_4_ + (int)lVar10;
      }
    }
    if (bonus_spawn_guard == '\0') {
      bonus_try_spawn_on_kill(&(&creature_pool)[creature_id].pos_x);
    }
    if (0.0 < _bonus_freeze_timer) {
      pos = &(&creature_pool)[creature_id].pos_x;
      iVar5 = 8;
      do {
        iVar7 = crt_rand();
        effect_spawn_freeze_shard(pos,(float)(iVar7 % 0x264) * 0.01);
        iVar5 = iVar5 + -1;
      } while (iVar5 != 0);
      iVar5 = crt_rand();
      effect_spawn_freeze_shatter(pos,(float)(iVar5 % 0x264) * 0.01);
      highscore_active_record.creature_kill_count = highscore_active_record.creature_kill_count + 1;
      pcVar1->active = '\0';
      fx_queue_add_random(pos);
    }
  }
  return;
}



/* config_sync_from_grim @ 0041ec60 */

/* syncs Grim config values into config blob and writes crimson.cfg */

int config_sync_from_grim(void)

{
  char cVar1;
  undefined1 *puVar2;
  int *piVar3;
  uchar *puVar4;
  char *pcVar5;
  FILE *pFVar6;
  long lVar7;
  uint uVar8;
  uint uVar9;
  int iVar10;
  int unaff_EBX;
  int unaff_EBP;
  int unaff_ESI;
  int unaff_EDI;
  highscore_record_t *phVar11;
  highscore_record_t *phVar12;
  _func_55 **pp_Var13;
  char *pcVar14;
  uchar *puVar15;
  int in_stack_fffffb6c;
  IGrim2D in_stack_fffffb70;
  IGrim2D IVar16;
  IGrim2D IStack_48c;
  IGrim2D IStack_488;
  IGrim2D IStack_484;
  IGrim2D IStack_480;
  IGrim2D aIStack_47c [5];
  undefined1 uStack_468;
  undefined1 uStack_467;
  undefined1 uStack_466;
  undefined1 uStack_465;
  undefined2 uStack_464;
  undefined1 uStack_45a;
  undefined1 uStack_459;
  undefined1 uStack_458;
  undefined1 uStack_457;
  undefined4 uStack_454;
  undefined4 uStack_450;
  undefined4 uStack_44c;
  undefined4 uStack_448;
  undefined4 uStack_424;
  undefined4 uStack_420;
  undefined4 uStack_3fc;
  undefined4 uStack_3f8;
  char acStack_3f4 [12];
  undefined4 uStack_3e8;
  undefined4 uStack_3e4;
  int aiStack_3e0 [8];
  IGrim2D_vtbl IStack_3c0;
  undefined4 uStack_270;
  undefined4 uStack_26c;
  undefined4 uStack_268;
  undefined4 uStack_264;
  undefined4 uStack_260;
  undefined4 uStack_25c;
  undefined4 uStack_258;
  undefined4 uStack_254;
  undefined4 uStack_250;
  undefined4 uStack_24c;
  undefined4 uStack_248;
  undefined4 uStack_244;
  undefined4 uStack_240;
  undefined4 uStack_23c;
  undefined4 uStack_238;
  undefined4 uStack_234;
  undefined4 uStack_230;
  undefined4 uStack_22c;
  undefined4 uStack_228;
  undefined4 uStack_224;
  undefined1 uStack_20;
  undefined1 uStack_1f;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  undefined1 uStack_8;
  undefined4 uStack_4;
  
  puVar2 = (undefined1 *)
           (*grim_interface_ptr->vtable->grim_get_config_var)
                     ((IGrim2D *)&stack0xfffffb70,(uint *)0x8,unaff_EDI);
  config_blob.windowed._0_1_ = *puVar2;
  piVar3 = (int *)(*grim_interface_ptr->vtable->grim_get_config_var)
                            (&IStack_48c,(uint *)0x2b,unaff_ESI);
  config_blob.display_bpp = *piVar3;
  piVar3 = (int *)(*grim_interface_ptr->vtable->grim_get_config_var)
                            (&IStack_488,(uint *)0x29,unaff_EBP);
  config_blob.screen_width = *piVar3;
  piVar3 = (int *)(*grim_interface_ptr->vtable->grim_get_config_var)
                            (&IStack_484,(uint *)0x2a,unaff_EBX);
  config_blob.screen_height = *piVar3;
  puVar4 = (uchar *)(*grim_interface_ptr->vtable->grim_get_config_var)
                              (&IStack_480,(uint *)0x59,in_stack_fffffb6c);
  config_blob.reserved0._112_4_ = *(undefined4 *)puVar4;
  puVar4 = (uchar *)(*grim_interface_ptr->vtable->grim_get_config_var)
                              (aIStack_47c,(uint *)0x54,(int)in_stack_fffffb70.vtable);
  config_blob.player_name_length = player_name_length;
  config_blob.reserved7[0] = *puVar4;
  uVar8 = 0xffffffff;
  phVar11 = &highscore_active_record;
  do {
    phVar12 = phVar11;
    if (uVar8 == 0) break;
    uVar8 = uVar8 - 1;
    phVar12 = (highscore_record_t *)(phVar11->player_name + 1);
    pcVar5 = phVar11->player_name;
    phVar11 = phVar12;
  } while (*pcVar5 != '\0');
  uVar8 = ~uVar8;
  pcVar5 = (char *)((int)phVar12 - uVar8);
  pcVar14 = config_blob.player_name;
  for (uVar9 = uVar8 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
    *(undefined4 *)pcVar14 = *(undefined4 *)pcVar5;
    pcVar5 = pcVar5 + 4;
    pcVar14 = pcVar14 + 4;
  }
  for (uVar8 = uVar8 & 3; uVar8 != 0; uVar8 = uVar8 - 1) {
    *pcVar14 = *pcVar5;
    pcVar5 = pcVar5 + 1;
    pcVar14 = pcVar14 + 1;
  }
  if (grim_config_invoked != '\0') {
    aIStack_47c[0].vtable = &IStack_3c0;
    acStack_3f4[0] = '\0';
    acStack_3f4[1] = '\0';
    acStack_3f4[2] = '\0';
    acStack_3f4[3] = '\0';
    uStack_20 = 0;
    acStack_3f4[4] = '\0';
    acStack_3f4[5] = '\0';
    acStack_3f4[6] = '\0';
    acStack_3f4[7] = '\0';
    uStack_1f = 1;
    uStack_1c = 0;
    uStack_18 = 1;
    uStack_3f8 = 0x3f800000;
    acStack_3f4[8] = 0;
    iVar10 = 0;
    piVar3 = aiStack_3e0;
    do {
      uVar8 = 0xffffffff;
      *piVar3 = iVar10;
      pcVar5 = s_default_0047131c;
      do {
        pcVar14 = pcVar5;
        if (uVar8 == 0) break;
        uVar8 = uVar8 - 1;
        pcVar14 = pcVar5 + 1;
        cVar1 = *pcVar5;
        pcVar5 = pcVar14;
      } while (cVar1 != '\0');
      uVar8 = ~uVar8;
      piVar3 = piVar3 + 1;
      pcVar5 = pcVar14 + -uVar8;
      IVar16.vtable = aIStack_47c[0].vtable;
      for (uVar9 = uVar8 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
        (IVar16.vtable)->grim_release = *(_func_1 **)pcVar5;
        pcVar5 = pcVar5 + 4;
        IVar16.vtable = (IGrim2D_vtbl *)&(IVar16.vtable)->grim_set_paused;
      }
      iVar10 = iVar10 + 1;
      for (uVar8 = uVar8 & 3; uVar8 != 0; uVar8 = uVar8 - 1) {
        *(char *)&(IVar16.vtable)->grim_release = *pcVar5;
        pcVar5 = pcVar5 + 1;
        IVar16.vtable = (IGrim2D_vtbl *)((int)&(IVar16.vtable)->grim_release + 1);
      }
      aIStack_47c[0].vtable = (IGrim2D_vtbl *)((int)&(aIStack_47c[0].vtable)->grim_shutdown + 3);
    } while (iVar10 < 8);
    uStack_465 = 0;
    uStack_466 = 0;
    pp_Var13 = &IStack_3c0.grim_draw_circle_filled;
    for (iVar10 = 8; iVar10 != 0; iVar10 = iVar10 + -1) {
      *pp_Var13 = (_func_55 *)0x0;
      pp_Var13 = pp_Var13 + 1;
    }
    uVar8 = 0xffffffff;
    pcVar5 = &default_player_name;
    do {
      pcVar14 = pcVar5;
      if (uVar8 == 0) break;
      uVar8 = uVar8 - 1;
      pcVar14 = pcVar5 + 1;
      cVar1 = *pcVar5;
      pcVar5 = pcVar14;
    } while (cVar1 != '\0');
    uVar8 = ~uVar8;
    pcVar5 = pcVar14 + -uVar8;
    pp_Var13 = &IStack_3c0.grim_draw_circle_filled;
    for (uVar9 = uVar8 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
      *pp_Var13 = *(_func_55 **)pcVar5;
      pcVar5 = pcVar5 + 4;
      pp_Var13 = pp_Var13 + 1;
    }
    for (uVar8 = uVar8 & 3; uVar8 != 0; uVar8 = uVar8 - 1) {
      *(char *)pp_Var13 = *pcVar5;
      pcVar5 = pcVar5 + 1;
      pp_Var13 = (_func_55 **)((int)pp_Var13 + 1);
    }
    uStack_3e4 = 1;
    uStack_8 = 1;
    IStack_3c0.grim_set_color_ptr = (_func_69 *)0x20;
    uStack_450 = 1;
    uStack_45a = 1;
    uStack_458 = 1;
    uStack_457 = 1;
    uStack_454 = 1;
    IStack_3c0.grim_submit_vertices_offset = (_func_76 *)0x20;
    uStack_3e8 = 0;
    uStack_468 = 0;
    uStack_467 = 0;
    IStack_3c0.grim_set_uv = (_func_65 *)0x0;
    IStack_3c0.grim_set_atlas_frame = (_func_66 *)0x0;
    IStack_3c0.grim_set_sub_rect = (_func_67 *)0x2328;
    IStack_3c0.grim_set_uv_point = (_func_68 *)0x6978;
    IStack_3c0.grim_set_rotation = (_func_64 *)0x64;
    uStack_3fc = 0;
    IStack_3c0.grim_set_color = (_func_70 *)0x320;
    IStack_3c0.grim_set_color_slot = (_func_71 *)0x258;
    IStack_3c0.grim_draw_quad._0_1_ = 0;
    uStack_459 = 0;
    uStack_44c = 2;
    uStack_448 = 2;
    uStack_424 = 0;
    uStack_420 = 0;
    uStack_4 = 0x3f800000;
    IStack_3c0.grim_draw_quad_xy = (_func_73 *)0x11;
    IStack_3c0.grim_draw_quad_rotated_matrix = (_func_74 *)0x1f;
    IStack_3c0.grim_submit_vertices_transform = (_func_75 *)0x1e;
    IStack_3c0.grim_submit_vertices_offset_color = (_func_77 *)0x100;
    IStack_3c0.grim_submit_vertices_transform_color = (_func_78 *)0x17e;
    IStack_3c0.grim_draw_quad_points = (_func_79 *)0x17e;
    IStack_3c0.grim_draw_text_mono = (_func_80 *)0x10;
    IStack_3c0.grim_draw_text_mono_fmt = (_func_81 *)0x12;
    IStack_3c0.grim_draw_text_small = (_func_82 *)0x13f;
    IStack_3c0.grim_draw_text_small_fmt = (_func_83 *)0x140;
    IStack_3c0.grim_measure_text_width = (_func_84 *)0x141;
    uStack_270 = 0x153;
    uStack_26c = 0x17e;
    uStack_268 = 0x17e;
    uStack_264 = 0x17e;
    uStack_260 = 200;
    uStack_25c = 0xd0;
    uStack_258 = 0xcb;
    uStack_254 = 0xcd;
    uStack_250 = 0x9d;
    uStack_24c = 0x17e;
    uStack_248 = 0x17e;
    uStack_244 = 0xd3;
    IVar16.vtable = (IGrim2D_vtbl *)&file_mode_read_binary;
    uStack_240 = 0xd1;
    uStack_23c = 0x13f;
    uStack_238 = 0x140;
    uStack_234 = 0x141;
    uStack_230 = 0x153;
    uStack_22c = 0x17e;
    uStack_228 = 0x17e;
    uStack_224 = 0x17e;
    uStack_464 = 0x101;
    pcVar5 = game_build_path(config_filename);
    pFVar6 = crt_fopen(pcVar5,(char *)IVar16.vtable);
    if (pFVar6 != (FILE *)0x0) {
      crt_fseek(pFVar6,0,2);
      lVar7 = crt_ftell(pFVar6);
      if (lVar7 == 0x480) {
        crt_fseek(pFVar6,0,0);
        crt_fread(&uStack_468,0x480,1,pFVar6);
        uVar8 = 0xffffffff;
        pcVar5 = acStack_3f4;
        do {
          pcVar14 = pcVar5;
          if (uVar8 == 0) break;
          uVar8 = uVar8 - 1;
          pcVar14 = pcVar5 + 1;
          cVar1 = *pcVar5;
          pcVar5 = pcVar14;
        } while (cVar1 != '\0');
        uVar8 = ~uVar8;
        config_blob.fx_toggle = '\0';
        puVar4 = (uchar *)(pcVar14 + -uVar8);
        puVar15 = config_blob.reserved0 + 0x74;
        for (uVar9 = uVar8 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
          *(undefined4 *)puVar15 = *(undefined4 *)puVar4;
          puVar4 = puVar4 + 4;
          puVar15 = puVar15 + 4;
        }
        for (uVar8 = uVar8 & 3; uVar8 != 0; uVar8 = uVar8 - 1) {
          *puVar15 = *puVar4;
          puVar4 = puVar4 + 1;
          puVar15 = puVar15 + 1;
        }
      }
      crt_fclose(pFVar6);
    }
  }
  IVar16.vtable = (IGrim2D_vtbl *)&file_mode_write_binary;
  pcVar5 = game_build_path(config_filename);
  pFVar6 = crt_fopen(pcVar5,(char *)IVar16.vtable);
  iVar10 = 0;
  if (pFVar6 != (FILE *)0x0) {
    crt_fwrite(&config_blob,0x480,1,pFVar6);
    iVar10 = crt_fclose(pFVar6);
  }
  return CONCAT31((int3)((uint)iVar10 >> 8),1);
}



/* config_ensure_file @ 0041f130 */

/* creates crimson.cfg when missing (writes default config blob) */

void config_ensure_file(void)

{
  char *pcVar1;
  FILE *pFVar2;
  char *pcVar3;
  
  pcVar3 = &file_mode_read_binary;
  pcVar1 = game_build_path(config_filename);
  pFVar2 = crt_fopen(pcVar1,pcVar3);
  if (pFVar2 != (FILE *)0x0) {
    crt_fclose(pFVar2);
    return;
  }
  pcVar3 = &file_mode_write_binary;
  config_blob.fx_toggle = '\x01';
  pcVar1 = game_build_path(config_filename);
  pFVar2 = crt_fopen(pcVar1,pcVar3);
  if (pFVar2 != (FILE *)0x0) {
    crt_fwrite(&config_blob,0x480,1,pFVar2);
    crt_fclose(pFVar2);
  }
  return;
}



/* config_load_presets @ 0041f1a0 */

/* loads config presets into globals */

uint config_load_presets(void)

{
  char cVar1;
  char *pcVar2;
  FILE *fp;
  long lVar3;
  uint uVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  char unaff_SI;
  highscore_record_t *phVar8;
  uint uVar9;
  undefined4 uVar10;
  uint value;
  undefined4 uVar11;
  FILE *value_00;
  char *pcVar12;
  
  pcVar12 = &file_mode_read_binary;
  player_health.input.move_key_forward = 0x11;
  player_health.input.move_key_backward = 0x1f;
  player_health.input.turn_key_left = 0x1e;
  player_health.input.turn_key_right = 0x20;
  player_health.input.fire_key = 0xf;
  player_health.input.key_reserved_0 = 0x11;
  player_health.input.key_reserved_1 = 0x1f;
  player_health.input.aim_key_left = 0x10;
  player_health.input.aim_key_right = 0x12;
  player_alt_move_key_forward = 200;
  player_alt_move_key_backward = 0xd0;
  player_alt_turn_key_left = 0xcb;
  player_alt_turn_key_right = 0xcd;
  player_alt_fire_key = 0x9d;
  player_alt_key_reserved_0 = 0x11;
  player_alt_key_reserved_1 = 0x1f;
  player_alt_key_reserved_2 = 0xd3;
  player_alt_key_reserved_3 = 0xc9;
  pcVar2 = game_build_path(config_filename);
  fp = crt_fopen(pcVar2,pcVar12);
  if (fp == (FILE *)0x0) {
    return 0;
  }
  crt_fseek(fp,0,2);
  lVar3 = crt_ftell(fp);
  if (lVar3 != 0x480) {
    crt_fclose(fp);
    uVar4 = config_sync_from_grim();
    return uVar4 & 0xffffff00;
  }
  value_00 = fp;
  crt_fseek(fp,0,0);
  crt_fread(&config_blob,0x480,1,fp);
  crt_fclose(fp);
  piVar7 = &player_health.input.move_key_backward;
  piVar5 = config_blob.keybinds_p1 + 0xc;
  do {
    piVar6 = piVar5 + 0x10;
    ((player_input_t *)(piVar7 + -1))->move_key_forward = piVar5[-0xc];
    *piVar7 = piVar5[-0xb];
    piVar7[1] = piVar5[-10];
    piVar7[2] = piVar5[-9];
    piVar7[3] = piVar5[-8];
    piVar7[4] = piVar5[-7];
    piVar7[5] = piVar5[-6];
    piVar7[6] = piVar5[-5];
    piVar7[7] = piVar5[-4];
    piVar7[9] = piVar5[-3];
    piVar7[8] = piVar5[-2];
    piVar7[0xb] = piVar5[-1];
    piVar7[10] = *piVar5;
    piVar7 = piVar7 + 0xd8;
    piVar5 = piVar6;
  } while ((int)piVar6 < 0x4805c0);
  uVar4 = 0x59;
  uVar11 = 0x41f33e;
  (*grim_interface_ptr->vtable->grim_set_config_var)
            ((IGrim2D *)0x59,config_blob.reserved0._112_4_,(uint)value_00);
  if (unaff_SI == '\0') {
    value = 0x54;
    uVar10 = 0x41f364;
    (*grim_interface_ptr->vtable->grim_set_config_var)
              ((IGrim2D *)0x54,CONCAT31((int3)((uint)uVar11 >> 8),config_blob.reserved7[0]),uVar4);
    uVar9 = 8;
    (*grim_interface_ptr->vtable->grim_set_config_var)
              ((IGrim2D *)0x8,CONCAT31((int3)((uint)uVar10 >> 8),(undefined1)config_blob.windowed),
               value);
    uVar4 = 0x2b;
    (*grim_interface_ptr->vtable->grim_set_config_var)
              ((IGrim2D *)0x2b,config_blob.display_bpp,uVar9);
    uVar9 = 0x29;
    (*grim_interface_ptr->vtable->grim_set_config_var)
              ((IGrim2D *)0x29,config_blob.screen_width,uVar4);
    uVar4 = 0x2a;
    uVar11 = 0x41f3cc;
    (*grim_interface_ptr->vtable->grim_set_config_var)
              ((IGrim2D *)0x2a,config_blob.screen_height,uVar9);
    (*grim_interface_ptr->vtable->grim_set_config_var)
              ((IGrim2D *)0x53,CONCAT31((int3)((uint)uVar11 >> 8),config_blob.reserved0[0]),uVar4);
  }
  uVar4 = 0xffffffff;
  pcVar2 = config_blob.player_name;
  do {
    pcVar12 = pcVar2;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar12 = pcVar2 + 1;
    cVar1 = *pcVar2;
    pcVar2 = pcVar12;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar2 = pcVar12 + -uVar4;
  phVar8 = &highscore_active_record;
  for (uVar9 = uVar4 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
    *(undefined4 *)phVar8->player_name = *(undefined4 *)pcVar2;
    pcVar2 = pcVar2 + 4;
    phVar8 = (highscore_record_t *)(phVar8->player_name + 4);
  }
  for (uVar9 = uVar4 & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
    phVar8->player_name[0] = *pcVar2;
    pcVar2 = pcVar2 + 1;
    phVar8 = (highscore_record_t *)(phVar8->player_name + 1);
  }
  player_name_length = config_blob.player_name_length;
  config_blob.reserved0[2] = '\0';
  config_blob.reserved0[0x80] = '\0';
  config_blob.reserved0[0x81] = '\0';
  config_blob.reserved0[0x82] = '\0';
  config_blob.reserved0[0x83] = '\0';
  return CONCAT31((int3)(uVar4 >> 8),1);
}



/* angle_approach @ 0041f430 */

/* wraps angle into [0,2pi] and steps toward target using shortest arc */

void __cdecl angle_approach(float *angle,float target,float rate)

{
  float fVar1;
  float fVar2;
  float fVar3;
  
  fVar1 = *angle;
  while (fVar1 < 0.0) {
    fVar1 = *angle + 6.2831855;
    *angle = fVar1;
  }
  fVar1 = *angle;
  while (6.2831855 < fVar1) {
    fVar1 = *angle - 6.2831855;
    *angle = fVar1;
  }
  fVar2 = ABS(target - *angle);
  fVar1 = *angle;
  if (*angle < target) {
    fVar1 = target;
  }
  fVar3 = *angle;
  if (target < *angle) {
    fVar3 = target;
  }
  fVar3 = ABS((6.2831855 - fVar1) + fVar3);
  fVar1 = fVar3;
  if (fVar2 < fVar3) {
    fVar1 = fVar2;
  }
  if (1.0 < fVar1) {
    fVar1 = 1.0;
  }
  if (fVar2 <= fVar3) {
    fVar1 = frame_dt * fVar1 * rate;
    if (*angle < target) {
      *angle = fVar1 + *angle;
      return;
    }
  }
  else {
    fVar1 = frame_dt * fVar1 * rate;
    if (target < *angle) {
      *angle = fVar1 + *angle;
      return;
    }
  }
  *angle = *angle - fVar1;
  return;
}



/* bonus_alloc_slot @ 0041f580 */

/* returns a free bonus slot in DAT_00482948 (or DAT_00490630 sentinel) */

int * bonus_alloc_slot(void)

{
  int *piVar1;
  int iVar2;
  
  iVar2 = 0;
  piVar1 = &bonus_pool;
  do {
    if (*piVar1 == 0) {
      return &bonus_pool + iVar2 * 7;
    }
    piVar1 = piVar1 + 7;
    iVar2 = iVar2 + 1;
  } while ((int)piVar1 < 0x482b08);
  return (int *)&bonus_pool_sentinel;
}



/* bonus_spawn_at @ 0041f5b0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* clamps position, fills bonus entry fields, and spawns pickup effect */

int * __cdecl bonus_spawn_at(float *pos,int bonus_id,int duration_override)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  
  if (*pos < 32.0) {
    *pos = 32.0;
  }
  if (pos[1] < 32.0) {
    pos[1] = 32.0;
  }
  if ((float)(terrain_texture_width + -0x20) < *pos) {
    *pos = (float)(terrain_texture_width + -0x20);
  }
  if ((float)(terrain_texture_height + -0x20) < pos[1]) {
    pos[1] = (float)(terrain_texture_height + -0x20);
  }
  if (config_blob.reserved0._24_4_ != 2) {
    piVar1 = bonus_alloc_slot();
    *(undefined1 *)(piVar1 + 1) = 0;
    piVar1[4] = (int)*pos;
    piVar1[5] = (int)pos[1];
    piVar1[2] = 0x41200000;
    piVar1[3] = 0x41200000;
    *piVar1 = bonus_id;
    piVar1[6] = duration_override;
    if (duration_override == -1) {
      piVar1[6] = *(int *)(&bonus_meta_default_amount + bonus_id * 0x14);
    }
    _effect_template_color_r = 0x3ecccccd;
    _effect_template_flags = 0x1d;
    _effect_template_color_g = 0x3f000000;
    _effect_template_color_b = 0x3f800000;
    _effect_template_color_a = 0x3f000000;
    _effect_template_lifetime = 0x3f000000;
    _effect_template_half_width = 0x42000000;
    _effect_template_half_height = 0x42000000;
    iVar4 = 0x10;
    do {
      uVar2 = crt_rand();
      _effect_template_rotation = (float)(uVar2 & 0x7f) * 0.049087387;
      uVar2 = crt_rand();
      uVar2 = uVar2 & 0x8000007f;
      if ((int)uVar2 < 0) {
        uVar2 = (uVar2 - 1 | 0xffffff80) + 1;
      }
      effect_template_vel_x = (float)(int)(uVar2 - 0x40);
      uVar2 = crt_rand();
      uVar2 = uVar2 & 0x8000007f;
      if ((int)uVar2 < 0) {
        uVar2 = (uVar2 - 1 | 0xffffff80) + 1;
      }
      effect_template_vel_y = (float)(int)(uVar2 - 0x40);
      iVar3 = crt_rand();
      _effect_template_scale_step = (float)(iVar3 % 100) * 0.01 + 0.1;
      effect_spawn(0,pos);
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
    return piVar1;
  }
  return (int *)&bonus_pool_sentinel;
}



/* bonus_spawn_at_pos @ 0041f790 */

/* allocates a bonus slot near pos, enforces spacing/edges, picks bonus type + amount */

uint * __cdecl bonus_spawn_at_pos(float *pos)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  
  if ((((*pos < 32.0) || ((float)(terrain_texture_width + -0x20) < *pos)) || (pos[1] < 32.0)) ||
     (((float)(terrain_texture_height + -0x20) < pos[1] || (config_blob.reserved0._24_4_ == 2)))) {
    return (uint *)&bonus_pool_sentinel;
  }
  puVar1 = (uint *)bonus_alloc_slot();
  piVar4 = &bonus_pool;
  while ((*piVar4 == 0 ||
         (32.0 <= SQRT((pos[1] - (float)piVar4[5]) * (pos[1] - (float)piVar4[5]) +
                       (*pos - (float)piVar4[4]) * (*pos - (float)piVar4[4]))))) {
    piVar4 = piVar4 + 7;
    if (0x482b07 < (int)piVar4) {
LAB_0041f853:
      *(undefined1 *)(puVar1 + 1) = 0;
      puVar1[4] = (uint)*pos;
      puVar1[5] = (uint)pos[1];
      puVar1[2] = 0x41200000;
      puVar1[3] = 0x41200000;
      uVar2 = bonus_pick_random_type();
      *puVar1 = uVar2;
      if (uVar2 == 3) {
        uVar2 = weapon_pick_random_available();
        puVar1[6] = uVar2;
        return puVar1;
      }
      if (*puVar1 == 1) {
        puVar1[6] = 500;
        iVar3 = crt_rand();
        if (((byte)iVar3 & 7) < 3) {
          puVar1[6] = 1000;
          return puVar1;
        }
      }
      else {
        puVar1[6] = *(uint *)(&bonus_meta_default_amount + *puVar1 * 0x14);
      }
      return puVar1;
    }
  }
  puVar1 = (uint *)&bonus_pool_sentinel;
  goto LAB_0041f853;
}



/* bonus_try_spawn_on_kill @ 0041f8d0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* decides whether to drop a bonus on kill (mode/perk rules) and spawns pickup burst */

uint * __cdecl bonus_try_spawn_on_kill(float *pos)

{
  int iVar1;
  uint *puVar2;
  uint *puVar3;
  uint uVar4;
  int iVar5;
  uint *puVar6;
  
  if (config_blob.reserved0._24_4_ == 4) {
    return (uint *)0x4;
  }
  if (demo_mode_active != '\0') {
    return (uint *)config_blob.reserved0._24_4_;
  }
  if (config_blob.reserved0._24_4_ == 2) {
    return (uint *)0x2;
  }
  if (config_blob.reserved0._24_4_ == 8) {
    return (uint *)0x8;
  }
  if (((player_health._pad0._668_4_ == 1) ||
      ((player2_weapon_id == 1 && (config_blob.reserved0._20_4_ == 2)))) &&
     (iVar1 = crt_rand(), ((byte)iVar1 & 3) < 3)) {
    puVar2 = bonus_spawn_at_pos(pos);
    *puVar2 = 3;
    puVar3 = (uint *)weapon_pick_random_available();
    puVar2[6] = (uint)puVar3;
    if (puVar3 == (uint *)0x1) {
      puVar3 = (uint *)weapon_pick_random_available();
      puVar2[6] = (uint)puVar3;
    }
    iVar1 = 0;
    if (*puVar2 != 1) {
      puVar3 = &bonus_pool;
      do {
        if (*puVar3 == *puVar2) {
          iVar1 = iVar1 + 1;
        }
        puVar3 = puVar3 + 7;
      } while ((int)puVar3 < 0x482b08);
      if (1 < iVar1) goto LAB_0041f998;
    }
    if (puVar2[6] == 1) {
LAB_0041f998:
      *puVar2 = 0;
      return puVar3;
    }
    puVar3 = (uint *)perk_count_get(perk_id_my_favourite_weapon);
    puVar6 = (uint *)0x0;
    if (puVar3 != (uint *)0x0) goto LAB_0041f998;
  }
  else {
    iVar1 = crt_rand();
    if ((iVar1 % 9 != 1) &&
       ((player_health._pad0._668_4_ != 1 || (iVar1 = crt_rand(), iVar1 % 5 != 1)))) {
      iVar1 = perk_count_get(perk_id_bonus_magnet);
      if (iVar1 == 0) {
        return (uint *)0x0;
      }
      iVar1 = crt_rand();
      if (iVar1 % 10 != 2) {
        return (uint *)(iVar1 / 10);
      }
    }
    puVar2 = bonus_spawn_at_pos(pos);
    if ((*puVar2 == 3) &&
       (SQRT((pos[1] - player_pos_y) * (pos[1] - player_pos_y) +
             (*pos - player_pos_x) * (*pos - player_pos_x)) < 56.0)) {
      *puVar2 = 1;
      puVar2[6] = 100;
    }
    iVar1 = 0;
    if (*puVar2 != 1) {
      puVar3 = &bonus_pool;
      do {
        if (*puVar3 == *puVar2) {
          iVar1 = iVar1 + 1;
        }
        puVar3 = puVar3 + 7;
      } while ((int)puVar3 < 0x482b08);
      if (1 < iVar1) goto LAB_0041fa76;
    }
    puVar3 = (uint *)player_health._pad0._668_4_;
    puVar6 = (uint *)player_health._pad0._668_4_;
    if (puVar2[6] == player_health._pad0._668_4_) {
LAB_0041fa76:
      *puVar2 = 0;
      return puVar3;
    }
  }
  if ((puVar2 != (uint *)0x0) && (puVar2 != (uint *)&bonus_pool_sentinel)) {
    _effect_template_color_r = 0x3ecccccd;
    _effect_template_flags = 0x1d;
    _effect_template_color_g = 0x3f000000;
    _effect_template_color_b = 0x3f800000;
    _effect_template_color_a = 0x3f000000;
    _effect_template_lifetime = 0x3f000000;
    _effect_template_half_width = 0x42000000;
    _effect_template_half_height = 0x42000000;
    iVar1 = 0x10;
    do {
      uVar4 = crt_rand();
      _effect_template_rotation = (float)(uVar4 & 0x7f) * 0.049087387;
      uVar4 = crt_rand();
      uVar4 = uVar4 & 0x8000007f;
      if ((int)uVar4 < 0) {
        uVar4 = (uVar4 - 1 | 0xffffff80) + 1;
      }
      effect_template_vel_x = (float)(int)(uVar4 - 0x40);
      uVar4 = crt_rand();
      uVar4 = uVar4 & 0x8000007f;
      if ((int)uVar4 < 0) {
        uVar4 = (uVar4 - 1 | 0xffffff80) + 1;
      }
      effect_template_vel_y = (float)(int)(uVar4 - 0x40);
      iVar5 = crt_rand();
      _effect_template_scale_step = (float)(iVar5 % 100) * 0.01 + 0.1;
      puVar6 = effect_spawn(0,pos);
      iVar1 = iVar1 + -1;
    } while (iVar1 != 0);
  }
  return puVar6;
}



/* fx_spawn_sprite @ 0041fbb0 */

/* spawns a sprite effect entry in DAT_00496820 */

int __cdecl fx_spawn_sprite(float *pos,float *vel,float scale)

{
  sprite_effect_t *psVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = 0;
  psVar1 = &sprite_effect_pool;
  do {
    if ((char)psVar1->active == '\0') goto LAB_0041fbd8;
    psVar1 = psVar1 + 1;
    iVar3 = iVar3 + 1;
  } while ((int)psVar1 < 0x49aa20);
  iVar3 = crt_rand();
  iVar3 = iVar3 % 0x180;
LAB_0041fbd8:
  *(undefined1 *)&(&sprite_effect_pool)[iVar3].active = 1;
  (&sprite_effect_pool)[iVar3].color_b = 1.0;
  (&sprite_effect_pool)[iVar3].color_g = 1.0;
  (&sprite_effect_pool)[iVar3].color_r = 1.0;
  (&sprite_effect_pool)[iVar3].color_a = 1.0;
  (&sprite_effect_pool)[iVar3].pos_x = *pos;
  (&sprite_effect_pool)[iVar3].pos_y = pos[1];
  (&sprite_effect_pool)[iVar3].vel_x = *vel;
  (&sprite_effect_pool)[iVar3].vel_y = vel[1];
  (&sprite_effect_pool)[iVar3].scale = scale;
  iVar2 = crt_rand();
  (&sprite_effect_pool)[iVar3].rotation = (float)(iVar2 % 0x274) * 0.01;
  return iVar3;
}



/* weapon_table_entry @ 0041fc60 */

/* returns the entry base (&DAT_004d7a2c + weapon_id * 0x1f) */

char * __cdecl weapon_table_entry(int weapon_id)

{
  return (&weapon_table)[weapon_id].name;
}



/* FUN_0041fc80 @ 0041fc80 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] void* sub_41fc80() */

void * FUN_0041fc80(void)

{
  player_state_t *ppVar1;
  float fVar2;
  float fVar3;
  char cVar4;
  uint uVar5;
  undefined4 uVar6;
  int iVar7;
  uchar *puVar8;
  uint uVar9;
  bool bVar10;
  
  if (*(float *)((int)cv_verbose + 0xc) != 0.0) {
    console_printf(&console_log_queue,s___Reseting_players__00473e54);
  }
  render_overlay_player_index = 0;
  do {
    uVar5 = render_overlay_player_index;
    fVar2 = (float)terrain_texture_width;
    _DAT_004aaf30 = 0;
    iVar7 = render_overlay_player_index * 0x360;
    fVar3 = (float)terrain_texture_height;
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x2f0] = '\0';
    ppVar1->_pad0[0x2f1] = '\0';
    ppVar1->_pad0[0x2f2] = '\0';
    ppVar1->_pad0[0x2f3] = '\0';
    ppVar1 = &player_health + uVar5;
    ppVar1->_pad0[0x2f4] = '\0';
    ppVar1->_pad0[0x2f5] = '\0';
    ppVar1->_pad0[0x2f6] = '\0';
    ppVar1->_pad0[0x2f7] = '\0';
    ppVar1 = &player_health + uVar5;
    ppVar1->_pad0[0x2e4] = '\0';
    ppVar1->_pad0[0x2e5] = '\0';
    ppVar1->_pad0[0x2e6] = '\0';
    ppVar1->_pad0[0x2e7] = '\0';
    (&player_plaguebearer_active)[iVar7] = 0;
    (&player_pos_x)[uVar5 * 0xd8] = fVar2 * 0.5;
    (&player_pos_y)[uVar5 * 0xd8] = fVar3 * 0.5;
    uVar9 = uVar5 & 0x80000001;
    bVar10 = uVar9 == 0;
    ppVar1 = &player_health + uVar5;
    ppVar1->_pad0[0] = '\0';
    ppVar1->_pad0[1] = '\0';
    ppVar1->_pad0[2] = 200;
    ppVar1->_pad0[3] = 'B';
    if ((int)uVar9 < 0) {
      bVar10 = (uVar9 - 1 | 0xfffffffe) == 0xffffffff;
    }
    if (bVar10) {
      (&player_pos_x)[uVar5 * 0xd8] =
           (float)(int)(uVar5 * 0x50) + (float)(&player_pos_x)[uVar5 * 0xd8];
      (&player_pos_y)[uVar5 * 0xd8] =
           (float)(int)(uVar5 * 0x50) + (float)(&player_pos_y)[uVar5 * 0xd8];
    }
    else {
      (&player_pos_x)[uVar5 * 0xd8] =
           (float)(&player_pos_x)[uVar5 * 0xd8] - (float)(int)(uVar5 * 0x50);
      (&player_pos_y)[uVar5 * 0xd8] =
           (float)(&player_pos_y)[uVar5 * 0xd8] - (float)(int)(uVar5 * 0x50);
    }
    fVar2 = (float)_DAT_004d7aec;
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x10] = '\0';
    ppVar1->_pad0[0x11] = '\0';
    ppVar1->_pad0[0x12] = '@';
    ppVar1->_pad0[0x13] = 'B';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x38] = '\0';
    ppVar1->_pad0[0x39] = '\0';
    ppVar1->_pad0[0x3a] = '\0';
    ppVar1->_pad0[0x3b] = '@';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x90] = '\x01';
    ppVar1->_pad0[0x91] = '\0';
    ppVar1->_pad0[0x92] = '\0';
    ppVar1->_pad0[0x93] = '\0';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[8] = '\0';
    ppVar1->_pad0[9] = '\0';
    ppVar1->_pad0[10] = '\0';
    ppVar1->_pad0[0xb] = '\0';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x88] = '\0';
    ppVar1->_pad0[0x89] = '\0';
    ppVar1->_pad0[0x8a] = '\0';
    ppVar1->_pad0[0x8b] = '\0';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x8c] = '\0';
    ppVar1->_pad0[0x8d] = '\0';
    ppVar1->_pad0[0x8e] = '\0';
    ppVar1->_pad0[0x8f] = '\0';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x294] = '\0';
    ppVar1->_pad0[0x295] = '\0';
    ppVar1->_pad0[0x296] = '\0';
    ppVar1->_pad0[0x297] = '\0';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x44] = '\0';
    ppVar1->_pad0[0x45] = '\0';
    ppVar1->_pad0[0x46] = '\0';
    ppVar1->_pad0[0x47] = '\0';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x2a8] = '\0';
    ppVar1->_pad0[0x2a9] = '\0';
    ppVar1->_pad0[0x2aa] = ' ';
    ppVar1->_pad0[0x2ab] = 'A';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x2a0] = '\0';
    ppVar1->_pad0[0x2a1] = '\0';
    ppVar1->_pad0[0x2a2] = ' ';
    ppVar1->_pad0[0x2a3] = 'A';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x2b4] = '\0';
    ppVar1->_pad0[0x2b5] = '\0';
    ppVar1->_pad0[0x2b6] = 0x80;
    ppVar1->_pad0[0x2b7] = '?';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x2ac] = '\0';
    ppVar1->_pad0[0x2ad] = '\0';
    ppVar1->_pad0[0x2ae] = '\0';
    ppVar1->_pad0[0x2af] = '\0';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x2b8] = '\x01';
    ppVar1->_pad0[0x2b9] = '\0';
    ppVar1->_pad0[0x2ba] = '\0';
    ppVar1->_pad0[699] = '\0';
    *(float *)((&player_health)[render_overlay_player_index]._pad0 + 700) = fVar2;
    (&player_health)[render_overlay_player_index]._pad0[0x2c0] = '\0';
    *(undefined4 *)((&player_health)[render_overlay_player_index]._pad0 + 0x2c4) =
         *(undefined4 *)((&player_health)[render_overlay_player_index]._pad0 + 700);
    uVar6 = DAT_004d7af4;
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x2c8] = '\0';
    ppVar1->_pad0[0x2c9] = '\0';
    ppVar1->_pad0[0x2ca] = '\0';
    ppVar1->_pad0[0x2cb] = '\0';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x2cc] = '\0';
    ppVar1->_pad0[0x2cd] = '\0';
    ppVar1->_pad0[0x2ce] = '\0';
    ppVar1->_pad0[0x2cf] = '\0';
    *(undefined4 *)((&player_health)[render_overlay_player_index]._pad0 + 0x2d0) = uVar6;
    cVar4 = demo_mode_active;
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x2b0] = 0xcd;
    ppVar1->_pad0[0x2b1] = 0xcc;
    ppVar1->_pad0[0x2b2] = 'L';
    ppVar1->_pad0[0x2b3] = '?';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x29c] = '\x01';
    ppVar1->_pad0[0x29d] = '\0';
    ppVar1->_pad0[0x29e] = '\0';
    ppVar1->_pad0[0x29f] = '\0';
    ppVar1 = &player_health + render_overlay_player_index;
    ppVar1->_pad0[0x2d4] = '\0';
    ppVar1->_pad0[0x2d5] = '\0';
    ppVar1->_pad0[0x2d6] = '\0';
    ppVar1->_pad0[0x2d7] = '\0';
    (&player_death_timer)[render_overlay_player_index * 0xd8] = 0x41800000;
    if (cVar4 == '\0') {
      ui_mouse_x = 0x43a00000;
      ui_mouse_y = 0x430c0000;
    }
    puVar8 = (&player_health)[render_overlay_player_index]._pad0 + 0x94;
    for (iVar7 = 0x80; iVar7 != 0; iVar7 = iVar7 + -1) {
      puVar8[0] = '\0';
      puVar8[1] = '\0';
      puVar8[2] = '\0';
      puVar8[3] = '\0';
      puVar8 = puVar8 + 4;
    }
    puVar8 = &creature_pool.collision_flag;
    do {
      *puVar8 = '\0';
      puVar8 = puVar8 + 0x98;
    } while ((int)puVar8 < 0x4aa341);
    render_overlay_player_index = render_overlay_player_index + 1;
  } while ((int)render_overlay_player_index < 2);
  render_overlay_player_index = 0;
  return puVar8;
}



/* effect_uv_tables_init @ 0041fed0 */

/* precomputes UV grids for 2x2, 4x4, 8x8, 16x16 effect atlases */

void effect_uv_tables_init(void)

{
  float fVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  float *pfVar4;
  float *pfVar5;
  int local_8;
  int local_4;
  
  local_8 = 0;
  puVar2 = &DAT_00490f84;
  do {
    fVar1 = (float)local_8;
    puVar3 = puVar2 + 2;
    local_8 = local_8 + 1;
    puVar2[-1] = fVar1 * 0.0625;
    *puVar2 = 0;
    puVar2 = puVar3;
  } while ((int)puVar3 < 0x491004);
  local_4 = 0;
  pfVar5 = (float *)&effect_uv2_v;
  do {
    local_8 = 0;
    pfVar4 = pfVar5;
    do {
      fVar1 = (float)local_8;
      local_8 = local_8 + 1;
      pfVar4[-1] = fVar1 * 0.5;
      *pfVar4 = (float)local_4 * 0.5;
      pfVar4 = pfVar4 + 2;
    } while (local_8 < 2);
    local_4 = local_4 + 1;
    pfVar5 = pfVar5 + 4;
  } while (local_4 < 2);
  local_4 = 0;
  pfVar5 = (float *)&effect_uv4_v;
  do {
    local_8 = 0;
    pfVar4 = pfVar5;
    do {
      fVar1 = (float)local_8;
      local_8 = local_8 + 1;
      pfVar4[-1] = fVar1 * 0.25;
      *pfVar4 = (float)local_4 * 0.25;
      pfVar4 = pfVar4 + 2;
    } while (local_8 < 4);
    local_4 = local_4 + 1;
    pfVar5 = pfVar5 + 8;
  } while (local_4 < 4);
  local_4 = 0;
  pfVar5 = (float *)&effect_uv8_v;
  do {
    local_8 = 0;
    pfVar4 = pfVar5;
    do {
      fVar1 = (float)local_8;
      local_8 = local_8 + 1;
      pfVar4[-1] = fVar1 * 0.125;
      *pfVar4 = (float)local_4 * 0.125;
      pfVar4 = pfVar4 + 2;
    } while (local_8 < 8);
    local_4 = local_4 + 1;
    pfVar5 = pfVar5 + 0x10;
  } while (local_4 < 8);
  local_4 = 0;
  pfVar5 = (float *)&effect_uv16_v;
  do {
    local_8 = 0;
    pfVar4 = pfVar5;
    do {
      fVar1 = (float)local_8;
      local_8 = local_8 + 1;
      pfVar4[-1] = fVar1 * 0.0625;
      *pfVar4 = (float)local_4 * 0.0625;
      pfVar4 = pfVar4 + 2;
    } while (local_8 < 0x10);
    local_4 = local_4 + 1;
    pfVar5 = pfVar5 + 0x20;
  } while (local_4 < 0x10);
  return;
}



/* creature_find_nearest @ 00420040 */

/* returns nearest creature index; uses hitbox-size sentinel when exclude_id == -1 */

int __cdecl creature_find_nearest(float *pos,int exclude_id,float min_dist)

{
  float fVar1;
  float fVar2;
  float fVar3;
  creature_t *pcVar4;
  int iVar5;
  int iVar6;
  
  fVar1 = 1e+06;
  iVar6 = 0;
  if (exclude_id == -1) {
    iVar5 = 0;
    pcVar4 = &creature_pool;
    do {
      if (((pcVar4->active != '\0') && (pcVar4->hitbox_size == 16.0)) &&
         (fVar2 = *pos - pcVar4->pos_x, fVar3 = pos[1] - pcVar4->pos_y,
         fVar2 = SQRT(fVar3 * fVar3 + fVar2 * fVar2), fVar2 < fVar1)) {
        iVar6 = iVar5;
        fVar1 = fVar2;
      }
      pcVar4 = pcVar4 + 1;
      iVar5 = iVar5 + 1;
    } while ((int)pcVar4 < 0x4aa338);
    return iVar6;
  }
  iVar5 = 0;
  pcVar4 = &creature_pool;
  do {
    if ((((pcVar4->active != '\0') && (iVar5 != exclude_id)) &&
        (fVar2 = *pos - pcVar4->pos_x, fVar3 = pos[1] - pcVar4->pos_y,
        fVar2 = SQRT(fVar2 * fVar2 + fVar3 * fVar3), min_dist < fVar2)) && (fVar2 < fVar1)) {
      iVar6 = iVar5;
      fVar1 = fVar2;
    }
    pcVar4 = pcVar4 + 1;
    iVar5 = iVar5 + 1;
  } while ((int)pcVar4 < 0x4aa338);
  return iVar6;
}



/* fx_spawn_particle @ 00420130 */

/* spawns a fast particle entry in DAT_00493eb8 */

int __cdecl fx_spawn_particle(float *pos,float angle,void *unused,float intensity)

{
  particle_t *ppVar1;
  int iVar2;
  uint uVar3;
  float10 fVar4;
  
  ppVar1 = &particle_pool;
  uVar3 = 0;
  do {
    if (ppVar1->active == '\0') goto LAB_00420160;
    ppVar1 = ppVar1 + 1;
    uVar3 = uVar3 + 1;
  } while ((int)ppVar1 < 0x495ab8);
  uVar3 = crt_rand();
  uVar3 = uVar3 & 0x8000007f;
  if ((int)uVar3 < 0) {
    uVar3 = (uVar3 - 1 | 0xffffff80) + 1;
  }
LAB_00420160:
  fVar4 = (float10)fcos((float10)angle);
  (&particle_pool)[uVar3].active = '\x01';
  (&particle_pool)[uVar3].pos_x = *pos;
  (&particle_pool)[uVar3].pos_y = pos[1];
  (&particle_pool)[uVar3].vel_x = (float)(fVar4 * (float10)90.0);
  fVar4 = (float10)fsin((float10)angle);
  (&particle_pool)[uVar3].vel_y = (float)(fVar4 * (float10)90.0);
  (&particle_pool)[uVar3].intensity = intensity;
  (&particle_pool)[uVar3].scale_x = 1.0;
  (&particle_pool)[uVar3].scale_y = 1.0;
  (&particle_pool)[uVar3].scale_z = 1.0;
  (&particle_pool)[uVar3].age = 0.0;
  (&particle_pool)[uVar3].angle = angle;
  iVar2 = crt_rand();
  (&particle_pool)[uVar3].spin = (float)(iVar2 % 0x274) * 0.01;
  (&particle_pool)[uVar3].render_flag = '\x01';
  *(undefined1 *)&(&particle_pool)[uVar3].style_id = 0;
  return uVar3;
}



/* fx_spawn_particle_slow @ 00420240 */

/* spawns a slow particle entry in DAT_00493eb8 */

int __cdecl fx_spawn_particle_slow(float *pos,float angle)

{
  particle_t *ppVar1;
  int iVar2;
  uint uVar3;
  float10 fVar4;
  
  ppVar1 = &particle_pool;
  uVar3 = 0;
  do {
    if (ppVar1->active == '\0') goto LAB_00420270;
    ppVar1 = ppVar1 + 1;
    uVar3 = uVar3 + 1;
  } while ((int)ppVar1 < 0x495ab8);
  uVar3 = crt_rand();
  uVar3 = uVar3 & 0x8000007f;
  if ((int)uVar3 < 0) {
    uVar3 = (uVar3 - 1 | 0xffffff80) + 1;
  }
LAB_00420270:
  fVar4 = (float10)fcos((float10)angle);
  (&particle_pool)[uVar3].active = '\x01';
  (&particle_pool)[uVar3].pos_x = *pos;
  (&particle_pool)[uVar3].pos_y = pos[1];
  (&particle_pool)[uVar3].vel_x = (float)(fVar4 * (float10)30.0);
  fVar4 = (float10)fsin((float10)angle);
  (&particle_pool)[uVar3].vel_y = (float)(fVar4 * (float10)30.0);
  (&particle_pool)[uVar3].intensity = 1.0;
  (&particle_pool)[uVar3].scale_x = 1.0;
  (&particle_pool)[uVar3].scale_y = 1.0;
  (&particle_pool)[uVar3].scale_z = 1.0;
  (&particle_pool)[uVar3].age = 0.0;
  (&particle_pool)[uVar3].angle = angle;
  iVar2 = crt_rand();
  (&particle_pool)[uVar3].spin = (float)(iVar2 % 0x274) * 0.01;
  (&particle_pool)[uVar3].render_flag = '\x01';
  *(undefined1 *)&(&particle_pool)[uVar3].style_id = 8;
  (&particle_pool)[uVar3].target_id = -1;
  return uVar3;
}



/* fx_spawn_secondary_projectile @ 00420360 */

/* spawns a typed entry in DAT_00495ad8 (secondary projectile pool) */

int __cdecl fx_spawn_secondary_projectile(float *pos,float angle,int type_id)

{
  int iVar1;
  secondary_projectile_t *psVar2;
  int iVar3;
  int iVar4;
  float10 fVar5;
  float10 fVar6;
  
  iVar4 = 0;
  psVar2 = &secondary_projectile_pool;
  do {
    if (psVar2->active == '\0') goto LAB_0042037f;
    psVar2 = (secondary_projectile_t *)&psVar2[1].angle;
    iVar4 = iVar4 + 1;
  } while ((int)psVar2 < 0x4965d8);
  iVar4 = 0x3f;
LAB_0042037f:
  highscore_active_record.shots_fired = highscore_active_record.shots_fired + 1;
  fVar5 = (float10)fcos((float10)angle - (float10)1.5707964);
  iVar1 = iVar4 * 0x2c;
  *(undefined1 *)((int)&secondary_projectile_pool + iVar1) = 1;
  *(float *)((int)&secondary_projectile_pool + iVar1 + 0xc) = *pos;
  *(float *)((int)&secondary_projectile_pool + iVar1 + 0x10) = pos[1];
  *(undefined4 *)((int)&secondary_projectile_pool + iVar1 + 8) = 0x40000000;
  *(float *)((int)&secondary_projectile_pool + iVar1 + 4) = angle;
  *(undefined4 *)((int)&secondary_projectile_pool + iVar1 + 0x20) = 0;
  *(int *)((int)&secondary_projectile_pool + iVar1 + 0x1c) = type_id;
  *(float *)((int)&secondary_projectile_pool + iVar1 + 0x14) = (float)(fVar5 * (float10)90.0);
  fVar6 = (float10)fsin((float10)angle - (float10)1.5707964);
  *(float *)((int)&secondary_projectile_pool + iVar1 + 0x18) = (float)(fVar6 * (float10)90.0);
  if (type_id == 2) {
    iVar3 = creature_find_nearest
                      ((float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2c),-1,0.0)
    ;
    *(int *)((int)&secondary_projectile_pool + iVar1 + 0x24) = iVar3;
    *(float *)((int)&secondary_projectile_pool + iVar1 + 0x14) = (float)fVar5 * 190.0;
    *(float *)((int)&secondary_projectile_pool + iVar1 + 0x18) = (float)fVar6 * 190.0;
  }
  return iVar4;
}



/* projectile_spawn @ 00420440 */

/* allocates a projectile slot, initializes fields, and returns the index (overrides to type 0x2d
   when Fire Bullets is active) */

int __cdecl projectile_spawn(float *pos,float angle,int type_id,int owner_id)

{
  projectile_t *ppVar1;
  int iVar2;
  float10 fVar3;
  
  if (bonus_spawn_guard == '\0') {
    while (((((owner_id == -100 || (owner_id == -1)) || (owner_id == -2)) || (owner_id == -3)) &&
           ((highscore_active_record.shots_fired = highscore_active_record.shots_fired + 1,
            type_id != 0x2d &&
            ((0.0 < (float)player_health._pad0._760_4_ || (0.0 < player2_fire_bullets_timer))))))) {
      type_id = 0x2d;
    }
  }
  iVar2 = 0;
  ppVar1 = &projectile_pool;
  do {
    if (ppVar1->active == '\0') goto LAB_004204d7;
    ppVar1 = ppVar1 + 1;
    iVar2 = iVar2 + 1;
  } while ((int)ppVar1 < 0x493eb8);
  iVar2 = 0x5f;
LAB_004204d7:
  fVar3 = (float10)fcos((float10)angle);
  (&projectile_pool)[iVar2].owner_id = owner_id;
  (&projectile_pool)[iVar2].active = '\x01';
  (&projectile_pool)[iVar2].base_damage = (&weapon_table)[type_id].projectile_meta;
  (&projectile_pool)[iVar2].pos_x = *pos;
  (&projectile_pool)[iVar2].pos_y = pos[1];
  (&projectile_pool)[iVar2].origin_x = *pos;
  (&projectile_pool)[iVar2].origin_y = pos[1];
  (&projectile_pool)[iVar2].angle = angle;
  (&projectile_pool)[iVar2].type_id = type_id;
  (&projectile_pool)[iVar2].life_timer = 0.4;
  (&projectile_pool)[iVar2].reserved = 0.0;
  (&projectile_pool)[iVar2].speed_scale = 1.0;
  (&projectile_pool)[iVar2].vel_x = (float)(fVar3 * (float10)1.5);
  fVar3 = (float10)fsin((float10)angle);
  (&projectile_pool)[iVar2].vel_y = (float)(fVar3 * (float10)1.5);
  if (type_id == 0x16) {
    (&projectile_pool)[iVar2].hit_radius = 3.0;
    (&projectile_pool)[iVar2].damage_pool = 1.0;
    return iVar2;
  }
  if (type_id == 0x15) {
    (&projectile_pool)[iVar2].hit_radius = 5.0;
    (&projectile_pool)[iVar2].damage_pool = 1.0;
    return iVar2;
  }
  if ((type_id == 0x17) || (type_id == 0x1c)) {
    (&projectile_pool)[iVar2].hit_radius = 10.0;
  }
  else {
    (&projectile_pool)[iVar2].hit_radius = 1.0;
    if (type_id == 6) {
      (&projectile_pool)[iVar2].damage_pool = 300.0;
      return iVar2;
    }
    if (type_id == 0x2d) {
      (&projectile_pool)[iVar2].damage_pool = 240.0;
      return iVar2;
    }
    if (type_id == 0x19) {
      (&projectile_pool)[iVar2].damage_pool = 50.0;
      return iVar2;
    }
  }
  (&projectile_pool)[iVar2].damage_pool = 1.0;
  return iVar2;
}



/* projectile_reset_pools @ 004205d0 */

/* clears projectile and effect pools (DAT_004926b8, DAT_00493eb8) */

void projectile_reset_pools(void)

{
  projectile_t *ppVar1;
  particle_t *ppVar2;
  
  ppVar1 = &projectile_pool;
  do {
    ppVar1->active = '\0';
    ppVar1 = ppVar1 + 1;
  } while ((int)ppVar1 < 0x493eb8);
  ppVar2 = &particle_pool;
  do {
    ppVar2->active = '\0';
    ppVar2 = ppVar2 + 1;
  } while ((int)ppVar2 < 0x495ab8);
  return;
}



/* creatures_apply_radius_damage @ 00420600 */

/* applies damage to creatures within radius using FUN_004207c0 */

void __cdecl creatures_apply_radius_damage(float *pos,float radius,float damage,int damage_type)

{
  float fVar1;
  float fVar2;
  creature_t *pcVar3;
  int creature_id;
  float local_8 [2];
  
  local_8[0] = 0.0;
  local_8[1] = 0.0;
  creature_id = 0;
  pcVar3 = &creature_pool;
  do {
    if (((pcVar3->active != '\0') &&
        (fVar1 = pcVar3->pos_x - *pos, fVar2 = pcVar3->pos_y - pos[1],
        SQRT(fVar2 * fVar2 + fVar1 * fVar1) - radius < pcVar3->size * 0.14285715 + 3.0)) &&
       (5.0 < pcVar3->hitbox_size)) {
      creature_apply_damage(creature_id,damage,damage_type,local_8);
    }
    pcVar3 = pcVar3 + 1;
    creature_id = creature_id + 1;
  } while ((int)pcVar3 < 0x4aa338);
  return;
}



/* creature_find_in_radius @ 004206a0 */

/* returns the first creature index in range, or -1 */

int __cdecl creature_find_in_radius(float *pos,float radius,int start_index)

{
  float fVar1;
  float fVar2;
  creature_t *pcVar3;
  
  if (start_index < 0x180) {
    pcVar3 = &creature_pool + start_index;
    do {
      if (pcVar3->active != '\0') {
        fVar1 = pcVar3->pos_x - *pos;
        fVar2 = pcVar3->pos_y - pos[1];
        if (SQRT(fVar2 * fVar2 + fVar1 * fVar1) - radius < pcVar3->size * 0.14285715 + 3.0) {
          if (5.0 < pcVar3->hitbox_size) {
            return start_index;
          }
        }
      }
      pcVar3 = pcVar3 + 1;
      start_index = start_index + 1;
    } while ((int)pcVar3 < 0x4aa338);
  }
  return -1;
}



/* player_find_in_radius @ 00420730 */

/* returns a player index in range, skipping owner_id (-1/-2/-3 -> player 0/1/2) */

int __cdecl player_find_in_radius(int owner_id,float *pos,float radius)

{
  float fVar1;
  float fVar2;
  int iVar3;
  player_state_t *ppVar4;
  
  iVar3 = 0;
  if (0 < (int)config_blob.reserved0._20_4_) {
    ppVar4 = &player_health;
    do {
      if (iVar3 != -1 - owner_id) {
        if (0.0 < *(float *)ppVar4->_pad0) {
          fVar1 = *(float *)(ppVar4[-1]._pad1 + 0x14) - *pos;
          fVar2 = *(float *)(ppVar4[-1]._pad1 + 0x18) - pos[1];
          if (SQRT(fVar2 * fVar2 + fVar1 * fVar1) - radius <
              *(float *)(ppVar4->_pad0 + 0x10) * 0.14285715 + 3.0) {
            return iVar3;
          }
        }
      }
      iVar3 = iVar3 + 1;
      ppVar4 = ppVar4 + 1;
    } while (iVar3 < (int)config_blob.reserved0._20_4_);
  }
  return -1;
}



/* creature_apply_damage @ 004207c0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* applies damage + impulse, handles death side effects; returns 1 when killed */

int __cdecl creature_apply_damage(int creature_id,float damage,int damage_type,float *impulse)

{
  float fVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  uchar *puVar5;
  
  (&creature_pool)[creature_id].hit_flash_timer = 0.2;
  if (damage_type == 1) {
    iVar2 = perk_count_get(perk_id_uranium_filled_bullets);
    if (iVar2 != 0) {
      damage = damage + damage;
    }
    iVar2 = perk_count_get(perk_id_living_fortress);
    if ((iVar2 != 0) && (0 < (int)config_blob.reserved0._20_4_)) {
      puVar5 = player_health._pad0 + 0x80;
      iVar2 = config_blob.reserved0._20_4_;
      do {
        if (0.0 < *(float *)((player_state_t *)(puVar5 + -0x80))->_pad0) {
          damage = (*(float *)puVar5 * 0.05 + 1.0) * damage;
        }
        puVar5 = puVar5 + 0x360;
        iVar2 = iVar2 + -1;
      } while (iVar2 != 0);
    }
    iVar2 = perk_count_get(perk_id_barrel_greaser);
    if (iVar2 != 0) {
      damage = damage * 1.4;
    }
    iVar2 = perk_count_get(perk_id_doctor);
    if (iVar2 != 0) {
      damage = damage * 1.2;
    }
    if (((&creature_pool)[creature_id].flags & 4) == 0) {
      uVar3 = crt_rand();
      fVar1 = ((float)(int)((uVar3 & 0x7f) - 0x40) * 0.002) /
              ((&creature_pool)[creature_id].size * 0.025);
      if (1.5707964 < fVar1) {
        fVar1 = 1.5707964;
      }
      (&creature_pool)[creature_id].heading = fVar1 + (&creature_pool)[creature_id].heading;
    }
  }
  else if ((damage_type == 7) && (iVar2 = perk_count_get(perk_id_ion_gun_master), iVar2 != 0)) {
    damage = damage * 1.2;
  }
  if ((&creature_pool)[creature_id].health <= 0.0) {
    (&creature_pool)[creature_id].hitbox_size =
         (&creature_pool)[creature_id].hitbox_size - frame_dt * 15.0;
  }
  else {
    if ((damage_type == 4) && (iVar2 = perk_count_get(perk_id_pyromaniac), iVar2 != 0)) {
      damage = damage * 1.5;
      crt_rand();
    }
    (&creature_pool)[creature_id].health = (&creature_pool)[creature_id].health - damage;
    (&creature_pool)[creature_id].vel_x = (&creature_pool)[creature_id].vel_x - *impulse;
    (&creature_pool)[creature_id].vel_y = (&creature_pool)[creature_id].vel_y - impulse[1];
    if ((&creature_pool)[creature_id].health <= 0.0) {
      (&creature_pool)[creature_id].hitbox_size =
           (&creature_pool)[creature_id].hitbox_size - frame_dt;
      creature_handle_death(creature_id,true);
      fVar1 = impulse[1];
      (&creature_pool)[creature_id].vel_x =
           (&creature_pool)[creature_id].vel_x - (*impulse + *impulse);
      (&creature_pool)[creature_id].vel_y = (&creature_pool)[creature_id].vel_y - (fVar1 + fVar1);
      if (((&creature_pool)[creature_id].flags & 0x10) == 0) {
        uVar3 = crt_rand();
        uVar3 = uVar3 & 0x80000003;
        if ((int)uVar3 < 0) {
          uVar3 = (uVar3 - 1 | 0xfffffffc) + 1;
        }
        sfx_play_panned(*(float *)(&creature_type_sfx_a0 +
                                  (uVar3 + (&creature_pool)[creature_id].type_id * 0x11) * 4));
      }
      else {
        _effect_template_color_r = 0x3f4ccccd;
        _effect_template_flags = 0x1d;
        _effect_template_color_g = 0x3f4ccccd;
        _effect_template_color_b = 0x3e99999a;
        _effect_template_color_a = 0x3f000000;
        _effect_template_lifetime = 0x3f333333;
        _effect_template_half_width = 0x42100000;
        _effect_template_half_height = 0x42100000;
        iVar2 = 5;
        do {
          uVar3 = crt_rand();
          _effect_template_rotation = (float)(uVar3 & 0x7f) * 0.049087387;
          uVar3 = crt_rand();
          effect_template_vel_x = (float)(int)((uVar3 & 0x7f) - 0x40);
          uVar3 = crt_rand();
          effect_template_vel_y = (float)(int)((uVar3 & 0x7f) - 0x40);
          iVar4 = crt_rand();
          _effect_template_scale_step = (float)(iVar4 % 0x8c) * 0.01 + 0.3;
          effect_spawn(0,&(&creature_pool)[creature_id].pos_x);
          iVar2 = iVar2 + -1;
        } while (iVar2 != 0);
      }
    }
  }
  if (0.0 < (&creature_pool)[creature_id].health) {
    return 0;
  }
  return 1;
}



/* projectile_update @ 00420b90 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* updates projectile movement, collisions, and hit effects */

void projectile_update(void)

{
  float fVar1;
  char cVar2;
  float fVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  float fVar8;
  int iVar9;
  float *pfVar10;
  float *pfVar11;
  float10 fVar12;
  float10 fVar13;
  float10 fVar14;
  float10 fVar15;
  float10 fVar16;
  float10 fVar17;
  float10 fVar18;
  longlong lVar19;
  float fVar20;
  int local_ec;
  int local_e8;
  int local_e4;
  float local_dc;
  int local_d8;
  float local_cc;
  float local_c8;
  float local_c4;
  float local_c0;
  float local_bc;
  float local_b8;
  float local_b4;
  float local_b0;
  float local_ac;
  float local_a8;
  float local_a4;
  float local_a0;
  float local_9c;
  float local_98;
  float local_94;
  float local_90;
  float local_8c;
  float local_88;
  float local_84;
  float local_80;
  float local_7c;
  float local_78;
  float local_74;
  float local_70;
  float local_6c;
  float local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  float local_58;
  float fStack_50;
  float local_4c;
  float local_48;
  float local_44;
  float fStack_40;
  float local_3c;
  float fStack_38;
  float local_34;
  float fStack_30;
  float local_2c;
  float local_28;
  float local_20;
  float local_1c;
  float fStack_18;
  float local_14;
  float local_10 [4];
  
  DAT_004aaf54 = DAT_004aaf54 + 1;
  local_c0 = 1.0;
  iVar4 = perk_count_get(perk_id_ion_gun_master);
  if (iVar4 != 0) {
    local_c0 = 1.2;
  }
  local_e8 = 0;
  do {
    if ((&projectile_pool)[local_e8].active != '\0') {
      if ((&projectile_pool)[local_e8].life_timer <= 0.0) {
        (&projectile_pool)[local_e8].active = '\0';
      }
      if (0.4 <= (&projectile_pool)[local_e8].life_timer) {
        pfVar10 = &(&projectile_pool)[local_e8].pos_x;
        if (((((&projectile_pool)[local_e8].pos_x < -64.0) ||
             ((&projectile_pool)[local_e8].pos_y < -64.0)) ||
            ((float)(terrain_texture_width + 0x40) < *pfVar10)) ||
           ((float)(terrain_texture_height + 0x40) < (&projectile_pool)[local_e8].pos_y)) {
LAB_004219ef:
          fVar8 = (&projectile_pool)[local_e8].life_timer - frame_dt;
LAB_004219f8:
          (&projectile_pool)[local_e8].life_timer = fVar8;
        }
        else {
          lVar19 = __ftol();
          local_dc = (float)lVar19;
          fVar17 = (float10)(&projectile_pool)[local_e8].angle - (float10)1.5707964;
          fVar12 = (float10)fcos(fVar17);
          fVar18 = (float10)frame_dt;
          fVar13 = (float10)fsin(fVar17);
          fVar17 = (float10)frame_dt;
          iVar4 = perk_count_get(perk_id_barrel_greaser);
          if ((iVar4 != 0) && ((&projectile_pool)[local_e8].owner_id < 0)) {
            lVar19 = __ftol();
            local_dc = (float)lVar19;
          }
          local_c8 = 0.0;
          local_cc = 0.0;
          local_c4 = 0.0;
          if (0 < (int)local_dc) {
            do {
              fVar8 = local_c4;
              local_cc = (float)(fVar12 * fVar18 * (float10)20.0) *
                         (&projectile_pool)[local_e8].speed_scale * 3.0 + local_cc;
              local_c8 = (float)(fVar13 * fVar17 * (float10)20.0) *
                         (&projectile_pool)[local_e8].speed_scale * 3.0 + local_c8;
              if ((4.0 <= SQRT(local_c8 * local_c8 + local_cc * local_cc)) ||
                 ((int)local_dc <= (int)local_c4 + 3)) {
                FUN_0041e270(pfVar10,&local_cc);
                iVar4 = creature_find_in_radius(pfVar10,(&projectile_pool)[local_e8].hit_radius,0);
                if ((iVar4 == -1) || (iVar4 == (&projectile_pool)[local_e8].owner_id)) {
                  if (local_e8 != shock_chain_projectile_id) {
                    if ((&projectile_pool)[local_e8].owner_id != -100) {
                      iVar4 = player_find_in_radius
                                        ((&projectile_pool)[local_e8].owner_id,pfVar10,
                                         (&projectile_pool)[local_e8].hit_radius);
                    }
                    if (iVar4 != -1) {
                      (&projectile_pool)[local_e8].life_timer = 0.25;
                      if (*(float *)((&player_health)[iVar4]._pad0 + 0x2f4) <= 0.0) {
                        *(float *)(&player_health)[iVar4]._pad0 =
                             *(float *)(&player_health)[iVar4]._pad0 - 10.0;
                      }
                    }
                  }
                }
                else {
                  iVar9 = perk_count_get(perk_id_poison_bullets);
                  if ((iVar9 != 0) && (iVar9 = crt_rand(), ((byte)iVar9 & 7) == 1)) {
                    (&creature_pool)[iVar4].flags = (&creature_pool)[iVar4].flags | 1;
                  }
                  if ((&projectile_pool)[local_e8].type_id == 0x19) {
                    iVar9 = 8;
                    do {
                      fVar8 = 0.0;
                      uVar7 = crt_rand();
                      effect_spawn_blood_splatter(pfVar10,(float)(uVar7 & 0xff) * 0.024543693,fVar8)
                      ;
                      iVar9 = iVar9 + -1;
                    } while (iVar9 != 0);
                  }
                  else if ((&projectile_pool)[local_e8].type_id == 0x1d) {
                    FUN_0042f3f0(pfVar10,26.0,4.2039e-45);
                    projectile_spawn(pfVar10,(&projectile_pool)[local_e8].angle - 1.0471976,0x1d,
                                     iVar4);
                    projectile_spawn(pfVar10,(&projectile_pool)[local_e8].angle + 1.0471976,0x1d,
                                     iVar4);
                  }
                  local_64 = 0x3f800000;
                  local_68 = 1.0;
                  _effect_template_color_g = 0x3f800000;
                  local_60 = 0x3f800000;
                  local_5c = 0x3f800000;
                  _effect_template_color_r = 0x3f800000;
                  _effect_template_flags = 0x59;
                  _effect_template_color_b = 0x3f800000;
                  _effect_template_color_a = 0x3f800000;
                  _effect_template_lifetime = 0x3eb33333;
                  _effect_template_age = 0;
                  _effect_template_half_width = 0x40800000;
                  _effect_template_half_height = 0x40800000;
                  if (config_blob.fx_toggle == '\0') {
                    iVar9 = perk_count_get(perk_id_bloody_mess_quick_learner);
                    if (iVar9 == 0) {
                      if (_bonus_freeze_timer <= 0.0) {
                        iVar9 = 2;
                        do {
                          effect_spawn_blood_splatter
                                    (pfVar10,(&projectile_pool)[local_e8].angle - 1.5707964,0.0);
                          iVar6 = crt_rand();
                          if (((byte)iVar6 & 7) == 2) {
                            effect_spawn_blood_splatter
                                      (pfVar10,((&projectile_pool)[local_e8].angle - 1.5707964) +
                                               3.1415927,0.0);
                          }
                          iVar9 = iVar9 + -1;
                        } while (iVar9 != 0);
                      }
                    }
                    else {
                      iVar9 = 8;
                      do {
                        fVar8 = 0.0;
                        uVar7 = crt_rand();
                        effect_spawn_blood_splatter
                                  (pfVar10,((&projectile_pool)[local_e8].angle - 1.5707964) +
                                           (float)(int)((uVar7 & 0x1f) - 0x10) * 0.0625,fVar8);
                        iVar9 = iVar9 + -1;
                      } while (iVar9 != 0);
                      effect_spawn_blood_splatter
                                (pfVar10,((&projectile_pool)[local_e8].angle - 1.5707964) +
                                         3.1415927,0.0);
                    }
                  }
                  if ((&creature_pool)[iVar4].hitbox_size == 16.0) {
                    highscore_active_record.shots_hit = highscore_active_record.shots_hit + 1;
                  }
                  iVar9 = perk_count_get(perk_id_bloody_mess_quick_learner);
                  if (iVar9 != 0) {
                    local_d8 = 0x1e;
                    iVar9 = -0x1e;
                    do {
                      iVar6 = local_d8 - iVar9;
                      iVar5 = crt_rand();
                      local_58 = (float)(iVar5 % iVar6 + iVar9);
                      iVar5 = crt_rand();
                      local_20 = local_58 + (&creature_pool)[iVar4].pos_x;
                      local_1c = (float)(iVar5 % iVar6 + iVar9) + (&creature_pool)[iVar4].pos_y;
                      fx_queue_add_random(&local_20);
                      iVar5 = crt_rand();
                      local_28 = (float)(iVar5 % iVar6 + iVar9);
                      iVar5 = crt_rand();
                      local_48 = local_28 + (&creature_pool)[iVar4].pos_x;
                      local_44 = (float)(iVar5 % iVar6 + iVar9) + (&creature_pool)[iVar4].pos_y;
                      fx_queue_add_random(&local_48);
                      iVar9 = iVar9 + -10;
                      local_d8 = local_d8 + 10;
                    } while (-0x3c < iVar9);
                  }
                  iVar9 = (&projectile_pool)[local_e8].type_id;
                  if (((iVar9 != 0x2d) && (iVar9 != 6)) && (iVar9 != 0x19)) {
                    (&projectile_pool)[local_e8].life_timer = 0.25;
                    uVar7 = crt_rand();
                    fVar14 = (float10)(&projectile_pool)[local_e8].angle - (float10)1.5707964;
                    fVar15 = (float10)fcos(fVar14);
                    *pfVar10 = (float)(fVar15 * (float10)(uVar7 & 3) + (float10)*pfVar10);
                    fVar14 = (float10)fsin(fVar14);
                    (&projectile_pool)[local_e8].pos_y =
                         (float)(fVar14 * (float10)(uVar7 & 3) +
                                (float10)(&projectile_pool)[local_e8].pos_y);
                  }
                  fVar8 = (&projectile_pool)[local_e8].origin_x - *pfVar10;
                  fVar20 = (&projectile_pool)[local_e8].origin_y -
                           (&projectile_pool)[local_e8].pos_y;
                  fVar8 = SQRT(fVar8 * fVar8 + fVar20 * fVar20);
                  if (fVar8 < 50.0) {
                    fVar8 = 50.0;
                  }
                  iVar9 = (&projectile_pool)[local_e8].type_id;
                  fVar20 = (&weapon_table)[iVar9].damage_scale;
                  if (iVar9 == 0x16) {
                    FUN_0042f270(pfVar10,1.5,0.1);
                    FUN_0042f540((int)pfVar10,0.8);
                  }
                  else if (iVar9 == 0x15) {
                    if ((0 < shock_chain_links_left) && (local_e8 == shock_chain_projectile_id)) {
                      shock_chain_links_left = shock_chain_links_left + -1;
                      iVar9 = creature_find_nearest(pfVar10,iVar4,100.0);
                      bonus_spawn_guard = 1;
                      fVar14 = (float10)fpatan((float10)(&creature_pool)[iVar9].pos_y -
                                               (float10)(&creature_pool)[iVar4].pos_y,
                                               (float10)(&creature_pool)[iVar9].pos_x -
                                               (float10)(&creature_pool)[iVar4].pos_x);
                      shock_chain_projectile_id =
                           projectile_spawn(pfVar10,(float)((fVar14 - (float10)1.5707964) -
                                                           (float10)3.1415927),0x15,iVar4);
                      bonus_spawn_guard = 0;
                    }
                    FUN_0042f270(pfVar10,1.2,0.4);
                    FUN_0042f540((int)pfVar10,1.2);
                  }
                  else if (iVar9 == 0x17) {
                    FUN_0042f270(pfVar10,1.0,1.0);
                    FUN_0042f540((int)pfVar10,2.2);
                    sfx_play_panned(sfx_shockwave);
                  }
                  else if (iVar9 == 0x1c) {
                    bonus_spawn_guard = 1;
                    local_e4 = 0;
                    fVar3 = (&creature_pool)[iVar4].size * 0.5 + 1.0;
                    do {
                      fVar1 = (float)((float10)local_e4 * (float10)0.5235988);
                      fVar14 = (float10)fcos((float10)local_e4 * (float10)0.5235988);
                      fVar15 = (float10)fsin((float10)fVar1);
                      local_34 = (float)(fVar15 * (float10)fVar3);
                      local_88 = (float)(fVar14 * (float10)fVar3 + (float10)*pfVar10);
                      local_84 = local_34 + (&projectile_pool)[local_e8].pos_y;
                      projectile_spawn(&local_88,fVar1,9,-100);
                      local_e4 = local_e4 + 1;
                    } while (local_e4 < 0xc);
                    bonus_spawn_guard = 0;
                    sfx_play_panned(sfx_explosion_medium);
                    sfx_play_panned(sfx_shockwave);
                    FUN_0042f330(pfVar10,1.5,0x3f800000);
                    FUN_0042f330(pfVar10,1.0,0x3f800000);
                  }
                  else if (iVar9 == 0x18) {
                    FUN_0042f080(pfVar10);
                    fVar3 = (&creature_pool)[iVar4].size * 0.65;
                    (&projectile_pool)[local_e8].life_timer = 0.25;
                    (&creature_pool)[iVar4].size = fVar3;
                    if (fVar3 < 16.0) {
                      creature_handle_death(iVar4,true);
                    }
                  }
                  else if (iVar9 == 0x13) {
                    local_14 = local_c8 * 3.0;
                    (&creature_pool)[iVar4].pos_x = local_cc * 3.0 + (&creature_pool)[iVar4].pos_x;
                    (&creature_pool)[iVar4].pos_y = local_14 + (&creature_pool)[iVar4].pos_y;
                  }
                  else if (iVar9 == 0x29) {
                    (&creature_pool)[iVar4].collision_flag = '\x01';
                  }
                  fVar8 = ((100.0 / fVar8) * fVar20 * 30.0 + 10.0) * 0.95;
                  if ((0.0 < fVar8) && (0.0 < (&creature_pool)[iVar4].health)) {
                    fVar20 = (&projectile_pool)[local_e8].damage_pool - 1.0;
                    (&projectile_pool)[local_e8].damage_pool = fVar20;
                    fVar14 = (float10)fcos((float10)(&projectile_pool)[local_e8].angle -
                                           (float10)1.5707964);
                    fVar15 = fVar14 * (float10)(&projectile_pool)[local_e8].speed_scale;
                    if (fVar20 <= 0.0) {
                      local_98 = (float)fVar15;
                      local_94 = (float)(fVar14 * (float10)(&projectile_pool)[local_e8].speed_scale)
                      ;
                      creature_apply_damage(iVar4,fVar8,1,&local_98);
                      if ((&projectile_pool)[local_e8].life_timer != 0.25) {
                        (&projectile_pool)[local_e8].life_timer = 0.25;
                      }
                    }
                    else {
                      local_78 = (float)fVar15;
                      local_74 = (float)(fVar14 * (float10)(&projectile_pool)[local_e8].speed_scale)
                      ;
                      creature_apply_damage(iVar4,fVar20,1,&local_78);
                      (&projectile_pool)[local_e8].damage_pool =
                           (&projectile_pool)[local_e8].damage_pool - (&creature_pool)[iVar4].health
                      ;
                    }
                  }
                  if (((&projectile_pool)[local_e8].damage_pool == 1.0) &&
                     (fVar8 = (&projectile_pool)[local_e8].life_timer,
                     (&projectile_pool)[local_e8].damage_pool = 0.0, fVar8 != 0.25)) {
                    (&projectile_pool)[local_e8].life_timer = 0.25;
                  }
                  (&creature_pool)[iVar4].state_flag = '\x01';
                  crt_rand();
                  if (((&projectile_pool)[local_e8].type_id == 6) ||
                     ((&projectile_pool)[local_e8].type_id == 0x2d)) {
                    perk_count_get(perk_id_bloody_mess_quick_learner);
                    local_ec = 6;
                    do {
                      iVar9 = crt_rand();
                      fVar14 = (float10)(iVar9 % 100) * (float10)0.1;
                      if ((float10)4.0 < fVar14) {
                        iVar9 = crt_rand();
                        fVar14 = (float10)(iVar9 % 0x5a + 10) * (float10)0.1;
                      }
                      if ((float10)7.0 < fVar14) {
                        iVar9 = crt_rand();
                        fVar14 = (float10)(iVar9 % 0x50 + 0x14) * (float10)0.1;
                      }
                      fVar15 = (float10)(&projectile_pool)[local_e8].angle - (float10)1.5707964;
                      fVar16 = (float10)fcos(fVar15);
                      local_a8 = 0.0;
                      local_a4 = 0.0;
                      fVar8 = (float)(fVar16 * fVar14 * (float10)20.0);
                      fVar15 = (float10)fsin(fVar15);
                      fVar20 = (float)(fVar15 * fVar14 * (float10)20.0);
                      local_b0 = fVar8 + (&creature_pool)[iVar4].pos_x;
                      local_ac = fVar20 + (&creature_pool)[iVar4].pos_y;
                      vec2_add_inplace(iVar4,&local_b0,&local_a8);
                      crt_rand();
                      if (0.0 < _bonus_freeze_timer) {
                        local_a0 = fVar8 + *pfVar10;
                        local_9c = fVar20 + (&projectile_pool)[local_e8].pos_y;
                        iVar9 = crt_rand();
                        effect_spawn_freeze_shard
                                  (&local_a0,
                                   ((&projectile_pool)[local_e8].angle - 1.5707964) +
                                   (float)(iVar9 % 100) * 0.01);
                      }
                      local_b8 = fVar8 + (&creature_pool)[iVar4].pos_x;
                      local_b4 = fVar20 + (&creature_pool)[iVar4].pos_y;
                      fx_queue_add_random(&local_b8);
                      local_ec = local_ec + -1;
                    } while (local_ec != 0);
                  }
                  else if (_bonus_freeze_timer <= 0.0) {
                    pfVar11 = &(&creature_pool)[iVar4].pos_x;
                    iVar9 = 3;
                    do {
                      iVar6 = crt_rand();
                      fVar15 = ((float10)(&projectile_pool)[local_e8].angle - (float10)1.5707964) +
                               (float10)(iVar6 % 0x14 + -10) * (float10)0.1;
                      fVar14 = (float10)fcos(fVar15);
                      fVar8 = (float)(fVar14 * (float10)20.0);
                      fVar14 = (float10)fsin(fVar15);
                      fVar20 = (float)(fVar14 * (float10)20.0);
                      fx_queue_add_random(pfVar11);
                      local_4c = fVar20 * 1.5;
                      local_70 = fVar8 * 1.5 + *pfVar11;
                      local_6c = local_4c + (&creature_pool)[iVar4].pos_y;
                      fx_queue_add_random(&local_70);
                      local_3c = fVar20 + fVar20;
                      local_80 = fVar8 + fVar8 + *pfVar11;
                      local_7c = local_3c + (&creature_pool)[iVar4].pos_y;
                      fx_queue_add_random(&local_80);
                      local_2c = fVar20 * 2.5;
                      local_90 = fVar8 * 2.5 + *pfVar11;
                      local_8c = local_2c + (&creature_pool)[iVar4].pos_y;
                      fx_queue_add_random(&local_90);
                      iVar9 = iVar9 + -1;
                    } while (iVar9 != 0);
                  }
                  else {
                    iVar4 = crt_rand();
                    effect_spawn_freeze_shard
                              (pfVar10,((&projectile_pool)[local_e8].angle - 1.5707964) +
                                       (float)(iVar4 % 100) * 0.01);
                  }
                  if (((demo_mode_active == '\0') && (DAT_004cc8d4 == '\0')) &&
                     (config_blob.reserved0._24_4_ != 2)) {
                    sfx_play_exclusive(music_track_extra_0);
                  }
                  else {
                    fVar8 = sfx_shock_hit_01;
                    if ((&weapon_ammo_class)[(&projectile_pool)[local_e8].type_id * 0x1f] != 4) {
                      iVar4 = crt_rand();
                      fVar8 = (float)(iVar4 % 6 + sfx_bullet_hit_01);
                    }
                    sfx_play_panned(fVar8);
                  }
                  fVar8 = local_c4;
                  if ((&projectile_pool)[local_e8].damage_pool <= 0.0) break;
                }
                local_c8 = 0.0;
                local_cc = 0.0;
              }
              local_c4 = (float)((int)fVar8 + 3);
            } while ((int)local_c4 < (int)local_dc);
          }
        }
      }
      else {
        iVar4 = (&projectile_pool)[local_e8].type_id;
        if ((iVar4 == 0x15) || (iVar4 == 0x16)) {
          if (local_e8 == shock_chain_projectile_id) {
            shock_chain_projectile_id = -1;
            shock_chain_links_left = 0;
          }
          (&projectile_pool)[local_e8].life_timer =
               (&projectile_pool)[local_e8].life_timer - frame_dt;
          if (iVar4 == 0x15) {
            fVar20 = frame_dt * 100.0;
            fVar8 = local_c0 * 88.0;
          }
          else {
            fVar20 = frame_dt * 40.0;
            fVar8 = local_c0 * 60.0;
          }
        }
        else {
          if (iVar4 != 0x17) {
            if (iVar4 != 6) goto LAB_004219ef;
            fVar8 = (&projectile_pool)[local_e8].life_timer - frame_dt * 0.1;
            goto LAB_004219f8;
          }
          (&projectile_pool)[local_e8].life_timer =
               (&projectile_pool)[local_e8].life_timer - frame_dt * 0.7;
          fVar20 = frame_dt * 300.0;
          fVar8 = local_c0 * 128.0;
        }
        creatures_apply_radius_damage(&(&projectile_pool)[local_e8].pos_x,fVar8,fVar20,7);
      }
    }
    local_e8 = local_e8 + 1;
  } while (local_e8 < 0x60);
  pfVar10 = &secondary_projectile_pool.vel_y;
  do {
    if (((secondary_projectile_t *)(pfVar10 + -6))->active != '\0') {
      if (pfVar10[1] == 4.2039e-45) {
        camera_shake_pulses = 4;
        fVar8 = frame_dt * 3.0 + pfVar10[-1];
        pfVar10[-1] = fVar8;
        if (1.0 < fVar8) {
          local_10[0] = 0.0;
          local_10[1] = 0.0;
          local_10[2] = 0.0;
          local_10[3] = 0.25;
          fx_queue_add(0x10,pfVar10 + -3,*pfVar10 * 256.0,*pfVar10 * 256.0,0.0,local_10);
          ((secondary_projectile_t *)(pfVar10 + -6))->active = '\0';
        }
        fVar8 = *pfVar10;
        fVar20 = pfVar10[-1];
        iVar4 = 0;
        pfVar11 = &creature_pool.pos_y;
        do {
          if ((((creature_t *)(pfVar11 + -6))->active != '\0') && (0.0 < pfVar11[3])) {
            fVar3 = pfVar11[-1] - pfVar10[-3];
            fVar1 = *pfVar11 - pfVar10[-2];
            if (SQRT(fVar3 * fVar3 + fVar1 * fVar1) < fVar8 * fVar20 * 80.0) {
              local_c0 = fVar3;
              local_bc = fVar1;
              thunk_FUN_00452f1d();
              local_c0 = local_c8 * 0.1;
              local_bc = local_c4 * 0.1;
              creature_apply_damage(iVar4,frame_dt * *pfVar10 * 700.0,3,&local_c0);
              if (pfVar11[3] <= 0.0) {
                fx_queue_add_random(pfVar11 + -1);
                fx_queue_add_random(pfVar11 + -1);
                creature_handle_death(iVar4,true);
              }
            }
          }
          pfVar11 = pfVar11 + 0x26;
          iVar4 = iVar4 + 1;
        } while ((int)pfVar11 < 0x4aa350);
      }
      else {
        local_a0 = frame_dt * pfVar10[-1];
        pfVar11 = pfVar10 + -3;
        local_9c = frame_dt * *pfVar10;
        FUN_0041e270(pfVar11,&local_a0);
        fVar8 = pfVar10[1];
        if (fVar8 == 1.4013e-45) {
          if (SQRT(pfVar10[-1] * pfVar10[-1] + *pfVar10 * *pfVar10) < 500.0) {
            fVar8 = 3.0;
LAB_00421c48:
            fVar8 = frame_dt * fVar8 + 1.0;
            pfVar10[-1] = fVar8 * pfVar10[-1];
            *pfVar10 = fVar8 * *pfVar10;
          }
LAB_00421c5a:
          fVar8 = pfVar10[-4] - frame_dt;
LAB_00421d65:
          pfVar10[-4] = fVar8;
        }
        else {
          if (fVar8 == 5.60519e-45) {
            if (SQRT(pfVar10[-1] * pfVar10[-1] + *pfVar10 * *pfVar10) < 600.0) {
              fVar8 = 4.0;
              goto LAB_00421c48;
            }
            goto LAB_00421c5a;
          }
          if (fVar8 == 2.8026e-45) {
            if ((&creature_pool)[(int)pfVar10[3]].active == '\0') {
              fVar8 = (float)creature_find_nearest(pfVar11,-1,0.0);
              pfVar10[3] = fVar8;
            }
            fVar18 = (float10)fpatan((float10)pfVar10[-2] -
                                     (float10)(&creature_pool)[(int)pfVar10[3]].pos_y,
                                     (float10)*pfVar11 -
                                     (float10)(&creature_pool)[(int)pfVar10[3]].pos_x);
            pfVar10[-5] = (float)(fVar18 - (float10)1.5707964);
            fVar18 = (float10)fcos((fVar18 - (float10)1.5707964) - (float10)1.5707964);
            pfVar10[-1] = (float)(fVar18 * (float10)frame_dt * (float10)800.0 + (float10)pfVar10[-1]
                                 );
            fVar18 = (float10)fsin((float10)pfVar10[-5] - (float10)1.5707964);
            *pfVar10 = (float)(fVar18 * (float10)frame_dt * (float10)800.0 + (float10)*pfVar10);
            if (350.0 < SQRT(pfVar10[-1] * pfVar10[-1] + *pfVar10 * *pfVar10)) {
              fVar18 = (float10)fcos((float10)pfVar10[-5] - (float10)1.5707964);
              pfVar10[-1] = (float)((float10)pfVar10[-1] -
                                   fVar18 * (float10)frame_dt * (float10)800.0);
              fVar18 = (float10)fsin((float10)pfVar10[-5] - (float10)1.5707964);
              *pfVar10 = (float)((float10)*pfVar10 - fVar18 * (float10)frame_dt * (float10)800.0);
            }
            fVar8 = pfVar10[-4] - frame_dt * 0.5;
            goto LAB_00421d65;
          }
        }
        local_c4 = *pfVar10;
        fVar8 = pfVar10[2] - (ABS(local_c4) + ABS(pfVar10[-1])) * frame_dt * 0.01;
        pfVar10[2] = fVar8;
        if (fVar8 < 0.0) {
          fVar18 = (float10)fcos((float10)pfVar10[-5] + (float10)1.5707964);
          fStack_30 = (float)fVar18;
          local_b0 = fStack_30 * 90.0;
          local_ac = (float)(fVar18 * (float10)90.0);
          fVar18 = (float10)fcos((float10)pfVar10[-5] - (float10)1.5707964);
          fStack_40 = (float)fVar18;
          fVar18 = (float10)fsin((float10)pfVar10[-5] - (float10)1.5707964);
          fStack_50 = fStack_40 * 9.0;
          local_a8 = *pfVar11 - fStack_50;
          local_a4 = (float)((float10)pfVar10[-2] - fVar18 * (float10)9.0);
          iVar4 = fx_spawn_sprite(&local_a8,&local_b0,14.0);
          pfVar10[2] = 0.06;
          (&sprite_effect_pool)[iVar4].color_a = 0.25;
        }
        iVar4 = creature_find_in_radius(pfVar11,8.0,0);
        if (iVar4 != -1) {
          if ((&creature_pool)[iVar4].hitbox_size == 16.0) {
            highscore_active_record.shots_hit = highscore_active_record.shots_hit + 1;
          }
          if (_bonus_freeze_timer <= 0.0) {
            iVar9 = crt_rand();
            fStack_18 = (float)(iVar9 % 0x14 + -10);
            iVar9 = crt_rand();
            local_90 = fStack_18 + (&creature_pool)[iVar4].pos_x;
            local_8c = (float)(iVar9 % 0x14 + -10) + (&creature_pool)[iVar4].pos_y;
            fx_queue_add_random(&local_90);
            iVar9 = crt_rand();
            fStack_38 = (float)(iVar9 % 0x14 + -10);
            iVar9 = crt_rand();
            local_80 = fStack_38 + (&creature_pool)[iVar4].pos_x;
            local_7c = (float)(iVar9 % 0x14 + -10) + (&creature_pool)[iVar4].pos_y;
            fx_queue_add_random(&local_80);
            iVar9 = crt_rand();
            local_28 = (float)(iVar9 % 0x14 + -10);
            iVar9 = crt_rand();
            local_70 = local_28 + (&creature_pool)[iVar4].pos_x;
            local_6c = (float)(iVar9 % 0x14 + -10) + (&creature_pool)[iVar4].pos_y;
            fx_queue_add_random(&local_70);
          }
          else {
            local_ec = 4;
            do {
              iVar9 = crt_rand();
              effect_spawn_freeze_shard(pfVar11,(float)(iVar9 % 0x264) * 0.01);
              local_ec = local_ec + -1;
            } while (local_ec != 0);
          }
          fVar8 = pfVar10[1];
          local_dc = 150.0;
          if (fVar8 == 1.4013e-45) {
            local_dc = pfVar10[-4] * 50.0 + 500.0;
            if (2 < config_blob.detail_preset) {
              effect_spawn_explosion_burst(pfVar11,0.4);
            }
          }
          else if (fVar8 == 2.8026e-45) {
            local_dc = pfVar10[-4] * 20.0 + 80.0;
          }
          else if (fVar8 == 5.60519e-45) {
            local_dc = pfVar10[-4] * 20.0 + 40.0;
          }
          if (((demo_mode_active == '\0') && (DAT_004cc8d4 == '\0')) &&
             (config_blob.reserved0._24_4_ != 2)) {
            sfx_play_exclusive(music_track_extra_0);
          }
          else {
            sfx_play_panned(sfx_explosion_medium);
          }
          local_94 = 1.0 / frame_dt;
          (&creature_pool)[iVar4].state_flag = '\x01';
          local_98 = local_94 * pfVar10[-1];
          local_94 = local_94 * *pfVar10;
          creature_apply_damage(iVar4,local_dc,3,&local_98);
          fVar20 = _bonus_freeze_timer;
          fVar8 = pfVar10[1];
          if (fVar8 == 1.4013e-45) {
            pfVar10[1] = 4.2039e-45;
            pfVar10[-1] = 0.0;
            *pfVar10 = 1.0;
            if (fVar20 <= 0.0) {
              iVar9 = 0x14;
              do {
                iVar6 = crt_rand();
                fVar8 = (float)(iVar6 % 0x274) * 0.01;
                iVar6 = crt_rand();
                fVar18 = (float10)fcos((float10)fVar8);
                local_58 = (float)(fVar18 * (float10)(iVar6 % 0x5a));
                fVar18 = (float10)fsin((float10)fVar8);
                local_78 = local_58 + (&creature_pool)[iVar4].pos_x;
                local_74 = (float)(fVar18 * (float10)(iVar6 % 0x5a) +
                                  (float10)(&creature_pool)[iVar4].pos_y);
                fx_queue_add_random(&local_78);
                iVar9 = iVar9 + -1;
              } while (iVar9 != 0);
            }
            else {
              iVar4 = 8;
              do {
                iVar9 = crt_rand();
                effect_spawn_freeze_shard(pfVar11,(float)(iVar9 % 0x264) * 0.01);
                iVar4 = iVar4 + -1;
              } while (iVar4 != 0);
            }
          }
          else if (fVar8 == 2.8026e-45) {
            pfVar10[1] = 4.2039e-45;
            pfVar10[-1] = 0.0;
            *pfVar10 = 0.35;
            if (fVar20 <= 0.0) {
              iVar9 = 10;
              do {
                iVar6 = crt_rand();
                fVar8 = (float)(iVar6 % 0x274) * 0.01;
                uVar7 = crt_rand();
                uVar7 = uVar7 & 0x8000003f;
                if ((int)uVar7 < 0) {
                  uVar7 = (uVar7 - 1 | 0xffffffc0) + 1;
                }
                fVar18 = (float10)fcos((float10)fVar8);
                fVar17 = (float10)fsin((float10)fVar8);
                local_88 = (float)(fVar18 * (float10)(int)uVar7) + (&creature_pool)[iVar4].pos_x;
                local_84 = (float)(fVar17 * (float10)(int)uVar7 +
                                  (float10)(&creature_pool)[iVar4].pos_y);
                fx_queue_add_random(&local_88);
                iVar9 = iVar9 + -1;
              } while (iVar9 != 0);
            }
            else {
              iVar4 = 8;
              do {
                iVar9 = crt_rand();
                effect_spawn_freeze_shard(pfVar11,(float)(iVar9 % 0x264) * 0.01);
                iVar4 = iVar4 + -1;
              } while (iVar4 != 0);
            }
          }
          else if (fVar8 == 5.60519e-45) {
            pfVar10[1] = 4.2039e-45;
            pfVar10[-1] = 0.0;
            *pfVar10 = 0.25;
            if (fVar20 <= 0.0) {
              iVar9 = 3;
              do {
                iVar6 = crt_rand();
                fVar8 = (float)(iVar6 % 0x274) * 0.01;
                iVar6 = crt_rand();
                fVar18 = (float10)fcos((float10)fVar8);
                fVar17 = (float10)fsin((float10)fVar8);
                local_48 = (float)(fVar18 * (float10)(iVar6 % 0x2c)) + (&creature_pool)[iVar4].pos_x
                ;
                local_44 = (float)(fVar17 * (float10)(iVar6 % 0x2c) +
                                  (float10)(&creature_pool)[iVar4].pos_y);
                fx_queue_add_random(&local_48);
                iVar9 = iVar9 + -1;
              } while (iVar9 != 0);
            }
            else {
              iVar9 = 8;
              do {
                iVar6 = crt_rand();
                effect_spawn_freeze_shard
                          (&(&creature_pool)[iVar4].pos_x,(float)(iVar6 % 0x264) * 0.01);
                iVar9 = iVar9 + -1;
              } while (iVar9 != 0);
            }
          }
          local_ec = 0;
          do {
            iVar4 = crt_rand();
            fVar18 = (float10)(iVar4 % 800) * (float10)0.1;
            fVar17 = (float10)fcos((float10)local_ec * (float10)0.62831855);
            local_68 = (float)fVar17;
            fVar17 = (float10)fsin((float10)local_ec * (float10)0.62831855);
            local_20 = (float)(fVar18 * (float10)local_68);
            local_1c = (float)(fVar17 * fVar18);
            iVar4 = fx_spawn_sprite(pfVar11,&local_20,14.0);
            local_ec = local_ec + 1;
            (&sprite_effect_pool)[iVar4].color_a = 0.37;
          } while (local_ec < 10);
        }
        if (pfVar10[-4] <= 0.0) {
          pfVar10[1] = 4.2039e-45;
          pfVar10[-1] = 0.0;
          *pfVar10 = 0.5;
        }
      }
    }
    pfVar10 = pfVar10 + 0xb;
  } while ((int)pfVar10 < 0x4965f0);
  pfVar10 = &sprite_effect_pool.pos_y;
  do {
    if ((char)((sprite_effect_t *)(pfVar10 + -7))->active != '\0') {
      local_68 = frame_dt * pfVar10[1];
      fVar8 = frame_dt * pfVar10[2];
      pfVar10[-1] = local_68 + pfVar10[-1];
      *pfVar10 = fVar8 + *pfVar10;
      pfVar10[-2] = frame_dt * 3.0 + pfVar10[-2];
      fVar8 = pfVar10[-3] - frame_dt;
      pfVar10[-3] = fVar8;
      if (fVar8 <= 0.0) {
        *(undefined1 *)&((sprite_effect_t *)(pfVar10 + -7))->active = 0;
      }
      pfVar10[3] = frame_dt * 60.0 + pfVar10[3];
    }
    pfVar10 = pfVar10 + 0xb;
  } while ((int)pfVar10 < 0x49aa3c);
  local_e8 = 0;
  pfVar10 = &particle_pool.vel_y;
  do {
    if (((particle_t *)(pfVar10 + -4))->active != '\0') {
      if (SUB41(pfVar10[8],0) == '\b') {
        pfVar10[5] = pfVar10[5] - frame_dt * 0.11;
        pfVar10[7] = frame_dt * 5.0 + pfVar10[7];
        if (*(uchar *)((int)pfVar10 + -0xf) != '\0') {
          fVar8 = frame_dt * pfVar10[-1];
          if (pfVar10[5] <= 0.15) {
            fStack_40 = fVar8 * 0.55;
            fVar20 = fStack_40 * pfVar10[5];
            fVar3 = frame_dt * *pfVar10 * 0.55 * pfVar10[5];
            fStack_50 = fVar20;
            fStack_30 = fVar8;
            goto LAB_004226a3;
          }
          local_b8 = fVar8 * pfVar10[5];
          local_b4 = frame_dt * *pfVar10 * pfVar10[5];
          local_68 = fVar8;
          FUN_0041e270(pfVar10 + -3,&local_b8);
        }
      }
      else {
        pfVar10[5] = pfVar10[5] - frame_dt * 0.9;
        pfVar10[7] = frame_dt + pfVar10[7];
        fVar8 = frame_dt * pfVar10[-1];
        if (pfVar10[5] <= 0.15) {
          local_58 = fVar8 * 2.5;
          fVar20 = local_58 * 0.15;
          fVar3 = frame_dt * *pfVar10 * 2.5 * 0.15;
          local_90 = fVar20;
          local_28 = fVar8;
LAB_004226a3:
          pfVar10[-3] = fVar20 + pfVar10[-3];
          pfVar10[-2] = fVar3 + pfVar10[-2];
        }
        else {
          fStack_38 = fVar8 * 2.5;
          local_a0 = fStack_38 * pfVar10[5];
          local_9c = frame_dt * *pfVar10 * 2.5 * pfVar10[5];
          fStack_18 = fVar8;
          FUN_0041e270(pfVar10 + -3,&local_a0);
        }
      }
      cVar2 = SUB41(pfVar10[8],0);
      if (cVar2 == '\0') {
        if (0.0 < pfVar10[5]) {
LAB_00422767:
          if (*(uchar *)((int)pfVar10 + -0xf) == '\x01') {
            if (cVar2 == '\0') {
              iVar4 = crt_rand();
              fVar18 = (float10)(iVar4 % 100 + -0x32) * (float10)0.06 * (float10)pfVar10[5] *
                       (float10)frame_dt * (float10)1.96;
LAB_00422821:
              fVar8 = pfVar10[6];
              pfVar10[6] = (float)((float10)fVar8 - fVar18);
              fVar18 = (float10)fcos((float10)fVar8 - fVar18);
              pfVar10[-1] = (float)(fVar18 * (float10)82.0);
              fVar18 = (float10)fsin((float10)pfVar10[6]);
              fVar18 = fVar18 * (float10)82.0;
            }
            else {
              if (cVar2 != '\b') {
                iVar4 = crt_rand();
                fVar18 = (float10)(iVar4 % 100 + -0x32) * (float10)0.06 * (float10)pfVar10[5] *
                         (float10)frame_dt * (float10)1.1;
                goto LAB_00422821;
              }
              iVar4 = crt_rand();
              fVar18 = (float10)pfVar10[6] -
                       (float10)(iVar4 % 100 + -0x32) * (float10)0.06 * (float10)pfVar10[5] *
                       (float10)frame_dt * (float10)1.1;
              pfVar10[6] = (float)fVar18;
              fVar18 = (float10)fcos(fVar18);
              pfVar10[-1] = (float)(fVar18 * (float10)62.0);
              fVar18 = (float10)fsin((float10)pfVar10[6]);
              fVar18 = fVar18 * (float10)62.0;
            }
            *pfVar10 = (float)fVar18;
          }
          if (pfVar10[5] <= 1.0) {
            fVar8 = pfVar10[5];
          }
          else {
            fVar8 = 1.0;
          }
          pfVar10[4] = fVar8;
          fVar8 = 1.0 - pfVar10[5] * 0.95;
          pfVar10[1] = fVar8;
          pfVar10[2] = fVar8;
          if (*(uchar *)((int)pfVar10 + -0xf) != '\0') {
            pfVar11 = pfVar10 + -3;
            fVar8 = (float)creature_find_in_radius(pfVar11,pfVar10[5] * 8.0,0);
            if (fVar8 != -NAN) {
              *(uchar *)((int)pfVar10 + -0xf) = '\0';
              if (SUB41(pfVar10[8],0) == '\b') {
                fVar20 = (&creature_pool)[(int)fVar8].pos_y;
                *pfVar11 = (&creature_pool)[(int)fVar8].pos_x;
                pfVar10[-2] = fVar20;
                pfVar10[-1] = 0.0;
                *pfVar10 = 0.0;
                (&creature_pool)[(int)fVar8].state_flag = '\0';
                pfVar10[9] = fVar8;
              }
              else {
                fVar20 = pfVar10[6];
                while (6.2831855 < fVar20) {
                  fVar20 = pfVar10[6] - 6.2831855;
                  pfVar10[6] = fVar20;
                }
                fVar20 = pfVar10[6];
                while (fVar20 < 0.0) {
                  fVar20 = pfVar10[6] + 6.2831855;
                  pfVar10[6] = fVar20;
                }
                local_80 = (float)((float10)frame_dt * (float10)pfVar10[-1]);
                local_70 = *pfVar11 - local_80;
                pfVar11 = &(&creature_pool)[(int)fVar8].pos_x;
                local_98 = local_70 - *pfVar11;
                fVar18 = (float10)fpatan(((float10)pfVar10[-2] -
                                         (float10)frame_dt * (float10)*pfVar10) -
                                         (float10)(&creature_pool)[(int)fVar8].pos_y,
                                         (float10)local_98);
                if ((float10)6.2831855 < fVar18) {
                  do {
                    fVar18 = fVar18 - (float10)6.2831855;
                  } while ((float10)6.2831855 < fVar18);
                }
                if (fVar18 < (float10)0.0) {
                  do {
                    fVar18 = fVar18 + (float10)6.2831855;
                  } while (fVar18 < (float10)0.0);
                }
                if ((float10)pfVar10[6] <= fVar18) {
                  fVar20 = pfVar10[6] + 1.2566371;
                }
                else {
                  fVar20 = pfVar10[6] - 1.2566371;
                }
                pfVar10[6] = fVar20;
                fVar18 = (float10)fcos((float10)pfVar10[6]);
                pfVar10[-1] = (float)(fVar18 * (float10)82.0);
                fVar18 = (float10)fsin((float10)pfVar10[6]);
                *pfVar10 = (float)(fVar18 * (float10)82.0);
                iVar4 = crt_rand();
                (&creature_pool)[(int)fVar8].state_flag = '\x01';
                local_b0 = 0.0;
                local_ac = 0.0;
                fVar20 = (float)(iVar4 % 10) * 0.1;
                pfVar10[-1] = fVar20 * pfVar10[-1];
                *pfVar10 = fVar20 * *pfVar10;
                creature_apply_damage((int)fVar8,pfVar10[5] * 10.0,4,&local_b0);
                if (1.6 < (&creature_pool)[(int)fVar8].tint_g + (&creature_pool)[(int)fVar8].tint_b
                          + (&creature_pool)[(int)fVar8].tint_r) {
                  fVar20 = 1.0 - pfVar10[5] * 0.01;
                  (&creature_pool)[(int)fVar8].tint_r = fVar20 * (&creature_pool)[(int)fVar8].tint_r
                  ;
                  (&creature_pool)[(int)fVar8].tint_g = fVar20 * (&creature_pool)[(int)fVar8].tint_g
                  ;
                  (&creature_pool)[(int)fVar8].tint_b = fVar20 * (&creature_pool)[(int)fVar8].tint_b
                  ;
                  if (0.0 <= (&creature_pool)[(int)fVar8].tint_r) {
                    if (1.0 < (&creature_pool)[(int)fVar8].tint_r) {
                      (&creature_pool)[(int)fVar8].tint_r = 1.0;
                    }
                  }
                  else {
                    (&creature_pool)[(int)fVar8].tint_r = 0.0;
                  }
                  if (0.0 <= (&creature_pool)[(int)fVar8].tint_g) {
                    if (1.0 < (&creature_pool)[(int)fVar8].tint_g) {
                      (&creature_pool)[(int)fVar8].tint_g = 1.0;
                    }
                  }
                  else {
                    (&creature_pool)[(int)fVar8].tint_g = 0.0;
                  }
                  if (0.0 <= (&creature_pool)[(int)fVar8].tint_b) {
                    if (1.0 < (&creature_pool)[(int)fVar8].tint_b) {
                      (&creature_pool)[(int)fVar8].tint_b = 1.0;
                    }
                  }
                  else {
                    (&creature_pool)[(int)fVar8].tint_b = 0.0;
                  }
                  if (0.0 <= (&creature_pool)[(int)fVar8].tint_a) {
                    if (1.0 < (&creature_pool)[(int)fVar8].tint_a) {
                      (&creature_pool)[(int)fVar8].tint_a = 1.0;
                    }
                  }
                  else {
                    (&creature_pool)[(int)fVar8].tint_a = 0.0;
                  }
                }
                if (local_e8 % 3 == 0) {
                  iVar4 = crt_rand();
                  iVar9 = crt_rand();
                  local_a4 = (float)(iVar9 % 0x3c + -0x1e);
                  local_a8 = (float)(iVar4 % 0x3c + -0x1e);
                  iVar4 = fx_spawn_sprite(pfVar11,&local_a8,13.0);
                  (&sprite_effect_pool)[iVar4].color_a = 0.7;
                }
                fx_queue_add_random(pfVar11);
                local_74 = *pfVar10;
                local_84 = local_74 * frame_dt;
                *pfVar11 = pfVar10[-1] * frame_dt + *pfVar11;
                (&creature_pool)[(int)fVar8].pos_y = local_84 + (&creature_pool)[(int)fVar8].pos_y;
              }
            }
          }
        }
        else {
          ((particle_t *)(pfVar10 + -4))->active = '\0';
        }
      }
      else {
        if (0.8 < pfVar10[5]) goto LAB_00422767;
        ((particle_t *)(pfVar10 + -4))->active = '\0';
        if ((SUB41(pfVar10[8],0) == '\b') && (pfVar10[9] != -NAN)) {
          if ((&creature_pool)[(int)pfVar10[9]].active != '\0') {
            iVar4 = crt_rand();
            sfx_play_panned(*(float *)(&creature_type_sfx_a0 +
                                      (iVar4 % 3 + (&creature_pool)[(int)pfVar10[9]].type_id * 0x11)
                                      * 4));
          }
          creature_handle_death((int)pfVar10[9],false);
        }
      }
    }
    pfVar10 = pfVar10 + 0xe;
    local_e8 = local_e8 + 1;
    if (0x495ac7 < (int)pfVar10) {
      return;
    }
  } while( true );
}



/* projectile_render @ 00422c70 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders projectiles/secondary projectiles and related beam/trail effects */

void projectile_render(void)

{
  float *pos;
  projectile_t *self;
  IGrim2D_vtbl *pIVar1;
  projectile_t *x0;
  float unaff_EBX;
  projectile_t *x1;
  float *pfVar2;
  float unaff_EBP;
  float unaff_ESI;
  uchar *puVar3;
  float unaff_EDI;
  int iVar4;
  int iVar5;
  float10 fVar6;
  float10 fVar7;
  float10 fVar8;
  ulonglong uVar9;
  longlong lVar10;
  float in_stack_00000008;
  float in_stack_0000000c;
  float in_stack_00000010;
  float in_stack_00000014;
  float in_stack_00000020;
  float in_stack_00000024;
  float in_stack_00000028;
  float in_stack_00000030;
  float in_stack_00000034;
  float in_stack_00000038;
  float in_stack_00000040;
  uint uVar11;
  float fVar12;
  uint value;
  int in_stack_fffffe64;
  projectile_t *ppVar13;
  projectile_t *ppVar14;
  float in_stack_fffffe68;
  projectile_t *ppVar15;
  IGrim2D *in_stack_fffffe6c;
  projectile_t *ppVar16;
  float fVar17;
  float fVar18;
  projectile_t *ppVar19;
  IGrim2D *in_stack_fffffe74;
  IGrim2D *pIVar20;
  float fVar21;
  IGrim2D *pIVar22;
  projectile_t *in_stack_fffffe7c;
  projectile_t **pppVar23;
  IGrim2D *self_00;
  IGrim2D *pIVar24;
  projectile_t **pppVar25;
  projectile_t *in_stack_fffffe84;
  projectile_t *in_stack_fffffe88;
  projectile_t *in_stack_fffffe8c;
  projectile_t *in_stack_fffffe90;
  projectile_t *in_stack_fffffe94;
  projectile_t *in_stack_fffffe98;
  projectile_t *in_stack_fffffe9c;
  projectile_t *in_stack_fffffea0;
  projectile_t **h;
  projectile_t *ppStack_158;
  projectile_t *ppStack_154;
  projectile_t *ppStack_150;
  projectile_t *ppStack_14c;
  projectile_t *ppStack_144;
  projectile_t *ppStack_140;
  projectile_t *ppStack_13c;
  projectile_t *ppStack_138;
  float fStack_130;
  projectile_t *ppStack_12c;
  projectile_t *ppStack_128;
  projectile_t *ppStack_124;
  projectile_t *ppStack_120;
  IGrim2D *pIStack_11c;
  projectile_t *ppStack_118;
  projectile_t *ppStack_114;
  projectile_t *ppStack_110;
  projectile_t *ppStack_10c;
  projectile_t *ppStack_108;
  projectile_t *ppStack_104;
  projectile_t *ppStack_100;
  projectile_t *ppStack_fc;
  projectile_t *ppStack_f8;
  float fStack_f4;
  projectile_t *ppStack_ec;
  projectile_t *ppStack_e8;
  projectile_t *ppStack_e4;
  float fStack_e0;
  projectile_t *ppStack_dc;
  projectile_t *ppStack_d8;
  projectile_t *ppStack_d4;
  projectile_t *ppStack_d0;
  projectile_t *ppStack_cc;
  float fStack_c8;
  projectile_t *ppStack_c4;
  projectile_t *ppStack_c0;
  projectile_t *ppStack_bc;
  projectile_t *ppStack_b8;
  projectile_t *ppStack_b4;
  projectile_t *ppStack_b0;
  float fStack_ac;
  projectile_t *ppStack_a8;
  projectile_t *ppStack_a4;
  projectile_t *ppStack_a0;
  projectile_t *ppStack_9c;
  projectile_t *ppStack_98;
  projectile_t *ppStack_94;
  projectile_t *ppStack_90;
  float fStack_88;
  projectile_t *ppStack_84;
  float fStack_80;
  projectile_t *ppStack_7c;
  float fStack_78;
  float fStack_74;
  float fStack_6c;
  projectile_t *ppStack_68;
  projectile_t *ppStack_64;
  projectile_t *ppStack_5c;
  float fStack_58;
  projectile_t *ppStack_54;
  float fStack_50;
  projectile_t *ppStack_4c;
  float fStack_48;
  projectile_t *ppStack_44;
  projectile_t *ppStack_40;
  projectile_t *ppStack_3c;
  projectile_t *ppStack_34;
  float fStack_30;
  projectile_t *ppStack_2c;
  float fStack_28;
  float fStack_24;
  projectile_t *ppStack_20;
  float fStack_1c;
  float fStack_14;
  projectile_t *ppStack_c;
  projectile_t *ppStack_4;
  
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,unaff_EDI);
  fVar21 = in_stack_00000008 * 0.5;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,0.0,0.0,fVar21,unaff_ESI);
  ppVar13 = (projectile_t *)(in_stack_0000000c * 0.2);
  ppVar19 = ppVar13;
  (*grim_interface_ptr->vtable->grim_set_color_slot)
            ((IGrim2D *)0x2,0,0.0,0.0,(float)ppVar13,unaff_EBP);
  (*grim_interface_ptr->vtable->grim_set_color_slot)
            ((IGrim2D *)0x3,0,0.0,0.0,(float)ppVar13,unaff_EBX);
  (*grim_interface_ptr->vtable->grim_bind_texture)
            ((IGrim2D *)bullet_trail_texture,0,in_stack_fffffe64);
  ppVar13 = (projectile_t *)0x3f000000;
  uVar11 = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,0.5,in_stack_fffffe68);
  iVar4 = 0;
  if (0 < (int)config_blob.reserved0._20_4_) {
    puVar3 = player_health._pad0 + 0x2dc;
    do {
      if (0.0 < *(float *)((player_state_t *)(puVar3 + -0x2dc))->_pad0) {
        fVar6 = (float10)*(float *)puVar3 - (float10)1.5707964;
        fVar7 = (float10)fcos(fVar6);
        fVar8 = (float10)fsin(fVar6);
        in_stack_fffffe9c = (projectile_t *)(float)fVar8;
        ppStack_10c = (projectile_t *)((float)in_stack_fffffe9c * 512.0);
        ppStack_d8 = (projectile_t *)
                     (float)(fVar7 * (float10)512.0 + (float10)*(float *)(puVar3 + -0x2ec));
        ppStack_d4 = (projectile_t *)((float)ppStack_10c + *(float *)(puVar3 + -0x2e8));
        fVar7 = (float10)fcos(fVar6 - (float10)0.150915);
        ppStack_118 = (projectile_t *)(float)(fVar7 * (float10)15.0);
        fVar6 = (float10)fsin(fVar6 - (float10)0.150915);
        ppStack_150 = (projectile_t *)(*(float *)(puVar3 + -0x2ec) + (float)ppStack_118);
        ppStack_14c = (projectile_t *)
                      (float)((float10)*(float *)(puVar3 + -0x2e8) + fVar6 * (float10)15.0);
        fVar6 = (float10)fcos((float10)*(float *)puVar3);
        fVar6 = fVar6 * (float10)1.1;
        fVar7 = (float10)fsin((float10)*(float *)puVar3);
        ppStack_e4 = (projectile_t *)(float)(fVar7 * (float10)1.1);
        ppStack_94 = (projectile_t *)((float)ppStack_14c + _camera_offset_y);
        ppStack_138 = (projectile_t *)
                      (float)(((float10)(float)ppStack_150 + (float10)_camera_offset_x) - fVar6);
        ppStack_100 = (projectile_t *)
                      (float)((float10)(float)ppStack_150 + (float10)_camera_offset_x + fVar6);
        ppStack_fc = (projectile_t *)((float)ppStack_94 + (float)ppStack_e4);
        ppStack_124 = (projectile_t *)((float)ppStack_d4 + _camera_offset_y);
        ppStack_108 = (projectile_t *)
                      (float)((float10)(float)ppStack_d8 + (float10)_camera_offset_x + fVar6);
        ppStack_104 = (projectile_t *)((float)ppStack_124 + (float)ppStack_e4);
        ppStack_f8 = (projectile_t *)
                     (float)(((float10)(float)ppStack_d8 + (float10)_camera_offset_x) - fVar6);
        fStack_f4 = (float)ppStack_124 - (float)ppStack_e4;
        ppStack_64 = ppStack_94;
        if (0 < *(int *)(player_health._pad0 + perk_id_sharpshooter * 4 + 0x94)) {
          (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar11);
          (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)ppVar13);
          ppVar13 = ppStack_f8;
          (*grim_interface_ptr->vtable->grim_draw_quad_points)
                    ((IGrim2D *)ppStack_13c,(float)ppStack_138,(float)ppStack_104,(float)ppStack_100
                     ,(float)ppStack_10c,(float)ppStack_108,(float)ppStack_fc,(float)ppStack_f8,
                     in_stack_fffffe68);
          in_stack_fffffe68 = 6.07815e-39;
          (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_fffffe6c);
          uVar11 = 6;
          (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,(uint)ppVar13);
        }
      }
      iVar4 = iVar4 + 1;
      puVar3 = puVar3 + 0x360;
    } while (iVar4 < (int)config_blob.reserved0._20_4_);
  }
  pIVar24 = (IGrim2D *)0x0;
  (*grim_interface_ptr->vtable->grim_set_color_slot)
            ((IGrim2D *)0x0,0x3f000000,0.5,0.5,0.0,(float)in_stack_fffffe6c);
  ppVar16 = (projectile_t *)0x0;
  ppVar15 = (projectile_t *)0x3f000000;
  (*grim_interface_ptr->vtable->grim_set_color_slot)
            ((IGrim2D *)0x1,0x3f000000,0.5,0.5,0.0,(float)ppVar19);
  uVar11 = 0x13;
  ppVar14 = (projectile_t *)0x5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)ppVar15);
  ppVar13 = (projectile_t *)0x2;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar11);
  pfVar2 = &projectile_pool.vel_y;
  do {
    if ((((projectile_t *)(pfVar2 + -7))->active != '\0') &&
       ((fVar12 = pfVar2[1], (int)fVar12 < 8 || (fVar12 == 4.06377e-44)))) {
      if (fVar12 == 0.0) {
        ((projectile_t *)(pfVar2 + -7))->active = '\0';
      }
      fStack_24 = pfVar2[2];
      if (fStack_24 <= 1.0) {
        if (fStack_24 < 0.0) {
          fStack_24 = 0.0;
        }
      }
      else {
        fStack_24 = 1.0;
      }
      fVar12 = fStack_24 * in_stack_00000014;
      fVar21 = fVar12;
      (*grim_interface_ptr->vtable->grim_set_color_slot)
                ((IGrim2D *)0x2,0x3f000000,0.5,0.5,fVar12,(float)ppVar14);
      (*grim_interface_ptr->vtable->grim_set_color_slot)
                ((IGrim2D *)0x3,0x3f000000,0.5,0.5,fVar12,(float)ppVar15);
      fVar18 = fStack_1c;
      fVar12 = pfVar2[1];
      if (fVar12 == 2.8026e-45) {
        ppStack_c = (projectile_t *)(_camera_offset_y + pfVar2[-2]);
        self = (projectile_t *)((_camera_offset_x + pfVar2[-3]) - pfVar2[-1]);
        x0 = (projectile_t *)((float)ppStack_c - *pfVar2);
        ppVar13 = (projectile_t *)(_camera_offset_x + pfVar2[-3] + pfVar2[-1]);
        x1 = (projectile_t *)((float)ppStack_c + *pfVar2);
        in_stack_fffffe7c = (projectile_t *)(_camera_offset_y + pfVar2[-4]);
        ppStack_158 = (projectile_t *)(_camera_offset_x + pfVar2[-5] + pfVar2[-1]);
        fStack_f4 = (float)in_stack_fffffe7c + *pfVar2;
        ppStack_128 = (projectile_t *)((_camera_offset_x + pfVar2[-5]) - pfVar2[-1]);
        ppVar19 = (projectile_t *)((float)in_stack_fffffe7c - *pfVar2);
        ppStack_108 = ppStack_128;
        ppStack_104 = ppVar19;
        ppStack_f8 = ppStack_158;
        ppStack_e8 = self;
        ppStack_e4 = x0;
        ppStack_d8 = ppVar13;
        ppStack_d4 = x1;
        ppStack_4 = in_stack_fffffe7c;
      }
      else if (fVar12 == 1.4013e-45) {
        ppStack_138 = (projectile_t *)(pfVar2[-1] * 1.2);
        ppStack_fc = (projectile_t *)(*pfVar2 * 1.2);
        in_stack_00000014 = _camera_offset_y + pfVar2[-2];
        self = (projectile_t *)((_camera_offset_x + pfVar2[-3]) - (float)ppStack_138);
        x0 = (projectile_t *)(in_stack_00000014 - (float)ppStack_fc);
        ppVar13 = (projectile_t *)(_camera_offset_x + pfVar2[-3] + (float)ppStack_138);
        x1 = (projectile_t *)(in_stack_00000014 + (float)ppStack_fc);
        in_stack_fffffea0 = (projectile_t *)(_camera_offset_x + pfVar2[-5]);
        in_stack_fffffe7c = (projectile_t *)(_camera_offset_y + pfVar2[-4]);
        ppStack_158 = (projectile_t *)((float)in_stack_fffffea0 + (float)ppStack_138);
        ppStack_9c = (projectile_t *)((float)in_stack_fffffe7c + (float)ppStack_fc);
        ppStack_128 = (projectile_t *)((float)in_stack_fffffea0 - (float)ppStack_138);
        ppVar19 = (projectile_t *)((float)in_stack_fffffe7c - (float)ppStack_fc);
        ppStack_150 = self;
        ppStack_14c = x0;
        ppStack_12c = ppVar19;
        ppStack_100 = ppStack_138;
        ppStack_c0 = ppVar13;
        ppStack_bc = x1;
        ppStack_a0 = ppStack_158;
        ppStack_44 = in_stack_fffffe7c;
        ppStack_3c = ppStack_fc;
        ppStack_34 = in_stack_fffffe7c;
        ppStack_2c = ppStack_fc;
        fStack_14 = in_stack_00000014;
      }
      else if (fVar12 == 8.40779e-45) {
        (*grim_interface_ptr->vtable->grim_set_color_slot)
                  ((IGrim2D *)0x2,0x3e4ccccd,0.5,1.0,fStack_1c,(float)ppVar16);
        (*grim_interface_ptr->vtable->grim_set_color_slot)
                  ((IGrim2D *)0x3,0x3e4ccccd,0.5,1.0,fVar18,(float)ppVar19);
        ppStack_140 = (projectile_t *)(pfVar2[-1] * 1.1);
        ppStack_13c = (projectile_t *)(*pfVar2 * 1.1);
        fStack_74 = _camera_offset_y + pfVar2[-2];
        self = (projectile_t *)((_camera_offset_x + pfVar2[-3]) - (float)ppStack_140);
        x0 = (projectile_t *)(fStack_74 - (float)ppStack_13c);
        ppVar13 = (projectile_t *)(_camera_offset_x + pfVar2[-3] + (float)ppStack_140);
        x1 = (projectile_t *)(fStack_74 + (float)ppStack_13c);
        ppStack_158 = (projectile_t *)(_camera_offset_x + pfVar2[-5]);
        in_stack_fffffe84 = (projectile_t *)(_camera_offset_y + pfVar2[-4]);
        ppStack_150 = (projectile_t *)((float)ppStack_158 + (float)ppStack_140);
        ppStack_14c = (projectile_t *)((float)in_stack_fffffe84 + (float)ppStack_13c);
        in_stack_fffffe8c = (projectile_t *)((float)ppStack_158 - (float)ppStack_140);
        ppVar19 = (projectile_t *)((float)in_stack_fffffe84 - (float)ppStack_13c);
        in_stack_fffffe90 = ppVar19;
        ppStack_120 = in_stack_fffffe8c;
        ppStack_118 = ppStack_150;
        ppStack_114 = ppStack_14c;
        ppStack_e8 = ppVar13;
        ppStack_e4 = x1;
        ppStack_a8 = self;
        ppStack_a4 = x0;
        ppStack_a0 = ppStack_140;
        ppStack_9c = ppStack_13c;
        ppStack_84 = in_stack_fffffe84;
        ppStack_7c = ppStack_13c;
        fStack_6c = fStack_74;
        ppStack_64 = ppStack_13c;
        ppStack_4c = in_stack_fffffe84;
      }
      else {
        in_stack_fffffe90 = (projectile_t *)(pfVar2[-1] * 0.7);
        in_stack_fffffe94 = (projectile_t *)(*pfVar2 * 0.7);
        ppStack_5c = (projectile_t *)(_camera_offset_y + pfVar2[-2]);
        self = (projectile_t *)((_camera_offset_x + pfVar2[-3]) - (float)in_stack_fffffe90);
        x0 = (projectile_t *)((float)ppStack_5c - (float)in_stack_fffffe94);
        ppVar13 = (projectile_t *)(_camera_offset_x + pfVar2[-3] + (float)in_stack_fffffe90);
        x1 = (projectile_t *)((float)ppStack_5c + (float)in_stack_fffffe94);
        in_stack_fffffea0 = (projectile_t *)(_camera_offset_x + pfVar2[-5]);
        in_stack_fffffe7c = (projectile_t *)(_camera_offset_y + pfVar2[-4]);
        ppStack_158 = (projectile_t *)((float)in_stack_fffffea0 + (float)in_stack_fffffe90);
        ppStack_10c = (projectile_t *)((float)in_stack_fffffe7c + (float)in_stack_fffffe94);
        in_stack_fffffe98 = (projectile_t *)((float)in_stack_fffffea0 - (float)in_stack_fffffe90);
        ppVar19 = (projectile_t *)((float)in_stack_fffffe7c - (float)in_stack_fffffe94);
        in_stack_fffffe9c = ppVar19;
        ppStack_128 = in_stack_fffffe98;
        ppStack_118 = ppVar13;
        ppStack_114 = x1;
        ppStack_110 = ppStack_158;
        ppStack_dc = in_stack_fffffe94;
        ppStack_cc = in_stack_fffffe7c;
        ppStack_c4 = in_stack_fffffe94;
        ppStack_b4 = in_stack_fffffe7c;
        ppStack_98 = in_stack_fffffe90;
        ppStack_94 = in_stack_fffffe94;
        ppStack_68 = self;
        ppStack_64 = x0;
        ppStack_4c = ppStack_5c;
      }
      ppVar14 = ppStack_150;
      ppVar15 = ppStack_14c;
      ppVar16 = ppStack_120;
      (*grim_interface_ptr->vtable->grim_draw_quad_points)
                ((IGrim2D *)self,(float)x0,(float)ppVar13,(float)x1,(float)ppStack_150,
                 (float)ppStack_14c,(float)ppStack_120,(float)ppVar19,(float)in_stack_fffffe74);
    }
    pfVar2 = pfVar2 + 0x10;
  } while ((int)pfVar2 < 0x493ed4);
  fVar12 = 6.080694e-39;
  (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)ppVar14);
  uVar11 = 0x13;
  iVar4 = 5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)ppVar13);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar11);
  (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,iVar4);
  effect_select_texture(0xd);
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,(float)ppVar13);
  if (0.0 < *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2d8)) {
    fVar6 = ((float10)*(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2dc) -
            (float10)1.5707964) - (float10)0.150915;
    fVar7 = (float10)fcos(fVar6);
    in_stack_fffffe8c = (projectile_t *)(float)(fVar7 * (float10)15.0);
    fVar6 = (float10)fsin(fVar6);
    in_stack_fffffe90 = (projectile_t *)(float)(fVar6 * (float10)15.0);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,
               in_stack_00000010 *
               *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2d8),fVar12);
    (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)ppVar14);
    (*grim_interface_ptr->vtable->grim_draw_quad)
              ((IGrim2D *)
               (((float)in_stack_fffffe94 +
                 (float)(&player_pos_x)[render_overlay_player_index * 0xd8] + _camera_offset_x) -
               80.0),((float)in_stack_fffffe98 +
                      (float)(&player_pos_y)[render_overlay_player_index * 0xd8] + _camera_offset_y)
                     - 80.0,160.0,160.0,(float)ppVar15);
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)ppVar16);
  }
  (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)ppVar19);
  pfVar2 = &projectile_pool.pos_y;
  do {
    if ((((projectile_t *)(pfVar2 + -3))->active != '\0') &&
       ((((fVar12 = pfVar2[5], fVar12 == 1.26117e-44 || (fVar12 == 1.54143e-44)) ||
         (fVar12 == 3.64338e-44)) || ((fVar12 == 3.36312e-44 || (fVar12 == 3.92364e-44)))))) {
      if (pfVar2[6] == 0.4) {
        if (fVar12 == 1.26117e-44) {
          uVar9 = __ftol();
          lVar10 = __ftol();
          iVar4 = (int)((longlong)
                        ((ulonglong)(uint)((int)uVar9 >> 0x1f) << 0x20 | uVar9 & 0xffffffff) /
                       (longlong)(int)lVar10);
          if (8 < iVar4) {
            iVar4 = 8;
          }
          fVar6 = (float10)fcos((float10)pfVar2[-2] + (float10)1.5707964);
          ppStack_140 = (projectile_t *)(float)(fVar6 * (float10)pfVar2[8] * (float10)2.5);
          fVar6 = (float10)fsin((float10)pfVar2[-2] + (float10)1.5707964);
          in_stack_fffffe84 = (projectile_t *)(float)(fVar6 * (float10)pfVar2[8] * (float10)2.5);
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000024 * 0.4,(float)in_stack_fffffe74)
          ;
          iVar5 = 0;
          in_stack_fffffe90 = (projectile_t *)0x0;
          if (0 < iVar4) {
            do {
              (*grim_interface_ptr->vtable->grim_draw_quad)
                        ((IGrim2D *)
                         (((float)(int)in_stack_fffffe8c * (float)ppStack_140 + pfVar2[-1] +
                          _camera_offset_x) - 11.0),
                         ((float)(int)in_stack_fffffe8c * (float)in_stack_fffffe84 + *pfVar2 +
                         _camera_offset_y) - 11.0,22.0,22.0,(float)in_stack_fffffe74);
              iVar5 = iVar5 + 1;
              in_stack_fffffe90 = (projectile_t *)iVar5;
            } while (iVar5 < iVar4);
          }
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000028 * 0.45,fVar21);
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)((_camera_offset_x + pfVar2[-1]) - 28.0),
                     (_camera_offset_y + *pfVar2) - 28.0,56.0,56.0,(float)in_stack_fffffe7c);
          ppVar13 = (projectile_t *)(in_stack_00000030 * 0.3);
          pIVar1 = grim_interface_ptr->vtable;
LAB_00423cb4:
          fVar21 = 1.0;
          in_stack_fffffe74 = (IGrim2D *)0x3f800000;
          (*pIVar1->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,(float)ppVar13,(float)pIVar24);
          in_stack_fffffe7c = ppVar13;
          if (config_blob.reserved0[0x10] != '\0') {
            pIVar24 = (IGrim2D *)0x43800000;
            in_stack_fffffe7c = (projectile_t *)0x43800000;
            fVar21 = (_camera_offset_y + *pfVar2) - 128.0;
            in_stack_fffffe74 = (IGrim2D *)((_camera_offset_x + pfVar2[-1]) - 128.0);
            (*grim_interface_ptr->vtable->grim_draw_quad)
                      (in_stack_fffffe74,fVar21,256.0,256.0,(float)in_stack_fffffe84);
          }
        }
        else {
          if (fVar12 == 1.54143e-44) {
            uVar9 = __ftol();
            lVar10 = __ftol();
            iVar4 = (int)((longlong)
                          ((ulonglong)(uint)((int)uVar9 >> 0x1f) << 0x20 | uVar9 & 0xffffffff) /
                         (longlong)(int)lVar10);
            if (3 < iVar4) {
              iVar4 = 3;
            }
            fVar6 = (float10)fcos((float10)pfVar2[-2] + (float10)1.5707964);
            fVar7 = fVar6 * (float10)pfVar2[8] * (float10)2.1;
            fVar6 = (float10)fsin((float10)pfVar2[-2] + (float10)1.5707964);
            in_stack_fffffe84 = (projectile_t *)(float)(fVar6 * (float10)pfVar2[8] * (float10)2.1);
            fVar12 = in_stack_00000024 * 0.4;
            fVar17 = 1.0;
            fVar18 = 1.0;
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)0x3f800000,1.0,1.0,fVar12,(float)in_stack_fffffe74);
            iVar5 = 0;
            in_stack_fffffe90 = (projectile_t *)0x0;
            if (0 < iVar4) {
              do {
                (*grim_interface_ptr->vtable->grim_draw_quad)
                          ((IGrim2D *)
                           (((float)(int)pIVar24 * (float)ppStack_14c + pfVar2[-1] +
                            _camera_offset_x) - 6.0),
                           ((float)(int)pIVar24 * fVar21 + *pfVar2 + _camera_offset_y) - 6.0,12.0,
                           12.0,fVar18);
                iVar5 = iVar5 + 1;
                in_stack_fffffe84 = (projectile_t *)iVar5;
              } while (iVar5 < iVar4);
            }
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_fffffe8c,fVar17);
            (*grim_interface_ptr->vtable->grim_draw_quad)
                      ((IGrim2D *)((_camera_offset_x + pfVar2[-1]) - 8.0),
                       (_camera_offset_y + *pfVar2) - 8.0,16.0,16.0,fVar12);
            pIVar1 = grim_interface_ptr->vtable;
            fVar18 = 1.0;
            fVar12 = 1.0;
            pIVar22 = (IGrim2D *)0x3f800000;
          }
          else {
            if (fVar12 == 3.92364e-44) {
              uVar9 = __ftol();
              lVar10 = __ftol();
              iVar4 = (int)((longlong)
                            ((ulonglong)(uint)((int)uVar9 >> 0x1f) << 0x20 | uVar9 & 0xffffffff) /
                           (longlong)(int)lVar10);
              if (0x12 < iVar4) {
                iVar4 = 0x12;
              }
              fVar6 = (float10)fcos((float10)pfVar2[-2] + (float10)1.5707964);
              ppStack_140 = (projectile_t *)(float)(fVar6 * (float10)pfVar2[8] * (float10)2.6);
              fVar6 = (float10)fsin((float10)pfVar2[-2] + (float10)1.5707964);
              in_stack_fffffe84 = (projectile_t *)(float)(fVar6 * (float10)pfVar2[8] * (float10)2.6)
              ;
              ppVar13 = (projectile_t *)(in_stack_00000024 * 0.4);
              in_stack_fffffe88 = ppVar13;
              (*grim_interface_ptr->vtable->grim_set_color)
                        ((IGrim2D *)0x3f800000,1.0,1.0,(float)ppVar13,(float)in_stack_fffffe74);
              iVar5 = 0;
              in_stack_fffffe90 = (projectile_t *)0x0;
              if (0 < iVar4) {
                do {
                  (*grim_interface_ptr->vtable->grim_draw_quad)
                            ((IGrim2D *)
                             (((float)(int)in_stack_fffffe90 * (float)ppStack_13c + pfVar2[-1] +
                              _camera_offset_x) - 22.0),
                             ((float)(int)in_stack_fffffe90 * (float)in_stack_fffffe88 + *pfVar2 +
                             _camera_offset_y) - 22.0,44.0,44.0,fVar21);
                  iVar5 = iVar5 + 1;
                  in_stack_fffffe94 = (projectile_t *)iVar5;
                } while (iVar5 < iVar4);
              }
              (*grim_interface_ptr->vtable->grim_set_color)
                        ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000028 * 0.45,fVar21);
              (*grim_interface_ptr->vtable->grim_draw_quad)
                        ((IGrim2D *)((_camera_offset_x + pfVar2[-1]) - 42.0),
                         (_camera_offset_y + *pfVar2) - 42.0,84.0,84.0,(float)in_stack_fffffe7c);
              pIVar1 = grim_interface_ptr->vtable;
              goto LAB_00423cb4;
            }
            if (fVar12 == 3.64338e-44) {
              uVar9 = __ftol();
              lVar10 = __ftol();
              iVar4 = (int)((longlong)
                            ((ulonglong)(uint)((int)uVar9 >> 0x1f) << 0x20 | uVar9 & 0xffffffff) /
                           (longlong)(int)lVar10);
              if (3 < iVar4) {
                iVar4 = 3;
              }
              fVar6 = (float10)fcos((float10)pfVar2[-2] + (float10)1.5707964);
              fVar7 = fVar6 * (float10)pfVar2[8] * (float10)2.1;
              fVar6 = (float10)fsin((float10)pfVar2[-2] + (float10)1.5707964);
              in_stack_fffffe84 = (projectile_t *)(float)(fVar6 * (float10)pfVar2[8] * (float10)2.1)
              ;
              fVar12 = in_stack_00000024 * 0.4;
              fVar17 = 0.3;
              fVar18 = 1.0;
              (*grim_interface_ptr->vtable->grim_set_color)
                        ((IGrim2D *)0x3e99999a,1.0,0.3,fVar12,(float)in_stack_fffffe74);
              iVar5 = 0;
              in_stack_fffffe90 = (projectile_t *)0x0;
              if (0 < iVar4) {
                do {
                  (*grim_interface_ptr->vtable->grim_draw_quad)
                            ((IGrim2D *)
                             (((float)(int)pIVar24 * (float)ppStack_14c + pfVar2[-1] +
                              _camera_offset_x) - 6.0),
                             ((float)(int)pIVar24 * fVar21 + *pfVar2 + _camera_offset_y) - 6.0,12.0,
                             12.0,fVar18);
                  iVar5 = iVar5 + 1;
                  in_stack_fffffe84 = (projectile_t *)iVar5;
                } while (iVar5 < iVar4);
              }
              (*grim_interface_ptr->vtable->grim_set_color)
                        ((IGrim2D *)0x3e99999a,1.0,0.3,(float)in_stack_fffffe8c,fVar17);
              (*grim_interface_ptr->vtable->grim_draw_quad)
                        ((IGrim2D *)((_camera_offset_x + pfVar2[-1]) - 8.0),
                         (_camera_offset_y + *pfVar2) - 8.0,16.0,16.0,fVar12);
              pIVar1 = grim_interface_ptr->vtable;
              fVar18 = 0.3;
              fVar12 = 1.0;
            }
            else {
              if (fVar12 != 3.36312e-44) goto LAB_00424111;
              uVar9 = __ftol();
              lVar10 = __ftol();
              iVar4 = (int)((longlong)
                            ((ulonglong)(uint)((int)uVar9 >> 0x1f) << 0x20 | uVar9 & 0xffffffff) /
                           (longlong)(int)lVar10);
              if (3 < iVar4) {
                iVar4 = 3;
              }
              fVar6 = (float10)fcos((float10)pfVar2[-2] + (float10)1.5707964);
              fVar7 = fVar6 * (float10)pfVar2[8] * (float10)2.1;
              fVar6 = (float10)fsin((float10)pfVar2[-2] + (float10)1.5707964);
              in_stack_fffffe84 = (projectile_t *)(float)(fVar6 * (float10)pfVar2[8] * (float10)2.1)
              ;
              fVar12 = in_stack_00000024 * 0.4;
              fVar17 = 1.0;
              fVar18 = 0.3;
              (*grim_interface_ptr->vtable->grim_set_color)
                        ((IGrim2D *)0x3e99999a,0.3,1.0,fVar12,(float)in_stack_fffffe74);
              iVar5 = 0;
              in_stack_fffffe90 = (projectile_t *)0x0;
              if (0 < iVar4) {
                do {
                  (*grim_interface_ptr->vtable->grim_draw_quad)
                            ((IGrim2D *)
                             (((float)(int)pIVar24 * (float)ppStack_14c + pfVar2[-1] +
                              _camera_offset_x) - 6.0),
                             ((float)(int)pIVar24 * fVar21 + *pfVar2 + _camera_offset_y) - 6.0,12.0,
                             12.0,fVar18);
                  iVar5 = iVar5 + 1;
                  in_stack_fffffe84 = (projectile_t *)iVar5;
                } while (iVar5 < iVar4);
              }
              (*grim_interface_ptr->vtable->grim_set_color)
                        ((IGrim2D *)0x3e99999a,0.3,1.0,(float)in_stack_fffffe8c,fVar17);
              (*grim_interface_ptr->vtable->grim_draw_quad)
                        ((IGrim2D *)((_camera_offset_x + pfVar2[-1]) - 8.0),
                         (_camera_offset_y + *pfVar2) - 8.0,16.0,16.0,fVar12);
              pIVar1 = grim_interface_ptr->vtable;
              fVar18 = 1.0;
              fVar12 = 0.3;
            }
            pIVar22 = (IGrim2D *)0x3e99999a;
          }
          ppStack_140 = (projectile_t *)(float)fVar7;
          (*pIVar1->grim_set_color)
                    (pIVar22,fVar12,fVar18,in_stack_00000024 * 0.15,(float)in_stack_fffffe74);
          if (config_blob.reserved0[0x10] != '\0') {
            in_stack_fffffe74 = (IGrim2D *)0x42f00000;
            fVar18 = 120.0;
            fVar12 = (_camera_offset_y + *pfVar2) - 60.0;
            pIVar1 = grim_interface_ptr->vtable;
            pIVar22 = (IGrim2D *)((_camera_offset_x + pfVar2[-1]) - 60.0);
            goto LAB_00424107;
          }
        }
      }
      else {
        fVar12 = pfVar2[6] * 2.5;
        if (fVar12 <= 1.0) {
          if (fVar12 < 0.0) {
            fVar12 = 0.0;
          }
        }
        else {
          fVar12 = 1.0;
        }
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,fVar12 * in_stack_00000024,(float)in_stack_fffffe74
                  );
        in_stack_fffffe74 = (IGrim2D *)0x42600000;
        fVar18 = 56.0;
        fVar12 = (_camera_offset_y + *pfVar2) - 28.0;
        pIVar1 = grim_interface_ptr->vtable;
        pIVar22 = (IGrim2D *)((_camera_offset_x + pfVar2[-1]) - 28.0);
LAB_00424107:
        (*pIVar1->grim_draw_quad)(pIVar22,fVar12,fVar18,(float)in_stack_fffffe74,fVar21);
      }
    }
LAB_00424111:
    pfVar2 = pfVar2 + 0x10;
  } while ((int)pfVar2 < 0x493ec4);
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_fffffe74);
  ppVar13 = (projectile_t *)0x3f800000;
  iVar4 = perk_count_get(perk_id_ion_gun_master);
  if (iVar4 != 0) {
    ppVar13 = (projectile_t *)0x3f99999a;
  }
  (*grim_interface_ptr->vtable->grim_bind_texture)(projectile_texture,0,(int)fVar21);
  pIVar22 = (IGrim2D *)0x424175;
  (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)in_stack_fffffe7c);
  ppStack_14c = (projectile_t *)0x0;
  pfVar2 = &projectile_pool.origin_y;
  do {
    ppVar19 = (projectile_t *)(pfVar2 + -5);
    ppVar14 = ppVar19;
    if (((projectile_t *)(pfVar2 + -5))->active != '\0') {
      fVar21 = pfVar2[3];
      if (fVar21 == 2.66247e-44) {
        if (pfVar2[4] == 0.4) {
          (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)pfVar2[-4],(float)pIVar24);
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)
                    ((IGrim2D *)0x2,0,(int)in_stack_fffffe84);
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3dcccccd,0.6,0.2,in_stack_00000038 * 0.7,(float)in_stack_fffffe88)
          ;
          ppStack_d0 = (projectile_t *)((float)ppStack_150 * 16.0);
          pIVar1 = grim_interface_ptr->vtable;
          fVar21 = (float)ppStack_150 * 8.0;
          in_stack_fffffe84 = ppStack_d0;
LAB_00424257:
          pIVar24 = (IGrim2D *)((_camera_offset_y + pfVar2[-2]) - fVar21);
          pIVar22 = (IGrim2D *)0x42427f;
          in_stack_fffffe88 = in_stack_fffffe84;
          (*pIVar1->grim_draw_quad)
                    ((IGrim2D *)((_camera_offset_x + pfVar2[-3]) - fVar21),(float)pIVar24,
                     (float)in_stack_fffffe84,(float)in_stack_fffffe84,(float)ppVar13);
        }
        else {
          (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)pfVar2[-4],(float)pIVar24);
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)
                    ((IGrim2D *)0x2,0,(int)in_stack_fffffe84);
          fVar21 = pfVar2[4] * 2.5;
          if (fVar21 <= 1.0) {
            if (fVar21 < 0.0) {
              fVar21 = 0.0;
            }
          }
          else {
            fVar21 = 1.0;
          }
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f800000,1.0,1.0,fVar21 * in_stack_00000038,
                     (float)in_stack_fffffe88);
          in_stack_fffffe88 = (projectile_t *)0x42600000;
          in_stack_fffffe84 = (projectile_t *)0x42600000;
          pIVar24 = (IGrim2D *)((_camera_offset_y + pfVar2[-2]) - 28.0);
          pIVar22 = (IGrim2D *)0x424343;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)((_camera_offset_x + pfVar2[-3]) - 28.0),(float)pIVar24,56.0,56.0,
                     (float)ppVar13);
        }
      }
      else if (fVar21 == 4.06377e-44) {
        if (pfVar2[4] == 0.4) {
          (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)pfVar2[-4],(float)pIVar24);
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)
                    ((IGrim2D *)0x4,3,(int)in_stack_fffffe84);
          fVar12 = 1.0;
          fVar21 = 1.0;
          pIVar1 = grim_interface_ptr->vtable;
          pIVar24 = (IGrim2D *)0x3f800000;
LAB_00424475:
          (*pIVar1->grim_set_color)
                    (pIVar24,fVar21,fVar12,in_stack_00000030,(float)in_stack_fffffe88);
          fVar21 = (float)ppStack_150 * 0.5;
          pIVar1 = grim_interface_ptr->vtable;
          in_stack_fffffe84 = ppStack_150;
          goto LAB_00424257;
        }
      }
      else if (fVar21 == 3.50325e-44) {
        if (pfVar2[4] == 0.4) {
          (*grim_interface_ptr->vtable->grim_set_rotation)
                    ((IGrim2D *)((float)(int)ppStack_14c * 0.1 - (float)quest_spawn_timeline * 0.1),
                     (float)pIVar24);
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)
                    ((IGrim2D *)0x4,6,(int)in_stack_fffffe84);
          fVar12 = 0.8;
          fVar21 = 0.8;
          pIVar1 = grim_interface_ptr->vtable;
          pIVar24 = (IGrim2D *)0x3f4ccccd;
          goto LAB_00424475;
        }
      }
      else if (((fVar21 == 3.08286e-44) || (fVar21 == 2.94273e-44)) ||
              ((fVar21 == 3.22299e-44 || (fVar21 == 6.30584e-44)))) {
        if (pfVar2[4] == 0.4) {
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x2,2,(int)pIVar24);
          ppStack_128 = (projectile_t *)(pfVar2[-3] - pfVar2[-1]);
          pppVar25 = &ppStack_128;
          ppStack_124 = (projectile_t *)(pfVar2[-2] - *pfVar2);
          pppVar23 = &ppStack_128;
          ppStack_108 = (projectile_t *)
                        SQRT((float)ppStack_124 * (float)ppStack_124 +
                             (float)ppStack_128 * (float)ppStack_128);
          ppStack_e8 = ppStack_128;
          ppStack_e4 = ppStack_124;
          thunk_FUN_00452f1d();
          if (pfVar2[3] == 6.30584e-44) {
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)0x3f800000,0.6,0.1,in_stack_00000030,(float)pppVar23);
          }
          else {
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)0x3f000000,0.6,1.0,in_stack_00000030,(float)pppVar23);
          }
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x4,2,(int)pppVar25);
          ppStack_d8 = (projectile_t *)((float)ppStack_158 * 16.0);
          fStack_e0 = (_camera_offset_x + pfVar2[-1]) - (float)ppStack_d8;
          ppStack_dc = (projectile_t *)((_camera_offset_y + *pfVar2) - (float)ppStack_d8);
          if ((float)ppStack_108 <= 256.0) {
            fStack_130 = 0.0;
            ppStack_98 = ppStack_108;
          }
          else {
            fStack_130 = (float)ppStack_108 - 256.0;
            ppStack_98 = (projectile_t *)0x43800000;
          }
          in_stack_fffffe9c = (projectile_t *)((float)ppStack_158 * 3.1);
          if (9.0 < (float)in_stack_fffffe9c) {
            in_stack_fffffe9c = (projectile_t *)0x41100000;
          }
          fStack_88 = fStack_130;
          if (fStack_130 < (float)ppStack_108) {
            ppVar14 = (projectile_t *)((float)ppStack_158 * 32.0);
            ppVar15 = ppVar14;
            do {
              if (pfVar2[3] == 6.30584e-44) {
                (*grim_interface_ptr->vtable->grim_set_color)
                          ((IGrim2D *)0x3f800000,0.6,0.1,
                           ((fStack_130 - fStack_88) / (float)ppStack_98) * in_stack_00000034,
                           (float)in_stack_fffffe84);
              }
              else {
                (*grim_interface_ptr->vtable->grim_set_color)
                          ((IGrim2D *)0x3f000000,0.6,1.0,
                           ((fStack_130 - fStack_88) / (float)ppStack_98) * in_stack_00000034,
                           (float)in_stack_fffffe84);
              }
              in_stack_fffffe84 = ppVar14;
              (*grim_interface_ptr->vtable->grim_draw_quad)
                        ((IGrim2D *)((float)ppStack_124 * (float)ppStack_12c + (float)ppStack_dc),
                         (float)ppStack_120 * (float)ppStack_12c + (float)ppStack_d8,(float)ppVar14,
                         (float)ppVar14,(float)in_stack_fffffe88);
              ppStack_128 = (projectile_t *)((float)ppVar15 + (float)ppStack_128);
            } while ((float)ppStack_128 < (float)ppStack_100);
          }
          (*grim_interface_ptr->vtable->grim_set_rotation)
                    ((IGrim2D *)ppStack_144->angle,(float)in_stack_fffffe84);
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f800000,1.0,0.7,in_stack_00000038,(float)in_stack_fffffe88);
          in_stack_fffffe84 = (projectile_t *)((float)ppStack_150 * 32.0);
          pIVar24 = (IGrim2D *)((_camera_offset_y + ppStack_144->pos_y) - (float)ppStack_d0);
          pIVar22 = (IGrim2D *)0x4247d2;
          in_stack_fffffe88 = in_stack_fffffe84;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)((_camera_offset_x + ppStack_144->pos_x) - (float)ppStack_d0),
                     (float)pIVar24,(float)in_stack_fffffe84,(float)in_stack_fffffe84,(float)ppVar13
                    );
          in_stack_00000030 = in_stack_00000038;
          ppVar14 = ppStack_144;
        }
        else {
          (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)pfVar2[-4],(float)pIVar24);
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)
                    ((IGrim2D *)0x4,2,(int)in_stack_fffffe84);
          in_stack_fffffea0 = (projectile_t *)(pfVar2[4] * 2.5);
          if ((float)in_stack_fffffea0 <= 1.0) {
            if ((float)in_stack_fffffea0 < 0.0) {
              in_stack_fffffea0 = (projectile_t *)0x0;
            }
          }
          else {
            in_stack_fffffea0 = (projectile_t *)0x3f800000;
          }
          ppStack_124 = (projectile_t *)(pfVar2[-3] - pfVar2[-1]);
          pppVar25 = &ppStack_124;
          ppStack_120 = (projectile_t *)(pfVar2[-2] - *pfVar2);
          pppVar23 = &ppStack_124;
          ppStack_104 = (projectile_t *)
                        SQRT((float)ppStack_120 * (float)ppStack_120 +
                             (float)ppStack_124 * (float)ppStack_124);
          ppStack_ec = ppStack_124;
          ppStack_e8 = ppStack_120;
          thunk_FUN_00452f1d();
          fVar21 = pfVar2[3];
          if (fVar21 == 3.08286e-44) {
            h = (projectile_t **)0x3f866666;
          }
          else if (fVar21 == 2.94273e-44) {
            h = (projectile_t **)0x400ccccd;
          }
          else {
            h = (projectile_t **)0x3f4ccccd;
            if (fVar21 != 6.30584e-44) {
              h = (projectile_t **)0x40600000;
            }
          }
          (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x4,2,(int)pppVar23);
          ppStack_d8 = (projectile_t *)((float)ppStack_158 * 16.0);
          fStack_e0 = (_camera_offset_x + pfVar2[-1]) - (float)ppStack_d8;
          ppStack_dc = (projectile_t *)((_camera_offset_y + *pfVar2) - (float)ppStack_d8);
          if ((float)ppStack_108 <= 256.0) {
            in_stack_fffffe94 = (projectile_t *)0x0;
            ppStack_90 = ppStack_108;
          }
          else {
            in_stack_fffffe94 = (projectile_t *)((float)ppStack_108 - 256.0);
            ppStack_90 = (projectile_t *)0x43800000;
          }
          ppStack_118 = (projectile_t *)((float)ppStack_158 * 3.1);
          if (9.0 < (float)ppStack_118) {
            ppStack_118 = (projectile_t *)0x41100000;
          }
          ppStack_a8 = in_stack_fffffe94;
          if ((float)in_stack_fffffe94 < (float)ppStack_108) {
            pppVar23 = (projectile_t **)((float)ppStack_158 * 32.0);
            h = pppVar23;
            do {
              if (pfVar2[3] == 6.30584e-44) {
                (*grim_interface_ptr->vtable->grim_set_color)
                          ((IGrim2D *)0x3f800000,0.6,0.1,
                           (((float)in_stack_fffffe94 - (float)ppStack_a8) / (float)ppStack_90) *
                           (float)in_stack_fffffe9c * in_stack_00000034,(float)pppVar25);
              }
              else {
                (*grim_interface_ptr->vtable->grim_set_color)
                          ((IGrim2D *)0x3f000000,0.6,1.0,
                           (((float)in_stack_fffffe94 - (float)ppStack_a8) / (float)ppStack_90) *
                           (float)in_stack_fffffe9c * in_stack_00000034,(float)pppVar25);
              }
              pppVar25 = pppVar23;
              (*grim_interface_ptr->vtable->grim_draw_quad)
                        ((IGrim2D *)
                         ((float)in_stack_fffffe98 * (float)ppStack_124 + (float)ppStack_dc),
                         (float)in_stack_fffffe98 * (float)ppStack_120 + (float)ppStack_d8,
                         (float)pppVar23,(float)pppVar23,(float)in_stack_fffffe88);
              in_stack_fffffe9c = (projectile_t *)((float)ppStack_110 + (float)in_stack_fffffe9c);
            } while ((float)in_stack_fffffe9c < (float)ppStack_100);
          }
          ppVar15 = (projectile_t *)((float)in_stack_fffffe9c * in_stack_00000034);
          ppStack_118 = ppVar15;
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f000000,0.6,1.0,(float)ppVar15,(float)pppVar25);
          pos = &ppStack_140->pos_x;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)((_camera_offset_x + *pos) - 16.0),
                     (_camera_offset_y + ppStack_140->pos_y) - 16.0,32.0,32.0,
                     (float)in_stack_fffffe88);
          in_stack_fffffe84 = (projectile_t *)0x3f800000;
          pIVar24 = (IGrim2D *)0x3f19999a;
          pIVar22 = (IGrim2D *)0x424b17;
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f000000,0.6,1.0,(float)ppVar15,(float)ppVar13);
          ppVar16 = (projectile_t *)((float)ppStack_14c * (float)h * 40.0);
          in_stack_00000030 = in_stack_00000040;
          ppVar14 = ppStack_138;
          in_stack_fffffe88 = ppVar15;
          ppStack_fc = ppVar16;
          if (ppStack_140->type_id != 0x2d) {
            ppVar13 = (projectile_t *)0x1;
            pIVar24 = (IGrim2D *)0x424b40;
            in_stack_fffffe84 = (projectile_t *)pos;
            iVar4 = creature_find_in_radius(pos,(float)ppVar16,1);
            in_stack_fffffe88 = ppVar16;
            if (iVar4 != -1) {
              ppStack_150 = (projectile_t *)((float)ppStack_14c * 32.0);
              do {
                (*grim_interface_ptr->vtable->grim_set_uv_point)
                          ((IGrim2D *)0x0,0x3f200000,0.0,(float)in_stack_fffffe90);
                (*grim_interface_ptr->vtable->grim_set_uv_point)
                          ((IGrim2D *)0x1,0x3f200000,0.25,(float)in_stack_fffffe94);
                (*grim_interface_ptr->vtable->grim_set_uv_point)
                          ((IGrim2D *)0x2,0x3f200000,0.25,(float)in_stack_fffffe98);
                (*grim_interface_ptr->vtable->grim_set_uv_point)
                          ((IGrim2D *)0x3,0x3f200000,0.0,(float)in_stack_fffffe9c);
                pppVar25 = &ppStack_10c;
                ppStack_10c = (projectile_t *)((&creature_pool)[iVar4].pos_x - *pos);
                ppStack_108 = (projectile_t *)((&creature_pool)[iVar4].pos_y - ppStack_140->pos_y);
                pppVar23 = &ppStack_10c;
                thunk_FUN_00452f1d();
                ppVar13 = (projectile_t *)-(float)ppStack_110;
                ppStack_110 = ppStack_114;
                fStack_ac = _camera_offset_x + *pos;
                ppStack_a8 = (projectile_t *)(_camera_offset_y + ppStack_140->pos_y);
                fVar21 = (float)ppVar13 * (float)ppStack_144;
                ppStack_104 = (projectile_t *)((float)ppStack_144 * (float)ppStack_114);
                ppStack_a0 = (projectile_t *)((float)ppStack_104 * 10.0);
                ppStack_124 = (projectile_t *)(fStack_ac - fVar21 * 10.0);
                ppStack_120 = (projectile_t *)((float)ppStack_a8 - (float)ppStack_a0);
                fStack_88 = (float)ppStack_104 * 10.0;
                ppStack_10c = (projectile_t *)(fStack_ac + fVar21 * 10.0);
                ppStack_108 = (projectile_t *)(fStack_88 + (float)ppStack_a8);
                ppStack_bc = (projectile_t *)(_camera_offset_x + (&creature_pool)[iVar4].pos_x);
                ppStack_b8 = (projectile_t *)(_camera_offset_y + (&creature_pool)[iVar4].pos_y);
                fStack_30 = (float)ppStack_104 * 10.0;
                ppStack_12c = (projectile_t *)(fVar21 * 10.0 + (float)ppStack_bc);
                ppStack_128 = (projectile_t *)(fStack_30 + (float)ppStack_b8);
                fStack_28 = (float)ppStack_104 * 10.0;
                ppStack_fc = (projectile_t *)((float)ppStack_bc - fVar21 * 10.0);
                ppStack_f8 = (projectile_t *)((float)ppStack_b8 - fStack_28);
                ppStack_114 = ppVar13;
                ppStack_b0 = ppStack_104;
                ppStack_98 = ppStack_104;
                ppStack_40 = ppStack_104;
                ppStack_20 = ppStack_104;
                (*grim_interface_ptr->vtable->grim_draw_quad_points)
                          ((IGrim2D *)ppStack_124,(float)ppStack_120,(float)ppStack_10c,
                           (float)ppStack_108,(float)ppStack_12c,(float)ppStack_128,
                           (float)ppStack_fc,(float)ppStack_f8,(float)pppVar23);
                fVar21 = (float)ppStack_110 * (float)ppStack_140;
                ppStack_100 = (projectile_t *)((float)ppStack_10c * (float)ppStack_140);
                ppStack_5c = (projectile_t *)((float)ppStack_100 * 4.0);
                ppVar13 = (projectile_t *)((float)ppStack_128 + fVar21 * 4.0);
                ppStack_124 = (projectile_t *)((float)ppStack_5c + (float)ppStack_124);
                ppStack_4c = (projectile_t *)((float)ppStack_100 * 4.0);
                ppStack_f8 = (projectile_t *)((float)ppStack_f8 - fVar21 * 4.0);
                fStack_f4 = fStack_f4 - (float)ppStack_4c;
                ppStack_4 = (projectile_t *)((float)ppStack_100 * 4.0);
                ppStack_120 = (projectile_t *)((float)ppStack_120 - fVar21 * 4.0);
                pIVar24 = (IGrim2D *)((float)pIStack_11c - (float)ppStack_4);
                fStack_14 = (float)ppStack_100 * 4.0;
                in_stack_fffffe84 = (projectile_t *)((float)ppStack_108 + fVar21 * 4.0);
                in_stack_fffffe88 = (projectile_t *)(fStack_14 + (float)ppStack_104);
                pIVar22 = (IGrim2D *)0x424f32;
                ppStack_128 = ppVar13;
                pIStack_11c = pIVar24;
                ppStack_108 = in_stack_fffffe84;
                ppStack_104 = in_stack_fffffe88;
                ppStack_54 = ppStack_100;
                ppStack_44 = ppStack_100;
                ppStack_c = ppStack_100;
                (*grim_interface_ptr->vtable->grim_draw_quad_points)
                          ((IGrim2D *)ppStack_120,(float)pIVar24,(float)in_stack_fffffe84,
                           (float)in_stack_fffffe88,(float)ppVar13,(float)ppStack_124,
                           (float)ppStack_f8,fStack_f4,(float)pppVar25);
                (*grim_interface_ptr->vtable->grim_set_atlas_frame)
                          ((IGrim2D *)0x4,2,(int)in_stack_fffffea0);
                in_stack_fffffe94 =
                     (projectile_t *)
                     ((_camera_offset_x + (&creature_pool)[iVar4].pos_x) - (float)ppStack_b8);
                in_stack_fffffe90 = (projectile_t *)0x424f86;
                (*grim_interface_ptr->vtable->grim_draw_quad)
                          ((IGrim2D *)in_stack_fffffe94,
                           (_camera_offset_y + (&creature_pool)[iVar4].pos_y) - (float)ppStack_b8,
                           (float)ppStack_13c,(float)ppStack_13c,(float)h);
                h = (projectile_t **)(iVar4 + 1);
                in_stack_fffffe98 = (projectile_t *)0x424f93;
                in_stack_fffffe9c = (projectile_t *)pos;
                in_stack_fffffea0 = ppStack_e4;
                iVar4 = creature_find_in_radius(pos,(float)ppStack_e4,(int)h);
              } while (iVar4 != -1);
            }
          }
        }
      }
    }
    pfVar2 = pfVar2 + 0x10;
    ppStack_14c = (projectile_t *)((int)ppStack_14c + 1);
  } while ((int)pfVar2 < 0x493ecc);
  self_00 = (IGrim2D *)0x424fd2;
  (*grim_interface_ptr->vtable->grim_end_batch)(pIVar24);
  pIVar20 = (IGrim2D *)0x1;
  uVar11 = 0x13;
  ppStack_a8 = (projectile_t *)
               ((float)(int)highscore_active_record.survival_elapsed_ms * 0.001 * 9.0);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,1,(uint)pIVar22);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar11);
  (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar20);
  ppStack_154 = (projectile_t *)0x0;
  pfVar2 = &projectile_pool.pos_y;
  do {
    if ((((projectile_t *)(pfVar2 + -3))->active != '\0') && (pfVar2[5] == 5.74532e-44)) {
      if (pfVar2[6] == 0.4) {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000030,(float)pIVar22);
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)((_camera_offset_x + pfVar2[-1]) - 30.0),
                   (_camera_offset_y + *pfVar2) - 30.0,60.0,60.0,(float)self_00);
        fVar6 = (float10)fsin((float10)pfVar2[-2] + (float10)1.5707964);
        fVar7 = (float10)fcos((float10)pfVar2[-2] + (float10)1.5707964);
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)
                   (float)((((float10)_camera_offset_x + (float10)pfVar2[-1]) - (float10)30.0) +
                          fVar7 * (float10)15.0),
                   (float)((((float10)_camera_offset_y + (float10)*pfVar2) - (float10)30.0) +
                          fVar6 * (float10)15.0),60.0,60.0,(float)pIVar24);
        fVar6 = (float10)fcos((float10)(int)ppVar19 + (float10)(float)ppStack_a8);
        fVar7 = (float10)fsin((float10)(float)((float10)(int)ppVar19 + (float10)(float)ppStack_a8));
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)
                   (float)(fVar6 * fVar6 +
                          (((float10)_camera_offset_x + (float10)pfVar2[-1]) - (float10)31.0)),
                   (float)((((float10)_camera_offset_y + (float10)*pfVar2) - (float10)31.0) +
                          fVar7 * (float10)11.0),52.0,52.0,(float)in_stack_fffffe84);
        fVar6 = (float10)fsin((float10)(float)ppStack_158 + (float10)2.0943952);
        fVar7 = (float10)fcos((float10)(float)ppStack_158 + (float10)2.0943952);
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)
                   (float)((((float10)_camera_offset_x + (float10)pfVar2[-1]) - (float10)31.0) +
                          fVar7 * (float10)10.0),
                   (float)fVar6 * 10.0 + ((_camera_offset_y + *pfVar2) - 31.0),62.0,62.0,
                   (float)in_stack_fffffe88);
        in_stack_fffffe88 = (projectile_t *)0x42780000;
        in_stack_fffffe84 = (projectile_t *)0x42780000;
        fVar6 = (float10)fsin((float10)(float)ppStack_154 + (float10)4.1887903);
        pIVar24 = (IGrim2D *)
                  (float)((((float10)_camera_offset_y + (float10)*pfVar2) - (float10)31.0) +
                         fVar6 * (float10)(float)in_stack_fffffea0);
        fVar6 = (float10)fcos((float10)(float)ppStack_154 + (float10)4.1887903);
        self_00 = (IGrim2D *)
                  (float)((((float10)_camera_offset_x + (float10)pfVar2[-1]) - (float10)31.0) +
                         fVar6 * (float10)10.0);
        pIVar22 = (IGrim2D *)0x425237;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  (self_00,(float)pIVar24,62.0,62.0,(float)ppVar13);
      }
      else {
        fVar21 = pfVar2[6] * 2.5;
        if (fVar21 <= 1.0) {
          if (fVar21 < 0.0) {
            fVar21 = 0.0;
          }
        }
        else {
          fVar21 = 1.0;
        }
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,fVar21 * in_stack_00000028,(float)pIVar22);
        pIVar22 = (IGrim2D *)((float)in_stack_fffffe94 * 40.0 + 32.0);
        fVar21 = (float)in_stack_fffffe94 * 20.0 + 16.0;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)((_camera_offset_x + pfVar2[-1]) - fVar21),
                   (_camera_offset_y + *pfVar2) - fVar21,(float)pIVar22,(float)pIVar22,
                   (float)self_00);
      }
    }
    pfVar2 = pfVar2 + 0x10;
    ppStack_154 = (projectile_t *)((int)ppStack_154 + 1);
  } while ((int)pfVar2 < 0x493ec4);
  (*grim_interface_ptr->vtable->grim_end_batch)(pIVar22);
  pIVar22 = (IGrim2D *)0x3f800000;
  fVar21 = 1.0;
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)self_00);
  uVar11 = 0x13;
  iVar4 = 5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)fVar21);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar11);
  (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,iVar4);
  effect_select_texture(0xd);
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000030,fVar21);
  fVar21 = 6.09118e-39;
  (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar22);
  ppVar13 = &projectile_pool;
  do {
    if (((ppVar13->active != '\0') && (ppVar14->type_id == 0x2d)) && (ppVar13->life_timer == 0.4)) {
      (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)ppVar13->angle,(float)self_00);
      fStack_c8 = _camera_offset_y + ppVar13->pos_y;
      self_00 = (IGrim2D *)0x42800000;
      ppStack_154 = (projectile_t *)((_camera_offset_x + ppVar13->pos_x) - 32.0);
      fVar21 = fStack_c8 - 32.0;
      (*grim_interface_ptr->vtable->grim_draw_quad)
                ((IGrim2D *)ppStack_154,fVar21,64.0,64.0,(float)pIVar24);
    }
    ppVar13 = ppVar13 + 1;
  } while ((int)ppVar13 < 0x493eb8);
  pIVar20 = (IGrim2D *)0x42545e;
  (*grim_interface_ptr->vtable->grim_end_batch)(self_00);
  uVar11 = 0x13;
  fVar18 = 7.00649e-45;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)fVar21);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar11);
  fVar12 = in_stack_00000020 * 0.9;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f4ccccd,0.8,0.8,fVar12,fVar18);
  ppVar19 = (projectile_t *)0x0;
  uVar11 = 0x4254d8;
  pIVar22 = DAT_0049bb30;
  (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0049bb30,0,(int)fVar21);
  ppVar13 = (projectile_t *)0x4254e6;
  (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar20);
  pfVar2 = &projectile_pool.pos_y;
  do {
    if (((((projectile_t *)(pfVar2 + -3))->active != '\0') && (pfVar2[6] == 0.4)) &&
       ((fVar21 = pfVar2[5], fVar21 != 1.26117e-44 &&
        ((fVar21 != 1.54143e-44 && (fVar21 != 2.66247e-44)))))) {
      (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)pfVar2[-2],(float)self_00);
      if (pfVar2[5] == 1.4013e-45) {
        fStack_c8 = _camera_offset_y + *pfVar2;
        self_00 = (IGrim2D *)0x40c00000;
        fVar21 = 6.0;
        pIVar1 = grim_interface_ptr->vtable;
        ppVar19 = (projectile_t *)((_camera_offset_x + pfVar2[-1]) - 3.0);
        ppVar13 = (projectile_t *)(fStack_c8 - 3.0);
        ppStack_154 = ppVar19;
      }
      else {
        ppVar14 = (projectile_t *)(_camera_offset_y + *pfVar2);
        if (pfVar2[5] == 5.60519e-45) {
          self_00 = (IGrim2D *)0x41000000;
          ppVar19 = (projectile_t *)((_camera_offset_x + pfVar2[-1]) - 4.0);
          pIVar1 = grim_interface_ptr->vtable;
          fVar21 = 8.0;
          ppVar13 = (projectile_t *)((float)ppVar14 - 4.0);
          ppStack_fc = ppVar19;
          ppStack_f8 = ppVar13;
          ppStack_b8 = ppVar14;
        }
        else {
          self_00 = (IGrim2D *)0x40800000;
          ppVar19 = (projectile_t *)((_camera_offset_x + pfVar2[-1]) - 2.0);
          pIVar1 = grim_interface_ptr->vtable;
          fVar21 = 4.0;
          ppVar13 = (projectile_t *)((float)ppVar14 - 2.0);
          ppStack_104 = ppVar19;
          ppStack_100 = ppVar13;
          ppStack_b0 = ppVar14;
        }
      }
      pIVar22 = (IGrim2D *)0x42563b;
      (*pIVar1->grim_draw_quad)
                ((IGrim2D *)ppVar19,(float)ppVar13,fVar21,(float)self_00,(float)pIVar24);
    }
    pfVar2 = pfVar2 + 0x10;
  } while ((int)pfVar2 < 0x493ec4);
  pIVar24 = (IGrim2D *)0x425658;
  (*grim_interface_ptr->vtable->grim_end_batch)(self_00);
  if (config_blob.reserved0[0x10] != '\0') {
    uVar11 = 0x13;
    iVar4 = 5;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)ppVar13);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar11);
    (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,iVar4);
    effect_select_texture(0xd);
    ppVar19 = (projectile_t *)0x4256c4;
    (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)ppVar13);
    pfVar2 = &secondary_projectile_pool.angle;
    do {
      if (((secondary_projectile_t *)(pfVar2 + -1))->active != '\0') {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000028 * 0.48,(float)pIVar24);
        pIVar24 = (IGrim2D *)0x430c0000;
        fVar6 = (float10)fcos((float10)*pfVar2 - (float10)1.5707964);
        ppStack_d0 = (projectile_t *)(float)fVar6;
        fVar6 = (float10)fsin((float10)*pfVar2 - (float10)1.5707964);
        ppStack_c0 = (projectile_t *)((float)ppStack_d0 * 5.0);
        ppStack_b4 = (projectile_t *)(_camera_offset_y + pfVar2[3]);
        ppStack_a8 = (projectile_t *)((_camera_offset_x + pfVar2[2]) - (float)ppStack_c0);
        ppStack_154 = (projectile_t *)
                      (float)(((float10)(float)ppStack_b4 - fVar6 * (float10)5.0) - (float10)70.0);
        ppVar19 = ppStack_154;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)((float)ppStack_a8 - 70.0),(float)ppStack_154,140.0,140.0,
                   (float)self_00);
      }
      pfVar2 = pfVar2 + 0xb;
    } while ((int)pfVar2 < 0x4965dc);
    ppVar13 = (projectile_t *)0x4257b9;
    (*grim_interface_ptr->vtable->grim_end_batch)(pIVar24);
    uVar11 = 0x14;
    pIVar22 = (IGrim2D *)0x6;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,(uint)ppVar19);
  }
  value = 0x13;
  fVar21 = 7.00649e-45;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,uVar11);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,value);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f4ccccd,0.8,0.8,fVar12,fVar21);
  (*grim_interface_ptr->vtable->grim_bind_texture)(projectile_texture,0,uVar11);
  (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x4,3,(int)pIVar22);
  ppVar14 = (projectile_t *)0x425859;
  (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)ppVar19);
  pfVar2 = &secondary_projectile_pool.pos_y;
  do {
    if ((((secondary_projectile_t *)(pfVar2 + -4))->active != '\0') && (pfVar2[3] != 4.2039e-45)) {
      ppVar14 = (projectile_t *)0x425884;
      (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)pfVar2[-3],(float)ppVar13);
      fVar21 = pfVar2[3];
      if (fVar21 == 1.4013e-45) {
        ppStack_d0 = (projectile_t *)(_camera_offset_y + *pfVar2);
        ppVar14 = (projectile_t *)((float)ppStack_d0 - 7.0);
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f4ccccd,0.8,0.8,fVar12,(float)pIVar24);
        pIVar24 = (IGrim2D *)0x41600000;
        ppVar13 = (projectile_t *)0x41600000;
        pIVar1 = grim_interface_ptr->vtable;
        ppVar19 = ppStack_154;
LAB_00425a07:
        (*pIVar1->grim_draw_quad)
                  ((IGrim2D *)ppVar14,(float)ppVar19,(float)ppVar13,(float)pIVar24,(float)self_00);
      }
      else if (fVar21 == 2.8026e-45) {
        ppStack_c0 = (projectile_t *)(_camera_offset_y + *pfVar2);
        ppStack_104 = (projectile_t *)((_camera_offset_x + pfVar2[-1]) - 5.0);
        ppStack_100 = (projectile_t *)((float)ppStack_c0 - 5.0);
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f4ccccd,0.8,0.8,fVar12,(float)pIVar24);
        pIVar24 = (IGrim2D *)0x41200000;
        ppVar13 = (projectile_t *)0x41200000;
        ppVar14 = ppStack_100;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)ppStack_100,(float)ppStack_fc,10.0,10.0,(float)self_00);
      }
      else if (fVar21 == 5.60519e-45) {
        ppStack_b8 = (projectile_t *)(_camera_offset_y + *pfVar2);
        ppStack_10c = (projectile_t *)((_camera_offset_x + pfVar2[-1]) - 4.0);
        ppStack_108 = (projectile_t *)((float)ppStack_b8 - 4.0);
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f4ccccd,0.8,0.8,fVar12,(float)pIVar24);
        pIVar24 = (IGrim2D *)0x41000000;
        ppVar13 = (projectile_t *)0x41000000;
        pIVar1 = grim_interface_ptr->vtable;
        ppVar14 = ppStack_108;
        ppVar19 = ppStack_104;
        goto LAB_00425a07;
      }
    }
    pfVar2 = pfVar2 + 0xb;
  } while ((int)pfVar2 < 0x4965e8);
  pIVar24 = (IGrim2D *)0x425a2b;
  (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)ppVar13);
  if (config_blob.reserved0[0x10] != '\0') {
    uVar11 = 0x13;
    iVar4 = 5;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)ppVar14);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar11);
    (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,iVar4);
    effect_select_texture(0xd);
    ppVar19 = (projectile_t *)0x425a96;
    (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)ppVar14);
    pfVar2 = &secondary_projectile_pool.pos_y;
    do {
      if (((secondary_projectile_t *)(pfVar2 + -4))->active != '\0') {
        fVar21 = pfVar2[3];
        if (fVar21 == 5.60519e-45) {
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f333333,0.7,1.0,in_stack_00000020 * 0.158,(float)pIVar24);
          pIVar24 = (IGrim2D *)0x41f00000;
          fVar21 = 30.0;
          fVar6 = (float10)fcos((float10)pfVar2[-3] - (float10)1.5707964);
          pIVar1 = grim_interface_ptr->vtable;
          ppStack_d8 = (projectile_t *)(float)fVar6;
          fVar6 = (float10)fsin((float10)pfVar2[-3] - (float10)1.5707964);
          fStack_c8 = (float)ppStack_d8 * 9.0;
          ppStack_bc = (projectile_t *)(_camera_offset_y + *pfVar2);
          ppStack_b0 = (projectile_t *)((_camera_offset_x + pfVar2[-1]) - fStack_c8);
          ppVar14 = (projectile_t *)((float)ppStack_b0 - 15.0);
          ppVar19 = (projectile_t *)
                    (float)(((float10)(float)ppStack_bc - fVar6 * (float10)9.0) - (float10)15.0);
LAB_00425d30:
          (*pIVar1->grim_draw_quad)
                    ((IGrim2D *)ppVar14,(float)ppVar19,fVar21,(float)pIVar24,(float)ppVar13);
        }
        else if (fVar21 == 1.4013e-45) {
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000020 * 0.68,(float)pIVar24);
          pIVar24 = (IGrim2D *)0x42700000;
          fVar6 = (float10)fcos((float10)pfVar2[-3] - (float10)1.5707964);
          fStack_48 = (float)fVar6;
          fVar6 = (float10)fsin((float10)pfVar2[-3] - (float10)1.5707964);
          fStack_58 = fStack_48 * 9.0;
          ppStack_64 = (projectile_t *)(_camera_offset_y + *pfVar2);
          fStack_50 = (_camera_offset_x + pfVar2[-1]) - fStack_58;
          ppStack_108 = (projectile_t *)(fStack_50 - 30.0);
          ppVar19 = (projectile_t *)
                    (float)(((float10)(float)ppStack_64 - fVar6 * (float10)9.0) - (float10)30.0);
          ppStack_104 = ppVar19;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)ppStack_108,(float)ppVar19,60.0,60.0,(float)ppVar13);
        }
        else if (fVar21 == 2.8026e-45) {
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000020 * 0.58,(float)pIVar24);
          pIVar24 = (IGrim2D *)0x42200000;
          fVar21 = 40.0;
          fVar6 = (float10)fcos((float10)pfVar2[-3] - (float10)1.5707964);
          pIVar1 = grim_interface_ptr->vtable;
          fStack_80 = (float)fVar6;
          fVar6 = (float10)fsin((float10)pfVar2[-3] - (float10)1.5707964);
          fStack_88 = fStack_80 * 9.0;
          fStack_6c = _camera_offset_y + *pfVar2;
          fStack_78 = (_camera_offset_x + pfVar2[-1]) - fStack_88;
          ppVar14 = (projectile_t *)(fStack_78 - 20.0);
          ppVar19 = (projectile_t *)
                    (float)(((float10)fStack_6c - fVar6 * (float10)9.0) - (float10)20.0);
          ppStack_110 = ppVar14;
          ppStack_10c = ppVar19;
          goto LAB_00425d30;
        }
      }
      pfVar2 = pfVar2 + 0xb;
    } while ((int)pfVar2 < 0x4965e8);
    (*grim_interface_ptr->vtable->grim_end_batch)(pIVar24);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,(uint)ppVar19);
  }
  return;
}



/* FUN_00425d80 @ 00425d80 */

int __cdecl FUN_00425d80(int param_1)

{
  float fVar1;
  float fVar2;
  creature_t *pcVar3;
  int iVar4;
  
  iVar4 = 0;
  pcVar3 = &creature_pool;
  do {
    if (pcVar3->active != '\0') {
      fVar1 = pcVar3->pos_x - (&creature_pool)[param_1].pos_x;
      fVar2 = pcVar3->pos_y - (&creature_pool)[param_1].pos_y;
      if (SQRT(fVar2 * fVar2 + fVar1 * fVar1) < 45.0) {
        if (((&creature_pool)[iVar4].collision_flag != '\0') &&
           ((&creature_pool)[param_1].health < 150.0)) {
          (&creature_pool)[param_1].collision_flag = '\x01';
        }
        if (((&creature_pool)[param_1].collision_flag != '\0') &&
           ((&creature_pool)[iVar4].health < 150.0)) {
          (&creature_pool)[iVar4].collision_flag = '\x01';
        }
        return iVar4;
      }
    }
    pcVar3 = pcVar3 + 1;
    iVar4 = iVar4 + 1;
  } while ((int)pcVar3 < 0x4aa338);
  return 0;
}



/* player_take_damage @ 00425e50 */

/* applies player damage with perk modifiers, SFX, and retaliation effects */

void __cdecl player_take_damage(int player_index,float damage)

{
  player_state_t *ppVar1;
  float *pos;
  float fVar2;
  float fVar3;
  bool bVar4;
  int iVar5;
  uint uVar6;
  creature_t *pcVar7;
  bool bVar8;
  float local_c;
  float local_8 [2];
  
  iVar5 = perk_count_get(perk_id_death_clock);
  if (iVar5 != 0) {
    return;
  }
  iVar5 = perk_count_get(perk_id_tough_reloader);
  if ((iVar5 != 0) && ((&player_health)[player_index]._pad0[0x2a4] != '\0')) {
    damage = damage * 0.5;
  }
  survival_reward_damage_seen = 1;
  local_c = 1.0;
  if (0.0 < *(float *)((&player_health)[player_index]._pad0 + 0x2f4)) {
    survival_reward_damage_seen = 1;
    return;
  }
  bVar8 = (float)player_health._pad0._0_4_ <= 0.0;
  iVar5 = perk_count_get(perk_id_thick_skinned);
  if (iVar5 != 0) {
    local_c = 0.666;
  }
  bVar4 = false;
  iVar5 = perk_count_get(perk_id_ninja);
  if (iVar5 == 0) {
    iVar5 = perk_count_get(perk_id_dodger);
    if ((iVar5 != 0) && (iVar5 = crt_rand(), iVar5 % 5 == 0)) {
      bVar4 = true;
      goto LAB_00425fa1;
    }
  }
  else {
    iVar5 = crt_rand();
    if (iVar5 % 3 == 0) {
      bVar4 = true;
      goto LAB_00425fa1;
    }
  }
  iVar5 = perk_count_get(perk_id_highlander);
  if (iVar5 == 0) {
    *(float *)(&player_health)[player_index]._pad0 =
         *(float *)(&player_health)[player_index]._pad0 - local_c * damage;
  }
  else {
    iVar5 = crt_rand();
    if (iVar5 % 10 == 0) {
      ppVar1 = &player_health + player_index;
      ppVar1->_pad0[0] = '\0';
      ppVar1->_pad0[1] = '\0';
      ppVar1->_pad0[2] = '\0';
      ppVar1->_pad0[3] = '\0';
    }
  }
LAB_00425fa1:
  if (0.0 <= *(float *)(&player_health)[player_index]._pad0) {
    iVar5 = crt_rand();
    sfx_play_panned((float)(iVar5 % 3 + sfx_trooper_inpain_01));
    if (bVar8) {
      return;
    }
  }
  else {
    (&player_death_timer)[player_index * 0xd8] =
         (float)(&player_death_timer)[player_index * 0xd8] - frame_dt * 28.0;
    if (bVar8) {
      return;
    }
    iVar5 = perk_count_get(perk_id_final_revenge);
    if (iVar5 == 0) {
      uVar6 = crt_rand();
      uVar6 = uVar6 & 0x80000001;
      if ((int)uVar6 < 0) {
        uVar6 = (uVar6 - 1 | 0xfffffffe) + 1;
      }
      sfx_play_panned((float)(uVar6 + sfx_trooper_die_01));
    }
    else {
      pos = (float *)(&player_pos_x + player_index * 0xd8);
      effect_spawn_explosion_burst(pos,1.8);
      bonus_spawn_guard = 1;
      iVar5 = 0;
      pcVar7 = &creature_pool;
      do {
        if ((((pcVar7->active != '\0') && (ABS(pcVar7->pos_x - *pos) <= 512.0)) &&
            (ABS(pcVar7->pos_y - (float)(&player_pos_y)[player_index * 0xd8]) <= 512.0)) &&
           (fVar2 = pcVar7->pos_x - *pos,
           fVar3 = pcVar7->pos_y - (float)(&player_pos_y)[player_index * 0xd8],
           fVar2 = 512.0 - SQRT(fVar2 * fVar2 + fVar3 * fVar3), 0.0 < fVar2)) {
          local_8[0] = 0.0;
          local_8[1] = 0.0;
          creature_apply_damage(iVar5,fVar2 * 5.0,3,local_8);
        }
        pcVar7 = pcVar7 + 1;
        iVar5 = iVar5 + 1;
      } while ((int)pcVar7 < 0x4aa338);
      bonus_spawn_guard = 0;
      sfx_play_panned(sfx_explosion_large);
      sfx_play_panned(sfx_shockwave);
    }
  }
  if (!bVar4) {
    iVar5 = perk_count_get(perk_id_unstoppable);
    if (iVar5 == 0) {
      iVar5 = crt_rand();
      *(float *)((&player_health)[player_index]._pad0 + 8) =
           (float)(iVar5 % 100 + -0x32) * 0.04 +
           *(float *)((&player_health)[player_index]._pad0 + 8);
      fVar2 = damage * 0.01 + *(float *)((&player_health)[player_index]._pad0 + 0x294);
      *(float *)((&player_health)[player_index]._pad0 + 0x294) = fVar2;
      if (0.48 < fVar2) {
        ppVar1 = &player_health + player_index;
        ppVar1->_pad0[0x294] = 0x8f;
        ppVar1->_pad0[0x295] = 0xc2;
        ppVar1->_pad0[0x296] = 0xf5;
        ppVar1->_pad0[0x297] = '>';
      }
    }
    if ((*(float *)(&player_health)[player_index]._pad0 <= 20.0) &&
       (iVar5 = crt_rand(), ((byte)iVar5 & 7) == 3)) {
      ppVar1 = &player_health + player_index;
      ppVar1->_pad0[0x2ec] = '\0';
      ppVar1->_pad0[0x2ed] = '\0';
      ppVar1->_pad0[0x2ee] = '\0';
      ppVar1->_pad0[0x2ef] = '\0';
    }
  }
  return;
}



/* creature_update_all @ 00426220 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* primary creature update loop: AI, movement, attacks, and animation phase */

void creature_update_all(void)

{
  float *pfVar1;
  uchar *puVar2;
  float *pfVar3;
  int *piVar4;
  float fVar5;
  undefined4 uVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  char cVar10;
  float10 fVar11;
  float10 fVar12;
  longlong lVar13;
  float *pfVar14;
  float fVar15;
  float *pfVar16;
  float fVar17;
  int local_7c;
  float local_78;
  float local_70;
  float local_6c;
  float local_60;
  float local_50 [12];
  float local_20;
  float local_1c;
  float local_18;
  float local_14;
  float local_10;
  float local_8;
  
  creature_update_tick = creature_update_tick + 1;
  creature_active_count = 0;
  local_7c = 0;
  do {
    if ((&creature_pool)[local_7c].active != '\0') {
      creature_active_count = creature_active_count + 1;
      if (0.0 < (&creature_pool)[local_7c].hit_flash_timer) {
        (&creature_pool)[local_7c].hit_flash_timer =
             (&creature_pool)[local_7c].hit_flash_timer - frame_dt;
      }
      if (_bonus_freeze_timer <= 0.0) {
        pfVar14 = &(&creature_pool)[local_7c].health;
        if (((&creature_pool)[local_7c].health <= 0.0) &&
           ((&creature_pool)[local_7c].hitbox_size == 16.0)) {
          (&creature_pool)[local_7c].hitbox_size = (&creature_pool)[local_7c].hitbox_size - frame_dt
          ;
        }
        if (((&creature_pool)[local_7c].flags & 2U) == 0) {
          if (((&creature_pool)[local_7c].flags & 1U) != 0) {
            fVar17 = frame_dt * 60.0;
            pfVar16 = local_50 + 2;
            local_50[2] = 0.0;
            local_50[3] = 0.0;
            goto LAB_0042634c;
          }
        }
        else {
          fVar17 = frame_dt * 180.0;
          pfVar16 = local_50;
          local_50[0] = 0.0;
          local_50[1] = 0.0;
LAB_0042634c:
          creature_apply_damage(local_7c,fVar17,0,pfVar16);
        }
        if (((&creature_pool)[local_7c].flags & 0x80) != 0) {
          iVar7 = (&creature_pool)[local_7c].link_index;
          if (iVar7 < 0) {
            iVar7 = iVar7 + frame_dt_ms;
            (&creature_pool)[local_7c].link_index = iVar7;
            if (-1 < iVar7) {
              uVar8 = crt_rand();
              (&creature_pool)[local_7c].ai_mode = 7;
              (&creature_pool)[local_7c].link_index = (uVar8 & 0x1ff) + 500;
            }
          }
          else {
            iVar7 = iVar7 - frame_dt_ms;
            (&creature_pool)[local_7c].link_index = iVar7;
            if (iVar7 < 1) {
              uVar8 = crt_rand();
              (&creature_pool)[local_7c].link_index = -700 - (uVar8 & 0x3ff);
            }
          }
        }
        if ((*pfVar14 <= 0.0) && ((&creature_pool)[local_7c].hitbox_size == 16.0)) {
          (&creature_pool)[local_7c].hitbox_size = (&creature_pool)[local_7c].hitbox_size - frame_dt
          ;
        }
        cVar10 = (char)(&creature_pool)[local_7c].target_player;
        iVar7 = (int)cVar10;
        pfVar16 = &(&creature_pool)[local_7c].pos_x;
        iVar9 = iVar7 * 0x360;
        fVar17 = (&player_pos_y)[iVar7 * 0xd8] - (&creature_pool)[local_7c].pos_y;
        local_78 = SQRT(fVar17 * fVar17 +
                        ((&player_pos_x)[iVar7 * 0xd8] - *pfVar16) *
                        ((&player_pos_x)[iVar7 * 0xd8] - *pfVar16));
        if (creature_update_tick % 0x46 != 0) {
          if (config_blob.reserved0._20_4_ == 2) {
            if ((0.0 < (float)(&player2_health)[iVar7 * -0xd8]) &&
               (fVar17 = *(float *)((&player_health)[-iVar7]._pad1 + 0x14) - *pfVar16,
               fVar15 = *(float *)((&player_health)[-iVar7]._pad1 + 0x18) -
                        (&creature_pool)[local_7c].pos_y,
               local_6c = SQRT(fVar15 * fVar15 + fVar17 * fVar17), local_6c < local_78)) {
              *(char *)&(&creature_pool)[local_7c].target_player = '\x01' - cVar10;
              local_78 = local_6c;
            }
          }
          else {
            fVar17 = player_pos_y - (&creature_pool)[local_7c].pos_y;
            local_6c = SQRT(fVar17 * fVar17 + (player_pos_x - *pfVar16) * (player_pos_x - *pfVar16))
            ;
          }
          cVar10 = (char)(&creature_pool)[local_7c].target_player;
          iVar7 = (int)cVar10;
          iVar9 = iVar7 * 0x360;
          fVar17 = player_pos_x -
                   (&creature_pool)[*(int *)((&player_health)[iVar7]._pad0 + 0x2fc)].pos_x;
          fVar15 = player_pos_y -
                   (&creature_pool)[*(int *)((&player_health)[iVar7]._pad0 + 0x2fc)].pos_y;
          if (local_6c < SQRT(fVar15 * fVar15 + fVar17 * fVar17)) {
            *(int *)((&player_health)[iVar7]._pad0 + 0x2fc) = local_7c;
          }
        }
        if (*(float *)(player_health._pad0 + iVar9) <= 0.0) {
          *(char *)&(&creature_pool)[local_7c].target_player = '\x01' - cVar10;
        }
        pfVar1 = &(&creature_pool)[local_7c].hitbox_size;
        if ((&creature_pool)[local_7c].hitbox_size == 16.0) {
          puVar2 = &(&creature_pool)[local_7c].collision_flag;
          if ((&creature_pool)[local_7c].collision_flag != '\0') {
            fVar17 = (&creature_pool)[local_7c].collision_timer - frame_dt;
            (&creature_pool)[local_7c].collision_timer = fVar17;
            if (fVar17 < 0.0) {
              (&creature_pool)[local_7c].state_flag = '\x01';
              (&creature_pool)[local_7c].collision_timer = fVar17 + 0.5;
              fVar17 = *pfVar14;
              *pfVar14 = fVar17 - 15.0;
              if (fVar17 - 15.0 < 0.0) {
                plaguebearer_infection_count = plaguebearer_infection_count + 1;
                creature_handle_death(local_7c,true);
                uVar8 = crt_rand();
                uVar8 = uVar8 & 0x80000001;
                if ((int)uVar8 < 0) {
                  uVar8 = (uVar8 - 1 | 0xfffffffe) + 1;
                }
                sfx_play_panned(*(float *)(&creature_type_sfx_b0 +
                                          (uVar8 + (&creature_pool)[local_7c].type_id * 0x11) * 4));
              }
              fx_queue_add_random(pfVar16);
            }
          }
          uVar6 = player_health._pad0._744_4_;
          fVar17 = (&creature_pool)[local_7c].phase_seed;
          *(undefined1 *)&(&creature_pool)[local_7c].force_target = 0;
          local_70 = 1.0;
          fVar17 = (float)(int)fVar17 * 3.7 * 3.1415927;
          if (local_7c != uVar6) {
            iVar7 = (&creature_pool)[local_7c].ai_mode;
            if (iVar7 == 0) {
              iVar7 = (int)(char)(&creature_pool)[local_7c].target_player;
              if (800.0 < local_78) {
LAB_0042676e:
                fVar15 = (&player_pos_y)[iVar7 * 0xd8];
                (&creature_pool)[local_7c].target_x = (&player_pos_x)[iVar7 * 0xd8];
                (&creature_pool)[local_7c].target_y = fVar15;
              }
              else {
                fVar11 = (float10)fcos((float10)fVar17);
                (&creature_pool)[local_7c].target_x =
                     (float)(fVar11 * (float10)local_78 * (float10)0.85 +
                            (float10)(&player_pos_x)[iVar7 * 0xd8]);
                fVar11 = (float10)fsin((float10)fVar17);
                (&creature_pool)[local_7c].target_y =
                     (float)(fVar11 * (float10)local_78 * (float10)0.85 +
                            (float10)(&player_pos_y)[iVar7 * 0xd8]);
              }
            }
            else if (iVar7 == 8) {
              fVar11 = (float10)fcos((float10)fVar17);
              iVar7 = (int)(char)(&creature_pool)[local_7c].target_player;
              (&creature_pool)[local_7c].target_x =
                   (float)(fVar11 * (float10)local_78 * (float10)0.9 +
                          (float10)(&player_pos_x)[iVar7 * 0xd8]);
              fVar11 = (float10)fsin((float10)fVar17);
              (&creature_pool)[local_7c].target_y =
                   (float)(fVar11 * (float10)local_78 * (float10)0.9 +
                          (float10)(&player_pos_y)[iVar7 * 0xd8]);
            }
            else if (iVar7 == 1) {
              iVar7 = (int)(char)(&creature_pool)[local_7c].target_player;
              if (800.0 < local_78) goto LAB_0042676e;
              fVar11 = (float10)fcos((float10)fVar17);
              (&creature_pool)[local_7c].target_x =
                   (float)(fVar11 * (float10)local_78 * (float10)0.55 +
                          (float10)(&player_pos_x)[iVar7 * 0xd8]);
              fVar11 = (float10)fsin((float10)fVar17);
              (&creature_pool)[local_7c].target_y =
                   (float)(fVar11 * (float10)local_78 * (float10)0.55 +
                          (float10)(&player_pos_y)[iVar7 * 0xd8]);
            }
            else if (iVar7 == 3) {
              iVar7 = (&creature_pool)[local_7c].link_index;
              if ((&creature_pool)[iVar7].health <= 0.0) {
                (&creature_pool)[local_7c].ai_mode = 0;
              }
              else {
                (&creature_pool)[local_7c].target_x =
                     (&creature_pool)[iVar7].pos_x + (&creature_pool)[local_7c].target_offset_x;
                (&creature_pool)[local_7c].target_y =
                     (&creature_pool)[iVar7].pos_y + (&creature_pool)[local_7c].target_offset_y;
              }
            }
            else if (iVar7 == 5) {
              iVar7 = (&creature_pool)[local_7c].link_index;
              if ((&creature_pool)[iVar7].health <= 0.0) {
                (&creature_pool)[local_7c].ai_mode = 0;
                local_50[4] = 0.0;
                local_50[5] = 0.0;
                creature_apply_damage(local_7c,1000.0,1,local_50 + 4);
              }
              else {
                (&creature_pool)[local_7c].target_x =
                     (&creature_pool)[iVar7].pos_x + (&creature_pool)[local_7c].target_offset_x;
                (&creature_pool)[local_7c].target_y =
                     (&creature_pool)[iVar7].pos_y + (&creature_pool)[local_7c].target_offset_y;
                fVar15 = (&creature_pool)[local_7c].target_x - *pfVar16;
                fVar5 = (&creature_pool)[local_7c].target_y - (&creature_pool)[local_7c].pos_y;
                fVar15 = SQRT(fVar15 * fVar15 + fVar5 * fVar5);
                if (fVar15 <= 64.0) {
                  local_70 = fVar15 * 0.015625;
                }
              }
            }
            iVar7 = (&creature_pool)[local_7c].ai_mode;
            if (iVar7 == 4) {
              if ((&creature_pool)[(&creature_pool)[local_7c].link_index].health <= 0.0) {
                (&creature_pool)[local_7c].ai_mode = 0;
                local_50[6] = 0.0;
                local_50[7] = 0.0;
                creature_apply_damage(local_7c,1000.0,1,local_50 + 6);
              }
              else {
                iVar7 = (int)(char)(&creature_pool)[local_7c].target_player;
                if (local_78 <= 800.0) {
                  fVar11 = (float10)fcos((float10)fVar17);
                  (&creature_pool)[local_7c].target_x =
                       (float)(fVar11 * (float10)local_78 * (float10)0.85 +
                              (float10)(&player_pos_x)[iVar7 * 0xd8]);
                  fVar11 = (float10)fsin((float10)fVar17);
                  (&creature_pool)[local_7c].target_y =
                       (float)(fVar11 * (float10)local_78 * (float10)0.85 +
                              (float10)(&player_pos_y)[iVar7 * 0xd8]);
                }
                else {
                  fVar17 = (&player_pos_y)[iVar7 * 0xd8];
                  (&creature_pool)[local_7c].target_x = (&player_pos_x)[iVar7 * 0xd8];
                  (&creature_pool)[local_7c].target_y = fVar17;
                }
              }
            }
            else if (iVar7 == 7) {
              uVar8 = (&creature_pool)[local_7c].flags & 0x80;
              if ((uVar8 == 0) || ((&creature_pool)[local_7c].link_index < 1)) {
                if (((&creature_pool)[local_7c].orbit_radius <= 0.0) || (uVar8 != 0)) {
LAB_00426ac8:
                  (&creature_pool)[local_7c].ai_mode = 0;
                }
                else {
                  fVar15 = (&creature_pool)[local_7c].orbit_radius - frame_dt;
                  fVar17 = (&creature_pool)[local_7c].pos_y;
                  (&creature_pool)[local_7c].target_x = *pfVar16;
                  (&creature_pool)[local_7c].target_y = fVar17;
                  (&creature_pool)[local_7c].orbit_radius = fVar15;
                }
              }
              else {
                fVar17 = (&creature_pool)[local_7c].pos_y;
                (&creature_pool)[local_7c].target_x = *pfVar16;
                (&creature_pool)[local_7c].target_y = fVar17;
              }
            }
            else if (iVar7 == 6) {
              iVar7 = (&creature_pool)[local_7c].link_index;
              if ((&creature_pool)[iVar7].health <= 0.0) goto LAB_00426ac8;
              fVar11 = (float10)(&creature_pool)[local_7c].orbit_angle +
                       (float10)(&creature_pool)[local_7c].heading;
              fVar12 = (float10)fcos(fVar11);
              (&creature_pool)[local_7c].target_x =
                   (float)(fVar12 * (float10)(&creature_pool)[local_7c].orbit_radius +
                          (float10)(&creature_pool)[iVar7].pos_x);
              fVar11 = (float10)fsin(fVar11);
              (&creature_pool)[local_7c].target_y =
                   (float)(fVar11 * (float10)(&creature_pool)[local_7c].orbit_radius +
                          (float10)(&creature_pool)[iVar7].pos_y);
            }
            fVar17 = (&creature_pool)[local_7c].target_x - *pfVar16;
            fVar15 = (&creature_pool)[local_7c].target_y - (&creature_pool)[local_7c].pos_y;
            if (SQRT(fVar17 * fVar17 + fVar15 * fVar15) < 40.0) {
              *(undefined1 *)&(&creature_pool)[local_7c].force_target = 1;
            }
            fVar17 = (&creature_pool)[local_7c].target_x - *pfVar16;
            fVar15 = (&creature_pool)[local_7c].target_y - (&creature_pool)[local_7c].pos_y;
            if (400.0 < SQRT(fVar17 * fVar17 + fVar15 * fVar15)) {
              *(undefined1 *)&(&creature_pool)[local_7c].force_target = 1;
            }
            if (((char)(&creature_pool)[local_7c].force_target != '\0') ||
               ((&creature_pool)[local_7c].ai_mode == 2)) {
              iVar7 = (int)(char)(&creature_pool)[local_7c].target_player;
              (&creature_pool)[local_7c].target_x = (&player_pos_x)[iVar7 * 0xd8];
              (&creature_pool)[local_7c].target_y = (&player_pos_y)[iVar7 * 0xd8];
            }
            fVar11 = (float10)fpatan((float10)(&creature_pool)[local_7c].target_y -
                                     (float10)(&creature_pool)[local_7c].pos_y,
                                     (float10)(&creature_pool)[local_7c].target_x -
                                     (float10)*pfVar16);
            (&creature_pool)[local_7c].target_heading = (float)(fVar11 + (float10)1.5707964);
            if (((0.0 < _bonus_energizer_timer) && ((&creature_pool)[local_7c].max_health < 500.0))
               || (*puVar2 != '\0')) {
              (&creature_pool)[local_7c].target_heading =
                   (float)(fVar11 + (float10)1.5707964 + (float10)3.1415927);
            }
            uVar8 = (&creature_pool)[local_7c].flags;
            if ((uVar8 & 4) == 0) {
              if ((&creature_pool)[local_7c].ai_mode != 7) {
                angle_approach(&(&creature_pool)[local_7c].heading,
                               (&creature_pool)[local_7c].target_heading,
                               (&creature_pool)[local_7c].move_speed * 0.33333334 * 4.0);
                fVar11 = (float10)(&creature_pool)[local_7c].heading - (float10)1.5707964;
                fVar12 = (float10)fcos(fVar11);
                (&creature_pool)[local_7c].vel_x =
                     (float)(fVar12 * (float10)frame_dt * (float10)local_70 *
                             (float10)(&creature_pool)[local_7c].move_speed * (float10)30.0);
                fVar11 = (float10)fsin(fVar11);
                (&creature_pool)[local_7c].vel_y =
                     (float)(fVar11 * (float10)frame_dt * (float10)local_70 *
                             (float10)(&creature_pool)[local_7c].move_speed * (float10)30.0);
                vec2_add_inplace(local_7c,pfVar16,&(&creature_pool)[local_7c].vel_x);
              }
            }
            else {
              if (*pfVar16 < (&creature_pool)[local_7c].size) {
                *pfVar16 = (&creature_pool)[local_7c].size;
              }
              if ((&creature_pool)[local_7c].pos_y < (&creature_pool)[local_7c].size) {
                (&creature_pool)[local_7c].pos_y = (&creature_pool)[local_7c].size;
              }
              fVar17 = 1024.0 - (&creature_pool)[local_7c].size;
              if (fVar17 < *pfVar16) {
                *pfVar16 = fVar17;
              }
              if (fVar17 < (&creature_pool)[local_7c].pos_y) {
                (&creature_pool)[local_7c].pos_y = fVar17;
              }
              if ((uVar8 & 0x40) == 0) {
                (&creature_pool)[local_7c].vel_y = 0.0;
                (&creature_pool)[local_7c].vel_x = 0.0;
              }
              else {
                angle_approach(&(&creature_pool)[local_7c].heading,
                               (&creature_pool)[local_7c].target_heading,
                               (&creature_pool)[local_7c].move_speed * 0.33333334 * 4.0);
                fVar11 = (float10)(&creature_pool)[local_7c].heading - (float10)1.5707964;
                fVar12 = (float10)fcos(fVar11);
                (&creature_pool)[local_7c].vel_x =
                     (float)(fVar12 * (float10)frame_dt * (float10)local_70 *
                             (float10)(&creature_pool)[local_7c].move_speed * (float10)30.0);
                fVar11 = (float10)fsin(fVar11);
                (&creature_pool)[local_7c].vel_y =
                     (float)(fVar11 * (float10)frame_dt * (float10)local_70 *
                             (float10)(&creature_pool)[local_7c].move_speed * (float10)30.0);
                vec2_add_inplace(local_7c,pfVar16,&(&creature_pool)[local_7c].vel_x);
              }
              iVar7 = (&creature_pool)[local_7c].link_index;
              fVar17 = (float)(&creature_spawn_slot_timer)[iVar7 * 6] - frame_dt;
              (&creature_spawn_slot_timer)[iVar7 * 6] = fVar17;
              if (fVar17 < 0.0) {
                (&creature_spawn_slot_timer)[iVar7 * 6] =
                     fVar17 + (float)(&creature_spawn_slot_interval)[iVar7 * 6];
                if ((int)(&creature_spawn_slot_count)[iVar7 * 6] <
                    (int)(&creature_spawn_slot_limit)[iVar7 * 6]) {
                  (&creature_spawn_slot_count)[iVar7 * 6] =
                       (&creature_spawn_slot_count)[iVar7 * 6] + 1;
                  creature_spawn_template
                            (*(int *)(&creature_spawn_slot_template + iVar7 * 0x18),pfVar16,-100.0);
                }
              }
            }
            iVar7 = perk_count_get(perk_id_plaguebearer);
            if ((iVar7 != 0) && (plaguebearer_infection_count < 0x3c)) {
              FUN_00425d80(local_7c);
            }
            fVar17 = 30.0 / (&creature_pool)[local_7c].size;
            if ((((&creature_pool)[local_7c].flags & 4U) == 0) ||
               (((&creature_pool)[local_7c].flags & 0x40U) != 0)) {
              if ((&creature_pool)[local_7c].ai_mode != 7) {
                fVar17 = *(float *)(&creature_type_anim_rate +
                                   (&creature_pool)[local_7c].type_id * 0x44) *
                         (&creature_pool)[local_7c].move_speed * frame_dt * fVar17 * local_70 * 25.0
                         + (&creature_pool)[local_7c].anim_phase;
                (&creature_pool)[local_7c].anim_phase = fVar17;
                while (31.0 < fVar17) {
                  fVar17 = (&creature_pool)[local_7c].anim_phase - 31.0;
                  (&creature_pool)[local_7c].anim_phase = fVar17;
                }
              }
            }
            else {
              fVar17 = *(float *)(&creature_type_anim_rate +
                                 (&creature_pool)[local_7c].type_id * 0x44) *
                       (&creature_pool)[local_7c].move_speed * frame_dt * fVar17 * local_70 * 22.0 +
                       (&creature_pool)[local_7c].anim_phase;
              (&creature_pool)[local_7c].anim_phase = fVar17;
              if (15.0 < fVar17) {
                fVar17 = (&creature_pool)[local_7c].anim_phase;
                do {
                  fVar17 = fVar17 - 15.0;
                } while (15.0 < fVar17);
                (&creature_pool)[local_7c].anim_phase = fVar17;
              }
            }
            pfVar3 = &(&creature_pool)[local_7c].attack_cooldown;
            if ((&creature_pool)[local_7c].attack_cooldown <= 0.0) {
              *pfVar3 = 0.0;
            }
            else {
              *pfVar3 = *pfVar3 - frame_dt;
            }
            iVar7 = (int)(char)(&creature_pool)[local_7c].target_player;
            piVar4 = &(&creature_pool)[local_7c].target_player;
            fVar17 = (&creature_pool)[local_7c].pos_y - (&player_pos_y)[iVar7 * 0xd8];
            fVar17 = SQRT((*pfVar16 - (&player_pos_x)[iVar7 * 0xd8]) *
                          (*pfVar16 - (&player_pos_x)[iVar7 * 0xd8]) + fVar17 * fVar17);
            if ((((fVar17 < 100.0) && (iVar7 = perk_count_get(perk_id_radioactive), iVar7 != 0)) &&
                (fVar15 = (&creature_pool)[local_7c].collision_timer - frame_dt * 1.5,
                (&creature_pool)[local_7c].collision_timer = fVar15, fVar15 < 0.0)) &&
               (0.0 < *pfVar14)) {
              (&creature_pool)[local_7c].collision_timer = 0.5;
              (&creature_pool)[local_7c].state_flag = '\x01';
              fVar15 = *pfVar14 - (100.0 - fVar17) * 0.3;
              *pfVar14 = fVar15;
              if (fVar15 < 0.0) {
                if ((&creature_pool)[local_7c].type_id == 1) {
                  *pfVar14 = 1.0;
                }
                else {
                  lVar13 = __ftol();
                  player_health._pad0._136_4_ = SUB84(lVar13,0);
                  *pfVar1 = *pfVar1 - frame_dt;
                }
              }
              fx_queue_add_random(pfVar16);
            }
            if (64.0 < fVar17) {
              if ((((&creature_pool)[local_7c].flags & 0x10) != 0) && (*pfVar3 <= 0.0)) {
                projectile_spawn(pfVar16,(&creature_pool)[local_7c].heading,9,local_7c);
                fVar15 = sfx_shock_fire;
                *pfVar3 = *pfVar3 + 1.0;
                sfx_play_panned(fVar15);
              }
              if ((((&creature_pool)[local_7c].flags & 0x100U) != 0) && (*pfVar3 <= 0.0)) {
                projectile_spawn(pfVar16,(&creature_pool)[local_7c].heading,
                                 (int)(&creature_pool)[local_7c].orbit_radius,local_7c);
                uVar8 = crt_rand();
                fVar15 = sfx_plasmaminigun_fire;
                local_60 = (float)(uVar8 & 3);
                *pfVar3 = (float)(int)local_60 * 0.1 + (&creature_pool)[local_7c].orbit_angle +
                          *pfVar3;
                sfx_play_panned(fVar15);
              }
            }
            if (fVar17 < 20.0) {
              *pfVar16 = *pfVar16 - (&creature_pool)[local_7c].vel_x;
              (&creature_pool)[local_7c].pos_y =
                   (&creature_pool)[local_7c].pos_y - (&creature_pool)[local_7c].vel_y;
              if (((&creature_pool)[local_7c].max_health < 380.0) && (0.0 < _bonus_energizer_timer))
              {
                lVar13 = __ftol();
                player_health._pad0._136_4_ = SUB84(lVar13,0);
                effect_spawn_burst(pfVar16,6);
                sfx_play_panned(sfx_ui_bonus);
                bonus_spawn_guard = 1;
                creature_handle_death(local_7c,false);
                bonus_spawn_guard = 0;
              }
            }
            if (16.0 < (&creature_pool)[local_7c].size) {
              if (30.0 <= fVar17) goto LAB_004276d6;
              if ((0.0 < *(float *)(&player_health)[(char)*piVar4]._pad0) &&
                 (_bonus_energizer_timer <= 0.0)) {
                if (*pfVar3 <= 0.0) {
                  uVar8 = crt_rand();
                  uVar8 = uVar8 & 0x80000001;
                  if ((int)uVar8 < 0) {
                    uVar8 = (uVar8 - 1 | 0xfffffffe) + 1;
                  }
                  sfx_play_panned(*(float *)(&creature_type_sfx_b0 +
                                            (uVar8 + (&creature_pool)[local_7c].type_id * 0x11) * 4)
                                 );
                  iVar7 = perk_count_get(perk_id_mr_melee);
                  if (iVar7 != 0) {
                    local_50[8] = 0.0;
                    local_50[9] = 0.0;
                    creature_apply_damage(local_7c,25.0,2,local_50 + 8);
                  }
                  if (*(float *)((&player_health)[(char)*piVar4]._pad0 + 0x2f4) <= 0.0) {
                    iVar7 = perk_count_get(perk_id_toxic_avenger);
                    if (iVar7 == 0) {
                      iVar7 = perk_count_get(perk_id_veins_of_poison);
                      if (iVar7 == 0) goto LAB_0042733a;
                      uVar8 = (&creature_pool)[local_7c].flags | 1;
                    }
                    else {
                      uVar8 = (&creature_pool)[local_7c].flags | 3;
                    }
                    (&creature_pool)[local_7c].flags = uVar8;
                  }
LAB_0042733a:
                  player_take_damage((int)(char)*piVar4,(&creature_pool)[local_7c].contact_damage);
                  thunk_FUN_00452f1d();
                  local_50[9] = (float)puVar2 * 3.0 + (&player_pos_y)[(char)*piVar4 * 0xd8];
                  local_50[8] = local_60 * 3.0 + (&player_pos_x)[(char)*piVar4 * 0xd8];
                  fx_queue_add_random(local_50 + 8);
                  *pfVar3 = *pfVar3 + 1.0;
                }
                if ((((&player_plaguebearer_active)[(char)*piVar4 * 0x360] != '\0') &&
                    (*pfVar14 < 150.0)) && (plaguebearer_infection_count < 0x32)) {
                  *puVar2 = '\x01';
                }
              }
            }
            if ((fVar17 < 30.0) && ((&creature_pool)[local_7c].size <= 30.0)) {
              *pfVar14 = 0.0;
              *pfVar1 = *pfVar1 - frame_dt;
            }
          }
        }
        else if (*pfVar1 <= 0.0) {
          *pfVar1 = *pfVar1 - frame_dt * 20.0;
        }
        else {
          fVar17 = *pfVar1 - frame_dt * 28.0;
          *pfVar1 = fVar17;
          if (0.0 < fVar17) {
            if ((((&creature_pool)[local_7c].flags & 4U) == 0) ||
               (((&creature_pool)[local_7c].flags & 0x40U) != 0)) {
              fVar11 = (float10)(&creature_pool)[local_7c].heading - (float10)1.5707964;
              fVar12 = (float10)fcos(fVar11);
              (&creature_pool)[local_7c].vel_x =
                   (float)(fVar12 * (float10)fVar17 * (float10)frame_dt * (float10)9.0);
              fVar11 = (float10)fsin(fVar11);
              (&creature_pool)[local_7c].vel_y =
                   (float)(fVar11 * (float10)fVar17 * (float10)frame_dt * (float10)9.0);
              *pfVar16 = *pfVar16 - (&creature_pool)[local_7c].vel_x;
              (&creature_pool)[local_7c].pos_y =
                   (&creature_pool)[local_7c].pos_y - (&creature_pool)[local_7c].vel_y;
            }
            else {
              (&creature_pool)[local_7c].vel_x = 0.0;
              (&creature_pool)[local_7c].vel_y = 0.0;
            }
          }
          else {
            if (config_blob.fx_toggle == '\0') {
              if ((((&creature_pool)[local_7c].flags & 4U) == 0) ||
                 (((&creature_pool)[local_7c].flags & 0x40U) != 0)) {
                local_8 = (&creature_pool)[local_7c].size * 0.5;
                iVar7 = (&creature_pool)[local_7c].type_id;
                fVar17 = (&creature_pool)[local_7c].size;
                fVar15 = (&creature_pool)[local_7c].heading;
                local_18 = *pfVar16 - local_8;
                pfVar14 = &local_18;
                local_14 = (&creature_pool)[local_7c].pos_y - local_8;
              }
              else {
                local_10 = (&creature_pool)[local_7c].size * 0.5;
                fVar17 = (&creature_pool)[local_7c].size;
                fVar15 = (&creature_pool)[local_7c].heading;
                iVar7 = 7;
                local_20 = *pfVar16 - local_10;
                pfVar14 = &local_20;
                local_1c = (&creature_pool)[local_7c].pos_y - local_10;
              }
              iVar7 = fx_queue_add_rotated
                                (pfVar14,&(&creature_pool)[local_7c].tint_r,fVar15,fVar17,iVar7);
              if ((char)iVar7 == '\0') {
                *pfVar1 = 0.001;
                goto LAB_004276d6;
              }
            }
            highscore_active_record.creature_kill_count =
                 highscore_active_record.creature_kill_count + 1;
            if ((config_blob.fx_toggle == '\0') && (((&creature_pool)[local_7c].flags & 4) != 0)) {
              iVar7 = 8;
              do {
                fVar17 = 0.0;
                iVar9 = crt_rand();
                effect_spawn_blood_splatter(pfVar16,(float)(iVar9 % 0x264) * 0.01,fVar17);
                iVar7 = iVar7 + -1;
              } while (iVar7 != 0);
              iVar7 = 6;
              do {
                fVar17 = -0.07;
                iVar9 = crt_rand();
                effect_spawn_blood_splatter(pfVar16,(float)(iVar9 % 0x264) * 0.01,fVar17);
                iVar7 = iVar7 + -1;
              } while (iVar7 != 0);
              iVar7 = 5;
              do {
                fVar17 = -0.12;
                iVar9 = crt_rand();
                effect_spawn_blood_splatter(pfVar16,(float)(iVar9 % 0x264) * 0.01,fVar17);
                iVar7 = iVar7 + -1;
              } while (iVar7 != 0);
            }
            if (*(float *)((int)cv_bodiesFade + 0xc) == 0.0) {
              (&creature_pool)[local_7c].active = '\0';
            }
          }
        }
      }
    }
LAB_004276d6:
    local_7c = local_7c + 1;
    if (0x17f < local_7c) {
      return;
    }
  } while( true );
}



/* fx_queue_add_random @ 00427700 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* spawns a random fx_queue_add entry (effect ids 3..7) with grayscale color/size */

void __cdecl fx_queue_add_random(float *pos)

{
  uint uVar1;
  int iVar2;
  float *pos_00;
  float w;
  float h;
  float rotation;
  float *rgba;
  float local_8;
  float local_4;
  
  if (config_blob.fx_toggle == '\0') {
    if ((DAT_004912b0 & 1) == 0) {
      DAT_004912b0 = DAT_004912b0 | 1;
      _fx_queue_random_color_r = 0.9;
      _fx_queue_random_color_g = 0.9;
      _fx_queue_random_color_b = 0.9;
      _fx_queue_random_color_a = 0x3f47ae14;
      crt_atexit(&DAT_00427830);
    }
    uVar1 = crt_rand();
    _fx_queue_random_color_r = (float)(uVar1 & 0xf) * 0.01 + 0.84;
    _fx_queue_random_color_g = _fx_queue_random_color_r;
    _fx_queue_random_color_b = _fx_queue_random_color_r;
    iVar2 = crt_rand();
    w = (float)(iVar2 % 0x18 + -0xc) + 30.0;
    iVar2 = crt_rand();
    rgba = (float *)&fx_queue_random_color_r;
    rotation = (float)(iVar2 % 0x274) * 0.01;
    local_8 = *pos - w * 0.5;
    local_4 = pos[1] - w * 0.5;
    pos_00 = &local_8;
    h = w;
    iVar2 = crt_rand();
    fx_queue_add(iVar2 % 5 + 3,pos_00,w,h,rotation,rgba);
  }
  return;
}



/* fx_queue_add_rotated @ 00427840 */

/* pushes a rotated sprite into DAT_004aaf3c (capped at 0x40); returns 1 on success */

int __cdecl fx_queue_add_rotated(float *pos,float *rgba,float rotation,float scale,int effect_id)

{
  undefined4 in_EAX;
  float fVar1;
  uint3 uVar2;
  
  uVar2 = (uint3)((uint)in_EAX >> 8);
  fVar1 = (float)CONCAT31(uVar2,terrain_texture_failed);
  if (terrain_texture_failed == '\0') {
    if (fx_queue_rotated == 0x3f) {
      return (uint)uVar2 << 8;
    }
    (&fx_rotated_color_r)[fx_queue_rotated * 4] = *rgba;
    (&fx_rotated_color_g)[fx_queue_rotated * 4] = rgba[1];
    (&fx_rotated_color_b)[fx_queue_rotated * 4] = rgba[2];
    (&fx_rotated_color_a)[fx_queue_rotated * 4] = rgba[3];
    if (*(float *)((int)cv_terrainBodiesTransparency + 0xc) == 0.0) {
      fVar1 = (float)(&fx_rotated_color_a)[fx_queue_rotated * 4] * 0.8;
    }
    else {
      fVar1 = (1.0 / *(float *)((int)cv_terrainBodiesTransparency + 0xc)) *
              (float)(&fx_rotated_color_a)[fx_queue_rotated * 4];
    }
    (&fx_rotated_color_a)[fx_queue_rotated * 4] = fVar1;
    (&fx_rotated_rotation)[fx_queue_rotated] = rotation;
    (&fx_rotated_effect_id)[fx_queue_rotated] = effect_id;
    (&fx_rotated_scale)[fx_queue_rotated] = scale;
    (&fx_rotated_pos_x)[fx_queue_rotated * 2] = *pos;
    fVar1 = pos[1];
    (&fx_rotated_pos_y)[fx_queue_rotated * 2] = fVar1;
    fx_queue_rotated = fx_queue_rotated + 1;
    if (0x3f < fx_queue_rotated) {
      fx_queue_rotated = 0x3f;
    }
  }
  return CONCAT31((int3)((uint)fVar1 >> 8),1);
}



/* fx_queue_render @ 00427920 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* bakes FX queues (DAT_004aaf18/DAT_004aaf3c) into the ground render target (terrain_render_target)
   and clears them */

void fx_queue_render(void)

{
  int iVar1;
  float unaff_EBX;
  IGrim2D *unaff_EBP;
  float *pfVar2;
  float unaff_ESI;
  int iVar3;
  float unaff_EDI;
  float *pfVar4;
  IGrim2D *self;
  uint uVar5;
  IGrim2D *pIVar6;
  IGrim2D *pIVar7;
  float fVar8;
  float v1;
  float a;
  float radians;
  IGrim2D *pIVar9;
  IGrim2D *in_stack_ffffffe8;
  float fStack_14;
  float fStack_10;
  float fStack_c;
  float fStack_8;
  
  pIVar9 = (IGrim2D *)(1.0 / (float)config_blob.reserved0._112_4_);
  fVar8 = 1.0 / (((float)terrain_texture_width / (float)config_blob.reserved0._112_4_) * 0.5);
  if (terrain_texture_failed == '\0') {
    if ((fx_queue_rotated != 0) || (fx_queue_count != 0)) {
      (*grim_interface_ptr->vtable->grim_set_render_target)(terrain_render_target,(int)unaff_EDI);
      (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,(int)unaff_ESI);
      if (0 < fx_queue_count) {
        (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_EBP);
        (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,unaff_EBX);
        iVar3 = 0;
        if (0 < fx_queue_count) {
          pfVar2 = &fx_queue.rotation;
          do {
            (*grim_interface_ptr->vtable->grim_set_color_ptr)
                      ((IGrim2D *)(pfVar2 + 5),(float *)pIVar9);
            (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)*pfVar2,fVar8);
            effect_select_texture(((fx_queue_entry_t *)(pfVar2 + -1))->effect_id);
            fVar8 = fStack_8 * pfVar2[3];
            pIVar9 = (IGrim2D *)(fStack_8 * pfVar2[4]);
            (*grim_interface_ptr->vtable->grim_draw_quad)
                      ((IGrim2D *)((pfVar2[1] - pfVar2[4] * 0.5) * fStack_8),
                       (pfVar2[2] - pfVar2[3] * 0.5) * fStack_8,(float)pIVar9,fVar8,
                       (float)in_stack_ffffffe8);
            iVar3 = iVar3 + 1;
            pfVar2 = pfVar2 + 10;
          } while (iVar3 < fx_queue_count);
        }
        (*grim_interface_ptr->vtable->grim_end_batch)(pIVar9);
      }
      if (0 < fx_queue_rotated) {
        pIVar7 = (IGrim2D *)0x0;
        pIVar9 = bodyset_texture;
        (*grim_interface_ptr->vtable->grim_bind_texture)(bodyset_texture,0,(int)fVar8);
        uVar5 = 0x13;
        pIVar6 = (IGrim2D *)0x1;
        (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,1,(uint)pIVar9);
        (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar5);
        (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar6);
        iVar3 = 0;
        if (0 < fx_queue_rotated) {
          pfVar2 = (float *)&fx_rotated_pos_x;
          pfVar4 = (float *)&fx_rotated_color_b;
          do {
            iVar1 = *(int *)(&creature_type_corpse_frame + (&fx_rotated_effect_id)[iVar3] * 0x44);
            DAT_004965d8 = (float)(&effect_uv4_u)[iVar1 * 2];
            DAT_004965dc = (float)(&effect_uv4_v)[iVar1 * 2];
            _DAT_004965e0 = (float)(&effect_uv4_u)[iVar1 * 2] + 0.25;
            _DAT_004965e4 = (float)(&effect_uv4_v)[iVar1 * 2] + 0.25;
            (*grim_interface_ptr->vtable->grim_set_uv)
                      ((IGrim2D *)DAT_004965d8,DAT_004965dc,_DAT_004965e0,_DAT_004965e4,
                       (float)pIVar6);
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)pfVar4[-2],pfVar4[-1],*pfVar4,pfVar4[1] * 0.5,(float)pIVar9);
            (*grim_interface_ptr->vtable->grim_set_rotation)
                      ((IGrim2D *)((float)(&fx_rotated_rotation)[iVar3] - 1.5707964),(float)pIVar7);
            DAT_004965d8 = *pfVar2 - 0.5;
            DAT_004965dc = pfVar2[1] - 0.5;
            pIVar9 = (IGrim2D *)(fStack_c * (float)(&fx_rotated_scale)[iVar3] * 1.064);
            pIVar6 = (IGrim2D *)(DAT_004965dc * fStack_c - fStack_8);
            pIVar7 = pIVar9;
            (*grim_interface_ptr->vtable->grim_draw_quad)
                      ((IGrim2D *)(DAT_004965d8 * fStack_c - fStack_8),(float)pIVar6,(float)pIVar9,
                       (float)pIVar9,fVar8);
            iVar3 = iVar3 + 1;
            pfVar4 = pfVar4 + 4;
            pfVar2 = pfVar2 + 2;
          } while (iVar3 < fx_queue_rotated);
        }
        fVar8 = 6.106934e-39;
        (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_ffffffe8);
        uVar5 = 0x13;
        pIVar9 = (IGrim2D *)0x5;
        (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)pIVar7);
        v1 = 2.8026e-44;
        a = 8.40779e-45;
        (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar5);
        radians = 6.107021e-39;
        (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar9);
        iVar3 = 0;
        if (0 < fx_queue_rotated) {
          pfVar2 = (float *)&fx_rotated_pos_x;
          pfVar4 = (float *)&fx_rotated_color_b;
          do {
            iVar1 = *(int *)(&creature_type_corpse_frame + (&fx_rotated_effect_id)[iVar3] * 0x44);
            DAT_004965d8 = (float)(&effect_uv4_u)[iVar1 * 2];
            DAT_004965dc = (float)(&effect_uv4_v)[iVar1 * 2];
            _DAT_004965e0 = (float)(&effect_uv4_u)[iVar1 * 2] + 0.25;
            _DAT_004965e4 = (float)(&effect_uv4_v)[iVar1 * 2] + 0.25;
            (*grim_interface_ptr->vtable->grim_set_uv)
                      ((IGrim2D *)DAT_004965d8,DAT_004965dc,_DAT_004965e0,_DAT_004965e4,v1);
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)pfVar4[-2],pfVar4[-1],*pfVar4,pfVar4[1],a);
            (*grim_interface_ptr->vtable->grim_set_rotation)
                      ((IGrim2D *)((float)(&fx_rotated_rotation)[iVar3] - 1.5707964),radians);
            a = fStack_14 * (float)(&fx_rotated_scale)[iVar3];
            v1 = fStack_14 * pfVar2[1] - fStack_10;
            radians = a;
            (*grim_interface_ptr->vtable->grim_draw_quad)
                      ((IGrim2D *)(fStack_14 * *pfVar2 - fStack_10),v1,a,a,(float)pIVar9);
            iVar3 = iVar3 + 1;
            pfVar4 = pfVar4 + 4;
            pfVar2 = pfVar2 + 2;
          } while (iVar3 < fx_queue_rotated);
        }
        (*grim_interface_ptr->vtable->grim_end_batch)(pIVar7);
      }
      fx_queue_count = 0;
      fx_queue_rotated = 0;
      (*grim_interface_ptr->vtable->grim_set_render_target)((IGrim2D *)0xffffffff,(int)fVar8);
    }
  }
  else if (0 < fx_queue_rotated) {
    fVar8 = 0.0;
    pIVar9 = bodyset_texture;
    (*grim_interface_ptr->vtable->grim_bind_texture)(bodyset_texture,0,(int)unaff_EDI);
    uVar5 = 0x13;
    pIVar7 = (IGrim2D *)0x1;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,1,(uint)pIVar9);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar5);
    pIVar6 = (IGrim2D *)0x4279c2;
    (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar7);
    iVar3 = 0;
    if (0 < fx_queue_rotated) {
      pfVar2 = (float *)&fx_rotated_pos_x;
      pfVar4 = (float *)&fx_rotated_color_b;
      do {
        iVar1 = *(int *)(&creature_type_corpse_frame + (&fx_rotated_effect_id)[iVar3] * 0x44);
        DAT_004965d8 = (float)(&effect_uv4_u)[iVar1 * 2];
        DAT_004965dc = (float)(&effect_uv4_v)[iVar1 * 2];
        _DAT_004965e0 = (float)(&effect_uv4_u)[iVar1 * 2] + 0.25;
        _DAT_004965e4 = (float)(&effect_uv4_v)[iVar1 * 2] + 0.25;
        (*grim_interface_ptr->vtable->grim_set_uv)
                  ((IGrim2D *)DAT_004965d8,DAT_004965dc,_DAT_004965e0,_DAT_004965e4,(float)pIVar9);
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)pfVar4[-2],pfVar4[-1],*pfVar4,pfVar4[1] * 0.5,fVar8);
        (*grim_interface_ptr->vtable->grim_set_rotation)
                  ((IGrim2D *)((float)(&fx_rotated_rotation)[iVar3] - 1.5707964),unaff_EDI);
        DAT_004965d8 = *pfVar2 + 2.0;
        DAT_004965dc = pfVar2[1] + 2.0;
        fVar8 = (float)(&fx_rotated_scale)[iVar3] * 1.04;
        pIVar9 = (IGrim2D *)(DAT_004965dc + _camera_offset_y);
        pIVar6 = (IGrim2D *)0x427b16;
        unaff_EDI = fVar8;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)(DAT_004965d8 + _camera_offset_x),(float)pIVar9,fVar8,fVar8,unaff_ESI)
        ;
        iVar3 = iVar3 + 1;
        pfVar4 = pfVar4 + 4;
        pfVar2 = pfVar2 + 2;
      } while (iVar3 < fx_queue_rotated);
    }
    pIVar7 = (IGrim2D *)0x427b38;
    (*grim_interface_ptr->vtable->grim_end_batch)(pIVar9);
    uVar5 = 0x13;
    self = (IGrim2D *)0x5;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)pIVar6);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar5);
    (*grim_interface_ptr->vtable->grim_begin_batch)(self);
    iVar3 = 0;
    if (0 < fx_queue_rotated) {
      pfVar2 = (float *)&fx_rotated_pos_x;
      pfVar4 = (float *)&fx_rotated_color_b;
      do {
        iVar1 = *(int *)(&creature_type_corpse_frame + (&fx_rotated_effect_id)[iVar3] * 0x44);
        DAT_004965d8 = (float)(&effect_uv4_u)[iVar1 * 2];
        DAT_004965dc = (float)(&effect_uv4_v)[iVar1 * 2];
        _DAT_004965e0 = (float)(&effect_uv4_u)[iVar1 * 2] + 0.25;
        _DAT_004965e4 = (float)(&effect_uv4_v)[iVar1 * 2] + 0.25;
        (*grim_interface_ptr->vtable->grim_set_uv)
                  ((IGrim2D *)DAT_004965d8,DAT_004965dc,_DAT_004965e0,_DAT_004965e4,(float)pIVar6);
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)pfVar4[-2],pfVar4[-1],*pfVar4,pfVar4[1],(float)pIVar7);
        (*grim_interface_ptr->vtable->grim_set_rotation)
                  ((IGrim2D *)((float)(&fx_rotated_rotation)[iVar3] - 1.5707964),(float)pIVar9);
        pIVar7 = (IGrim2D *)(&fx_rotated_scale)[iVar3];
        pIVar6 = (IGrim2D *)(_camera_offset_y + pfVar2[1]);
        pIVar9 = pIVar7;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)(_camera_offset_x + *pfVar2),(float)pIVar6,(float)pIVar7,(float)pIVar7
                   ,fVar8);
        iVar3 = iVar3 + 1;
        pfVar4 = pfVar4 + 4;
        pfVar2 = pfVar2 + 2;
      } while (iVar3 < fx_queue_rotated);
    }
    (*grim_interface_ptr->vtable->grim_end_batch)(pIVar6);
    return;
  }
  return;
}



/* creature_alloc_slot @ 00428140 */

/* finds a free creature entry in DAT_0049bf38 and seeds defaults */

int creature_alloc_slot(void)

{
  creature_t *pcVar1;
  uint uVar2;
  int iVar3;
  
  iVar3 = 0;
  pcVar1 = &creature_pool;
  do {
    if (pcVar1->active == '\0') {
      (&creature_pool)[iVar3].flags = 0;
      uVar2 = crt_rand();
      (&creature_pool)[iVar3].phase_seed = (float)(uVar2 & 0x17f);
      pcVar1 = &creature_pool + iVar3;
      pcVar1->_pad3[0] = '\0';
      pcVar1->_pad3[1] = '\0';
      pcVar1->_pad3[2] = '\0';
      pcVar1->_pad3[3] = '\0';
      (&creature_pool)[iVar3].anim_phase = 0.0;
      creature_spawned_count = creature_spawned_count + 1;
      return iVar3;
    }
    pcVar1 = pcVar1 + 1;
    iVar3 = iVar3 + 1;
  } while ((int)pcVar1 < 0x4aa338);
  if (*(float *)((int)cv_verbose + 0xc) != 0.0) {
    console_printf(&console_log_queue,s_No_free_creatures_to_spawn__00473e6c);
  }
  return 0x180;
}



/* FUN_004281e0 @ 004281e0 */

/* [binja] void* sub_4281e0() */

void * FUN_004281e0(void)

{
  int *piVar1;
  
  piVar1 = &creature_pool.flags;
  do {
    ((creature_t *)(piVar1 + -0x23))->active = 0;
    if ((*piVar1 & 4) != 0) {
      (&creature_spawn_slot_owner)[piVar1[-5] * 6] = 0;
    }
    piVar1 = piVar1 + 0x26;
  } while ((int)piVar1 < 0x4aa3c4);
  return piVar1;
}



/* creatures_none_active @ 00428210 */

/* returns low byte 1 when no active creature entries exist (0 otherwise); sets DAT_0048700c */

uint creatures_none_active(void)

{
  creature_t *pcVar1;
  
  pcVar1 = &creature_pool;
  do {
    if (pcVar1->active != '\0') {
      creatures_any_active_flag = 0;
      return (uint)pcVar1 & 0xffffff00;
    }
    pcVar1 = pcVar1 + 1;
  } while ((int)pcVar1 < 0x4aa338);
  creatures_any_active_flag = 1;
  return CONCAT31((int3)((uint)pcVar1 >> 8),1);
}



/* creature_spawn @ 00428240 */

/* allocates a creature slot and seeds position, type, and tint defaults */

int __cdecl creature_spawn(float *pos,float *tint_rgba,int type_id)

{
  float fVar1;
  float fVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = creature_alloc_slot();
  (&creature_pool)[iVar3].pos_x = *pos;
  (&creature_pool)[iVar3].pos_y = pos[1];
  (&creature_pool)[iVar3].type_id = type_id;
  (&creature_pool)[iVar3].ai_mode = 0;
  (&creature_pool)[iVar3].collision_flag = '\0';
  (&creature_pool)[iVar3].collision_timer = 0.0;
  (&creature_pool)[iVar3].active = '\x01';
  *(undefined1 *)&(&creature_pool)[iVar3].force_target = 0;
  (&creature_pool)[iVar3].state_flag = '\x01';
  (&creature_pool)[iVar3].hitbox_size = 16.0;
  fVar1 = (float)(int)highscore_active_record.survival_elapsed_ms;
  (&creature_pool)[iVar3].vel_x = 0.0;
  (&creature_pool)[iVar3].vel_y = 0.0;
  (&creature_pool)[iVar3].health = fVar1 * 0.000100000005 + 10.0;
  iVar4 = crt_rand();
  (&creature_pool)[iVar3].heading = (float)(iVar4 % 0x13a) * 0.01;
  (&creature_pool)[iVar3].move_speed =
       (float)(int)highscore_active_record.survival_elapsed_ms * 1.0000001e-05 + 2.5;
  iVar4 = crt_rand();
  (&creature_pool)[iVar3].attack_cooldown = 0.0;
  (&creature_pool)[iVar3].reward_value = (float)(iVar4 % 0x1e + 0x8c);
  (&creature_pool)[iVar3].tint_r = *tint_rgba;
  (&creature_pool)[iVar3].tint_g = tint_rgba[1];
  (&creature_pool)[iVar3].tint_b = tint_rgba[2];
  fVar1 = (&creature_pool)[iVar3].health;
  (&creature_pool)[iVar3].tint_a = tint_rgba[3];
  fVar2 = (float)(int)highscore_active_record.survival_elapsed_ms;
  (&creature_pool)[iVar3].contact_damage = 4.0;
  (&creature_pool)[iVar3].max_health = fVar1;
  (&creature_pool)[iVar3].size = fVar2 * 1.0000001e-05 + 47.0;
  return iVar3;
}



/* player_render_overlays @ 00428390 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders per-player overlays/indicators using DAT_004908** tables */

void player_render_overlays(void)

{
  float *pfVar1;
  float *pfVar2;
  int iVar3;
  int iVar4;
  IGrim2D_vtbl *pIVar5;
  float unaff_EBX;
  IGrim2D *unaff_EBP;
  IGrim2D *unaff_ESI;
  uchar *puVar6;
  float unaff_EDI;
  float10 fVar7;
  float10 fVar8;
  longlong lVar9;
  IGrim2D *pIVar10;
  undefined4 *h;
  float radians;
  IGrim2D *pIVar11;
  IGrim2D *self;
  IGrim2D *pIStack0000001c;
  float fStack00000020;
  float fStack00000024;
  float fStack00000028;
  float fStack0000002c;
  IGrim2D *pIStack00000030;
  float fStack00000034;
  float in_stack_00000038;
  float in_stack_0000003c;
  IGrim2D in_stack_00000040;
  float in_stack_00000044;
  IGrim2D *in_stack_00000048;
  float in_stack_0000004c;
  uint uVar12;
  float in_stack_ffffffb8;
  float fVar13;
  float fVar14;
  IGrim2D *pIVar15;
  float fVar16;
  float fVar17;
  float in_stack_ffffffd8;
  float in_stack_ffffffdc;
  IGrim2D *in_stack_ffffffe0;
  float in_stack_ffffffe4;
  float in_stack_ffffffe8;
  float b;
  float a;
  IGrim2D *a_00;
  float b_00;
  float h_00;
  
  if (((((DAT_0048727c != '\0') || (ui_transition_alpha <= 0.0)) || (game_state_id == 0x14)) ||
      ((game_state_id == 0x16 || (game_state_prev == 0x14)))) || (game_state_prev == 0x16)) {
    return;
  }
  fVar13 = 6.10849e-39;
  pIVar10 = (IGrim2D *)perk_id_radioactive;
  pIVar11 = (IGrim2D *)ui_transition_alpha;
  iVar3 = perk_count_get(perk_id_radioactive);
  if (iVar3 != 0) {
    uVar12 = 0x13;
    iVar3 = 5;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)in_stack_ffffffb8);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar12);
    (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)particles_texture,0,iVar3);
    effect_select_texture(0x10);
    fVar7 = (float10)fsin((float10)_DAT_0047ea4c);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3e99999a,0.6,0.3,
               (float)(((fVar7 + (float10)1.0) * (float10)0.1875 + (float10)0.25) *
                      (float10)(float)unaff_ESI),in_stack_ffffffb8);
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,fVar13);
    (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar10);
    (*grim_interface_ptr->vtable->grim_draw_quad)
              ((IGrim2D *)
               ((_camera_offset_x + (float)(&player_pos_x)[render_overlay_player_index * 0xd8]) -
               50.0),(_camera_offset_y + (float)(&player_pos_y)[render_overlay_player_index * 0xd8])
                     - 50.0,100.0,100.0,unaff_EDI);
    (*grim_interface_ptr->vtable->grim_end_batch)(unaff_ESI);
  }
  fVar13 = 0.0;
  pIVar10 = DAT_0048287c;
  (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048287c,0,(int)unaff_EBP);
  uVar12 = 0x13;
  pIVar15 = (IGrim2D *)0x1;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,1,(uint)pIVar10);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar12);
  iVar3 = render_overlay_player_index;
  if (0.0 < *(float *)(&player_health)[render_overlay_player_index]._pad0) {
    lVar9 = __ftol();
    iVar4 = (int)lVar9;
    fVar7 = (float10)*(float *)((&player_health)[iVar3]._pad0 + 0x2dc) + (float10)1.5707964;
    fcos(fVar7);
    fsin(fVar7);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,unaff_EBX * 0.35,(float)pIVar15);
    (*grim_interface_ptr->vtable->grim_set_rotation)
              (*(IGrim2D **)((&player_health)[render_overlay_player_index]._pad0 + 8),(float)pIVar10
              );
    DAT_004965d8 = (float)(&effect_uv8_u)[iVar4 * 2];
    DAT_004965dc = (float)(&effect_uv8_v)[iVar4 * 2];
    pfVar1 = (float *)(&effect_uv8_u + iVar4 * 2);
    _DAT_004965e0 = (IGrim2D *)(*pfVar1 + 0.125);
    _DAT_004965e4 = (float)(&effect_uv8_v)[iVar4 * 2] + 0.125;
    b_00 = (float)_DAT_004965e0;
    (*grim_interface_ptr->vtable->grim_set_uv)
              ((IGrim2D *)DAT_004965d8,DAT_004965dc,(float)_DAT_004965e0,_DAT_004965e4,fVar13);
    (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_EBP);
    fVar13 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10) * 0.5 - 2.0;
    fVar14 = _camera_offset_y + (float)(&player_pos_y)[render_overlay_player_index * 0xd8];
    DAT_004965d8 = (_camera_offset_x + (float)(&player_pos_x)[render_overlay_player_index * 0xd8]) -
                   fVar13;
    DAT_004965dc = fVar14 - fVar13;
    fVar13 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10) * 1.02;
    b = DAT_004965d8;
    a = DAT_004965dc;
    (*grim_interface_ptr->vtable->grim_draw_quad)
              ((IGrim2D *)(DAT_004965d8 + 1.0),DAT_004965dc + 1.0,fVar13,fVar13,unaff_EBX);
    DAT_004965d8 = *(float *)(&DAT_00491090 + iVar4 * 8);
    DAT_004965dc = *(float *)(&DAT_00491094 + iVar4 * 8);
    iVar3 = iVar4 * 8;
    pfVar2 = (float *)(&DAT_00491090 + iVar3);
    _DAT_004965e0 = (IGrim2D *)(*pfVar2 + 0.125);
    _DAT_004965e4 = *(float *)(&DAT_00491094 + iVar3) + 0.125;
    fVar16 = (float)_DAT_004965e0;
    radians = _DAT_004965e4;
    (*grim_interface_ptr->vtable->grim_set_uv)
              ((IGrim2D *)DAT_004965d8,DAT_004965dc,(float)_DAT_004965e0,_DAT_004965e4,
               (float)pIVar11);
    (*grim_interface_ptr->vtable->grim_set_rotation)
              (*(IGrim2D **)((&player_health)[render_overlay_player_index]._pad0 + 0x2dc),
               in_stack_ffffffd8);
    fVar13 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10) * 0.5;
    DAT_004965d8 = ((_camera_offset_x + (float)(&player_pos_x)[render_overlay_player_index * 0xd8])
                   - fVar13) + fVar16;
    DAT_004965dc = ((_camera_offset_y + (float)(&player_pos_y)[render_overlay_player_index * 0xd8])
                   - fVar13) + radians;
    fVar13 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10) * 1.03;
    pIVar10 = (IGrim2D *)DAT_004965dc;
    (*grim_interface_ptr->vtable->grim_draw_quad)
              ((IGrim2D *)(DAT_004965d8 + 1.0),DAT_004965dc + 1.0,fVar13,fVar13,in_stack_ffffffdc);
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_ffffffe0);
    fVar17 = 0.0;
    pIVar11 = DAT_0048287c;
    (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048287c,0,(int)in_stack_ffffffe4);
    uVar12 = 0x13;
    pIVar15 = (IGrim2D *)0x5;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)pIVar11);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar12);
    (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar15);
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,b,(float)pIVar11);
    (*grim_interface_ptr->vtable->grim_set_rotation)
              (*(IGrim2D **)((&player_health)[render_overlay_player_index]._pad0 + 8),fVar17);
    DAT_004965d8 = *pfVar1;
    DAT_004965dc = (float)(&effect_uv8_v)[iVar4 * 2];
    _DAT_004965e0 = (IGrim2D *)(*pfVar1 + 0.125);
    _DAT_004965e4 = (float)(&effect_uv8_v)[iVar4 * 2] + 0.125;
    pIVar15 = _DAT_004965e0;
    pIStack0000001c = (IGrim2D *)_DAT_004965e4;
    (*grim_interface_ptr->vtable->grim_set_uv)
              ((IGrim2D *)DAT_004965d8,DAT_004965dc,(float)_DAT_004965e0,_DAT_004965e4,
               in_stack_ffffffe4);
    fVar17 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10) * 0.5;
    pIVar11 = *(IGrim2D **)((&player_health)[render_overlay_player_index]._pad0 + 0x10);
    DAT_004965d8 = (_camera_offset_x + (float)(&player_pos_x)[render_overlay_player_index * 0xd8]) -
                   fVar17;
    DAT_004965dc = (_camera_offset_y + (float)(&player_pos_y)[render_overlay_player_index * 0xd8]) -
                   fVar17;
    pIStack0000001c = (IGrim2D *)DAT_004965d8;
    fStack00000020 = DAT_004965dc;
    (*grim_interface_ptr->vtable->grim_draw_quad)
              ((IGrim2D *)DAT_004965d8,DAT_004965dc,(float)pIVar11,(float)pIVar11,in_stack_ffffffe8)
    ;
    fVar17 = b_00;
    h_00 = b_00;
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,b_00,b);
    if (1 < (int)config_blob.reserved0._20_4_) {
      if (render_overlay_player_index == 0) {
        (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3e99999a,0.3,1.0,b_00,a);
      }
      else {
        (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,0.55,0.35,b_00,a);
      }
    }
    DAT_004965d8 = *pfVar2;
    DAT_004965dc = *(float *)(&DAT_00491094 + iVar3);
    _DAT_004965e0 = (IGrim2D *)(*pfVar2 + 0.125);
    _DAT_004965e4 = *(float *)(&DAT_00491094 + iVar3) + 0.125;
    fStack00000028 = (float)_DAT_004965e0;
    fStack0000002c = _DAT_004965e4;
    (*grim_interface_ptr->vtable->grim_set_uv)
              ((IGrim2D *)DAT_004965d8,DAT_004965dc,(float)_DAT_004965e0,_DAT_004965e4,fVar13);
    (*grim_interface_ptr->vtable->grim_set_rotation)
              (*(IGrim2D **)((&player_health)[render_overlay_player_index]._pad0 + 0x2dc),fVar14);
    fVar13 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10) * 0.5;
    self = *(IGrim2D **)((&player_health)[render_overlay_player_index]._pad0 + 0x10);
    fStack00000024 = _camera_offset_y + (float)(&player_pos_y)[render_overlay_player_index * 0xd8];
    DAT_004965d8 = ((_camera_offset_x + (float)(&player_pos_x)[render_overlay_player_index * 0xd8])
                   - fVar13) + fStack00000028;
    DAT_004965dc = (fStack00000024 - fVar13) + fStack0000002c;
    pIStack00000030 = (IGrim2D *)DAT_004965d8;
    fStack00000034 = DAT_004965dc;
    a_00 = self;
    (*grim_interface_ptr->vtable->grim_draw_quad)
              ((IGrim2D *)DAT_004965d8,DAT_004965dc,(float)self,(float)self,h_00);
    fVar13 = 6.112045e-39;
    (*grim_interface_ptr->vtable->grim_end_batch)(pIVar11);
    if (0.0 < *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2f4)) {
      uVar12 = 0x13;
      iVar3 = 5;
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)a_00);
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar12);
      (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)particles_texture,0,iVar3);
      effect_select_texture(2);
      fVar7 = (float10)fsin((float10)_DAT_0047ea4c);
      puVar6 = (&player_health)[render_overlay_player_index]._pad0 + 0x2f4;
      fVar7 = (fVar7 + (float10)1.0) * (float10)0.25 + (float10)*(float *)puVar6;
      if (*(float *)puVar6 < 1.0) {
        fVar7 = fVar7 * (float10)*(float *)puVar6;
      }
      if ((float10)1.0 < fVar7) {
        fVar7 = (float10)1.0;
      }
      pIStack0000001c = (IGrim2D *)(float)(fVar7 * (float10)fVar16);
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3eb6b6b7,0.7058824,1.0,(float)pIStack0000001c * 0.4,(float)a_00);
      fVar7 = (float10)fsin((float10)_DAT_0047ea4c * (float10)3.0);
      fVar17 = (float)(fVar7 + (float10)17.5);
      fVar7 = (float10)*(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2dc) -
              (float10)1.5707964;
      fVar8 = (float10)fcos(fVar7);
      pIStack00000030 = (IGrim2D *)(float)(fVar8 * (float10)3.0);
      fVar7 = (float10)fsin(fVar7);
      fStack00000034 = (float)(fVar7 * (float10)3.0);
      (*grim_interface_ptr->vtable->grim_set_rotation)
                ((IGrim2D *)(_DAT_0047ea4c + _DAT_0047ea4c),fVar13);
      (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar11);
      fStack00000020 = (float)pIVar15 + (float)pIVar15;
      (*grim_interface_ptr->vtable->grim_draw_quad)
                ((IGrim2D *)
                 (((_camera_offset_x + (float)(&player_pos_x)[render_overlay_player_index * 0xd8]) -
                  (float)pIVar15) + in_stack_00000038),
                 (in_stack_0000003c + (float)(&player_pos_y)[render_overlay_player_index * 0xd8] +
                 _camera_offset_y) - (float)pIVar15,fStack00000020,fStack00000020,(float)pIVar10);
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3eb6b6b7,0.7058824,1.0,fStack0000002c * 0.3,fVar16);
      fVar7 = (float10)fsin((float10)_DAT_0047ea4c * (float10)3.0);
      fStack00000020 = (float)(fVar7 * (float10)4.0 + (float10)24.0);
      (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)(_DAT_0047ea4c * -2.0),radians);
      fVar13 = fStack00000024 + fStack00000024;
      fStack0000002c = fVar13;
      (*grim_interface_ptr->vtable->grim_draw_quad)
                ((IGrim2D *)
                 (((_camera_offset_x + (float)(&player_pos_x)[render_overlay_player_index * 0xd8]) -
                  fStack00000024) + in_stack_00000044),
                 ((float)in_stack_00000048 +
                  (float)(&player_pos_y)[render_overlay_player_index * 0xd8] + _camera_offset_y) -
                 fStack00000024,fVar13,fVar13,fVar17);
      fVar17 = 6.112978e-39;
      (*grim_interface_ptr->vtable->grim_end_batch)(self);
      pIVar10 = (IGrim2D *)0x14;
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,(uint)fVar13);
    }
    if (((&weapon_table)[*(int *)((&player_health)[render_overlay_player_index]._pad0 + 0x29c)].
         flags & 8) == 0) {
      fVar7 = (float10)*(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2dc) +
              (float10)1.5707964;
      pIVar11 = (IGrim2D *)0x0;
      fcos(fVar7);
      fVar7 = (float10)fsin(fVar7);
      in_stack_00000040.vtable =
           (IGrim2D_vtbl *)
           (float)(fVar7 * (float10)*(float *)((&player_health)[render_overlay_player_index]._pad0 +
                                              0x2d8) * (float10)12.0 - fVar7 * (float10)21.0);
      pIVar10 = DAT_0048f7e0;
      (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7e0,0,(int)fVar17);
      uVar12 = 0x13;
      fVar13 = 2.8026e-45;
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,2,(uint)pIVar10);
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar12);
      (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,fVar13);
      fVar13 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2d8) * 0.8;
      if (1.0 < fVar13) {
        fVar13 = 1.0;
      }
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,fVar13 * (float)pIVar15,(float)pIVar10);
      (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar11);
      (*grim_interface_ptr->vtable->grim_set_rotation)
                (*(IGrim2D **)((&player_health)[render_overlay_player_index]._pad0 + 0x2dc),fVar17);
      if (((&weapon_table)[*(int *)((&player_health)[render_overlay_player_index]._pad0 + 0x29c)].
           flags & 4) == 0) {
        in_stack_0000004c =
             *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10) * 0.5;
        fVar13 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10);
        fVar17 = (_camera_offset_x + (float)(&player_pos_x)[render_overlay_player_index * 0xd8]) -
                 in_stack_0000004c;
        in_stack_0000004c =
             (_camera_offset_y + (float)(&player_pos_y)[render_overlay_player_index * 0xd8]) -
             in_stack_0000004c;
        pIVar5 = grim_interface_ptr->vtable;
        fStack0000002c = fVar13;
      }
      else {
        in_stack_0000004c =
             *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10) * 0.25;
        fVar17 = (_camera_offset_x + (float)(&player_pos_x)[render_overlay_player_index * 0xd8]) -
                 in_stack_0000004c;
        in_stack_0000004c =
             (_camera_offset_y + (float)(&player_pos_y)[render_overlay_player_index * 0xd8]) -
             in_stack_0000004c;
        fVar13 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10) * 0.5;
        pIVar5 = grim_interface_ptr->vtable;
      }
      in_stack_0000004c = in_stack_0000004c + in_stack_00000044;
      in_stack_00000048 = (IGrim2D *)(fVar17 + (float)in_stack_00000040.vtable);
      DAT_004965d8 = (float)in_stack_00000048;
      DAT_004965dc = in_stack_0000004c;
      pIVar10 = in_stack_00000048;
      (*pIVar5->grim_draw_quad)(in_stack_00000048,in_stack_0000004c,fVar13,fVar13,(float)self);
      (*grim_interface_ptr->vtable->grim_end_batch)(pIVar15);
    }
    pIVar15 = (IGrim2D *)0x42932c;
    pIVar11 = (IGrim2D *)DAT_004c2bcc;
    iVar3 = perk_count_get(DAT_004c2bcc);
    if (iVar3 != 0) {
      uVar12 = 0x13;
      iVar3 = 5;
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)pIVar10);
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar12);
      (*grim_interface_ptr->vtable->grim_bind_texture)(projectile_texture,0,iVar3);
      (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x4,2,(int)pIVar10);
      pIVar10 = (IGrim2D *)0x42939d;
      (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar15);
      pIVar15 = pIStack0000001c;
      iVar3 = 0;
      if (0 < (int)config_blob.reserved0._20_4_) {
        puVar6 = player_health._pad0 + 0x2fc;
        do {
          if ((0.25 < *(float *)(puVar6 + -0x288)) &&
             (iVar4 = *(int *)puVar6,
             fVar13 = (&creature_pool)[iVar4].pos_x - *(float *)(puVar6 + -0x30c),
             fVar17 = (&creature_pool)[iVar4].pos_y - *(float *)(puVar6 + -0x308),
             SQRT(fVar13 * fVar13 + fVar17 * fVar17) <= 80.0)) {
            in_stack_00000040.vtable =
                 (IGrim2D_vtbl *)((&creature_pool)[iVar4].pos_x - *(float *)(puVar6 + -0x30c));
            fVar13 = (&creature_pool)[iVar4].pos_y - *(float *)(puVar6 + -0x308);
            h = &stack0x00000040.vtable;
            pIVar10 = &stack0x00000040;
            pIStack00000030 =
                 (IGrim2D *)
                 SQRT((float)in_stack_00000040.vtable * (float)in_stack_00000040.vtable +
                      fVar13 * fVar13);
            in_stack_00000044 = fVar13;
            thunk_FUN_00452f1d();
            fStack00000020 = (_camera_offset_x + *(float *)(puVar6 + -0x30c)) - 16.0;
            fStack00000024 = (_camera_offset_y + *(float *)(puVar6 + -0x308)) - 16.0;
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)0x3f000000,0.6,1.0,(float)pIVar15,(float)pIVar10);
            fStack00000020 = 0.0;
            if (0.0 < fStack0000002c) {
              do {
                pIVar10 = (IGrim2D *)0x42000000;
                (*grim_interface_ptr->vtable->grim_draw_quad)
                          ((IGrim2D *)(fVar13 * fStack00000020 + fStack00000024),
                           (float)in_stack_00000040.vtable * fStack00000020 + fStack00000028,32.0,
                           32.0,(float)h);
                fStack00000024 = fStack00000024 + 8.0;
              } while (fStack00000024 < (float)pIStack00000030);
            }
          }
          iVar3 = iVar3 + 1;
          puVar6 = puVar6 + 0x360;
        } while (iVar3 < (int)config_blob.reserved0._20_4_);
      }
      (*grim_interface_ptr->vtable->grim_end_batch)(pIVar11);
    }
    uVar12 = 0x13;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)pIVar10);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar12);
    return;
  }
  if (0.0 <= (float)(&player_death_timer)[render_overlay_player_index * 0xd8]) {
    lVar9 = __ftol();
    iVar3 = (int)lVar9;
  }
  else {
    iVar3 = 0x34;
  }
  (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar15);
  DAT_004965d8 = (float)(&effect_uv8_u)[iVar3 * 2];
  DAT_004965dc = (float)(&effect_uv8_v)[iVar3 * 2];
  _DAT_004965e0 = (IGrim2D *)((float)(&effect_uv8_u)[iVar3 * 2] + 0.125);
  _DAT_004965e4 = (float)(&effect_uv8_v)[iVar3 * 2] + 0.125;
  (*grim_interface_ptr->vtable->grim_set_uv)
            ((IGrim2D *)DAT_004965d8,DAT_004965dc,(float)_DAT_004965e0,_DAT_004965e4,(float)pIVar10)
  ;
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_ffffffd8 * 0.35,fVar13);
  (*grim_interface_ptr->vtable->grim_set_rotation)
            (*(IGrim2D **)((&player_health)[render_overlay_player_index]._pad0 + 0x2dc),
             (float)unaff_EBP);
  fVar13 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10) * 0.5;
  DAT_004965d8 = (_camera_offset_x + (float)(&player_pos_x)[render_overlay_player_index * 0xd8]) -
                 fVar13;
  DAT_004965dc = (_camera_offset_y + (float)(&player_pos_y)[render_overlay_player_index * 0xd8]) -
                 fVar13;
  pIVar10 = (IGrim2D *)
            (*(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10) * 1.03);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(DAT_004965d8 + 1.0),DAT_004965dc + 1.0,(float)pIVar10,(float)pIVar10,
             unaff_EBX);
  fVar17 = 6.109626e-39;
  (*grim_interface_ptr->vtable->grim_end_batch)(pIVar11);
  uVar12 = 0x13;
  fVar13 = 7.00649e-45;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)pIVar10);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar12);
  if (config_blob.reserved0._20_4_ == 1) {
    fVar16 = 1.0;
    pIVar5 = grim_interface_ptr->vtable;
    fVar14 = 1.0;
  }
  else {
    pIVar5 = grim_interface_ptr->vtable;
    if (render_overlay_player_index == 0) {
      fVar16 = 1.0;
      fVar14 = 0.3;
      pIVar15 = (IGrim2D *)0x3e99999a;
      goto LAB_004287af;
    }
    fVar16 = 0.35;
    fVar14 = 0.55;
  }
  pIVar15 = (IGrim2D *)0x3f800000;
LAB_004287af:
  (*pIVar5->grim_set_color)(pIVar15,fVar14,fVar16,in_stack_ffffffd8,fVar13);
  (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar10);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)DAT_004965d8,DAT_004965dc,
             *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10),
             *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x10),fVar17);
  (*grim_interface_ptr->vtable->grim_end_batch)(pIVar11);
  return;
}



/* bonus_label_for_entry @ 00429580 */

/* returns the label string for a bonus entry (formatting weapon/score cases) */

char * __cdecl bonus_label_for_entry(int *bonus_entry)

{
  int iVar1;
  char *pcVar2;
  
  iVar1 = *bonus_entry;
  if (iVar1 == 3) {
    pcVar2 = weapon_table_entry(bonus_entry[6]);
    crt_sprintf(&DAT_0049679c,&DAT_00471fc4,pcVar2);
    return &DAT_0049679c;
  }
  if (iVar1 == 1) {
    crt_sprintf(&DAT_0049679c,s__s___d_00473e8c,DAT_004853e4,bonus_entry[6]);
    return &DAT_0049679c;
  }
  return *(char **)(&bonus_meta_label + iVar1 * 0x14);
}



/* bonus_render @ 004295f0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders bonus icons and labels from the pickup pool */

void bonus_render(void)

{
  float fVar1;
  int iVar2;
  uint uVar3;
  int *piVar4;
  IGrim2D_vtbl *pIVar5;
  float unaff_EBP;
  uchar *puVar6;
  IGrim2D_vtbl *unaff_ESI;
  float *pfVar7;
  int unaff_EDI;
  IGrim2D IVar8;
  bool bVar9;
  float10 fVar10;
  float10 extraout_ST0;
  float10 extraout_ST0_00;
  float10 fVar11;
  uint uVar12;
  int iVar13;
  float fVar14;
  IGrim2D *pIVar15;
  IGrim2D *pIVar16;
  float fVar17;
  IGrim2D_vtbl *self;
  IGrim2D *self_00;
  IGrim2D self_01;
  IGrim2D_vtbl *pIVar18;
  IGrim2D_vtbl *text;
  float frame;
  IGrim2D local_30;
  IGrim2D_vtbl *pIStack_2c;
  IGrim2D_vtbl *pIStack_28;
  IGrim2D IStack_24;
  IGrim2D local_20;
  IGrim2D local_1c;
  IGrim2D_vtbl *local_18;
  IGrim2D_vtbl *local_14;
  undefined4 uStack_10;
  
  local_30.vtable = (IGrim2D_vtbl *)ui_transition_alpha;
  local_20.vtable = (IGrim2D_vtbl *)0x3ef0a3d7;
  local_1c.vtable = (IGrim2D_vtbl *)0x3ef0a3d7;
  local_18 = (IGrim2D_vtbl *)0x3ef0a3d7;
  local_14 = (IGrim2D_vtbl *)0x3f800000;
  if ((((0.0 < ui_transition_alpha) && (game_state_id != 0x14)) && (game_state_id != 0x16)) &&
     ((game_state_prev != 0x14 && (game_state_prev != 0x16)))) {
    _DAT_004aaf5c = frame_dt * 1.3 + _DAT_004aaf5c;
    self_00 = particles_texture;
    (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,unaff_EDI);
    pIVar18 = (IGrim2D_vtbl *)0x429696;
    effect_select_texture(0x10);
    pIVar16 = (IGrim2D *)0x13;
    fVar17 = 7.00649e-45;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)self_00);
    fVar14 = 2.8026e-44;
    pIVar15 = (IGrim2D *)0x2;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,(uint)pIVar16);
    local_1c.vtable = (IGrim2D_vtbl *)0x3f333333;
    uStack_10 = 0x3f800000;
    pIStack_2c = (IGrim2D_vtbl *)0x3f333333;
    local_18 = (IGrim2D_vtbl *)0x3f4ccccd;
    local_14 = (IGrim2D_vtbl *)0x3f800000;
    local_20.vtable = (IGrim2D_vtbl *)0x3f800000;
    pIStack_28 = (IGrim2D_vtbl *)0x3f4ccccd;
    IStack_24.vtable = (IGrim2D_vtbl *)0x3f800000;
    iVar13 = 5;
    uVar12 = 0x13;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)fVar14);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar12);
    (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)bonus_texture,0,iVar13);
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,fVar14);
    IStack_24.vtable = (IGrim2D_vtbl *)0x3f800000;
    local_20.vtable = (IGrim2D_vtbl *)0x3f800000;
    local_1c.vtable = (IGrim2D_vtbl *)0x3f800000;
    local_18 = (IGrim2D_vtbl *)0x3f800000;
    fVar14 = 1.0;
    local_30.vtable = (IGrim2D_vtbl *)0x3f800000;
    pIStack_2c = (IGrim2D_vtbl *)0x3f800000;
    pIStack_28 = (IGrim2D_vtbl *)0x3f800000;
    (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar15);
    pIVar15 = (IGrim2D *)0x0;
    pfVar7 = (float *)&bonus_time_left;
    do {
      if (pfVar7[-2] != 0.0) {
        fVar1 = 1.0;
        if (*pfVar7 < 2.0) {
          fVar10 = (float10)fsin((float10)*pfVar7 * (float10)18.849556);
          if (fVar10 <= (float10)0.0) {
            fVar1 = *pfVar7 * 0.5;
          }
          else {
            fVar1 = *pfVar7 * 0.25;
          }
        }
        frame = pfVar7[1] - *pfVar7;
        if (frame < 0.5) {
          fVar1 = frame + frame;
        }
        IStack_24.vtable = (IGrim2D_vtbl *)(fVar1 * 0.9 * unaff_ESI);
        if (0.0 <= (float)local_30.vtable) {
          if (1.0 < (float)local_30.vtable) {
            local_30.vtable = (IGrim2D_vtbl *)0x3f800000;
          }
        }
        else {
          local_30.vtable = (IGrim2D_vtbl *)0x0;
        }
        if (0.0 <= (float)pIStack_2c) {
          if (1.0 < (float)pIStack_2c) {
            pIStack_2c = (IGrim2D_vtbl *)0x3f800000;
          }
        }
        else {
          pIStack_2c = (IGrim2D_vtbl *)0x0;
        }
        if (0.0 <= (float)pIStack_28) {
          if (1.0 < (float)pIStack_28) {
            pIStack_28 = (IGrim2D_vtbl *)0x3f800000;
          }
        }
        else {
          pIStack_28 = (IGrim2D_vtbl *)0x0;
        }
        if (0.0 <= (float)IStack_24.vtable) {
          if (1.0 < (float)IStack_24.vtable) {
            IStack_24.vtable = (IGrim2D_vtbl *)0x3f800000;
          }
        }
        else {
          IStack_24.vtable = (IGrim2D_vtbl *)0x0;
        }
        (*grim_interface_ptr->vtable->grim_set_color_ptr)(&local_30,(float *)pIVar16);
        (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,fVar17);
        (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x4,0,(int)self_00);
        self_00 = (IGrim2D *)0x42000000;
        fVar17 = 32.0;
        pIVar16 = (IGrim2D *)((_camera_offset_y + pfVar7[3]) - 16.0);
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)((_camera_offset_x + pfVar7[2]) - 16.0),(float)pIVar16,32.0,32.0,
                   (float)pIVar18);
        iVar13 = *(int *)(&bonus_meta_icon_id + (int)pfVar7[-2] * 0x14);
        if (-1 < iVar13) {
          if (0.5 <= *pfVar7) {
            fVar1 = pfVar7[1] - *pfVar7;
            if (0.5 <= fVar1) {
              fVar1 = 1.0;
            }
            else {
              fVar1 = fVar1 + fVar1;
            }
          }
          else {
            fVar1 = *pfVar7 + *pfVar7;
          }
          pIStack_2c = (IGrim2D_vtbl *)(fVar1 * local_30.vtable);
          local_14 = local_30.vtable;
          if (0.0 <= (float)local_20.vtable) {
            if (1.0 < (float)local_20.vtable) {
              local_20.vtable = (IGrim2D_vtbl *)0x3f800000;
            }
          }
          else {
            local_20.vtable = (IGrim2D_vtbl *)0x0;
          }
          if (0.0 <= (float)local_1c.vtable) {
            if (1.0 < (float)local_1c.vtable) {
              local_1c.vtable = (IGrim2D_vtbl *)0x3f800000;
            }
          }
          else {
            local_1c.vtable = (IGrim2D_vtbl *)0x0;
          }
          if (0.0 <= (float)local_18) {
            if (1.0 < (float)local_18) {
              local_18 = (IGrim2D_vtbl *)0x3f800000;
            }
          }
          else {
            local_18 = (IGrim2D_vtbl *)0x0;
          }
          if (1.0 < (float)local_30.vtable) {
            local_14 = (IGrim2D_vtbl *)0x3f800000;
          }
          self_00 = (IGrim2D *)0x429a99;
          (*grim_interface_ptr->vtable->grim_set_color_ptr)(&local_20,(float *)pIVar15);
          IStack_24.vtable = (IGrim2D_vtbl *)(float)local_30.vtable;
          fVar10 = (float10)fsin((float10)(int)local_30.vtable + (float10)_DAT_004aaf5c);
          local_20.vtable = (IGrim2D_vtbl *)(float)fVar10;
          crt_ci_pow();
          pIStack_28 = (IGrim2D_vtbl *)
                       (float)((extraout_ST0 * (float10)0.25 + (float10)0.75) *
                              (float10)(float)pIStack_28);
          (*grim_interface_ptr->vtable->grim_set_color_ptr)(&local_1c,(float *)unaff_ESI);
          fVar10 = (float10)fsin((float10)(float)local_20.vtable -
                                 (float10)(int)highscore_active_record.survival_elapsed_ms *
                                 (float10)0.003);
          (*grim_interface_ptr->vtable->grim_set_rotation)
                    ((IGrim2D *)(float)(fVar10 * (float10)0.2),unaff_EBP);
          if ((pfVar7[-2] == 1.4013e-45) && (pfVar7[4] == 1.4013e-42)) {
            (*grim_interface_ptr->vtable->grim_set_atlas_frame)
                      ((IGrim2D *)0x4,iVar13 + 1,(int)frame);
          }
          else {
            (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x4,iVar13,(int)frame);
          }
          unaff_EBP = (float)local_1c.vtable * 32.0;
          unaff_ESI = (IGrim2D_vtbl *)
                      ((_camera_offset_y + pfVar7[3]) - (float)local_1c.vtable * 16.0);
          pIVar15 = (IGrim2D *)((_camera_offset_x + pfVar7[2]) - (float)local_1c.vtable * 16.0);
          pIVar18 = (IGrim2D_vtbl *)0x429b84;
          local_14 = (IGrim2D_vtbl *)unaff_EBP;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    (pIVar15,(float)unaff_ESI,unaff_EBP,unaff_EBP,fVar14);
        }
      }
      pfVar7 = pfVar7 + 7;
      pIVar15 = (IGrim2D *)((int)&pIVar15->vtable + 1);
    } while ((int)pfVar7 < 0x482b10);
    (*grim_interface_ptr->vtable->grim_end_batch)(pIVar16);
    pIVar5 = (IGrim2D_vtbl *)0x0;
    (*grim_interface_ptr->vtable->grim_bind_texture)(ui_weapon_icons_texture,0,(int)fVar17);
    uVar12 = 0x429bcf;
    (*grim_interface_ptr->vtable->grim_begin_batch)(self_00);
    fVar17 = 0.0;
    pfVar7 = (float *)&bonus_time_left;
    do {
      if (pfVar7[-2] == 4.2039e-45) {
        if (0.5 <= *pfVar7) {
          fVar1 = pfVar7[1] - *pfVar7;
          if (0.5 <= fVar1) {
            fVar1 = 1.0;
          }
          else {
            fVar1 = fVar1 + fVar1;
          }
        }
        else {
          fVar1 = *pfVar7 + *pfVar7;
        }
        local_30.vtable = (IGrim2D_vtbl *)(fVar1 * fVar14);
        uVar12 = 0x429c34;
        local_18 = local_30.vtable;
        (*grim_interface_ptr->vtable->grim_set_color_ptr)(&IStack_24,(float *)pIVar18);
        fVar10 = (float10)fsin((float10)_DAT_004aaf5c);
        IStack_24.vtable = (IGrim2D_vtbl *)(float)fVar10;
        crt_ci_pow();
        pIStack_2c = (IGrim2D_vtbl *)
                     (float)((extraout_ST0_00 * (float10)0.25 + (float10)0.75) *
                            (float10)(float)pIStack_2c);
        (*grim_interface_ptr->vtable->grim_set_color_ptr)(&local_20,(float *)pIVar15);
        fVar10 = (float10)fsin((float10)(int)local_30.vtable -
                               (float10)(int)highscore_active_record.survival_elapsed_ms *
                               (float10)0.003);
        (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)(float)fVar10,(float)unaff_ESI);
        (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,unaff_EBP);
        (*grim_interface_ptr->vtable->grim_set_sub_rect)
                  ((IGrim2D *)0x8,2,1,(&weapon_table)[(int)pfVar7[4]].hud_icon_id << 1,(int)fVar17);
        fVar17 = (float)local_1c.vtable * 30.0;
        unaff_EBP = (float)local_1c.vtable * 60.0;
        unaff_ESI = (IGrim2D_vtbl *)((_camera_offset_y + pfVar7[3]) - (float)local_1c.vtable * 15.0)
        ;
        pIVar15 = (IGrim2D *)((_camera_offset_x + pfVar7[2]) - fVar17);
        pIVar18 = (IGrim2D_vtbl *)0x429d27;
        local_18 = (IGrim2D_vtbl *)fVar17;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  (pIVar15,(float)unaff_ESI,unaff_EBP,fVar17,fVar14);
      }
      pfVar7 = pfVar7 + 7;
      fVar17 = (float)((int)fVar17 + 1);
    } while ((int)pfVar7 < 0x482b10);
    self_01.vtable = (IGrim2D_vtbl *)0x429d4d;
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)pIVar18);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,uVar12);
    self = (IGrim2D_vtbl *)0x3f333333;
    fVar14 = 1.0;
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,0.7,(float)self_01.vtable);
    if (0 < (int)config_blob.reserved0._20_4_) {
      puVar6 = player_health._pad0 + 0x2c;
      pIStack_2c = (IGrim2D_vtbl *)&DAT_004aaf60;
      text = pIVar18;
      do {
        IVar8.vtable = pIStack_2c;
        pIVar18 = text;
        if (0.0 < *(float *)((player_state_t *)(puVar6 + -0x2c))->_pad0) {
          iVar13 = 0;
          piVar4 = &bonus_pool;
          do {
            if ((*piVar4 != 0) &&
               (SQRT((*(float *)puVar6 - (float)piVar4[4]) * (*(float *)puVar6 - (float)piVar4[4]) +
                     (*(float *)(puVar6 + 4) - (float)piVar4[5]) *
                     (*(float *)(puVar6 + 4) - (float)piVar4[5])) < 24.0)) {
              if (game_state_id == 9) {
                pIStack_2c->grim_release =
                     (_func_1 *)
                     ((int)&((IGrim2D_vtbl *)pIStack_2c->grim_release)->grim_release + frame_dt_ms);
              }
              pIVar18 = (IGrim2D_vtbl *)bonus_label_for_entry(&bonus_pool + iVar13 * 7);
              local_30.vtable = (IGrim2D_vtbl *)(_camera_offset_x + *(float *)puVar6 + 16.0);
              IStack_24.vtable =
                   (IGrim2D_vtbl *)
                   (*grim_interface_ptr->vtable->grim_measure_text_width)((IGrim2D *)pIVar18,text);
              if ((float)config_blob.screen_width < (float)(int)IStack_24.vtable + (float)pIStack_2c
                 ) {
                pIStack_2c = (IGrim2D_vtbl *)
                             ((float)config_blob.screen_width - (float)(int)IStack_24.vtable);
              }
              fVar14 = 6.11816e-39;
              self = pIStack_2c;
              self_01.vtable = local_30.vtable;
              (*grim_interface_ptr->vtable->grim_draw_text_small)
                        ((IGrim2D *)pIStack_2c,(float)local_30.vtable,(float)pIVar18,(char *)pIVar15
                        );
              IVar8.vtable = IStack_24.vtable;
              goto LAB_00429df8;
            }
            piVar4 = piVar4 + 7;
            iVar13 = iVar13 + 1;
          } while ((int)piVar4 < 0x482b08);
          pIStack_2c->grim_release = (_func_1 *)0x0;
LAB_00429df8:
          if (0x28a < (int)(IVar8.vtable)->grim_release) {
            self = (IGrim2D_vtbl *)0x429e0c;
            self_01.vtable = (IGrim2D_vtbl *)perk_id_telekinetic;
            iVar2 = perk_count_get(perk_id_telekinetic);
            if ((iVar2 != 0) && ((&bonus_state)[iVar13 * 0x1c] == '\0')) {
              self_01.vtable = (IGrim2D_vtbl *)(&bonus_pool + iVar13 * 7);
              fVar14 = 6.118208e-39;
              self = pIVar5;
              bonus_apply((int)pIVar5,(int *)self_01.vtable);
              (&bonus_state)[iVar13 * 0x1c] = 1;
              (&bonus_time_left)[iVar13 * 7] = 0x3f000000;
              (&DAT_004aaf60)[(int)pIVar5] = 0;
              break;
            }
          }
        }
        pIVar5 = (IGrim2D_vtbl *)((int)&pIVar5->grim_release + 1);
        puVar6 = puVar6 + 0x360;
        pIStack_2c = (IGrim2D_vtbl *)&(IVar8.vtable)->grim_set_paused;
        text = pIVar18;
      } while ((int)pIVar5 < (int)config_blob.reserved0._20_4_);
    }
    if (config_blob.reserved0[0x10] != '\0') {
      uVar12 = 0x13;
      iVar13 = 5;
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)fVar14);
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar12);
      (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,iVar13);
      effect_select_texture(0xd);
      (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,fVar14);
      (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.065,(float)self)
      ;
      (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)self_01.vtable);
      uVar12 = 0;
      piVar4 = &particle_pool.style_id;
      do {
        if (((particle_t *)(piVar4 + -0xc))->active != '\0') {
          uVar3 = uVar12 & 0x80000001;
          bVar9 = uVar3 == 0;
          if ((int)uVar3 < 0) {
            bVar9 = (uVar3 - 1 | 0xfffffffe) == 0xffffffff;
          }
          if ((bVar9) && ((char)*piVar4 != '\b')) {
            fVar10 = (float10)fsin(((float10)1.0 - (float10)(float)piVar4[-3]) * (float10)1.5707964)
            ;
            fVar10 = (fVar10 + (float10)0.1) * (float10)55.0 + (float10)4.0;
            if (fVar10 < (float10)16.0) {
              fVar10 = (float10)16.0;
            }
            self_01.vtable = (IGrim2D_vtbl *)(float)(fVar10 + fVar10);
            pIStack_28 = self_01.vtable;
            (*grim_interface_ptr->vtable->grim_draw_quad)
                      ((IGrim2D *)
                       (float)(((float10)_camera_offset_x + (float10)(float)piVar4[-0xb]) - fVar10),
                       (float)(((float10)_camera_offset_y + (float10)(float)piVar4[-10]) - fVar10),
                       (float)self_01.vtable,(float)self_01.vtable,(float)pIVar18);
          }
        }
        piVar4 = piVar4 + 0xe;
        uVar12 = uVar12 + 1;
      } while ((int)piVar4 < 0x495ae8);
      pIVar18 = (IGrim2D_vtbl *)0x42a088;
      (*grim_interface_ptr->vtable->grim_end_batch)(pIVar15);
      fVar14 = 2.8026e-44;
      self = (IGrim2D_vtbl *)0x6;
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,(uint)self_01.vtable);
    }
    uVar12 = 0x13;
    iVar13 = 5;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)fVar14);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar12);
    (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,iVar13);
    effect_select_texture(0xc);
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,fVar14);
    (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)self);
    pfVar7 = &particle_pool.spin;
    do {
      if ((((particle_t *)(pfVar7 + -0xb))->active != '\0') && (SUB41(pfVar7[1],0) != '\b')) {
        (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)*pfVar7,(float)self_01.vtable);
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)pfVar7[-6],pfVar7[-5],pfVar7[-4],pfVar7[-3],(float)pIVar18);
        fVar10 = (float10)fsin(((float10)1.0 - (float10)pfVar7[-2]) * (float10)1.5707964);
        fVar10 = fVar10 * (float10)24.0;
        if (SUB41(pfVar7[1],0) == '\x01') {
          fVar10 = fVar10 * (float10)0.8;
        }
        if (fVar10 < (float10)2.0) {
          fVar10 = (float10)2.0;
        }
        self_01.vtable = (IGrim2D_vtbl *)(float)(fVar10 + fVar10);
        pIVar18 = self_01.vtable;
        IStack_24.vtable = self_01.vtable;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)(float)(((float10)_camera_offset_x + (float10)pfVar7[-10]) - fVar10),
                   (float)(((float10)_camera_offset_y + (float10)pfVar7[-9]) - fVar10),
                   (float)self_01.vtable,(float)self_01.vtable,(float)pIVar15);
      }
      pfVar7 = pfVar7 + 0xe;
    } while ((int)pfVar7 < 0x495ae4);
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)self_01.vtable);
    effect_select_texture(2);
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,(float)pIVar18);
    pIVar16 = (IGrim2D *)0x42a211;
    (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar15);
    piVar4 = &particle_pool.style_id;
    do {
      if ((((particle_t *)(piVar4 + -0xc))->active != '\0') && ((char)*piVar4 == '\b')) {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,(float)piVar4[-4],(float)unaff_ESI);
        fVar10 = (float10)fsin((float10)(float)piVar4[-1]);
        fVar11 = (fVar10 * (float10)3.0 + (float10)15.0) * (float10)(float)piVar4[-7] * (float10)7.0
        ;
        IStack_24.vtable =
             (IGrim2D_vtbl *)
             ((float)((float10)15.0 - fVar10 * (float10)3.0) * (float)piVar4[-7] * 7.0);
        unaff_ESI = (IGrim2D_vtbl *)(float)(fVar11 + fVar11);
        pIVar16 = (IGrim2D *)
                  (float)(((float10)_camera_offset_y + (float10)(float)piVar4[-10]) - fVar11);
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)((_camera_offset_x + (float)piVar4[-0xb]) - (float)IStack_24.vtable),
                   (float)pIVar16,(float)IStack_24.vtable + (float)IStack_24.vtable,(float)unaff_ESI
                   ,unaff_EBP);
      }
      piVar4 = piVar4 + 0xe;
    } while ((int)piVar4 < 0x495ae8);
    pIVar18 = (IGrim2D_vtbl *)0x42a2e1;
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)unaff_ESI);
    fVar17 = 2.8026e-44;
    pIVar15 = (IGrim2D *)0x6;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,(uint)pIVar16);
    uVar12 = 0x13;
    fVar14 = 7.00649e-45;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)fVar17);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar12);
    (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,fVar14);
    (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,fVar17);
    pIVar5 = (IGrim2D_vtbl *)0x42a363;
    (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar15);
    pfVar7 = &secondary_projectile_pool.vel_x;
    do {
      if ((((secondary_projectile_t *)(pfVar7 + -5))->active != '\0') && (pfVar7[2] == 4.2039e-45))
      {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,0.6,0.1,1.0 - *pfVar7,(float)pIVar16);
        pIStack_2c = (IGrim2D_vtbl *)(pfVar7[1] * *pfVar7 * 64.0);
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)((_camera_offset_x + pfVar7[-2]) - (float)pIStack_2c * 0.5),
                   (_camera_offset_y + pfVar7[-1]) - (float)pIStack_2c * 0.5,(float)pIStack_2c,
                   (float)pIStack_2c,(float)pIVar18);
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,0.6,0.1,(1.0 - *pfVar7) * 0.3,(float)unaff_ESI);
        pIVar18 = (IGrim2D_vtbl *)(pfVar7[1] * *pfVar7 * 200.0);
        pIVar16 = (IGrim2D *)((_camera_offset_y + pfVar7[-1]) - (float)pIVar18 * 0.5);
        pIVar5 = (IGrim2D_vtbl *)0x42a46b;
        unaff_ESI = pIVar18;
        IStack_24.vtable = pIVar18;
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)((_camera_offset_x + pfVar7[-2]) - (float)pIVar18 * 0.5),
                   (float)pIVar16,(float)pIVar18,(float)pIVar18,unaff_EBP);
      }
      pfVar7 = pfVar7 + 0xb;
    } while ((int)pfVar7 < 0x4965ec);
    pIVar18 = (IGrim2D_vtbl *)0x42a488;
    (*grim_interface_ptr->vtable->grim_end_batch)(pIVar16);
    fVar14 = 2.8026e-44;
    pIVar15 = (IGrim2D *)0x6;
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,(uint)pIVar5);
    if (config_blob.reserved0[0x11] != '\0') {
      uVar12 = 0x13;
      iVar13 = 5;
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)fVar14);
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar12);
      (*grim_interface_ptr->vtable->grim_bind_texture)(particles_texture,0,iVar13);
      (*grim_interface_ptr->vtable->grim_set_uv)
                ((IGrim2D *)DAT_00491248,DAT_0049124c,DAT_00491248 + 0.25,DAT_0049124c + 0.25,fVar14
                );
      (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar15);
      iVar13 = 0x496848;
      do {
        if (*(char *)(iVar13 + -0x28) != '\0') {
          (*grim_interface_ptr->vtable->grim_set_rotation)
                    (*(IGrim2D **)(iVar13 + -0x14),(float)pIVar5);
          (*grim_interface_ptr->vtable->grim_set_color)
                    (*(IGrim2D **)(iVar13 + -0x24),*(float *)(iVar13 + -0x20),
                     *(float *)(iVar13 + -0x1c),*(float *)(iVar13 + -0x18),(float)pIVar18);
          pIVar5 = pIStack_2c;
          pIVar18 = pIStack_2c;
          (*grim_interface_ptr->vtable->grim_draw_quad)
                    ((IGrim2D *)
                     ((_camera_offset_x + *(float *)(iVar13 + -0x10)) - (float)pIStack_2c * 0.5),
                     (_camera_offset_y + *(float *)(iVar13 + -0xc)) - (float)pIStack_2c * 0.5,
                     (float)pIStack_2c,(float)pIStack_2c,(float)pIVar16);
        }
        iVar13 = iVar13 + 0x2c;
      } while (iVar13 < 0x49aa48);
      (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)pIVar5);
    }
    effects_render();
  }
  return;
}



/* audio_resume_all @ 0042a5f0 */

/* resume active audio channels */

int audio_resume_all(void)

{
  float fVar1;
  int iVar2;
  uint3 extraout_var;
  
  audio_resume_channels();
  fVar1 = *(float *)((int)cv_verbose + 0xc);
  iVar2 = CONCAT22((short)((uint)cv_verbose >> 0x10),
                   (ushort)(fVar1 < 0.0) << 8 | (ushort)NAN(fVar1) << 10 |
                   (ushort)(fVar1 == 0.0) << 0xe);
  if ((fVar1 == 0.0) == 0) {
    console_printf(&console_log_queue,s_<___Restored_00473e94);
    iVar2 = (uint)extraout_var << 8;
  }
  audio_suspend_flag = 0;
  return CONCAT31((int3)((uint)iVar2 >> 8),1);
}



/* audio_suspend_all @ 0042a630 */

/* suspend active audio channels */

void audio_suspend_all(void)

{
  audio_suspend_channels();
  if (*(float *)((int)cv_verbose + 0xc) != 0.0) {
    console_printf(&console_log_queue,s_<___Suspended_00473ea4);
  }
  audio_suspend_flag = 1;
  return;
}



/* texture_get_or_load @ 0042a670 */

/* lookup texture handle; load if missing (name + path) */

int __cdecl texture_get_or_load(char *name,char *path)

{
  int iVar1;
  char *unaff_ESI;
  char *unaff_EDI;
  char *unaff_retaddr;
  char *in_stack_0000000c;
  
  iVar1 = (*grim_interface_ptr->vtable->grim_get_texture_handle)((IGrim2D *)name,unaff_EDI);
  if (iVar1 == -1) {
    iVar1 = (*grim_interface_ptr->vtable->grim_load_texture)
                      ((IGrim2D *)name,in_stack_0000000c,unaff_ESI);
    if ((char)iVar1 != '\0') {
      if (*(float *)((int)cv_silentloads + 0xc) == 0.0) {
        console_printf(&console_log_queue,s____loading_texture___s__ok_00473ed4,in_stack_0000000c);
      }
      iVar1 = (*grim_interface_ptr->vtable->grim_get_texture_handle)((IGrim2D *)name,unaff_retaddr);
      return iVar1;
    }
    console_printf(&console_log_queue,s____loading_texture___s__failed_00473eb4,in_stack_0000000c);
    iVar1 = -1;
  }
  return iVar1;
}



/* texture_get_or_load_alt @ 0042a700 */

/* duplicate of texture_get_or_load (callers are mostly .jaz assets) */

int __cdecl texture_get_or_load_alt(char *name,char *path)

{
  int iVar1;
  char *unaff_ESI;
  char *unaff_retaddr;
  
  iVar1 = (*grim_interface_ptr->vtable->grim_get_texture_handle)((IGrim2D *)name,unaff_ESI);
  if (iVar1 == -1) {
    iVar1 = (*grim_interface_ptr->vtable->grim_load_texture)((IGrim2D *)name,name,unaff_retaddr);
    if ((char)iVar1 != '\0') {
      if (*(float *)((int)cv_silentloads + 0xc) == 0.0) {
        console_printf(&console_log_queue,s____loading_texture___s__ok_00473ed4);
      }
      iVar1 = (*grim_interface_ptr->vtable->grim_get_texture_handle)((IGrim2D *)name,name);
      return iVar1;
    }
    console_printf(&console_log_queue,s____loading_texture___s__failed_00473eb4);
    iVar1 = -1;
  }
  return iVar1;
}



/* console_cmd_load_texture @ 0042a780 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* console command handler for loadtexture; calls texture_get_or_load(name, path) */

void console_cmd_load_texture(void)

{
  int iVar1;
  char *path;
  char *name;
  
  iVar1 = console_cmd_argc_get();
  if (iVar1 != 2) {
    console_printf(&console_log_queue,s_loadtexture_<texturefileid>_00473ef0);
    return;
  }
  path = console_cmd_arg_get(2);
  name = console_cmd_arg_get(2);
  texture_get_or_load(name,path);
  return;
}



/* console_cmd_set_resource_paq @ 0042a7c0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* console command handler for setresourcepaq; validates file and updates Grim config id 0x10 */

void console_cmd_set_resource_paq(void)

{
  int iVar1;
  char *pcVar2;
  FILE *fp;
  uint in_stack_ffffffec;
  uint value;
  char *mode;
  
  iVar1 = console_cmd_argc_get();
  if (iVar1 != 2) {
    console_printf(&console_log_queue,s_setresourcepaq_<resourcepaq>_00473f44);
    return;
  }
  mode = &file_mode_read_binary;
  pcVar2 = console_cmd_arg_get(1);
  value = 0x42a7f4;
  fp = crt_fopen(pcVar2,mode);
  if (fp == (FILE *)0x0) {
    pcVar2 = console_cmd_arg_get(1);
    console_printf(&console_log_queue,s_File___s__not_found__00473f2c,pcVar2);
    return;
  }
  crt_fclose(fp);
  console_cmd_arg_get(1);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x10,in_stack_ffffffec,value);
  pcVar2 = console_cmd_arg_get(1);
  console_printf(&console_log_queue,s_Set_resource_paq_to___s__00473f10,pcVar2);
  return;
}



/* console_cmd_tell_time_survived @ 0042a860 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* console command handler for telltimesurvived; prints survived time in seconds */

void console_cmd_tell_time_survived(void)

{
  longlong lVar1;
  
  lVar1 = __ftol();
  console_printf(&console_log_queue,s_Survived___i_seconds__00473f64,(int)lVar1);
  return;
}



/* console_cmd_open_url @ 0042a890 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* console command handler for openurl; converts to wide and calls HlinkNavigateString */

void console_cmd_open_url(void)

{
  int iVar1;
  char *pcVar2;
  HRESULT HVar3;
  WCHAR *lpWideCharStr;
  int cchWideChar;
  WCHAR aWStack_208 [260];
  
  lpWideCharStr = aWStack_208;
  iVar1 = console_cmd_argc_get();
  if (iVar1 != 2) {
    console_printf(&console_log_queue,s_openurl_<url>_00473fbc);
    return;
  }
  cchWideChar = 0x104;
  iVar1 = -1;
  pcVar2 = console_cmd_arg_get(1);
  MultiByteToWideChar(0,0,pcVar2,iVar1,lpWideCharStr,cchWideChar);
  HVar3 = HlinkNavigateString((IUnknown *)0x0,aWStack_208);
  if (HVar3 < 0) {
    console_printf(&console_log_queue,s_Failed_to_launch_web_browser__00473f9c);
    return;
  }
  pcVar2 = console_cmd_arg_get(1);
  console_printf(&console_log_queue,s_Launching_web_browser___s____00473f7c,pcVar2);
  return;
}



/* console_cmd_snd_freq_adjustment @ 0042a930 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* console command handler for sndfreqadjustment; toggles DAT_004807a8 and prints status */

void console_cmd_snd_freq_adjustment(void)

{
  config_blob.reserved6[0x10] = config_blob.reserved6[0x10] == '\0';
  if ((bool)config_blob.reserved6[0x10]) {
    console_printf(&console_log_queue,s_Sound_frequency_adjustment_is_no_00473ffc);
    return;
  }
  console_printf(&console_log_queue,s_Sound_frequency_adjustment_is_no_00473fcc);
  return;
}



/* reg_read_dword_default @ 0042a980 */

/* reads a registry DWORD or writes fallback to output */

int __cdecl reg_read_dword_default(HKEY key,char *name,uint *out,uint fallback)

{
  uint *puVar1;
  LONG LVar2;
  DWORD local_4;
  
  puVar1 = out;
  local_4 = 4;
  LVar2 = RegQueryValueExA((HKEY)key,name,(LPDWORD)0x0,(LPDWORD)&out,(LPBYTE)out,&local_4);
  if (LVar2 != 0) {
    *puVar1 = fallback;
  }
  return 0;
}



/* reg_write_dword @ 0042a9c0 */

/* writes a registry DWORD */

int __cdecl reg_write_dword(HKEY key,char *name,uint value)

{
  LONG LVar1;
  
  LVar1 = RegSetValueExA((HKEY)key,name,0,4,(BYTE *)&value,4);
  return -(uint)(LVar1 != 0) & 0x80004005;
}



/* init_audio_and_terrain @ 0042a9f0 */

/* sound init + terrain texture setup */

void init_audio_and_terrain(void)

{
  IGrim2D_vtbl *pIVar1;
  int iVar2;
  int iVar3;
  char *extraout_EDX;
  char *extraout_EDX_00;
  char *extraout_EDX_01;
  int unaff_EDI;
  longlong lVar4;
  char *pcVar5;
  undefined4 in_stack_00000004;
  int extraout_var;
  
  console_printf(&console_log_queue,s_Init_Grim_successful__00474114);
  iVar3 = extraout_var;
  console_printf(&console_log_queue,&DAT_004711c0);
  console_printf(&console_log_queue,s________________________004740fc);
  console_printf(&console_log_queue,s___Sound_init___________004740e4);
  console_printf(&console_log_queue,s________________________004740fc);
  if (DAT_004aaeea == '\0') {
    iVar2 = sfx_system_init();
    if ((char)iVar2 == '\0') {
      DAT_004aaeea = '\x01';
    }
  }
  else {
    console_printf(&console_log_queue,s____no_sounds_selected_004740cc);
  }
  console_printf(&console_log_queue,&DAT_004711c0);
  terrain_texture_width = 0x400;
  terrain_texture_height = 0x400;
  if (0.5 <= (float)config_blob.reserved0._112_4_) {
    if (4.0 < (float)config_blob.reserved0._112_4_) {
      config_blob.reserved0[0x70] = '\0';
      config_blob.reserved0[0x71] = '\0';
      config_blob.reserved0[0x72] = 0x80;
      config_blob.reserved0[0x73] = '@';
    }
  }
  else {
    config_blob.reserved0[0x70] = '\0';
    config_blob.reserved0[0x71] = '\0';
    config_blob.reserved0[0x72] = '\0';
    config_blob.reserved0[0x73] = '?';
  }
  if (terrain_texture_failed == '\0') {
    lVar4 = __ftol();
    iVar3 = (*grim_interface_ptr->vtable->grim_create_texture)
                      ((IGrim2D *)s_ground_004740c4,(char *)lVar4,(int)(char *)lVar4,iVar3);
    pcVar5 = extraout_EDX;
    if ((char)iVar3 == '\0') {
      config_blob.reserved0._112_4_ =
           (float)config_blob.reserved0._112_4_ + (float)config_blob.reserved0._112_4_;
      pIVar1 = grim_interface_ptr->vtable;
      lVar4 = __ftol();
      iVar3 = (int)lVar4;
      lVar4 = __ftol();
      iVar3 = (*pIVar1->grim_create_texture)
                        ((IGrim2D *)s_ground_004740c4,(char *)lVar4,iVar3,unaff_EDI);
      if ((char)iVar3 == '\0') {
        config_blob.reserved0._112_4_ = in_stack_00000004;
        terrain_texture_failed = '\x01';
        console_printf(&console_log_queue,s_Failed_to_create_terrain_texture_004740a0);
        pcVar5 = s___>_entering_safemode__00474088;
      }
      else {
        pcVar5 = s_Created_terrain_texture__0047406c;
      }
      console_printf(&console_log_queue,pcVar5);
      pcVar5 = extraout_EDX_00;
    }
    if (terrain_texture_failed == '\0') goto LAB_0042abbf;
  }
  console_printf(&console_log_queue,s_Running_in_safemode__using_stati_00474034);
  pcVar5 = extraout_EDX_01;
LAB_0042abbf:
  console_flush_log(&console_log_queue,pcVar5);
  return;
}



/* load_textures_step @ 0042abd0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* stage-based texture loading (advances DAT_004aaf88) */

int load_textures_step(void)

{
  char *in_EDX;
  char *extraout_EDX;
  char *extraout_EDX_00;
  char *extraout_EDX_01;
  char *extraout_EDX_02;
  char *extraout_EDX_03;
  char *extraout_EDX_04;
  char *extraout_EDX_05;
  char *extraout_EDX_06;
  char *extraout_EDX_07;
  char *extraout_EDX_08;
  char *extraout_EDX_09;
  char *extraout_EDX_10;
  char *unaff_retaddr;
  char *in_stack_00000004;
  char *pcVar1;
  char *pcVar2;
  
  if (DAT_004aaf88 == 0) {
    texture_get_or_load(s_GRIM_Font2_004745d8,s_load_smallWhite_tga_004745e4);
    texture_get_or_load(s_trooper_0047372c,s_game_trooper_jaz_004745c4);
    texture_get_or_load(s_zombie_0047375c,s_game_zombie_jaz_004745b4);
    texture_get_or_load(s_spider_sp1_00473748,s_game_spider_sp1_jaz_004745a0);
    texture_get_or_load(s_spider_sp2_0047373c,s_game_spider_sp2_jaz_0047458c);
    texture_get_or_load(s_alien_00473734,s_game_alien_jaz_0047457c);
    texture_get_or_load(s_lizard_00473754,s_game_lizard_jaz_0047456c);
    in_EDX = extraout_EDX;
  }
  if (DAT_004aaf88 == 1) {
    DAT_0048f7d8 = texture_get_or_load(s_arrow_00474554,s_load_arrow_tga_0047455c);
    texture_get_or_load(s_bullet_i_00474534,s_load_bullet16_tga_00474540);
    bullet_trail_texture =
         texture_get_or_load(s_bulletTrail_00474510,s_load_bulletTrail_tga_0047451c);
    texture_get_or_load(s_bodyset_004744f4,s_game_bodyset_jaz_004744fc);
    bodyset_texture =
         (*grim_interface_ptr->vtable->grim_get_texture_handle)
                   ((IGrim2D *)s_bodyset_004744f4,unaff_retaddr);
    unaff_retaddr = s_game_projs_jaz_004744e4;
    projectile_texture = texture_get_or_load(s_projs_004744dc,s_game_projs_jaz_004744e4);
    in_EDX = extraout_EDX_00;
  }
  if (DAT_004aaf88 == 2) {
    texture_get_or_load(s_ui_iconAim_004744bc,s_ui_ui_iconAim_jaz_004744c8);
    texture_get_or_load(s_ui_buttonSm_00474498,s_ui_ui_button_64x32_jaz_004744a4);
    texture_get_or_load(s_ui_buttonMd_00474474,s_ui_ui_button_128x32_jaz_00474480);
    texture_get_or_load(s_ui_checkOn_00474454,s_ui_ui_checkOn_jaz_00474460);
    texture_get_or_load(s_ui_checkOff_00474434,s_ui_ui_checkOff_jaz_00474440);
    texture_get_or_load(s_ui_rectOff_00474414,s_ui_ui_rectOff_jaz_00474420);
    texture_get_or_load(s_ui_rectOn_004743f4,s_ui_ui_rectOn_jaz_00474400);
    texture_get_or_load(s_bonuses_004743d8,s_game_bonuses_jaz_004743e0);
    in_EDX = extraout_EDX_01;
  }
  if (DAT_004aaf88 == 3) {
    pcVar2 = s_ui_ui_indBullet_jaz_00473864;
    texture_get_or_load_alt(s_ui_ui_indBullet_jaz_00473864,unaff_retaddr);
    pcVar1 = s_ui_ui_indRocket_jaz_00473850;
    texture_get_or_load_alt(s_ui_ui_indRocket_jaz_00473850,pcVar2);
    pcVar2 = s_ui_ui_indElectric_jaz_00473838;
    texture_get_or_load_alt(s_ui_ui_indElectric_jaz_00473838,pcVar1);
    texture_get_or_load_alt(s_ui_ui_indFire_jaz_00473878,pcVar2);
    bonus_texture =
         (*grim_interface_ptr->vtable->grim_get_texture_handle)
                   ((IGrim2D *)s_bonuses_004743d8,unaff_retaddr);
    unaff_retaddr = s_game_particles_jaz_004743c4;
    particles_texture = texture_get_or_load_alt(s_game_particles_jaz_004743c4,in_stack_00000004);
    in_EDX = extraout_EDX_02;
  }
  if (DAT_004aaf88 == 4) {
    pcVar1 = s_ui_ui_indLife_jaz_004743b0;
    DAT_0048f7c0 = texture_get_or_load_alt(s_ui_ui_indLife_jaz_004743b0,unaff_retaddr);
    pcVar2 = s_ui_ui_indPanel_jaz_0047439c;
    DAT_0048f7c4 = texture_get_or_load_alt(s_ui_ui_indPanel_jaz_0047439c,pcVar1);
    pcVar1 = s_ui_ui_arrow_jaz_0047438c;
    DAT_0048f7bc = texture_get_or_load_alt(s_ui_ui_arrow_jaz_0047438c,pcVar2);
    pcVar2 = s_ui_ui_cursor_jaz_00474378;
    DAT_0048f798 = texture_get_or_load_alt(s_ui_ui_cursor_jaz_00474378,pcVar1);
    DAT_0048f79c = texture_get_or_load_alt(s_ui_ui_aim_jaz_00474368,pcVar2);
    in_EDX = extraout_EDX_03;
  }
  if (DAT_004aaf88 == 5) {
    if (terrain_texture_failed == '\0') {
      pcVar2 = s_ter_ter_q1_base_jaz_00474354;
      DAT_0048f548 = texture_get_or_load_alt(s_ter_ter_q1_base_jaz_00474354,unaff_retaddr);
      pcVar1 = s_ter_ter_q1_tex1_jaz_00474340;
      DAT_0048f54c = texture_get_or_load_alt(s_ter_ter_q1_tex1_jaz_00474340,pcVar2);
      pcVar2 = s_ter_ter_q2_base_jaz_0047432c;
      _DAT_0048f550 = texture_get_or_load_alt(s_ter_ter_q2_base_jaz_0047432c,pcVar1);
      pcVar1 = s_ter_ter_q2_tex1_jaz_00474318;
      _DAT_0048f554 = texture_get_or_load_alt(s_ter_ter_q2_tex1_jaz_00474318,pcVar2);
      pcVar2 = s_ter_ter_q3_base_jaz_00474304;
      _DAT_0048f558 = texture_get_or_load_alt(s_ter_ter_q3_base_jaz_00474304,pcVar1);
      pcVar1 = s_ter_ter_q3_tex1_jaz_004742f0;
      _DAT_0048f55c = texture_get_or_load_alt(s_ter_ter_q3_tex1_jaz_004742f0,pcVar2);
      pcVar2 = s_ter_ter_q4_base_jaz_004742dc;
      _DAT_0048f560 = texture_get_or_load_alt(s_ter_ter_q4_base_jaz_004742dc,pcVar1);
      _DAT_0048f564 = texture_get_or_load_alt(s_ter_ter_q4_tex1_jaz_004742c8,pcVar2);
      in_EDX = extraout_EDX_04;
    }
    else {
      pcVar2 = s_ter_fb_q1_jaz_004742b8;
      DAT_0048f548 = texture_get_or_load_alt(s_ter_fb_q1_jaz_004742b8,unaff_retaddr);
      pcVar1 = s_ter_fb_q2_jaz_004742a8;
      DAT_0048f54c = texture_get_or_load_alt(s_ter_fb_q2_jaz_004742a8,pcVar2);
      pcVar2 = s_ter_fb_q3_jaz_00474298;
      _DAT_0048f550 = texture_get_or_load_alt(s_ter_fb_q3_jaz_00474298,pcVar1);
      _DAT_0048f554 = texture_get_or_load_alt(s_ter_fb_q4_jaz_00474288,pcVar2);
      terrain_render_target = DAT_0048f548;
      in_EDX = extraout_EDX_05;
    }
  }
  if (DAT_004aaf88 == 6) {
    pcVar1 = s_ui_ui_textLevComp_jaz_00474270;
    DAT_0048f7a0 = texture_get_or_load_alt(s_ui_ui_textLevComp_jaz_00474270,unaff_retaddr);
    pcVar2 = s_ui_ui_textQuest_jaz_0047425c;
    DAT_0048f7a4 = texture_get_or_load_alt(s_ui_ui_textQuest_jaz_0047425c,pcVar1);
    pcVar1 = s_ui_ui_num1_jaz_0047424c;
    DAT_0048f7a8 = texture_get_or_load_alt(s_ui_ui_num1_jaz_0047424c,pcVar2);
    pcVar2 = s_ui_ui_num2_jaz_0047423c;
    DAT_0048f7ac = texture_get_or_load_alt(s_ui_ui_num2_jaz_0047423c,pcVar1);
    pcVar1 = s_ui_ui_num3_jaz_0047422c;
    _DAT_0048f7b0 = texture_get_or_load_alt(s_ui_ui_num3_jaz_0047422c,pcVar2);
    pcVar2 = s_ui_ui_num4_jaz_0047421c;
    DAT_0048f7b4 = texture_get_or_load_alt(s_ui_ui_num4_jaz_0047421c,pcVar1);
    _DAT_0048f7b8 = texture_get_or_load_alt(s_ui_ui_num5_jaz_0047420c,pcVar2);
    in_EDX = extraout_EDX_06;
  }
  if (DAT_004aaf88 == 7) {
    ui_weapon_icons_texture = texture_get_or_load(s_ui_wicons_004741ec,s_ui_ui_wicons_jaz_004741f8);
    texture_get_or_load(s_iGameUI_00473894,s_ui_ui_gameTop_jaz_004741d8);
    pcVar1 = s_iHeart_0047388c;
    texture_get_or_load(s_iHeart_0047388c,s_ui_ui_lifeHeart_jaz_004741c4);
    pcVar2 = s_ui_ui_clockTable_jaz_004741ac;
    ui_clock_table_texture = texture_get_or_load_alt(s_ui_ui_clockTable_jaz_004741ac,pcVar1);
    DAT_0048f7cc = texture_get_or_load_alt(s_ui_ui_clockPointer_jaz_00474194,pcVar2);
    in_EDX = extraout_EDX_07;
  }
  if (DAT_004aaf88 == 8) {
    DAT_0048f7e0 = texture_get_or_load_alt(s_game_muzzleFlash_jaz_0047417c,unaff_retaddr);
    texture_get_or_load(s_ui_dropOn_00474158,s_ui_ui_dropDownOn_jaz_00474164);
    texture_get_or_load(s_ui_dropOff_00474134,s_ui_ui_dropDownOff_jaz_00474140);
    in_EDX = extraout_EDX_08;
    if (terrain_texture_failed == '\0') {
      terrain_render_target =
           (*grim_interface_ptr->vtable->grim_get_texture_handle)
                     ((IGrim2D *)s_ground_004740c4,unaff_retaddr);
      in_EDX = extraout_EDX_09;
    }
  }
  if (DAT_004aaf88 == 9) {
    game_state_id = 0;
    DAT_0049bb30 = (*grim_interface_ptr->vtable->grim_get_texture_handle)
                             ((IGrim2D *)s_bullet_i_00474534,unaff_retaddr);
    _DAT_00496698 =
         (*grim_interface_ptr->vtable->grim_get_texture_handle)
                   ((IGrim2D *)s_aim64_0047412c,in_stack_00000004);
    DAT_004aaf86 = 1;
    in_EDX = extraout_EDX_10;
  }
  DAT_004aaf88 = DAT_004aaf88 + 1;
  DAT_00473a5c = 0xb;
  console_flush_log(&console_log_queue,in_EDX);
  return (uint)(10 < DAT_004aaf88);
}



/* game_startup_init_prelude @ 0042b090 */

/* prelude called by game_startup_init; handles core init, dates, registry time, and terrain reset
    */

void game_startup_init_prelude(void)

{
  LONG LVar1;
  char *filename;
  uint id;
  HKEY key;
  uint uVar2;
  undefined1 *puVar3;
  undefined4 uVar4;
  undefined4 in_stack_ffffffe0;
  uint in_stack_ffffffe4;
  
  DAT_004aaee4 = strdup_malloc(&DAT_0047f4d8);
  uVar4 = 0x12;
  (*grim_interface_ptr->vtable->grim_set_config_var)
            ((IGrim2D *)0x12,CONCAT31((int3)((uint)in_stack_ffffffe0 >> 8),1),in_stack_ffffffe4);
  uVar2 = 0x13;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,uVar4);
  id = 0x42b0e7;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar2);
  effect_uv_tables_init();
  console_flush_log(&console_log_queue,filename);
  console_printf(&console_log_queue,s_Entering_Crimsonland___0047465c);
  perks_init_database();
  weapon_table_init();
  game_core_init();
  GetLocalTime((LPSYSTEMTIME)&local_system_time);
  if (local_system_time._2_2_ == 9) {
    if (local_system_day != 0xc) goto LAB_0042b17a;
  }
  else if (local_system_time._2_2_ == 0xb) {
    if (local_system_day != 8) goto LAB_0042b17a;
  }
  else if ((local_system_time._2_2_ != 0xc) || (local_system_day != 0x12)) goto LAB_0042b17a;
  DAT_004aaed8 = 1;
  texture_get_or_load(s_balloon_00474648,s_balloon_tga_00474650);
LAB_0042b17a:
  key = (HKEY)&console_log_queue;
  DAT_004aaed8 = 0;
  uVar2 = 0x42b190;
  console_printf(&console_log_queue,s_Unloaded_resource_paq_00474630);
  puVar3 = &DAT_0047f4d8;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x10,id,uVar2);
  uVar4 = ZEXT24(qpc_timestamp_scratch);
  QueryPerformanceCounter((LARGE_INTEGER *)&stack0xffffffd8);
  crt_srand(uVar4);
  gameplay_reset_state();
  DAT_004aaed9 = 1;
  terrain_generate_random();
  DAT_004aaed9 = 0;
  LVar1 = RegCreateKeyExA((HKEY)0x80000001,s_Software_10tons_entertainment_Cr_00474604,0,(LPSTR)0x0,
                          0,0xf003f,(LPSECURITY_ATTRIBUTES)0x0,(PHKEY)&stack0xffffffd0,(LPDWORD)0x0)
  ;
  if (LVar1 == 0) {
    reg_read_dword_default((HKEY)key,s_timePlayed_004745f8,(uint *)&stack0xffffffd4,0);
    DAT_0048718c = (uint)puVar3;
    RegCloseKey(key);
  }
  return;
}



/* game_startup_init @ 0042b290 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* startup init: logs, builds perks/weapons, seeds UI/effects, loads registry time; triggers intro
   music then switches to crimson_theme */

void game_startup_init(void)

{
  undefined4 uVar1;
  IGrim2D *pIVar2;
  int iVar3;
  float unaff_EBP;
  char *unaff_ESI;
  IGrim2D *unaff_EDI;
  IGrim2D_vtbl *pIVar4;
  float10 extraout_ST0;
  longlong lVar5;
  float unaff_retaddr;
  IGrim2D *in_stack_00000004;
  int in_stack_00000008;
  IGrim2D *in_stack_0000000c;
  IGrim2D *in_stack_00000010;
  IGrim2D *in_stack_00000014;
  IGrim2D *in_stack_00000018;
  IGrim2D *in_stack_0000001c;
  float in_stack_00000020;
  IGrim2D *in_stack_00000024;
  IGrim2D *in_stack_00000028;
  char *in_stack_0000002c;
  float *in_stack_00000030;
  float in_stack_00000034;
  float in_stack_00000038;
  IGrim2D *in_stack_0000003c;
  IGrim2D *in_stack_00000040;
  IGrim2D IStack00000044;
  float fStack00000048;
  int in_stack_00000054;
  char *in_stack_ffffffdc;
  char *in_stack_ffffffe0;
  char *pcVar6;
  code *handle;
  float fVar7;
  IGrim2D *in_stack_fffffff4;
  char *handle_00;
  IGrim2D *in_stack_fffffff8;
  uint uVar8;
  IGrim2D *in_stack_fffffffc;
  float v1;
  
  pcVar6 = (char *)0x42b2a1;
  (*grim_interface_ptr->vtable->grim_get_frame_dt)(unaff_EDI);
  frame_dt = (float)extraout_ST0;
  if ((float10)0.1 < extraout_ST0) {
    frame_dt = 0.1;
  }
  if (DAT_00473a60 != '\0') {
    DAT_00473a60 = '\0';
  }
  if (DAT_004aaf9c == '\0') {
    load_textures_step();
  }
  if ((DAT_00473a60 == '\0') && (DAT_004aaf86 != '\0')) {
    pcVar6 = s_splashReflexive_00474714;
    texture_get_or_load(s_splashReflexive_00474714,s_load_splashReflexive_jpg_00474724);
    in_stack_ffffffe0 = s_load_splash10tons_jaz_004746fc;
    in_stack_ffffffdc = s_splash10Tons_004746ec;
    texture_get_or_load(s_splash10Tons_004746ec,s_load_splash10tons_jaz_004746fc);
    game_startup_init_prelude();
    crt_beginthread(&LAB_0042b250,0,(void *)0x0);
    DAT_004aaf86 = '\0';
    DAT_004aaf9c = '\x01';
    if (0.5 < _DAT_004aaf90) {
      _DAT_004aaf90 = 0.5;
    }
LAB_0042b35f:
    if ((DAT_004aaf8c != '\0') && (DAT_004aaf9d != '\0')) {
      if (DAT_004aaf98 < 5) {
        DAT_004aaf98 = DAT_004aaf98 + 1;
        Sleep(5);
        (*grim_interface_ptr->vtable->grim_clear_color)((IGrim2D *)0x0,0.0,0.0,1.0,(float)unaff_ESI)
        ;
        audio_update();
        console_update(0x47eea0);
        FUN_00401dd0(&console_log_queue);
        if (*(float *)((int)cv_showFPS + 0xc) != 0.0) {
          (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.6,unaff_EBP)
          ;
          (*grim_interface_ptr->vtable->grim_get_fps)(in_stack_fffffff4);
          lVar5 = __ftol();
          pIVar4 = grim_interface_ptr->vtable;
          if ((int)lVar5 < 400) {
            (*pIVar4->grim_get_fps)(in_stack_fffffff8);
            lVar5 = __ftol();
            uVar1 = (undefined4)lVar5;
            pcVar6 = &DAT_00471f40;
            iVar3 = config_blob.screen_width + -0x2d;
          }
          else {
            (*pIVar4->grim_get_fps)(in_stack_fffffff8);
            lVar5 = __ftol();
            uVar1 = (undefined4)lVar5;
            pcVar6 = &DAT_00472990;
            iVar3 = config_blob.screen_width + -0x33;
          }
          (*pIVar4->grim_draw_text_small_fmt)
                    (grim_interface_ptr,(float)iVar3,(float)(config_blob.screen_height + -0x18),
                     pcVar6,uVar1);
        }
        iVar3 = (*grim_interface_ptr->vtable->grim_is_key_down)
                          ((IGrim2D *)0x10,(uint)in_stack_fffffffc);
        if (((char)iVar3 != '\0') &&
           (iVar3 = (*grim_interface_ptr->vtable->grim_is_key_down)
                              ((IGrim2D *)0x38,(uint)unaff_retaddr), (char)iVar3 != '\0')) {
          return;
        }
        return;
      }
      if (14.0 < _DAT_004aaf90) {
        handle = console_hotkey_update;
        (*grim_interface_ptr->vtable->grim_set_config_var)
                  ((IGrim2D *)0x2d,(uint)in_stack_ffffffdc,(uint)in_stack_ffffffe0);
        pIVar4 = grim_interface_ptr->vtable;
        pIVar2 = (IGrim2D *)
                 (*pIVar4->grim_get_texture_handle)((IGrim2D *)s_splashReflexive_00474714,pcVar6);
        (*pIVar4->grim_destroy_texture)(pIVar2,(int)handle);
        pIVar4 = grim_interface_ptr->vtable;
        pIVar2 = (IGrim2D *)
                 (*pIVar4->grim_get_texture_handle)((IGrim2D *)s_splash10Tons_004746ec,unaff_ESI);
        (*pIVar4->grim_destroy_texture)(pIVar2,(int)unaff_EBP);
        sfx_mute_all(music_track_intro_id);
        iVar3 = game_is_full_version();
        if ((char)iVar3 == '\0') {
          sfx_play_exclusive(music_track_crimsonquest_id);
          demo_mode_start();
        }
        else {
          sfx_play_exclusive(music_track_crimson_theme_id);
        }
        (*grim_interface_ptr->vtable->grim_clear_color)
                  ((IGrim2D *)0x0,0.0,0.0,1.0,(float)in_stack_fffffff4);
        return;
      }
      iVar3 = (*grim_interface_ptr->vtable->grim_is_key_down)((IGrim2D *)0x1,(uint)unaff_ESI);
      if (((((char)iVar3 != '\0') ||
           (iVar3 = (*grim_interface_ptr->vtable->grim_is_key_down)((IGrim2D *)0x39,(uint)unaff_EBP)
           , (char)iVar3 != '\0')) ||
          (iVar3 = (*grim_interface_ptr->vtable->grim_is_key_down)
                             ((IGrim2D *)0x1c,(uint)in_stack_fffffff4), (char)iVar3 != '\0')) ||
         ((iVar3 = input_primary_just_pressed(), (char)iVar3 != '\0' ||
          (iVar3 = (*grim_interface_ptr->vtable->grim_was_mouse_button_pressed)
                             ((IGrim2D *)0x1,(int)in_stack_fffffff8), (char)iVar3 != '\0')))) {
        DAT_004aaf94 = '\x01';
        goto LAB_0042bd39;
      }
      if (DAT_004aaed9 != '\0') goto LAB_0042bd39;
      iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)
                        ((IGrim2D *)0x29,(uint)in_stack_fffffffc);
      if ((char)iVar3 != '\0') {
        console_set_open(&console_log_queue,console_open_flag == '\0');
      }
      _DAT_0047ea4c = _DAT_0047ea4c + frame_dt;
      _DAT_0047ea48 = frame_dt;
      uVar8 = 0;
      (*grim_interface_ptr->vtable->grim_clear_color)((IGrim2D *)0x0,0.0,0.0,1.0,unaff_retaddr);
      if (DAT_004aaf85 != '\0') {
        v1 = 6.126621e-39;
        fVar7 = (float)music_track_intro_id;
        iVar3 = sfx_is_unmuted(music_track_intro_id);
        if ((char)iVar3 == '\0') {
          v1 = 6.126648e-39;
          fVar7 = (float)music_track_intro_id;
          sfx_play_exclusive(music_track_intro_id);
        }
        _DAT_004aaf90 = frame_dt * 1.1 + _DAT_004aaf90;
        (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,uVar8);
        _DAT_004aaf90 = _DAT_004aaf90 - 2.0;
        if (DAT_004aaf94 != '\0') {
          if ((_DAT_004aaf90 < 1.0) ||
             ((5.0 <= _DAT_004aaf90 && ((_DAT_004aaf90 < 7.0 || (11.0 <= _DAT_004aaf90)))))) {
            _DAT_004aaf90 = 16.0;
          }
          else {
            _DAT_004aaf90 = frame_dt * 4.0 + _DAT_004aaf90;
          }
        }
        uVar8 = 0x40;
        (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,v1);
        (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,fVar7);
        if ((_DAT_004aaf90 <= 1.0) || (5.0 <= _DAT_004aaf90)) {
          if (6.0 < _DAT_004aaf90) {
            pIVar2 = (IGrim2D *)
                     (*grim_interface_ptr->vtable->grim_get_texture_handle)
                               ((IGrim2D *)s_splashReflexive_00474714,(char *)in_stack_00000004);
            uVar8 = 0x100;
            in_stack_00000014 = (IGrim2D *)0x100;
            goto LAB_0042b800;
          }
        }
        else {
          uVar8 = 0x80;
          in_stack_00000010 = (IGrim2D *)0x80;
          pIVar2 = (IGrim2D *)
                   (*grim_interface_ptr->vtable->grim_get_texture_handle)
                             ((IGrim2D *)s_splash10Tons_004746ec,(char *)in_stack_00000004);
LAB_0042b800:
          if (-1 < (int)pIVar2) {
            (*grim_interface_ptr->vtable->grim_bind_texture)(pIVar2,0,0x40);
          }
        }
        (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_0000000c);
        if (_DAT_004aaf90 <= 1.0) {
          if (2.0 <= _DAT_004aaf90) goto LAB_0042b8d9;
          if (4.0 <= _DAT_004aaf90) goto LAB_0042b97b;
LAB_0042ba4c:
          if (7.0 < _DAT_004aaf90) {
            if (8.0 <= _DAT_004aaf90) goto LAB_0042bb08;
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)0x3f800000,1.0,1.0,(_DAT_004aaf90 - 6.0) - 1.0,
                       (float)in_stack_00000010);
            in_stack_00000010 = (IGrim2D *)(float)(int)in_stack_00000020;
            pIVar4 = grim_interface_ptr->vtable;
            in_stack_0000000c = (IGrim2D *)0x44000000;
            in_stack_00000024 = (IGrim2D *)(config_blob.screen_width / 2 + -0x100);
            pIVar2 = (IGrim2D *)(float)(int)in_stack_00000024;
            goto LAB_0042bc9a;
          }
          if (8.0 <= _DAT_004aaf90) {
LAB_0042bb08:
            if (10.0 <= _DAT_004aaf90) goto LAB_0042bbaa;
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)0x3f800000,1.0,1.0,1.0,(float)in_stack_00000010);
            in_stack_00000010 = (IGrim2D *)(float)(int)in_stack_00000020;
            pIVar4 = grim_interface_ptr->vtable;
            in_stack_0000000c = (IGrim2D *)0x44000000;
            in_stack_00000024 = (IGrim2D *)(config_blob.screen_width / 2 + -0x100);
            pIVar2 = (IGrim2D *)(float)(int)in_stack_00000024;
            goto LAB_0042bc9a;
          }
          if (10.0 <= _DAT_004aaf90) {
LAB_0042bbaa:
            if (_DAT_004aaf90 < 11.0) {
              in_stack_00000020 = 1.0 - ((_DAT_004aaf90 - 6.0) - 4.0);
              if (0.0 <= in_stack_00000020) {
                if (1.0 < in_stack_00000020) {
                  in_stack_00000020 = 1.0;
                }
              }
              else {
                in_stack_00000020 = 0.0;
              }
              (*grim_interface_ptr->vtable->grim_set_color)
                        ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000020,(float)in_stack_00000010);
              (*grim_interface_ptr->vtable->grim_set_color)
                        ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000020,(float)in_stack_00000014);
              in_stack_00000014 = (IGrim2D *)(float)(int)in_stack_00000024;
              pIVar4 = grim_interface_ptr->vtable;
              in_stack_0000000c = (IGrim2D *)(float)(int)(config_blob.screen_height / 2 - uVar8 / 2)
              ;
              in_stack_00000010 = (IGrim2D *)0x44000000;
              in_stack_00000028 = (IGrim2D *)(config_blob.screen_width / 2 + -0x100);
              pIVar2 = (IGrim2D *)(float)(int)in_stack_00000028;
              goto LAB_0042bc9a;
            }
          }
        }
        else {
          if (2.0 <= _DAT_004aaf90) {
LAB_0042b8d9:
            if (4.0 <= _DAT_004aaf90) {
LAB_0042b97b:
              if (5.0 <= _DAT_004aaf90) goto LAB_0042ba4c;
              in_stack_00000020 = 1.0 - (_DAT_004aaf90 - 4.0);
              if (0.0 <= in_stack_00000020) {
                if (1.0 < in_stack_00000020) {
                  in_stack_00000020 = 1.0;
                }
              }
              else {
                in_stack_00000020 = 0.0;
              }
              (*grim_interface_ptr->vtable->grim_set_color)
                        ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000020,(float)in_stack_00000010);
              in_stack_00000010 = (IGrim2D *)(float)(int)in_stack_00000020;
              pIVar4 = grim_interface_ptr->vtable;
              in_stack_0000000c = (IGrim2D *)0x44000000;
              in_stack_00000024 = (IGrim2D *)(config_blob.screen_width / 2 + -0x100);
              pIVar2 = (IGrim2D *)(float)(int)in_stack_00000024;
            }
            else {
              (*grim_interface_ptr->vtable->grim_set_color)
                        ((IGrim2D *)0x3f800000,1.0,1.0,1.0,(float)in_stack_00000010);
              in_stack_00000010 = (IGrim2D *)(float)(int)in_stack_00000020;
              pIVar4 = grim_interface_ptr->vtable;
              in_stack_0000000c = (IGrim2D *)0x44000000;
              in_stack_00000024 = (IGrim2D *)(config_blob.screen_width / 2 + -0x100);
              pIVar2 = (IGrim2D *)(float)(int)in_stack_00000024;
            }
          }
          else {
            (*grim_interface_ptr->vtable->grim_set_color)
                      ((IGrim2D *)0x3f800000,1.0,1.0,_DAT_004aaf90 - 1.0,(float)in_stack_00000010);
            in_stack_00000010 = (IGrim2D *)(float)(int)in_stack_00000020;
            pIVar4 = grim_interface_ptr->vtable;
            in_stack_0000000c = (IGrim2D *)0x44000000;
            in_stack_00000024 = (IGrim2D *)(config_blob.screen_width / 2 + -0x100);
            pIVar2 = (IGrim2D *)(float)(int)in_stack_00000024;
          }
LAB_0042bc9a:
          (*pIVar4->grim_draw_quad)
                    (pIVar2,(float)in_stack_0000000c,(float)in_stack_00000010,
                     (float)in_stack_00000014,(float)in_stack_00000018);
        }
        _DAT_004aaf90 = _DAT_004aaf90 + 2.0;
        (*grim_interface_ptr->vtable->grim_set_config_var)
                  ((IGrim2D *)0x15,2,(uint)in_stack_00000010);
        (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000014);
        audio_update();
      }
      console_update(0x47eea0);
      FUN_00401dd0(&console_log_queue);
      iVar3 = (*grim_interface_ptr->vtable->grim_is_key_down)
                        ((IGrim2D *)0x10,(uint)in_stack_00000018);
      if (((char)iVar3 != '\0') &&
         (iVar3 = (*grim_interface_ptr->vtable->grim_is_key_down)
                            ((IGrim2D *)0x38,(uint)in_stack_0000001c), (char)iVar3 != '\0')) {
        return;
      }
      if (DAT_0047ea50 != '\0') {
        return;
      }
LAB_0042bd39:
      if (*(float *)((int)cv_showFPS + 0xc) == 0.0) {
        return;
      }
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,0.6,in_stack_00000020);
      (*grim_interface_ptr->vtable->grim_get_fps)(in_stack_00000024);
      lVar5 = __ftol();
      pIVar4 = grim_interface_ptr->vtable;
      if ((int)lVar5 < 400) {
        (*pIVar4->grim_get_fps)(in_stack_00000028);
        __ftol();
        in_stack_00000024 = (IGrim2D *)&DAT_00471f40;
        iVar3 = config_blob.screen_width + -0x2d;
      }
      else {
        (*pIVar4->grim_get_fps)(in_stack_00000028);
        __ftol();
        in_stack_00000024 = (IGrim2D *)&DAT_00472990;
        iVar3 = config_blob.screen_width + -0x33;
      }
      in_stack_00000020 = (float)(config_blob.screen_height + -0x18);
      (*pIVar4->grim_draw_text_small_fmt)
                (grim_interface_ptr,(float)iVar3,in_stack_00000020,(char *)in_stack_00000024);
      return;
    }
    if ((DAT_004aaf9c != '\0') && (DAT_004aaf8c != '\0')) {
      _DAT_004aaf90 = _DAT_004aaf90 - frame_dt;
      if (_DAT_004aaf90 < 0.0) {
        _DAT_004aaf90 = 0.0;
        DAT_004aaf9d = '\x01';
        pIVar4 = grim_interface_ptr->vtable;
        pIVar2 = (IGrim2D *)
                 (*pIVar4->grim_get_texture_handle)((IGrim2D *)s_loading_004746e4,unaff_ESI);
        (*pIVar4->grim_destroy_texture)(pIVar2,(int)unaff_EBP);
        pIVar4 = grim_interface_ptr->vtable;
        unaff_ESI = (char *)0x42be85;
        pIVar2 = (IGrim2D *)
                 (*pIVar4->grim_get_texture_handle)
                           ((IGrim2D *)s_logo_esrb_004746d8,(char *)in_stack_fffffff4);
        unaff_EBP = 6.129506e-39;
        (*pIVar4->grim_destroy_texture)(pIVar2,(int)in_stack_fffffff8);
      }
      goto LAB_0042bea6;
    }
  }
  else if (DAT_004aaf9c != '\0') goto LAB_0042b35f;
  _DAT_004aaf90 = _DAT_004aaf90 + frame_dt;
LAB_0042bea6:
  fVar7 = 1.0;
  uVar8 = 0;
  (*grim_interface_ptr->vtable->grim_clear_color)((IGrim2D *)0x0,0.0,0.0,1.0,(float)unaff_ESI);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,uVar8);
  pcVar6 = (char *)(_DAT_004aaf90 + _DAT_004aaf90);
  if ((float)pcVar6 <= 1.0) {
    if ((float)pcVar6 < 0.0) {
      pcVar6 = (char *)0x0;
    }
  }
  else {
    pcVar6 = (char *)0x3f800000;
  }
  handle_00 = pcVar6;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,(float)pcVar6,fVar7);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)unaff_ESI);
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,unaff_EBP);
  pIVar4 = grim_interface_ptr->vtable;
  pIVar2 = (IGrim2D *)
           (*pIVar4->grim_get_texture_handle)((IGrim2D *)s_logo_esrb_004746d8,(char *)0x0);
  (*pIVar4->grim_bind_texture)(pIVar2,(int)handle_00,(int)in_stack_fffffff8);
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_fffffffc);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)((screen_width_f - 256.0) - 1.0),(_DAT_00471144 - 128.0) - 1.0,256.0,128.0,
             unaff_retaddr);
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000004);
  pIVar4 = grim_interface_ptr->vtable;
  pIVar2 = (IGrim2D *)(*pIVar4->grim_get_texture_handle)((IGrim2D *)s_loading_004746e4,(char *)0x0);
  (*pIVar4->grim_bind_texture)(pIVar2,in_stack_00000008,(int)in_stack_0000000c);
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_00000010);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(screen_width_f * 0.5 + 128.0),_DAT_00471144 * 0.5 + 16.0,128.0,32.0,
             (float)in_stack_00000014);
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_00000018);
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_0000001c);
  pIVar4 = grim_interface_ptr->vtable;
  pIVar2 = (IGrim2D *)(*pIVar4->grim_get_texture_handle)((IGrim2D *)s_cl_logo_00471f70,(char *)0x0);
  (*pIVar4->grim_bind_texture)(pIVar2,(int)in_stack_00000020,(int)in_stack_00000024);
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(screen_width_f * 0.5 - 256.0),_DAT_00471144 * 0.5 - 32.0,512.0,64.0,
             (float)in_stack_00000028);
  (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)in_stack_0000002c);
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,(float)pcVar6,(float)in_stack_00000030);
  in_stack_0000002c = pcVar6;
  if (*(float *)((int)cv_silentloads + 0xc) == 0.0) {
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000040 * 0.7,in_stack_00000034);
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,screen_width_f * 0.5 - 246.0,_DAT_00471144 * 0.5 + 32.0,
               s_Grim_GFX__d__d_004746c8);
    in_stack_00000034 = 1.13505e-43;
    in_stack_00000030 = DAT_004cc8d8;
    in_stack_0000002c = s_Grim_SFX___d__d_004746b8;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,screen_width_f * 0.5 - 246.0,_DAT_00471144 * 0.5 + 45.0,
               s_Grim_SFX___d__d_004746b8);
  }
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,(uint)in_stack_0000002c);
  DAT_00496604 = (float)in_stack_0000003c * 0.7;
  (*grim_interface_ptr->vtable->grim_set_color_ptr)((IGrim2D *)&DAT_004965f8,in_stack_00000030);
  IStack00000044.vtable = (IGrim2D_vtbl *)0xc0800000;
  fStack00000048 = _DAT_00471144 * 0.5 - 68.0;
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            (&stack0x00000044,(float *)(screen_width_f + 8.0),128.0,in_stack_00000034);
  console_update(0x47eea0);
  FUN_00401dd0(&console_log_queue);
  if (*(float *)((int)cv_showFPS + 0xc) != 0.0) {
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,0.6,in_stack_00000038);
    (*grim_interface_ptr->vtable->grim_get_fps)(in_stack_0000003c);
    lVar5 = __ftol();
    pIVar4 = grim_interface_ptr->vtable;
    if ((int)lVar5 < 400) {
      (*pIVar4->grim_get_fps)(in_stack_00000040);
      __ftol();
      in_stack_0000003c = (IGrim2D *)&DAT_00471f40;
      in_stack_00000054 = config_blob.screen_width + -0x2d;
    }
    else {
      (*pIVar4->grim_get_fps)(in_stack_00000040);
      __ftol();
      in_stack_0000003c = (IGrim2D *)&DAT_00472990;
      in_stack_00000054 = config_blob.screen_width + -0x33;
    }
    in_stack_00000038 = (float)(config_blob.screen_height + -0x18);
    (*pIVar4->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)in_stack_00000054,in_stack_00000038,
               (char *)in_stack_0000003c);
  }
  Sleep(0x32);
  return;
}



/* console_cmd_snd_add_game_tune @ 0042c360 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* console command handler for snd_addGameTune; loads music\%s and queues the track */

void console_cmd_snd_add_game_tune(void)

{
  int iVar1;
  char *pcVar2;
  char acStack_400 [1024];
  
  iVar1 = console_cmd_argc_get();
  if (iVar1 != 2) {
    console_printf(&console_log_queue,s_snd_addGameTune_<tuneName_ogg>_0047474c);
    return;
  }
  pcVar2 = console_cmd_arg_get(1);
  crt_sprintf(acStack_400,s_music__s_00474740,pcVar2);
  iVar1 = music_load_track(acStack_400);
  if (-1 < iVar1) {
    music_queue_track(iVar1);
  }
  return;
}



/* console_cmd_set_gamma_ramp @ 0042c3d0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* console command handler for setGammaRamp; parses float and calls grim_set_config_var(0x1c) */

void console_cmd_set_gamma_ramp(void)

{
  int iVar1;
  char *locale;
  void *this;
  double dVar2;
  uint value;
  char *str;
  float id;
  
  iVar1 = console_cmd_argc_get();
  if (iVar1 != 2) {
    console_printf(&console_log_queue,s_setGammaRamp_<scalar_>_0>_004747e4);
    console_printf(&console_log_queue,s_Command_adjusts_gamma_ramp_linea_0047479c);
    return;
  }
  str = (char *)0x1;
  locale = console_cmd_arg_get(1);
  value = 0x42c40e;
  dVar2 = crt_atof_l(this,locale,str);
  id = (float)dVar2;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x1c,(uint)id,value);
  console_printf(&console_log_queue,s_Gamma_ramp_regenerated_and_multi_0047476c,
                 (double)(float)locale,locale,str,id);
  return;
}



/* crimsonland_main @ 0042c450 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Enum "_D3DFORMAT": Some values do not have unique names */
/* primary game init/run/shutdown sequence */

int crimsonland_main(void)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  HRESULT HVar4;
  IDirect3D8 *This;
  char *pcVar5;
  uchar *puVar6;
  float *pfVar7;
  int *piVar8;
  void *pvVar9;
  int *piVar10;
  LONG LVar11;
  int *piVar12;
  char *filename;
  char *filename_00;
  char *filename_01;
  char *extraout_EDX;
  char *extraout_EDX_00;
  char *filename_02;
  char *filename_03;
  char *filename_04;
  char *filename_05;
  char *extraout_EDX_01;
  char *extraout_EDX_02;
  char *extraout_EDX_03;
  char *extraout_EDX_04;
  char *filename_06;
  char *filename_07;
  char *extraout_EDX_05;
  char *extraout_EDX_06;
  char *extraout_EDX_07;
  int unaff_EBX;
  IGrim2D unaff_ESI;
  IGrim2D unaff_EDI;
  LPCCH pCVar13;
  float a;
  float a_00;
  HKEY key;
  undefined4 uVar14;
  IGrim2D *pIVar15;
  LPCSTR lpCaption;
  char *pcVar16;
  IGrim2D *self;
  undefined4 uVar17;
  undefined4 *puVar18;
  uint value;
  uint uVar19;
  IGrim2D value_00;
  IGrim2D id;
  int in_stack_fffffbdc;
  IGrim2D IStack_418;
  IGrim2D IStack_414;
  IGrim2D IStack_410;
  IGrim2D local_40c [3];
  WCHAR local_400 [512];
  
  uVar2 = FUN_004623b2((int *)0x0);
  crt_srand(uVar2);
  uVar2 = 0;
  iVar3 = dx_get_version((int *)&stack0xfffffbe0,(char *)local_40c,10);
  if (iVar3 < 0) {
    iVar3 = MessageBoxA((HWND)0x0,s_Unknown_DirectX_version_detected_00474d74,s_Crimsonland_00472d5c
                        ,4);
    if (iVar3 == 7) {
      return 0;
    }
  }
  else if (uVar2 < 0x80100) {
    iVar3 = MessageBoxA((HWND)0x0,s_DirectX8_1_or_newer_not_detected_00474e60,s_Crimsonland_00472d5c
                        ,0x23);
    if (iVar3 != 6) {
      return 0;
    }
    MultiByteToWideChar(0,0,s_http___www_microsoft_com_windows_00474e28,-1,local_400,0x104);
    HVar4 = HlinkNavigateString((IUnknown *)0x0,local_400);
    if (-1 < HVar4) {
      return 0;
    }
    MessageBoxA((HWND)0x0,s_Failed_to_launch_web_browser__00474e08,s_Crimsonland_00472d5c,0);
    return 0;
  }
  crt_getcwd(&game_base_path,0x103);
  GetCommandLineA();
  DAT_00473a64 = 0x7b;
  This = Direct3DCreate8(0xdc);
  console_printf(&console_log_queue,s_Crimsonland_00474d64);
  console_printf(&console_log_queue,s_____________00474d54);
  console_printf(&console_log_queue,&DAT_004711c0);
  console_flush_log(&console_log_queue,filename);
  if (This == (IDirect3D8 *)0x0) {
    MessageBoxA((HWND)0x0,s_DirectX8_1_not_detected__Crimson_00474cb8,s_Crimsonland_00472d5c,0);
    return 0;
  }
  (*This->lpVtbl->Release)(This);
  console_printf(&console_log_queue,s_Game_base_path____s__00474ca0);
  console_flush_log(&console_log_queue,filename_00);
  config_ensure_file();
  console_register_command(&console_log_queue,s_setGammaRamp_00474c90,console_cmd_set_gamma_ramp);
  console_register_command
            (&console_log_queue,s_snd_addGameTune_00474c80,console_cmd_snd_add_game_tune);
  console_register_command
            (&console_log_queue,s_generateterrain_00474c70,console_cmd_generate_terrain);
  console_register_command
            (&console_log_queue,s_telltimesurvived_00474c5c,console_cmd_tell_time_survived);
  console_register_command
            (&console_log_queue,s_setresourcepaq_00474c4c,console_cmd_set_resource_paq);
  console_register_command(&console_log_queue,s_loadtexture_00474c40,console_cmd_load_texture);
  console_register_command(&console_log_queue,s_openurl_00474c38,console_cmd_open_url);
  console_register_command
            (&console_log_queue,s_sndfreqadjustment_00474c24,console_cmd_snd_freq_adjustment);
  puVar18 = &DAT_004852d0;
  for (iVar3 = 0x3f; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar18 = 0;
    puVar18 = puVar18 + 1;
  }
  *(undefined2 *)puVar18 = 0;
  *(undefined1 *)((int)puVar18 + 2) = 0;
  DAT_004852d0._0_1_ = 0x53;
  DAT_004852d0._1_1_ = 0x6f;
  DAT_004852d0._2_1_ = 0x66;
  DAT_004852d0._3_1_ = 0x74;
  DAT_004852d4._0_1_ = 0x77;
  DAT_004852d4._1_1_ = 0x61;
  DAT_004852d6 = 0x72;
  DAT_004852d7 = 0x65;
  DAT_004852d8 = 0x5c;
  DAT_004852d9 = 0x53;
  DAT_004852da = 0x6f;
  DAT_004852db = 99;
  DAT_004852dc = 0x6b;
  grim_interface_ptr = (IGrim2D *)grim_load_interface(s____grim_grSystem_c_Release_grim__00474c00);
  console_printf(&console_log_queue,s________________________004740fc);
  console_printf(&console_log_queue,s_______Grim2D_API_______00474be8);
  console_printf(&console_log_queue,s________________________004740fc);
  console_printf(&console_log_queue,s_Initiating_Grim_00474bd4);
  console_flush_log(&console_log_queue,filename_01);
  DAT_004852e1 = 0x75;
  DAT_004852eb = 0x75;
  DAT_004852dd = 0x65;
  DAT_004852de = 0x74;
  DAT_004852df = 0x50;
  DAT_004852e0 = 0x6c;
  DAT_004852e2 = 0x67;
  DAT_004852e3 = 0x69;
  DAT_004852e4 = 0x6e;
  DAT_004852e5 = 0x73;
  DAT_004852e6 = 0x5c;
  DAT_004852e7 = 0x44;
  DAT_004852e8 = 0x65;
  DAT_004852e9 = 0x66;
  DAT_004852ea = 0x61;
  DAT_004852ec = 0x6c;
  DAT_004852ed = 0x74;
  DAT_004852ee = 0x5c;
  pcVar5 = extraout_EDX;
  if (grim_interface_ptr == (IGrim2D *)0x0) {
    console_printf(&console_log_queue,s____DEV_dll_not_found__trying_to_f_00474ba4);
    grim_interface_ptr = (IGrim2D *)grim_load_interface(s_grim_dll_00474b98);
    pcVar5 = extraout_EDX_00;
  }
  console_flush_log(&console_log_queue,pcVar5);
  if (grim_interface_ptr == grim_interface_ptr + 1) {
    console_printf(&console_log_queue,PTR_DAT_00473a14);
    console_printf(&console_log_queue,PTR_secret_hint_secret_weapons_00473a18);
    console_printf(&console_log_queue,PTR_secret_hint_redistr_build_00473a10);
    console_printf(&console_log_queue,PTR_secret_hint_not_meant_to_see_00473a1c);
    console_printf(&console_log_queue,PTR_secret_hint_alienzookeeper_00473a20);
    console_printf(&console_log_queue,PTR_secret_hint_secret_path_00473a24);
    console_printf(&console_log_queue,PTR_secret_hint_magic_paint_00473a28);
    console_printf(&console_log_queue,PTR_secret_hint_haxx0r_00473a34);
    console_printf(&console_log_queue,PTR_DAT_00473a2c);
  }
  if (grim_interface_ptr == (IGrim2D *)0x0) {
    MessageBoxA((HWND)0x0,s_Grim_dll_is_corrupted_or_missing_00474b10,&DAT_00474b90,0);
    return 0;
  }
  console_printf(&console_log_queue,s____interface_created_00474af8);
  console_printf(&console_log_queue,s____registering_core_variables_00474ad8);
  register_core_cvars();
  if (DAT_00473a64 != 0x7b) {
    grim_interface_ptr = (IGrim2D *)0x0;
  }
  console_flush_log(&console_log_queue,filename_02);
  console_printf(&console_log_queue,s____loading_config_pre_sets_00474abc);
  config_load_presets();
  game_load_status();
  game_sequence_load();
  console_flush_log(&console_log_queue,filename_03);
  console_printf(&console_log_queue,s____invoking_grim_config_00474aa0);
  console_flush_log(&console_log_queue,filename_04);
  iVar3 = (*grim_interface_ptr->vtable->grim_apply_config)((IGrim2D *)unaff_EDI.vtable);
  grim_config_invoked = 1;
  if ((char)iVar3 == '\0') {
    config_sync_from_grim();
    grim_config_invoked = 0;
    (*grim_interface_ptr->vtable->grim_release)((IGrim2D *)unaff_ESI.vtable);
    return 0;
  }
  config_sync_from_grim();
  grim_config_invoked = 0;
  config_load_presets();
  console_printf(&console_log_queue,s____setting_system_states_00474a84);
  console_flush_log(&console_log_queue,filename_05);
  pcVar5 = (char *)(*grim_interface_ptr->vtable->grim_get_config_var)
                             (&IStack_418,(uint *)0x54,(int)unaff_ESI.vtable);
  terrain_texture_failed = *pcVar5;
  puVar6 = (uchar *)(*grim_interface_ptr->vtable->grim_get_config_var)
                              (&IStack_414,(uint *)0x53,unaff_EBX);
  DAT_004aaeea = *puVar6;
  pfVar7 = (float *)(*grim_interface_ptr->vtable->grim_get_config_var)
                              (&IStack_410,(uint *)0x59,in_stack_fffffbdc);
  config_blob.reserved0._112_4_ = *pfVar7;
  if (((((float)config_blob.reserved0._112_4_ != 0.5) &&
       ((float)config_blob.reserved0._112_4_ != 1.0)) &&
      ((float)config_blob.reserved0._112_4_ != 2.0)) &&
     ((float)config_blob.reserved0._112_4_ != 4.0)) {
    config_blob.reserved0[0x70] = '\0';
    config_blob.reserved0[0x71] = '\0';
    config_blob.reserved0[0x72] = 0x80;
    config_blob.reserved0[0x73] = '?';
  }
  config_blob.reserved0[0] = DAT_004aaeea;
  id.vtable = (IGrim2D_vtbl *)0x42cac3;
  pcVar5 = (char *)(*grim_interface_ptr->vtable->grim_get_config_var)(local_40c,(uint *)0x8,uVar2);
  config_blob.windowed._0_1_ = *pcVar5;
  if (terrain_texture_failed == '\0') {
    pcVar5 = s____using_PRIMARY_backend_00474a44;
  }
  else {
    pcVar5 = s____using_SAFEMODE_fallback_backe_00474a60;
  }
  uVar2 = 0x42cae9;
  console_printf(&console_log_queue,pcVar5);
  pcVar5 = extraout_EDX_01;
  if (grim_interface_ptr == (IGrim2D *)0x0) {
    uVar2 = 0x42cb04;
    console_printf(&console_log_queue,s____using_DEVELOPER_backend_00474a28);
    pcVar5 = extraout_EDX_02;
  }
  console_flush_log(&console_log_queue,pcVar5);
  value_00.vtable = (IGrim2D_vtbl *)0x2d;
  uVar19 = 0x42cb2f;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x2d,(uint)id.vtable,uVar2);
  value = 5;
  uVar2 = 0x42cb48;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x5,uVar19,(uint)value_00.vtable);
  uVar19 = 6;
  uVar17 = 0x42cb61;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x6,uVar2,value);
  uVar2 = 0x42cb76;
  (*grim_interface_ptr->vtable->grim_set_config_var)
            ((IGrim2D *)0x42,CONCAT31((int3)((uint)uVar17 >> 8),1),uVar19);
  puVar18 = &console_log_queue;
  uVar19 = 0x42cb85;
  console_printf(&console_log_queue,s____setting_system_states_00474a84);
  pcVar5 = s_Crimsonland_00472d5c;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x7,uVar2,uVar19);
  piVar8 = (int *)(*grim_interface_ptr->vtable->grim_get_config_var)
                            ((IGrim2D *)&stack0xfffffbd0,(uint *)0x29,(int)puVar18);
  config_blob.screen_width = *piVar8;
  piVar8 = (int *)(*grim_interface_ptr->vtable->grim_get_config_var)
                            ((IGrim2D *)&stack0xfffffbd4,(uint *)0x2a,(int)pcVar5);
  config_blob.screen_height = *piVar8;
  if ((char)config_blob.windowed == '\0') {
    pcVar16 = s____selected_fullscreen_mode__dx__004749d0;
    pcVar5 = (char *)config_blob.screen_width;
    console_printf(&console_log_queue,s____selected_fullscreen_mode__dx__004749d0);
  }
  else {
    pcVar5 = s____selected_windowed_mode__windo_004749f8;
    pcVar16 = (char *)&console_log_queue;
    console_printf(&console_log_queue,s____selected_windowed_mode__windo_004749f8);
  }
  DAT_004aaeda = config_blob.reserved0[1];
  uVar14 = 0x42cc37;
  (*grim_interface_ptr->vtable->grim_set_config_var)
            ((IGrim2D *)0xb,CONCAT31((int3)((uint)pcVar16 >> 8),1),(uint)pcVar5);
  self = (IGrim2D *)&console_log_queue;
  uVar2 = 0x42cc46;
  console_printf(&console_log_queue,s____using_keyboard_004749bc);
  uVar17 = 0x42cc5b;
  (*grim_interface_ptr->vtable->grim_set_config_var)
            ((IGrim2D *)0xc,CONCAT31((int3)((uint)uVar14 >> 8),1),uVar2);
  pcVar5 = s____using_mouse_004749ac;
  pIVar15 = (IGrim2D *)&console_log_queue;
  uVar2 = 0x42cc6a;
  console_printf(&console_log_queue,s____using_mouse_004749ac);
  (*grim_interface_ptr->vtable->grim_set_config_var)
            ((IGrim2D *)0xe,CONCAT31((int3)((uint)uVar17 >> 8),1),uVar2);
  console_printf(&console_log_queue,s____using_joystick_00474998);
  puVar18 = &console_log_queue;
  uVar17 = 0x42cca0;
  console_printf(&console_log_queue,s____initiating_Grim_system_0047497c);
  iVar3 = (*grim_interface_ptr->vtable->grim_init_system)(pIVar15);
  if ((char)iVar3 == '\0') {
    console_printf(&console_log_queue,s_Critical_failure__00474968);
    lpCaption = (LPCSTR)0x0;
    pcVar16 = (*grim_interface_ptr->vtable->grim_get_error_text)((IGrim2D *)s_Crimsonland__00474958)
    ;
    MessageBoxA((HWND)0x0,pcVar16,lpCaption,(UINT)pcVar5);
    (*grim_interface_ptr->vtable->grim_release)(self);
    return 0;
  }
  console_exec_line(&console_log_queue,s_exec_autoexec_txt_00474944);
  uVar19 = 0x12;
  (*grim_interface_ptr->vtable->grim_set_config_var)
            ((IGrim2D *)0x12,CONCAT31((int3)((uint)uVar17 >> 8),1),(uint)puVar18);
  uVar2 = 0x13;
  key = (HKEY)0x5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,uVar19);
  uVar19 = 0x14;
  pIVar15 = (IGrim2D *)0x6;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar2);
  uVar2 = 0x42cd61;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f800000,uVar19);
  screen_width_f = (float)config_blob.screen_width;
  _DAT_00471144 = (float)config_blob.screen_height;
  pvVar9 = console_register_cvar(&console_log_queue,s_v_width_00474938,&DAT_00474940);
  pcVar5 = s_v_height_00474928;
  *(float *)((int)pvVar9 + 0xc) = (float)config_blob.screen_width;
  uVar19 = 0x42cdaa;
  pvVar9 = console_register_cvar(&console_log_queue,s_v_height_00474928,&DAT_00474934);
  *(float *)((int)pvVar9 + 0xc) = (float)config_blob.screen_height;
  init_audio_and_terrain();
  pcVar16 = s_crimson_paq_0047491c;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x10,uVar2,uVar19);
  console_printf(&console_log_queue,s_Set_resource_paq_to__crimson_paq_004748f8);
  texture_get_or_load(s_backplasma_0047296c,s_load_backplasma_jaz_004748e4);
  texture_get_or_load(s_mockup_00472964,s_load_mockup_jaz_004748d4);
  texture_get_or_load(s_logo_esrb_004746d8,s_load_esrb_mature_jaz_004748bc);
  texture_get_or_load(s_loading_004746e4,s_load_loading_jaz_004748a8);
  texture_get_or_load(s_cl_logo_00471f70,s_load_logo_crimsonland_tga_0047488c);
  a_00 = 1.0;
  uVar2 = 0;
  uVar17 = 0;
  (*grim_interface_ptr->vtable->grim_clear_color)((IGrim2D *)0x0,0.0,0.0,1.0,(float)pcVar5);
  (*grim_interface_ptr->vtable->grim_set_config_var)
            ((IGrim2D *)0x36,CONCAT31((int3)((uint)uVar17 >> 8),1),uVar2);
  a = 1.0;
  uVar2 = 0;
  uVar17 = 0;
  (*grim_interface_ptr->vtable->grim_clear_color)((IGrim2D *)0x0,0.0,0.0,1.0,a_00);
  (*grim_interface_ptr->vtable->grim_set_config_var)
            ((IGrim2D *)0x36,CONCAT31((int3)((uint)uVar17 >> 8),1),uVar2);
  (*grim_interface_ptr->vtable->grim_clear_color)((IGrim2D *)0x0,0.0,0.0,1.0,a);
  uVar2 = DAT_00473a30;
  _key_char_count = 0;
  puVar18 = &key_char_buffer;
  for (uVar19 = DAT_00473a30 >> 2; uVar19 != 0; uVar19 = uVar19 - 1) {
    *puVar18 = 0;
    puVar18 = puVar18 + 1;
  }
  for (uVar19 = uVar2 & 3; uVar19 != 0; uVar19 = uVar19 - 1) {
    *(undefined1 *)puVar18 = 0;
    puVar18 = (undefined4 *)((int)puVar18 + 1);
  }
  (*grim_interface_ptr->vtable->grim_set_key_char_buffer)
            ((IGrim2D *)&key_char_buffer,&key_char_count,(int *)uVar2,(int)a_00);
  config_sync_from_grim();
  piVar12 = &player_health.input.move_key_backward;
  piVar8 = config_blob.keybinds_p1 + 0xc;
  do {
    piVar10 = piVar8 + 0x10;
    ((player_input_t *)(piVar12 + -1))->move_key_forward = piVar8[-0xc];
    *piVar12 = piVar8[-0xb];
    piVar12[1] = piVar8[-10];
    piVar12[2] = piVar8[-9];
    piVar12[3] = piVar8[-8];
    piVar12[4] = piVar8[-7];
    piVar12[5] = piVar8[-6];
    piVar12[6] = piVar8[-5];
    piVar12[7] = piVar8[-4];
    piVar12[9] = piVar8[-3];
    piVar12[8] = piVar8[-2];
    piVar12[0xb] = piVar8[-1];
    piVar12[10] = *piVar8;
    piVar12 = piVar12 + 0xd8;
    piVar8 = piVar10;
  } while ((int)piVar10 < 0x4805c0);
  (*grim_interface_ptr->vtable->grim_apply_settings)((IGrim2D *)pcVar5);
  LVar11 = RegCreateKeyExA((HKEY)0x80000001,s_Software_10tons_entertainment_Cr_00474604,0,(LPSTR)0x0
                           ,0,0xf003f,(LPSECURITY_ATTRIBUTES)0x0,(PHKEY)&stack0xfffffb98,
                           (LPDWORD)0x0);
  if (LVar11 == 0) {
    reg_write_dword((HKEY)key,s_timePlayed_004745f8,DAT_0048718c);
    RegCloseKey(key);
  }
  else {
    console_printf(&console_log_queue,s_Kameli_was_NOT_hairy__00474874);
  }
  game_save_status();
  console_printf(&console_log_queue,s_Leaving_Crimsonland___0047485c);
  pcVar5 = extraout_EDX_03;
  if (DAT_004aaee4 != (void *)0x0) {
    crt_free(DAT_004aaee4);
    pcVar5 = extraout_EDX_04;
  }
  console_flush_log(&console_log_queue,pcVar5);
  audio_shutdown_all();
  console_printf(&console_log_queue,s_Shutdown_Grim___00474848);
  (*grim_interface_ptr->vtable->grim_shutdown)((IGrim2D *)pcVar16);
  console_flush_log(&console_log_queue,filename_06);
  (*grim_interface_ptr->vtable->grim_release)(pIVar15);
  console_printf(&console_log_queue,s_Waving_the_Grim_Reaper_goodbye___00474824);
  console_flush_log(&console_log_queue,filename_07);
  pcVar5 = extraout_EDX_05;
  if (((DAT_004d11f0 == 0) && (DAT_004d11f8 != '\0')) && (DAT_004d11f4 != (LPCCH)0x0)) {
    Sleep(200);
    puVar18 = (undefined4 *)&stack0xfffffbc6;
    for (iVar3 = 0xff; iVar3 != 0; iVar3 = iVar3 + -1) {
      *puVar18 = 0;
      puVar18 = puVar18 + 1;
    }
    *(undefined2 *)puVar18 = 0;
    uVar2 = 0xffffffff;
    pCVar13 = DAT_004d11f4;
    do {
      if (uVar2 == 0) break;
      uVar2 = uVar2 - 1;
      cVar1 = *pCVar13;
      pCVar13 = pCVar13 + 1;
    } while (cVar1 != '\0');
    MultiByteToWideChar(0,1,DAT_004d11f4,~uVar2 - 1,(LPWSTR)&stack0xfffffbc4,0x1ff);
    HVar4 = HlinkNavigateString((IUnknown *)0x0,(LPCWSTR)&stack0xfffffbc4);
    pcVar5 = extraout_EDX_06;
    if (HVar4 < 0) {
      console_printf(&console_log_queue,s_Failed_to_open_browser_at___s___00474800,DAT_004d11f4);
      pcVar5 = extraout_EDX_07;
    }
    DAT_004d11f8 = '\0';
  }
  console_flush_log(&console_log_queue,pcVar5);
  return 0;
}



/* effect_init_entry @ 0042de80 */

/* initializes an effect entry to default values */

void __cdecl effect_init_entry(void *entry)

{
  undefined4 *puVar1;
  int iVar2;
  
  *(undefined4 *)((int)entry + 0x2c) = 0;
  *(undefined4 *)((int)entry + 0x24) = 0;
  *(undefined4 *)((int)entry + 0x14) = 0;
  *(undefined4 *)((int)entry + 0x30) = 0x3f800000;
  *(undefined4 *)((int)entry + 0x34) = 0x3f800000;
  *(undefined4 *)((int)entry + 0x18) = 0x3f800000;
  *(undefined4 *)((int)entry + 0x38) = 0x3f800000;
  *(undefined4 *)((int)entry + 0x3c) = 0x3f800000;
  puVar1 = (undefined4 *)((int)entry + 0x50);
  iVar2 = 4;
  do {
    puVar1[2] = 0xffffffff;
    *puVar1 = 0x3f000000;
    puVar1[1] = 0x3f800000;
    puVar1 = puVar1 + 7;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  return;
}



/* effect_defaults_reset @ 0042df10 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* resets global effect template values */

void effect_defaults_reset(void)

{
  undefined4 *puVar1;
  
  _effect_template_color_r = 0x3f800000;
  _effect_template_color_g = 0x3f800000;
  _effect_template_color_b = 0x3f800000;
  _effect_template_color_a = 0x3f800000;
  _DAT_004ab1b0 = 0;
  _effect_template_flags = 1;
  _effect_template_rotation = 0;
  _effect_template_scale = 0x3f800000;
  _effect_template_age = 0;
  _effect_template_lifetime = 0x3f000000;
  _effect_template_half_height = 0x42000000;
  _effect_template_half_width = 0x42000000;
  _DAT_004ab1b4 = 0;
  _effect_template_rotation_step = 0x3f800000;
  _effect_template_scale_step = 0x3f800000;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  _DAT_004ab268 = 0;
  effect_pool_pos_x.quad_data[0x1c] = (float)&DAT_004ab3ec;
  effect_init_entry(&effect_pool_pos_x);
  puVar1 = &DAT_004ab4a4;
  do {
    *puVar1 = puVar1 + 1;
    effect_init_entry(puVar1 + -0x2e);
    puVar1 = puVar1 + 0x2f;
  } while ((int)puVar1 < 0x4c2b2c);
  _DAT_004c2a70 = &DAT_004c2a74;
  effect_init_entry(&DAT_004c29b8);
  effect_free_list_head = &effect_pool_pos_x;
  _DAT_004c2b34 = 0;
  return;
}



/* effect_free @ 0042e080 */

/* returns an effect entry to the free list */

void __cdecl effect_free(void *entry)

{
  *(void **)((int)entry + 0xb8) = effect_free_list_head;
  *(undefined4 *)((int)entry + 0x2c) = 0;
  effect_free_list_head = entry;
  return;
}



/* effect_select_texture @ 0042e0a0 */

/* selects effect texture page based on effect id */

void __cdecl effect_select_texture(int effect_id)

{
  int iVar1;
  int atlas_size;
  int unaff_retaddr;
  
  iVar1 = *(int *)(&effect_id_size_code + effect_id * 8);
  atlas_size = *(int *)(&effect_id_frame + effect_id * 8);
  if (iVar1 == 0x10) {
    (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x10,atlas_size,unaff_retaddr);
    return;
  }
  if (iVar1 == 0x20) {
    (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x8,atlas_size,unaff_retaddr);
    return;
  }
  if (iVar1 == 0x40) {
    (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x4,atlas_size,unaff_retaddr);
    return;
  }
  if (iVar1 == 0x80) {
    (*grim_interface_ptr->vtable->grim_set_atlas_frame)((IGrim2D *)0x2,atlas_size,unaff_retaddr);
  }
  return;
}



/* effect_spawn @ 0042e120 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* allocates an effect entry and assigns quad UVs */

void * __cdecl effect_spawn(int effect_id,float *pos)

{
  float fVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  float *pfVar5;
  int iVar6;
  float *pfVar7;
  float *pfVar8;
  
  if (config_blob.detail_preset < 3) {
    uVar4 = DAT_004c2b38 & 1;
    DAT_004c2b38 = DAT_004c2b38 + 1;
    if (uVar4 != 0) {
      return &DAT_004ab270;
    }
  }
  iVar2 = *(int *)(&effect_id_size_code + effect_id * 8);
  iVar3 = *(int *)(&effect_id_frame + effect_id * 8);
  pfVar5 = effect_free_list_head;
  pfVar7 = (float *)effect_free_list_head[0x2e];
  if ((float *)effect_free_list_head[0x2e] == (float *)0x0) {
    pfVar5 = (float *)&DAT_004ab270;
    pfVar7 = effect_free_list_head;
  }
  effect_free_list_head = pfVar7;
  pfVar7 = (float *)&effect_template_vel_x;
  pfVar8 = pfVar5 + 3;
  for (iVar6 = 0xf; iVar6 != 0; iVar6 = iVar6 + -1) {
    *pfVar8 = *pfVar7;
    pfVar7 = pfVar7 + 1;
    pfVar8 = pfVar8 + 1;
  }
  *pfVar5 = *pos;
  pfVar5[1] = pos[1];
  *(char *)(pfVar5 + 2) = (char)effect_id;
  if (iVar2 == 0x10) {
    pfVar5[0x17] = (float)(&effect_uv16_u)[iVar3 * 2];
    pfVar5[0x18] = (float)(&effect_uv16_v)[iVar3 * 2];
    fVar1 = -_effect_template_half_height;
    pfVar5[0x12] = -_effect_template_half_width;
    pfVar5[0x13] = fVar1;
    fVar1 = (float)(&effect_uv16_v)[iVar3 * 2];
    pfVar5[0x1e] = _effect_uv_step_16 + (float)(&effect_uv16_u)[iVar3 * 2];
    pfVar5[0x1f] = fVar1;
    fVar1 = -_effect_template_half_height;
    pfVar5[0x19] = _effect_template_half_width;
    pfVar5[0x1a] = fVar1;
    fVar1 = _effect_uv_step_16 + (float)(&effect_uv16_v)[iVar3 * 2];
    pfVar5[0x25] = _effect_uv_step_16 + (float)(&effect_uv16_u)[iVar3 * 2];
    pfVar5[0x26] = fVar1;
    fVar1 = _effect_template_half_height;
    pfVar5[0x20] = _effect_template_half_width;
    pfVar5[0x21] = fVar1;
    fVar1 = _effect_uv_step_16 + (float)(&effect_uv16_v)[iVar3 * 2];
    pfVar5[0x2c] = (float)(&effect_uv16_u)[iVar3 * 2];
    pfVar5[0x2d] = fVar1;
    fVar1 = _effect_template_half_height;
    pfVar5[0x27] = -_effect_template_half_width;
    pfVar5[0x28] = fVar1;
    return pfVar5;
  }
  if (iVar2 == 0x20) {
    pfVar5[0x17] = (float)(&effect_uv8_u)[iVar3 * 2];
    pfVar5[0x18] = (float)(&effect_uv8_v)[iVar3 * 2];
    fVar1 = -_effect_template_half_height;
    pfVar5[0x12] = -_effect_template_half_width;
    pfVar5[0x13] = fVar1;
    fVar1 = (float)(&effect_uv8_v)[iVar3 * 2];
    pfVar5[0x1e] = _effect_uv_step_8 + (float)(&effect_uv8_u)[iVar3 * 2];
    pfVar5[0x1f] = fVar1;
    fVar1 = -_effect_template_half_height;
    pfVar5[0x19] = _effect_template_half_width;
    pfVar5[0x1a] = fVar1;
    fVar1 = _effect_uv_step_8 + (float)(&effect_uv8_v)[iVar3 * 2];
    pfVar5[0x25] = _effect_uv_step_8 + (float)(&effect_uv8_u)[iVar3 * 2];
    pfVar5[0x26] = fVar1;
    fVar1 = _effect_template_half_height;
    pfVar5[0x20] = _effect_template_half_width;
    pfVar5[0x21] = fVar1;
    fVar1 = _effect_uv_step_8 + (float)(&effect_uv8_v)[iVar3 * 2];
    pfVar5[0x2c] = (float)(&effect_uv8_u)[iVar3 * 2];
    pfVar5[0x2d] = fVar1;
    fVar1 = _effect_template_half_height;
    pfVar5[0x27] = -_effect_template_half_width;
    pfVar5[0x28] = fVar1;
    return pfVar5;
  }
  if (iVar2 != 0x40) {
    if (iVar2 == 0x80) {
      pfVar5[0x17] = (float)(&effect_uv2_u)[iVar3 * 2];
      pfVar5[0x18] = (float)(&effect_uv2_v)[iVar3 * 2];
      fVar1 = -_effect_template_half_height;
      pfVar5[0x12] = -_effect_template_half_width;
      pfVar5[0x13] = fVar1;
      fVar1 = (float)(&effect_uv2_v)[iVar3 * 2];
      pfVar5[0x1e] = _effect_uv_step_2 + (float)(&effect_uv2_u)[iVar3 * 2];
      pfVar5[0x1f] = fVar1;
      fVar1 = -_effect_template_half_height;
      pfVar5[0x19] = _effect_template_half_width;
      pfVar5[0x1a] = fVar1;
      fVar1 = _effect_uv_step_2 + (float)(&effect_uv2_v)[iVar3 * 2];
      pfVar5[0x25] = _effect_uv_step_2 + (float)(&effect_uv2_u)[iVar3 * 2];
      pfVar5[0x26] = fVar1;
      fVar1 = _effect_template_half_height;
      pfVar5[0x20] = _effect_template_half_width;
      pfVar5[0x21] = fVar1;
      fVar1 = _effect_uv_step_2 + (float)(&effect_uv2_v)[iVar3 * 2];
      pfVar5[0x2c] = (float)(&effect_uv2_u)[iVar3 * 2];
      pfVar5[0x2d] = fVar1;
      fVar1 = _effect_template_half_height;
      pfVar5[0x27] = -_effect_template_half_width;
      pfVar5[0x28] = fVar1;
    }
    return pfVar5;
  }
  pfVar5[0x17] = (float)(&effect_uv4_u)[iVar3 * 2];
  pfVar5[0x18] = (float)(&effect_uv4_v)[iVar3 * 2];
  fVar1 = -_effect_template_half_height;
  pfVar5[0x12] = -_effect_template_half_width;
  pfVar5[0x13] = fVar1;
  fVar1 = (float)(&effect_uv4_v)[iVar3 * 2];
  pfVar5[0x1e] = _effect_uv_step_4 + (float)(&effect_uv4_u)[iVar3 * 2];
  pfVar5[0x1f] = fVar1;
  fVar1 = -_effect_template_half_height;
  pfVar5[0x19] = _effect_template_half_width;
  pfVar5[0x1a] = fVar1;
  fVar1 = _effect_uv_step_4 + (float)(&effect_uv4_v)[iVar3 * 2];
  pfVar5[0x25] = _effect_uv_step_4 + (float)(&effect_uv4_u)[iVar3 * 2];
  pfVar5[0x26] = fVar1;
  fVar1 = _effect_template_half_height;
  pfVar5[0x20] = _effect_template_half_width;
  pfVar5[0x21] = fVar1;
  fVar1 = _effect_uv_step_4 + (float)(&effect_uv4_v)[iVar3 * 2];
  pfVar5[0x2c] = (float)(&effect_uv4_u)[iVar3 * 2];
  pfVar5[0x2d] = fVar1;
  fVar1 = _effect_template_half_height;
  pfVar5[0x27] = -_effect_template_half_width;
  pfVar5[0x28] = fVar1;
  return pfVar5;
}



/* effects_update @ 0042e710 */

/* ticks active effects and frees expired entries */

void effects_update(void)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float *pfVar4;
  
  pfVar4 = &effect_pool_pos_x.age;
  do {
    fVar1 = pfVar4[2];
    if (fVar1 != 0.0) {
      fVar2 = frame_dt + *pfVar4;
      *pfVar4 = fVar2;
      if (fVar2 < pfVar4[1]) {
        if (0.0 <= fVar2) {
          fVar3 = frame_dt * pfVar4[-5];
          ((effect_entry_t *)(pfVar4 + -9))->pos_x =
               frame_dt * pfVar4[-6] + ((effect_entry_t *)(pfVar4 + -9))->pos_x;
          pfVar4[-8] = fVar3 + pfVar4[-8];
          if (((uint)fVar1 & 4) != 0) {
            pfVar4[-4] = frame_dt * pfVar4[7] + pfVar4[-4];
          }
          if (((uint)fVar1 & 8) != 0) {
            pfVar4[-3] = frame_dt * pfVar4[8] + pfVar4[-3];
          }
          if (((uint)fVar1 & 0x10) != 0) {
            pfVar4[6] = 1.0 - fVar2 / pfVar4[1];
          }
        }
      }
      else {
        if (((uint)fVar1 & 0x80) != 0) {
          if (((uint)fVar1 & 0x100) == 0) {
            pfVar4[6] = 0.8;
          }
          else {
            pfVar4[6] = 0.35;
          }
          fx_queue_add((uint)*(byte *)(pfVar4 + -7),(float *)(pfVar4 + -9),pfVar4[-2] + pfVar4[-2],
                       pfVar4[-1] + pfVar4[-1],pfVar4[-4],pfVar4 + 3);
        }
        effect_free((effect_entry_t *)(pfVar4 + -9));
      }
    }
    pfVar4 = pfVar4 + 0x2f;
  } while ((int)pfVar4 < 0x4c2b54);
  return;
}



/* effects_render @ 0042e820 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders active effects (rotated quads) */

void effects_render(void)

{
  float10 fVar1;
  float10 fVar2;
  uint value;
  int iVar3;
  float *pfVar4;
  IGrim2D *in_stack_ffffffcc;
  IGrim2D *self;
  IGrim2D *in_stack_ffffffd0;
  float fStack_20;
  float fStack_1c;
  float fStack_18;
  float fStack_14;
  float fStack_10;
  float fStack_c;
  
  value = 0x13;
  iVar3 = 5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)in_stack_ffffffcc);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,value);
  (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)particles_texture,0,iVar3);
  pfVar4 = (float *)0x42e879;
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_ffffffcc);
  iVar3 = 0x4ab364;
  do {
    if (((*(uint *)(iVar3 + -8) != 0) && (0.0 <= *(float *)(iVar3 + -0x10))) &&
       ((*(uint *)(iVar3 + -8) & 0x40) != 0)) {
      fVar1 = (float10)fcos((float10)*(float *)(iVar3 + -0x20));
      fVar2 = (float10)fsin((float10)*(float *)(iVar3 + -0x20));
      fStack_18 = (float)fVar1 * *(float *)(iVar3 + -0x1c);
      fStack_14 = (float)-fVar2 * *(float *)(iVar3 + -0x1c);
      fStack_10 = (float)fVar2 * *(float *)(iVar3 + -0x1c);
      fStack_c = (float)(fVar1 * (float10)*(float *)(iVar3 + -0x1c));
      __ftol();
      __ftol();
      __ftol();
      __ftol();
      fStack_20 = _camera_offset_x + *(float *)(iVar3 + -0x34);
      fStack_1c = _camera_offset_y + *(float *)(iVar3 + -0x30);
      pfVar4 = &fStack_18;
      (*grim_interface_ptr->vtable->grim_submit_vertices_transform_color)
                ((IGrim2D *)(iVar3 + 0x14),(float *)0x4,(int)&fStack_20,pfVar4,
                 (float *)&stack0xffffffd8,(float *)in_stack_ffffffd0);
    }
    iVar3 = iVar3 + 0xbc;
  } while (iVar3 < 0x4c2b64);
  self = (IGrim2D *)0x42e99d;
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_ffffffd0);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,(uint)pfVar4);
  pfVar4 = (float *)0x42e9c3;
  (*grim_interface_ptr->vtable->grim_begin_batch)(self);
  iVar3 = 0x4ab364;
  do {
    if (((*(uint *)(iVar3 + -8) != 0) && (0.0 <= *(float *)(iVar3 + -0x10))) &&
       ((*(uint *)(iVar3 + -8) & 0x40) == 0)) {
      fVar1 = (float10)fcos((float10)*(float *)(iVar3 + -0x20));
      fVar2 = (float10)fsin((float10)*(float *)(iVar3 + -0x20));
      fStack_18 = (float)fVar1 * *(float *)(iVar3 + -0x1c);
      fStack_14 = (float)-fVar2 * *(float *)(iVar3 + -0x1c);
      fStack_10 = (float)fVar2 * *(float *)(iVar3 + -0x1c);
      fStack_c = (float)(fVar1 * (float10)*(float *)(iVar3 + -0x1c));
      __ftol();
      __ftol();
      __ftol();
      __ftol();
      fStack_20 = _camera_offset_x + *(float *)(iVar3 + -0x34);
      fStack_1c = _camera_offset_y + *(float *)(iVar3 + -0x30);
      pfVar4 = &fStack_18;
      (*grim_interface_ptr->vtable->grim_submit_vertices_transform_color)
                ((IGrim2D *)(iVar3 + 0x14),(float *)0x4,(int)&fStack_20,pfVar4,
                 (float *)&stack0xffffffd8,(float *)in_stack_ffffffd0);
    }
    iVar3 = iVar3 + 0xbc;
  } while (iVar3 < 0x4c2b64);
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_ffffffd0);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,(uint)pfVar4);
  return;
}



/* effect_spawn_blood_splatter @ 0042eb10 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* spawns blood splatter particles (effect id 7) */

void __cdecl effect_spawn_blood_splatter(float *pos,float angle,float age)

{
  uint uVar1;
  int iVar2;
  float10 fVar3;
  float10 fVar4;
  float10 fVar5;
  
  if (config_blob.fx_toggle == '\0') {
    _effect_template_lifetime = 0.25 - age;
    fVar3 = (float10)angle + (float10)3.1415927;
    _effect_template_color_r = 0x3f800000;
    _effect_template_color_g = 0x3f800000;
    fVar4 = (float10)fcos(fVar3);
    _effect_template_flags = 0xc9;
    _effect_template_color_b = 0x3f800000;
    _effect_template_color_a = 0x3f000000;
    _effect_template_scale_step = 0.0;
    _effect_template_age = age;
    iVar2 = 2;
    fVar5 = (float10)fsin(fVar3);
    do {
      uVar1 = crt_rand();
      _effect_template_rotation = (float)(int)((uVar1 & 0x3f) - 0x20) * 0.1 + (float)fVar3;
      uVar1 = crt_rand();
      _effect_template_half_width = (float)((uVar1 & 7) + 1);
      _effect_template_half_height = _effect_template_half_width;
      uVar1 = crt_rand();
      effect_template_vel_x = (float)((uVar1 & 0x3f) + 100) * (float)fVar4;
      uVar1 = crt_rand();
      _effect_template_rotation_step = 0;
      effect_template_vel_y = (float)((uVar1 & 0x3f) + 100) * (float)fVar5;
      uVar1 = crt_rand();
      _effect_template_scale_step = (float)(uVar1 & 0x7f) * 0.03 + 0.1;
      effect_spawn(7,pos);
      iVar2 = iVar2 + -1;
    } while (iVar2 != 0);
  }
  return;
}



/* effect_spawn_freeze_shard @ 0042ec80 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* spawns a random freeze shard effect (ids 8..10) around the given angle */

void __cdecl effect_spawn_freeze_shard(float *pos,float angle)

{
  float fVar1;
  uint uVar2;
  int iVar3;
  float10 fVar4;
  
  _effect_template_color_r = 0x3f800000;
  _effect_template_flags = 0x1cd;
  _effect_template_color_g = 0x3f800000;
  _effect_template_color_b = 0x3f800000;
  _effect_template_color_a = 0x3f000000;
  uVar2 = crt_rand();
  _effect_template_age = 0;
  _effect_template_half_width = 8.0;
  _effect_template_half_height = 8.0;
  _effect_template_lifetime = (float)(uVar2 & 0xf) * 0.01 + 0.2;
  fVar1 = angle + 3.1415927;
  iVar3 = crt_rand();
  _effect_template_rotation = (float)(iVar3 % 100) * 0.01 + fVar1;
  iVar3 = crt_rand();
  _effect_template_half_width = (float)(iVar3 % 5 + 7);
  fVar4 = (float10)fcos((float10)fVar1);
  effect_template_vel_x = (float)(fVar4 * (float10)114.0);
  fVar4 = (float10)fsin((float10)fVar1);
  effect_template_vel_y = (float)(fVar4 * (float10)114.0);
  _effect_template_half_height = _effect_template_half_width;
  iVar3 = crt_rand();
  _effect_template_rotation_step = ((float)(iVar3 % 0x14) * 0.1 - 1.0) * 4.0;
  uVar2 = crt_rand();
  _effect_template_scale_step = (float)(int)-(uVar2 & 0xf) * 0.1;
  iVar3 = crt_rand();
  effect_spawn(iVar3 % 3 + 8,pos);
  return;
}



/* effect_spawn_freeze_shatter @ 0042ee00 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* four-way shatter burst (id 0xe) plus extra freeze shards */

void __cdecl effect_spawn_freeze_shatter(float *pos,float angle)

{
  int iVar1;
  int iVar2;
  float10 fVar3;
  undefined4 local_14;
  
  _effect_template_color_r = 0x3f800000;
  _effect_template_flags = 0x5d;
  _effect_template_color_g = 0x3f800000;
  _effect_template_color_b = 0x3f800000;
  _effect_template_color_a = 0x3f000000;
  _effect_template_age = 0;
  _effect_template_lifetime = 0x3f8ccccd;
  _effect_template_scale_step = 0;
  local_14 = 0;
  do {
    fVar3 = (float10)local_14 * (float10)1.5707964 + (float10)angle;
    _effect_template_rotation = (float)fVar3;
    fVar3 = (float10)fcos(fVar3);
    effect_template_vel_x = (float)(fVar3 * (float10)42.0);
    fVar3 = (float10)fsin((float10)_effect_template_rotation);
    effect_template_vel_y = (float)(fVar3 * (float10)42.0);
    iVar1 = crt_rand();
    _effect_template_half_width = (float)(iVar1 % 10 + 0x12);
    _effect_template_half_height = _effect_template_half_width;
    iVar1 = crt_rand();
    _effect_template_rotation_step = ((float)(iVar1 % 0x14) * 0.1 - 1.0) * 1.9;
    effect_spawn(0xe,pos);
    local_14 = local_14 + 1;
  } while (local_14 < 4);
  iVar1 = 4;
  do {
    iVar2 = crt_rand();
    effect_spawn_freeze_shard(pos,(float)(iVar2 % 0x264) * 0.01);
    iVar1 = iVar1 + -1;
  } while (iVar1 != 0);
  return;
}



/* effect_spawn_burst @ 0042ef60 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* generic burst loop for effect id 0 */

void __cdecl effect_spawn_burst(float *pos,int count)

{
  uint uVar1;
  int iVar2;
  
  _effect_template_color_r = 0x3ecccccd;
  _effect_template_flags = 0x1d;
  _effect_template_color_g = 0x3f000000;
  _effect_template_color_b = 0x3f800000;
  _effect_template_color_a = 0x3f000000;
  _effect_template_age = 0;
  _effect_template_lifetime = 0x3f000000;
  _effect_template_half_width = 0x42000000;
  _effect_template_half_height = 0x42000000;
  if (0 < count) {
    do {
      uVar1 = crt_rand();
      _effect_template_rotation = (float)(uVar1 & 0x7f) * 0.049087387;
      uVar1 = crt_rand();
      effect_template_vel_x = (float)(int)((uVar1 & 0x7f) - 0x40);
      uVar1 = crt_rand();
      effect_template_vel_y = (float)(int)((uVar1 & 0x7f) - 0x40);
      iVar2 = crt_rand();
      _effect_template_scale_step = (float)(iVar2 % 100) * 0.01 + 0.1;
      effect_spawn(0,pos);
      count = count + -1;
    } while (count != 0);
  }
  return;
}



/* FUN_0042f080 @ 0042f080 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] void* sub_42f080(float* arg1) */

void * __cdecl FUN_0042f080(float *arg1)

{
  uint uVar1;
  int iVar2;
  void *pvVar3;
  int iVar4;
  
  _effect_template_color_r = 0x3e99999a;
  _effect_template_flags = 0x19;
  _effect_template_color_g = 0x3f19999a;
  _effect_template_color_b = 0x3f666666;
  _effect_template_color_a = 0x3f800000;
  _effect_template_age = 0;
  _effect_template_lifetime = 0x3e99999a;
  _effect_template_half_width = 0x42100000;
  _effect_template_half_height = 0x42100000;
  _effect_template_rotation = 0.0;
  effect_template_vel_x = 0.0;
  effect_template_vel_y = 0.0;
  _effect_template_scale_step = -4.0;
  effect_spawn(1,arg1);
  _effect_template_color_b = 0x3f800000;
  _effect_template_color_r = 0x3ecccccd;
  _effect_template_flags = 0x1d;
  _effect_template_color_g = 0x3f000000;
  _effect_template_color_a = 0x3f000000;
  _effect_template_age = 0;
  _effect_template_lifetime = 0x3e99999a;
  _effect_template_half_width = 0x42000000;
  _effect_template_half_height = 0x42000000;
  iVar4 = 4;
  pvVar3 = (void *)config_blob.detail_preset;
  if (config_blob.detail_preset < 3) {
    iVar4 = 2;
  }
  for (; iVar4 != 0; iVar4 = iVar4 + -1) {
    uVar1 = crt_rand();
    _effect_template_rotation = (float)(uVar1 & 0x7f) * 0.049087387;
    uVar1 = crt_rand();
    effect_template_vel_x = (float)(int)((uVar1 & 0x7f) - 0x40) * 1.4;
    uVar1 = crt_rand();
    effect_template_vel_y = (float)(int)((uVar1 & 0x7f) - 0x40) * 1.4;
    iVar2 = crt_rand();
    _effect_template_scale_step = (float)(iVar2 % 100) * 0.01 + 0.1;
    pvVar3 = effect_spawn(0,arg1);
  }
  return pvVar3;
}



/* FUN_0042f270 @ 0042f270 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] void* sub_42f270(float* arg1, float arg2, float arg3) */

void * __cdecl FUN_0042f270(float *arg1,float arg2,float arg3)

{
  void *pvVar1;
  
  _effect_template_lifetime = arg3 * 0.8;
  _effect_template_color_g = 0x3f19999a;
  _effect_template_scale_step = arg2 * 45.0;
  _effect_template_color_r = 0x3f19999a;
  _effect_template_flags = 0x19;
  _effect_template_color_b = 0x3f666666;
  _effect_template_color_a = 0x3f800000;
  _effect_template_age = 0;
  _effect_template_half_width = 0x40800000;
  _effect_template_half_height = 0x40800000;
  _effect_template_rotation = 0;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  pvVar1 = effect_spawn(1,arg1);
  return pvVar1;
}



/* FUN_0042f330 @ 0042f330 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] void* sub_42f330(float* arg1, float arg2, int32_t arg3) */

void * __cdecl FUN_0042f330(float *arg1,float arg2,int arg3)

{
  void *pvVar1;
  
  _effect_template_scale_step = arg2 * 45.0;
  _effect_template_color_b = 0x3e99999a;
  _effect_template_color_r = 0x3f666666;
  _effect_template_color_g = 0x3f19999a;
  _effect_template_flags = 0x19;
  _effect_template_color_a = 0x3f800000;
  _effect_template_age = 0x3dcccccd;
  _effect_template_lifetime = arg3;
  _effect_template_half_width = 0x40800000;
  _effect_template_half_height = 0x40800000;
  _effect_template_rotation = 0;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  pvVar1 = effect_spawn(1,arg1);
  return pvVar1;
}



/* FUN_0042f3f0 @ 0042f3f0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] void* sub_42f3f0(float* arg1, float arg2, float arg3) */

void * __cdecl FUN_0042f3f0(float *arg1,float arg2,float arg3)

{
  float fVar1;
  uint uVar2;
  int iVar3;
  void *pvVar4;
  float10 fVar5;
  float10 fVar6;
  longlong lVar7;
  float local_10;
  float local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  local_10 = 1.0;
  local_c = 0.9;
  local_8 = 0x3dcccccd;
  local_4 = 0x3f800000;
  _effect_template_color_r = 0x3f800000;
  pvVar4 = (void *)0x3f800000;
  _effect_template_flags = 0x19;
  _effect_template_color_g = 0x3f666666;
  _effect_template_color_b = 0x3dcccccd;
  _effect_template_color_a = 0x3f800000;
  _effect_template_half_width = 0x40800000;
  _effect_template_half_height = 0x40800000;
  _effect_template_rotation = 0;
  effect_template_vel_x = 0;
  effect_template_vel_y = 0;
  _effect_template_scale_step = 0x425c0000;
  if (0 < (int)arg3) {
    lVar7 = __ftol();
    do {
      uVar2 = crt_rand();
      fVar1 = (float)(uVar2 & 0x1ff) * 0.001953125 * 6.2831855;
      iVar3 = crt_rand();
      fVar5 = (float10)(iVar3 % (int)lVar7);
      fVar6 = (float10)fcos((float10)fVar1);
      local_10 = (float)(fVar6 * fVar5 + (float10)*arg1);
      fVar6 = (float10)fsin((float10)fVar1);
      local_c = (float)(fVar6 * fVar5 + (float10)arg1[1]);
      uVar2 = crt_rand();
      _effect_template_age = (float)(int)-(uVar2 & 0xff) * 0.0012;
      _effect_template_lifetime = 0.1 - _effect_template_age;
      pvVar4 = effect_spawn(0,&local_10);
      arg3 = (float)((int)arg3 + -1);
    } while (arg3 != 0.0);
  }
  return pvVar4;
}



/* FUN_0042f540 @ 0042f540 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_42f540(int32_t arg1, float arg2) */

int __cdecl FUN_0042f540(int arg1,float arg2)

{
  float fVar1;
  void *pvVar2;
  uint uVar3;
  int iVar4;
  void *pvVar5;
  longlong lVar6;
  
  fVar1 = arg2 * 0.8;
  _effect_template_color_r = 0x3ecccccd;
  _effect_template_lifetime = fVar1 * 0.7;
  _effect_template_color_a = 0x3f000000;
  _effect_template_flags = 0x1d;
  _effect_template_color_g = 0x3f000000;
  _effect_template_color_b = 0x3f800000;
  _effect_template_age = 0;
  if (1.1 < _effect_template_lifetime) {
    _effect_template_lifetime = 1.1;
  }
  _effect_template_half_width = fVar1 * 32.0;
  _effect_template_half_height = _effect_template_half_width;
  lVar6 = __ftol();
  pvVar2 = (void *)lVar6;
  if (config_blob.detail_preset < 3) {
    pvVar2 = (void *)((int)pvVar2 / 2);
  }
  pvVar5 = pvVar2;
  if (0 < (int)pvVar2) {
    do {
      uVar3 = crt_rand();
      _effect_template_rotation = (float)(uVar3 & 0x7f) * 0.049087387;
      uVar3 = crt_rand();
      effect_template_vel_x = (float)(int)((uVar3 & 0x7f) - 0x40) * fVar1 * 1.4;
      uVar3 = crt_rand();
      effect_template_vel_y = (float)(int)((uVar3 & 0x7f) - 0x40) * fVar1 * 1.4;
      iVar4 = crt_rand();
      _effect_template_scale_step = ((float)(iVar4 % 100) * 0.01 + 0.1) * fVar1;
      pvVar2 = effect_spawn(0,(float *)arg1);
      pvVar5 = (void *)((int)pvVar5 + -1);
    } while (pvVar5 != (void *)0x0);
  }
  return (int)pvVar2;
}



/* effect_spawn_explosion_burst @ 0042f6c0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* spawns explosion burst and shockwave particles */

void __cdecl effect_spawn_explosion_burst(float *pos,float scale)

{
  float *pos_00;
  int iVar1;
  int iVar2;
  uint uVar3;
  
  pos_00 = pos;
  _effect_template_scale_step = scale * 25.0;
  _effect_template_color_r = 0x3f19999a;
  _effect_template_flags = 0x19;
  _effect_template_color_g = 0x3f19999a;
  _effect_template_color_b = 0x3f19999a;
  _effect_template_color_a = 0x3f800000;
  _effect_template_lifetime = 0.35;
  _effect_template_age = -0.1;
  _effect_template_half_width = 0x42000000;
  _effect_template_half_height = 0x42000000;
  _effect_template_rotation = 0.0;
  effect_template_vel_x = 0.0;
  effect_template_vel_y = 0.0;
  effect_spawn(1,pos);
  _effect_template_color_b = 0x3dcccccd;
  _effect_template_color_r = 0x3dcccccd;
  _effect_template_flags = 0x5d;
  _effect_template_color_g = 0x3dcccccd;
  _effect_template_color_a = 0x3f800000;
  _effect_template_rotation = 0.0;
  effect_template_vel_x = 0.0;
  effect_template_vel_y = 0.0;
  if (3 < config_blob.detail_preset) {
    pos = (float *)0x0;
    do {
      _effect_template_half_width = 0x42000000;
      _effect_template_half_height = 0x42000000;
      _effect_template_age = (float)(int)pos * 0.2 - 0.5;
      _effect_template_lifetime = (float)(int)pos * 0.2 + 0.6;
      iVar1 = crt_rand();
      _effect_template_rotation_step = 1.4;
      _effect_template_rotation = (float)(iVar1 % 0x266) * 0.02;
      _effect_template_scale_step = scale * 5.0;
      effect_spawn(0x11,pos_00);
      pos = (float *)((int)pos + 1);
    } while ((int)pos < 2);
  }
  _effect_template_scale_step = scale * 45.0;
  _effect_template_color_r = 0x3f800000;
  _effect_template_flags = 0x19;
  _effect_template_color_g = 0x3f800000;
  _effect_template_color_b = 0x3f800000;
  _effect_template_color_a = 0x3f800000;
  _effect_template_age = 0.0;
  _effect_template_lifetime = 0.3;
  _effect_template_half_width = 0x42000000;
  _effect_template_half_height = 0x42000000;
  _effect_template_rotation = 0.0;
  effect_template_vel_x = 0.0;
  effect_template_vel_y = 0.0;
  effect_spawn(0,pos_00);
  _effect_template_color_b = 0x3f800000;
  _effect_template_color_r = 0x3f800000;
  _effect_template_flags = 0x1d;
  _effect_template_color_g = 0x3f800000;
  _effect_template_color_a = 0x3f800000;
  _effect_template_lifetime = 0.7;
  _effect_template_age = 0.0;
  _effect_template_half_width = 0x42000000;
  _effect_template_half_height = 0x42000000;
  if (config_blob.detail_preset < 2) {
    iVar1 = 1;
  }
  else {
    iVar1 = (3 < config_blob.detail_preset) + 3;
  }
  for (; iVar1 != 0; iVar1 = iVar1 + -1) {
    iVar2 = crt_rand();
    _effect_template_rotation = (float)(iVar2 % 0x13a) * 0.02;
    uVar3 = crt_rand();
    effect_template_vel_x = (float)(int)((uVar3 & 0x3f) * 2 + -0x40);
    uVar3 = crt_rand();
    effect_template_vel_y = (float)(int)((uVar3 & 0x3f) * 2 + -0x40);
    iVar2 = crt_rand();
    _effect_template_scale_step = (float)(iVar2 - 3U & 7) * scale;
    iVar2 = crt_rand();
    _effect_template_rotation_step = (float)(iVar2 + 3U & 7);
    effect_spawn(0xc,pos_00);
  }
  return;
}



/* FUN_0042faa0 @ 0042faa0 */

/* [binja] int32_t sub_42faa0() */

int FUN_0042faa0(void)

{
  int extraout_EAX;
  
  crt_ehvec_ctor(&perk_name_table,0x14,0x80,&LAB_0042fac0,FUN_00412410);
  return extraout_EAX;
}



/* FUN_0042fae0 @ 0042fae0 */

/* [binja] int32_t sub_42fae0() */

int FUN_0042fae0(void)

{
  int iVar1;
  
  iVar1 = crt_atexit(&LAB_0042faf0);
  return iVar1;
}



/* perk_can_offer @ 0042fb10 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* returns nonzero when perk is eligible for selection */

int __cdecl perk_can_offer(int perk_index)

{
  int iVar1;
  uint uVar2;
  
  uVar2 = config_blob.reserved0._24_4_;
  if (((((config_blob.reserved0._24_4_ != 3) || (config_blob.hardcore == '\0')) ||
       (_quest_stage_minor != 10)) ||
      ((_quest_stage_major != 2 ||
       (((perk_index != perk_id_poison_bullets && (perk_index != perk_id_veins_of_poison)) &&
        (perk_index != perk_id_plaguebearer)))))) &&
     (((config_blob.reserved0._20_4_ != 2 || (((&perk_flags_table)[perk_index * 0x14] & 2) != 0)) &&
      ((config_blob.reserved0._24_4_ != 3 ||
       (uVar2 = perk_index * 5, ((&perk_flags_table)[perk_index * 0x14] & 1) != 0)))))) {
    iVar1 = *(int *)(&perk_prereq_table + perk_index * 0x14);
    if (iVar1 == -1) {
      return -0xff;
    }
    if (0 < *(int *)(player_health._pad0 + iVar1 * 4 + 0x94)) {
      return CONCAT31((int3)((uint)iVar1 >> 8),1);
    }
    uVar2 = game_is_full_version();
    if (((((char)uVar2 == '\0') && (perk_index != perk_id_living_fortress)) &&
        (perk_index != perk_id_man_bomb)) && (perk_index != perk_id_fire_caugh)) {
      uVar2 = perk_id_tough_reloader;
    }
  }
  return uVar2 & 0xffffff00;
}



/* perk_select_random @ 0042fbd0 */

/* randomly selects an eligible perk index */

int perk_select_random(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = 1;
  do {
    iVar1 = crt_rand();
    iVar1 = iVar1 % DAT_004c2c38 + 1;
    if ((&perk_available_table)[iVar1 * 0x14] != '\0') {
      iVar2 = perk_can_offer(iVar1);
      if ((char)iVar2 != '\0') {
        return iVar1;
      }
    }
    iVar3 = iVar3 + 1;
  } while (iVar3 < 0x3e9);
  console_printf(&console_log_queue,s___Perk_Randomizer_failed_to_gene_00475696 + 2);
  return perk_id_instant_winner;
}



/* perks_rebuild_available @ 0042fc30 */

/* rebuilds perk availability/unlock flags */

void perks_rebuild_available(void)

{
  int iVar1;
  int iVar2;
  undefined1 *puVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  
  iVar4 = DAT_004c2c38 + 1;
  if (0 < iVar4) {
    puVar3 = &perk_available_table;
    do {
      *puVar3 = 0;
      puVar3 = puVar3 + 0x14;
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
  }
  iVar4 = perk_id_antiperk;
  puVar3 = &DAT_004c2c60;
  (&perk_available_table)[perk_id_antiperk * 0x14] = 0;
  do {
    *puVar3 = 1;
    iVar1 = perk_id_fire_caugh;
    iVar5 = perk_id_living_fortress;
    iVar2 = quest_unlock_index;
    puVar3 = puVar3 + 0x14;
  } while ((int)puVar3 < 0x4c2e7c);
  (&perk_available_table)[perk_id_man_bomb * 0x14] = 1;
  (&perk_available_table)[iVar5 * 0x14] = 1;
  (&perk_available_table)[iVar1 * 0x14] = 1;
  (&perk_available_table)[perk_id_tough_reloader * 0x14] = 1;
  iVar5 = 0;
  if (0 < iVar2) {
    piVar6 = &quest_unlock_perk_id;
    do {
      if (0x484fe7 < (int)piVar6) break;
      iVar1 = *piVar6;
      iVar5 = iVar5 + 1;
      piVar6 = piVar6 + 0xb;
      (&perk_available_table)[iVar1 * 0x14] = 1;
    } while (iVar5 < iVar2);
  }
  (&perk_available_table)[iVar4 * 0x14] = 0;
  return;
}



/* perk_count_get @ 0042fcf0 */

/* returns perk count from DAT_00490968 */

int __cdecl perk_count_get(int perk_id)

{
  return *(int *)(player_health._pad0 + perk_id * 4 + 0x94);
}



/* FUN_0042fd00 @ 0042fd00 */

char * __thiscall FUN_0042fd00(uint3 param_1,char *param_2,int param_3)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  char *pcVar7;
  int iVar8;
  char *unaff_EDI;
  char *pcVar9;
  int in_stack_0000000c;
  undefined4 uStack_4;
  
  uVar4 = 0xffffffff;
  pcVar2 = param_2;
  do {
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    cVar1 = *pcVar2;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  iVar5 = ~uVar4 - 1;
  uStack_4 = (uint)param_1;
  pcVar2 = operator_new(~uVar4);
  uVar4 = 0xffffffff;
  do {
    pcVar7 = param_2;
    if (uVar4 == 0) break;
    uVar4 = uVar4 - 1;
    pcVar7 = param_2 + 1;
    cVar1 = *param_2;
    param_2 = pcVar7;
  } while (cVar1 != '\0');
  uVar4 = ~uVar4;
  pcVar7 = pcVar7 + -uVar4;
  pcVar9 = pcVar2;
  for (uVar6 = uVar4 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar9 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar9 = pcVar9 + 4;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *pcVar9 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar9 = pcVar9 + 1;
  }
  iVar8 = 0;
  if (0 < iVar5) {
    do {
      uStack_4._0_3_ = CONCAT12(pcVar2[iVar8],(undefined2)uStack_4);
      iVar3 = (*grim_interface_ptr->vtable->grim_measure_text_width)
                        ((IGrim2D *)((int)&uStack_4 + 2),unaff_EDI);
      param_3 = param_3 - iVar3;
      if (param_3 < 0) {
        do {
          iVar3 = iVar8 + -1;
          iVar8 = iVar8 + -1;
        } while (pcVar2[iVar3] != ' ');
        pcVar2[iVar8] = '\n';
        param_3 = in_stack_0000000c;
      }
      iVar8 = iVar8 + 1;
    } while (iVar8 < iVar5);
  }
  return pcVar2;
}



/* perks_init_database @ 0042fd90 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* builds the perk table (ids, names, descriptions) */

void __fastcall perks_init_database(void)

{
  char *pcVar1;
  char *pcVar2;
  int iVar3;
  uint3 in_ECX;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  char *pcVar4;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  undefined4 extraout_ECX_09;
  undefined4 extraout_ECX_10;
  undefined4 extraout_ECX_11;
  undefined4 extraout_ECX_12;
  undefined4 extraout_ECX_13;
  undefined4 extraout_ECX_14;
  undefined4 extraout_ECX_15;
  undefined4 extraout_ECX_16;
  undefined4 extraout_ECX_17;
  undefined4 extraout_ECX_18;
  undefined4 extraout_ECX_19;
  undefined4 extraout_ECX_20;
  undefined4 extraout_ECX_21;
  undefined4 extraout_ECX_22;
  undefined4 extraout_ECX_23;
  undefined4 extraout_ECX_24;
  undefined4 extraout_ECX_25;
  undefined4 extraout_ECX_26;
  undefined4 extraout_ECX_27;
  undefined4 extraout_ECX_28;
  undefined4 extraout_ECX_29;
  undefined4 extraout_ECX_30;
  undefined4 extraout_ECX_31;
  undefined4 extraout_ECX_32;
  undefined4 extraout_ECX_33;
  undefined4 extraout_ECX_34;
  undefined4 extraout_ECX_35;
  undefined4 extraout_ECX_36;
  undefined4 extraout_ECX_37;
  undefined4 extraout_ECX_38;
  undefined4 extraout_ECX_39;
  undefined4 extraout_ECX_40;
  undefined4 extraout_ECX_41;
  undefined4 extraout_ECX_42;
  undefined4 extraout_ECX_43;
  undefined4 extraout_ECX_44;
  undefined4 extraout_ECX_45;
  undefined4 extraout_ECX_46;
  undefined4 extraout_ECX_47;
  undefined4 extraout_ECX_48;
  undefined4 extraout_ECX_49;
  undefined4 extraout_ECX_50;
  undefined4 extraout_ECX_51;
  undefined4 extraout_ECX_52;
  undefined4 extraout_ECX_53;
  undefined4 extraout_ECX_54;
  undefined4 extraout_ECX_55;
  undefined4 extraout_ECX_56;
  undefined4 extraout_ECX_57;
  undefined4 extraout_ECX_58;
  undefined4 extraout_ECX_59;
  undefined4 extraout_ECX_60;
  undefined4 extraout_ECX_61;
  undefined4 extraout_ECX_62;
  undefined4 extraout_ECX_63;
  undefined4 extraout_ECX_64;
  undefined4 extraout_ECX_65;
  undefined4 extraout_ECX_66;
  undefined4 extraout_ECX_67;
  undefined4 extraout_ECX_68;
  undefined4 extraout_ECX_69;
  undefined4 extraout_ECX_70;
  undefined4 extraout_ECX_71;
  undefined4 extraout_ECX_72;
  undefined4 extraout_ECX_73;
  undefined4 extraout_ECX_74;
  undefined4 extraout_ECX_75;
  undefined4 extraout_ECX_76;
  undefined4 extraout_ECX_77;
  undefined4 extraout_ECX_78;
  undefined4 extraout_ECX_79;
  undefined4 extraout_ECX_80;
  undefined4 extraout_ECX_81;
  undefined4 extraout_ECX_82;
  undefined4 extraout_ECX_83;
  undefined4 extraout_ECX_84;
  undefined4 extraout_ECX_85;
  undefined4 extraout_ECX_86;
  undefined4 extraout_ECX_87;
  undefined4 extraout_ECX_88;
  undefined4 extraout_ECX_89;
  undefined4 extraout_ECX_90;
  undefined4 extraout_ECX_91;
  undefined4 extraout_ECX_92;
  undefined4 extraout_ECX_93;
  undefined4 extraout_ECX_94;
  undefined4 extraout_ECX_95;
  undefined4 extraout_ECX_96;
  undefined4 extraout_ECX_97;
  undefined4 extraout_ECX_98;
  undefined4 extraout_ECX_99;
  undefined4 extraout_ECX_x00100;
  undefined4 extraout_ECX_x00101;
  undefined4 extraout_ECX_x00102;
  undefined4 extraout_ECX_x00103;
  undefined4 extraout_ECX_x00104;
  undefined4 extraout_ECX_x00105;
  undefined4 extraout_ECX_x00106;
  undefined4 extraout_ECX_x00107;
  undefined4 extraout_ECX_x00108;
  undefined4 extraout_ECX_x00109;
  undefined4 extraout_ECX_x00110;
  undefined4 extraout_ECX_x00111;
  undefined4 extraout_ECX_x00112;
  
  perk_id_antiperk = 0;
  perk_name_table = FUN_0042fd00(in_ECX,s_AntiPerk_00477728,0x100);
  _perk_desc_table =
       FUN_0042fd00((uint3)extraout_ECX,s_You_shouldn_t_be_seeing_this___00477708,0x100);
  perk_id_bloody_mess_quick_learner = 1;
  DAT_004c3640 = FUN_0042fd00((uint3)extraout_ECX_00,s_Bloody_Mess_004776fc,0x100);
  DAT_004c3648 = FUN_0042fd00((uint3)extraout_ECX_01,s_More_the_merrier__More_blood_gua_00477684,
                              0x100);
  DAT_004c3644 = FUN_0042fd00((uint3)extraout_ECX_02,s_Quick_Learner_00477674,0x100);
  pcVar2 = FUN_0042fd00((uint3)extraout_ECX_03,s_You_learn_things_faster_than_a_r_00477600,0x100);
  pcVar1 = DAT_004c3648;
  pcVar4 = DAT_004c3640;
  DAT_004c364c = pcVar2;
  if (config_blob.fx_toggle == '\0') {
    iVar3 = perk_id_bloody_mess_quick_learner * 0x14;
    (&perk_name_table)[perk_id_bloody_mess_quick_learner * 5] = DAT_004c3640;
    *(char **)(&perk_desc_table + iVar3) = pcVar1;
  }
  else {
    pcVar4 = (char *)(perk_id_bloody_mess_quick_learner * 0x14);
    *(char **)(pcVar4 + 0x4c2c40) = DAT_004c3644;
    *(char **)(pcVar4 + 0x4c2c44) = pcVar2;
  }
  perk_id_sharpshooter = 2;
  _DAT_004c2c68 = FUN_0042fd00((uint3)pcVar4,s_Sharpshooter_004775f0,0x100);
  _DAT_004c2c6c =
       FUN_0042fd00((uint3)extraout_ECX_04,s_Miraculously_your_aiming_improve_00477538,0x100);
  perk_id_fastloader = 3;
  _DAT_004c2c7c = FUN_0042fd00((uint3)extraout_ECX_05,s_Fastloader_0047752c,0x100);
  _DAT_004c2c80 =
       FUN_0042fd00((uint3)extraout_ECX_06,s_Man__you_sure_know_how_to_load_a_00477504,0x100);
  perk_id_lean_mean_exp_machine = 4;
  _DAT_004c2c90 = FUN_0042fd00((uint3)extraout_ECX_07,s_Lean_Mean_Exp_Machine_004774ec,0x100);
  _DAT_004c2c94 =
       FUN_0042fd00((uint3)extraout_ECX_08,s_Why_kill_for_experience_when_you_0047745c,0x100);
  perk_id_long_distance_runner = 5;
  _DAT_004c2ca4 = FUN_0042fd00((uint3)extraout_ECX_09,s_Long_Distance_Runner_00477444,0x100);
  _DAT_004c2ca8 =
       FUN_0042fd00((uint3)extraout_ECX_10,s_You_move_like_a_train_that_has_f_004773a4,0x100);
  perk_id_pyrokinetic = 6;
  _DAT_004c2cb8 = FUN_0042fd00((uint3)extraout_ECX_11,s_Pyrokinetic_00477398,0x100);
  _DAT_004c2cbc =
       FUN_0042fd00((uint3)extraout_ECX_12,s_You_see_flames_everywhere__Bare_a_0047734c,0x100);
  perk_id_instant_winner = 7;
  _DAT_004c2ccc = FUN_0042fd00((uint3)extraout_ECX_13,s_Instant_Winner_0047733c,0x100);
  _DAT_004c2cd0 =
       FUN_0042fd00((uint3)extraout_ECX_14,s_2500_experience_points__Right_aw_00477300,0x100);
  DAT_004c2cd4 = DAT_004c2cd4 | 4;
  perk_id_grim_deal = 8;
  _DAT_004c2ce8 = 0;
  _DAT_004c2ce0 = FUN_0042fd00((uint3)DAT_004c2cd4,s_Grim_Deal_004772f4,0x100);
  _DAT_004c2ce4 =
       FUN_0042fd00((uint3)extraout_ECX_15,s_I_ll_make_you_a_deal__I_ll_give_y_00477258,0x100);
  perk_id_alternate_weapon = 9;
  _DAT_004c2cfc = 1;
  _DAT_004c2cf4 = FUN_0042fd00((uint3)extraout_ECX_16,s_Alternate_Weapon_00477244,0x100);
  _DAT_004c2cf8 =
       FUN_0042fd00((uint3)extraout_ECX_17,s_Ever_fancied_about_having_two_we_00477140,0x100);
  perk_id_plaguebearer = 10;
  _DAT_004c2d08 = FUN_0042fd00((uint3)extraout_ECX_18,s_Plaguebearer_00477130,0x100);
  _DAT_004c2d0c =
       FUN_0042fd00((uint3)extraout_ECX_19,s_You_carry_a_horrible_disease__Go_004770a4,0x100);
  perk_id_evil_eyes = 0xb;
  _DAT_004c2d1c = FUN_0042fd00((uint3)extraout_ECX_20,s_Evil_Eyes_00477098,0x100);
  _DAT_004c2d20 =
       FUN_0042fd00((uint3)extraout_ECX_21,s_No_living__nor_dead__can_resist_t_0047702c,0x100);
  perk_id_ammo_maniac = 0xc;
  _DAT_004c2d30 = FUN_0042fd00((uint3)extraout_ECX_22,s_Ammo_Maniac_00477020,0x100);
  _DAT_004c2d34 =
       FUN_0042fd00((uint3)extraout_ECX_23,s_You_squeeze_and_you_push_and_you_00476f80,0x100);
  perk_id_radioactive = 0xd;
  _DAT_004c2d44 = FUN_0042fd00((uint3)extraout_ECX_24,s_Radioactive_00476f74,0x100);
  _DAT_004c2d48 =
       FUN_0042fd00((uint3)extraout_ECX_25,s_You_are_the_Radioactive_man__you_00476eb0,0x100);
  perk_id_fastshot = 0xe;
  _DAT_004c2d58 = FUN_0042fd00((uint3)extraout_ECX_26,s_Fastshot_00476ea4,0x100);
  _DAT_004c2d5c =
       FUN_0042fd00((uint3)extraout_ECX_27,s_Funny_how_you_make_your_gun_spit_00476e28,0x100);
  perk_id_fatal_lottery = 0xf;
  _DAT_004c2d74 = 4;
  _DAT_004c2d6c = FUN_0042fd00((uint3)extraout_ECX_28,s_Fatal_Lottery_00476e18,0x100);
  _DAT_004c2d70 =
       FUN_0042fd00((uint3)extraout_ECX_29,s_Fifty_fifty_chance_of_dying_OR_g_00476db4,0x100);
  perk_id_random_weapon = 0x10;
  _DAT_004c2d88 = 5;
  _DAT_004c2d80 = FUN_0042fd00((uint3)extraout_ECX_30,s_Random_Weapon_00476da4,0x100);
  _DAT_004c2d84 =
       FUN_0042fd00((uint3)extraout_ECX_31,s_Here__have_this_weapon__No_quest_00476d78,0x100);
  perk_id_mr_melee = 0x11;
  _DAT_004c2d94 = FUN_0042fd00((uint3)extraout_ECX_32,s_Mr__Melee_00476d6c,0x100);
  _DAT_004c2d98 =
       FUN_0042fd00((uint3)extraout_ECX_33,s_You_master_the_art_of_melee_figh_00476cfc,0x100);
  perk_id_anxious_loader = 0x12;
  _DAT_004c2da8 = FUN_0042fd00((uint3)extraout_ECX_34,s_Anxious_Loader_00476cec,0x100);
  _DAT_004c2dac =
       FUN_0042fd00((uint3)extraout_ECX_35,s_When_you_can_t_stand_waiting_you_00476c5c,0x100);
  perk_id_final_revenge = 0x13;
  _DAT_004c2dc4 = 0;
  _DAT_004c2dbc = FUN_0042fd00((uint3)extraout_ECX_36,s_Final_Revenge_00476c4c,0x100);
  _DAT_004c2dc0 =
       FUN_0042fd00((uint3)extraout_ECX_37,s_Pick_this_and_you_ll_get_your_re_00476c14,0x100);
  perk_id_telekinetic = 0x14;
  _DAT_004c2dd0 = FUN_0042fd00((uint3)extraout_ECX_38,s_Telekinetic_00476c08,0x100);
  _DAT_004c2dd4 =
       FUN_0042fd00((uint3)extraout_ECX_39,s_Picking_up_bonuses_has_never_bee_00476b8c,0x100);
  perk_id_perk_expert = 0x15;
  _DAT_004c2de4 = FUN_0042fd00((uint3)extraout_ECX_40,s_Perk_Expert_00476b80,0x100);
  _DAT_004c2de8 =
       FUN_0042fd00((uint3)extraout_ECX_41,s_You_sure_know_how_to_pick_a_perk_00476acc,0x100);
  perk_id_unstoppable = 0x16;
  _DAT_004c2df8 = FUN_0042fd00((uint3)extraout_ECX_42,s_Unstoppable_00476ac0,0x100);
  _DAT_004c2dfc =
       FUN_0042fd00((uint3)extraout_ECX_43,s_Monsters_can_t_slow_you_down_wit_00476a4c,0x100);
  perk_id_regression_bullets = 0x17;
  _DAT_004c2e0c = FUN_0042fd00((uint3)extraout_ECX_44,s_Regression_Bullets_00476a38,0x100);
  _DAT_004c2e10 =
       FUN_0042fd00((uint3)extraout_ECX_45,s_Attempt_to_shoot_with_an_empty_c_004769c0,0x100);
  perk_id_infernal_contract = 0x18;
  _DAT_004c2e20 = FUN_0042fd00((uint3)extraout_ECX_46,s_Infernal_Contract_004769ac,0x100);
  _DAT_004c2e24 =
       FUN_0042fd00((uint3)extraout_ECX_47,s_In_exchange_for_your_soul__a_dar_004768d0,0x100);
  perk_id_poison_bullets = 0x19;
  _DAT_004c2e34 = FUN_0042fd00((uint3)extraout_ECX_48,s_Poison_Bullets_004768c0,0x100);
  _DAT_004c2e38 =
       FUN_0042fd00((uint3)extraout_ECX_49,s_You_tend_to_explicitly_treat_eac_00476834,0x100);
  perk_id_dodger = 0x1a;
  _DAT_004c2e48 = FUN_0042fd00((uint3)extraout_ECX_50,s_Dodger_0047682c,0x100);
  _DAT_004c2e4c =
       FUN_0042fd00((uint3)extraout_ECX_51,s_It_seems_so_stupid_just_to_take_t_004767b8,0x100);
  perk_id_bonus_magnet = 0x1b;
  _DAT_004c2e5c = FUN_0042fd00((uint3)extraout_ECX_52,s_Bonus_Magnet_004767a8,0x100);
  _DAT_004c2e60 =
       FUN_0042fd00((uint3)extraout_ECX_53,s_You_somehow_seem_to_lure_all_kin_00476758,0x100);
  perk_id_uranium_filled_bullets = 0x1c;
  _DAT_004c2e70 = FUN_0042fd00((uint3)extraout_ECX_54,s_Uranium_Filled_Bullets_00476740,0x100);
  _DAT_004c2e74 =
       FUN_0042fd00((uint3)extraout_ECX_55,s_Your_bullets_have_a_nice_creamy_u_004766d8,0x100);
  perk_id_doctor = 0x1d;
  _DAT_004c2e84 = FUN_0042fd00((uint3)extraout_ECX_56,s_Doctor_004766d0,0x100);
  _DAT_004c2e88 =
       FUN_0042fd00((uint3)extraout_ECX_57,s_With_a_single_glance_you_can_tel_0047660c,0x100);
  perk_id_monster_vision = 0x1e;
  _DAT_004c2e98 = FUN_0042fd00((uint3)extraout_ECX_58,s_Monster_Vision_004765fc,0x100);
  _DAT_004c2e9c =
       FUN_0042fd00((uint3)extraout_ECX_59,s_With_your_newly_enhanced_senses_y_00476598,0x100);
  perk_id_hot_tempered = 0x1f;
  _DAT_004c2eac = FUN_0042fd00((uint3)extraout_ECX_60,s_Hot_Tempered_00476588,0x100);
  _DAT_004c2eb0 =
       FUN_0042fd00((uint3)extraout_ECX_61,s_It_literally_boils_inside_you__T_0047650c,0x100);
  perk_id_bonus_economist = 0x20;
  _DAT_004c2ec0 = FUN_0042fd00((uint3)extraout_ECX_62,s_Bonus_Economist_004764fc,0x100);
  _DAT_004c2ec4 =
       FUN_0042fd00((uint3)extraout_ECX_63,s_Your_bonus_power_ups_last_50__lo_004764bc,0x100);
  DAT_004c2bcc = 0;
  perk_id_thick_skinned = 0x21;
  _DAT_004c2ed4 = FUN_0042fd00((uint3)extraout_ECX_64,s_Thick_Skinned_004764ac,0x100);
  _DAT_004c2ed8 =
       FUN_0042fd00((uint3)extraout_ECX_65,s_Trade_1_3_of_your_health_for_onl_00476464,0x100);
  perk_id_barrel_greaser = 0x22;
  _DAT_004c2ee8 = FUN_0042fd00((uint3)extraout_ECX_66,s_Barrel_Greaser_00476454,0x100);
  _DAT_004c2eec =
       FUN_0042fd00((uint3)extraout_ECX_67,s_After_studying_a_lot_of_physics_a_004763d0,0x100);
  perk_id_ammunition_within = 0x23;
  _DAT_004c2efc = FUN_0042fd00((uint3)extraout_ECX_68,s_Ammunition_Within_004763bc,0x100);
  _DAT_004c2f00 =
       FUN_0042fd00((uint3)extraout_ECX_69,s_Empty_clip_doesn_t_prevent_you_f_00476334,0x100);
  perk_id_veins_of_poison = 0x24;
  _DAT_004c2f10 = FUN_0042fd00((uint3)extraout_ECX_70,s_Veins_of_Poison_00476324,0x100);
  _DAT_004c2f14 =
       FUN_0042fd00((uint3)extraout_ECX_71,s_A_strong_poison_runs_through_you_004762ac,0x100);
  perk_id_toxic_avenger = 0x25;
  _DAT_004c2f24 = FUN_0042fd00((uint3)extraout_ECX_72,s_Toxic_Avenger_0047629c,0x100);
  _DAT_004c2f28 =
       FUN_0042fd00((uint3)extraout_ECX_73,s_You_started_out_just_by_being_po_004761dc,0x100);
  perk_id_regeneration = 0x26;
  _DAT_004c2f34 = perk_id_veins_of_poison;
  _DAT_004c2f38 = FUN_0042fd00((uint3)extraout_ECX_74,s_Regeneration_004761cc,0x100);
  _DAT_004c2f3c =
       FUN_0042fd00((uint3)extraout_ECX_75,s_Your_health_replenishes_but_very_00476188,0x100);
  perk_id_pyromaniac = 0x27;
  _DAT_004c2f4c = FUN_0042fd00((uint3)extraout_ECX_76,s_Pyromaniac_0047617c,0x100);
  _DAT_004c2f50 =
       FUN_0042fd00((uint3)extraout_ECX_77,s_You_just_enjoy_using_fire_as_you_004760fc,0x100);
  perk_id_ninja = 0x28;
  _DAT_004c2f60 = FUN_0042fd00((uint3)extraout_ECX_78,s_Ninja_004760f4,0x100);
  _DAT_004c2f64 =
       FUN_0042fd00((uint3)extraout_ECX_79,s_You_ve_taken_your_dodging_abilit_00476090,0x100);
  _DAT_004c2f70 = perk_id_dodger;
  perk_id_highlander = 0x29;
  _DAT_004c2f7c = 0;
  _DAT_004c2f74 = FUN_0042fd00((uint3)perk_id_dodger,s_Highlander_00476084,0x100);
  _DAT_004c2f78 =
       FUN_0042fd00((uint3)extraout_ECX_80,s_You_are_immortal__Well__almost_i_00475fb8,0x100);
  perk_id_jinxed = 0x2a;
  _DAT_004c2f88 = FUN_0042fd00((uint3)extraout_ECX_81,s_Jinxed_00475fb0,0x100);
  _DAT_004c2f8c =
       FUN_0042fd00((uint3)extraout_ECX_82,s_Things_happen_near_you__Stranges_00475f4c,0x100);
  perk_id_perk_master = 0x2b;
  _DAT_004c2f9c = FUN_0042fd00((uint3)extraout_ECX_83,s_Perk_Master_00475f40,0x100);
  _DAT_004c2fa0 =
       FUN_0042fd00((uint3)extraout_ECX_84,s_Being_the_Perk_Expert_taught_you_00475eb4,0x100);
  _DAT_004c2fac = perk_id_perk_expert;
  perk_id_reflex_boosted = 0x2c;
  _DAT_004c2fb0 = FUN_0042fd00((uint3)extraout_ECX_85,s_Reflex_Boosted_00475ea4,0x100);
  _DAT_004c2fb4 =
       FUN_0042fd00((uint3)extraout_ECX_86,s_To_you_the_world_seems_to_go_on_a_00475e00,0x100);
  perk_id_greater_regeneration = 0x2d;
  _DAT_004c2fc4 = FUN_0042fd00((uint3)extraout_ECX_87,s_Greater_Regeneration_00475de8,0x100);
  _DAT_004c2fc8 =
       FUN_0042fd00((uint3)extraout_ECX_88,s_Your_health_replenishes_faster_t_00475dbc,0x100);
  perk_id_breathing_room = 0x2e;
  _DAT_004c2fd4 = perk_id_regeneration;
  _DAT_004c2fe0 = 2;
  _DAT_004c2fd8 = FUN_0042fd00((uint3)extraout_ECX_89,s_Breathing_Room_00475dac,0x100);
  _DAT_004c2fdc =
       FUN_0042fd00((uint3)extraout_ECX_90,s_Trade_2_3rds_of_your_health_for_t_00475d34,0x100);
  perk_id_death_clock = 0x2f;
  _DAT_004c2fec = FUN_0042fd00((uint3)extraout_ECX_91,s_Death_Clock_00475d28,0x100);
  _DAT_004c2ff0 =
       FUN_0042fd00((uint3)extraout_ECX_92,s_You_die_exactly_in_30_seconds__Y_00475cbc,0x100);
  perk_id_my_favourite_weapon = 0x30;
  _DAT_004c3000 = FUN_0042fd00((uint3)extraout_ECX_93,s_My_Favourite_Weapon_00475ca8,0x100);
  _DAT_004c3004 =
       FUN_0042fd00((uint3)extraout_ECX_94,s_You_ve_grown_very_fond_of_your_p_00475c14,0x100);
  perk_id_bandage = 0x31;
  _DAT_004c3014 = FUN_0042fd00((uint3)extraout_ECX_95,s_Bandage_00475c0c,0x100);
  _DAT_004c3018 =
       FUN_0042fd00((uint3)extraout_ECX_96,s_Here__eat_this_bandage_and_you_l_00475bb0,0x100);
  perk_id_angry_reloader = 0x32;
  _DAT_004c3028 = FUN_0042fd00((uint3)extraout_ECX_97,s_Angry_Reloader_00475ba0,0x100);
  _DAT_004c302c =
       FUN_0042fd00((uint3)extraout_ECX_98,s_You_hate_it_when_you_run_out_of_s_00475ab4,0x100);
  perk_id_ion_gun_master = 0x33;
  _DAT_004c303c = FUN_0042fd00((uint3)extraout_ECX_99,s_Ion_Gun_Master_00475aa4,0x100);
  _DAT_004c3040 =
       FUN_0042fd00((uint3)extraout_ECX_x00100,s_You_re_good_with_ion_weapons__Yo_00475a18,0x100);
  perk_id_stationary_reloader = 0x34;
  _DAT_004c3050 = FUN_0042fd00((uint3)extraout_ECX_x00101,s_Stationary_Reloader_00475a04,0x100);
  _DAT_004c3054 =
       FUN_0042fd00((uint3)extraout_ECX_x00102,s_It_s_incredibly_hard_to_reload_y_0047594c,0x100);
  perk_id_man_bomb = 0x35;
  _DAT_004c3064 = FUN_0042fd00((uint3)extraout_ECX_x00103,s_Man_Bomb_00475940,0x100);
  _DAT_004c3068 =
       FUN_0042fd00((uint3)extraout_ECX_x00104,s_You_have_the_ability_to_go_boom_f_004758a8,0x100);
  perk_id_fire_caugh = 0x36;
  _DAT_004c3078 = FUN_0042fd00((uint3)extraout_ECX_x00105,s_Fire_Caugh_0047589c,0x100);
  _DAT_004c307c =
       FUN_0042fd00((uint3)extraout_ECX_x00106,s_You_have_a_fireball_stuck_in_you_00475850,0x100);
  perk_id_living_fortress = 0x37;
  _DAT_004c308c = FUN_0042fd00((uint3)extraout_ECX_x00107,s_Living_Fortress_00475840,0x100);
  _DAT_004c3090 =
       FUN_0042fd00((uint3)extraout_ECX_x00108,s_It_comes_a_time_in_each_man_s_li_0047577c,0x100);
  perk_id_tough_reloader = 0x38;
  _DAT_004c30a0 = FUN_0042fd00((uint3)extraout_ECX_x00109,s_Tough_Reloader_0047576c,0x100);
  _DAT_004c30a4 =
       FUN_0042fd00((uint3)extraout_ECX_x00110,s_Damage_received_during_reloading_00475734,0x100);
  perk_id_lifeline_50_50 = 0x39;
  _DAT_004c30b4 = FUN_0042fd00((uint3)extraout_ECX_x00111,s_Lifeline_50_50_00475724,0x100);
  _DAT_004c30b8 =
       FUN_0042fd00((uint3)extraout_ECX_x00112,s_The_computer_removes_half_of_the_004756cc,0x100);
  DAT_004c2c38 = 0x39;
  DAT_004c2b8c = 0x3a;
  perks_rebuild_available();
  return;
}



/* FUN_00430a20 @ 00430a20 */

/* [binja] int32_t sub_430a20(int32_t* arg1, int32_t arg2, int32_t arg3, char* arg4) */

int __cdecl FUN_00430a20(int *arg1,int arg2,int arg3,char *arg4)

{
  int iVar1;
  char *pcVar2;
  uint uVar3;
  
  if ((void *)arg1[3] != (void *)0x0) {
    crt_free((void *)arg1[3]);
    console_printf(&console_log_queue,s___Quest_overwritten__00477742 + 2);
  }
  pcVar2 = strdup_malloc(arg4);
  arg1[3] = (int)pcVar2;
  arg1[8] = perk_id_antiperk;
  iVar1 = arg2 * 2 + -2;
  arg1[9] = 0;
  *arg1 = arg2;
  arg1[1] = arg3;
  arg1[4] = iVar1;
  if (arg3 < 6) {
    arg1[5] = arg2 * 2 + -1;
    arg1[6] = iVar1;
  }
  else {
    arg1[5] = iVar1;
    arg1[6] = arg2 * 2 + -1;
  }
  if (4 < arg2) {
    uVar3 = arg3 & 0x80000003;
    if ((int)uVar3 < 0) {
      uVar3 = (uVar3 - 1 | 0xfffffffc) + 1;
    }
    arg1[4] = uVar3;
    arg1[5] = 1;
    arg1[6] = 3;
    arg1[7] = 5;
  }
  quest_meta_cursor = arg1;
  return arg2;
}



/* creature_spawn_slot_alloc @ 00430ad0 */

/* returns first free spawn slot index (creature_spawn_slot_owner == 0); returns 0x1f if none free
    */

int creature_spawn_slot_alloc(void)

{
  int iVar1;
  int *piVar2;
  
  iVar1 = 0;
  piVar2 = &creature_spawn_slot_owner;
  do {
    if (*piVar2 == 0) {
      return iVar1;
    }
    piVar2 = piVar2 + 6;
    iVar1 = iVar1 + 1;
  } while ((int)piVar2 < 0x4852d0);
  return 0x1f;
}



/* creature_spawn_template @ 00430af0 */

/* spawns creature(s) from template id; heading -100 uses a random heading */

void * __cdecl creature_spawn_template(int template_id,float *pos,float heading)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float *pfVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  creature_t *pcVar10;
  float10 fVar11;
  float10 fVar12;
  int local_48;
  float local_4;
  
  pfVar5 = pos;
  iVar6 = creature_alloc_slot();
  if (heading == -100.0) {
    iVar7 = crt_rand();
    heading = (float)(iVar7 % 0x274) * 0.01;
  }
  pcVar10 = &creature_pool + iVar6;
  (&creature_pool)[iVar6].ai_mode = 0;
  (&creature_pool)[iVar6].pos_x = *pos;
  fVar4 = pos[1];
  (&creature_pool)[iVar6].vel_x = 0.0;
  (&creature_pool)[iVar6].pos_y = fVar4;
  (&creature_pool)[iVar6].collision_flag = '\0';
  (&creature_pool)[iVar6].collision_timer = 0.0;
  pcVar10->active = '\x01';
  *(undefined1 *)&(&creature_pool)[iVar6].force_target = 0;
  (&creature_pool)[iVar6].state_flag = '\x01';
  (&creature_pool)[iVar6].hitbox_size = 16.0;
  (&creature_pool)[iVar6].vel_y = 0.0;
  iVar7 = crt_rand();
  (&creature_pool)[iVar6].attack_cooldown = 0.0;
  (&creature_pool)[iVar6].heading = (float)(iVar7 % 0x13a) * 0.01;
  if (template_id == 0x12) {
    (&creature_pool)[iVar6].tint_r = 0.65;
    (&creature_pool)[iVar6].type_id = 2;
    (&creature_pool)[iVar6].tint_g = 0.85;
    (&creature_pool)[iVar6].health = 200.0;
    (&creature_pool)[iVar6].move_speed = 2.2;
    (&creature_pool)[iVar6].tint_b = 0.97;
    (&creature_pool)[iVar6].reward_value = 600.0;
    (&creature_pool)[iVar6].size = 55.0;
    (&creature_pool)[iVar6].tint_a = 1.0;
    (&creature_pool)[iVar6].contact_damage = 14.0;
    (&creature_pool)[iVar6].max_health = 200.0;
    pos = (float *)0x0;
    do {
      iVar7 = creature_alloc_slot();
      fVar11 = (float10)fcos((float10)(int)pos * (float10)0.7853982);
      pcVar10 = &creature_pool + iVar7;
      (&creature_pool)[iVar7].ai_mode = 3;
      (&creature_pool)[iVar7].link_index = iVar6;
      (&creature_pool)[iVar7].target_offset_x = (float)(fVar11 * (float10)100.0);
      fVar11 = (float10)fsin((float10)(int)pos * (float10)0.7853982);
      (&creature_pool)[iVar7].target_offset_y = (float)(fVar11 * (float10)100.0);
      (&creature_pool)[iVar7].pos_x = *pfVar5;
      (&creature_pool)[iVar7].pos_y = pfVar5[1];
      (&creature_pool)[iVar7].vel_x = 0.0;
      (&creature_pool)[iVar7].vel_y = 0.0;
      (&creature_pool)[iVar7].collision_flag = '\0';
      (&creature_pool)[iVar7].tint_r = 0.32000002;
      (&creature_pool)[iVar7].health = 40.0;
      (&creature_pool)[iVar7].max_health = 40.0;
      (&creature_pool)[iVar7].tint_g = 0.58800006;
      pos = (float *)((int)pos + 1);
      (&creature_pool)[iVar7].tint_b = 0.426;
      (&creature_pool)[iVar7].collision_timer = 0.0;
      pcVar10->active = '\x01';
      (&creature_pool)[iVar7].state_flag = '\x01';
      (&creature_pool)[iVar7].hitbox_size = 16.0;
      (&creature_pool)[iVar7].attack_cooldown = 0.0;
      (&creature_pool)[iVar7].type_id = 2;
      (&creature_pool)[iVar7].move_speed = 2.4;
      (&creature_pool)[iVar7].reward_value = 60.0;
      (&creature_pool)[iVar7].tint_a = 1.0;
      (&creature_pool)[iVar7].size = 50.0;
      (&creature_pool)[iVar7].contact_damage = 4.0;
    } while ((int)pos < 8);
  }
  else if (template_id == 0x19) {
    (&creature_pool)[iVar6].tint_r = 0.95;
    (&creature_pool)[iVar6].type_id = 2;
    (&creature_pool)[iVar6].tint_g = 0.55;
    (&creature_pool)[iVar6].health = 50.0;
    (&creature_pool)[iVar6].move_speed = 3.8;
    (&creature_pool)[iVar6].tint_b = 0.37;
    (&creature_pool)[iVar6].reward_value = 300.0;
    (&creature_pool)[iVar6].size = 55.0;
    (&creature_pool)[iVar6].tint_a = 1.0;
    (&creature_pool)[iVar6].contact_damage = 40.0;
    (&creature_pool)[iVar6].max_health = 50.0;
    pos = (float *)0x0;
    do {
      iVar7 = creature_alloc_slot();
      fVar11 = (float10)fcos((float10)(int)pos * (float10)1.2566371);
      pcVar10 = &creature_pool + iVar7;
      (&creature_pool)[iVar7].ai_mode = 5;
      (&creature_pool)[iVar7].link_index = iVar6;
      (&creature_pool)[iVar7].target_offset_x = (float)(fVar11 * (float10)110.0);
      fVar11 = (float10)fsin((float10)(int)pos * (float10)1.2566371);
      (&creature_pool)[iVar7].target_offset_y = (float)(fVar11 * (float10)110.0);
      fVar4 = (&creature_pool)[iVar7].target_offset_x;
      fVar1 = *pfVar5;
      fVar2 = (&creature_pool)[iVar7].target_offset_y;
      fVar3 = pfVar5[1];
      (&creature_pool)[iVar7].vel_x = 0.0;
      (&creature_pool)[iVar7].pos_x = fVar4 + fVar1;
      (&creature_pool)[iVar7].vel_y = 0.0;
      (&creature_pool)[iVar7].pos_y = fVar2 + fVar3;
      (&creature_pool)[iVar7].health = 220.0;
      (&creature_pool)[iVar7].max_health = 220.0;
      (&creature_pool)[iVar7].tint_r = 0.7125;
      pos = (float *)((int)pos + 1);
      (&creature_pool)[iVar7].tint_g = 0.41250002;
      (&creature_pool)[iVar7].collision_flag = '\0';
      (&creature_pool)[iVar7].tint_b = 0.2775;
      (&creature_pool)[iVar7].collision_timer = 0.0;
      pcVar10->active = '\x01';
      (&creature_pool)[iVar7].state_flag = '\x01';
      (&creature_pool)[iVar7].hitbox_size = 16.0;
      (&creature_pool)[iVar7].attack_cooldown = 0.0;
      (&creature_pool)[iVar7].type_id = 2;
      (&creature_pool)[iVar7].move_speed = 3.8;
      (&creature_pool)[iVar7].reward_value = 60.0;
      (&creature_pool)[iVar7].tint_a = 0.6;
      (&creature_pool)[iVar7].size = 50.0;
      (&creature_pool)[iVar7].contact_damage = 35.0;
    } while ((int)pos < 5);
  }
  else {
    if (template_id == 0x11) {
      (&creature_pool)[iVar6].type_id = 1;
      (&creature_pool)[iVar6].pos_x = *pos;
      (&creature_pool)[iVar6].pos_y = pos[1];
      (&creature_pool)[iVar6].ai_mode = 1;
      (&creature_pool)[iVar6].tint_r = 0.99;
      (&creature_pool)[iVar6].tint_g = 0.99;
      (&creature_pool)[iVar6].health = 1500.0;
      (&creature_pool)[iVar6].move_speed = 2.1;
      (&creature_pool)[iVar6].tint_b = 0.21;
      (&creature_pool)[iVar6].reward_value = 1000.0;
      (&creature_pool)[iVar6].size = 69.0;
      (&creature_pool)[iVar6].tint_a = 1.0;
      (&creature_pool)[iVar6].contact_damage = 150.0;
      (&creature_pool)[iVar6].max_health = 1500.0;
      local_48 = 2;
      pos = (float *)0xffffff00;
      iVar7 = iVar6;
      do {
        iVar8 = creature_alloc_slot();
        (&creature_pool)[iVar8].target_offset_x = (float)(int)pos;
        pcVar10 = &creature_pool + iVar8;
        (&creature_pool)[iVar8].ai_mode = 3;
        (&creature_pool)[iVar8].link_index = iVar7;
        (&creature_pool)[iVar8].target_offset_y = -256.0;
        fVar11 = (float10)fcos((float10)local_48 * (float10)0.3926991);
        fVar12 = (float10)fsin((float10)local_48 * (float10)0.3926991);
        fVar4 = pfVar5[1];
        (&creature_pool)[iVar8].pos_x = (float)fVar11 * 256.0 + *pfVar5;
        (&creature_pool)[iVar8].vel_x = 0.0;
        (&creature_pool)[iVar8].tint_r = 0.6;
        (&creature_pool)[iVar8].pos_y = (float)(fVar12 * (float10)256.0 + (float10)fVar4);
        (&creature_pool)[iVar8].tint_g = 0.6;
        (&creature_pool)[iVar8].vel_y = 0.0;
        (&creature_pool)[iVar8].tint_b = 0.31;
        (&creature_pool)[iVar8].health = 60.0;
        (&creature_pool)[iVar8].reward_value = 60.0;
        (&creature_pool)[iVar8].max_health = 60.0;
        (&creature_pool)[iVar8].tint_a = 1.0;
        pos = pos + 0x10;
        local_48 = local_48 + 2;
        (&creature_pool)[iVar8].collision_flag = '\0';
        (&creature_pool)[iVar8].collision_timer = 0.0;
        pcVar10->active = '\x01';
        (&creature_pool)[iVar8].state_flag = '\x01';
        (&creature_pool)[iVar8].hitbox_size = 16.0;
        (&creature_pool)[iVar8].attack_cooldown = 0.0;
        (&creature_pool)[iVar8].type_id = 1;
        (&creature_pool)[iVar8].move_speed = 2.4;
        (&creature_pool)[iVar8].size = 50.0;
        (&creature_pool)[iVar8].contact_damage = 14.0;
        iVar7 = iVar8;
      } while ((int)pos < 0);
    }
    else {
      if (template_id != 0x13) {
        if (template_id == 0x14) {
          (&creature_pool)[iVar6].type_id = 2;
          (&creature_pool)[iVar6].pos_x = *pos;
          (&creature_pool)[iVar6].pos_y = pos[1];
          (&creature_pool)[iVar6].ai_mode = 2;
          (&creature_pool)[iVar6].tint_r = 0.7;
          (&creature_pool)[iVar6].tint_g = 0.8;
          (&creature_pool)[iVar6].health = 1500.0;
          (&creature_pool)[iVar6].move_speed = 2.0;
          (&creature_pool)[iVar6].tint_b = 0.31;
          (&creature_pool)[iVar6].reward_value = 600.0;
          (&creature_pool)[iVar6].size = 50.0;
          (&creature_pool)[iVar6].tint_a = 1.0;
          (&creature_pool)[iVar6].contact_damage = 40.0;
          (&creature_pool)[iVar6].pos_x = *pos;
          (&creature_pool)[iVar6].pos_y = pos[1];
          (&creature_pool)[iVar6].max_health = 1500.0;
          local_48 = 0;
          do {
            pos = (float *)0x80;
            do {
              iVar7 = creature_alloc_slot();
              (&creature_pool)[iVar7].target_offset_y = (float)(int)pos;
              pcVar10 = &creature_pool + iVar7;
              (&creature_pool)[iVar7].ai_mode = 5;
              (&creature_pool)[iVar7].heading = 0.0;
              (&creature_pool)[iVar7].anim_phase = 0.0;
              (&creature_pool)[iVar7].link_index = iVar6;
              (&creature_pool)[iVar7].target_offset_x = (float)local_48;
              fVar4 = *pfVar5;
              fVar1 = (&creature_pool)[iVar7].target_offset_x;
              fVar2 = (&creature_pool)[iVar7].target_offset_y;
              fVar3 = pfVar5[1];
              (&creature_pool)[iVar7].vel_x = 0.0;
              (&creature_pool)[iVar7].pos_x = fVar4 + fVar1;
              (&creature_pool)[iVar7].vel_y = 0.0;
              (&creature_pool)[iVar7].pos_y = fVar2 + fVar3;
              (&creature_pool)[iVar7].tint_r = 0.4;
              (&creature_pool)[iVar7].health = 40.0;
              (&creature_pool)[iVar7].max_health = 40.0;
              (&creature_pool)[iVar7].tint_g = 0.7;
              pos = pos + 0x10;
              (&creature_pool)[iVar7].tint_b = 0.11;
              (&creature_pool)[iVar7].collision_flag = '\0';
              (&creature_pool)[iVar7].collision_timer = 0.0;
              pcVar10->active = '\x01';
              (&creature_pool)[iVar7].state_flag = '\x01';
              (&creature_pool)[iVar7].hitbox_size = 16.0;
              (&creature_pool)[iVar7].attack_cooldown = 0.0;
              (&creature_pool)[iVar7].type_id = 2;
              (&creature_pool)[iVar7].move_speed = 2.0;
              (&creature_pool)[iVar7].reward_value = 60.0;
              (&creature_pool)[iVar7].tint_a = 1.0;
              (&creature_pool)[iVar7].size = 50.0;
              (&creature_pool)[iVar7].contact_damage = 4.0;
            } while ((int)pos < 0x101);
            local_48 = local_48 + -0x40;
          } while (-0x240 < local_48);
        }
        else if (template_id == 0x15) {
          (&creature_pool)[iVar6].type_id = 2;
          (&creature_pool)[iVar6].pos_x = *pos;
          (&creature_pool)[iVar6].pos_y = pos[1];
          (&creature_pool)[iVar6].ai_mode = 2;
          (&creature_pool)[iVar6].tint_r = 1.0;
          (&creature_pool)[iVar6].tint_g = 1.0;
          (&creature_pool)[iVar6].health = 1500.0;
          (&creature_pool)[iVar6].move_speed = 2.0;
          (&creature_pool)[iVar6].tint_b = 1.0;
          (&creature_pool)[iVar6].reward_value = 600.0;
          (&creature_pool)[iVar6].size = 60.0;
          (&creature_pool)[iVar6].tint_a = 1.0;
          (&creature_pool)[iVar6].contact_damage = 40.0;
          (&creature_pool)[iVar6].pos_x = *pos;
          (&creature_pool)[iVar6].pos_y = pos[1];
          (&creature_pool)[iVar6].max_health = 1500.0;
          local_48 = 0;
          do {
            pos = (float *)0x80;
            do {
              iVar7 = creature_alloc_slot();
              (&creature_pool)[iVar7].target_offset_y = (float)(int)pos;
              pcVar10 = &creature_pool + iVar7;
              (&creature_pool)[iVar7].ai_mode = 4;
              (&creature_pool)[iVar7].heading = 0.0;
              (&creature_pool)[iVar7].anim_phase = 0.0;
              (&creature_pool)[iVar7].link_index = iVar6;
              (&creature_pool)[iVar7].target_offset_x = (float)local_48;
              fVar4 = *pfVar5;
              fVar1 = (&creature_pool)[iVar7].target_offset_x;
              fVar2 = (&creature_pool)[iVar7].target_offset_y;
              fVar3 = pfVar5[1];
              (&creature_pool)[iVar7].vel_x = 0.0;
              (&creature_pool)[iVar7].pos_x = fVar4 + fVar1;
              (&creature_pool)[iVar7].vel_y = 0.0;
              (&creature_pool)[iVar7].pos_y = fVar2 + fVar3;
              (&creature_pool)[iVar7].health = 40.0;
              (&creature_pool)[iVar7].max_health = 40.0;
              (&creature_pool)[iVar7].tint_r = 0.4;
              pos = pos + 0x10;
              (&creature_pool)[iVar7].tint_g = 0.7;
              (&creature_pool)[iVar7].collision_flag = '\0';
              (&creature_pool)[iVar7].tint_b = 0.11;
              (&creature_pool)[iVar7].collision_timer = 0.0;
              pcVar10->active = '\x01';
              (&creature_pool)[iVar7].state_flag = '\x01';
              (&creature_pool)[iVar7].hitbox_size = 16.0;
              (&creature_pool)[iVar7].attack_cooldown = 0.0;
              (&creature_pool)[iVar7].type_id = 2;
              (&creature_pool)[iVar7].move_speed = 2.0;
              (&creature_pool)[iVar7].reward_value = 60.0;
              (&creature_pool)[iVar7].tint_a = 1.0;
              (&creature_pool)[iVar7].size = 50.0;
              (&creature_pool)[iVar7].contact_damage = 4.0;
            } while ((int)pos < 0x101);
            local_48 = local_48 + -0x40;
          } while (-0x240 < local_48);
        }
        else if (template_id == 0x17) {
          (&creature_pool)[iVar6].type_id = 3;
          (&creature_pool)[iVar6].pos_x = *pos;
          (&creature_pool)[iVar6].pos_y = pos[1];
          (&creature_pool)[iVar6].tint_r = 1.0;
          (&creature_pool)[iVar6].tint_g = 1.0;
          (&creature_pool)[iVar6].ai_mode = 2;
          (&creature_pool)[iVar6].health = 1500.0;
          (&creature_pool)[iVar6].tint_b = 1.0;
          (&creature_pool)[iVar6].move_speed = 2.0;
          (&creature_pool)[iVar6].reward_value = 600.0;
          (&creature_pool)[iVar6].tint_a = 1.0;
          (&creature_pool)[iVar6].size = 60.0;
          (&creature_pool)[iVar6].contact_damage = 40.0;
          (&creature_pool)[iVar6].pos_x = *pos;
          (&creature_pool)[iVar6].pos_y = pos[1];
          (&creature_pool)[iVar6].max_health = 1500.0;
          local_48 = 0;
          do {
            pos = (float *)0x80;
            do {
              iVar7 = creature_alloc_slot();
              (&creature_pool)[iVar7].target_offset_y = (float)(int)pos;
              pcVar10 = &creature_pool + iVar7;
              (&creature_pool)[iVar7].ai_mode = 4;
              (&creature_pool)[iVar7].heading = 0.0;
              (&creature_pool)[iVar7].anim_phase = 0.0;
              (&creature_pool)[iVar7].link_index = iVar6;
              (&creature_pool)[iVar7].target_offset_x = (float)local_48;
              fVar4 = (&creature_pool)[iVar7].target_offset_x;
              fVar1 = *pfVar5;
              fVar2 = (&creature_pool)[iVar7].target_offset_y;
              fVar3 = pfVar5[1];
              (&creature_pool)[iVar7].vel_x = 0.0;
              (&creature_pool)[iVar7].pos_x = fVar4 + fVar1;
              (&creature_pool)[iVar7].vel_y = 0.0;
              (&creature_pool)[iVar7].pos_y = fVar2 + fVar3;
              (&creature_pool)[iVar7].health = 40.0;
              (&creature_pool)[iVar7].max_health = 40.0;
              (&creature_pool)[iVar7].tint_r = 0.4;
              pos = pos + 0x10;
              (&creature_pool)[iVar7].tint_g = 0.7;
              (&creature_pool)[iVar7].collision_flag = '\0';
              (&creature_pool)[iVar7].tint_b = 0.11;
              (&creature_pool)[iVar7].collision_timer = 0.0;
              pcVar10->active = '\x01';
              (&creature_pool)[iVar7].state_flag = '\x01';
              (&creature_pool)[iVar7].hitbox_size = 16.0;
              (&creature_pool)[iVar7].attack_cooldown = 0.0;
              (&creature_pool)[iVar7].type_id = 3;
              (&creature_pool)[iVar7].move_speed = 2.0;
              (&creature_pool)[iVar7].reward_value = 60.0;
              (&creature_pool)[iVar7].tint_a = 1.0;
              (&creature_pool)[iVar7].size = 50.0;
              (&creature_pool)[iVar7].contact_damage = 4.0;
            } while ((int)pos < 0x101);
            local_48 = local_48 + -0x40;
          } while (-0x240 < local_48);
        }
        else if (template_id == 0x16) {
          (&creature_pool)[iVar6].type_id = 1;
          (&creature_pool)[iVar6].pos_x = *pos;
          (&creature_pool)[iVar6].pos_y = pos[1];
          (&creature_pool)[iVar6].tint_r = 1.0;
          (&creature_pool)[iVar6].tint_g = 1.0;
          (&creature_pool)[iVar6].ai_mode = 2;
          (&creature_pool)[iVar6].health = 1500.0;
          (&creature_pool)[iVar6].tint_b = 1.0;
          (&creature_pool)[iVar6].move_speed = 2.0;
          (&creature_pool)[iVar6].reward_value = 600.0;
          (&creature_pool)[iVar6].tint_a = 1.0;
          (&creature_pool)[iVar6].size = 64.0;
          (&creature_pool)[iVar6].contact_damage = 40.0;
          (&creature_pool)[iVar6].pos_x = *pos;
          (&creature_pool)[iVar6].pos_y = pos[1];
          (&creature_pool)[iVar6].max_health = 1500.0;
          local_48 = 0;
          do {
            pos = (float *)0x80;
            do {
              iVar7 = creature_alloc_slot();
              (&creature_pool)[iVar7].target_offset_y = (float)(int)pos;
              pcVar10 = &creature_pool + iVar7;
              (&creature_pool)[iVar7].ai_mode = 4;
              (&creature_pool)[iVar7].heading = 0.0;
              (&creature_pool)[iVar7].anim_phase = 0.0;
              (&creature_pool)[iVar7].link_index = iVar6;
              (&creature_pool)[iVar7].target_offset_x = (float)local_48;
              fVar4 = (&creature_pool)[iVar7].target_offset_x;
              fVar1 = *pfVar5;
              fVar2 = (&creature_pool)[iVar7].target_offset_y;
              fVar3 = pfVar5[1];
              (&creature_pool)[iVar7].vel_x = 0.0;
              (&creature_pool)[iVar7].pos_x = fVar4 + fVar1;
              (&creature_pool)[iVar7].vel_y = 0.0;
              (&creature_pool)[iVar7].pos_y = fVar2 + fVar3;
              (&creature_pool)[iVar7].health = 40.0;
              (&creature_pool)[iVar7].max_health = 40.0;
              (&creature_pool)[iVar7].tint_r = 0.4;
              pos = pos + 0x10;
              (&creature_pool)[iVar7].tint_g = 0.7;
              (&creature_pool)[iVar7].collision_flag = '\0';
              (&creature_pool)[iVar7].tint_b = 0.11;
              (&creature_pool)[iVar7].collision_timer = 0.0;
              pcVar10->active = '\x01';
              (&creature_pool)[iVar7].state_flag = '\x01';
              (&creature_pool)[iVar7].hitbox_size = 16.0;
              (&creature_pool)[iVar7].attack_cooldown = 0.0;
              (&creature_pool)[iVar7].type_id = 1;
              (&creature_pool)[iVar7].move_speed = 2.0;
              (&creature_pool)[iVar7].reward_value = 60.0;
              (&creature_pool)[iVar7].tint_a = 1.0;
              (&creature_pool)[iVar7].size = 60.0;
              (&creature_pool)[iVar7].contact_damage = 4.0;
            } while ((int)pos < 0x101);
            local_48 = local_48 + -0x40;
          } while (-0x240 < local_48);
        }
        else {
          if (template_id != 0xf) {
            if (template_id == 0x18) {
              (&creature_pool)[iVar6].type_id = 2;
              (&creature_pool)[iVar6].pos_x = *pos;
              fVar4 = pos[1];
              (&creature_pool)[iVar6].ai_mode = 2;
              (&creature_pool)[iVar6].tint_r = 0.7;
              (&creature_pool)[iVar6].pos_y = fVar4;
              (&creature_pool)[iVar6].tint_g = 0.8;
              (&creature_pool)[iVar6].health = 500.0;
              (&creature_pool)[iVar6].move_speed = 2.0;
              (&creature_pool)[iVar6].tint_b = 0.31;
              (&creature_pool)[iVar6].reward_value = 600.0;
              (&creature_pool)[iVar6].tint_a = 1.0;
              (&creature_pool)[iVar6].size = 40.0;
              (&creature_pool)[iVar6].contact_damage = 40.0;
              (&creature_pool)[iVar6].pos_x = *pos;
              (&creature_pool)[iVar6].pos_y = pos[1];
              (&creature_pool)[iVar6].max_health = 500.0;
              local_48 = 0;
              do {
                pos = (float *)0x80;
                do {
                  iVar7 = creature_alloc_slot();
                  (&creature_pool)[iVar7].target_offset_y = (float)(int)pos;
                  pcVar10 = &creature_pool + iVar7;
                  (&creature_pool)[iVar7].ai_mode = 3;
                  (&creature_pool)[iVar7].heading = 0.0;
                  (&creature_pool)[iVar7].anim_phase = 0.0;
                  (&creature_pool)[iVar7].link_index = iVar6;
                  (&creature_pool)[iVar7].target_offset_x = (float)local_48;
                  fVar4 = (&creature_pool)[iVar7].target_offset_x;
                  fVar1 = *pfVar5;
                  fVar2 = (&creature_pool)[iVar7].target_offset_y;
                  fVar3 = pfVar5[1];
                  (&creature_pool)[iVar7].vel_x = 0.0;
                  (&creature_pool)[iVar7].pos_x = fVar4 + fVar1;
                  (&creature_pool)[iVar7].vel_y = 0.0;
                  (&creature_pool)[iVar7].pos_y = fVar2 + fVar3;
                  (&creature_pool)[iVar7].health = 260.0;
                  (&creature_pool)[iVar7].max_health = 260.0;
                  (&creature_pool)[iVar7].tint_r = 0.7125;
                  pos = pos + 0x10;
                  (&creature_pool)[iVar7].tint_g = 0.41250002;
                  (&creature_pool)[iVar7].collision_flag = '\0';
                  (&creature_pool)[iVar7].tint_b = 0.2775;
                  (&creature_pool)[iVar7].collision_timer = 0.0;
                  pcVar10->active = '\x01';
                  (&creature_pool)[iVar7].state_flag = '\x01';
                  (&creature_pool)[iVar7].hitbox_size = 16.0;
                  (&creature_pool)[iVar7].attack_cooldown = 0.0;
                  (&creature_pool)[iVar7].type_id = 2;
                  (&creature_pool)[iVar7].move_speed = 3.8;
                  (&creature_pool)[iVar7].reward_value = 60.0;
                  (&creature_pool)[iVar7].tint_a = 0.6;
                  (&creature_pool)[iVar7].size = 50.0;
                  (&creature_pool)[iVar7].contact_damage = 35.0;
                } while ((int)pos < 0x101);
                local_48 = local_48 + -0x40;
              } while (-0x240 < local_48);
              goto LAB_004310b8;
            }
            if (template_id == 1) {
              (&creature_pool)[iVar6].type_id = 4;
              (&creature_pool)[iVar6].flags = 8;
              (&creature_pool)[iVar6].size = 80.0;
              (&creature_pool)[iVar6].health = 400.0;
              (&creature_pool)[iVar6].move_speed = 2.0;
              (&creature_pool)[iVar6].reward_value = 1000.0;
              (&creature_pool)[iVar6].tint_a = 1.0;
              (&creature_pool)[iVar6].tint_r = 0.8;
              (&creature_pool)[iVar6].tint_g = 0.7;
              (&creature_pool)[iVar6].tint_b = 0.4;
              (&creature_pool)[iVar6].contact_damage = 17.0;
              goto LAB_004310b8;
            }
            if (template_id == 10) {
              (&creature_pool)[iVar6].type_id = 2;
              (&creature_pool)[iVar6].flags = 4;
              iVar7 = creature_spawn_slot_alloc();
              (&creature_pool)[iVar6].link_index = iVar7;
              (&creature_spawn_slot_timer)[iVar7 * 6] = 0x40000000;
              (&creature_spawn_slot_count)[iVar7 * 6] = 0;
              (&creature_spawn_slot_limit)[iVar7 * 6] = 100;
              (&creature_spawn_slot_interval)[iVar7 * 6] = 0x40a00000;
              *(undefined4 *)(&creature_spawn_slot_template + iVar7 * 0x18) = 0x32;
              (&creature_spawn_slot_owner)[iVar7 * 6] = pcVar10;
              (&creature_pool)[iVar6].size = 55.0;
              (&creature_pool)[iVar6].health = 1000.0;
              (&creature_pool)[iVar6].move_speed = 1.5;
              (&creature_pool)[iVar6].reward_value = 3000.0;
              (&creature_pool)[iVar6].tint_a = 1.0;
              (&creature_pool)[iVar6].tint_r = 0.8;
              (&creature_pool)[iVar6].tint_g = 0.7;
              (&creature_pool)[iVar6].tint_b = 0.4;
              (&creature_pool)[iVar6].contact_damage = 0.0;
              goto LAB_004310b8;
            }
            if (template_id == 0xb) {
              (&creature_pool)[iVar6].type_id = 2;
              (&creature_pool)[iVar6].flags = 4;
              iVar7 = creature_spawn_slot_alloc();
              (&creature_pool)[iVar6].link_index = iVar7;
              (&creature_spawn_slot_timer)[iVar7 * 6] = 0x40000000;
              (&creature_spawn_slot_count)[iVar7 * 6] = 0;
              (&creature_spawn_slot_limit)[iVar7 * 6] = 100;
              (&creature_spawn_slot_interval)[iVar7 * 6] = 0x40c00000;
              *(undefined4 *)(&creature_spawn_slot_template + iVar7 * 0x18) = 0x3c;
              (&creature_spawn_slot_owner)[iVar7 * 6] = pcVar10;
              (&creature_pool)[iVar6].size = 65.0;
              (&creature_pool)[iVar6].health = 3500.0;
              (&creature_pool)[iVar6].move_speed = 1.5;
              (&creature_pool)[iVar6].reward_value = 5000.0;
              (&creature_pool)[iVar6].tint_a = 1.0;
              (&creature_pool)[iVar6].tint_r = 0.9;
              (&creature_pool)[iVar6].tint_g = 0.1;
              (&creature_pool)[iVar6].tint_b = 0.1;
              (&creature_pool)[iVar6].contact_damage = 0.0;
              goto LAB_004310b8;
            }
            if (template_id == 0x10) {
              (&creature_pool)[iVar6].type_id = 2;
              (&creature_pool)[iVar6].flags = 4;
              iVar7 = creature_spawn_slot_alloc();
              (&creature_pool)[iVar6].link_index = iVar7;
              (&creature_spawn_slot_timer)[iVar7 * 6] = 0x3fc00000;
              (&creature_spawn_slot_count)[iVar7 * 6] = 0;
              (&creature_spawn_slot_limit)[iVar7 * 6] = 100;
              (&creature_spawn_slot_interval)[iVar7 * 6] = 0x40133333;
              *(undefined4 *)(&creature_spawn_slot_template + iVar7 * 0x18) = 0x32;
              (&creature_spawn_slot_owner)[iVar7 * 6] = pcVar10;
              (&creature_pool)[iVar6].size = 32.0;
              (&creature_pool)[iVar6].health = 50.0;
              (&creature_pool)[iVar6].move_speed = 2.8;
              (&creature_pool)[iVar6].reward_value = 800.0;
            }
            else {
              if (template_id == 0xe) {
                (&creature_pool)[iVar6].type_id = 2;
                (&creature_pool)[iVar6].flags = 4;
                iVar7 = creature_spawn_slot_alloc();
                (&creature_pool)[iVar6].link_index = iVar7;
                pos = (float *)0x0;
                (&creature_spawn_slot_timer)[iVar7 * 6] = 0x3fc00000;
                (&creature_spawn_slot_count)[iVar7 * 6] = 0;
                (&creature_spawn_slot_limit)[iVar7 * 6] = 0x40;
                (&creature_spawn_slot_interval)[iVar7 * 6] = 0x3f866666;
                *(undefined4 *)(&creature_spawn_slot_template + iVar7 * 0x18) = 0x1c;
                (&creature_spawn_slot_owner)[iVar7 * 6] = pcVar10;
                (&creature_pool)[iVar6].size = 32.0;
                (&creature_pool)[iVar6].health = 50.0;
                (&creature_pool)[iVar6].move_speed = 2.8;
                (&creature_pool)[iVar6].reward_value = 5000.0;
                (&creature_pool)[iVar6].tint_a = 1.0;
                (&creature_pool)[iVar6].tint_r = 0.9;
                (&creature_pool)[iVar6].tint_g = 0.8;
                (&creature_pool)[iVar6].tint_b = 0.4;
                (&creature_pool)[iVar6].contact_damage = 0.0;
                do {
                  iVar7 = creature_alloc_slot();
                  fVar11 = (float10)fcos((float10)(int)pos * (float10)0.2617994);
                  pcVar10 = &creature_pool + iVar7;
                  (&creature_pool)[iVar7].ai_mode = 3;
                  (&creature_pool)[iVar7].heading = 0.0;
                  (&creature_pool)[iVar7].anim_phase = 0.0;
                  (&creature_pool)[iVar7].link_index = iVar6;
                  (&creature_pool)[iVar7].target_offset_x = (float)(fVar11 * (float10)100.0);
                  fVar11 = (float10)fsin((float10)(int)pos * (float10)0.2617994);
                  (&creature_pool)[iVar7].target_offset_y = (float)(fVar11 * (float10)100.0);
                  (&creature_pool)[iVar7].pos_x = *pfVar5;
                  (&creature_pool)[iVar7].pos_y = pfVar5[1];
                  (&creature_pool)[iVar7].vel_x = 0.0;
                  (&creature_pool)[iVar7].vel_y = 0.0;
                  (&creature_pool)[iVar7].collision_flag = '\0';
                  (&creature_pool)[iVar7].tint_r = 1.0;
                  (&creature_pool)[iVar7].health = 40.0;
                  (&creature_pool)[iVar7].max_health = 40.0;
                  (&creature_pool)[iVar7].tint_g = 0.3;
                  pos = (float *)((int)pos + 1);
                  (&creature_pool)[iVar7].tint_b = 0.3;
                  (&creature_pool)[iVar7].collision_timer = 0.0;
                  pcVar10->active = '\x01';
                  (&creature_pool)[iVar7].state_flag = '\x01';
                  (&creature_pool)[iVar7].hitbox_size = 16.0;
                  (&creature_pool)[iVar7].attack_cooldown = 0.0;
                  (&creature_pool)[iVar7].type_id = 2;
                  (&creature_pool)[iVar7].move_speed = 4.0;
                  (&creature_pool)[iVar7].reward_value = 350.0;
                  (&creature_pool)[iVar7].tint_a = 1.0;
                  (&creature_pool)[iVar7].size = 35.0;
                  (&creature_pool)[iVar7].contact_damage = 30.0;
                } while ((int)pos < 0x18);
                goto LAB_004310b8;
              }
              if (template_id == 0xc) {
                (&creature_pool)[iVar6].type_id = 2;
                (&creature_pool)[iVar6].flags = 4;
                iVar7 = creature_spawn_slot_alloc();
                (&creature_pool)[iVar6].link_index = iVar7;
                (&creature_spawn_slot_timer)[iVar7 * 6] = 0x3fc00000;
                (&creature_spawn_slot_count)[iVar7 * 6] = 0;
                (&creature_spawn_slot_limit)[iVar7 * 6] = 100;
                (&creature_spawn_slot_interval)[iVar7 * 6] = 0x40000000;
                *(undefined4 *)(&creature_spawn_slot_template + iVar7 * 0x18) = 0x31;
                (&creature_spawn_slot_owner)[iVar7 * 6] = pcVar10;
                (&creature_pool)[iVar6].size = 32.0;
                (&creature_pool)[iVar6].health = 50.0;
                (&creature_pool)[iVar6].move_speed = 2.8;
                (&creature_pool)[iVar6].reward_value = 1000.0;
              }
              else {
                if (template_id != 0xd) {
                  if (template_id == 9) {
                    (&creature_pool)[iVar6].type_id = 2;
                    (&creature_pool)[iVar6].flags = 4;
                    iVar7 = creature_spawn_slot_alloc();
                    (&creature_pool)[iVar6].link_index = iVar7;
                    (&creature_spawn_slot_timer)[iVar7 * 6] = 0x3f800000;
                    (&creature_spawn_slot_count)[iVar7 * 6] = 0;
                    (&creature_spawn_slot_limit)[iVar7 * 6] = 0x10;
                    (&creature_spawn_slot_interval)[iVar7 * 6] = 0x40000000;
                    *(undefined4 *)(&creature_spawn_slot_template + iVar7 * 0x18) = 0x1d;
                    (&creature_spawn_slot_owner)[iVar7 * 6] = pcVar10;
                    (&creature_pool)[iVar6].size = 40.0;
                    (&creature_pool)[iVar6].health = 450.0;
                    (&creature_pool)[iVar6].move_speed = 2.0;
                    (&creature_pool)[iVar6].reward_value = 1000.0;
                    (&creature_pool)[iVar6].tint_a = 1.0;
                    (&creature_pool)[iVar6].tint_r = 1.0;
                    (&creature_pool)[iVar6].tint_g = 1.0;
                    (&creature_pool)[iVar6].tint_b = 1.0;
                    (&creature_pool)[iVar6].contact_damage = 0.0;
                    goto LAB_004310b8;
                  }
                  if (template_id == 7) {
                    (&creature_pool)[iVar6].type_id = 2;
                    (&creature_pool)[iVar6].flags = 4;
                    iVar7 = creature_spawn_slot_alloc();
                    (&creature_pool)[iVar6].link_index = iVar7;
                    (&creature_spawn_slot_timer)[iVar7 * 6] = 0x3f800000;
                    (&creature_spawn_slot_count)[iVar7 * 6] = 0;
                    (&creature_spawn_slot_limit)[iVar7 * 6] = 100;
                    (&creature_spawn_slot_interval)[iVar7 * 6] = 0x400ccccd;
                  }
                  else {
                    if (template_id != 8) {
                      if (template_id == 0x1a) {
                        (&creature_pool)[iVar6].type_id = 2;
                        (&creature_pool)[iVar6].size = 50.0;
                        (&creature_pool)[iVar6].ai_mode = 1;
                        (&creature_pool)[iVar6].health = 50.0;
                        (&creature_pool)[iVar6].move_speed = 2.4;
                        (&creature_pool)[iVar6].reward_value = 125.0;
                        (&creature_pool)[iVar6].tint_a = 1.0;
                        iVar7 = crt_rand();
                        fVar4 = (float)(iVar7 % 0x28);
                      }
                      else if (template_id == 0x1b) {
                        (&creature_pool)[iVar6].type_id = 3;
                        (&creature_pool)[iVar6].size = 50.0;
                        (&creature_pool)[iVar6].ai_mode = 1;
                        (&creature_pool)[iVar6].health = 40.0;
                        (&creature_pool)[iVar6].move_speed = 2.4;
                        (&creature_pool)[iVar6].reward_value = 125.0;
                        (&creature_pool)[iVar6].tint_a = 1.0;
                        iVar7 = crt_rand();
                        fVar4 = (float)(iVar7 % 0x28);
                      }
                      else {
                        if (template_id != 0x1c) {
                          if (template_id == 0x41) {
                            (&creature_pool)[iVar6].type_id = 0;
                            iVar7 = crt_rand();
                            (&creature_pool)[iVar6].tint_a = 1.0;
                            fVar4 = (float)(iVar7 % 0x1e + 0x28);
                            (&creature_pool)[iVar6].size = fVar4;
                            (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 10.0;
                            (&creature_pool)[iVar6].move_speed = fVar4 * 0.0025 + 0.9;
                            (&creature_pool)[iVar6].reward_value = fVar4 + fVar4 + 50.0;
                            iVar7 = crt_rand();
                            fVar4 = (float)(iVar7 % 0x28) * 0.01 + 0.6;
                            (&creature_pool)[iVar6].tint_r = fVar4;
                            (&creature_pool)[iVar6].tint_g = fVar4;
                            (&creature_pool)[iVar6].tint_b = fVar4;
                            iVar7 = crt_rand();
                            (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 10) + 4.0;
                            goto LAB_004310b8;
                          }
                          if (template_id == 0x31) {
                            (&creature_pool)[iVar6].type_id = 1;
                            iVar7 = crt_rand();
                            fVar4 = (float)(iVar7 % 0x1e + 0x28);
                            (&creature_pool)[iVar6].size = fVar4;
                            (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 10.0;
                            iVar7 = crt_rand();
                            (&creature_pool)[iVar6].tint_a = 1.0;
                            (&creature_pool)[iVar6].move_speed = (float)(iVar7 % 0x12) * 0.1 + 1.1;
                            (&creature_pool)[iVar6].reward_value =
                                 (&creature_pool)[iVar6].size + (&creature_pool)[iVar6].size + 50.0;
                            iVar7 = crt_rand();
                            (&creature_pool)[iVar6].tint_b = 0.38;
                            fVar4 = (float)(iVar7 % 0x1e) * 0.01 + 0.6;
                            (&creature_pool)[iVar6].tint_r = fVar4;
                            (&creature_pool)[iVar6].tint_g = fVar4;
                          }
                          else {
                            if (template_id != 0x32) {
                              if (template_id == 0x33) {
                                (&creature_pool)[iVar6].type_id = 3;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 0xf + 0x2d);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 20.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0x12) * 0.1 + 1.1;
                                (&creature_pool)[iVar6].reward_value =
                                     (&creature_pool)[iVar6].size + (&creature_pool)[iVar6].size +
                                     50.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_g = 0.5;
                                (&creature_pool)[iVar6].tint_b = 0.5;
                                (&creature_pool)[iVar6].tint_r = (float)(iVar7 % 0x28) * 0.01 + 0.6;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 10) + 4.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x34) {
                                (&creature_pool)[iVar6].type_id = 3;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 0x14 + 0x28);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 20.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0x12) * 0.1 + 1.1;
                                (&creature_pool)[iVar6].reward_value =
                                     (&creature_pool)[iVar6].size + (&creature_pool)[iVar6].size +
                                     50.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_r = 0.5;
                                (&creature_pool)[iVar6].tint_b = 0.5;
                                (&creature_pool)[iVar6].tint_g = (float)(iVar7 % 0x28) * 0.01 + 0.6;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 10) + 4.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x20) {
                                (&creature_pool)[iVar6].type_id = 2;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 0x1e + 0x28);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 20.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].tint_r = 0.3;
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0x12) * 0.1 + 1.1;
                                (&creature_pool)[iVar6].reward_value =
                                     (&creature_pool)[iVar6].size + (&creature_pool)[iVar6].size +
                                     50.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_b = 0.3;
                                (&creature_pool)[iVar6].tint_g = (float)(iVar7 % 0x28) * 0.01 + 0.6;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 10) + 4.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 3) {
                                (&creature_pool)[iVar6].type_id = 3;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 0xf + 0x26);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 20.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].tint_r = 0.6;
                                (&creature_pool)[iVar6].tint_g = 0.6;
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0x12) * 0.1 + 1.1;
                                (&creature_pool)[iVar6].reward_value =
                                     (&creature_pool)[iVar6].size + (&creature_pool)[iVar6].size +
                                     50.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_b = (float)(iVar7 % 0x19) * 0.01 + 0.8;
                                if (0.0 <= (&creature_pool)[iVar6].tint_r) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_r) {
                                    (&creature_pool)[iVar6].tint_r = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_r = 0.0;
                                }
                                if (0.0 <= (&creature_pool)[iVar6].tint_g) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_g) {
                                    (&creature_pool)[iVar6].tint_g = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_g = 0.0;
                                }
                                if (0.0 <= (&creature_pool)[iVar6].tint_b) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_b) {
                                    (&creature_pool)[iVar6].tint_b = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_b = 0.0;
                                }
                                if (0.0 <= (&creature_pool)[iVar6].tint_a) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_a) {
                                    (&creature_pool)[iVar6].tint_a = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_a = 0.0;
                                }
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 10) + 4.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 5) {
                                (&creature_pool)[iVar6].type_id = 4;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 0xf + 0x26);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 20.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].tint_r = 0.6;
                                (&creature_pool)[iVar6].tint_g = 0.6;
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0x12) * 0.1 + 1.1;
                                (&creature_pool)[iVar6].reward_value =
                                     (&creature_pool)[iVar6].size + (&creature_pool)[iVar6].size +
                                     50.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_b = (float)(iVar7 % 0x19) * 0.01 + 0.8;
                                if (0.0 <= (&creature_pool)[iVar6].tint_r) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_r) {
                                    (&creature_pool)[iVar6].tint_r = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_r = 0.0;
                                }
                                if (0.0 <= (&creature_pool)[iVar6].tint_g) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_g) {
                                    (&creature_pool)[iVar6].tint_g = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_g = 0.0;
                                }
                                if (0.0 <= (&creature_pool)[iVar6].tint_b) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_b) {
                                    (&creature_pool)[iVar6].tint_b = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_b = 0.0;
                                }
                                if (0.0 <= (&creature_pool)[iVar6].tint_a) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_a) {
                                    (&creature_pool)[iVar6].tint_a = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_a = 0.0;
                                }
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 10) + 4.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 4) {
                                (&creature_pool)[iVar6].type_id = 1;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 0xf + 0x26);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 20.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].tint_r = 0.67;
                                (&creature_pool)[iVar6].tint_g = 0.67;
                                (&creature_pool)[iVar6].tint_b = 1.0;
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0x12) * 0.1 + 1.1;
                                (&creature_pool)[iVar6].reward_value =
                                     (&creature_pool)[iVar6].size + (&creature_pool)[iVar6].size +
                                     50.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 10) + 4.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 6) {
                                (&creature_pool)[iVar6].type_id = 2;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 0xf + 0x26);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 20.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].tint_r = 0.6;
                                (&creature_pool)[iVar6].tint_g = 0.6;
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0x12) * 0.1 + 1.1;
                                (&creature_pool)[iVar6].reward_value =
                                     (&creature_pool)[iVar6].size + (&creature_pool)[iVar6].size +
                                     50.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_b = (float)(iVar7 % 0x19) * 0.01 + 0.8;
                                if (0.0 <= (&creature_pool)[iVar6].tint_r) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_r) {
                                    (&creature_pool)[iVar6].tint_r = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_r = 0.0;
                                }
                                if (0.0 <= (&creature_pool)[iVar6].tint_g) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_g) {
                                    (&creature_pool)[iVar6].tint_g = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_g = 0.0;
                                }
                                if (0.0 <= (&creature_pool)[iVar6].tint_b) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_b) {
                                    (&creature_pool)[iVar6].tint_b = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_b = 0.0;
                                }
                                if (0.0 <= (&creature_pool)[iVar6].tint_a) {
                                  if (1.0 < (&creature_pool)[iVar6].tint_a) {
                                    (&creature_pool)[iVar6].tint_a = 1.0;
                                  }
                                }
                                else {
                                  (&creature_pool)[iVar6].tint_a = 0.0;
                                }
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 10) + 4.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x35) {
                                (&creature_pool)[iVar6].type_id = 4;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 10 + 0x1e);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 20.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].tint_b = 0.8;
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0x12) * 0.1 + 1.1;
                                (&creature_pool)[iVar6].reward_value =
                                     (&creature_pool)[iVar6].size + (&creature_pool)[iVar6].size +
                                     50.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_r = 0.8;
                                (&creature_pool)[iVar6].tint_g = (float)(iVar7 % 0x14) * 0.01 + 0.8;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 10) + 4.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x2e) {
                                (&creature_pool)[iVar6].type_id = 1;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 0x1e + 0x28);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 20.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0x12) * 0.1 + 1.1;
                                (&creature_pool)[iVar6].reward_value =
                                     (&creature_pool)[iVar6].size + (&creature_pool)[iVar6].size +
                                     50.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_r = (float)(iVar7 % 0x28) * 0.01 + 0.6;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_g = (float)(iVar7 % 0x28) * 0.01 + 0.6;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_b = (float)(iVar7 % 0x28) * 0.01 + 0.6;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 10) + 4.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x36) {
                                (&creature_pool)[iVar6].type_id = 2;
                                (&creature_pool)[iVar6].size = 50.0;
                                (&creature_pool)[iVar6].ai_mode = 7;
                                (&creature_pool)[iVar6].orbit_radius = 1.5;
                                (&creature_pool)[iVar6].health = 10.0;
                                (&creature_pool)[iVar6].move_speed = 1.8;
                                (&creature_pool)[iVar6].reward_value = 150.0;
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_g = (float)(iVar7 % 5) * 0.01 + 0.65;
                                (&creature_pool)[iVar6].tint_r = 0.65;
                                (&creature_pool)[iVar6].tint_b = 0.95;
                                (&creature_pool)[iVar6].contact_damage = 40.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x1d) {
                                (&creature_pool)[iVar6].type_id = 2;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 0x14 + 0x23);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 1.1428572 + 10.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0xf) * 0.1 + 1.1;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].reward_value = (float)(iVar7 % 100 + 0x32);
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_r = (float)(iVar7 % 0x32) * 0.001 + 0.6
                                ;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_g = (float)(iVar7 % 0x32) * 0.01 + 0.5;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_b = (float)(iVar7 % 0x32) * 0.001 + 0.6
                                ;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 10) + 4.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x1e) {
                                (&creature_pool)[iVar6].type_id = 2;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 0x1e + 0x23);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 2.2857144 + 10.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0x11) * 0.1 + 1.5;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].reward_value = (float)(iVar7 % 200 + 0x32);
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_r = (float)(iVar7 % 0x32) * 0.001 + 0.6
                                ;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_g = (float)(iVar7 % 0x32) * 0.001 + 0.6
                                ;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_b = (float)(iVar7 % 0x32) * 0.01 + 0.5;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 0x1e) + 4.0
                                ;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x1f) {
                                (&creature_pool)[iVar6].type_id = 2;
                                iVar7 = crt_rand();
                                fVar4 = (float)(iVar7 % 0x1e + 0x2d);
                                (&creature_pool)[iVar6].size = fVar4;
                                (&creature_pool)[iVar6].health = fVar4 * 3.7142856 + 30.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].move_speed =
                                     (float)(iVar7 % 0x15) * 0.1 + 1.6;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].reward_value = (float)(iVar7 % 200 + 0x50);
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_r = (float)(iVar7 % 0x32) * 0.01 + 0.5;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_g = (float)(iVar7 % 0x32) * 0.001 + 0.6
                                ;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].tint_b = (float)(iVar7 % 0x32) * 0.001 + 0.6
                                ;
                                iVar7 = crt_rand();
                                (&creature_pool)[iVar6].contact_damage = (float)(iVar7 % 0x23) + 8.0
                                ;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x24) {
                                (&creature_pool)[iVar6].type_id = 2;
                                (&creature_pool)[iVar6].health = 20.0;
                                (&creature_pool)[iVar6].move_speed = 2.0;
                                (&creature_pool)[iVar6].reward_value = 110.0;
                                (&creature_pool)[iVar6].tint_r = 0.1;
                                (&creature_pool)[iVar6].tint_g = 0.7;
                                (&creature_pool)[iVar6].tint_b = 0.11;
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].size = 50.0;
                                (&creature_pool)[iVar6].contact_damage = 4.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x25) {
                                (&creature_pool)[iVar6].type_id = 2;
                                (&creature_pool)[iVar6].health = 25.0;
                                (&creature_pool)[iVar6].move_speed = 2.5;
                                (&creature_pool)[iVar6].reward_value = 125.0;
                                (&creature_pool)[iVar6].tint_r = 0.1;
                                (&creature_pool)[iVar6].tint_g = 0.8;
                                (&creature_pool)[iVar6].tint_b = 0.11;
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].size = 30.0;
                                (&creature_pool)[iVar6].contact_damage = 3.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x26) {
                                (&creature_pool)[iVar6].type_id = 2;
                                (&creature_pool)[iVar6].health = 50.0;
                                (&creature_pool)[iVar6].move_speed = 2.2;
                                (&creature_pool)[iVar6].reward_value = 125.0;
                                (&creature_pool)[iVar6].tint_r = 0.6;
                                (&creature_pool)[iVar6].tint_g = 0.8;
                                (&creature_pool)[iVar6].tint_b = 0.6;
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                (&creature_pool)[iVar6].size = 45.0;
                                (&creature_pool)[iVar6].contact_damage = 10.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x27) {
                                (&creature_pool)[iVar6].type_id = 2;
                                (&creature_pool)[iVar6].health = 50.0;
                                (&creature_pool)[iVar6].move_speed = 2.1;
                                (&creature_pool)[iVar6].flags = 0x400;
                                (&creature_pool)[iVar6].reward_value = 125.0;
                                (&creature_pool)[iVar6].tint_r = 1.0;
                                (&creature_pool)[iVar6].tint_g = 0.8;
                                (&creature_pool)[iVar6].tint_b = 0.1;
                                (&creature_pool)[iVar6].tint_a = 1.0;
                                *(undefined2 *)&(&creature_pool)[iVar6].link_index = 3;
                                *(undefined2 *)((int)&(&creature_pool)[iVar6].link_index + 2) = 5;
                                (&creature_pool)[iVar6].size = 45.0;
                                (&creature_pool)[iVar6].contact_damage = 10.0;
                                goto LAB_004310b8;
                              }
                              if (template_id == 0x21) {
                                (&creature_pool)[iVar6].type_id = 2;
                                (&creature_pool)[iVar6].health = 53.0;
                                (&creature_pool)[iVar6].move_speed = 1.7;
                                (&creature_pool)[iVar6].reward_value = 120.0;
                                (&creature_pool)[iVar6].tint_r = 0.7;
                                (&creature_pool)[iVar6].tint_g = 0.1;
                                (&creature_pool)[iVar6].tint_b = 0.51;
                                local_4 = 0.5;
                              }
                              else {
                                if (template_id == 0x22) {
                                  (&creature_pool)[iVar6].type_id = 2;
                                  (&creature_pool)[iVar6].health = 25.0;
                                  (&creature_pool)[iVar6].move_speed = 1.7;
                                  (&creature_pool)[iVar6].reward_value = 150.0;
                                  (&creature_pool)[iVar6].tint_r = 0.1;
                                  (&creature_pool)[iVar6].tint_g = 0.7;
                                  (&creature_pool)[iVar6].tint_b = 0.51;
                                  (&creature_pool)[iVar6].tint_a = 0.05;
                                  (&creature_pool)[iVar6].size = 50.0;
                                  (&creature_pool)[iVar6].contact_damage = 8.0;
                                  goto LAB_004310b8;
                                }
                                if (template_id == 0x23) {
                                  (&creature_pool)[iVar6].type_id = 2;
                                  (&creature_pool)[iVar6].health = 5.0;
                                  (&creature_pool)[iVar6].move_speed = 1.7;
                                  (&creature_pool)[iVar6].reward_value = 180.0;
                                  (&creature_pool)[iVar6].tint_r = 0.1;
                                  (&creature_pool)[iVar6].tint_g = 0.7;
                                  (&creature_pool)[iVar6].tint_b = 0.51;
                                  (&creature_pool)[iVar6].tint_a = 0.04;
                                  (&creature_pool)[iVar6].size = 45.0;
                                  (&creature_pool)[iVar6].contact_damage = 8.0;
                                  goto LAB_004310b8;
                                }
                                if (template_id != 0x28) {
                                  if (template_id == 0x29) {
                                    (&creature_pool)[iVar6].type_id = 2;
                                    (&creature_pool)[iVar6].health = 800.0;
                                    (&creature_pool)[iVar6].move_speed = 2.5;
                                    (&creature_pool)[iVar6].reward_value = 450.0;
                                    (&creature_pool)[iVar6].tint_r = 0.8;
                                    (&creature_pool)[iVar6].tint_g = 0.8;
                                    (&creature_pool)[iVar6].tint_b = 0.8;
                                    (&creature_pool)[iVar6].tint_a = 1.0;
                                    (&creature_pool)[iVar6].size = 70.0;
                                    (&creature_pool)[iVar6].contact_damage = 20.0;
                                    goto LAB_004310b8;
                                  }
                                  if (template_id == 0x2a) {
                                    (&creature_pool)[iVar6].type_id = 2;
                                    (&creature_pool)[iVar6].health = 50.0;
                                    (&creature_pool)[iVar6].move_speed = 3.1;
                                    (&creature_pool)[iVar6].reward_value = 300.0;
                                    (&creature_pool)[iVar6].tint_r = 0.3;
                                    (&creature_pool)[iVar6].tint_g = 0.3;
                                    (&creature_pool)[iVar6].tint_b = 0.3;
                                    (&creature_pool)[iVar6].tint_a = 1.0;
                                    (&creature_pool)[iVar6].size = 60.0;
                                    (&creature_pool)[iVar6].contact_damage = 8.0;
                                    goto LAB_004310b8;
                                  }
                                  if (template_id == 0x2b) {
                                    (&creature_pool)[iVar6].type_id = 2;
                                    (&creature_pool)[iVar6].health = 30.0;
                                    (&creature_pool)[iVar6].move_speed = 3.6;
                                    (&creature_pool)[iVar6].reward_value = 450.0;
                                    (&creature_pool)[iVar6].tint_r = 1.0;
                                    (&creature_pool)[iVar6].tint_g = 0.3;
                                    (&creature_pool)[iVar6].tint_b = 0.3;
                                  }
                                  else {
                                    if (template_id == 0x2c) {
                                      (&creature_pool)[iVar6].type_id = 2;
                                      (&creature_pool)[iVar6].health = 3800.0;
                                      (&creature_pool)[iVar6].move_speed = 2.0;
                                      (&creature_pool)[iVar6].reward_value = 1500.0;
                                      (&creature_pool)[iVar6].tint_r = 0.85;
                                      (&creature_pool)[iVar6].tint_g = 0.2;
                                      (&creature_pool)[iVar6].tint_b = 0.2;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      (&creature_pool)[iVar6].size = 80.0;
                                      (&creature_pool)[iVar6].contact_damage = 40.0;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0x2d) {
                                      (&creature_pool)[iVar6].type_id = 2;
                                      (&creature_pool)[iVar6].health = 45.0;
                                      (&creature_pool)[iVar6].move_speed = 3.1;
                                      (&creature_pool)[iVar6].reward_value = 200.0;
                                      (&creature_pool)[iVar6].tint_r = 0.0;
                                      (&creature_pool)[iVar6].tint_g = 0.9;
                                      (&creature_pool)[iVar6].tint_b = 0.8;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      (&creature_pool)[iVar6].size = 38.0;
                                      (&creature_pool)[iVar6].contact_damage = 3.0;
                                      (&creature_pool)[iVar6].ai_mode = 2;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0x2f) {
                                      (&creature_pool)[iVar6].type_id = 1;
                                      (&creature_pool)[iVar6].health = 20.0;
                                      (&creature_pool)[iVar6].move_speed = 2.5;
                                      (&creature_pool)[iVar6].reward_value = 150.0;
                                      (&creature_pool)[iVar6].tint_r = 0.8;
                                      (&creature_pool)[iVar6].tint_g = 0.8;
                                      (&creature_pool)[iVar6].tint_b = 0.8;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      (&creature_pool)[iVar6].size = 45.0;
                                      (&creature_pool)[iVar6].contact_damage = 4.0;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0x30) {
                                      (&creature_pool)[iVar6].type_id = 1;
                                      (&creature_pool)[iVar6].health = 1000.0;
                                      (&creature_pool)[iVar6].move_speed = 2.0;
                                      (&creature_pool)[iVar6].reward_value = 400.0;
                                      (&creature_pool)[iVar6].tint_r = 0.9;
                                      (&creature_pool)[iVar6].tint_g = 0.8;
                                      (&creature_pool)[iVar6].tint_b = 0.1;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      (&creature_pool)[iVar6].size = 65.0;
                                      (&creature_pool)[iVar6].contact_damage = 10.0;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0x3b) {
                                      (&creature_pool)[iVar6].type_id = 3;
                                      (&creature_pool)[iVar6].health = 1200.0;
                                      (&creature_pool)[iVar6].move_speed = 2.0;
                                      (&creature_pool)[iVar6].reward_value = 4000.0;
                                      (&creature_pool)[iVar6].tint_r = 0.9;
                                      (&creature_pool)[iVar6].tint_g = 0.0;
                                      (&creature_pool)[iVar6].tint_b = 0.0;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      (&creature_pool)[iVar6].size = 70.0;
                                      (&creature_pool)[iVar6].contact_damage = 20.0;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0x3c) {
                                      (&creature_pool)[iVar6].type_id = 3;
                                      (&creature_pool)[iVar6].flags = 0x100;
                                      (&creature_pool)[iVar6].orbit_angle = 0.4;
                                      (&creature_pool)[iVar6].orbit_radius = 3.64338e-44;
                                      (&creature_pool)[iVar6].health = 200.0;
                                      (&creature_pool)[iVar6].move_speed = 2.0;
                                      (&creature_pool)[iVar6].reward_value = 200.0;
                                      (&creature_pool)[iVar6].tint_r = 0.9;
                                      (&creature_pool)[iVar6].tint_g = 0.1;
                                      (&creature_pool)[iVar6].tint_b = 0.1;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      (&creature_pool)[iVar6].size = 40.0;
                                      (&creature_pool)[iVar6].contact_damage = 20.0;
                                      (&creature_pool)[iVar6].ai_mode = 2;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0x3d) {
                                      (&creature_pool)[iVar6].type_id = 3;
                                      (&creature_pool)[iVar6].health = 70.0;
                                      (&creature_pool)[iVar6].move_speed = 2.6;
                                      (&creature_pool)[iVar6].reward_value = 120.0;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      iVar7 = crt_rand();
                                      fVar4 = (float)(iVar7 % 0x14) * 0.01 + 0.8;
                                      (&creature_pool)[iVar6].tint_r = fVar4;
                                      (&creature_pool)[iVar6].tint_b = fVar4;
                                      (&creature_pool)[iVar6].tint_g = fVar4;
                                      iVar7 = crt_rand();
                                      fVar4 = (float)(iVar7 % 7 + 0x2d);
                                      (&creature_pool)[iVar6].size = fVar4;
                                      (&creature_pool)[iVar6].contact_damage = fVar4 * 0.22;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0x3e) {
                                      (&creature_pool)[iVar6].type_id = 3;
                                      (&creature_pool)[iVar6].health = 1000.0;
                                      (&creature_pool)[iVar6].move_speed = 2.8;
                                      (&creature_pool)[iVar6].reward_value = 500.0;
                                      (&creature_pool)[iVar6].tint_r = 1.0;
                                      (&creature_pool)[iVar6].tint_g = 1.0;
                                      (&creature_pool)[iVar6].tint_b = 1.0;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      (&creature_pool)[iVar6].size = 64.0;
                                      (&creature_pool)[iVar6].contact_damage = 40.0;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0) {
                                      (&creature_pool)[iVar6].type_id = 0;
                                      (&creature_pool)[iVar6].flags = 0x44;
                                      (&creature_pool)[iVar6].health = 8500.0;
                                      (&creature_pool)[iVar6].move_speed = 1.3;
                                      (&creature_pool)[iVar6].reward_value = 6600.0;
                                      (&creature_pool)[iVar6].tint_r = 0.6;
                                      (&creature_pool)[iVar6].tint_g = 0.6;
                                      (&creature_pool)[iVar6].tint_b = 1.0;
                                      (&creature_pool)[iVar6].tint_a = 0.8;
                                      (&creature_pool)[iVar6].size = 64.0;
                                      (&creature_pool)[iVar6].contact_damage = 50.0;
                                      iVar7 = creature_spawn_slot_alloc();
                                      (&creature_pool)[iVar6].link_index = iVar7;
                                      (&creature_spawn_slot_timer)[iVar7 * 6] = 0x3f800000;
                                      (&creature_spawn_slot_count)[iVar7 * 6] = 0;
                                      (&creature_spawn_slot_limit)[iVar7 * 6] = 0x32c;
                                      (&creature_spawn_slot_interval)[iVar7 * 6] = 0x3f333333;
                                      *(undefined4 *)(&creature_spawn_slot_template + iVar7 * 0x18)
                                           = 0x41;
                                      (&creature_spawn_slot_owner)[iVar7 * 6] = pcVar10;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0x38) {
                                      (&creature_pool)[iVar6].type_id = 3;
                                      (&creature_pool)[iVar6].flags = 0x80;
                                      (&creature_pool)[iVar6].link_index = 0;
                                      (&creature_pool)[iVar6].health = 50.0;
                                      (&creature_pool)[iVar6].move_speed = 4.8;
                                      (&creature_pool)[iVar6].reward_value = 433.0;
                                      (&creature_pool)[iVar6].tint_r = 1.0;
                                      (&creature_pool)[iVar6].tint_g = 0.75;
                                      (&creature_pool)[iVar6].tint_b = 0.1;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      uVar9 = crt_rand();
                                      uVar9 = uVar9 & 0x80000003;
                                      if ((int)uVar9 < 0) {
                                        uVar9 = (uVar9 - 1 | 0xfffffffc) + 1;
                                      }
                                      (&creature_pool)[iVar6].size = (float)(int)(uVar9 + 0x29);
                                      (&creature_pool)[iVar6].contact_damage = 10.0;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0x37) {
                                      (&creature_pool)[iVar6].type_id = 4;
                                      (&creature_pool)[iVar6].flags = 0x100;
                                      (&creature_pool)[iVar6].link_index = 0;
                                      (&creature_pool)[iVar6].health = 50.0;
                                      (&creature_pool)[iVar6].move_speed = 3.2;
                                      (&creature_pool)[iVar6].reward_value = 433.0;
                                      (&creature_pool)[iVar6].tint_r = 1.0;
                                      (&creature_pool)[iVar6].tint_g = 0.75;
                                      (&creature_pool)[iVar6].tint_b = 0.1;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      uVar9 = crt_rand();
                                      uVar9 = uVar9 & 0x80000003;
                                      if ((int)uVar9 < 0) {
                                        uVar9 = (uVar9 - 1 | 0xfffffffc) + 1;
                                      }
                                      (&creature_pool)[iVar6].size = (float)(int)(uVar9 + 0x29);
                                      (&creature_pool)[iVar6].contact_damage = 10.0;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0x39) {
                                      (&creature_pool)[iVar6].type_id = 3;
                                      (&creature_pool)[iVar6].flags = 0x80;
                                      (&creature_pool)[iVar6].link_index = 0;
                                      (&creature_pool)[iVar6].health = 4.0;
                                      (&creature_pool)[iVar6].move_speed = 4.8;
                                      (&creature_pool)[iVar6].reward_value = 50.0;
                                      (&creature_pool)[iVar6].tint_r = 0.8;
                                      (&creature_pool)[iVar6].tint_g = 0.65;
                                      (&creature_pool)[iVar6].tint_b = 0.1;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      uVar9 = crt_rand();
                                      uVar9 = uVar9 & 0x80000003;
                                      if ((int)uVar9 < 0) {
                                        uVar9 = (uVar9 - 1 | 0xfffffffc) + 1;
                                      }
                                      (&creature_pool)[iVar6].size = (float)(int)(uVar9 + 0x1a);
                                      (&creature_pool)[iVar6].contact_damage = 10.0;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id == 0x3a) {
                                      (&creature_pool)[iVar6].type_id = 3;
                                      (&creature_pool)[iVar6].flags = 0x10;
                                      (&creature_pool)[iVar6].orbit_angle = 0.9;
                                      (&creature_pool)[iVar6].orbit_radius = 1.26117e-44;
                                      (&creature_pool)[iVar6].health = 4500.0;
                                      (&creature_pool)[iVar6].move_speed = 2.0;
                                      (&creature_pool)[iVar6].reward_value = 4500.0;
                                      (&creature_pool)[iVar6].tint_r = 1.0;
                                      (&creature_pool)[iVar6].tint_g = 1.0;
                                      (&creature_pool)[iVar6].tint_b = 1.0;
                                      (&creature_pool)[iVar6].tint_a = 1.0;
                                      (&creature_pool)[iVar6].size = 64.0;
                                      (&creature_pool)[iVar6].contact_damage = 50.0;
                                      goto LAB_004310b8;
                                    }
                                    if (template_id != 0x3f) {
                                      if (template_id == 0x40) {
                                        (&creature_pool)[iVar6].type_id = 3;
                                        (&creature_pool)[iVar6].health = 70.0;
                                        (&creature_pool)[iVar6].move_speed = 2.2;
                                        (&creature_pool)[iVar6].reward_value = 160.0;
                                        (&creature_pool)[iVar6].tint_r = 0.5;
                                        (&creature_pool)[iVar6].tint_g = 0.6;
                                        (&creature_pool)[iVar6].tint_b = 0.9;
                                        (&creature_pool)[iVar6].tint_a = 1.0;
                                        (&creature_pool)[iVar6].size = 45.0;
                                        (&creature_pool)[iVar6].contact_damage = 5.0;
                                        goto LAB_004310b8;
                                      }
                                      if (template_id == 0x42) {
                                        (&creature_pool)[iVar6].type_id = 0;
                                        (&creature_pool)[iVar6].health = 200.0;
                                        (&creature_pool)[iVar6].move_speed = 1.7;
                                        (&creature_pool)[iVar6].reward_value = 160.0;
                                        (&creature_pool)[iVar6].tint_r = 0.9;
                                        (&creature_pool)[iVar6].tint_g = 0.9;
                                        (&creature_pool)[iVar6].tint_b = 0.9;
                                        (&creature_pool)[iVar6].tint_a = 1.0;
                                        (&creature_pool)[iVar6].size = 45.0;
                                        (&creature_pool)[iVar6].contact_damage = 15.0;
                                        goto LAB_004310b8;
                                      }
                                      if (template_id == 0x43) {
                                        (&creature_pool)[iVar6].type_id = 0;
                                        (&creature_pool)[iVar6].health = 2000.0;
                                        (&creature_pool)[iVar6].move_speed = 2.1;
                                        (&creature_pool)[iVar6].reward_value = 460.0;
                                        (&creature_pool)[iVar6].tint_r = 0.2;
                                        (&creature_pool)[iVar6].tint_g = 0.6;
                                        (&creature_pool)[iVar6].tint_b = 0.1;
                                        (&creature_pool)[iVar6].tint_a = 1.0;
                                        (&creature_pool)[iVar6].size = 70.0;
                                        (&creature_pool)[iVar6].contact_damage = 15.0;
                                        goto LAB_004310b8;
                                      }
                                      goto LAB_00431094;
                                    }
                                    (&creature_pool)[iVar6].type_id = 3;
                                    (&creature_pool)[iVar6].health = 200.0;
                                    (&creature_pool)[iVar6].move_speed = 2.3;
                                    (&creature_pool)[iVar6].reward_value = 210.0;
                                    (&creature_pool)[iVar6].tint_r = 0.7;
                                    (&creature_pool)[iVar6].tint_g = 0.4;
                                    (&creature_pool)[iVar6].tint_b = 0.1;
                                  }
                                  (&creature_pool)[iVar6].tint_a = 1.0;
                                  (&creature_pool)[iVar6].size = 35.0;
                                  (&creature_pool)[iVar6].contact_damage = 20.0;
                                  goto LAB_004310b8;
                                }
                                (&creature_pool)[iVar6].type_id = 2;
                                (&creature_pool)[iVar6].health = 50.0;
                                (&creature_pool)[iVar6].move_speed = 1.7;
                                (&creature_pool)[iVar6].reward_value = 150.0;
                                (&creature_pool)[iVar6].tint_r = 0.7;
                                local_4 = 1.0;
                                (&creature_pool)[iVar6].tint_g = 0.1;
                                (&creature_pool)[iVar6].tint_b = 0.51;
                              }
                              (&creature_pool)[iVar6].tint_a = local_4;
                              (&creature_pool)[iVar6].size = 55.0;
                              (&creature_pool)[iVar6].contact_damage = 8.0;
                              goto LAB_004310b8;
                            }
                            (&creature_pool)[iVar6].type_id = 3;
                            iVar7 = crt_rand();
                            fVar4 = (float)(iVar7 % 0x19 + 0x28);
                            (&creature_pool)[iVar6].size = fVar4;
                            (&creature_pool)[iVar6].health = fVar4 + 10.0;
                            iVar7 = crt_rand();
                            (&creature_pool)[iVar6].tint_a = 1.0;
                            (&creature_pool)[iVar6].move_speed = (float)(iVar7 % 0x11) * 0.1 + 1.1;
                            (&creature_pool)[iVar6].reward_value =
                                 (&creature_pool)[iVar6].size + (&creature_pool)[iVar6].size + 50.0;
                            iVar7 = crt_rand();
                            fVar4 = (float)(iVar7 % 0x28) * 0.01 + 0.6;
                            (&creature_pool)[iVar6].tint_r = fVar4;
                            (&creature_pool)[iVar6].tint_g = fVar4;
                            (&creature_pool)[iVar6].tint_b = fVar4;
                          }
                          (&creature_pool)[iVar6].contact_damage =
                               (&creature_pool)[iVar6].size * 0.14 + 4.0;
                          goto LAB_004310b8;
                        }
                        (&creature_pool)[iVar6].type_id = 1;
                        (&creature_pool)[iVar6].size = 50.0;
                        (&creature_pool)[iVar6].ai_mode = 1;
                        (&creature_pool)[iVar6].health = 50.0;
                        (&creature_pool)[iVar6].move_speed = 2.4;
                        (&creature_pool)[iVar6].reward_value = 125.0;
                        (&creature_pool)[iVar6].tint_a = 1.0;
                        iVar7 = crt_rand();
                        fVar4 = (float)(iVar7 % 0x28);
                      }
                      fVar4 = fVar4 * 0.01 + 0.5;
                      (&creature_pool)[iVar6].tint_r = fVar4;
                      (&creature_pool)[iVar6].tint_g = fVar4;
                      (&creature_pool)[iVar6].tint_b = 1.0;
                      (&creature_pool)[iVar6].contact_damage = 5.0;
                      goto LAB_004310b8;
                    }
                    (&creature_pool)[iVar6].type_id = 2;
                    (&creature_pool)[iVar6].flags = 4;
                    iVar7 = creature_spawn_slot_alloc();
                    (&creature_pool)[iVar6].link_index = iVar7;
                    (&creature_spawn_slot_timer)[iVar7 * 6] = 0x3f800000;
                    (&creature_spawn_slot_count)[iVar7 * 6] = 0;
                    (&creature_spawn_slot_limit)[iVar7 * 6] = 100;
                    (&creature_spawn_slot_interval)[iVar7 * 6] = 0x40333333;
                  }
                  *(undefined4 *)(&creature_spawn_slot_template + iVar7 * 0x18) = 0x1d;
                  (&creature_spawn_slot_owner)[iVar7 * 6] = pcVar10;
                  (&creature_pool)[iVar6].size = 50.0;
                  (&creature_pool)[iVar6].health = 1000.0;
                  (&creature_pool)[iVar6].move_speed = 2.0;
                  (&creature_pool)[iVar6].reward_value = 3000.0;
                  (&creature_pool)[iVar6].tint_a = 1.0;
                  (&creature_pool)[iVar6].tint_r = 1.0;
                  (&creature_pool)[iVar6].tint_g = 1.0;
                  (&creature_pool)[iVar6].tint_b = 1.0;
                  (&creature_pool)[iVar6].contact_damage = 0.0;
                  goto LAB_004310b8;
                }
                (&creature_pool)[iVar6].type_id = 2;
                (&creature_pool)[iVar6].flags = 4;
                iVar7 = creature_spawn_slot_alloc();
                (&creature_pool)[iVar6].link_index = iVar7;
                (&creature_spawn_slot_timer)[iVar7 * 6] = 0x40000000;
                (&creature_spawn_slot_count)[iVar7 * 6] = 0;
                (&creature_spawn_slot_limit)[iVar7 * 6] = 100;
                (&creature_spawn_slot_interval)[iVar7 * 6] = 0x40c00000;
                *(undefined4 *)(&creature_spawn_slot_template + iVar7 * 0x18) = 0x31;
                (&creature_spawn_slot_owner)[iVar7 * 6] = pcVar10;
                (&creature_pool)[iVar6].size = 32.0;
                (&creature_pool)[iVar6].health = 50.0;
                (&creature_pool)[iVar6].move_speed = 1.3;
                (&creature_pool)[iVar6].reward_value = 1000.0;
              }
            }
            (&creature_pool)[iVar6].tint_a = 1.0;
            (&creature_pool)[iVar6].tint_r = 0.9;
            (&creature_pool)[iVar6].tint_g = 0.8;
            (&creature_pool)[iVar6].tint_b = 0.4;
            (&creature_pool)[iVar6].contact_damage = 0.0;
            goto LAB_004310b8;
          }
          (&creature_pool)[iVar6].type_id = 2;
          (&creature_pool)[iVar6].pos_x = *pos;
          (&creature_pool)[iVar6].pos_y = pos[1];
          (&creature_pool)[iVar6].type_id = 2;
          (&creature_pool)[iVar6].tint_r = 0.66499996;
          (&creature_pool)[iVar6].tint_g = 0.385;
          (&creature_pool)[iVar6].ai_mode = 0;
          (&creature_pool)[iVar6].health = 20.0;
          (&creature_pool)[iVar6].tint_b = 0.259;
          (&creature_pool)[iVar6].move_speed = 2.9;
          (&creature_pool)[iVar6].reward_value = 60.0;
          (&creature_pool)[iVar6].tint_a = 0.56;
          (&creature_pool)[iVar6].size = 50.0;
          (&creature_pool)[iVar6].contact_damage = 35.0;
          (&creature_pool)[iVar6].max_health = 20.0;
        }
        goto LAB_00431094;
      }
      (&creature_pool)[iVar6].type_id = 2;
      iVar7 = terrain_texture_height / 2;
      (&creature_pool)[iVar6].ai_mode = 2;
      (&creature_pool)[iVar6].pos_x = -10.0;
      fVar11 = (float10)fcos((float10)0.0);
      (&creature_pool)[iVar6].tint_r = 0.6;
      (&creature_pool)[iVar6].pos_y = (float)iVar7;
      (&creature_pool)[iVar6].tint_g = 0.8;
      (&creature_pool)[iVar6].tint_b = 0.91;
      (&creature_pool)[iVar6].health = 200.0;
      (&creature_pool)[iVar6].move_speed = 2.0;
      (&creature_pool)[iVar6].reward_value = 600.0;
      (&creature_pool)[iVar6].tint_a = 1.0;
      (&creature_pool)[iVar6].size = 40.0;
      (&creature_pool)[iVar6].contact_damage = 20.0;
      pos = (float *)0x2;
      fVar12 = (float10)fsin((float10)0.0);
      fVar4 = *pfVar5;
      fVar1 = pfVar5[1];
      (&creature_pool)[iVar6].max_health = 200.0;
      (&creature_pool)[iVar6].pos_x = (float)(fVar11 * (float10)256.0 + (float10)fVar4);
      (&creature_pool)[iVar6].ai_mode = 6;
      (&creature_pool)[iVar6].pos_y = (float)fVar12 * 256.0 + fVar1;
      iVar7 = iVar6;
      do {
        iVar8 = creature_alloc_slot();
        fVar11 = (float10)fcos((float10)(int)pos * (float10)0.34906587);
        pcVar10 = &creature_pool + iVar8;
        (&creature_pool)[iVar8].ai_mode = 6;
        (&creature_pool)[iVar8].link_index = iVar7;
        (&creature_pool)[iVar8].orbit_angle = 3.1415927;
        (&creature_pool)[iVar8].orbit_radius = 10.0;
        fVar12 = (float10)fsin((float10)(int)pos * (float10)0.34906587);
        fVar4 = pfVar5[1];
        (&creature_pool)[iVar8].pos_x = (float)fVar11 * 256.0 + *pfVar5;
        (&creature_pool)[iVar8].vel_x = 0.0;
        (&creature_pool)[iVar8].health = 60.0;
        (&creature_pool)[iVar8].pos_y = (float)(fVar12 * (float10)256.0 + (float10)fVar4);
        (&creature_pool)[iVar8].vel_y = 0.0;
        (&creature_pool)[iVar8].reward_value = 60.0;
        (&creature_pool)[iVar8].max_health = 60.0;
        (&creature_pool)[iVar8].tint_r = 0.4;
        pos = (float *)((int)pos + 2);
        (&creature_pool)[iVar8].tint_g = 0.7;
        (&creature_pool)[iVar8].collision_flag = '\0';
        (&creature_pool)[iVar8].tint_b = 0.11;
        (&creature_pool)[iVar8].collision_timer = 0.0;
        pcVar10->active = '\x01';
        (&creature_pool)[iVar8].tint_a = 1.0;
        (&creature_pool)[iVar8].state_flag = '\x01';
        (&creature_pool)[iVar8].hitbox_size = 16.0;
        (&creature_pool)[iVar8].attack_cooldown = 0.0;
        (&creature_pool)[iVar8].type_id = 2;
        (&creature_pool)[iVar8].move_speed = 2.0;
        (&creature_pool)[iVar8].size = 50.0;
        (&creature_pool)[iVar8].contact_damage = 4.0;
        iVar7 = iVar8;
      } while ((int)pos < 0x16);
    }
    (&creature_pool)[iVar6].link_index = iVar8;
  }
LAB_00431094:
  pcVar10->type_id = 2;
  pcVar10->health = 20.0;
  console_printf(&console_log_queue,s_Unhandled_creatureType__00477758);
LAB_004310b8:
  if ((((demo_mode_active == '\0') && (0.0 < pcVar10->pos_x)) &&
      (pcVar10->pos_x < (float)terrain_texture_width)) &&
     ((0.0 < pcVar10->pos_y && (pcVar10->pos_y < (float)terrain_texture_height)))) {
    effect_spawn_burst(&pcVar10->pos_x,8);
  }
  pcVar10->max_health = pcVar10->health;
  uVar9 = pcVar10->flags;
  if ((((uVar9 & 0x10) == 0) && (pcVar10->type_id == 3)) && ((uVar9 & 0x80) == 0)) {
    pcVar10->flags = uVar9 | 0x80;
    pcVar10->link_index = 0;
    pcVar10->move_speed = pcVar10->move_speed * 1.2;
  }
  if ((template_id == 0x38) && (config_blob.hardcore != '\0')) {
    pcVar10->move_speed = pcVar10->move_speed * 0.7;
  }
  pcVar10->heading = heading;
  if ((config_blob.hardcore == '\0') &&
     (((pcVar10->flags & 4) == 0 ||
      ((&creature_spawn_slot_interval)[pcVar10->link_index * 6] =
            (float)(&creature_spawn_slot_interval)[pcVar10->link_index * 6] + 0.2,
      config_blob.hardcore == '\0')))) {
    if (0 < DAT_00487194) {
      switch(DAT_00487194) {
      case 1:
        pcVar10->reward_value = pcVar10->reward_value * 0.9;
        pcVar10->move_speed = pcVar10->move_speed * 0.95;
        pcVar10->contact_damage = pcVar10->contact_damage * 0.95;
        fVar4 = pcVar10->health * 0.95;
        break;
      case 2:
        pcVar10->reward_value = pcVar10->reward_value * 0.85;
        pcVar10->move_speed = pcVar10->move_speed * 0.9;
        pcVar10->contact_damage = pcVar10->contact_damage * 0.9;
        fVar4 = pcVar10->health * 0.9;
        break;
      case 3:
        pcVar10->reward_value = pcVar10->reward_value * 0.85;
        pcVar10->move_speed = pcVar10->move_speed * 0.8;
        pcVar10->contact_damage = pcVar10->contact_damage * 0.8;
        fVar4 = pcVar10->health * 0.8;
        break;
      case 4:
        pcVar10->reward_value = pcVar10->reward_value * 0.8;
        pcVar10->move_speed = pcVar10->move_speed * 0.7;
        pcVar10->contact_damage = pcVar10->contact_damage * 0.7;
        fVar4 = pcVar10->health * 0.7;
        break;
      default:
        pcVar10->reward_value = pcVar10->reward_value * 0.8;
        pcVar10->move_speed = pcVar10->move_speed * 0.6;
        pcVar10->contact_damage = pcVar10->contact_damage * 0.5;
        fVar4 = pcVar10->health * 0.5;
      }
      pcVar10->health = fVar4;
      if ((pcVar10->flags & 4) != 0) {
        fVar4 = (float)DAT_00487194 * 0.35;
        if (3.0 < fVar4) {
          fVar4 = 3.0;
        }
        (&creature_spawn_slot_interval)[pcVar10->link_index * 6] =
             fVar4 + (float)(&creature_spawn_slot_interval)[pcVar10->link_index * 6];
      }
    }
  }
  else {
    DAT_00487194 = 0;
    pcVar10->move_speed = pcVar10->move_speed * 1.05;
    pcVar10->contact_damage = pcVar10->contact_damage * 1.4;
    pcVar10->health = pcVar10->health * 1.2;
    if ((pcVar10->flags & 4) != 0) {
      iVar6 = pcVar10->link_index;
      fVar4 = (float)(&creature_spawn_slot_interval)[iVar6 * 6];
      (&creature_spawn_slot_interval)[iVar6 * 6] = fVar4 - 0.2;
      if (fVar4 - 0.2 < 0.1) {
        (&creature_spawn_slot_interval)[iVar6 * 6] = 0x3dcccccd;
        return pcVar10;
      }
    }
  }
  return pcVar10;
}



/* quest_spawn_table_empty @ 00434220 */

/* returns 1 when the quest spawn table has no pending entries */

int quest_spawn_table_empty(void)

{
  uint uVar1;
  int *piVar2;
  
  uVar1 = quest_spawn_count - 1;
  if (-1 < (int)uVar1) {
    piVar2 = &(&quest_spawn_table)[uVar1].count;
    do {
      if (0 < *piVar2) {
        return uVar1 & 0xffffff00;
      }
      uVar1 = uVar1 - 1;
      piVar2 = piVar2 + -6;
    } while (-1 < (int)uVar1);
  }
  return CONCAT31((int3)(uVar1 >> 8),1);
}



/* quest_spawn_timeline_update @ 00434250 */

/* updates quest spawn entries based on the quest timer */

void quest_spawn_timeline_update(void)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  quest_spawn_entry_t *pqVar4;
  int iVar5;
  int local_1c;
  float local_18;
  float local_14;
  float local_8;
  float local_4;
  
  if (creatures_any_active_flag == '\0') {
    DAT_004c3654 = 0;
  }
  else {
    DAT_004c3654 = DAT_004c3654 + frame_dt_ms;
  }
  iVar3 = 0;
  if (0 < quest_spawn_count) {
    piVar1 = &quest_spawn_table.trigger_time_ms;
    do {
      if ((0 < piVar1[1]) &&
         ((*piVar1 < quest_spawn_timeline ||
          (((creatures_any_active_flag != '\0' && (3000 < DAT_004c3654)) &&
           (0x6a4 < quest_spawn_timeline)))))) {
        pqVar4 = &quest_spawn_table + iVar3;
        iVar5 = quest_spawn_count;
        while( true ) {
          uVar2 = 0;
          local_18 = 0.0;
          local_14 = 0.0;
          if (0 < pqVar4->count) {
            local_1c = 0;
            do {
              if ((pqVar4->pos_x < 0.0) || ((float)terrain_texture_width < pqVar4->pos_x)) {
                local_14 = (float)local_1c;
                if ((uVar2 & 1) != 0) {
                  local_14 = -local_14;
                }
              }
              else {
                local_18 = (float)local_1c;
                if ((uVar2 & 1) != 0) {
                  local_18 = -local_18;
                }
              }
              local_8 = local_18 + pqVar4->pos_x;
              local_4 = local_14 + pqVar4->pos_y;
              creature_spawn_template(pqVar4->template_id,&local_8,pqVar4->heading);
              uVar2 = uVar2 + 1;
              local_1c = local_1c + 0x28;
              iVar5 = quest_spawn_count;
            } while ((int)uVar2 < pqVar4->count);
          }
          pqVar4->count = 0;
          creatures_any_active_flag = '\0';
          if (iVar5 + -1 <= iVar3) break;
          if (pqVar4->trigger_time_ms != pqVar4[1].trigger_time_ms) {
            creatures_any_active_flag = 0;
            return;
          }
          iVar3 = iVar3 + 1;
          pqVar4 = pqVar4 + 1;
        }
        creatures_any_active_flag = 0;
        return;
      }
      iVar3 = iVar3 + 1;
      piVar1 = piVar1 + 6;
    } while (iVar3 < quest_spawn_count);
  }
  return;
}



/* quest_database_advance_slot @ 004343c0 */

/* advances quest database tier/index (wraps every 10) */

void __cdecl quest_database_advance_slot(int *tier,int *index)

{
  int iVar1;
  
  iVar1 = *index;
  *index = iVar1 + 1;
  if (9 < iVar1 + 1) {
    *tier = *tier + 1;
    *index = 0;
  }
  return;
}



/* quest_build_fallback @ 004343e0 */

/* fills a default quest spawn table when no quest builder is present */

void __cdecl quest_build_fallback(quest_spawn_entry_t *entries,int *count)

{
  float fVar1;
  
  console_printf(&console_log_queue,s___Generating_a_fallback_quest__00477782 + 2);
  fVar1 = (float)terrain_texture_height;
  entries->pos_x = -50.0;
  entries->pos_y = fVar1 * 0.5;
  entries->template_id = 0x40;
  entries->trigger_time_ms = 500;
  entries->count = 10;
  fVar1 = (float)terrain_texture_height;
  entries[1].pos_x = -50.0;
  entries[1].pos_y = fVar1 * 0.5;
  entries[1].template_id = 0x40;
  entries[1].trigger_time_ms = 5000;
  entries[1].count = 0x14;
  *count = 2;
  return;
}



/* quest_build_nagolipoli @ 00434480 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 5 Quest 9 (Nagolipoli) */

void quest_build_nagolipoli(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  float fVar2;
  int iVar3;
  float *pfVar4;
  quest_spawn_entry_t *pqVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  float10 fVar10;
  float10 fVar11;
  int iStack_20;
  
  pqVar1 = entries;
  iStack_20 = 0;
  pfVar4 = &entries->pos_y;
  do {
    iVar3 = iStack_20;
    iVar7 = iStack_20 + 1;
    fVar10 = (float10)iStack_20 * (float10)0.7853982;
    fVar11 = (float10)fcos(fVar10);
    ((quest_spawn_entry_t *)(pfVar4 + -1))->pos_x = (float)(fVar11 * (float10)128.0);
    fVar11 = (float10)fsin(fVar10);
    *pfVar4 = (float)(fVar11 * (float10)128.0);
    ((quest_spawn_entry_t *)(pfVar4 + -1))->pos_x =
         ((quest_spawn_entry_t *)(pfVar4 + -1))->pos_x + 512.0;
    *pfVar4 = *pfVar4 + 512.0;
    pfVar4[2] = 8.96831e-44;
    pfVar4[1] = (float)fVar10;
    pfVar4[3] = 2.8026e-42;
    pfVar4[4] = 1.4013e-45;
    pfVar4 = pfVar4 + 6;
    iStack_20 = iVar7;
  } while (iVar7 < 8);
  iStack_20 = 0;
  pfVar4 = &entries[iVar7].pos_y;
  do {
    fVar10 = (float10)iStack_20;
    iStack_20 = iStack_20 + 1;
    fVar10 = fVar10 * (float10)0.5235988;
    fVar11 = (float10)fcos(fVar10);
    ((quest_spawn_entry_t *)(pfVar4 + -1))->pos_x = (float)(fVar11 * (float10)178.0);
    fVar11 = (float10)fsin(fVar10);
    *pfVar4 = (float)(fVar11 * (float10)178.0);
    ((quest_spawn_entry_t *)(pfVar4 + -1))->pos_x =
         ((quest_spawn_entry_t *)(pfVar4 + -1))->pos_x + 512.0;
    *pfVar4 = *pfVar4 + 512.0;
    pfVar4[2] = 8.96831e-44;
    pfVar4[1] = (float)fVar10;
    pfVar4[3] = 1.12104e-41;
    pfVar4[4] = 1.4013e-45;
    pfVar4 = pfVar4 + 6;
  } while (iStack_20 < 0xc);
  pqVar5 = entries + iVar3 + 0xd;
  iVar9 = 13000;
  iVar7 = 0;
  iVar3 = iVar3 + 0xd;
  do {
    iVar8 = iVar3;
    iVar6 = iVar7;
    pqVar5->pos_x = -64.0;
    pqVar5->pos_y = -64.0;
    pqVar5->template_id = 0x1c;
    pqVar5->heading = 1.0471976;
    iVar3 = ((int)(iVar6 + (iVar6 >> 0x1f & 7U)) >> 3) + 1;
    pqVar5->trigger_time_ms = iVar9;
    pqVar5->count = iVar3;
    pqVar5[1].pos_x = 1088.0;
    pqVar5[1].pos_y = -64.0;
    pqVar5[1].template_id = 0x1c;
    pqVar5[1].heading = -1.0471976;
    pqVar5[1].trigger_time_ms = iVar9;
    pqVar5[1].count = iVar3;
    pqVar5[2].pos_x = -64.0;
    pqVar5[2].pos_y = 1088.0;
    pqVar5[2].template_id = 0x1c;
    pqVar5[2].heading = -1.0471976;
    pqVar5[2].trigger_time_ms = iVar9;
    pqVar5[2].count = iVar3;
    pqVar5[3].pos_x = 1088.0;
    pqVar5[3].pos_y = 1088.0;
    pqVar5[3].template_id = 0x1c;
    pqVar5[3].heading = 3.926991;
    pqVar5[3].trigger_time_ms = iVar9;
    pqVar5[3].count = iVar3;
    pqVar5 = pqVar5 + 4;
    iVar9 = iVar9 + 800;
    iVar7 = iVar6 + 1;
    iVar3 = iVar8 + 4;
  } while (iVar9 < 0x96c8);
  iStack_20 = 0;
  iVar3 = (iVar6 + 0x97 + iVar7 * 4) * 0xa0;
  pfVar4 = &entries[iVar8 + 4].heading;
  do {
    ((quest_spawn_entry_t *)(pfVar4 + -2))->pos_x = 64.0;
    pfVar4[-1] = (float)iStack_20 * 85.333336 + 256.0;
    pfVar4[1] = 1.4013e-44;
    *pfVar4 = 0.0;
    pfVar4[2] = (float)iVar3;
    pfVar4[3] = 1.4013e-45;
    iStack_20 = iStack_20 + 1;
    iVar3 = iVar3 + 100;
    pfVar4 = pfVar4 + 6;
  } while (iStack_20 < 6);
  iStack_20 = 0;
  pfVar4 = &entries[iVar8 + 10].heading;
  entries = (quest_spawn_entry_t *)(iVar7 * 800 + 25000);
  do {
    fVar2 = (float)iStack_20;
    ((quest_spawn_entry_t *)(pfVar4 + -2))->pos_x = 960.0;
    iStack_20 = iStack_20 + 1;
    pfVar4[-1] = fVar2 * 85.333336 + 256.0;
    pfVar4[1] = 1.4013e-44;
    *pfVar4 = 0.0;
    pfVar4[2] = (float)entries;
    pfVar4[3] = 1.4013e-45;
    entries = (quest_spawn_entry_t *)&entries[4].pos_y;
    pfVar4 = pfVar4 + 6;
  } while (iStack_20 < 6);
  pqVar5 = pqVar1 + iVar8 + 0x10;
  pqVar5->pos_x = 512.0;
  pqVar5->pos_y = 256.0;
  pqVar5->template_id = 0xb;
  pqVar5->heading = 3.1415927;
  iVar3 = (iVar6 + 0xb0 + iVar7 * 4) * 0xa0;
  pqVar5->trigger_time_ms = iVar3;
  pqVar5->count = 1;
  pqVar5 = pqVar1 + iVar8 + 0x11;
  pqVar5->pos_x = 512.0;
  pqVar5->pos_y = 768.0;
  pqVar5->template_id = 0xb;
  pqVar5->heading = 3.1415927;
  pqVar5->trigger_time_ms = iVar3;
  pqVar5->count = 1;
  pqVar5 = pqVar1 + iVar8 + 0x12;
  pqVar5->pos_x = 512.0;
  pqVar5->pos_y = 1088.0;
  pqVar5->template_id = 0x1c;
  iVar3 = iVar7 * 800 + 0x6f54;
  pqVar5->heading = 3.926991;
  pqVar5->trigger_time_ms = iVar3;
  pqVar5->count = 8;
  pqVar1 = pqVar1 + iVar8 + 0x13;
  pqVar1->pos_x = 512.0;
  pqVar1->pos_y = -64.0;
  pqVar1->template_id = 0x1c;
  pqVar1->heading = 3.926991;
  pqVar1->trigger_time_ms = iVar3;
  pqVar1->count = 8;
  *count = iVar8 + 0x14;
  return;
}



/* quest_build_monster_blues @ 00434860 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 5 Quest 8 (Monster Blues) */

void quest_build_monster_blues(quest_spawn_entry_t *entries,int *count)

{
  float fVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  uint uVar5;
  int iVar6;
  
  fVar1 = (float)terrain_texture_height;
  entries->pos_x = -50.0;
  entries->pos_y = fVar1 * 0.5;
  entries->template_id = 4;
  entries->trigger_time_ms = 500;
  entries->count = 10;
  fVar1 = (float)terrain_texture_height;
  entries[1].pos_x = 1074.0;
  entries[1].pos_y = fVar1 * 0.5;
  entries[1].template_id = 6;
  entries[1].trigger_time_ms = 0x1d4c;
  entries[1].count = 10;
  entries[2].pos_x = 512.0;
  entries[2].pos_y = 1088.0;
  entries[2].template_id = 3;
  entries[2].trigger_time_ms = 0x445c;
  entries[2].count = 0xc;
  entries[3].pos_x = 512.0;
  entries[3].pos_y = -64.0;
  entries[3].template_id = 3;
  entries[3].trigger_time_ms = 0x445c;
  entries[3].count = 0xc;
  uVar5 = 0;
  iVar6 = 0x6b6c;
  piVar4 = &entries[4].template_id;
  do {
    ((quest_spawn_entry_t *)(piVar4 + -3))->pos_x = -64.0;
    uVar2 = uVar5 & 0x80000003;
    piVar4[-2] = 0x44000000;
    if ((int)uVar2 < 0) {
      uVar2 = (uVar2 - 1 | 0xfffffffc) + 1;
    }
    if (uVar2 == 0) {
      *piVar4 = 6;
    }
    else {
      *piVar4 = (-(uint)(uVar2 != 1) & 2) + 3;
    }
    piVar4[1] = iVar6;
    iVar6 = iVar6 + 900;
    iVar3 = uVar5 + ((int)uVar5 >> 0x1f & 7U);
    uVar5 = uVar5 + 1;
    piVar4[2] = (iVar3 >> 3) + 2;
    piVar4 = piVar4 + 6;
  } while ((int)uVar5 < 0x40);
  *count = 0x44;
  return;
}



/* quest_build_the_gathering @ 004349c0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 5 Quest 10 (The Gathering) */

void quest_build_the_gathering(quest_spawn_entry_t *entries,int *count)

{
  entries->pos_x = 256.0;
  entries->pos_y = 512.0;
  entries->template_id = 1;
  entries->trigger_time_ms = 500;
  entries->count = 1;
  entries[1].pos_x = 768.0;
  entries[1].pos_y = 512.0;
  entries[1].template_id = 1;
  entries[1].trigger_time_ms = 0x251c;
  entries[1].count = 2;
  entries[2].pos_x = 256.0;
  entries[2].pos_y = 512.0;
  entries[2].template_id = 0x3a;
  entries[2].trigger_time_ms = 0x3c8c;
  entries[2].count = 2;
  entries[3].pos_x = 768.0;
  entries[3].pos_y = 512.0;
  entries[3].template_id = 0x3a;
  entries[3].trigger_time_ms = 0x5fb4;
  entries[3].count = 2;
  entries[4].pos_x = 256.0;
  entries[4].pos_y = 512.0;
  entries[4].template_id = 0;
  entries[4].trigger_time_ms = 0x7724;
  entries[4].count = 2;
  entries[5].pos_x = 768.0;
  entries[5].pos_y = 512.0;
  entries[5].template_id = 0;
  entries[5].trigger_time_ms = 0x9a4c;
  entries[5].count = 2;
  entries[6].pos_x = 64.0;
  entries[6].pos_y = 64.0;
  entries[6].template_id = 0x3c;
  entries[6].trigger_time_ms = 0xd4e4;
  entries[6].count = 2;
  entries[7].pos_x = 960.0;
  entries[7].pos_y = 64.0;
  entries[7].template_id = 0x3c;
  entries[7].trigger_time_ms = 0xd4e4;
  entries[7].count = 1;
  entries[8].pos_x = 64.0;
  entries[8].pos_y = 960.0;
  entries[8].template_id = 0x3c;
  entries[8].trigger_time_ms = 0xd4e4;
  entries[8].count = 2;
  entries[9].pos_x = 960.0;
  entries[9].pos_y = 960.0;
  entries[9].template_id = 0x3c;
  entries[9].trigger_time_ms = 0xd4e4;
  entries[9].count = 1;
  entries[10].pos_x = -128.0;
  entries[10].pos_y = 512.0;
  entries[10].template_id = 0x3a;
  entries[10].trigger_time_ms = 0x16184;
  entries[10].count = 6;
  entries[0xb].pos_x = 1152.0;
  entries[0xb].pos_y = 512.0;
  entries[0xb].template_id = 1;
  entries[0xb].trigger_time_ms = 0x184ac;
  entries[0xb].count = 4;
  entries[0xc].pos_x = 1152.0;
  entries[0xc].pos_y = 512.0;
  entries[0xc].template_id = 1;
  entries[0xc].trigger_time_ms = 0x1abbc;
  entries[0xc].count = 2;
  *count = 0xd;
  return;
}



/* quest_build_army_of_three @ 00434ca0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 5 Quest 7 (Army of Three) */

void quest_build_army_of_three(quest_spawn_entry_t *entries,int *count)

{
  entries->pos_x = -64.0;
  entries->pos_y = 256.0;
  entries->template_id = 0x15;
  entries->trigger_time_ms = 500;
  entries->count = 1;
  entries[1].pos_x = -64.0;
  entries[1].pos_y = 512.0;
  entries[1].template_id = 0x15;
  entries[1].trigger_time_ms = 0x157c;
  entries[1].count = 1;
  entries[2].pos_x = -64.0;
  entries[2].pos_y = 768.0;
  entries[2].template_id = 0x15;
  entries[2].trigger_time_ms = 15000;
  entries[2].count = 1;
  entries[3].pos_x = -64.0;
  entries[3].pos_y = 768.0;
  entries[3].template_id = 0x17;
  entries[3].trigger_time_ms = 0x4c2c;
  entries[3].count = 1;
  entries[4].pos_x = -64.0;
  entries[4].pos_y = 512.0;
  entries[4].template_id = 0x17;
  entries[4].trigger_time_ms = 0x57e4;
  entries[4].count = 1;
  entries[5].pos_x = -64.0;
  entries[5].pos_y = 256.0;
  entries[5].template_id = 0x17;
  entries[5].trigger_time_ms = 0x6784;
  entries[5].count = 1;
  entries[6].pos_x = -64.0;
  entries[6].pos_y = 256.0;
  entries[6].template_id = 0x16;
  entries[6].trigger_time_ms = 0x8aac;
  entries[6].count = 1;
  entries[7].pos_x = -64.0;
  entries[7].pos_y = 512.0;
  entries[7].template_id = 0x16;
  entries[7].trigger_time_ms = 0x9a4c;
  entries[7].count = 1;
  entries[8].pos_x = -64.0;
  entries[8].pos_y = 768.0;
  entries[8].template_id = 0x16;
  entries[8].trigger_time_ms = 0xa604;
  entries[8].count = 1;
  entries[9].pos_x = 512.0;
  entries[9].pos_y = 1152.0;
  entries[9].template_id = 0x15;
  entries[9].trigger_time_ms = 0xcd14;
  entries[9].count = 3;
  entries[10].pos_x = 512.0;
  entries[10].pos_y = -256.0;
  entries[10].template_id = 0x17;
  entries[10].trigger_time_ms = 0xdcb4;
  entries[10].count = 3;
  *count = 0xb;
  return;
}



/* quest_build_knee_deep_in_the_dead @ 00434f00 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 5 Quest 5 (Knee-deep in the Dead) */

void quest_build_knee_deep_in_the_dead(quest_spawn_entry_t *entries,int *count)

{
  float fVar1;
  quest_spawn_entry_t *pqVar2;
  quest_spawn_entry_t *pqVar3;
  quest_spawn_entry_t *pqVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  bool bVar10;
  
  fVar1 = (float)terrain_texture_height;
  entries->pos_x = -50.0;
  entries->pos_y = fVar1 * 0.5;
  entries->template_id = 0x43;
  entries->trigger_time_ms = 100;
  entries->count = 1;
  uVar7 = 0;
  iVar8 = 1;
  pqVar4 = entries + 1;
  iVar5 = 500;
  do {
    uVar6 = uVar7 & 0x80000007;
    bVar10 = uVar6 == 0;
    if ((int)uVar6 < 0) {
      bVar10 = (uVar6 - 1 | 0xfffffff8) == 0xffffffff;
    }
    pqVar2 = pqVar4;
    iVar9 = iVar8;
    if (bVar10) {
      fVar1 = (float)terrain_texture_height;
      pqVar4->pos_x = -50.0;
      iVar9 = iVar8 + 1;
      pqVar2 = pqVar4 + 1;
      pqVar4->pos_y = fVar1 * 0.5;
      pqVar4->template_id = 0x43;
      pqVar4->trigger_time_ms = iVar5 + -2;
      pqVar4->count = 1;
    }
    fVar1 = (float)terrain_texture_height;
    pqVar2->pos_x = -50.0;
    pqVar2->pos_y = fVar1 * 0.5;
    pqVar2->template_id = 0x41;
    pqVar2->trigger_time_ms = iVar5;
    pqVar2->count = (0x20 < (int)uVar7) + 1;
    iVar8 = iVar9 + 1;
    pqVar4 = pqVar2 + 1;
    if (0x30d4 < iVar5) {
      fVar1 = (float)terrain_texture_height;
      pqVar4->pos_x = -50.0;
      iVar8 = iVar9 + 2;
      pqVar4 = pqVar2 + 2;
      pqVar2[1].pos_y = fVar1 * 0.5 + 158.0;
      pqVar2[1].template_id = 0x41;
      pqVar2[1].trigger_time_ms = iVar5 + 500;
      pqVar2[1].count = 1;
    }
    pqVar2 = pqVar4;
    if (0x5fb4 < iVar5) {
      fVar1 = (float)terrain_texture_height;
      pqVar4->pos_x = -50.0;
      iVar8 = iVar8 + 1;
      pqVar2 = pqVar4 + 1;
      pqVar4->pos_y = fVar1 * 0.5 - 158.0;
      pqVar4->template_id = 0x41;
      pqVar4->trigger_time_ms = iVar5 + 1000;
      pqVar4->count = 1;
    }
    pqVar3 = pqVar2;
    if (0x8e94 < iVar5) {
      fVar1 = (float)terrain_texture_height;
      pqVar2->pos_x = -50.0;
      iVar8 = iVar8 + 1;
      pqVar3 = pqVar2 + 1;
      pqVar2->pos_y = fVar1 * 0.5 - 258.0;
      pqVar2->template_id = 0x42;
      pqVar2->trigger_time_ms = iVar5 + 0x514;
      pqVar2->count = 1;
    }
    pqVar4 = pqVar3;
    if (0xbd74 < iVar5) {
      fVar1 = (float)terrain_texture_height;
      pqVar3->pos_x = -50.0;
      iVar8 = iVar8 + 1;
      pqVar4 = pqVar3 + 1;
      pqVar3->pos_y = fVar1 * 0.5 + 258.0;
      pqVar3->template_id = 0x42;
      pqVar3->trigger_time_ms = iVar5 + 300;
      pqVar3->count = 1;
    }
    iVar5 = iVar5 + 0x5dc;
    uVar7 = uVar7 + 1;
  } while (iVar5 < 0x178f4);
  *count = iVar8;
  return;
}



/* quest_build_the_gang_wars @ 00435120 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 5 Quest 4 (The Gang Wars) */

void quest_build_the_gang_wars(quest_spawn_entry_t *entries,int *count)

{
  float fVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  
  fVar1 = (float)terrain_texture_height;
  entries->pos_x = -150.0;
  entries->pos_y = fVar1 * 0.5;
  entries->template_id = 0x12;
  entries->trigger_time_ms = 100;
  entries->count = 1;
  fVar1 = (float)terrain_texture_height;
  entries[1].pos_x = 1174.0;
  iVar4 = 10;
  entries[1].pos_y = fVar1 * 0.5;
  entries[1].template_id = 0x12;
  entries[1].trigger_time_ms = 0x9c4;
  entries[1].count = 1;
  iVar3 = 0x157c;
  piVar2 = &entries[2].trigger_time_ms;
  do {
    fVar1 = (float)terrain_texture_height;
    ((quest_spawn_entry_t *)(piVar2 + -4))->pos_x = 1174.0;
    piVar2[-3] = (int)(fVar1 * 0.5);
    piVar2[-1] = 0x12;
    *piVar2 = iVar3;
    piVar2[1] = 2;
    iVar3 = iVar3 + 4000;
    iVar4 = iVar4 + -1;
    piVar2 = piVar2 + 6;
  } while (iVar4 != 0);
  entries[0xc].pos_x = 512.0;
  entries[0xc].pos_y = 1152.0;
  entries[0xc].template_id = 0x13;
  entries[0xc].trigger_time_ms = 0xc544;
  entries[0xc].count = 1;
  iVar3 = 0xe86c;
  piVar2 = &entries[0xd].trigger_time_ms;
  do {
    fVar1 = (float)terrain_texture_height;
    ((quest_spawn_entry_t *)(piVar2 + -4))->pos_x = -150.0;
    piVar2[-3] = (int)(fVar1 * 0.5);
    piVar2[-1] = 0x12;
    *piVar2 = iVar3;
    piVar2[1] = 2;
    iVar3 = iVar3 + 4000;
    piVar2 = piVar2 + 6;
  } while (iVar3 < 0x184ac);
  entries[0x17].pos_x = 512.0;
  entries[0x17].pos_y = 1152.0;
  entries[0x17].template_id = 0x13;
  entries[0x17].trigger_time_ms = 0x1a3ec;
  entries[0x17].count = 3;
  *count = 0x18;
  return;
}



/* quest_build_the_fortress @ 004352d0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 5 Quest 3 (The Fortress) */

void quest_build_the_fortress(quest_spawn_entry_t *entries,int *count)

{
  float fVar1;
  quest_spawn_entry_t *pqVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  pqVar2 = entries;
  fVar1 = (float)terrain_texture_height;
  entries->pos_x = -50.0;
  entries = (quest_spawn_entry_t *)0x200;
  pqVar2->pos_y = fVar1 * 0.5;
  pqVar2->template_id = 0x40;
  pqVar2->trigger_time_ms = 100;
  pqVar2->count = 6;
  iVar4 = 0x44c;
  iVar6 = 8;
  piVar3 = &pqVar2[1].trigger_time_ms;
  do {
    ((quest_spawn_entry_t *)(piVar3 + -4))->pos_x = 768.0;
    piVar3[-3] = (int)((float)(int)entries * 0.125 + 256.0);
    piVar3[-1] = 9;
    *piVar3 = iVar4;
    piVar3[1] = 1;
    iVar4 = iVar4 + 600;
    entries = (quest_spawn_entry_t *)&entries[0x15].heading;
    piVar3 = piVar3 + 6;
  } while (iVar4 < 0x14b4);
  pqVar2[8].pos_x = 128.0;
  pqVar2[8].pos_y = 512.0;
  pqVar2[8].template_id = 0xe;
  pqVar2[8].trigger_time_ms = 0x1964;
  pqVar2[8].count = 1;
  entries = (quest_spawn_entry_t *)0x180;
  do {
    iVar5 = 1;
    iVar4 = iVar6 * 600 + 0x157c;
    piVar3 = &pqVar2[iVar6].trigger_time_ms;
    do {
      if ((iVar5 != 1) ||
         ((entries != (quest_spawn_entry_t *)0x480 && (entries != (quest_spawn_entry_t *)0x600)))) {
        iVar6 = iVar6 + 1;
        ((quest_spawn_entry_t *)(piVar3 + -4))->pos_x = (float)(int)entries * 0.16666667 + 256.0;
        piVar3[-3] = (int)(512.0 - (float)(iVar5 * 0x180) * 0.16666667);
        piVar3[-1] = 10;
        *piVar3 = iVar4;
        piVar3[1] = 1;
        iVar4 = iVar4 + 600;
        piVar3 = piVar3 + 6;
      }
      iVar5 = iVar5 + 1;
    } while (iVar5 < 7);
    entries = entries + 0x10;
  } while ((int)entries < 0x901);
  *count = iVar6;
  return;
}



/* quest_build_cross_fire @ 00435480 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 5 Quest 6 (Cross Fire) */

void quest_build_cross_fire(quest_spawn_entry_t *entries,int *count)

{
  float fVar1;
  
  fVar1 = (float)terrain_texture_height;
  entries->pos_x = 1074.0;
  entries->pos_y = fVar1 * 0.5;
  entries->template_id = 0x40;
  entries->trigger_time_ms = 100;
  entries->count = 6;
  entries[1].pos_x = -40.0;
  entries[1].pos_y = 512.0;
  entries[1].template_id = 0x3c;
  entries[1].trigger_time_ms = 0x157c;
  entries[1].count = 4;
  entries[2].pos_x = -40.0;
  entries[2].pos_y = 512.0;
  entries[2].template_id = 0x3c;
  entries[2].trigger_time_ms = 0x3c8c;
  entries[2].count = 6;
  entries[3].pos_x = 512.0;
  entries[3].pos_y = 512.0;
  entries[3].template_id = 1;
  entries[3].trigger_time_ms = 0x4844;
  entries[3].count = 2;
  entries[4].pos_x = -100.0;
  entries[4].pos_y = 512.0;
  entries[4].template_id = 0x3c;
  entries[4].trigger_time_ms = 0x639c;
  entries[4].count = 8;
  entries[5].pos_x = 512.0;
  entries[5].pos_y = 1152.0;
  entries[5].template_id = 0x40;
  entries[5].trigger_time_ms = 26000;
  entries[5].count = 6;
  entries[6].pos_x = 512.0;
  entries[6].pos_y = -128.0;
  entries[6].template_id = 0x40;
  entries[6].trigger_time_ms = 26000;
  entries[6].count = 6;
  *count = 7;
  return;
}



/* quest_build_the_beating @ 00435610 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 5 Quest 1 (The Beating) */

void quest_build_the_beating(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  quest_spawn_entry_t *pqVar6;
  int iVar7;
  int iVar8;
  
  pqVar1 = entries;
  entries->pos_x = 256.0;
  entries->pos_y = 256.0;
  entries->template_id = 0x27;
  entries->trigger_time_ms = 500;
  entries->count = 1;
  iVar5 = 10000;
  iVar2 = terrain_texture_height / 2;
  entries[1].pos_x = (float)(terrain_texture_width + 0x20);
  iVar8 = 0x40;
  iVar7 = 8;
  entries[1].pos_y = (float)iVar2;
  entries[1].template_id = 0x29;
  entries[1].trigger_time_ms = 8000;
  entries[1].count = 3;
  piVar4 = &entries[2].trigger_time_ms;
  do {
    iVar2 = iVar8 + terrain_texture_width;
    iVar8 = iVar8 + 0x20;
    iVar3 = terrain_texture_height / 2;
    ((quest_spawn_entry_t *)(piVar4 + -4))->pos_x = (float)iVar2;
    piVar4[-3] = (int)(float)iVar3;
    piVar4[-1] = 0x25;
    *piVar4 = iVar5;
    piVar4[1] = 8;
    iVar5 = iVar5 + 100;
    iVar7 = iVar7 + -1;
    piVar4 = piVar4 + 6;
  } while (iVar7 != 0);
  iVar2 = terrain_texture_height / 2;
  entries[10].pos_x = -32.0;
  iVar5 = 20000;
  pqVar6 = entries + 0xb;
  entries = (quest_spawn_entry_t *)0xffffffc0;
  pqVar1[10].pos_y = (float)iVar2;
  pqVar1[10].template_id = 0x29;
  pqVar1[10].trigger_time_ms = 18000;
  pqVar1[10].count = 3;
  piVar4 = &pqVar6->trigger_time_ms;
  do {
    pqVar6 = entries + -2;
    iVar2 = terrain_texture_height / 2;
    ((quest_spawn_entry_t *)(piVar4 + -4))->pos_x = (float)(int)entries;
    piVar4[-3] = (int)(float)iVar2;
    piVar4[-1] = 0x25;
    *piVar4 = iVar5;
    piVar4[1] = 8;
    iVar5 = iVar5 + 100;
    piVar4 = piVar4 + 6;
    entries = (quest_spawn_entry_t *)&pqVar6->trigger_time_ms;
  } while (-0x140 < (int)&pqVar6->trigger_time_ms);
  iVar2 = 40000;
  entries = (quest_spawn_entry_t *)0xffffffc0;
  piVar4 = &pqVar1[0x13].trigger_time_ms;
  do {
    pqVar6 = (quest_spawn_entry_t *)((int)&entries[-2].pos_y + 2);
    ((quest_spawn_entry_t *)(piVar4 + -4))->pos_x = (float)(terrain_texture_width / 2);
    piVar4[-3] = (int)(float)(int)entries;
    piVar4[-1] = 0xf;
    *piVar4 = iVar2;
    piVar4[1] = 4;
    iVar2 = iVar2 + 100;
    piVar4 = piVar4 + 6;
    entries = pqVar6;
  } while (-0x13c < (int)pqVar6);
  iVar2 = 0;
  iVar5 = 40000;
  piVar4 = &pqVar1[0x19].trigger_time_ms;
  do {
    iVar7 = iVar2 + 0x2c + terrain_texture_width;
    iVar2 = iVar2 + 0x20;
    ((quest_spawn_entry_t *)(piVar4 + -4))->pos_x = (float)(terrain_texture_width / 2);
    piVar4[-3] = (int)(float)iVar7;
    piVar4[-1] = 0x12;
    *piVar4 = iVar5;
    piVar4[1] = 2;
    iVar5 = iVar5 + 100;
    piVar4 = piVar4 + 6;
  } while (iVar5 < 0x9e98);
  *count = 0x1f;
  return;
}



/* quest_build_the_spanking_of_the_dead @ 004358a0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 5 Quest 2 (The Spanking Of The Dead) */

void quest_build_the_spanking_of_the_dead(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int *piVar2;
  int iVar3;
  quest_spawn_entry_t *pqVar4;
  float10 fVar5;
  float10 fVar6;
  float10 fVar7;
  float10 fVar8;
  
  pqVar1 = entries;
  entries->pos_x = 256.0;
  entries->pos_y = 512.0;
  entries->template_id = 0x27;
  entries->trigger_time_ms = 500;
  entries->count = 1;
  entries[1].pos_x = 768.0;
  entries[1].pos_y = 512.0;
  entries[1].template_id = 0x27;
  entries[1].trigger_time_ms = 500;
  entries[1].count = 1;
  entries = (quest_spawn_entry_t *)0x0;
  iVar3 = 5000;
  piVar2 = &pqVar1[2].template_id;
  do {
    pqVar4 = (quest_spawn_entry_t *)((int)&entries->pos_x + 1);
    fVar5 = (float10)(int)entries * (float10)0.33333334;
    fVar6 = (float10)512.0 - (float10)(int)entries * (float10)3.8;
    fVar7 = (float10)fcos(fVar5);
    fVar8 = (float10)fsin(fVar5);
    ((quest_spawn_entry_t *)(piVar2 + -3))->pos_x = (float)(fVar7 * fVar6 + (float10)512.0);
    piVar2[-2] = (int)(float)(fVar8 * fVar6 + (float10)512.0);
    piVar2[-1] = (int)(float)fVar5;
    *piVar2 = 0x41;
    piVar2[1] = iVar3;
    piVar2[2] = 1;
    iVar3 = iVar3 + 300;
    piVar2 = piVar2 + 6;
    entries = pqVar4;
  } while (iVar3 < 0xa988);
  pqVar1[0x82].pos_x = 1280.0;
  pqVar1[0x82].pos_y = 512.0;
  iVar3 = (int)pqVar4 * 300;
  pqVar1[0x82].template_id = 0x42;
  pqVar1[0x82].trigger_time_ms = iVar3 + 10000;
  pqVar1[0x82].count = 0x10;
  pqVar1[0x83].pos_x = -256.0;
  pqVar1[0x83].pos_y = 512.0;
  pqVar1[0x83].template_id = 0x42;
  pqVar1[0x83].trigger_time_ms = iVar3 + 20000;
  pqVar1[0x83].count = 0x10;
  *count = 0x84;
  return;
}



/* quest_build_hidden_evil @ 00435a30 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 3 Quest 4 (Hidden Evil) */

void quest_build_hidden_evil(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  
  iVar1 = terrain_texture_height + 0x40;
  entries->pos_x = (float)(terrain_texture_width / 2);
  entries->pos_y = (float)iVar1;
  entries->template_id = 0x21;
  entries->trigger_time_ms = 500;
  entries->count = 0x32;
  iVar1 = terrain_texture_height + 0x40;
  entries[1].pos_x = (float)(terrain_texture_width / 2);
  entries[1].pos_y = (float)iVar1;
  entries[1].template_id = 0x22;
  entries[1].trigger_time_ms = 15000;
  entries[1].count = 0x1e;
  iVar1 = terrain_texture_height + 0x40;
  entries[2].pos_x = (float)(terrain_texture_width / 2);
  entries[2].pos_y = (float)iVar1;
  entries[2].template_id = 0x23;
  entries[2].trigger_time_ms = 25000;
  entries[2].count = 0x14;
  iVar1 = terrain_texture_height + 0x40;
  entries[3].pos_x = (float)(terrain_texture_width / 2);
  entries[3].pos_y = (float)iVar1;
  entries[3].template_id = 0x23;
  entries[3].trigger_time_ms = 30000;
  entries[3].count = 0x1e;
  iVar1 = terrain_texture_height + 0x40;
  entries[4].pos_x = (float)(terrain_texture_width / 2);
  entries[4].pos_y = (float)iVar1;
  entries[4].template_id = 0x22;
  entries[4].trigger_time_ms = 35000;
  entries[4].count = 0x1e;
  *count = 5;
  return;
}



/* quest_build_land_hostile @ 00435bd0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 1 Quest 1 (Land Hostile) */

void quest_build_land_hostile(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  
  iVar1 = terrain_texture_height + 0x40;
  entries->pos_x = (float)(terrain_texture_width / 2);
  entries->pos_y = (float)iVar1;
  entries->template_id = 0x26;
  entries->trigger_time_ms = 500;
  entries->count = 1;
  entries[1].pos_x = -64.0;
  entries[1].pos_y = 1088.0;
  entries[1].template_id = 0x26;
  entries[1].trigger_time_ms = 0x9c4;
  entries[1].count = 2;
  entries[2].pos_x = -64.0;
  entries[2].pos_y = -64.0;
  entries[2].template_id = 0x26;
  entries[2].trigger_time_ms = 0x1964;
  entries[2].count = 3;
  entries[3].pos_x = 1088.0;
  entries[3].pos_y = -64.0;
  entries[3].template_id = 0x26;
  entries[3].trigger_time_ms = 0x2cec;
  entries[3].count = 4;
  *count = 4;
  return;
}



/* quest_build_minor_alien_breach @ 00435cc0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 1 Quest 2 (Minor Alien Breach) */

void quest_build_minor_alien_breach(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  quest_spawn_entry_t *pqVar2;
  quest_spawn_entry_t *pqVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  entries->pos_x = 256.0;
  entries->pos_y = 256.0;
  entries->template_id = 0x26;
  iVar6 = 2;
  entries->trigger_time_ms = 1000;
  entries->count = 2;
  entries[1].pos_x = 256.0;
  entries[1].pos_y = 128.0;
  entries[1].template_id = 0x26;
  entries[1].trigger_time_ms = 0x6a4;
  entries[1].count = 2;
  iVar4 = 2;
  pqVar3 = entries + 2;
  do {
    iVar1 = terrain_texture_height / 2;
    pqVar3->pos_x = (float)(terrain_texture_width + 0x40);
    pqVar3->pos_y = (float)iVar1;
    pqVar3->template_id = 0x26;
    iVar5 = (iVar4 * 5 + -10) * 0x2d0;
    pqVar3->trigger_time_ms = iVar5;
    pqVar3->count = 1;
    pqVar2 = pqVar3 + 1;
    iVar1 = iVar6 + 1;
    if (6 < iVar4) {
      iVar1 = terrain_texture_height / 2;
      pqVar3[1].pos_x = (float)(terrain_texture_width + 0x40);
      pqVar3[1].pos_y = (float)(iVar1 + -0x100);
      pqVar3[1].template_id = 0x26;
      pqVar3[1].trigger_time_ms = iVar5;
      pqVar3[1].count = 1;
      pqVar2 = pqVar3 + 2;
      iVar1 = iVar6 + 2;
    }
    iVar6 = iVar1;
    pqVar3 = pqVar2;
    if (iVar4 == 0xd) {
      iVar1 = terrain_texture_height + 0x40;
      iVar6 = iVar6 + 1;
      pqVar3->pos_x = (float)(terrain_texture_width / 2);
      pqVar3->pos_y = (float)iVar1;
      pqVar3->template_id = 0x29;
      pqVar3->trigger_time_ms = 0x9ab0;
      pqVar3->count = 1;
      pqVar2 = pqVar3 + 1;
LAB_00435e39:
      iVar1 = terrain_texture_height / 2;
      pqVar2->pos_x = -64.0;
      iVar6 = iVar6 + 1;
      pqVar3 = pqVar2 + 1;
      pqVar2->pos_y = (float)(iVar1 + 0x100);
      pqVar2->template_id = 0x26;
      pqVar2->trigger_time_ms = iVar5;
      pqVar2->count = 1;
    }
    else {
      pqVar2 = pqVar3;
      if (10 < iVar4) goto LAB_00435e39;
    }
    iVar4 = iVar4 + 1;
    if (0x11 < iVar4) {
      *count = iVar6;
      return;
    }
  } while( true );
}



/* quest_build_alien_squads @ 00435ea0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 1 Quest 8 (Alien Squads) */

void quest_build_alien_squads(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  int iVar3;
  
  entries->pos_x = -256.0;
  entries->pos_y = 256.0;
  entries->template_id = 0x12;
  entries->trigger_time_ms = 0x5dc;
  entries->count = 1;
  entries[1].pos_x = -256.0;
  entries[1].pos_y = 768.0;
  entries[1].template_id = 0x12;
  entries[1].trigger_time_ms = 0x9c4;
  entries[1].count = 1;
  entries[2].pos_x = 768.0;
  entries[2].pos_y = -256.0;
  entries[2].template_id = 0x12;
  entries[2].trigger_time_ms = 0x157c;
  entries[2].count = 1;
  entries[3].pos_x = 768.0;
  entries[3].pos_y = 1280.0;
  entries[3].template_id = 0x12;
  entries[3].trigger_time_ms = 0x2134;
  entries[3].count = 1;
  entries[4].pos_x = 1280.0;
  entries[4].pos_y = 1280.0;
  entries[4].template_id = 0x12;
  entries[4].trigger_time_ms = 0x38a4;
  entries[4].count = 1;
  entries[5].pos_x = 1280.0;
  entries[5].pos_y = 768.0;
  entries[5].template_id = 0x12;
  entries[5].trigger_time_ms = 0x4844;
  entries[5].count = 1;
  entries[6].pos_x = -256.0;
  entries[6].pos_y = 256.0;
  entries[6].template_id = 0x12;
  entries[6].trigger_time_ms = 25000;
  entries[6].count = 1;
  entries[7].pos_x = -256.0;
  entries[7].pos_y = 768.0;
  entries[7].template_id = 0x12;
  entries[7].trigger_time_ms = 30000;
  entries[7].count = 1;
  iVar3 = 8;
  pqVar1 = entries + 8;
  iVar2 = 0x8d68;
  do {
    pqVar1->pos_x = -64.0;
    pqVar1->pos_y = -64.0;
    pqVar1->template_id = 0x26;
    pqVar1->trigger_time_ms = iVar2 + -400;
    pqVar1->count = 1;
    iVar3 = iVar3 + 2;
    pqVar1[1].pos_x = 1088.0;
    pqVar1[1].pos_y = 1088.0;
    pqVar1[1].template_id = 0x26;
    pqVar1[1].trigger_time_ms = iVar2;
    pqVar1[1].count = 1;
    iVar2 = iVar2 + 0x708;
    pqVar1 = pqVar1 + 2;
  } while (iVar2 < 83000);
  *count = iVar3;
  return;
}



/* quest_build_zombie_masters @ 004360a0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 3 Quest 10 (Zombie Masters) */

void quest_build_zombie_masters(quest_spawn_entry_t *entries,int *count)

{
  entries->pos_x = 256.0;
  entries->pos_y = 256.0;
  entries->template_id = 0;
  entries->trigger_time_ms = 1000;
  entries->count = config_blob.reserved0._20_4_;
  entries[1].pos_x = 512.0;
  entries[1].pos_y = 256.0;
  entries[1].template_id = 0;
  entries[1].trigger_time_ms = 6000;
  entries[1].count = 1;
  entries[2].pos_x = 768.0;
  entries[2].pos_y = 256.0;
  entries[2].template_id = 0;
  entries[2].trigger_time_ms = 14000;
  entries[2].count = config_blob.reserved0._20_4_;
  entries[3].pos_x = 768.0;
  entries[3].pos_y = 768.0;
  entries[3].template_id = 0;
  entries[3].trigger_time_ms = 18000;
  entries[3].count = 1;
  *count = 4;
  return;
}



/* quest_build_8_legged_terror @ 00436120 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 1 Quest 10 (8-legged Terror) */

void quest_build_8_legged_terror(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  int iVar3;
  
  entries->pos_x = (float)(terrain_texture_width + -0x100);
  iVar3 = 1;
  pqVar1 = entries + 1;
  entries->pos_y = (float)(terrain_texture_width / 2);
  entries->template_id = 0x3a;
  entries->trigger_time_ms = 1000;
  entries->count = 1;
  iVar2 = 6000;
  do {
    pqVar1->pos_x = -25.0;
    pqVar1->pos_y = -25.0;
    pqVar1->template_id = 0x3d;
    pqVar1->trigger_time_ms = iVar2;
    pqVar1->count = config_blob.reserved0._20_4_;
    pqVar1[1].pos_x = 1049.0;
    pqVar1[1].pos_y = -25.0;
    pqVar1[1].template_id = 0x3d;
    pqVar1[1].trigger_time_ms = iVar2;
    pqVar1[1].count = 1;
    pqVar1[2].pos_x = -25.0;
    pqVar1[2].pos_y = 1049.0;
    pqVar1[2].template_id = 0x3d;
    pqVar1[2].trigger_time_ms = iVar2;
    pqVar1[2].count = config_blob.reserved0._20_4_;
    iVar3 = iVar3 + 4;
    pqVar1[3].pos_x = 1049.0;
    pqVar1[3].pos_y = 1049.0;
    pqVar1[3].template_id = 0x3d;
    pqVar1[3].trigger_time_ms = iVar2;
    pqVar1[3].count = 1;
    iVar2 = iVar2 + 0x898;
    pqVar1 = pqVar1 + 4;
  } while (iVar2 < 0x8fc0);
  *count = iVar3;
  return;
}



/* quest_build_ghost_patrols @ 00436200 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 2 Quest 9 (Ghost Patrols) */

void quest_build_ghost_patrols(quest_spawn_entry_t *entries,int *count)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  bool bVar5;
  
  iVar2 = 0x9c4;
  entries->pos_x = (float)(terrain_texture_width + 0x80);
  entries->pos_y = (float)(terrain_texture_width / 2);
  entries->template_id = 0x2b;
  entries->trigger_time_ms = 0x5dc;
  entries->count = 2;
  piVar3 = &entries[1].template_id;
  uVar1 = 0;
  do {
    uVar4 = uVar1;
    uVar1 = uVar4 & 0x80000001;
    bVar5 = uVar1 == 0;
    if ((int)uVar1 < 0) {
      bVar5 = (uVar1 - 1 | 0xfffffffe) == 0xffffffff;
    }
    if (bVar5) {
      ((quest_spawn_entry_t *)(piVar3 + -3))->pos_x = -128.0;
    }
    else {
      ((quest_spawn_entry_t *)(piVar3 + -3))->pos_x = 1152.0;
    }
    uVar1 = uVar4 + 1;
    piVar3[-2] = (int)(float)(terrain_texture_width / 2);
    *piVar3 = 0x19;
    piVar3[1] = iVar2;
    piVar3[2] = 1;
    iVar2 = iVar2 + 0x9c4;
    piVar3 = piVar3 + 6;
  } while (iVar2 < 0x7ef4);
  entries[0xd].pos_x = -264.0;
  entries[0xd].pos_y = (float)(terrain_texture_width / 2);
  entries[0xd].template_id = 0x2b;
  entries[0xd].trigger_time_ms = uVar1 * 0x9c4 + -0x9c4;
  entries[0xd].count = 1;
  entries[0xe].pos_x = -128.0;
  entries[0xe].pos_y = (float)(terrain_texture_width / 2);
  entries[0xe].template_id = 0x18;
  entries[0xe].trigger_time_ms = (uVar4 + 0x10 + uVar1 * 4) * 500;
  entries[0xe].count = 1;
  *count = 0xf;
  return;
}



/* quest_build_the_random_factor @ 00436350 */

/* quest builder for Tier 1 Quest 6 (The Random Factor) */

void __cdecl quest_build_the_random_factor(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar5 = 0x5dc;
  iVar3 = 0;
  do {
    pqVar1 = entries + iVar3;
    pqVar1->pos_x = (float)(terrain_texture_width + 0x40);
    pqVar1->pos_y = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x1d;
    pqVar1->trigger_time_ms = iVar5;
    pqVar1->count = config_blob.reserved0._20_4_ * 2 + 4;
    pqVar1 = entries + iVar3 + 1;
    pqVar1->pos_x = -64.0;
    iVar4 = iVar3 + 2;
    pqVar1->pos_y = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x1d;
    pqVar1->trigger_time_ms = iVar5 + 200;
    pqVar1->count = 6;
    iVar2 = crt_rand();
    if (iVar2 % 5 == 3) {
      pqVar1 = entries + iVar4;
      iVar4 = iVar3 + 3;
      pqVar1->pos_x = (float)(terrain_texture_width / 2);
      pqVar1->pos_y = 1088.0;
      pqVar1->template_id = 0x29;
      pqVar1->trigger_time_ms = iVar5;
      pqVar1->count = config_blob.reserved0._20_4_;
    }
    iVar5 = iVar5 + 10000;
    iVar3 = iVar4;
  } while (iVar5 < 0x18c7c);
  *count = iVar4;
  return;
}



/* quest_build_spider_wave_syndrome @ 00436440 */

/* quest builder for Tier 1 Quest 7 (Spider Wave Syndrome) */

void __cdecl quest_build_spider_wave_syndrome(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = 0;
  iVar3 = 0x5dc;
  do {
    pqVar1 = entries + iVar2;
    pqVar1->pos_x = -64.0;
    iVar2 = iVar2 + 1;
    pqVar1->pos_y = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x40;
    pqVar1->trigger_time_ms = iVar3;
    iVar3 = iVar3 + 0x157c;
    pqVar1->count = config_blob.reserved0._20_4_ * 2 + 6;
  } while (iVar3 < 0x18894);
  *count = iVar2;
  return;
}



/* quest_build_nesting_grounds @ 004364a0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 1 Quest 9 (Nesting Grounds) */

void quest_build_nesting_grounds(quest_spawn_entry_t *entries,int *count)

{
  entries->pos_x = (float)(terrain_texture_width / 2);
  entries->pos_y = (float)(terrain_texture_height + 0x40);
  entries->template_id = 0x1d;
  entries->trigger_time_ms = 0x5dc;
  entries->count = config_blob.reserved0._20_4_ * 2 + 6;
  entries[1].pos_x = 256.0;
  entries[1].pos_y = 256.0;
  entries[1].template_id = 9;
  entries[1].trigger_time_ms = 8000;
  entries[1].count = 1;
  entries[2].pos_x = 512.0;
  entries[2].pos_y = 512.0;
  entries[2].template_id = 9;
  entries[2].trigger_time_ms = 13000;
  entries[2].count = 1;
  entries[3].pos_x = 768.0;
  entries[3].pos_y = 768.0;
  entries[3].template_id = 9;
  entries[3].trigger_time_ms = 18000;
  entries[3].count = 1;
  entries[4].pos_x = (float)(terrain_texture_width / 2);
  entries[4].pos_y = (float)(terrain_texture_height + 0x40);
  entries[4].template_id = 0x1d;
  entries[4].trigger_time_ms = 25000;
  entries[4].count = config_blob.reserved0._20_4_ * 2 + 6;
  entries[5].pos_x = (float)(terrain_texture_width / 2);
  entries[5].pos_y = (float)(terrain_texture_height + 0x40);
  entries[5].template_id = 0x1d;
  entries[5].trigger_time_ms = 39000;
  entries[5].count = config_blob.reserved0._20_4_ * 3 + 3;
  entries[6].pos_x = 384.0;
  entries[6].pos_y = 512.0;
  entries[6].template_id = 9;
  entries[6].trigger_time_ms = 0xa08c;
  entries[6].count = 1;
  entries[7].pos_x = 640.0;
  entries[7].pos_y = 512.0;
  entries[7].template_id = 9;
  entries[7].trigger_time_ms = 0xa474;
  entries[7].count = 1;
  entries[8].pos_x = 512.0;
  entries[8].pos_y = 640.0;
  entries[8].template_id = 9;
  entries[8].trigger_time_ms = 0xa85c;
  entries[8].count = 1;
  entries[9].pos_x = 512.0;
  entries[9].pos_y = 512.0;
  entries[9].template_id = 8;
  entries[9].trigger_time_ms = 0xac44;
  entries[9].count = 1;
  entries[10].pos_x = (float)(terrain_texture_width / 2);
  entries[10].pos_y = (float)(terrain_texture_height + 0x40);
  entries[10].template_id = 0x1e;
  entries[10].trigger_time_ms = 50000;
  entries[10].count = config_blob.reserved0._20_4_ * 2 + 5;
  entries[0xb].pos_x = (float)(terrain_texture_width / 2);
  entries[0xb].pos_y = (float)(terrain_texture_height + 0x40);
  entries[0xb].template_id = 0x1f;
  entries[0xb].trigger_time_ms = 55000;
  entries[0xb].count = config_blob.reserved0._20_4_ * 2 + 2;
  *count = 0xc;
  return;
}



/* quest_build_alien_dens @ 00436720 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 1 Quest 5 (Alien Dens) */

void quest_build_alien_dens(quest_spawn_entry_t *entries,int *count)

{
  entries->pos_x = 256.0;
  entries->pos_y = 256.0;
  entries->template_id = 8;
  entries->trigger_time_ms = 0x5dc;
  entries->count = 1;
  entries[1].pos_x = 768.0;
  entries[1].pos_y = 768.0;
  entries[1].template_id = 8;
  entries[1].trigger_time_ms = 0x5dc;
  entries[1].count = 1;
  entries[2].pos_x = 512.0;
  entries[2].pos_y = 512.0;
  entries[2].template_id = 8;
  entries[2].trigger_time_ms = 0x5bcc;
  entries[2].count = config_blob.reserved0._20_4_;
  entries[3].pos_x = 256.0;
  entries[3].pos_y = 768.0;
  entries[3].template_id = 8;
  entries[3].trigger_time_ms = 0x9664;
  entries[3].count = 1;
  entries[4].pos_x = 768.0;
  entries[4].pos_y = 256.0;
  entries[4].template_id = 8;
  entries[4].trigger_time_ms = 0x9664;
  entries[4].count = 1;
  *count = 5;
  return;
}



/* quest_build_arachnoid_farm @ 00436820 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 2 Quest 3 (Arachnoid Farm) */

void quest_build_arachnoid_farm(quest_spawn_entry_t *entries,int *count)

{
  float fVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int iStack_c;
  
  iVar3 = 0;
  iStack_c = 0;
  if (config_blob.reserved0._20_4_ != -4 && -1 < config_blob.reserved0._20_4_ + 4) {
    iVar4 = 500;
    piVar2 = &entries->trigger_time_ms;
    do {
      iVar3 = iStack_c + 1;
      ((quest_spawn_entry_t *)(piVar2 + -4))->pos_x = (float)iStack_c * 102.4 + 256.0;
      piVar2[-3] = 0x43800000;
      piVar2[-1] = 10;
      *piVar2 = iVar4;
      piVar2[1] = 1;
      iVar4 = iVar4 + 500;
      piVar2 = piVar2 + 6;
      iStack_c = iVar3;
    } while (iVar3 < config_blob.reserved0._20_4_ + 4);
  }
  iStack_c = 0;
  if (config_blob.reserved0._20_4_ != -4 && -1 < config_blob.reserved0._20_4_ + 4) {
    iVar4 = 0x2904;
    piVar2 = &entries[iVar3].trigger_time_ms;
    do {
      fVar1 = (float)iStack_c;
      iVar3 = iVar3 + 1;
      iStack_c = iStack_c + 1;
      ((quest_spawn_entry_t *)(piVar2 + -4))->pos_x = fVar1 * 102.4 + 256.0;
      piVar2[-3] = 0x44400000;
      piVar2[-1] = 10;
      *piVar2 = iVar4;
      piVar2[1] = 1;
      iVar4 = iVar4 + 500;
      piVar2 = piVar2 + 6;
    } while (iStack_c < config_blob.reserved0._20_4_ + 4);
  }
  iStack_c = 0;
  if (config_blob.reserved0._20_4_ != -7 && -1 < config_blob.reserved0._20_4_ + 7) {
    iVar4 = 0x9e34;
    piVar2 = &entries[iVar3].trigger_time_ms;
    do {
      fVar1 = (float)iStack_c;
      iVar3 = iVar3 + 1;
      iStack_c = iStack_c + 1;
      ((quest_spawn_entry_t *)(piVar2 + -4))->pos_x = fVar1 * 64.0 + 256.0;
      piVar2[-3] = 0x44000000;
      piVar2[-1] = 0x10;
      *piVar2 = iVar4;
      piVar2[1] = 1;
      iVar4 = iVar4 + 0xdac;
      piVar2 = piVar2 + 6;
    } while (iStack_c < config_blob.reserved0._20_4_ + 7);
    *count = iVar3;
    return;
  }
  *count = iVar3;
  return;
}



/* quest_build_gauntlet @ 004369a0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 4 Quest 7 (Gauntlet) */

void quest_build_gauntlet(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  quest_spawn_entry_t *pqVar2;
  int *piVar3;
  quest_spawn_entry_t *pqVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  float10 fVar8;
  float10 fVar9;
  int iStack_8;
  int iStack_4;
  
  pqVar2 = entries;
  iVar6 = 0;
  iStack_8 = 0;
  if (config_blob.hardcore != '\0') {
    config_blob.reserved0._20_4_ = config_blob.reserved0._20_4_ + 4;
  }
  iStack_4 = config_blob.reserved0._20_4_ + 9;
  if (0 < iStack_4) {
    iVar7 = 0;
    piVar3 = &entries->template_id;
    do {
      fVar8 = (float10)fcos(((float10)iStack_8 * (float10)6.2831855) / (float10)iStack_4);
      ((quest_spawn_entry_t *)(piVar3 + -3))->pos_x =
           (float)(fVar8 * (float10)158.0 + (float10)512.0);
      iVar6 = iStack_8 + 1;
      fVar8 = (float10)fsin(((float10)iStack_8 * (float10)6.2831855) /
                            (float10)(config_blob.reserved0._20_4_ + 9));
      piVar3[-2] = (int)(float)(fVar8 * (float10)158.0 + (float10)512.0);
      *piVar3 = 10;
      piVar3[1] = iVar7;
      piVar3[2] = 1;
      iVar7 = iVar7 + 200;
      iStack_4 = config_blob.reserved0._20_4_ + 9;
      piVar3 = piVar3 + 6;
      iStack_8 = iVar6;
    } while (iVar6 < iStack_4);
  }
  if (config_blob.reserved0._20_4_ != -9 && -1 < config_blob.reserved0._20_4_ + 9) {
    iVar5 = 4000;
    pqVar4 = entries + iVar6;
    iVar7 = 2;
    do {
      pqVar4->pos_x = (float)(terrain_texture_width + 0x40);
      pqVar4->pos_y = (float)(terrain_texture_width / 2);
      pqVar4->template_id = 0x41;
      pqVar4->trigger_time_ms = iVar5;
      pqVar4->count = iVar7;
      pqVar4[1].pos_x = -64.0;
      pqVar4[1].pos_y = (float)(terrain_texture_width / 2);
      pqVar4[1].template_id = 0x41;
      pqVar4[1].trigger_time_ms = iVar5;
      pqVar4[1].count = iVar7;
      pqVar4[2].pos_x = (float)(terrain_texture_width / 2);
      pqVar4[2].pos_y = (float)(terrain_texture_width + 0x40);
      pqVar4[2].template_id = 0x41;
      pqVar4[2].trigger_time_ms = iVar5;
      pqVar4[2].count = iVar7;
      iVar6 = iVar6 + 4;
      pqVar4[3].pos_x = (float)(terrain_texture_width / 2);
      pqVar4[3].pos_y = -64.0;
      pqVar4[3].template_id = 0x41;
      pqVar4[3].trigger_time_ms = iVar5;
      pqVar4[3].count = iVar7;
      iVar5 = iVar5 + 0x157c;
      iVar1 = iVar7 + -1;
      pqVar4 = pqVar4 + 4;
      iVar7 = iVar7 + 1;
    } while (iVar1 < config_blob.reserved0._20_4_ + 9);
  }
  iStack_4 = config_blob.reserved0._20_4_ + 0x11;
  entries = (quest_spawn_entry_t *)0x0;
  if (0 < iStack_4) {
    iVar7 = 0xa604;
    piVar3 = &pqVar2[iVar6].template_id;
    do {
      fVar8 = (float10)(int)entries;
      fVar9 = (float10)fcos((fVar8 * (float10)6.2831855) / (float10)iStack_4);
      ((quest_spawn_entry_t *)(piVar3 + -3))->pos_x =
           (float)(fVar9 * (float10)258.0 + (float10)512.0);
      iVar6 = iVar6 + 1;
      entries = (quest_spawn_entry_t *)((int)&entries->pos_x + 1);
      fVar8 = (float10)fsin((fVar8 * (float10)6.2831855) /
                            (float10)(config_blob.reserved0._20_4_ + 0x11));
      piVar3[-2] = (int)(float)(fVar8 * (float10)258.0 + (float10)512.0);
      *piVar3 = 10;
      piVar3[1] = iVar7;
      piVar3[2] = 1;
      iVar7 = iVar7 + 500;
      iStack_4 = config_blob.reserved0._20_4_ + 0x11;
      piVar3 = piVar3 + 6;
    } while ((int)entries < iStack_4);
  }
  if (config_blob.hardcore == '\0') {
    *count = iVar6;
    return;
  }
  config_blob.reserved0._20_4_ = config_blob.reserved0._20_4_ + -4;
  *count = iVar6;
  return;
}



/* quest_build_syntax_terror @ 00436c10 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 4 Quest 8 (Syntax Terror) */

void quest_build_syntax_terror(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iStack_1c;
  int iStack_18;
  int iStack_14;
  int iStack_10;
  
  iVar4 = 0;
  iStack_1c = 0;
  if (config_blob.hardcore != '\0') {
    config_blob.reserved0._20_4_ = config_blob.reserved0._20_4_ + 4;
  }
  iStack_18 = 0;
  iStack_10 = 0x5dc;
  iStack_14 = 0x14c9;
  iVar1 = config_blob.reserved0._20_4_;
  do {
    iVar5 = 0;
    if (iVar1 != -9 && -1 < iVar1 + 9) {
      piVar2 = &entries[iVar4].template_id;
      iVar3 = 0x4c5;
      iVar6 = iStack_10;
      do {
        iVar1 = iVar3 * iVar5;
        ((quest_spawn_entry_t *)(piVar2 + -3))->pos_x =
             (float)(((iVar5 * iVar5 * 0x4c + 0xec) * iVar5 + iStack_14 * iStack_18) % 0x380 + 0x40)
        ;
        iVar4 = iStack_1c + 1;
        iVar5 = iVar5 + 1;
        piVar2[-2] = (int)(float)((iVar1 + (iStack_18 * iStack_18 * 0x4c + 0x1b) * iStack_18) %
                                  0x380 + 0x40);
        *piVar2 = 7;
        piVar2[1] = iVar6;
        piVar2[2] = 1;
        iVar6 = iVar6 + 300;
        iVar1 = config_blob.reserved0._20_4_;
        piVar2 = piVar2 + 6;
        iVar3 = iVar3 + 0x15;
        iStack_1c = iVar4;
      } while (iVar5 < config_blob.reserved0._20_4_ + 9);
    }
    iStack_14 = iStack_14 + 0x35;
    iStack_18 = iStack_18 + 1;
    iStack_10 = iStack_10 + 30000;
  } while (iStack_14 < 0x159d);
  if (config_blob.hardcore == '\0') {
    *count = iVar4;
    return;
  }
  config_blob.reserved0._20_4_ = iVar1 + -4;
  *count = iVar4;
  return;
}



/* quest_build_spider_spawns @ 00436d70 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 2 Quest 2 (Spider Spawns) */

void quest_build_spider_spawns(quest_spawn_entry_t *entries,int *count)

{
  entries->pos_x = 128.0;
  entries->pos_y = 128.0;
  entries->template_id = 0x10;
  entries->trigger_time_ms = 0x5dc;
  entries->count = 1;
  entries[1].pos_x = 896.0;
  entries[1].pos_y = 896.0;
  entries[1].template_id = 0x10;
  entries[1].trigger_time_ms = 0x5dc;
  entries[1].count = 1;
  entries[2].pos_x = 896.0;
  entries[2].pos_y = 128.0;
  entries[2].template_id = 0x10;
  entries[2].trigger_time_ms = 0x5dc;
  entries[2].count = 1;
  entries[3].pos_x = 128.0;
  entries[3].pos_y = 896.0;
  entries[3].template_id = 0x10;
  entries[3].trigger_time_ms = 0x5dc;
  entries[3].count = 1;
  entries[4].pos_x = -64.0;
  entries[4].pos_y = 512.0;
  entries[4].template_id = 0x38;
  entries[4].trigger_time_ms = 3000;
  entries[4].count = 2;
  entries[5].pos_x = 512.0;
  entries[5].pos_y = 512.0;
  entries[5].template_id = 10;
  entries[5].trigger_time_ms = 18000;
  entries[5].count = 1;
  entries[6].pos_x = 448.0;
  entries[6].pos_y = 448.0;
  entries[6].template_id = 0x10;
  entries[6].trigger_time_ms = 0x5014;
  entries[6].count = 1;
  entries[7].pos_x = 576.0;
  entries[7].pos_y = 448.0;
  entries[7].template_id = 0x10;
  entries[7].trigger_time_ms = 26000;
  entries[7].count = 1;
  entries[8].pos_x = 1088.0;
  entries[8].pos_y = 512.0;
  entries[8].template_id = 0x38;
  entries[8].trigger_time_ms = 21000;
  entries[8].count = 2;
  entries[9].pos_x = 576.0;
  entries[9].pos_y = 576.0;
  entries[9].template_id = 0x10;
  entries[9].trigger_time_ms = 0x7b0c;
  entries[9].count = 1;
  entries[10].pos_x = 448.0;
  entries[10].pos_y = 576.0;
  entries[10].template_id = 0x10;
  entries[10].trigger_time_ms = 22000;
  entries[10].count = 1;
  *count = 0xb;
  return;
}



/* quest_build_two_fronts @ 00436ee0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 2 Quest 4 (Two Fronts) */

void quest_build_two_fronts(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar2 = 0;
  iVar3 = 0;
  do {
    entries->pos_x = (float)(terrain_texture_width + 0x40);
    entries->pos_y = (float)(terrain_texture_width / 2);
    entries->template_id = 0x1a;
    entries->trigger_time_ms = iVar3 * 2000 + 1000;
    entries->count = 1;
    entries[1].pos_x = -64.0;
    entries[1].pos_y = (float)(terrain_texture_width / 2);
    entries[1].template_id = 0x1b;
    entries[1].trigger_time_ms = (iVar3 * 5 + 5) * 400;
    entries[1].count = 1;
    if ((iVar3 == 10) || (pqVar1 = entries + 2, iVar4 = iVar2 + 2, iVar3 == 0x14)) {
      entries[2].pos_x = 256.0;
      iVar4 = iVar3 * 2000 + 0x9c4;
      entries[2].pos_y = 256.0;
      entries[2].template_id = 10;
      entries[2].trigger_time_ms = iVar4;
      entries[2].count = 1;
      entries[3].pos_x = 768.0;
      entries[3].pos_y = 768.0;
      entries[3].template_id = 7;
      entries[3].trigger_time_ms = iVar4;
      entries[3].count = 1;
      pqVar1 = entries + 4;
      iVar4 = iVar2 + 4;
    }
    iVar2 = iVar4;
    entries = pqVar1;
    if (iVar3 == 0x1e) {
      entries->pos_x = 768.0;
      entries->pos_y = 256.0;
      entries->template_id = 10;
      entries->trigger_time_ms = 0xf424;
      entries->count = 1;
      entries[1].pos_x = 256.0;
      entries[1].pos_y = 768.0;
      entries[1].template_id = 7;
      entries[1].trigger_time_ms = 0xf424;
      entries[1].count = 1;
      iVar2 = iVar2 + 2;
      entries = entries + 2;
    }
    iVar3 = iVar3 + 1;
  } while (iVar3 < 0x28);
  *count = iVar2;
  return;
}



/* quest_build_survival_of_the_fastest @ 00437060 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 2 Quest 7 (Survival Of The Fastest) */

void quest_build_survival_of_the_fastest(quest_spawn_entry_t *entries,int *count)

{
  float fVar1;
  quest_spawn_entry_t *pqVar2;
  int *piVar3;
  int iVar4;
  int iStack_c;
  
  pqVar2 = entries;
  iVar4 = 500;
  iStack_c = 0x100;
  piVar3 = &entries->trigger_time_ms;
  do {
    fVar1 = (float)iStack_c;
    iStack_c = iStack_c + 0x48;
    ((quest_spawn_entry_t *)(piVar3 + -4))->pos_x = fVar1;
    piVar3[-3] = 0x43800000;
    piVar3[-1] = 0x10;
    *piVar3 = iVar4;
    piVar3[1] = 1;
    iVar4 = iVar4 + 900;
    piVar3 = piVar3 + 6;
  } while (iStack_c < 0x2b0);
  iStack_c = 0x170c;
  entries = (quest_spawn_entry_t *)0x100;
  piVar3 = &pqVar2[6].trigger_time_ms;
  do {
    fVar1 = (float)(int)entries;
    entries = entries + 3;
    ((quest_spawn_entry_t *)(piVar3 + -4))->pos_x = 688.0;
    piVar3[-3] = (int)fVar1;
    piVar3[-1] = 0x10;
    *piVar3 = iStack_c;
    piVar3[1] = 1;
    iStack_c = iStack_c + 900;
    piVar3 = piVar3 + 6;
  } while ((int)entries < 0x2b0);
  entries = (quest_spawn_entry_t *)0x2b0;
  iVar4 = 4;
  iStack_c = 0x2c24;
  piVar3 = &pqVar2[0xc].trigger_time_ms;
  do {
    ((quest_spawn_entry_t *)(piVar3 + -4))->pos_x = (float)(int)entries;
    piVar3[-3] = 0x442c0000;
    piVar3[-1] = 0x10;
    *piVar3 = iStack_c;
    piVar3[1] = 1;
    entries = entries + -3;
    iStack_c = iStack_c + 900;
    iVar4 = iVar4 + -1;
    piVar3 = piVar3 + 6;
  } while (iVar4 != 0);
  entries = (quest_spawn_entry_t *)0x2b0;
  iStack_c = 0x3a34;
  iVar4 = 4;
  piVar3 = &pqVar2[0x10].trigger_time_ms;
  do {
    ((quest_spawn_entry_t *)(piVar3 + -4))->pos_x = 400.0;
    piVar3[-3] = (int)(float)(int)entries;
    piVar3[-1] = 0x10;
    *piVar3 = iStack_c;
    piVar3[1] = 1;
    entries = entries + -3;
    iStack_c = iStack_c + 900;
    iVar4 = iVar4 + -1;
    piVar3 = piVar3 + 6;
  } while (iVar4 != 0);
  iStack_c = 0x4844;
  iVar4 = 400;
  piVar3 = &pqVar2[0x14].trigger_time_ms;
  do {
    fVar1 = (float)iVar4;
    iVar4 = iVar4 + 0x48;
    ((quest_spawn_entry_t *)(piVar3 + -4))->pos_x = fVar1;
    piVar3[-3] = 0x43c80000;
    piVar3[-1] = 0x10;
    *piVar3 = iStack_c;
    piVar3[1] = 1;
    iStack_c = iStack_c + 900;
    piVar3 = piVar3 + 6;
  } while (iVar4 < 0x220);
  pqVar2[0x16].pos_x = 128.0;
  pqVar2[0x16].pos_y = 128.0;
  pqVar2[0x16].template_id = 0x10;
  pqVar2[0x16].trigger_time_ms = 0x571c;
  pqVar2[0x16].count = 1;
  pqVar2[0x17].pos_x = 896.0;
  pqVar2[0x17].pos_y = 128.0;
  pqVar2[0x17].template_id = 7;
  pqVar2[0x17].trigger_time_ms = 0x571c;
  pqVar2[0x17].count = 1;
  pqVar2[0x18].pos_x = 128.0;
  pqVar2[0x18].pos_y = 896.0;
  pqVar2[0x18].template_id = 7;
  pqVar2[0x18].trigger_time_ms = 0x5eec;
  pqVar2[0x18].count = 1;
  pqVar2[0x19].pos_x = 896.0;
  pqVar2[0x19].pos_y = 896.0;
  pqVar2[0x19].template_id = 0x10;
  pqVar2[0x19].trigger_time_ms = 0x5eec;
  pqVar2[0x19].count = 1;
  *count = 0x1a;
  return;
}



/* quest_build_spideroids @ 004373c0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 2 Quest 10 (Spideroids) */

void quest_build_spideroids(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  
  entries->pos_x = 1088.0;
  entries->pos_y = 512.0;
  entries->template_id = 1;
  entries->trigger_time_ms = 1000;
  entries->count = 1;
  entries[1].pos_x = -64.0;
  entries[1].pos_y = 512.0;
  entries[1].template_id = 1;
  entries[1].trigger_time_ms = 3000;
  entries[1].count = 1;
  entries[2].pos_x = 1088.0;
  entries[2].pos_y = 256.0;
  entries[2].template_id = 1;
  entries[2].trigger_time_ms = 6000;
  entries[2].count = 1;
  iVar2 = 3;
  if (config_blob.hardcore != '\0') {
    entries[3].pos_x = 1088.0;
    entries[3].pos_y = 762.0;
    entries[3].template_id = 1;
    entries[3].trigger_time_ms = 9000;
    entries[3].count = 1;
    entries[4].pos_x = 512.0;
    entries[4].pos_y = 1088.0;
    entries[4].template_id = 1;
    entries[4].trigger_time_ms = 9000;
    entries[4].count = 1;
    iVar2 = 5;
  }
  if (((int)config_blob.reserved0._20_4_ < 2) && (config_blob.hardcore == '\0')) {
    *count = iVar2;
    return;
  }
  pqVar1 = entries + iVar2;
  pqVar1->pos_x = -64.0;
  pqVar1->pos_y = 762.0;
  pqVar1->template_id = 1;
  pqVar1->trigger_time_ms = 9000;
  pqVar1->count = 1;
  *count = iVar2 + 1;
  return;
}



/* quest_build_evil_zombies_at_large @ 004374a0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 2 Quest 6 (Evil Zombies At Large) */

void quest_build_evil_zombies_at_large(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar2 = 0;
  iVar4 = 0x5dc;
  iVar3 = 4;
  do {
    entries->pos_x = (float)(terrain_texture_width + 0x40);
    entries->pos_y = (float)(terrain_texture_width / 2);
    entries->template_id = 0x41;
    entries->trigger_time_ms = iVar4;
    entries->count = iVar3;
    entries[1].pos_x = -64.0;
    entries[1].pos_y = (float)(terrain_texture_width / 2);
    entries[1].template_id = 0x41;
    entries[1].trigger_time_ms = iVar4;
    entries[1].count = iVar3;
    entries[2].pos_x = (float)(terrain_texture_width / 2);
    entries[2].pos_y = (float)(terrain_texture_width + 0x40);
    entries[2].template_id = 0x41;
    entries[2].trigger_time_ms = iVar4;
    entries[2].count = iVar3;
    iVar2 = iVar2 + 4;
    entries[3].pos_x = (float)(terrain_texture_width / 2);
    entries[3].pos_y = -64.0;
    entries[3].template_id = 0x41;
    entries[3].trigger_time_ms = iVar4;
    entries[3].count = iVar3;
    iVar4 = iVar4 + 0x157c;
    iVar1 = iVar3 + -3;
    entries = entries + 4;
    iVar3 = iVar3 + 1;
  } while (iVar1 < 10);
  *count = iVar2;
  return;
}



/* quest_build_everred_pastures @ 004375a0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 2 Quest 1 (Everred Pastures) */

void quest_build_everred_pastures(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  int iVar2;
  quest_spawn_entry_t *pqVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  iVar4 = 0;
  iVar6 = 0;
  do {
    iVar1 = iVar6 + 1;
    entries->pos_x = (float)(terrain_texture_width + 0x40);
    pqVar3 = entries + 4;
    entries->pos_y = (float)(terrain_texture_width / 2);
    entries->template_id = 0x32;
    iVar2 = iVar6 * 13000 + 0x5dc;
    entries->trigger_time_ms = iVar2;
    entries->count = iVar1;
    entries[1].pos_x = -64.0;
    entries[1].pos_y = (float)(terrain_texture_width / 2);
    entries[1].template_id = 0x33;
    entries[1].trigger_time_ms = iVar2;
    entries[1].count = iVar1;
    entries[2].pos_x = (float)(terrain_texture_width / 2);
    entries[2].pos_y = (float)(terrain_texture_width + 0x40);
    entries[2].template_id = 0x34;
    entries[2].trigger_time_ms = iVar2;
    entries[2].count = iVar1;
    iVar5 = iVar4 + 4;
    entries[3].pos_x = (float)(terrain_texture_width / 2);
    entries[3].pos_y = -64.0;
    entries[3].template_id = 0x35;
    entries[3].trigger_time_ms = iVar2;
    entries[3].count = iVar1;
    if (iVar6 == 3) {
      entries[4].pos_x = (float)(terrain_texture_width / 2);
      entries[4].pos_y = -64.0;
      entries[4].template_id = 0x1b;
      entries[4].trigger_time_ms = 0x9e34;
      entries[4].count = 8;
      iVar5 = iVar4 + 6;
      pqVar3 = entries + 6;
      entries[5].pos_x = (float)(terrain_texture_width / 2);
      entries[5].pos_y = 1088.0;
      entries[5].template_id = 0x1b;
      entries[5].trigger_time_ms = 0x9e34;
      entries[5].count = 8;
    }
    entries = pqVar3;
    iVar4 = iVar5;
    iVar6 = iVar1;
  } while (iVar1 < 8);
  *count = iVar5;
  return;
}



/* quest_build_lizard_kings @ 00437710 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 3 Quest 2 (Lizard Kings) */

void quest_build_lizard_kings(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int *piVar2;
  int iVar3;
  float10 fVar4;
  float10 fVar5;
  float10 fVar6;
  
  pqVar1 = entries;
  entries->pos_x = 1152.0;
  entries->pos_y = 512.0;
  iVar3 = 0x5dc;
  entries->template_id = 0x11;
  entries->trigger_time_ms = 0x5dc;
  entries->count = 1;
  entries[1].pos_x = -128.0;
  entries[1].pos_y = 512.0;
  entries[1].template_id = 0x11;
  entries[1].trigger_time_ms = 0x5dc;
  entries[1].count = 1;
  entries[2].pos_x = 1152.0;
  entries[2].pos_y = 896.0;
  entries[2].template_id = 0x11;
  entries[2].trigger_time_ms = 0x5dc;
  entries[2].count = 1;
  entries = (quest_spawn_entry_t *)0x0;
  piVar2 = &pqVar1[3].template_id;
  do {
    fVar4 = (float10)(int)entries;
    fVar5 = fVar4 * (float10)0.34906587;
    fVar6 = (float10)fcos(fVar5);
    ((quest_spawn_entry_t *)(piVar2 + -3))->pos_x = (float)(fVar6 * (float10)256.0 + (float10)512.0)
    ;
    fVar5 = (float10)fsin(fVar5);
    piVar2[-2] = (int)(float)(fVar5 * (float10)256.0 + (float10)512.0);
    *piVar2 = 0x31;
    piVar2[1] = iVar3;
    piVar2[2] = 1;
    iVar3 = iVar3 + 900;
    entries = (quest_spawn_entry_t *)((int)&entries->pos_x + 1);
    piVar2[-1] = (int)(float)(fVar4 * (float10)-0.34906587);
    piVar2 = piVar2 + 6;
  } while ((int)entries < 0x1c);
  *count = 0x1f;
  return;
}



/* quest_build_sweep_stakes @ 00437810 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 2 Quest 5 (Sweep Stakes) */

void quest_build_sweep_stakes(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  quest_spawn_entry_t *pqVar2;
  float fVar3;
  int iVar4;
  float10 fVar5;
  float10 fVar6;
  float10 fVar7;
  int iStack_18;
  
  fVar3 = 2.8026e-42;
  iVar4 = 2000;
  entries = (quest_spawn_entry_t *)&entries->trigger_time_ms;
  do {
    iVar1 = crt_rand();
    iStack_18 = 0x54;
    fVar5 = (float10)(iVar1 % 0x264) * (float10)0.01;
    fVar6 = (float10)fcos(fVar5);
    fVar5 = (float10)fsin(fVar5);
    pqVar2 = entries;
    do {
      fVar7 = (float10)iStack_18;
      iStack_18 = iStack_18 + 0x2a;
      pqVar2[-1].heading = (float)(fVar7 * (float10)(float)fVar6) + 512.0;
      pqVar2[-1].template_id = (int)(float)(fVar7 * fVar5 + (float10)512.0);
      pqVar2[-1].count = 0x36;
      pqVar2->pos_x = fVar3;
      pqVar2->pos_y = 1.4013e-45;
      fVar7 = (float10)fpatan((float10)(float)pqVar2[-1].template_id - (float10)512.0,
                              (float10)pqVar2[-1].heading - (float10)512.0);
      pqVar2[-1].trigger_time_ms = (int)(float)(fVar7 - (float10)1.5707964);
      pqVar2 = pqVar2 + 1;
    } while (iStack_18 < 0xfc);
    iVar1 = iVar4;
    if (iVar4 < 600) {
      iVar1 = 600;
    }
    iVar4 = iVar4 + -0x50;
    fVar3 = (float)((int)fVar3 + iVar1);
    entries = entries + 4;
  } while (0x2d0 < iVar4);
  *count = 0x40;
  return;
}



/* quest_build_deja_vu @ 00437920 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 3 Quest 9 (Deja vu) */

void quest_build_deja_vu(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  float10 fVar5;
  float10 fVar6;
  float10 fVar7;
  int iStack_18;
  
  iVar4 = 2000;
  iStack_18 = 2000;
  piVar3 = &entries->trigger_time_ms;
  do {
    iVar1 = crt_rand();
    entries = (quest_spawn_entry_t *)0x54;
    fVar5 = (float10)(iVar1 % 0x264) * (float10)0.01;
    fVar6 = (float10)fcos(fVar5);
    fVar5 = (float10)fsin(fVar5);
    piVar2 = piVar3;
    do {
      fVar7 = (float10)(int)entries;
      entries = (quest_spawn_entry_t *)((int)&entries[1].trigger_time_ms + 2);
      ((quest_spawn_entry_t *)(piVar2 + -4))->pos_x = (float)(fVar7 * (float10)(float)fVar6) + 512.0
      ;
      piVar2[-3] = (int)(float)(fVar7 * fVar5 + (float10)512.0);
      piVar2[-1] = 0xd;
      *piVar2 = iVar4;
      piVar2[1] = 1;
      piVar2 = piVar2 + 6;
    } while ((int)entries < 0xfc);
    iVar4 = iVar4 + iStack_18;
    iStack_18 = iStack_18 + -0x50;
    piVar3 = piVar3 + 0x18;
  } while (0x230 < iStack_18);
  *count = 0x48;
  return;
}



/* quest_build_target_practice @ 00437a00 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 1 Quest 3 (Target Practice) */

void quest_build_target_practice(quest_spawn_entry_t *entries,int *count)

{
  float fVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  float10 fVar7;
  float10 fVar8;
  float10 fVar9;
  
  iVar4 = 2000;
  iVar6 = 2000;
  piVar5 = &entries->trigger_time_ms;
  do {
    iVar2 = crt_rand();
    fVar1 = (float)(iVar2 % 0x264) * 0.01;
    uVar3 = crt_rand();
    uVar3 = uVar3 & 0x80000007;
    if ((int)uVar3 < 0) {
      uVar3 = (uVar3 - 1 | 0xfffffff8) + 1;
    }
    fVar7 = (float10)(int)((uVar3 + 2) * 0x20);
    fVar8 = (float10)fcos((float10)fVar1);
    fVar9 = (float10)fsin((float10)fVar1);
    ((quest_spawn_entry_t *)(piVar5 + -4))->pos_x = (float)(fVar8 * fVar7) + 512.0;
    piVar5[-3] = (int)(float)(fVar9 * fVar7 + (float10)512.0);
    piVar5[-1] = 0x36;
    *piVar5 = iVar4;
    piVar5[1] = 1;
    fVar7 = (float10)fpatan((float10)(float)piVar5[-3] - (float10)512.0,
                            (float10)((quest_spawn_entry_t *)(piVar5 + -4))->pos_x - (float10)512.0)
    ;
    piVar5[-2] = (int)(float)(fVar7 - (float10)1.5707964);
    iVar2 = iVar6;
    if (iVar6 < 0x44c) {
      iVar2 = 0x44c;
    }
    iVar6 = iVar6 + -0x32;
    iVar4 = iVar4 + iVar2;
    piVar5 = piVar5 + 6;
  } while (500 < iVar6);
  *count = 0x1e;
  return;
}



/* quest_build_major_alien_breach @ 00437af0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 4 Quest 1 (Major Alien Breach) */

void quest_build_major_alien_breach(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = 0;
  iVar1 = 4000;
  iVar3 = 0;
  do {
    entries->pos_x = 1088.0;
    entries->pos_y = 512.0;
    entries->template_id = 0x20;
    entries->trigger_time_ms = iVar1;
    entries->count = 2;
    iVar2 = iVar2 + 2;
    entries[1].pos_x = 512.0;
    entries[1].pos_y = -64.0;
    entries[1].template_id = 0x20;
    entries[1].trigger_time_ms = iVar1;
    entries[1].count = 2;
    iVar1 = iVar1 + (2000 - iVar3);
    entries = entries + 2;
    if (iVar1 < 1000) {
      iVar1 = 1000;
    }
    iVar3 = iVar3 + 0xf;
  } while (iVar3 < 0x5dc);
  *count = iVar2;
  return;
}



/* quest_build_land_of_lizards @ 00437ba0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 2 Quest 8 (Land Of Lizards) */

void quest_build_land_of_lizards(quest_spawn_entry_t *entries,int *count)

{
  entries->pos_x = 256.0;
  entries->pos_y = 256.0;
  entries->template_id = 0xe;
  entries->trigger_time_ms = 2000;
  entries->count = 1;
  entries[1].pos_x = 768.0;
  entries[1].pos_y = 256.0;
  entries[1].template_id = 0xe;
  entries[1].trigger_time_ms = 12000;
  entries[1].count = 1;
  entries[2].pos_x = 256.0;
  entries[2].pos_y = 768.0;
  entries[2].template_id = 0xe;
  entries[2].trigger_time_ms = 22000;
  entries[2].count = 1;
  entries[3].pos_x = 768.0;
  entries[3].pos_y = 768.0;
  entries[3].template_id = 0xe;
  entries[3].trigger_time_ms = 32000;
  entries[3].count = 1;
  *count = 4;
  return;
}



/* quest_build_the_lizquidation @ 00437c70 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 3 Quest 6 (The Lizquidation) */

void quest_build_the_lizquidation(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  quest_spawn_entry_t *pqVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar5 = 0;
  iVar3 = 0;
  do {
    iVar1 = iVar5 * 8000 + 0x5dc;
    pqVar2 = entries + iVar3;
    pqVar2->pos_x = (float)(terrain_texture_width + 0x40);
    pqVar2->pos_y = (float)(terrain_texture_width / 2);
    pqVar2->template_id = 0x2e;
    pqVar2->trigger_time_ms = iVar1;
    pqVar2->count = iVar5 + 6;
    pqVar2 = entries + iVar3 + 1;
    pqVar2->pos_x = -64.0;
    iVar4 = iVar3 + 2;
    pqVar2->pos_y = (float)(terrain_texture_width / 2);
    pqVar2->template_id = 0x2e;
    pqVar2->trigger_time_ms = iVar1;
    pqVar2->count = iVar5 + 6;
    if (iVar5 == 4) {
      pqVar2 = entries + iVar4;
      pqVar2->pos_x = (float)(terrain_texture_width + 0x80);
      iVar4 = iVar3 + 3;
      pqVar2->pos_y = (float)(terrain_texture_width / 2);
      pqVar2->template_id = 0x2b;
      pqVar2->trigger_time_ms = 0x5dc;
      pqVar2->count = 2;
    }
    iVar5 = iVar5 + 1;
    iVar3 = iVar4;
  } while (iVar5 < 10);
  *count = iVar4;
  return;
}



/* quest_build_zombie_time @ 00437d70 */

/* quest builder for Tier 4 Quest 2 (Zombie Time) */

void __cdecl quest_build_zombie_time(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = 0;
  iVar3 = 0x5dc;
  do {
    pqVar1 = entries + iVar2;
    pqVar1->pos_x = (float)(terrain_texture_width + 0x40);
    pqVar1->pos_y = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x41;
    pqVar1->trigger_time_ms = iVar3;
    pqVar1->count = 8;
    pqVar1 = entries + iVar2 + 1;
    pqVar1->pos_x = -64.0;
    iVar2 = iVar2 + 2;
    pqVar1->pos_y = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x41;
    pqVar1->trigger_time_ms = iVar3;
    iVar3 = iVar3 + 8000;
    pqVar1->count = 8;
  } while (iVar3 < 0x17cdc);
  *count = iVar2;
  return;
}



/* quest_build_frontline_assault @ 00437e10 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 1 Quest 4 (Frontline Assault) */

void quest_build_frontline_assault(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  iVar5 = 0;
  iVar6 = 0x9c4;
  iVar4 = 2;
  do {
    entries->pos_x = (float)(terrain_texture_width / 2);
    entries->pos_y = 1088.0;
    if (iVar4 < 5) {
      entries->template_id = 0x26;
    }
    else if (iVar4 < 10) {
      entries->template_id = 0x1a;
    }
    else {
      entries->template_id = 0x26;
    }
    iVar2 = iVar4 * iVar6 + -5000;
    entries->trigger_time_ms = iVar2;
    entries->count = 1;
    pqVar1 = entries + 1;
    iVar3 = iVar5 + 1;
    if (4 < iVar4) {
      entries[1].pos_x = -64.0;
      entries[1].pos_y = -64.0;
      entries[1].template_id = 0x26;
      entries[1].trigger_time_ms = iVar2;
      entries[1].count = 1;
      pqVar1 = entries + 2;
      iVar3 = iVar5 + 2;
    }
    iVar5 = iVar3;
    entries = pqVar1;
    if (10 < iVar4) {
      entries->pos_x = 1088.0;
      entries->pos_y = -64.0;
      entries->template_id = 0x26;
      entries->trigger_time_ms = iVar2;
      entries->count = 1;
      iVar5 = iVar5 + 1;
      entries = entries + 1;
    }
    if (iVar4 == 10) {
      entries->pos_x = 1088.0;
      entries->pos_y = 512.0;
      iVar3 = (iVar6 * 5 + -0x9c4) * 2;
      entries->template_id = 0x29;
      entries->trigger_time_ms = iVar3;
      entries->count = 1;
      entries[1].pos_x = -64.0;
      entries[1].pos_y = 512.0;
      entries[1].template_id = 0x29;
      entries[1].trigger_time_ms = iVar3;
      entries[1].count = 1;
      iVar5 = iVar5 + 2;
      entries = entries + 2;
    }
    iVar6 = iVar6 + -0x32;
    if (iVar6 < 0x708) {
      iVar6 = 0x708;
    }
    iVar4 = iVar4 + 1;
  } while (iVar4 < 0x16);
  *count = iVar5;
  return;
}



/* quest_build_the_collaboration @ 00437f30 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 4 Quest 4 (The Collaboration) */

void quest_build_the_collaboration(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  
  iVar3 = 0;
  iVar5 = 0x5dc;
  do {
    lVar6 = __ftol();
    iVar2 = (int)lVar6;
    pqVar1 = entries + iVar3;
    pqVar1->pos_x = (float)(terrain_texture_width + 0x40);
    pqVar1->pos_y = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x1a;
    pqVar1->trigger_time_ms = iVar5;
    pqVar1->count = iVar2;
    pqVar1 = entries + iVar3 + 1;
    pqVar1->pos_y = (float)(terrain_texture_width + 0x40);
    pqVar1->pos_x = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x1b;
    pqVar1->trigger_time_ms = iVar5;
    pqVar1->count = iVar2;
    pqVar1 = entries + iVar3 + 2;
    pqVar1->pos_x = -64.0;
    iVar4 = iVar3 + 3;
    pqVar1->pos_y = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x1c;
    pqVar1->trigger_time_ms = iVar5;
    pqVar1->count = iVar2;
    iVar3 = iVar3 + 4;
    pqVar1 = entries + iVar4;
    pqVar1->pos_x = 512.0;
    pqVar1->pos_y = -64.0;
    pqVar1->template_id = 0x41;
    pqVar1->trigger_time_ms = iVar5;
    iVar5 = iVar5 + 11000;
    pqVar1->count = iVar2;
  } while (iVar5 < 0x2b55c);
  *count = iVar3;
  return;
}



/* quest_build_the_blighting @ 00438050 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 3 Quest 1 (The Blighting) */

void quest_build_the_blighting(quest_spawn_entry_t *entries,int *count)

{
  uint uVar1;
  quest_spawn_entry_t *pqVar2;
  quest_spawn_entry_t *pqVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  uint uStack_8;
  
  entries->pos_x = (float)(terrain_texture_width + 0x80);
  iVar5 = 0x1a;
  entries->pos_y = (float)(terrain_texture_width / 2);
  entries->template_id = 0x2b;
  entries->trigger_time_ms = 0x5dc;
  entries->count = 2;
  entries[1].pos_x = -128.0;
  entries[1].pos_y = (float)(terrain_texture_width / 2);
  entries[1].template_id = 0x2b;
  entries[1].trigger_time_ms = 0x5dc;
  entries[1].count = 2;
  entries[2].pos_y = 128.0;
  entries[2].pos_x = 896.0;
  entries[2].template_id = 7;
  entries[2].trigger_time_ms = 2000;
  entries[2].count = 1;
  entries[3].pos_y = 128.0;
  entries[3].pos_x = 128.0;
  entries[3].template_id = 7;
  entries[3].trigger_time_ms = 2000;
  entries[3].count = 1;
  entries[4].pos_y = 896.0;
  entries[4].pos_x = 128.0;
  entries[4].template_id = 7;
  entries[4].trigger_time_ms = 2000;
  entries[4].count = 1;
  entries[5].pos_y = 896.0;
  entries[5].pos_x = 896.0;
  entries[5].template_id = 7;
  entries[5].trigger_time_ms = 2000;
  entries[5].count = 1;
  iVar7 = 6;
  iVar6 = 4000;
  uStack_8 = 0;
  pqVar3 = entries + 6;
  do {
    uVar1 = uStack_8 & 0x80000001;
    if ((int)uVar1 < 0) {
      uVar1 = (uVar1 - 1 | 0xfffffffe) + 1;
    }
    if ((uStack_8 == 2) || (pqVar2 = pqVar3, uStack_8 == 4)) {
      pqVar3->pos_x = -128.0;
      iVar7 = iVar7 + 1;
      pqVar2 = pqVar3 + 1;
      pqVar3->pos_y = (float)(terrain_texture_width / 2);
      pqVar3->template_id = 0x2b;
      pqVar3->trigger_time_ms = iVar6;
      pqVar3->count = 4;
    }
    if ((uStack_8 == 3) || (pqVar3 = pqVar2, uStack_8 == 5)) {
      pqVar2->pos_x = 1152.0;
      iVar7 = iVar7 + 1;
      pqVar3 = pqVar2 + 1;
      pqVar2->pos_y = (float)(terrain_texture_width / 2);
      pqVar2->template_id = 0x2b;
      pqVar2->trigger_time_ms = iVar6;
      pqVar2->count = 4;
    }
    if (uVar1 == 0) {
      iVar5 = 0x1a;
    }
    else if (uVar1 == 1) {
      iVar5 = 0x1c;
    }
    iVar4 = (int)uStack_8 % 5;
    if (iVar4 == 0) {
      pqVar3->pos_x = (float)(terrain_texture_width + 0x40);
      pqVar3->pos_y = (float)(terrain_texture_width / 2);
LAB_00438283:
      pqVar3->template_id = iVar5;
      pqVar3->trigger_time_ms = iVar6;
      pqVar3->count = 0xc;
      iVar7 = iVar7 + 1;
      pqVar3 = pqVar3 + 1;
      iVar6 = iVar6 + 15000;
    }
    else {
      if (iVar4 == 1) {
        pqVar3->pos_x = -64.0;
        pqVar3->pos_y = (float)(terrain_texture_width / 2);
        goto LAB_00438283;
      }
      if (iVar4 == 2) {
        pqVar3->pos_y = (float)(terrain_texture_width + 0x40);
LAB_00438281:
        pqVar3->pos_x = (float)(terrain_texture_width / 2);
        goto LAB_00438283;
      }
      if (iVar4 == 3) {
        pqVar3->pos_y = -64.0;
        goto LAB_00438281;
      }
    }
    iVar6 = iVar6 + 1000;
    uStack_8 = uStack_8 + 1;
    if (7 < (int)uStack_8) {
      *count = iVar7;
      return;
    }
  } while( true );
}



/* quest_build_the_annihilation @ 004382c0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 4 Quest 9 (The Annihilation) */

void quest_build_the_annihilation(quest_spawn_entry_t *entries,int *count)

{
  int *piVar1;
  bool bVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  
  iVar4 = 500;
  entries->pos_x = 128.0;
  uVar3 = 0;
  iVar5 = 0;
  piVar1 = &entries[1].template_id;
  entries->pos_y = (float)(terrain_texture_width / 2);
  entries->template_id = 0x2b;
  entries->trigger_time_ms = 500;
  entries->count = 2;
  do {
    piVar1[-2] = (int)(float)(iVar5 / 0xc + 0x80);
    if ((uVar3 & 1) == 0) {
      ((quest_spawn_entry_t *)(piVar1 + -3))->pos_x = 832.0;
    }
    else {
      ((quest_spawn_entry_t *)(piVar1 + -3))->pos_x = 896.0;
    }
    *piVar1 = 7;
    piVar1[1] = iVar4;
    piVar1[2] = 1;
    iVar4 = iVar4 + 500;
    iVar5 = iVar5 + 0x300;
    piVar1 = piVar1 + 6;
    uVar3 = uVar3 + 1;
  } while ((int)uVar3 < 0xc);
  bVar2 = false;
  iVar5 = 0;
  iVar4 = 45000;
  piVar1 = &entries[0xd].template_id;
  do {
    piVar1[-2] = (int)(float)(iVar5 / 0xc + 0x80);
    if (bVar2) {
      ((quest_spawn_entry_t *)(piVar1 + -3))->pos_x = 832.0;
    }
    else {
      ((quest_spawn_entry_t *)(piVar1 + -3))->pos_x = 896.0;
    }
    *piVar1 = 7;
    piVar1[1] = iVar4;
    piVar1[2] = 1;
    piVar1 = piVar1 + 6;
    iVar4 = iVar4 + 300;
    bVar2 = (bool)(bVar2 ^ 1);
    iVar5 = iVar5 + 0x300;
  } while (iVar4 < 0xbdd8);
  *count = 0x19;
  return;
}



/* quest_build_the_massacre @ 004383e0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 4 Quest 5 (The Massacre) */

void quest_build_the_massacre(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  bool bVar7;
  
  iVar6 = 0x5dc;
  uVar2 = 0;
  iVar4 = 0;
  do {
    pqVar1 = entries + 1;
    entries->pos_x = (float)(terrain_texture_width + 0x40);
    iVar5 = iVar4 + 1;
    uVar3 = uVar2 & 0x80000001;
    bVar7 = uVar3 == 0;
    entries->pos_y = (float)(terrain_texture_width / 2);
    entries->template_id = 0x41;
    entries->trigger_time_ms = iVar6;
    entries->count = uVar2 + 3;
    if ((int)uVar3 < 0) {
      bVar7 = (uVar3 - 1 | 0xfffffffe) == 0xffffffff;
    }
    if (bVar7) {
      pqVar1->pos_x = (float)(terrain_texture_width + 0x80);
      iVar5 = iVar4 + 2;
      pqVar1 = entries + 2;
      entries[1].pos_y = (float)(terrain_texture_width / 2);
      entries[1].template_id = 0x2b;
      entries[1].trigger_time_ms = iVar6;
      entries[1].count = uVar2 + 1;
    }
    iVar6 = iVar6 + 5000;
    entries = pqVar1;
    uVar2 = uVar2 + 1;
    iVar4 = iVar5;
  } while (iVar6 < 0x1656c);
  *count = iVar5;
  return;
}



/* quest_build_the_killing @ 004384a0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 3 Quest 3 (The Killing) */

void quest_build_the_killing(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  int iVar2;
  int iVar3;
  quest_spawn_entry_t *pqVar4;
  quest_spawn_entry_t *pqVar5;
  int iVar6;
  int iStack_4;
  
  iVar2 = 0;
  iVar6 = 2000;
  iVar3 = 0x1a;
  iStack_4 = 0;
  pqVar5 = entries;
  do {
    crt_rand();
    iVar1 = iStack_4 % 3;
    if (iVar1 == 0) {
      iVar3 = 0x1a;
    }
    else if (iVar1 == 1) {
      iVar3 = 0x1b;
    }
    else if (iVar1 == 2) {
      iVar3 = 0x1c;
    }
    crt_rand();
    iVar1 = iStack_4 % 5;
    pqVar4 = pqVar5;
    if (iVar1 == 0) {
      pqVar5->pos_x = (float)(terrain_texture_width + 0x40);
LAB_00438544:
      entries = (quest_spawn_entry_t *)(terrain_texture_width / 2);
      pqVar5->pos_y = (float)(int)entries;
      pqVar5->template_id = iVar3;
      pqVar5->trigger_time_ms = iVar6;
      pqVar5->count = 0xc;
LAB_004386cc:
      iVar2 = iVar2 + 1;
      pqVar5 = pqVar4 + 1;
      iVar6 = iVar6 + 5000;
    }
    else {
      if (iVar1 == 1) {
        pqVar5->pos_x = -64.0;
        goto LAB_00438544;
      }
      if (iVar1 == 2) {
        pqVar5->pos_y = (float)(terrain_texture_width + 0x40);
        pqVar5->pos_x = (float)(terrain_texture_width / 2);
        pqVar5->template_id = iVar3;
        pqVar5->trigger_time_ms = iVar6;
        pqVar5->count = 0xc;
        goto LAB_004386cc;
      }
      if (iVar1 == 3) {
        pqVar5->pos_y = -64.0;
        pqVar5->pos_x = (float)(terrain_texture_width / 2);
        pqVar5->template_id = iVar3;
        pqVar5->trigger_time_ms = iVar6;
        pqVar5->count = 0xc;
        goto LAB_004386cc;
      }
      if (iVar1 == 4) {
        iVar1 = crt_rand();
        pqVar5->pos_y = (float)(iVar1 % 0x300 + 0x80);
        iVar1 = crt_rand();
        pqVar5->pos_x = (float)(iVar1 % 0x300 + 0x80);
        pqVar5->template_id = 7;
        pqVar5->trigger_time_ms = iVar6;
        pqVar5->count = 3;
        iVar1 = crt_rand();
        pqVar5[1].pos_y = (float)(iVar1 % 0x300 + 0x80);
        iVar1 = crt_rand();
        pqVar4 = pqVar5 + 2;
        iVar2 = iVar2 + 2;
        pqVar5[1].pos_x = (float)(iVar1 % 0x300 + 0x80);
        pqVar5[1].template_id = 7;
        pqVar5[1].trigger_time_ms = iVar6 + 1000;
        pqVar5[1].count = 3;
        iVar1 = crt_rand();
        pqVar5[2].pos_y = (float)(iVar1 % 0x300 + 0x80);
        iVar1 = crt_rand();
        pqVar4->pos_x = (float)(iVar1 % 0x300 + 0x80);
        pqVar5[2].template_id = 7;
        pqVar5[2].trigger_time_ms = iVar6 + 2000;
        pqVar5[2].count = 3;
        goto LAB_004386cc;
      }
    }
    iVar6 = iVar6 + 1000;
    iStack_4 = iStack_4 + 1;
    if (9 < iStack_4) {
      *count = iVar2;
      return;
    }
  } while( true );
}



/* quest_build_lizard_zombie_pact @ 00438700 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 4 Quest 3 (Lizard Zombie Pact) */

void quest_build_lizard_zombie_pact(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iStack_4;
  
  iVar5 = 0x5dc;
  iStack_4 = 0;
  iVar3 = 0;
  do {
    pqVar1 = entries + iVar3;
    pqVar1->pos_x = (float)(terrain_texture_width + 0x40);
    pqVar1->pos_y = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x41;
    pqVar1->trigger_time_ms = iVar5;
    pqVar1->count = 6;
    pqVar1 = entries + iVar3 + 1;
    pqVar1->pos_x = -64.0;
    pqVar1->pos_y = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x41;
    pqVar1->trigger_time_ms = iVar5;
    pqVar1->count = 6;
    iVar4 = iVar3 + 2;
    if (iStack_4 % 5 == 0) {
      pqVar1 = entries + iVar4;
      iVar2 = iStack_4 / 5;
      pqVar1->pos_x = 356.0;
      pqVar1->pos_y = (float)(iVar2 * 0xb4 + 0x100);
      pqVar1->template_id = 0xc;
      pqVar1->trigger_time_ms = iVar5;
      pqVar1->count = iVar2 + 1;
      iVar4 = iVar3 + 4;
      pqVar1 = entries + iVar3 + 3;
      pqVar1->pos_x = 356.0;
      pqVar1->pos_y = (float)(iVar2 * 0xb4 + 0x180);
      pqVar1->template_id = 0xc;
      pqVar1->trigger_time_ms = iVar5;
      pqVar1->count = iVar2 + 2;
    }
    iVar5 = iVar5 + 7000;
    iStack_4 = iStack_4 + 1;
    iVar3 = iVar4;
  } while (iVar5 < 0x1bb5c);
  *count = iVar4;
  return;
}



/* quest_build_lizard_raze @ 00438840 */

/* quest builder for Tier 3 Quest 8 (Lizard Raze) */

void __cdecl quest_build_lizard_raze(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 0x5dc;
  iVar2 = 0;
  do {
    iVar3 = iVar2;
    pqVar1 = entries + iVar3;
    pqVar1->pos_x = (float)(terrain_texture_width + 0x40);
    pqVar1->pos_y = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x2e;
    pqVar1->trigger_time_ms = iVar4;
    pqVar1->count = 6;
    pqVar1 = entries + iVar3 + 1;
    pqVar1->pos_x = -64.0;
    pqVar1->pos_y = (float)(terrain_texture_width / 2);
    pqVar1->template_id = 0x2e;
    pqVar1->trigger_time_ms = iVar4;
    iVar4 = iVar4 + 6000;
    pqVar1->count = 6;
    iVar2 = iVar3 + 2;
  } while (iVar4 < 0x1656c);
  pqVar1 = entries + iVar3 + 2;
  pqVar1->pos_x = 128.0;
  pqVar1->pos_y = 256.0;
  pqVar1->template_id = 0xc;
  pqVar1->trigger_time_ms = 10000;
  pqVar1->count = 1;
  pqVar1 = entries + iVar3 + 3;
  pqVar1->pos_x = 128.0;
  pqVar1->pos_y = 384.0;
  pqVar1->template_id = 0xc;
  pqVar1->trigger_time_ms = 10000;
  pqVar1->count = 1;
  pqVar1 = entries + iVar3 + 4;
  pqVar1->pos_x = 128.0;
  pqVar1->pos_y = 512.0;
  pqVar1->template_id = 0xc;
  pqVar1->trigger_time_ms = 10000;
  pqVar1->count = 1;
  *count = iVar3 + 5;
  return;
}



/* quest_build_surrounded_by_reptiles @ 00438940 */

/* quest builder for Tier 3 Quest 5 (Surrounded By Reptiles) */

void __cdecl quest_build_surrounded_by_reptiles(quest_spawn_entry_t *entries,int *count)

{
  float fVar1;
  quest_spawn_entry_t *pqVar2;
  int iVar3;
  int iVar4;
  int local_4;
  
  iVar3 = 0;
  local_4 = 0;
  iVar4 = 1000;
  pqVar2 = entries;
  do {
    fVar1 = (float)local_4;
    pqVar2->pos_x = 256.0;
    iVar3 = iVar3 + 2;
    local_4 = local_4 + 0x200;
    fVar1 = fVar1 * 0.2 + 256.0;
    pqVar2->pos_y = fVar1;
    pqVar2->template_id = 0xd;
    pqVar2->trigger_time_ms = iVar4;
    pqVar2->count = 1;
    pqVar2[1].pos_x = 768.0;
    pqVar2[1].pos_y = fVar1;
    pqVar2[1].template_id = 0xd;
    pqVar2[1].trigger_time_ms = iVar4;
    pqVar2[1].count = 1;
    iVar4 = iVar4 + 800;
    pqVar2 = pqVar2 + 2;
  } while (iVar4 < 5000);
  local_4 = 0;
  iVar4 = 8000;
  pqVar2 = entries + iVar3;
  do {
    fVar1 = (float)local_4;
    pqVar2->pos_y = 256.0;
    iVar3 = iVar3 + 2;
    local_4 = local_4 + 0x200;
    fVar1 = fVar1 * 0.2 + 256.0;
    pqVar2->pos_x = fVar1;
    pqVar2->template_id = 0xd;
    pqVar2->trigger_time_ms = iVar4;
    pqVar2->count = 1;
    pqVar2[1].pos_y = 768.0;
    pqVar2[1].pos_x = fVar1;
    pqVar2[1].template_id = 0xd;
    pqVar2[1].trigger_time_ms = iVar4;
    pqVar2[1].count = 1;
    iVar4 = iVar4 + 800;
    pqVar2 = pqVar2 + 2;
  } while (iVar4 < 12000);
  *count = iVar3;
  return;
}



/* quest_build_the_unblitzkrieg @ 00438a40 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 4 Quest 6 (The Unblitzkrieg) */

void quest_build_the_unblitzkrieg(quest_spawn_entry_t *entries,int *count)

{
  quest_spawn_entry_t *pqVar1;
  int iVar2;
  uint uVar3;
  byte bVar4;
  int iVar5;
  int iVar6;
  int *piVar7;
  uint uVar8;
  
  iVar5 = 500;
  iVar6 = 0;
  piVar7 = &entries->template_id;
  uVar3 = 0;
  do {
    uVar8 = uVar3;
    ((quest_spawn_entry_t *)(piVar7 + -3))->pos_x = 824.0;
    iVar2 = iVar6 / 10;
    iVar6 = iVar6 + 0x270;
    piVar7[-2] = (int)(float)(iVar2 + 200);
    *piVar7 = (-(uint)((uVar8 & 1) != 0) & 6) + 7;
    piVar7[1] = iVar5;
    piVar7[2] = 1;
    iVar5 = iVar5 + 0x708;
    piVar7 = piVar7 + 6;
    uVar3 = uVar8 + 1;
  } while (iVar6 < 0x1860);
  iVar6 = 0;
  bVar4 = 0;
  piVar7 = &entries[uVar8 + 1].template_id;
  do {
    ((quest_spawn_entry_t *)(piVar7 + -3))->pos_x = (float)(0x338 - iVar6 / 10);
    piVar7[-2] = 0x444e0000;
    iVar6 = iVar6 + 0x270;
    *piVar7 = (-(uint)bVar4 & 6) + 7;
    piVar7[1] = iVar5;
    piVar7[2] = 1;
    iVar5 = iVar5 + 0x5dc;
    bVar4 = bVar4 ^ 1;
    piVar7 = piVar7 + 6;
  } while (iVar6 < 0x1860);
  iVar6 = 0;
  pqVar1 = entries + uVar8 + 0xb;
  bVar4 = 0;
  pqVar1->pos_x = 512.0;
  pqVar1->pos_y = 512.0;
  pqVar1->trigger_time_ms = iVar5;
  pqVar1->template_id = 7;
  pqVar1->count = 1;
  piVar7 = &entries[uVar8 + 0xc].template_id;
  do {
    ((quest_spawn_entry_t *)(piVar7 + -3))->pos_x = 200.0;
    piVar7[-2] = (int)(float)(0x338 - iVar6 / 10);
    iVar6 = iVar6 + 0x270;
    *piVar7 = (-(uint)bVar4 & 6) + 7;
    piVar7[1] = iVar5;
    piVar7[2] = 1;
    iVar5 = iVar5 + 0x4b0;
    bVar4 = bVar4 ^ 1;
    piVar7 = piVar7 + 6;
  } while (iVar6 < 0x1860);
  iVar6 = 0;
  bVar4 = 0;
  piVar7 = &entries[uVar8 + 0x16].template_id;
  do {
    ((quest_spawn_entry_t *)(piVar7 + -3))->pos_x = (float)(iVar6 / 10 + 200);
    piVar7[-2] = 0x43480000;
    iVar6 = iVar6 + 0x270;
    *piVar7 = (-(uint)bVar4 & 6) + 7;
    piVar7[1] = iVar5;
    piVar7[2] = 1;
    iVar5 = iVar5 + 800;
    bVar4 = bVar4 ^ 1;
    piVar7 = piVar7 + 6;
  } while (iVar6 < 0x1860);
  iVar6 = 0;
  bVar4 = 0;
  piVar7 = &entries[uVar8 + 0x20].template_id;
  do {
    ((quest_spawn_entry_t *)(piVar7 + -3))->pos_x = 824.0;
    piVar7[-2] = (int)(float)(iVar6 / 10 + 200);
    iVar6 = iVar6 + 0x270;
    *piVar7 = (-(uint)bVar4 & 6) + 7;
    piVar7[1] = iVar5;
    piVar7[2] = 1;
    iVar5 = iVar5 + 800;
    bVar4 = bVar4 ^ 1;
    piVar7 = piVar7 + 6;
  } while (iVar6 < 0x1860);
  iVar6 = 0;
  bVar4 = 0;
  piVar7 = &entries[uVar8 + 0x2a].template_id;
  do {
    ((quest_spawn_entry_t *)(piVar7 + -3))->pos_x = (float)(0x338 - iVar6 / 10);
    piVar7[-2] = 0x444e0000;
    iVar6 = iVar6 + 0x270;
    *piVar7 = (-(uint)bVar4 & 6) + 7;
    piVar7[1] = iVar5;
    piVar7[2] = 1;
    iVar5 = iVar5 + 700;
    bVar4 = bVar4 ^ 1;
    piVar7 = piVar7 + 6;
  } while (iVar6 < 0x1860);
  iVar6 = 0;
  bVar4 = 0;
  piVar7 = &entries[uVar8 + 0x34].template_id;
  do {
    ((quest_spawn_entry_t *)(piVar7 + -3))->pos_x = 200.0;
    piVar7[-2] = (int)(float)(0x338 - iVar6 / 10);
    iVar6 = iVar6 + 0x270;
    *piVar7 = (-(uint)bVar4 & 6) + 7;
    piVar7[1] = iVar5;
    piVar7[2] = 1;
    iVar5 = iVar5 + 700;
    bVar4 = bVar4 ^ 1;
    piVar7 = piVar7 + 6;
  } while (iVar6 < 0x1860);
  iVar6 = 0;
  bVar4 = 0;
  piVar7 = &entries[uVar8 + 0x3e].template_id;
  do {
    ((quest_spawn_entry_t *)(piVar7 + -3))->pos_x = (float)(iVar6 / 10 + 200);
    piVar7[-2] = 0x43480000;
    iVar6 = iVar6 + 0x270;
    *piVar7 = (-(uint)bVar4 & 6) + 7;
    piVar7[1] = iVar5;
    piVar7[2] = 1;
    iVar5 = iVar5 + 800;
    bVar4 = bVar4 ^ 1;
    piVar7 = piVar7 + 6;
  } while (iVar6 < 0x1860);
  *count = uVar8 + 0x48;
  return;
}



/* quest_build_the_end_of_all @ 00438e10 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 4 Quest 10 (The End of All) */

void quest_build_the_end_of_all(quest_spawn_entry_t *entries,int *count)

{
  float fVar1;
  bool bVar2;
  quest_spawn_entry_t *pqVar3;
  int *piVar4;
  int iVar5;
  quest_spawn_entry_t *pqVar6;
  int iVar7;
  float10 fVar8;
  float10 fVar9;
  
  pqVar3 = entries;
  entries->pos_x = 128.0;
  entries->pos_y = 128.0;
  entries->template_id = 0x3c;
  entries->trigger_time_ms = 3000;
  entries->count = 1;
  entries[1].pos_x = 896.0;
  entries[1].pos_y = 128.0;
  entries[1].template_id = 0x3c;
  entries[1].trigger_time_ms = 6000;
  entries[1].count = 1;
  entries[2].pos_x = 128.0;
  entries[2].pos_y = 896.0;
  entries[2].template_id = 0x3c;
  entries[2].trigger_time_ms = 9000;
  entries[2].count = 1;
  entries[3].pos_x = 896.0;
  entries[3].pos_y = 896.0;
  entries[3].template_id = 0x3c;
  entries[3].trigger_time_ms = 12000;
  entries[3].count = 1;
  entries = (quest_spawn_entry_t *)0x0;
  iVar5 = 13000;
  piVar4 = &pqVar3[4].template_id;
  do {
    pqVar6 = (quest_spawn_entry_t *)((int)&entries->pos_x + 1);
    fVar8 = (float10)fcos((float10)(int)entries * (float10)1.0471976);
    ((quest_spawn_entry_t *)(piVar4 + -3))->pos_x = (float)(fVar8 * (float10)80.0 + (float10)512.0);
    fVar8 = (float10)fsin((float10)(int)entries * (float10)1.0471976);
    piVar4[-2] = (int)(float)(fVar8 * (float10)80.0 + (float10)512.0);
    *piVar4 = 7;
    piVar4[1] = iVar5;
    piVar4[2] = 1;
    iVar5 = iVar5 + 300;
    piVar4 = piVar4 + 6;
    entries = pqVar6;
  } while (iVar5 < 0x39d0);
  iVar5 = 18000;
  pqVar3[10].pos_x = 512.0;
  pqVar3[10].pos_y = 512.0;
  pqVar3[10].template_id = 0xb;
  entries = (quest_spawn_entry_t *)0x100;
  pqVar3[10].trigger_time_ms = (int)pqVar6 * 300 + 13000;
  pqVar3[10].count = 1;
  bVar2 = false;
  piVar4 = &pqVar3[0xb].template_id;
  do {
    if (bVar2) {
      ((quest_spawn_entry_t *)(piVar4 + -3))->pos_x = 1152.0;
    }
    else {
      ((quest_spawn_entry_t *)(piVar4 + -3))->pos_x = -128.0;
    }
    fVar1 = (float)(int)entries;
    entries = (quest_spawn_entry_t *)&entries[5].heading;
    bVar2 = (bool)(bVar2 ^ 1);
    piVar4[-2] = (int)fVar1;
    *piVar4 = 0x3c;
    piVar4[1] = iVar5;
    piVar4[2] = 2;
    iVar5 = iVar5 + 1000;
    piVar4 = piVar4 + 6;
  } while ((int)entries < 0x300);
  iVar5 = 43000;
  entries = (quest_spawn_entry_t *)0x0;
  iVar7 = 0x15;
  piVar4 = &pqVar3[0xf].template_id;
  do {
    fVar8 = (float10)(int)entries;
    entries = (quest_spawn_entry_t *)((int)&entries->pos_x + 1);
    fVar8 = fVar8 * (float10)1.0471976 + (float10)0.5235988;
    fVar9 = (float10)fcos(fVar8);
    ((quest_spawn_entry_t *)(piVar4 + -3))->pos_x = (float)(fVar9 * (float10)80.0 + (float10)512.0);
    fVar8 = (float10)fsin(fVar8);
    piVar4[-2] = (int)(float)(fVar8 * (float10)80.0 + (float10)512.0);
    *piVar4 = 7;
    piVar4[1] = iVar5;
    piVar4[2] = 1;
    iVar5 = iVar5 + 300;
    piVar4 = piVar4 + 6;
  } while (iVar5 < 0xaf00);
  if (config_blob.hardcore != '\0') {
    entries = (quest_spawn_entry_t *)0x0;
    iVar5 = 0xf550;
    iVar7 = 0x21;
    piVar4 = &pqVar3[0x15].template_id;
    do {
      fVar8 = (float10)(int)entries;
      entries = (quest_spawn_entry_t *)((int)&entries->pos_x + 1);
      fVar8 = (fVar8 + (float10)1.0) * (float10)0.5235988;
      fVar9 = (float10)fcos(fVar8);
      ((quest_spawn_entry_t *)(piVar4 + -3))->pos_x =
           (float)(fVar9 * (float10)180.0 + (float10)512.0);
      fVar8 = (float10)fsin(fVar8);
      piVar4[-2] = (int)(float)(fVar8 * (float10)180.0 + (float10)512.0);
      *piVar4 = 7;
      piVar4[1] = iVar5;
      piVar4[2] = 1;
      iVar5 = iVar5 + 500;
      piVar4 = piVar4 + 6;
    } while (iVar5 < 0x10cc0);
  }
  bVar2 = false;
  iVar5 = 48000;
  entries = (quest_spawn_entry_t *)0x100;
  piVar4 = &pqVar3[iVar7].template_id;
  do {
    if (bVar2) {
      ((quest_spawn_entry_t *)(piVar4 + -3))->pos_x = 1152.0;
    }
    else {
      ((quest_spawn_entry_t *)(piVar4 + -3))->pos_x = -128.0;
    }
    fVar1 = (float)(int)entries;
    entries = (quest_spawn_entry_t *)&entries[5].heading;
    bVar2 = (bool)(bVar2 ^ 1);
    piVar4[-2] = (int)fVar1;
    *piVar4 = 0x3c;
    piVar4[1] = iVar5;
    piVar4[2] = 2;
    iVar5 = iVar5 + 1000;
    piVar4 = piVar4 + 6;
  } while ((int)entries < 0x300);
  *count = iVar7 + 4;
  return;
}



/* quest_build_spiders_inc @ 004390d0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* quest builder for Tier 3 Quest 7 (Spiders Inc.) */

void quest_build_spiders_inc(quest_spawn_entry_t *entries,int *count)

{
  int iVar1;
  quest_spawn_entry_t *pqVar2;
  quest_spawn_entry_t *pqVar3;
  int iVar4;
  int iVar5;
  
  pqVar3 = entries;
  entries->pos_y = (float)(terrain_texture_width + 0x40);
  entries->pos_x = (float)(terrain_texture_width / 2);
  entries->template_id = 0x38;
  entries->trigger_time_ms = 500;
  entries->count = 1;
  entries[1].pos_y = (float)(terrain_texture_width + 0x40);
  entries[1].pos_x = (float)(terrain_texture_width / 2 + 0x40);
  entries[1].template_id = 0x38;
  entries[1].trigger_time_ms = 500;
  entries[1].count = 1;
  entries[2].pos_y = -64.0;
  iVar4 = 17000;
  entries = (quest_spawn_entry_t *)0x0;
  pqVar3[2].pos_x = (float)(terrain_texture_width / 2);
  pqVar3[2].template_id = 0x40;
  pqVar3[2].trigger_time_ms = 500;
  pqVar3[2].count = 4;
  iVar5 = 3;
  do {
    iVar1 = (int)entries / 2 + 3;
    pqVar2 = pqVar3 + iVar5;
    pqVar2->pos_y = (float)(terrain_texture_width + 0x40);
    pqVar2->pos_x = (float)(terrain_texture_width / 2);
    pqVar2->template_id = 0x38;
    pqVar2->trigger_time_ms = iVar4;
    pqVar2->count = iVar1;
    pqVar2 = pqVar3 + iVar5 + 1;
    pqVar2->pos_y = -64.0;
    iVar5 = iVar5 + 2;
    pqVar2->pos_x = (float)(terrain_texture_width / 2);
    pqVar2->template_id = 0x38;
    pqVar2->trigger_time_ms = iVar4;
    pqVar2->count = iVar1;
    iVar4 = iVar4 + 6000;
    entries = (quest_spawn_entry_t *)((int)&entries->pos_x + 1);
  } while (iVar4 < 0x1a1f8);
  *count = iVar5;
  return;
}



/* quest_database_init @ 00439230 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* builds the quest metadata table and registers quest builders */

void quest_database_init(void)

{
  int local_8;
  int local_4;
  
  local_8 = 0;
  local_4 = 0;
  FUN_00430a20((int *)&quest_selected_meta,1,1,s_Land_Hostile_00477adc);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 120000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_land_hostile;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Minor_Alien_Breach_00477ac8);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 120000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_minor_alien_breach;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Target_Practice_00477ab8);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 65000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_target_practice;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Frontline_Assault_00477aa4);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_frontline_assault;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Alien_Dens_00477a98);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 180000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_alien_dens;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Random_Factor_00477a84);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_random_factor;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Spider_Wave_Syndrome_00477a6c);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 240000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_spider_wave_syndrome;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Alien_Squads_00477a5c);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 180000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_alien_squads;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Nesting_Grounds_00477a4c);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 240000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_nesting_grounds;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_8_legged_Terror_00477a3c);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 240000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_8_legged_terror;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Everred_Pastures_00477a28);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_everred_pastures;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Spider_Spawns_00477a18);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_spider_spawns;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Arachnoid_Farm_00477a08);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 240000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_arachnoid_farm;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Two_Fronts_004779fc);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 240000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_two_fronts;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Sweep_Stakes_004779ec);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 6;
  *(undefined4 *)(quest_meta_cursor + 8) = 35000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_sweep_stakes;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Evil_Zombies_At_Large_004779d4);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 180000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_evil_zombies_at_large;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Survival_Of_The_Fastest_004779bc);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 5;
  *(undefined4 *)(quest_meta_cursor + 8) = 120000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_survival_of_the_fastest;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Land_Of_Lizards_004779ac);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 180000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_land_of_lizards;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Ghost_Patrols_0047799c);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 180000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_ghost_patrols;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Spideroids_00477990);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 360000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_spideroids;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Blighting_00477980);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_blighting;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Lizard_Kings_00477970);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 180000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_lizard_kings;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Killing_00477964);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_killing;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Hidden_Evil_00477958);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_hidden_evil;
  quest_monster_vision_meta = quest_meta_cursor;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Surrounded_By_Reptiles_00477940);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_surrounded_by_reptiles;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Lizquidation_0047792c);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_lizquidation;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Spiders_Inc__0047791c);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 0xb;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_spiders_inc;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Lizard_Raze_00477910);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_lizard_raze;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Deja_vu_00477908);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 6;
  *(undefined4 *)(quest_meta_cursor + 8) = 120000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_deja_vu;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Zombie_Masters_004778f8);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_zombie_masters;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Major_Alien_Breach_004778e4);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 0x12;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_major_alien_breach;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Zombie_Time_004778d8);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_zombie_time;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Lizard_Zombie_Pact_004778c4);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_lizard_zombie_pact;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Collaboration_004778b0);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 360000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_collaboration;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Massacre_004778a0);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_massacre;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Unblitzkrieg_0047788c);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 600000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_unblitzkrieg;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Gauntlet_00477880);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_gauntlet;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Syntax_Terror_00477870);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_syntax_terror;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Annihilation_0047785c);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 300000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_annihilation;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_End_of_All_0047784c);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 480000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_end_of_all;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Beating_00477840);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 480000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_beating;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Spanking_Of_The_Dead_00477824);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 480000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_spanking_of_the_dead;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Fortress_00477814);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 480000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_fortress;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Gang_Wars_00477804);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 480000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_gang_wars;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Knee_deep_in_the_Dead_004777ec);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 480000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_knee_deep_in_the_dead;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Cross_Fire_004777e0);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 480000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_cross_fire;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Army_of_Three_004777d0);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 480000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_army_of_three;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Monster_Blues_004777c0);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 480000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_monster_blues;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_Nagolipoli_004777b4);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 480000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_nagolipoli;
  quest_database_advance_slot(&local_4,&local_8);
  FUN_00430a20((int *)(&quest_selected_meta + (local_8 + local_4 * 10) * 0x2c),local_4 + 1,
               local_8 + 1,s_The_Gathering_004777a4);
  *(undefined4 *)(quest_meta_cursor + 0x28) = 1;
  *(undefined4 *)(quest_meta_cursor + 8) = 480000;
  *(code **)(quest_meta_cursor + 0x1c) = quest_build_the_gathering;
  quest_database_advance_slot(&local_4,&local_8);
  quest_unlock_weapon_id = 2;
  DAT_00484780 = 3;
  _DAT_004847ac = 0;
  _DAT_004847d8 = 8;
  _DAT_00484804 = 0;
  _DAT_00484830 = 5;
  _DAT_0048485c = 0;
  _DAT_00484888 = 6;
  _DAT_004848b4 = 0;
  _DAT_004848e0 = 0xc;
  _DAT_0048490c = 0;
  _DAT_00484938 = 9;
  _DAT_00484964 = 0;
  _DAT_00484990 = 0x15;
  _DAT_004849bc = 0;
  _DAT_004849e8 = 7;
  _DAT_00484a14 = 0;
  _DAT_00484a40 = 4;
  _DAT_00484a6c = 0;
  _DAT_00484a98 = 0xb;
  _DAT_00484ac4 = 0;
  _DAT_00484af0 = 10;
  _DAT_00484b1c = 0;
  _DAT_00484b48 = 0xd;
  _DAT_00484b74 = 0;
  _DAT_00484ba0 = 0xf;
  _DAT_00484bcc = 0;
  _DAT_00484bf8 = 0x12;
  _DAT_00484c24 = 0;
  _DAT_00484c50 = 0x14;
  _DAT_00484c7c = 0;
  _DAT_00484ca8 = 0x13;
  _DAT_00484cd4 = 0;
  _DAT_00484d00 = 0xe;
  _DAT_00484d2c = 0;
  _DAT_00484d58 = 0x11;
  _DAT_00484d84 = 0;
  _DAT_00484db0 = 0x16;
  _DAT_00484ddc = 0;
  _DAT_00484e08 = 0x17;
  quest_unlock_perk_id = perk_id_antiperk;
  DAT_0048477c = perk_id_antiperk;
  _DAT_004847a8 = 0x1c;
  _DAT_004847d4 = perk_id_antiperk;
  _DAT_00484800 = 0x1d;
  _DAT_0048482c = perk_id_antiperk;
  _DAT_00484858 = 0x1e;
  _DAT_00484884 = perk_id_antiperk;
  _DAT_004848b0 = 0x1f;
  _DAT_004848dc = perk_id_antiperk;
  _DAT_00484908 = 0x20;
  _DAT_00484934 = perk_id_antiperk;
  _DAT_00484960 = 0x21;
  _DAT_0048498c = perk_id_antiperk;
  _DAT_004849b8 = 0x22;
  _DAT_004849e4 = perk_id_antiperk;
  _DAT_00484a10 = 0x23;
  _DAT_00484a3c = perk_id_antiperk;
  _DAT_00484a68 = 0x24;
  _DAT_00484a94 = perk_id_antiperk;
  _DAT_00484ac0 = 0x25;
  _DAT_00484aec = perk_id_antiperk;
  _DAT_00484b18 = 0x26;
  _DAT_00484b44 = perk_id_antiperk;
  _DAT_00484b70 = 0x27;
  _DAT_00484b9c = perk_id_antiperk;
  _DAT_00484bc8 = 0x28;
  _DAT_00484bf4 = perk_id_antiperk;
  _DAT_00484c20 = 0x29;
  _DAT_00484c4c = perk_id_antiperk;
  _DAT_00484c78 = 0x2a;
  _DAT_00484ca4 = perk_id_antiperk;
  _DAT_00484cd0 = 0x2b;
  _DAT_00484cfc = perk_id_antiperk;
  _DAT_00484d28 = 0x2c;
  _DAT_00484d54 = perk_id_antiperk;
  _DAT_00484d80 = 0x2d;
  _DAT_00484dac = perk_id_antiperk;
  _DAT_00484dd8 = 0x2e;
  _DAT_00484e04 = perk_id_antiperk;
  _DAT_00484e34 = 0x1f;
  _DAT_00484e30 = perk_id_antiperk;
  _DAT_00484e60 = 0;
  _DAT_00484e5c = 0x2f;
  _DAT_00484e8c = 0;
  _DAT_00484e88 = 0x30;
  _DAT_00484eb8 = 0x1e;
  _DAT_00484eb4 = perk_id_antiperk;
  _DAT_00484ee4 = 0;
  _DAT_00484ee0 = 0x31;
  _DAT_00484f10 = 0;
  _DAT_00484f0c = 0x32;
  _DAT_00484f3c = 0;
  _DAT_00484f38 = perk_id_antiperk;
  _DAT_00484f68 = 0;
  _DAT_00484f64 = 0x33;
  _DAT_00484f94 = 0;
  _DAT_00484f90 = 0x34;
  _DAT_00484fc0 = 0x1c;
  _DAT_00484fbc = perk_id_antiperk;
  return;
}



/* quest_start_selected @ 0043a790 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* resets quest state, selects quest metadata, and runs its builder */

void __cdecl quest_start_selected(int tier,int index)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  FUN_004281e0();
  quest_spawn_count = 0;
  quest_spawn_timeline = 0;
  DAT_00487244 = 0;
  fx_queue_rotated = 0;
  fx_queue_count = 0;
  highscore_active_record.full_version_marker = '\0';
  highscore_active_record.survival_elapsed_ms = 0;
  highscore_active_record.score_xp = 0;
  highscore_active_record.quest_stage_minor = '\0';
  highscore_active_record.quest_stage_major = '\0';
  highscore_active_record.game_mode_id = '\0';
  highscore_active_record.most_used_weapon_id = '\0';
  highscore_active_record.creature_kill_count = 0;
  highscore_active_record.shots_hit = 0;
  highscore_active_record.shots_fired = 0;
  highscore_active_record.date_checksum = '\0';
  highscore_active_record.year_offset = '\0';
  highscore_active_record.month = '\0';
  highscore_active_record.day = '\0';
  highscore_active_record.flags = '\0';
  uVar1 = crt_rand();
  highscore_active_record.reserved0._0_4_ = uVar1 & 0xfee050f;
  projectile_reset_pools();
  player_pos_x = (float)terrain_texture_width * 0.5;
  player_pos_y = (float)terrain_texture_height * 0.5;
  iVar4 = (index + -0xb + tier * 10) * 0x2c;
  terrain_generate(&quest_selected_meta + iVar4);
  weapon_assign_player(0,*(int *)(&quest_start_weapon_id + iVar4));
  weapon_assign_player(1,*(int *)(&quest_start_weapon_id + iVar4));
  console_printf(&console_log_queue,s_Setup_tier__d_quest__d__00477aec,tier,index);
  if (*(code **)(&quest_selected_builder + iVar4) == (code *)0x0) {
    quest_build_fallback(&quest_spawn_table,&quest_spawn_count);
  }
  else {
    (**(code **)(&quest_selected_builder + iVar4))();
  }
  iVar6 = 0;
  iVar4 = 0;
  _DAT_00486fd4 = 0;
  _DAT_00487030 = 0;
  if (0 < quest_spawn_count) {
    piVar2 = &quest_spawn_table.count;
    iVar3 = quest_spawn_count;
    do {
      if (((config_blob.hardcore != '\0') && (iVar5 = *piVar2, 1 < iVar5)) && (piVar2[-2] != 0x3c))
      {
        if (piVar2[-2] == 0x2b) {
          iVar5 = iVar5 + 2;
        }
        else {
          iVar5 = iVar5 + 8;
        }
        *piVar2 = iVar5;
      }
      iVar6 = iVar6 + *piVar2;
      if (iVar4 < piVar2[-1]) {
        iVar4 = piVar2[-1];
      }
      piVar2 = piVar2 + 6;
      iVar3 = iVar3 + -1;
      _DAT_00486fd4 = iVar6;
      _DAT_00487030 = iVar4;
    } while (iVar3 != 0);
  }
  return;
}



/* highscore_date_checksum @ 0043a950 */

/* computes a week-of-year style checksum for high score validation */

int __cdecl highscore_date_checksum(int year,int month,int day)

{
  int iVar1;
  int iVar2;
  
  iVar1 = (0xe - month) / 0xc;
  iVar2 = (year - iVar1) + 0x12c0;
  iVar1 = ((int)(iVar2 + (iVar2 >> 0x1f & 3U)) >> 2) + -0x7d2d +
          day + ((iVar2 / 400 + ((month + iVar1 * 0xc) * 0x99 + -0x1c9) / 5 + iVar2 * 0x16d) -
                iVar2 / 100);
  iVar2 = ((((iVar1 - iVar1 % 7) + 0x7bfd) % 0x23ab1) % 0x8eac) % 0x5b5;
  iVar1 = iVar2 / 0x5b4;
  return ((iVar2 - iVar1) % 0x16d + iVar1) / 7 + 1;
}



/* FUN_0043aa60 @ 0043aa60 */

undefined4 FUN_0043aa60(void)

{
  int iVar1;
  uint3 extraout_var;
  
  iVar1 = game_is_full_version();
  if ((char)iVar1 == '\0') {
    console_printf(&console_log_queue,s___Potentially_illegal_score_dete_00477b16 + 2);
    iVar1 = (uint)extraout_var << 8;
  }
  return CONCAT31((int3)((uint)iVar1 >> 8),1);
}



/* FUN_0043aa90 @ 0043aa90 */

/* [binja] void* sub_43aa90(void* arg1, void* arg2) */

void * __cdecl FUN_0043aa90(void *arg1,void *arg2)

{
  char cVar1;
  uint uVar2;
  uint uVar3;
  char *pcVar4;
  char *pcVar5;
  
  uVar2 = 0xffffffff;
  pcVar4 = arg1;
  do {
    pcVar5 = pcVar4;
    if (uVar2 == 0) break;
    uVar2 = uVar2 - 1;
    pcVar5 = pcVar4 + 1;
    cVar1 = *pcVar4;
    pcVar4 = pcVar5;
  } while (cVar1 != '\0');
  uVar2 = ~uVar2;
  pcVar4 = pcVar5 + -uVar2;
  pcVar5 = arg2;
  for (uVar3 = uVar2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
    pcVar4 = pcVar4 + 4;
    pcVar5 = pcVar5 + 4;
  }
  for (uVar2 = uVar2 & 3; uVar2 != 0; uVar2 = uVar2 - 1) {
    *pcVar5 = *pcVar4;
    pcVar4 = pcVar4 + 1;
    pcVar5 = pcVar5 + 1;
  }
  *(undefined4 *)((int)arg2 + 0x20) = *(undefined4 *)((int)arg1 + 0x20);
  *(undefined4 *)((int)arg2 + 0x24) = *(undefined4 *)((int)arg1 + 0x24);
  *(undefined1 *)((int)arg2 + 0x28) = *(undefined1 *)((int)arg1 + 0x28);
  *(undefined1 *)((int)arg2 + 0x29) = *(undefined1 *)((int)arg1 + 0x29);
  *(undefined1 *)((int)arg2 + 0x2a) = *(undefined1 *)((int)arg1 + 0x2a);
  *(undefined1 *)((int)arg2 + 0x2b) = *(undefined1 *)((int)arg1 + 0x2b);
  *(undefined4 *)((int)arg2 + 0x2c) = *(undefined4 *)((int)arg1 + 0x2c);
  *(undefined4 *)((int)arg2 + 0x34) = *(undefined4 *)((int)arg1 + 0x34);
  *(undefined4 *)((int)arg2 + 0x30) = *(undefined4 *)((int)arg1 + 0x30);
  *(undefined4 *)((int)arg2 + 0x38) = *(undefined4 *)((int)arg1 + 0x38);
  *(undefined4 *)((int)arg2 + 0x3c) = 0;
  return arg2;
}



/* highscore_read_record @ 0043ab10 */

/* reads and validates a high score record from a file */

char * __cdecl highscore_read_record(char *buffer,FILE *fp)

{
  uint uVar1;
  char *pcVar2;
  int iVar3;
  int iVar4;
  int local_4;
  
  iVar3 = 0;
  local_4 = 0;
  crt_fread(buffer,0x48,1,fp);
  if ((fp->_flag & 0x10) != 0) {
    return (char *)0x0;
  }
  crt_fread(&local_4,4,1,fp);
  uVar1 = 0;
  do {
    buffer[uVar1] = buffer[uVar1] + (-6 - ((char)uVar1 * '\x05' + '\x01') * (char)uVar1);
    uVar1 = uVar1 + 1;
  } while (uVar1 < 0x48);
  iVar4 = 0x48;
  pcVar2 = buffer;
  do {
    iVar3 = iVar3 + (int)(pcVar2 + (3 - (int)buffer)) * (int)*pcVar2 * 7;
    pcVar2 = pcVar2 + 1;
    iVar4 = iVar4 + -1;
  } while (iVar4 != 0);
  if (local_4 != iVar3) {
    buffer[0x1f] = '\0';
    console_printf(&console_log_queue,s_WARN__checksum_failure_on_score_b_00477b40,buffer);
    return (char *)0x0;
  }
  return buffer;
}



/* highscore_record_equals @ 0043abd0 */

/* compares high score record metadata and name for equality */

int __cdecl highscore_record_equals(byte *left,byte *right)

{
  byte bVar1;
  uint3 uVar3;
  int iVar2;
  bool bVar4;
  
  uVar3 = (uint3)((uint)left >> 8);
  if (*(int *)(left + 0x24) != *(int *)(right + 0x24)) {
    return (uint)uVar3 << 8;
  }
  if (*(int *)(left + 0x20) != *(int *)(right + 0x20)) {
    return (uint)uVar3 << 8;
  }
  if (left[0x28] != right[0x28]) {
    return (uint)uVar3 << 8;
  }
  if (*(int *)(left + 0x34) != *(int *)(right + 0x34)) {
    return (uint)uVar3 << 8;
  }
  if (*(int *)(left + 0x30) != *(int *)(right + 0x30)) {
    return (uint)uVar3 << 8;
  }
  if (*(int *)(left + 0x2c) != *(int *)(right + 0x2c)) {
    return (uint)uVar3 << 8;
  }
  while( true ) {
    bVar1 = *left;
    bVar4 = bVar1 < *right;
    if (bVar1 != *right) break;
    if (bVar1 == 0) {
      return 1;
    }
    bVar1 = left[1];
    bVar4 = bVar1 < right[1];
    if (bVar1 != right[1]) break;
    left = left + 2;
    right = right + 2;
    if (bVar1 == 0) {
      return 1;
    }
  }
  iVar2 = (1 - (uint)bVar4) - (uint)(bVar4 != 0);
  return CONCAT31((int3)((uint)iVar2 >> 8),iVar2 == 0);
}



/* highscore_update_record @ 0043ac70 */

/* updates a matching record in the high score file when allowed */

int __cdecl highscore_update_record(char *path,byte *record)

{
  char cVar1;
  byte bVar2;
  FILE *fp;
  char *pcVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  byte *pbVar7;
  char *pcVar8;
  byte *pbVar9;
  byte local_48 [56];
  uint local_10;
  byte local_4;
  undefined1 local_2;
  undefined1 local_1;
  
  pbVar7 = local_48;
  for (iVar4 = 0x12; iVar4 != 0; iVar4 = iVar4 + -1) {
    pbVar7[0] = 0;
    pbVar7[1] = 0;
    pbVar7[2] = 0;
    pbVar7[3] = 0;
    pbVar7 = pbVar7 + 4;
  }
  uVar5 = 0xffffffff;
  pcVar3 = &default_player_name;
  do {
    pcVar8 = pcVar3;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar3 + 1;
    cVar1 = *pcVar3;
    pcVar3 = pcVar8;
  } while (cVar1 != '\0');
  uVar5 = ~uVar5;
  pbVar7 = (byte *)(pcVar8 + -uVar5);
  pbVar9 = local_48;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pbVar9 = *(undefined4 *)pbVar7;
    pbVar7 = pbVar7 + 4;
    pbVar9 = pbVar9 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pbVar9 = *pbVar7;
    pbVar7 = pbVar7 + 1;
    pbVar9 = pbVar9 + 1;
  }
  local_4 = 0;
  local_2 = 0x7c;
  local_1 = 0xff;
  local_10 = crt_rand();
  local_10 = local_10 & 0xfee050f;
  fp = crt_fopen(path,&DAT_00477b68);
  uVar5 = 0;
  if (fp != (FILE *)0x0) {
    bVar2 = (byte)fp->_flag;
    while ((bVar2 & 0x10) == 0) {
      pcVar3 = highscore_read_record((char *)local_48,fp);
      if ((pcVar3 != (char *)0x0) &&
         (iVar4 = highscore_record_equals(record,local_48), (char)iVar4 != '\0')) {
        if ((local_4 & 2) != 0) {
          iVar4 = crt_fclose(fp);
          return CONCAT31((int3)((uint)iVar4 >> 8),1);
        }
        if (local_4 == 0) {
          record[0x44] = 2;
        }
        crt_fseek(fp,-0x4c,1);
        highscore_write_record(record,fp);
        crt_fflush(fp);
        iVar4 = crt_fclose(fp);
        return CONCAT31((int3)((uint)iVar4 >> 8),1);
      }
      bVar2 = (byte)fp->_flag;
    }
    crt_fflush(fp);
    uVar5 = crt_fclose(fp);
  }
  return uVar5 & 0xffffff00;
}



/* highscore_write_record @ 0043ad70 */

/* writes a high score record with date + checksum */

void __cdecl highscore_write_record(byte *record,FILE *fp)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  char *pcVar5;
  char *pcVar6;
  int local_4c;
  char local_48 [56];
  uint local_10;
  undefined1 local_4;
  undefined1 local_2;
  undefined1 local_1;
  
  local_4c = 0;
  GetLocalTime((LPSYSTEMTIME)&local_system_time);
  pcVar5 = local_48;
  for (iVar2 = 0x12; iVar2 != 0; iVar2 = iVar2 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5 = pcVar5 + 4;
  }
  uVar3 = 0xffffffff;
  pcVar5 = &default_player_name;
  do {
    pcVar6 = pcVar5;
    if (uVar3 == 0) break;
    uVar3 = uVar3 - 1;
    pcVar6 = pcVar5 + 1;
    cVar1 = *pcVar5;
    pcVar5 = pcVar6;
  } while (cVar1 != '\0');
  uVar3 = ~uVar3;
  pcVar5 = pcVar6 + -uVar3;
  pcVar6 = local_48;
  for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
    *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
    pcVar5 = pcVar5 + 4;
    pcVar6 = pcVar6 + 4;
  }
  for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *pcVar6 = *pcVar5;
    pcVar5 = pcVar5 + 1;
    pcVar6 = pcVar6 + 1;
  }
  local_4 = 0;
  local_2 = 0x7c;
  local_1 = 0xff;
  uVar3 = crt_rand();
  local_10 = uVar3 & 0xfee050f;
  if (record[0x40] == 0) {
    record[0x40] = (byte)local_system_day;
    record[0x42] = local_system_time._2_1_;
    record[0x43] = (char)local_system_time + 0x30;
    iVar2 = highscore_date_checksum
                      (local_system_time & 0xffff,local_system_time >> 0x10,(uint)local_system_day);
    record[0x41] = (byte)iVar2;
  }
  pcVar5 = local_48;
  for (iVar2 = 0x12; iVar2 != 0; iVar2 = iVar2 + -1) {
    *(undefined4 *)pcVar5 = *(undefined4 *)record;
    record = record + 4;
    pcVar5 = pcVar5 + 4;
  }
  uVar3 = 0;
  do {
    local_4c = local_4c + (int)(local_48 + uVar3 + (3 - (int)local_48)) * (int)local_48[uVar3] * 7;
    uVar3 = uVar3 + 1;
  } while (uVar3 < 0x48);
  uVar3 = 0;
  do {
    local_48[uVar3] = local_48[uVar3] + ((char)uVar3 * '\x05' + '\x01') * (char)uVar3 + '\x06';
    uVar3 = uVar3 + 1;
  } while (uVar3 < 0x48);
  crt_fwrite(local_48,0x48,1,fp);
  crt_fwrite(&local_4c,4,1,fp);
  return;
}



/* highscore_compare_survival_score_desc @ 0043aeb0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* qsort comparator used by highscore_load_table() for survival mode; sorts descending by dword at
   offset 0x24 */

int highscore_compare_survival_score_desc(void *a,void *b)

{
  if (*(int *)((int)b + 0x24) < *(int *)((int)a + 0x24)) {
    return -1;
  }
  return (uint)(*(int *)((int)a + 0x24) < *(int *)((int)b + 0x24));
}



/* highscore_compare_rush_field32_desc @ 0043aed0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* qsort comparator used by highscore_load_table() for rush mode; sorts descending by dword at
   offset 0x20 */

int highscore_compare_rush_field32_desc(void *a,void *b)

{
  if (*(int *)((int)b + 0x20) < *(int *)((int)a + 0x20)) {
    return -1;
  }
  return (uint)(*(int *)((int)a + 0x20) < *(int *)((int)b + 0x20));
}



/* highscore_compare_quest_field32_asc_nonzero_first @ 0043aef0 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* qsort comparator used by highscore_load_table() for quest mode; sorts ascending by dword at
   offset 0x20, treating 0 as "missing" (sorted last) */

int highscore_compare_quest_field32_asc_nonzero_first(void *a,void *b)

{
  int iVar1;
  int iVar2;
  
  iVar1 = *(int *)((int)a + 0x20);
  if (iVar1 == 0) {
    return 1;
  }
  iVar2 = *(int *)((int)b + 0x20);
  if (iVar2 == 0) {
    return -1;
  }
  if (iVar2 < iVar1) {
    return 1;
  }
  return (iVar2 <= iVar1) - 1;
}



/* highscore_find_name_entry @ 0043af30 */

/* finds a matching name entry in the loaded high score table */

byte * __cdecl highscore_find_name_entry(byte *record,int count)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  int iVar4;
  highscore_record_t *phVar5;
  highscore_record_t *phVar6;
  bool bVar7;
  
  iVar4 = 0;
  if (0 < count) {
    phVar5 = &highscore_table;
    pbVar2 = record;
    phVar6 = phVar5;
LAB_0043af49:
    do {
      bVar1 = *pbVar2;
      bVar7 = bVar1 < (byte)phVar5->player_name[0];
      if (bVar1 == phVar5->player_name[0]) {
        if (bVar1 != 0) {
          bVar1 = pbVar2[1];
          bVar7 = bVar1 < (byte)phVar5->player_name[1];
          if (bVar1 != phVar5->player_name[1]) goto LAB_0043af6d;
          phVar5 = (highscore_record_t *)(phVar5->player_name + 2);
          pbVar2 = pbVar2 + 2;
          if (bVar1 != 0) goto LAB_0043af49;
        }
        iVar3 = 0;
      }
      else {
LAB_0043af6d:
        iVar3 = (1 - (uint)bVar7) - (uint)(bVar7 != 0);
      }
      if (iVar3 == 0) {
        return (byte *)(&highscore_table + iVar4);
      }
      iVar4 = iVar4 + 1;
      phVar5 = phVar6 + 1;
      pbVar2 = record;
      phVar6 = phVar5;
    } while (iVar4 < count);
  }
  return (byte *)0x0;
}



/* highscore_load_table @ 0043afa0 */

/* loads, filters, and sorts the high score table */

void highscore_load_table(void)

{
  char cVar1;
  byte bVar2;
  char *pcVar3;
  FILE *fp;
  byte *pbVar4;
  highscore_record_t *phVar5;
  char *pcVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  uint uVar10;
  int iVar11;
  uchar *puVar12;
  int iVar13;
  byte *pbVar14;
  char *pcVar15;
  highscore_record_t *phVar16;
  bool bVar17;
  code *cmp;
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  byte local_48 [40];
  uint local_20;
  uint local_10;
  byte local_8;
  undefined1 local_7;
  byte bStack_6;
  undefined1 uStack_5;
  byte bStack_4;
  char cStack_3;
  undefined1 uStack_2;
  undefined1 local_1;
  
  pbVar4 = local_48;
  for (iVar8 = 0x12; iVar8 != 0; iVar8 = iVar8 + -1) {
    pbVar4[0] = 0;
    pbVar4[1] = 0;
    pbVar4[2] = 0;
    pbVar4[3] = 0;
    pbVar4 = pbVar4 + 4;
  }
  uVar9 = 0xffffffff;
  pcVar3 = &default_player_name;
  do {
    pcVar6 = pcVar3;
    if (uVar9 == 0) break;
    uVar9 = uVar9 - 1;
    pcVar6 = pcVar3 + 1;
    cVar1 = *pcVar3;
    pcVar3 = pcVar6;
  } while (cVar1 != '\0');
  uVar9 = ~uVar9;
  pbVar4 = (byte *)(pcVar6 + -uVar9);
  pbVar14 = local_48;
  for (uVar10 = uVar9 >> 2; uVar10 != 0; uVar10 = uVar10 - 1) {
    *(undefined4 *)pbVar14 = *(undefined4 *)pbVar4;
    pbVar4 = pbVar4 + 4;
    pbVar14 = pbVar14 + 4;
  }
  for (uVar9 = uVar9 & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
    *pbVar14 = *pbVar4;
    pbVar4 = pbVar4 + 1;
    pbVar14 = pbVar14 + 1;
  }
  bStack_4 = 0;
  uStack_2 = 0x7c;
  local_1 = 0xff;
  local_10 = crt_rand();
  local_10 = local_10 & 0xfee050f;
  pcVar3 = highscore_build_path();
  DAT_004c395c = 0;
  puVar12 = &highscore_table.sentinel_pipe;
  do {
    phVar16 = (highscore_record_t *)(puVar12 + -0x46);
    for (iVar8 = 0x12; iVar8 != 0; iVar8 = iVar8 + -1) {
      phVar16->player_name[0] = '\0';
      phVar16->player_name[1] = '\0';
      phVar16->player_name[2] = '\0';
      phVar16->player_name[3] = '\0';
      phVar16 = (highscore_record_t *)(phVar16->player_name + 4);
    }
    uVar9 = 0xffffffff;
    pcVar6 = &default_player_name;
    do {
      pcVar15 = pcVar6;
      if (uVar9 == 0) break;
      uVar9 = uVar9 - 1;
      pcVar15 = pcVar6 + 1;
      cVar1 = *pcVar6;
      pcVar6 = pcVar15;
    } while (cVar1 != '\0');
    uVar9 = ~uVar9;
    pcVar6 = pcVar15 + -uVar9;
    phVar16 = (highscore_record_t *)(puVar12 + -0x46);
    for (uVar10 = uVar9 >> 2; uVar10 != 0; uVar10 = uVar10 - 1) {
      *(undefined4 *)phVar16->player_name = *(undefined4 *)pcVar6;
      pcVar6 = pcVar6 + 4;
      phVar16 = (highscore_record_t *)(phVar16->player_name + 4);
    }
    for (uVar9 = uVar9 & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
      phVar16->player_name[0] = *pcVar6;
      pcVar6 = pcVar6 + 1;
      phVar16 = (highscore_record_t *)(phVar16->player_name + 1);
    }
    puVar12[-2] = '\0';
    *puVar12 = '|';
    puVar12[1] = 0xff;
    uVar9 = crt_rand();
    *(uint *)(puVar12 + -0xe) = uVar9 & 0xfee050f;
    puVar12 = puVar12 + 0x48;
  } while ((int)puVar12 < 0x484776);
  iVar8 = 0;
  fp = crt_fopen(pcVar3,&file_mode_read_binary);
  if (fp != (FILE *)0x0) {
    uVar9 = highscore_date_checksum
                      (local_system_time & 0xffff,local_system_time >> 0x10,(uint)local_system_day);
    bVar2 = (byte)fp->_flag;
    while ((bVar2 & 0x10) == 0) {
      pcVar3 = highscore_read_record((char *)local_48,fp);
      if ((pcVar3 == (char *)0x0) || ((local_20 & 0xff) != config_blob.reserved0._24_4_))
      goto LAB_0043b2ba;
      if (config_blob.reserved0._24_4_ == 3) {
        if (config_blob.hardcore == '\0') {
          if (cStack_3 == '\0') goto LAB_0043b0ff;
        }
        else if (cStack_3 == 'u') goto LAB_0043b0ff;
      }
      else {
LAB_0043b0ff:
        if (((config_blob.score_load_gate != '\0') || ((bStack_4 & 1) == 0)) ||
           ((bStack_4 & 2) != 0)) {
          if (config_blob.reserved0[2] == '\x03') {
            if (((local_system_day == local_8) &&
                ((local_system_time & 0xffff) - 2000 ==
                 (CONCAT12(cStack_3,CONCAT11(bStack_4,uStack_5)) & 0xff))) &&
               (local_system_time._2_2_ == bStack_6)) goto LAB_0043b1df;
          }
          else if (config_blob.reserved0[2] == '\x02') {
            if ((uVar9 == (CONCAT12(uStack_5,CONCAT11(bStack_6,local_7)) & 0xff)) &&
               ((local_system_time & 0xffff) ==
                (CONCAT12(cStack_3,CONCAT11(bStack_4,uStack_5)) & 0xff) + 2000)) {
LAB_0043b1df:
              if ((config_blob.reserved0[3] == '\x01') &&
                 (pbVar4 = highscore_find_name_entry(local_48,iVar8), pbVar4 != (byte *)0x0)) {
                pbVar14 = local_48;
                for (iVar11 = 0x12; iVar11 != 0; iVar11 = iVar11 + -1) {
                  *(undefined4 *)pbVar4 = *(undefined4 *)pbVar14;
                  pbVar14 = pbVar14 + 4;
                  pbVar4 = pbVar4 + 4;
                }
              }
              else if (iVar8 == 99) {
                phVar16 = &highscore_table;
                if (config_blob.reserved0._24_4_ == 2) {
                  phVar5 = (highscore_record_t *)&DAT_00482b58;
                  do {
                    if ((int)phVar5->survival_elapsed_ms < (int)phVar16->survival_elapsed_ms) {
                      phVar16 = phVar5;
                    }
                    phVar5 = phVar5 + 1;
                  } while ((int)phVar5 < 0x484730);
                  pbVar4 = local_48;
                  for (iVar11 = 0x12; iVar11 != 0; iVar11 = iVar11 + -1) {
                    *(undefined4 *)phVar16->player_name = *(undefined4 *)pbVar4;
                    pbVar4 = pbVar4 + 4;
                    phVar16 = (highscore_record_t *)(phVar16->player_name + 4);
                  }
                }
                else {
                  phVar5 = (highscore_record_t *)&DAT_00482b58;
                  if (config_blob.reserved0._24_4_ == 3) {
                    do {
                      if ((int)phVar16->survival_elapsed_ms < (int)phVar5->survival_elapsed_ms) {
                        phVar16 = phVar5;
                      }
                      phVar5 = phVar5 + 1;
                    } while ((int)phVar5 < 0x484730);
                    pbVar4 = local_48;
                    for (iVar11 = 0x12; iVar11 != 0; iVar11 = iVar11 + -1) {
                      *(undefined4 *)phVar16->player_name = *(undefined4 *)pbVar4;
                      pbVar4 = pbVar4 + 4;
                      phVar16 = (highscore_record_t *)(phVar16->player_name + 4);
                    }
                  }
                  else {
                    do {
                      if ((int)phVar5->score_xp < (int)phVar16->score_xp) {
                        phVar16 = phVar5;
                      }
                      phVar5 = phVar5 + 1;
                    } while ((int)phVar5 < 0x484730);
                    pbVar4 = local_48;
                    for (iVar11 = 0x12; iVar11 != 0; iVar11 = iVar11 + -1) {
                      *(undefined4 *)phVar16->player_name = *(undefined4 *)pbVar4;
                      pbVar4 = pbVar4 + 4;
                      phVar16 = (highscore_record_t *)(phVar16->player_name + 4);
                    }
                  }
                }
              }
              else {
                iVar13 = iVar8 + 1;
                pbVar4 = local_48;
                phVar16 = &highscore_table + iVar8;
                DAT_004c395c = iVar13;
                for (iVar11 = 0x12; iVar8 = iVar13, iVar11 != 0; iVar11 = iVar11 + -1) {
                  *(undefined4 *)phVar16->player_name = *(undefined4 *)pbVar4;
                  pbVar4 = pbVar4 + 4;
                  phVar16 = (highscore_record_t *)(phVar16->player_name + 4);
                }
              }
            }
          }
          else if ((config_blob.reserved0[2] != '\x01') ||
                  ((local_system_time._2_2_ == bStack_6 &&
                   ((local_system_time & 0xffff) - 2000 ==
                    (CONCAT12(cStack_3,CONCAT11(bStack_4,uStack_5)) & 0xff))))) goto LAB_0043b1df;
        }
      }
LAB_0043b2ba:
      bVar2 = (byte)fp->_flag;
    }
    crt_fclose(fp);
    if (100 < DAT_004c395c) {
      DAT_004c395c = 100;
    }
    if (config_blob.reserved0._24_4_ == 2) {
      cmp = highscore_compare_rush_field32_desc;
    }
    else if (config_blob.reserved0._24_4_ == 3) {
      cmp = highscore_compare_quest_field32_asc_nonzero_first;
    }
    else {
      cmp = highscore_compare_survival_score_desc;
    }
    crt_qsort(&highscore_table,100,0x48,cmp);
    if (config_blob.reserved0._128_4_ == 0) {
      local_4c = 0;
      if (0 < DAT_004c395c) {
        local_50 = 0;
        iVar8 = DAT_004c395c;
        do {
          iVar11 = DAT_004c395c;
          if (((highscore_table.reserved0[local_50 + 0xc] & 4) == 0) &&
             ((highscore_table.reserved0[local_50 + 0xc] & 1) != 0)) {
            iVar8 = 0;
            iVar13 = 0;
            local_58 = local_50;
            local_54 = local_4c;
            do {
              pcVar3 = highscore_table.player_name + iVar13;
              if ((highscore_table.reserved0[iVar13 + 0xc] & 1) != 0) {
                pcVar6 = highscore_table.player_name + local_50;
                do {
                  bVar2 = *pcVar6;
                  bVar17 = bVar2 < (byte)*pcVar3;
                  if (bVar2 != *pcVar3) {
LAB_0043b39e:
                    iVar7 = (1 - (uint)bVar17) - (uint)(bVar17 != 0);
                    goto LAB_0043b3a3;
                  }
                  if (bVar2 == 0) break;
                  bVar2 = pcVar6[1];
                  bVar17 = bVar2 < (byte)pcVar3[1];
                  if (bVar2 != pcVar3[1]) goto LAB_0043b39e;
                  pcVar6 = pcVar6 + 2;
                  pcVar3 = pcVar3 + 2;
                } while (bVar2 != 0);
                iVar7 = 0;
LAB_0043b3a3:
                if (iVar7 == 0) {
                  if (highscore_table.reserved0[local_58 + -0x10] == '\x02') {
                    if (*(int *)(highscore_table.reserved0 + local_58 + -0x18) <
                        *(int *)(highscore_table.reserved0 + iVar13 + -0x18)) {
LAB_0043b3d0:
                      local_58 = iVar13;
                      local_54 = iVar8;
                    }
                  }
                  else if (*(int *)(highscore_table.reserved0 + local_58 + -0x14) <
                           *(int *)(highscore_table.reserved0 + iVar13 + -0x14)) goto LAB_0043b3d0;
                }
              }
              iVar8 = iVar8 + 1;
              iVar13 = iVar13 + 0x48;
            } while (iVar8 < DAT_004c395c);
            (&highscore_table)[local_54].flags = (&highscore_table)[local_54].flags | 4;
            iVar8 = iVar11;
          }
          local_4c = local_4c + 1;
          local_50 = local_50 + 0x48;
          if (iVar8 <= local_4c) {
            return;
          }
        } while( true );
      }
    }
    else if (0 < DAT_004c395c) {
      puVar12 = &highscore_table.flags;
      iVar8 = DAT_004c395c;
      do {
        if ((*puVar12 & 1) != 0) {
          *puVar12 = *puVar12 | 4;
        }
        puVar12 = puVar12 + 0x48;
        iVar8 = iVar8 + -1;
      } while (iVar8 != 0);
    }
  }
  return;
}



/* highscore_save_record @ 0043b450 */

/* saves a high score record (updates or appends) */

void __cdecl highscore_save_record(byte *record)

{
  byte bVar1;
  char *path;
  FILE *fp;
  uint uVar2;
  int iVar3;
  byte *pbVar4;
  
  path = highscore_build_path();
  if (record == (byte *)0x0) {
    console_printf(&console_log_queue,s_UNEXPECTED__sc_is_null__00477bac);
    return;
  }
  uVar2 = 0xffffffff;
  pbVar4 = record;
  do {
    if (uVar2 == 0) break;
    uVar2 = uVar2 - 1;
    bVar1 = *pbVar4;
    pbVar4 = pbVar4 + 1;
  } while (bVar1 != 0);
  for (iVar3 = ~uVar2 - 2; (0 < iVar3 && (record[iVar3] == 0x20)); iVar3 = iVar3 + -1) {
    record[iVar3] = 0;
  }
  CreateDirectoryA(s_scores5_00477ba4,(LPSECURITY_ATTRIBUTES)0x0);
  if (DAT_004871c9 == '\0') {
    highscore_record_init();
  }
  if (((record[0x44] & 1) == 0) ||
     (iVar3 = highscore_update_record(path,record), (char)iVar3 == '\0')) {
    fp = crt_fopen(path,&DAT_00477ba0);
    if (fp == (FILE *)0x0) {
      console_printf(&console_log_queue,s_Unable_to_save_score__disk_full_o_00477b6c);
      return;
    }
    highscore_write_record(record,fp);
    crt_fclose(fp);
  }
  return;
}



/* highscore_save_active @ 0043b510 */

/* saves the active high score record */

void highscore_save_active(void)

{
  highscore_save_record((byte *)&highscore_active_record);
  return;
}



/* highscore_rank_index @ 0043b520 */

/* returns the insert index for the current run in the high score table */

int highscore_rank_index(void)

{
  int iVar1;
  int iVar2;
  uint *puVar3;
  
  iVar2 = DAT_004c395c;
  if (config_blob.reserved0._24_4_ == 2) {
    iVar1 = 0;
    if (0 < DAT_004c395c) {
      puVar3 = &highscore_table.survival_elapsed_ms;
      while (iVar2 = iVar1, (int)highscore_active_record.survival_elapsed_ms <= (int)*puVar3) {
        iVar1 = iVar1 + 1;
        puVar3 = puVar3 + 0x12;
        if (DAT_004c395c <= iVar1) {
          return DAT_004c395c;
        }
      }
    }
  }
  else if (config_blob.reserved0._24_4_ == 3) {
    iVar1 = 0;
    if (0 < DAT_004c395c) {
      puVar3 = &highscore_table.survival_elapsed_ms;
      while (iVar2 = iVar1, (int)*puVar3 <= (int)highscore_active_record.survival_elapsed_ms) {
        iVar1 = iVar1 + 1;
        puVar3 = puVar3 + 0x12;
        if (DAT_004c395c <= iVar1) {
          return DAT_004c395c;
        }
      }
    }
  }
  else {
    iVar1 = 0;
    if (0 < DAT_004c395c) {
      puVar3 = &highscore_table.score_xp;
      do {
        if ((int)*puVar3 < (int)highscore_active_record.score_xp) {
          return iVar1;
        }
        iVar1 = iVar1 + 1;
        puVar3 = puVar3 + 0x12;
      } while (iVar1 < DAT_004c395c);
    }
  }
  return iVar2;
}



/* highscore_build_path @ 0043b5b0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* builds the high score filename for the current mode */

char * highscore_build_path(void)

{
  char cVar1;
  uint uVar2;
  char *pcVar3;
  undefined *puVar4;
  
  if (DAT_004c3960 == '\0') {
    crt_getcwd(&DAT_004c375c,0x1ff);
    DAT_004c395b = 0;
    DAT_004c3960 = '\x01';
  }
  if (config_blob.reserved0._24_4_ == 2) {
    puVar4 = &DAT_004c375c;
    pcVar3 = s__s_scores5_rush_hi_00477c60;
  }
  else if (config_blob.reserved0._24_4_ == 1) {
    puVar4 = &DAT_004c375c;
    pcVar3 = s__s_scores5_survival_hi_00477c48;
  }
  else {
    if (config_blob.reserved0._24_4_ == 3) {
      if (config_blob.hardcore == '\0') {
        crt_sprintf(&DAT_004c36dc,s__s_scores5_questhc_d__d_hi_00477c10,&DAT_004c375c,
                    _quest_stage_major,_quest_stage_minor);
      }
      else {
        crt_sprintf(&DAT_004c36dc,s__s_scores5_quest_d__d_hi_00477c2c,&DAT_004c375c,
                    _quest_stage_major,_quest_stage_minor);
      }
      goto LAB_0043b67f;
    }
    puVar4 = (undefined *)(config_blob.reserved0._128_4_ * 0x1b + 0x4803f0);
    pcVar3 = s_scores5_unknown_hi_00477bfc;
  }
  crt_sprintf(&DAT_004c36dc,pcVar3,puVar4);
LAB_0043b67f:
  if (config_blob.reserved0._20_4_ == 2) {
    uVar2 = 0xffffffff;
    pcVar3 = &DAT_004c36dc;
    do {
      if (uVar2 == 0) break;
      uVar2 = uVar2 - 1;
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    uVar2 = ~uVar2;
    (&DAT_004c36d8)[uVar2] = 0x5f;
    (&DAT_004c36d9)[uVar2] = 0x32;
    (&DAT_004c36da)[uVar2] = 0x2e;
    (&DAT_004c36db)[uVar2] = 0x68;
    (&DAT_004c36dc)[uVar2] = 0x69;
    (&DAT_004c36dd)[uVar2] = 0;
  }
  if (config_blob.reserved0._128_4_ != 0) {
    crt_sprintf(&DAT_004c365c,&DAT_00477bf4,&DAT_004c36dc,
                config_blob.reserved0._128_4_ * 0x1b + 0x4803f0);
    console_printf(&console_log_queue,s_Opening_named_cache___s__00477bd8,&DAT_004c365c);
    return &DAT_004c365c;
  }
  if (*(float *)((int)cv_verbose + 0xc) != 0.0) {
    console_printf(&console_log_queue,s_Opening___s__00477bc8,&DAT_004c36dc);
  }
  return &DAT_004c36dc;
}



/* highscore_record_init @ 0043b750 */

/* fills the active high score record metadata for the current run */

void highscore_record_init(void)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 1;
  iVar1 = 1;
  iVar3 = 4;
  do {
    if (*(int *)((int)&DAT_0048708c + iVar3) < (int)(&DAT_0048708c)[iVar1]) {
      iVar3 = iVar1 * 4;
      iVar4 = iVar1;
    }
    iVar1 = iVar1 + 1;
  } while (iVar1 < 0x40);
  highscore_active_record.most_used_weapon_id = (uchar)iVar4;
  if ((int)highscore_active_record.shots_fired < (int)highscore_active_record.shots_hit) {
    highscore_active_record.shots_hit = highscore_active_record.shots_fired;
  }
  highscore_active_record.game_mode_id = config_blob.reserved0[0x18];
  highscore_active_record.quest_stage_major = quest_stage_major;
  highscore_active_record.quest_stage_minor = quest_stage_minor;
  highscore_active_record.flags = '\0';
  uVar2 = crt_rand();
  uVar2 = uVar2 & 0x8fffffff;
  if ((int)uVar2 < 0) {
    uVar2 = (uVar2 - 1 | 0xf0000000) + 1;
  }
  highscore_active_record.reserved0._0_4_ = uVar2 + 0x310;
  highscore_active_record.full_version_marker = -(config_blob.hardcore != '\0') & 0x75;
  return;
}



/* FUN_0043b810 @ 0043b810 */

/* [binja] void* __fastcall sub_43b810(void* arg1) */

void * __fastcall FUN_0043b810(void *arg1)

{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = 0x10;
  *(undefined4 *)((int)arg1 + 0x80) = 0;
  *(undefined4 *)((int)arg1 + 0x7c) = 0;
  *(undefined4 *)((int)arg1 + 0x78) = 0;
  *(undefined4 *)((int)arg1 + 0x74) = 0;
  *(undefined4 *)((int)arg1 + 0x14) = 0;
  *(undefined4 *)((int)arg1 + 0x18) = 0;
  *(undefined4 *)((int)arg1 + 0x1c) = 0;
  *(undefined4 *)((int)arg1 + 0x20) = 0xbf800000;
  puVar1 = (undefined4 *)((int)arg1 + 0x60);
  do {
    *puVar1 = 0;
    puVar1 = puVar1 + -1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  return arg1;
}



/* buffer_reader_init @ 0043b850 */

/* initializes the buffer reader cursor and length */

void __cdecl buffer_reader_init(void *data,int size)

{
  DAT_004c3c70 = data;
  DAT_004c3c74 = size;
  DAT_004c3c78 = 0;
  return;
}



/* buffer_reader_seek @ 0043b870 */

/* sets the buffer reader cursor */

void __cdecl buffer_reader_seek(int offset)

{
  DAT_004c3c78 = offset;
  return;
}



/* buffer_reader_read_u16 @ 0043b880 */

/* reads a little-endian u16 from the buffer */

int buffer_reader_read_u16(void)

{
  undefined2 *puVar1;
  
  puVar1 = (undefined2 *)(DAT_004c3c78 + DAT_004c3c70);
  DAT_004c3c78 = DAT_004c3c78 + 2;
  return CONCAT22((short)((uint)DAT_004c3c70 >> 0x10),*puVar1);
}



/* buffer_reader_read_u32 @ 0043b8a0 */

/* reads a little-endian u32 from the buffer */

uint buffer_reader_read_u32(void)

{
  uint *puVar1;
  
  puVar1 = (uint *)(DAT_004c3c78 + DAT_004c3c70);
  DAT_004c3c78 = DAT_004c3c78 + 4;
  return *puVar1;
}



/* buffer_reader_skip @ 0043b8c0 */

/* advances the buffer reader cursor */

void __cdecl buffer_reader_skip(int count)

{
  DAT_004c3c78 = DAT_004c3c78 + count;
  return;
}



/* buffer_reader_find_tag @ 0043b8e0 */

/* searches the buffer for a tag and updates the cursor */

int __cdecl buffer_reader_find_tag(char *tag,int tag_len)

{
  int iVar1;
  int iVar2;
  
  iVar2 = 0;
  if (0 < (int)DAT_004c3c74) {
    do {
      iVar1 = 0;
      if (0 < tag_len) {
        do {
          if (*(char *)(DAT_004c3c70 + iVar2 + iVar1) != tag[iVar1]) break;
          iVar1 = iVar1 + 1;
        } while (iVar1 < tag_len);
      }
      if (iVar1 == tag_len) {
        DAT_004c3c78 = iVar2 + tag_len;
        return CONCAT31((int3)((uint)iVar1 >> 8),1);
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 < (int)DAT_004c3c74);
  }
  return DAT_004c3c74 & 0xffffff00;
}



/* resource_pack_read_cstring @ 0043b940 */

/* reads a NUL-terminated pack entry name into DAT_004c3a68 */

int __cdecl resource_pack_read_cstring(FILE *fp)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = 0;
  bVar1 = (byte)fp->_flag;
  while (((bVar1 & 0x10) == 0 && (iVar2 = crt_getc(fp), iVar2 != 0))) {
    (&DAT_004c3a68)[iVar3] = (char)iVar2;
    bVar1 = (byte)fp->_flag;
    iVar3 = iVar3 + 1;
  }
  (&DAT_004c3a68)[iVar3] = 0;
  return (uint)~fp->_flag >> 4 & 1;
}



/* resource_pack_set @ 0043b980 */

/* validates and sets the active resource pack path */

int __cdecl resource_pack_set(char *path)

{
  char cVar1;
  FILE *fp;
  int iVar2;
  uint uVar3;
  uint uVar4;
  char *pcVar5;
  char *pcVar6;
  
  fp = crt_fopen(path,&file_mode_read_binary);
  if (fp == (FILE *)0x0) {
    DAT_004c3968._0_1_ = 0;
    DAT_004c3c6c = 0;
    return 0;
  }
  uVar3 = 0xffffffff;
  do {
    pcVar5 = path;
    if (uVar3 == 0) break;
    uVar3 = uVar3 - 1;
    pcVar5 = path + 1;
    cVar1 = *path;
    path = pcVar5;
  } while (cVar1 != '\0');
  uVar3 = ~uVar3;
  pcVar5 = pcVar5 + -uVar3;
  pcVar6 = (char *)&DAT_004c3968;
  for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
    *(undefined4 *)pcVar6 = *(undefined4 *)pcVar5;
    pcVar5 = pcVar5 + 4;
    pcVar6 = pcVar6 + 4;
  }
  for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *pcVar6 = *pcVar5;
    pcVar5 = pcVar5 + 1;
    pcVar6 = pcVar6 + 1;
  }
  DAT_004c3c6c = 1;
  iVar2 = crt_fclose(fp);
  return CONCAT31((int3)((uint)iVar2 >> 8),1);
}



/* resource_open_read @ 0043b9e0 */

/* opens a resource from the active pack or filesystem and returns its size */

int __cdecl resource_open_read(byte *path,int *size_out)

{
  int *piVar1;
  char cVar2;
  FILE *fp;
  int iVar3;
  uint uVar4;
  long lVar5;
  
  piVar1 = size_out;
  if (DAT_004c3c6c != '\0') {
    fp = crt_fopen((char *)&DAT_004c3968,&file_mode_read_binary);
    DAT_004c3c68 = fp;
    if (fp == (FILE *)0x0) {
      return 0;
    }
    crt_fseek(fp,4,0);
    iVar3 = resource_pack_read_cstring(fp);
    cVar2 = (char)iVar3;
    while (cVar2 != '\0') {
      crt_fread(&size_out,4,1,fp);
      *piVar1 = (int)size_out;
      uVar4 = FUN_00462de0(size_out,&DAT_004c3a68,path);
      iVar3 = 0;
      if (uVar4 == 0) goto LAB_0043bac3;
      crt_fseek(fp,(long)size_out,1);
      iVar3 = resource_pack_read_cstring(fp);
      cVar2 = (char)iVar3;
    }
    crt_fclose(fp);
  }
  DAT_004c3c68 = crt_fopen((char *)path,&file_mode_read_binary);
  if (DAT_004c3c68 == (FILE *)0x0) {
    return 0;
  }
  crt_fseek(DAT_004c3c68,0,2);
  lVar5 = crt_ftell(DAT_004c3c68);
  *piVar1 = lVar5;
  iVar3 = crt_fseek(DAT_004c3c68,0,0);
LAB_0043bac3:
  return CONCAT31((int3)((uint)iVar3 >> 8),1);
}



/* resource_close @ 0043bad0 */

/* closes the current resource file handle */

void resource_close(void)

{
  if (DAT_004c3c68 != (FILE *)0x0) {
    crt_fclose(DAT_004c3c68);
  }
  return;
}



/* dsound_init @ 0043baf0 */

/* WARNING: Restarted to delay deadcode elimination for space: stack */
/* initializes DirectSound and the primary buffer */

int __cdecl dsound_init(void *hwnd,uint coop_level)

{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 *puVar4;
  int *piVar5;
  undefined4 uStack_54;
  undefined4 auStack_30 [4];
  undefined4 uStack_20;
  short sStack_10;
  ushort uStack_8;
  
  if (DAT_004c3964 != (int *)0x0) {
    (**(code **)(*DAT_004c3964 + 8))();
  }
  DAT_004c3964 = (int *)0x0;
  uVar1 = DirectSoundCreate8((LPCGUID)0x0,(LPDIRECTSOUND8 *)&DAT_004c3964,(LPUNKNOWN)0x0);
  if ((int)uVar1 < 0) {
    return uVar1 & 0xffffff00;
  }
  uVar1 = (**(code **)(*DAT_004c3964 + 0x18))();
  if ((int)uVar1 < 0) {
    return uVar1 & 0xffffff00;
  }
  puVar4 = auStack_30;
  for (iVar3 = 9; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
  }
  uStack_54 = 0;
  auStack_30[0] = 0x24;
  auStack_30[1] = 1;
  auStack_30[2] = 0;
  uStack_20 = 0;
  uVar1 = (**(code **)(*DAT_004c3964 + 0xc))(DAT_004c3964,auStack_30);
  if ((int)uVar1 < 0) {
    return uVar1 & 0xffffff00;
  }
  uStack_54 = CONCAT22(sStack_10,1);
  piVar5 = &uStack_54;
  uVar1 = (**(code **)(CONCAT22(uStack_8,(uStack_8 >> 3) * sStack_10) + 0x38))(&stack0xffffffb8);
  if ((int)uVar1 < 0) {
    return uVar1 & 0xffffff00;
  }
  uVar2 = 0;
  if (piVar5 != (int *)0x0) {
    uVar2 = (**(code **)(*piVar5 + 8))(piVar5);
  }
  return CONCAT31((int3)((uint)uVar2 >> 8),1);
}



/* dsound_shutdown @ 0043bc20 */

/* releases the DirectSound interface */

void dsound_shutdown(void)

{
  if (DAT_004c3964 != (int *)0x0) {
    (**(code **)(*DAT_004c3964 + 8))(DAT_004c3964);
  }
  DAT_004c3964 = (int *)0x0;
  return;
}



/* dsound_restore_buffer @ 0043bc40 */

/* restores a lost DirectSound buffer */

int __cdecl dsound_restore_buffer(void *buffer)

{
  void *pvVar1;
  uint in_EAX;
  int iVar2;
  undefined4 extraout_EAX;
  uint unaff_ESI;
  
  pvVar1 = buffer;
  if (((buffer != (void *)0x0) &&
      (in_EAX = (**(code **)(*(int *)buffer + 0x24))(buffer,&buffer), -1 < (int)in_EAX)) &&
     ((unaff_ESI & 2) != 0)) {
    do {
      while (iVar2 = (**(code **)(*(int *)pvVar1 + 0x50))(pvVar1), iVar2 == -0x7787ff6a) {
        Sleep(10);
      }
    } while (iVar2 != 0);
    OutputDebugStringA(s_____SND__Buffer_restored__00477c74);
    return CONCAT31((int3)((uint)extraout_EAX >> 8),1);
  }
  return in_EAX & 0xffffff00;
}



/* resource_read_alloc @ 0043bca0 */

/* reads a resource into a newly allocated buffer */

int __cdecl resource_read_alloc(byte *path,void **out_data,uint *out_size)

{
  FILE *fp;
  int iVar1;
  void *ptr;
  
  iVar1 = resource_open_read(path,(int *)out_size);
  fp = DAT_004c3c68;
  if ((char)iVar1 == '\0') {
    return iVar1;
  }
  ptr = operator_new(*out_size);
  crt_fread(ptr,*out_size,1,fp);
  resource_close();
  *out_data = ptr;
  return CONCAT31((int3)((uint)out_data >> 8),1);
}



/* sfx_entry_load_ogg @ 0043bcf0 */

/* loads an OGG sample into an sfx entry */

int __cdecl sfx_entry_load_ogg(void *entry,byte *path)

{
  FILE *fp;
  int iVar1;
  void *pvVar2;
  uint uVar3;
  uint unaff_EDI;
  char *dst;
  void *local_314;
  undefined1 local_310 [740];
  uint local_2c;
  uint local_1c;
  int local_18;
  
  iVar1 = resource_open_read(path,(int *)&local_314);
  fp = DAT_004c3c68;
  if ((char)iVar1 == '\0') {
    return iVar1;
  }
  pvVar2 = operator_new((int)local_314 + 8);
  crt_fread((void *)((int)pvVar2 + 8),(uint)local_314,1,fp);
  resource_close();
  iVar1 = vorbis_mem_open(local_310,pvVar2,local_314,unaff_EDI);
  if ((char)iVar1 != '\0') {
    *(undefined4 *)entry = 0;
    *(undefined4 *)((int)entry + 4) = 0;
    *(undefined4 *)((int)entry + 8) = 0;
    *(undefined4 *)((int)entry + 0xc) = 0;
    *(undefined2 *)((int)entry + 0x10) = 0;
    *(short *)((int)entry + 2) = (short)local_1c;
    *(undefined2 *)entry = 1;
    uVar3 = (int)((local_1c & 0xffff) * 0x10) >> 3;
    *(short *)((int)entry + 0xc) = (short)uVar3;
    *(uint *)((int)entry + 8) = (uVar3 & 0xffff) * local_18;
    *(int *)((int)entry + 4) = local_18;
    *(undefined2 *)((int)entry + 0xe) = 0x10;
    *(undefined2 *)((int)entry + 0x10) = 0;
    *(uint *)((int)entry + 0x18) = local_2c;
    pvVar2 = operator_new(local_2c);
    dst = *(char **)((int)entry + 0x18);
    *(void **)((int)entry + 0x14) = pvVar2;
    iVar1 = 1;
    while ((dst != (char *)0x0 && (iVar1 != 0))) {
      iVar1 = vorbis_read_pcm16(local_310,
                                (void *)((*(int *)((int)entry + 0x18) - (int)dst) +
                                        *(int *)((int)entry + 0x14)),dst,unaff_EDI);
      dst = dst + -iVar1;
    }
    vorbis_mem_close(local_310);
    iVar1 = sfx_entry_create_buffers((int)entry);
    return CONCAT31((int3)((uint)iVar1 >> 8),(char)iVar1 != '\0');
  }
  return iVar1;
}



/* sfx_entry_seek @ 0043be20 */

/* seeks streaming sfx data and resets playback cursors */

void __cdecl sfx_entry_seek(int entry,int sample_offset)

{
  int *sample_offset_00;
  
  if (*(int *)(entry + 0x74) != 0) {
    sample_offset_00 = *(int **)(entry + 0x24);
    (**(code **)(*sample_offset_00 + 0x34))(sample_offset_00,sample_offset);
    vorbis_pcm_seek(*(void **)(entry + 0x74),(void *)sample_offset,(uint)sample_offset_00);
    *(undefined4 *)(entry + 0x1c) = 0;
    *(undefined4 *)(entry + 0x78) = 0;
    *(undefined4 *)(entry + 0x7c) = 0;
    *(undefined4 *)(entry + 0x80) = 0;
  }
  return;
}



/* sfx_entry_start_playback @ 0043be60 */

/* selects a voice/buffer and starts playback */

int __cdecl sfx_entry_start_playback(int entry)

{
  int *piVar1;
  int entry_00;
  int iVar2;
  int *piVar3;
  uint uVar4;
  
  entry_00 = entry;
  if (entry == 0) {
    return -1;
  }
  piVar3 = (int *)(entry + 0x24);
  iVar2 = dsound_restore_buffer(*(void **)(entry + 0x24));
  if ((char)iVar2 != '\0') {
    if (*(int *)(entry_00 + 0x74) != 0) goto LAB_0043be9c;
    sfx_entry_upload_buffer(entry_00);
  }
  if (*(int *)(entry_00 + 0x74) == 0) {
    uVar4 = 0;
    do {
      piVar1 = (int *)*piVar3;
      if (piVar1 != (int *)0x0) {
        (**(code **)(*piVar1 + 0x24))(piVar1,&entry);
        if ((entry & 1U) == 0) goto LAB_0043bf10;
      }
      uVar4 = uVar4 + 1;
      piVar3 = piVar3 + 1;
    } while ((int)uVar4 < 0x10);
    uVar4 = crt_rand();
    uVar4 = uVar4 & 0x8000000f;
    if ((int)uVar4 < 0) {
      uVar4 = (uVar4 - 1 | 0xfffffff0) + 1;
    }
    piVar3 = *(int **)(entry_00 + 0x24 + uVar4 * 4);
    (**(code **)(*piVar3 + 0x48))(piVar3);
LAB_0043bf10:
    piVar3 = *(int **)(entry_00 + 0x24 + uVar4 * 4);
    (**(code **)(*piVar3 + 0x44))(piVar3,sfx_rate_scale);
    piVar3 = *(int **)(entry_00 + 0x24 + uVar4 * 4);
    (**(code **)(*piVar3 + 0x30))(piVar3,0,0,0);
    return uVar4;
  }
LAB_0043be9c:
  sfx_entry_seek(entry_00,0);
  music_stream_fill(entry_00);
  music_stream_fill(entry_00);
  music_stream_fill(entry_00);
  (**(code **)(*(int *)*piVar3 + 0x30))((int *)*piVar3,0,0,1);
  return 0;
}



/* sfx_entry_resume @ 0043bf40 */

/* restarts playback for a streaming entry */

void __cdecl sfx_entry_resume(int entry)

{
  if (*(int *)(entry + 0x74) != 0) {
    (**(code **)(**(int **)(entry + 0x24) + 0x30))(*(int **)(entry + 0x24),0,0,1);
  }
  return;
}



/* sfx_entry_stop @ 0043bf60 */

/* stops playback for all voices */

void __cdecl sfx_entry_stop(int entry)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  
  if (entry != 0) {
    if (*(int *)(entry + 0x74) == 0) {
      piVar2 = (int *)(entry + 0x24);
      iVar3 = 0x10;
      do {
        piVar1 = (int *)*piVar2;
        if (piVar1 != (int *)0x0) {
          (**(code **)(*piVar1 + 0x48))(piVar1);
        }
        piVar2 = piVar2 + 1;
        iVar3 = iVar3 + -1;
      } while (iVar3 != 0);
    }
    else {
      piVar2 = *(int **)(entry + 0x24);
      if (piVar2 != (int *)0x0) {
        (**(code **)(*piVar2 + 0x48))(piVar2);
        return;
      }
    }
  }
  return;
}



/* sfx_entry_set_volume @ 0043bfa0 */

/* sets the volume for active voices */

void __cdecl sfx_entry_set_volume(int entry,float volume)

{
  int *piVar1;
  int iVar2;
  float fVar3;
  int iVar4;
  int *piVar5;
  longlong lVar6;
  
  fVar3 = (volume + 2.0) * 0.33333334;
  if ((*(int *)(entry + 0x74) == 0) || (*(float *)(entry + 0x20) != fVar3)) {
    iVar4 = 0;
    *(float *)(entry + 0x20) = fVar3;
    piVar5 = (int *)(entry + 0x24);
    do {
      piVar1 = (int *)*piVar5;
      if (piVar1 != (int *)0x0) {
        iVar2 = *piVar1;
        lVar6 = __ftol();
        (**(code **)(iVar2 + 0x3c))(piVar1,(int)lVar6);
        if (*(int *)(entry + 0x74) != 0) {
          return;
        }
      }
      iVar4 = iVar4 + 1;
      piVar5 = piVar5 + 1;
    } while (iVar4 < 0x10);
  }
  return;
}



/* sfx_entry_load_wav @ 0043c020 */

/* loads a WAV sample into an sfx entry */

int __cdecl sfx_entry_load_wav(void *entry,byte *path)

{
  int iVar1;
  uint extraout_EAX;
  uint local_4;
  
  iVar1 = resource_read_alloc(path,&path,&local_4);
  if ((char)iVar1 == '\0') {
    return iVar1;
  }
  iVar1 = wav_parse_into_entry(entry,path,local_4);
  if ((char)iVar1 == '\0') {
    crt_free(path);
    return extraout_EAX & 0xffffff00;
  }
  crt_free(path);
  iVar1 = sfx_entry_create_buffers((int)entry);
  return CONCAT31((int3)((uint)iVar1 >> 8),(char)iVar1 != '\0');
}



/* sfx_release_entry @ 0043c090 */

/* frees a sound entry (sample/voices) */

void __cdecl sfx_release_entry(int entry)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  
  if (*(void **)(entry + 0x74) != (void *)0x0) {
    vorbis_mem_close(*(void **)(entry + 0x74));
    crt_free(*(void **)(entry + 0x74));
    piVar3 = *(int **)(entry + 0x24);
    *(undefined4 *)(entry + 0x74) = 0;
    if (piVar3 != (int *)0x0) {
      (**(code **)(*piVar3 + 8))(piVar3);
    }
    *(undefined4 *)(entry + 0x24) = 0;
    crt_free(*(void **)(entry + 0x14));
    *(undefined4 *)(entry + 0x14) = 0;
    return;
  }
  piVar3 = (int *)(entry + 0x60);
  iVar2 = 0x10;
  do {
    piVar1 = (int *)*piVar3;
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    *piVar3 = 0;
    piVar3 = piVar3 + -1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  crt_free(*(void **)(entry + 0x14));
  *(undefined4 *)(entry + 0x14) = 0;
  return;
}



/* wav_parse_into_entry @ 0043c110 */

/* parses WAV data into an entry and copies PCM */

int __cdecl wav_parse_into_entry(void *entry,void *data,int size)

{
  int iVar1;
  uint uVar2;
  undefined4 *puVar3;
  uint uVar4;
  undefined4 *puVar5;
  
  *(undefined4 *)entry = 0;
  *(undefined4 *)((int)entry + 4) = 0;
  *(undefined4 *)((int)entry + 8) = 0;
  *(undefined4 *)((int)entry + 0xc) = 0;
  *(undefined2 *)((int)entry + 0x10) = 0;
  *(undefined2 *)entry = 1;
  *(undefined2 *)((int)entry + 2) = 1;
  *(undefined2 *)((int)entry + 0xe) = 0x10;
  *(undefined4 *)((int)entry + 4) = 0x5622;
  *(undefined2 *)((int)entry + 0xc) = 2;
  *(undefined2 *)((int)entry + 0x10) = 0;
  *(undefined4 *)((int)entry + 8) = 0xac44;
  buffer_reader_init(data,size);
  buffer_reader_seek(0);
  iVar1 = buffer_reader_find_tag(&DAT_00477c98,4);
  if ((char)iVar1 == '\0') {
    return iVar1;
  }
  buffer_reader_skip(4);
  buffer_reader_skip(2);
  iVar1 = buffer_reader_read_u16();
  *(short *)((int)entry + 2) = (short)iVar1;
  uVar2 = buffer_reader_read_u32();
  *(uint *)((int)entry + 4) = uVar2;
  buffer_reader_skip(6);
  uVar2 = buffer_reader_read_u16();
  *(short *)((int)entry + 0xe) = (short)uVar2;
  iVar1 = (uint)*(ushort *)((int)entry + 2) * (uVar2 & 0xffff);
  *(undefined2 *)((int)entry + 0x10) = 0;
  uVar2 = (int)(iVar1 + (iVar1 >> 0x1f & 7U)) >> 3;
  *(short *)((int)entry + 0xc) = (short)uVar2;
  *(uint *)((int)entry + 8) = (uVar2 & 0xffff) * *(int *)((int)entry + 4);
  buffer_reader_find_tag(&DAT_00477c90,4);
  uVar2 = buffer_reader_read_u32();
  *(uint *)((int)entry + 0x18) = uVar2;
  puVar3 = operator_new(uVar2);
  *(undefined4 **)((int)entry + 0x14) = puVar3;
  puVar5 = (undefined4 *)(DAT_004c3c78 + (int)data);
  for (uVar4 = uVar2 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
    *puVar3 = *puVar5;
    puVar5 = puVar5 + 1;
    puVar3 = puVar3 + 1;
  }
  for (uVar4 = uVar2 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *(undefined1 *)puVar3 = *(undefined1 *)puVar5;
    puVar5 = (undefined4 *)((int)puVar5 + 1);
    puVar3 = (undefined4 *)((int)puVar3 + 1);
  }
  return CONCAT31((int3)(uVar2 >> 8),1);
}



/* sfx_entry_upload_buffer @ 0043c230 */

/* uploads PCM data into a DirectSound buffer */

int __cdecl sfx_entry_upload_buffer(int entry)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int *piVar5;
  int *piVar6;
  undefined4 uVar7;
  int *piVar8;
  undefined1 local_4 [4];
  
  iVar1 = entry;
  piVar8 = &entry;
  uVar7 = 0;
  iVar2 = (**(code **)(**(int **)(entry + 0x24) + 0x2c))
                    (*(int **)(entry + 0x24),0,*(undefined4 *)(entry + 0x18),piVar8,local_4,0,0,0);
  if ((iVar2 < 0) && (iVar2 == -0x7787ff6a)) {
    iVar2 = dsound_restore_buffer(*(void **)(iVar1 + 0x24));
    if ((char)iVar2 == '\0') {
      return iVar2;
    }
  }
  uVar4 = *(uint *)(iVar1 + 0x18);
  piVar5 = *(int **)(iVar1 + 0x14);
  piVar6 = piVar8;
  for (uVar3 = uVar4 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *piVar6 = *piVar5;
    piVar5 = piVar5 + 1;
    piVar6 = piVar6 + 1;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *(char *)piVar6 = (char)*piVar5;
    piVar5 = (int *)((int)piVar5 + 1);
    piVar6 = (int *)((int)piVar6 + 1);
  }
  uVar7 = (**(code **)(**(int **)(iVar1 + 0x24) + 0x4c))(*(int **)(iVar1 + 0x24),piVar8,uVar7,0,0);
  return CONCAT31((int3)((uint)uVar7 >> 8),1);
}



/* sfx_entry_create_buffers @ 0043c2b0 */

/* creates DirectSound buffers for an sfx entry */

int __cdecl sfx_entry_create_buffers(int entry)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  uint extraout_EAX;
  int iVar4;
  undefined4 *puVar5;
  int iVar6;
  undefined4 *puVar7;
  undefined4 local_24 [4];
  int local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  puVar7 = (undefined4 *)(entry + 0x24);
  puVar5 = local_24;
  for (iVar4 = 9; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  local_24[2] = *(undefined4 *)(entry + 0x18);
  local_10 = 0;
  local_8 = 0;
  local_4 = 0;
  local_24[0] = 0x24;
  local_24[1] = 0x80e0;
  local_c = 0;
  local_14 = entry;
  uVar1 = (**(code **)(*DAT_004c3964 + 0xc))(DAT_004c3964,local_24,puVar7,0);
  if ((int)uVar1 < 0) {
    return uVar1 & 0xffffff00;
  }
  iVar6 = 1;
  iVar4 = entry + 0x28;
  do {
    iVar2 = (**(code **)(*DAT_004c3964 + 0x14))(DAT_004c3964,*puVar7,iVar4);
    if (iVar2 < 0) {
      OutputDebugStringA(s_____SND__Failed_to_duplicate_the_00477ca0);
      return extraout_EAX & 0xffffff00;
    }
    iVar6 = iVar6 + 1;
    iVar4 = iVar4 + 4;
  } while (iVar6 < 0x10);
  sfx_entry_upload_buffer(entry);
  iVar4 = 0;
  do {
    *(undefined1 *)(iVar4 + 100 + entry) = 0;
    (**(code **)(*(int *)*puVar7 + 0x48))((int *)*puVar7);
    uVar3 = (**(code **)(*(int *)*puVar7 + 0x34))((int *)*puVar7,0);
    iVar4 = iVar4 + 1;
    puVar7 = puVar7 + 1;
  } while (iVar4 < 0x10);
  return CONCAT31((int3)((uint)uVar3 >> 8),1);
}



/* music_entry_load_ogg @ 0043c3a0 */

/* loads an OGG stream into a music entry */

int __cdecl music_entry_load_ogg(void *entry,byte *path)

{
  ushort uVar1;
  FILE *fp;
  int iVar2;
  void *stream;
  void *this;
  uint uVar3;
  undefined4 *puVar4;
  uint3 uVar5;
  uint uVar6;
  uint unaff_EDI;
  undefined4 local_24 [4];
  void *local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  iVar2 = resource_open_read(path,(int *)&path);
  fp = DAT_004c3c68;
  if ((char)iVar2 == '\0') {
    return iVar2;
  }
  stream = operator_new((uint)(path + 8));
  crt_fread((void *)((int)stream + 8),(uint)path,1,fp);
  resource_close();
  this = operator_new(0x310);
  *(void **)((int)entry + 0x74) = this;
  iVar2 = vorbis_mem_open(this,stream,path,unaff_EDI);
  if ((char)iVar2 == '\0') {
    return iVar2;
  }
  *(undefined4 *)entry = 0;
  *(undefined4 *)((int)entry + 4) = 0;
  *(undefined4 *)((int)entry + 8) = 0;
  *(undefined4 *)((int)entry + 0xc) = 0;
  *(undefined2 *)((int)entry + 0x10) = 0;
  *(undefined2 *)entry = 1;
  uVar1 = *(ushort *)(*(int *)((int)entry + 0x74) + 0x2f4);
  *(ushort *)((int)entry + 2) = uVar1;
  *(undefined4 *)((int)entry + 4) = *(undefined4 *)(*(int *)((int)entry + 0x74) + 0x2f8);
  *(undefined2 *)((int)entry + 0xe) = 0x10;
  *(undefined2 *)((int)entry + 0x10) = 0;
  uVar3 = (int)((uint)uVar1 * 0x10) >> 3;
  *(short *)((int)entry + 0xc) = (short)uVar3;
  iVar2 = (uVar3 & 0xffff) * *(int *)((int)entry + 4);
  *(int *)((int)entry + 8) = iVar2;
  uVar3 = iVar2 * 2;
  *(uint *)((int)entry + 0x18) = uVar3;
  puVar4 = operator_new(uVar3);
  uVar3 = *(uint *)((int)entry + 0x18);
  *(undefined4 **)((int)entry + 0x14) = puVar4;
  for (uVar6 = uVar3 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
  }
  for (uVar3 = uVar3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined1 *)puVar4 = 0;
    puVar4 = (undefined4 *)((int)puVar4 + 1);
  }
  puVar4 = local_24;
  for (iVar2 = 9; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
  }
  local_24[2] = *(undefined4 *)((int)entry + 0x18);
  local_10 = 0;
  local_4 = 0;
  local_8 = 0;
  local_24[0] = 0x24;
  local_24[1] = 0x180c0;
  local_c = 0;
  local_14 = entry;
  iVar2 = (**(code **)(*DAT_004c3964 + 0xc))(DAT_004c3964,local_24,(int)entry + 0x24,0);
  uVar5 = (uint3)((uint)iVar2 >> 8);
  if (iVar2 < 0) {
    return (uint)uVar5 << 8;
  }
  *(undefined4 *)((int)entry + 0x80) = 0;
  return CONCAT31(uVar5,1);
}



/* music_stream_update @ 0043c520 */

/* updates streaming cursor and refills if needed */

void __cdecl music_stream_update(int entry)

{
  int entry_00;
  int iVar1;
  uint uVar2;
  uint uVar3;
  
  entry_00 = entry;
  iVar1 = (**(code **)(**(int **)(entry + 0x24) + 0x10))(*(int **)(entry + 0x24),&entry);
  if (-1 < iVar1) {
    if (*(int *)(entry_00 + 0x78) == 0) {
      iVar1 = 0;
    }
    else {
      iVar1 = *(int *)(entry_00 + 0x18) - *(int *)(entry_00 + 0x78);
    }
    *(undefined4 *)(entry_00 + 0x78) = 0;
    uVar3 = *(int *)(entry_00 + 0x80) + iVar1;
    *(int *)(entry_00 + 0x7c) = *(int *)(entry_00 + 0x7c) + iVar1;
    *(uint *)(entry_00 + 0x80) = uVar3;
    uVar2 = (int)(*(int *)(entry_00 + 0x18) + (*(int *)(entry_00 + 0x18) >> 0x1f & 3U)) >> 2;
    if (uVar2 < uVar3) {
      *(uint *)(entry_00 + 0x80) = uVar3 - uVar2;
      music_stream_fill(entry_00);
    }
  }
  return;
}



/* music_stream_fill @ 0043c590 */

/* decodes and writes the next music stream chunk */

int __cdecl music_stream_fill(int entry)

{
  int iVar1;
  uint uVar2;
  uint extraout_EAX;
  int iVar3;
  int iVar4;
  char *dst;
  int *bytes;
  
  bytes = *(int **)(entry + 0x24);
  iVar1 = (int)(*(int *)(entry + 0x18) + (*(int *)(entry + 0x18) >> 0x1f & 3U)) >> 2;
  iVar4 = *(int *)(entry + 0x1c);
  uVar2 = (**(code **)(*bytes + 0x2c))();
  if (-1 < (int)uVar2) {
    if (&stack0x00000000 != (undefined1 *)0xc) {
      OutputDebugStringA(s_____SND__Somehow_data_on_the_sec_00477ccc);
      return extraout_EAX & 0xffffff00;
    }
    dst = (char *)0x8;
    do {
      iVar3 = vorbis_read_pcm16(*(void **)(entry + 0x74),(void *)((8 - (int)dst) + iVar1),dst,
                                (int)bytes);
      if (iVar3 < 1) {
        iVar3 = vorbis_read_pcm16(*(void **)(entry + 0x74),(void *)((8 - (int)dst) + iVar1),dst,
                                  (int)bytes);
      }
      dst = dst + -iVar3;
    } while ((0 < (int)dst) && (iVar3 != 0));
    (**(code **)(**(int **)(entry + 0x24) + 0x4c))(*(int **)(entry + 0x24),iVar1,8,0,0);
    iVar4 = iVar4 + *(int *)(entry + 0x1c);
    uVar2 = iVar4 / *(int *)(entry + 0x18);
    *(int *)(entry + 0x1c) = iVar4 % *(int *)(entry + 0x18);
  }
  return uVar2 & 0xffffff00;
}



/* sfx_release_sample @ 0043c700 */

/* releases an sfx sample by id */

int __cdecl sfx_release_sample(int sfx_id)

{
  uint in_EAX;
  undefined4 extraout_EAX;
  
  if (((-1 < sfx_id) && (sfx_id < 0x80)) &&
     (in_EAX = sfx_id * 0x84, (&sfx_entry_table)[sfx_id].pcm_data != (void *)0x0)) {
    sfx_release_entry((int)(&sfx_entry_table + sfx_id));
    return CONCAT31((int3)((uint)extraout_EAX >> 8),1);
  }
  return in_EAX & 0xffffff00;
}



/* sfx_load_sample @ 0043c740 */

/* loads an sfx sample and returns its id */

int __cdecl sfx_load_sample(char *path)

{
  byte bVar1;
  void **ppvVar2;
  byte *pbVar3;
  int iVar4;
  char *pcVar5;
  int iVar6;
  byte *pbVar7;
  bool bVar8;
  byte local_80 [128];
  
  if (config_blob.reserved0[0] != '\0') {
    return 1;
  }
  iVar6 = 0;
  ppvVar2 = &sfx_entry_table.pcm_data;
  while (*ppvVar2 != (void *)0x0) {
    ppvVar2 = ppvVar2 + 0x21;
    iVar6 = iVar6 + 1;
    if (0x4cc6e3 < (int)ppvVar2) {
      return -1;
    }
  }
  if (iVar6 != -1) {
    pbVar7 = &DAT_00477dd4;
    pbVar3 = (byte *)path;
    do {
      bVar1 = *pbVar3;
      bVar8 = bVar1 < *pbVar7;
      if (bVar1 != *pbVar7) {
LAB_0043c7c5:
        iVar4 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
        goto LAB_0043c7ca;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar3[1];
      bVar8 = bVar1 < pbVar7[1];
      if (bVar1 != pbVar7[1]) goto LAB_0043c7c5;
      pbVar3 = pbVar3 + 2;
      pbVar7 = pbVar7 + 2;
    } while (bVar1 != 0);
    iVar4 = 0;
LAB_0043c7ca:
    if (iVar4 == 0) {
      console_printf(&console_log_queue,s_Warning__sample___s__not_accepte_00477db0,path);
      path = s_trooper_inPain_01_ogg_00477d98;
    }
    pcVar5 = _strstr(path,&DAT_00477dd4);
    if (pcVar5 == (char *)0x0) {
      iVar4 = sfx_entry_load_wav(&sfx_entry_table + iVar6,(byte *)path);
      if ((char)iVar4 != '\0') goto LAB_0043c885;
      pcVar5 = s____loading_wav_sample___s__faile_00477d48;
    }
    else {
      if (DAT_004cc8d5 == '\0') {
        pcVar5 = s_sfx__s_00477d90;
      }
      else {
        pcVar5 = &DAT_00471fc4;
      }
      crt_sprintf((char *)local_80,pcVar5,path);
      iVar4 = sfx_entry_load_ogg(&sfx_entry_table + iVar6,local_80);
      if ((char)iVar4 != '\0') {
LAB_0043c885:
        if (*(float *)((int)cv_silentloads + 0xc) == 0.0) {
          console_printf(&console_log_queue,s_SFX_Sample__d_<____s__ok_00477d2c,iVar6,path);
        }
        DAT_004cc8d8 = DAT_004cc8d8 + 1;
        return iVar6;
      }
      pcVar5 = s____loading_ogg_sample___s__faile_00477d6c;
    }
    console_printf(&console_log_queue,pcVar5,path);
  }
  return -1;
}



/* music_load_track @ 0043c8d0 */

/* loads a music track and returns its id */

int __cdecl music_load_track(char *path)

{
  void **ppvVar1;
  int iVar2;
  int iVar3;
  
  DAT_004cc8d8 = DAT_004cc8d8 + 1;
  iVar3 = 0;
  ppvVar1 = &music_entry_table.vorbis_stream;
  while ((ppvVar1[-0x18] != (void *)0x0 || (*ppvVar1 != (void *)0x0))) {
    ppvVar1 = ppvVar1 + 0x21;
    iVar3 = iVar3 + 1;
    if (0x4c84c3 < (int)ppvVar1) {
      return -1;
    }
  }
  if (iVar3 == -1) {
    return -1;
  }
  iVar2 = music_entry_load_ogg(&music_entry_table + iVar3,(byte *)path);
  if ((char)iVar2 == '\0') {
    console_printf(&console_log_queue,s_SFX_Tune__d_<____s__FAILED_00477df4,iVar3,path);
    return iVar3;
  }
  console_printf(&console_log_queue,s_SFX_Tune__d_<____s__ok_00477ddc,iVar3,path);
  return iVar3;
}



/* music_queue_track @ 0043c960 */

/* queues a music track id */

void __cdecl music_queue_track(int track_id)

{
  if (-1 < track_id) {
    *(int *)(&music_playlist + DAT_004cc8d0 * 4) = track_id;
    DAT_004cc8d0 = DAT_004cc8d0 + 1;
  }
  return;
}



/* music_release_track @ 0043c980 */

/* releases a music track by id */

int __cdecl music_release_track(int track_id)

{
  uint in_EAX;
  undefined4 extraout_EAX;
  
  if (((-1 < track_id) && (track_id < 0x80)) &&
     (in_EAX = track_id * 0x84, (&music_entry_table)[track_id].pcm_data != (void *)0x0)) {
    sfx_release_entry((int)(&music_entry_table + track_id));
    return CONCAT31((int3)((uint)extraout_EAX >> 8),1);
  }
  return in_EAX & 0xffffff00;
}



/* audio_init_music @ 0043c9c0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* loads music pack and registers music track ids */

void audio_init_music(void)

{
  int iVar1;
  undefined4 *puVar2;
  char *fmt;
  
  if ((config_blob.reserved0[0] == '\0') && (config_blob.reserved0[1] == '\0')) {
    puVar2 = &sfx_mute_flags;
    for (iVar1 = 0x20; iVar1 != 0; iVar1 = iVar1 + -1) {
      *puVar2 = 0x1010101;
      puVar2 = puVar2 + 1;
    }
    puVar2 = &sfx_volume_table;
    for (iVar1 = 0x80; iVar1 != 0; iVar1 = iVar1 + -1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    iVar1 = resource_pack_set(s_music_paq_00477eec);
    DAT_004cc8d5 = (char)iVar1;
    if (DAT_004cc8d5 == '\0') {
      fmt = s____resource_paq__music_paq__not_f_00477e84;
    }
    else {
      fmt = s____set_sound_resource_paq__music_00477ec4;
    }
    console_printf(&console_log_queue,fmt);
    music_track_intro_id = music_load_track(s_music_intro_ogg_00477e74);
    music_track_shortie_monk_id = music_load_track(s_music_shortie_monk_ogg_00477e5c);
    console_exec_line(&console_log_queue,s_exec_music_game_tunes_txt_00477e40);
    music_track_crimson_theme_id = music_load_track(s_music_crimson_theme_ogg_00477e28);
    music_track_crimsonquest_id = music_load_track(s_music_crimsonquest_ogg_00477e10);
    music_track_extra_0 = music_track_crimsonquest_id + 1;
    _music_track_extra_1 = music_track_crimsonquest_id + 2;
    sfx_unmuted_flag = 1;
  }
  return;
}



/* audio_init_sfx @ 0043caa0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* loads sfx pack and registers sound effect ids */

void audio_init_sfx(void)

{
  int iVar1;
  DWORD DVar2;
  DWORD DVar3;
  void **ppvVar4;
  char *fmt;
  
  if (config_blob.reserved0[0] == '\0') {
    iVar1 = resource_pack_set(s_sfx_paq_004784f4);
    DAT_004cc8d5 = (char)iVar1;
    if (DAT_004cc8d5 == '\0') {
      fmt = s____failed_to_set_sound_resource_p_0047849c;
    }
    else {
      fmt = s____set_sound_resource_paq__sfx_p_004784cc;
    }
    console_printf(&console_log_queue,fmt);
    DVar2 = timeGetTime();
    sfx_trooper_inpain_01 = sfx_load_sample(s_trooper_inPain_01_ogg_00477d98);
    sfx_trooper_inpain_02 = sfx_load_sample(s_trooper_inPain_02_ogg_00478484);
    _sfx_trooper_inpain_03 = sfx_load_sample(s_trooper_inPain_03_ogg_0047846c);
    sfx_trooper_die_01 = sfx_load_sample(s_trooper_die_01_ogg_00478458);
    sfx_trooper_die_02 = sfx_load_sample(s_trooper_die_02_ogg_00478444);
    sfx_trooper_die_03 = sfx_load_sample(s_trooper_die_03_ogg_00478430);
    sfx_zombie_die_01 = sfx_load_sample(s_zombie_die_01_ogg_0047841c);
    sfx_zombie_die_02 = sfx_load_sample(s_zombie_die_02_ogg_00478408);
    sfx_zombie_die_03 = sfx_load_sample(s_zombie_die_03_ogg_004783f4);
    sfx_zombie_die_04 = sfx_load_sample(s_zombie_die_04_ogg_004783e0);
    sfx_zombie_attack_01 = sfx_load_sample(s_zombie_attack_01_ogg_004783c8);
    sfx_zombie_attack_02 = sfx_load_sample(s_zombie_attack_02_ogg_004783b0);
    sfx_alien_die_01 = sfx_load_sample(s_alien_die_01_ogg_0047839c);
    sfx_alien_die_02 = sfx_load_sample(s_alien_die_02_ogg_00478388);
    sfx_alien_die_03 = sfx_load_sample(s_alien_die_03_ogg_00478374);
    sfx_alien_die_04 = sfx_load_sample(s_alien_die_04_ogg_00478360);
    sfx_alien_attack_01 = sfx_load_sample(s_alien_attack_01_ogg_0047834c);
    sfx_alien_attack_02 = sfx_load_sample(s_alien_attack_02_ogg_00478338);
    sfx_lizard_die_01 = sfx_load_sample(s_lizard_die_01_ogg_00478324);
    sfx_lizard_die_02 = sfx_load_sample(s_lizard_die_02_ogg_00478310);
    sfx_lizard_die_03 = sfx_load_sample(s_lizard_die_03_ogg_004782fc);
    sfx_lizard_die_04 = sfx_load_sample(s_lizard_die_04_ogg_004782e8);
    sfx_lizard_attack_01 = sfx_load_sample(s_lizard_attack_01_ogg_004782d0);
    sfx_lizard_attack_02 = sfx_load_sample(s_lizard_attack_02_ogg_004782b8);
    sfx_spider_die_01 = sfx_load_sample(s_spider_die_01_ogg_004782a4);
    sfx_spider_die_02 = sfx_load_sample(s_spider_die_02_ogg_00478290);
    sfx_spider_die_03 = sfx_load_sample(s_spider_die_03_ogg_0047827c);
    sfx_spider_die_04 = sfx_load_sample(s_spider_die_04_ogg_00478268);
    sfx_spider_attack_01 = sfx_load_sample(s_spider_attack_01_ogg_00478250);
    sfx_spider_attack_02 = sfx_load_sample(s_spider_attack_02_ogg_00478238);
    sfx_pistol_fire = sfx_load_sample(s_pistol_fire_ogg_00478228);
    sfx_pistol_reload = sfx_load_sample(s_pistol_reload_ogg_00478214);
    sfx_shotgun_fire = sfx_load_sample(s_shotgun_fire_ogg_00478200);
    sfx_shotgun_reload = sfx_load_sample(s_shotgun_reload_ogg_004781ec);
    sfx_autorifle_fire = sfx_load_sample(s_autorifle_fire_ogg_004781d8);
    sfx_autorifle_reload = sfx_load_sample(s_autorifle_reload_ogg_004781c0);
    sfx_gauss_fire = sfx_load_sample(s_gauss_fire_ogg_004781b0);
    sfx_hrpm_fire = sfx_load_sample(s_hrpm_fire_ogg_004781a0);
    sfx_shock_fire = sfx_load_sample(s_shock_fire_ogg_00478190);
    sfx_plasmaminigun_fire = sfx_load_sample(s_plasmaMinigun_fire_ogg_00478178);
    sfx_plasmashotgun_fire = sfx_load_sample(s_plasmaShotgun_fire_ogg_00478160);
    sfx_pulse_fire = sfx_load_sample(s_pulse_fire_ogg_00478150);
    sfx_flamer_fire_01 = sfx_load_sample(s_flamer_fire_01_ogg_0047813c);
    sfx_flamer_fire_02 = sfx_load_sample(s_flamer_fire_02_ogg_00478128);
    sfx_shock_reload = sfx_load_sample(s_shock_reload_ogg_00478114);
    sfx_shock_fire_alt = sfx_load_sample(s_shock_fire_ogg_00478190);
    sfx_shockminigun_fire = sfx_load_sample(s_shockMinigun_fire_ogg_004780fc);
    sfx_rocket_fire = sfx_load_sample(s_rocket_fire_ogg_004780ec);
    sfx_rocketmini_fire = sfx_load_sample(s_rocketmini_fire_ogg_004780d8);
    sfx_autorifle_reload_alt = sfx_load_sample(s_autorifle_reload_ogg_004781c0);
    sfx_bullet_hit_01 = sfx_load_sample(s_bullet_hit_01_ogg_004780c4);
    _sfx_bullet_hit_02 = sfx_load_sample(s_bullet_hit_02_ogg_004780b0);
    _sfx_bullet_hit_03 = sfx_load_sample(s_bullet_hit_03_ogg_0047809c);
    _sfx_bullet_hit_04 = sfx_load_sample(s_bullet_hit_04_ogg_00478088);
    _sfx_bullet_hit_05 = sfx_load_sample(s_bullet_hit_05_ogg_00478074);
    _sfx_bullet_hit_06 = sfx_load_sample(s_bullet_hit_06_ogg_00478060);
    sfx_shock_hit_01 = sfx_load_sample(s_shock_hit_01_ogg_0047804c);
    sfx_explosion_small = sfx_load_sample(s_explosion_small_ogg_00478038);
    sfx_explosion_medium = sfx_load_sample(s_explosion_medium_ogg_00478020);
    sfx_explosion_large = sfx_load_sample(s_explosion_large_ogg_0047800c);
    sfx_shockwave = sfx_load_sample(s_shockwave_ogg_00477ffc);
    sfx_questhit = sfx_load_sample(s_questHit_ogg_00477fec);
    sfx_ui_bonus = sfx_load_sample(s_ui_bonus_ogg_00477fdc);
    _sfx_trooper_inpain_01_alias_0 = sfx_trooper_inpain_01;
    sfx_trooper_inpain_01_alias_1 = sfx_trooper_inpain_01;
    _sfx_trooper_inpain_01_alias_2 = sfx_trooper_inpain_01;
    sfx_ui_buttonclick = sfx_load_sample(s_ui_buttonClick_ogg_00477fc8);
    sfx_ui_panelclick = sfx_load_sample(s_ui_panelClick_ogg_00477fb4);
    sfx_ui_levelup = sfx_load_sample(s_ui_levelUp_ogg_00477fa4);
    _sfx_ui_typeclick_01 = sfx_load_sample(s_ui_typeClick_01_ogg_00477f90);
    _sfx_ui_typeclick_02 = sfx_load_sample(s_ui_typeClick_02_ogg_00477f7c);
    sfx_ui_typeenter = sfx_load_sample(s_ui_typeEnter_ogg_00477f68);
    sfx_ui_clink_01 = sfx_load_sample(s_ui_clink_01_ogg_00477f58);
    sfx_bloodspill_01 = sfx_load_sample(s_bloodSpill_01_ogg_00477f44);
    _sfx_bloodspill_02 = sfx_load_sample(s_bloodSpill_02_ogg_00477f30);
    DVar3 = timeGetTime();
    iVar1 = 0;
    ppvVar4 = &sfx_entry_table.pcm_data;
    do {
      if (*ppvVar4 == (void *)0x0) break;
      ppvVar4 = ppvVar4 + 0x21;
      iVar1 = iVar1 + 1;
    } while ((int)ppvVar4 < 0x4cc6e4);
    console_printf(&console_log_queue,s__d_samples_loaded_to_sound_libra_00477ef8,iVar1,
                   (double)((float)(int)(DVar3 - DVar2) * 0.001));
  }
  return;
}



/* sfx_system_init @ 0043cf90 */

/* initializes the Grim SFX system and clears per-sfx state */

int sfx_system_init(void)

{
  undefined4 in_EAX;
  HWND hwnd;
  int iVar1;
  uint3 extraout_var;
  undefined3 extraout_var_00;
  undefined4 *puVar2;
  uint coop_level;
  
  if (config_blob.reserved0[0] != '\0') {
    return CONCAT31((int3)((uint)in_EAX >> 8),1);
  }
  console_printf(&console_log_queue,s_Initializing_Grim_SFX_sound_syst_004785c8);
  coop_level = 2;
  hwnd = GetForegroundWindow();
  iVar1 = dsound_init(hwnd,coop_level);
  if ((char)iVar1 == '\0') {
    console_printf(&console_log_queue,s____FAILED__unable_to_init_Grim_S_00478590);
    config_blob.reserved0[0] = '\x01';
    config_blob.reserved0[1] = '\x01';
    return (uint)extraout_var << 8;
  }
  console_printf(&console_log_queue,s____init_44100_Hz_16_bit_ok_00478574);
  console_printf(&console_log_queue,s____using_DirectSound_output_00478554);
  console_printf(&console_log_queue,s____using_default_speaker_config_00478530);
  console_printf(&console_log_queue,s____saying_hello_to_the_Ogg__00478510);
  puVar2 = &sfx_cooldown_table;
  for (iVar1 = 0x80; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  puVar2 = &sfx_voice_table;
  for (iVar1 = 0x20; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  console_printf(&console_log_queue,s_Init_Grim_SFX_done_004784fc);
  return CONCAT31(extraout_var_00,1);
}



/* sfx_release_all @ 0043d070 */

/* releases all loaded sfx samples */

void sfx_release_all(void)

{
  char *filename;
  sfx_entry_t *entry;
  
  if (config_blob.reserved0[0] == '\0') {
    entry = &sfx_entry_table;
    do {
      sfx_release_entry((int)entry);
      entry = entry + 1;
    } while ((int)entry < 0x4cc6d0);
    console_printf(&console_log_queue,s_SFX_Shutdown____004785fc);
    console_printf(&console_log_queue,s_SFX_Released__004785ec);
    console_flush_log(&console_log_queue,filename);
  }
  return;
}



/* music_release_all @ 0043d0d0 */

/* releases all loaded music tracks */

void music_release_all(void)

{
  char *filename;
  music_entry_t *entry;
  
  if (sfx_unmuted_flag != '\0') {
    entry = &music_entry_table;
    do {
      sfx_release_entry((int)entry);
      entry = entry + 1;
    } while ((int)entry < 0x4c8450);
    console_flush_log(&console_log_queue,filename);
  }
  return;
}



/* audio_shutdown_all @ 0043d110 */

/* shuts down sfx + music systems */

void audio_shutdown_all(void)

{
  sfx_release_all();
  music_release_all();
  dsound_shutdown();
  return;
}



/* sfx_play @ 0043d120 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* plays a sound effect with centered pan */

int __cdecl sfx_play(int sfx_id)

{
  int iVar1;
  longlong lVar2;
  float unaff_retaddr;
  
  if ((&sfx_entry_table)[sfx_id].pcm_data == (void *)0x0) {
    return -1;
  }
  if (config_blob.reserved0[0] != '\0') {
    return -1;
  }
  if (0.0 < (float)(&sfx_cooldown_table)[sfx_id]) {
    return -1;
  }
  if (_bonus_reflex_boost_timer <= 0.0) {
    sfx_rate_scale = 0xac44;
  }
  else if (_bonus_reflex_boost_timer <= 1.0) {
    if (_bonus_reflex_boost_timer < 1.0) {
      lVar2 = __ftol();
      sfx_rate_scale = (undefined4)lVar2;
    }
  }
  else {
    sfx_rate_scale = 0x5622;
  }
  if ((sfx_id == sfx_flamer_fire_01) || (sfx_id == sfx_flamer_fire_02)) {
    (&sfx_cooldown_table)[sfx_id] = 0x3ee147ae;
  }
  else {
    (&sfx_cooldown_table)[sfx_id] = 0x3d4ccccd;
  }
  iVar1 = sfx_entry_start_playback((int)(&sfx_entry_table + sfx_id));
  (**(code **)(*(int *)(&sfx_entry_table)[sfx_id].buffers[iVar1] + 0x40))
            ((&sfx_entry_table)[sfx_id].buffers[iVar1],0);
  sfx_entry_set_volume((int)(&sfx_entry_table + sfx_id),config_blob.sfx_volume * unaff_retaddr);
  return sfx_id;
}



/* sfx_play_panned @ 0043d260 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* plays a sound effect with computed pan */

float __cdecl sfx_play_panned(float sfx_id)

{
  int iVar1;
  int iVar2;
  float10 in_ST0;
  float10 extraout_ST0;
  longlong lVar3;
  
  if ((&sfx_entry_table)[(int)sfx_id].pcm_data == (void *)0x0) {
    return (float)in_ST0;
  }
  if (config_blob.reserved0[0] != '\0') {
    return (float)in_ST0;
  }
  if (0.0 < (float)(&sfx_cooldown_table)[(int)sfx_id]) {
    return (float)in_ST0;
  }
  if (_bonus_reflex_boost_timer <= 0.0) {
    sfx_rate_scale = 0xac44;
  }
  else if (_bonus_reflex_boost_timer <= 1.0) {
    if (_bonus_reflex_boost_timer < 1.0) {
      lVar3 = __ftol();
      sfx_rate_scale = (undefined4)lVar3;
    }
  }
  else {
    sfx_rate_scale = 0x5622;
  }
  if ((sfx_id == sfx_flamer_fire_01) || (sfx_id == sfx_flamer_fire_02)) {
    (&sfx_cooldown_table)[(int)sfx_id] = 0x3ee147ae;
  }
  else {
    (&sfx_cooldown_table)[(int)sfx_id] = 0x3d4ccccd;
  }
  lVar3 = __ftol();
  iVar2 = (int)lVar3;
  if (iVar2 < -10000) {
    iVar2 = -10000;
  }
  else if (10000 < iVar2) {
    iVar2 = 10000;
  }
  iVar1 = sfx_entry_start_playback((int)(&sfx_entry_table + (int)sfx_id));
  (**(code **)(*(int *)(&sfx_entry_table)[(int)sfx_id].buffers[iVar1] + 0x40))
            ((&sfx_entry_table)[(int)sfx_id].buffers[iVar1],iVar2);
  sfx_entry_set_volume((int)(&sfx_entry_table + (int)sfx_id),config_blob.sfx_volume * sfx_id);
  return (float)extraout_ST0;
}



/* audio_update @ 0043d3f0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* updates sfx cooldowns, music streams, and mute fades */

void audio_update(void)

{
  float *pfVar1;
  music_entry_t *entry;
  
  if (config_blob.reserved0[0] == '\0') {
    pfVar1 = (float *)&sfx_cooldown_table;
    do {
      if (0.0 < *pfVar1) {
        *pfVar1 = *pfVar1 - _DAT_0047ea48;
      }
      pfVar1 = pfVar1 + 1;
    } while ((int)pfVar1 < 0x4c3e80);
    if (sfx_unmuted_flag != '\0') {
      entry = &music_entry_table;
      do {
        if (entry->vorbis_stream != (void *)0x0) {
          music_stream_update((int)entry);
        }
        entry = entry + 1;
      } while ((int)entry < 0x4c8450);
      sfx_update_mute_fades();
    }
  }
  return;
}



/* sfx_play_exclusive @ 0043d460 */

/* mutes other sfx ids and ensures the chosen id is audible */

void __cdecl sfx_play_exclusive(int sfx_id)

{
  float fVar1;
  int iVar2;
  int iVar3;
  
  if (((sfx_unmuted_flag != '\0') && (config_blob.reserved0[1] == '\0')) &&
     (config_blob.reserved0[0] == '\0')) {
    if (DAT_004824d1 == '\0') {
      if (sfx_id == music_track_extra_0) {
        if (DAT_004cc8d4 != '\0') {
          return;
        }
        if (DAT_004cc8d0 == 0) {
          return;
        }
        iVar2 = crt_rand();
        DAT_004cc8d4 = '\x01';
        sfx_id = *(int *)(&music_playlist + (iVar2 % DAT_004cc8d0) * 4);
      }
      else {
        DAT_004cc8d4 = '\0';
      }
    }
    iVar2 = 0;
    do {
      if ((iVar2 != sfx_id) && (iVar3 = sfx_is_unmuted(iVar2), (char)iVar3 != '\0')) {
        sfx_mute_all(iVar2);
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 < 0x80);
    if ((float)(&sfx_volume_table)[sfx_id] <= 0.0) {
      sfx_entry_start_playback((int)(&music_entry_table + sfx_id));
      sfx_entry_set_volume((int)(&music_entry_table + sfx_id),config_blob.music_volume);
      fVar1 = config_blob.music_volume;
      *(undefined1 *)((int)&sfx_mute_flags + sfx_id) = 0;
      (&sfx_volume_table)[sfx_id] = fVar1;
    }
  }
  return;
}



/* sfx_mute_all @ 0043d550 */

/* mutes all unmuted sfx ids (recursive) */

void __cdecl sfx_mute_all(int sfx_id)

{
  int iVar1;
  int sfx_id_00;
  
  if (((sfx_unmuted_flag != '\0') && (config_blob.reserved0[1] == '\0')) &&
     (config_blob.reserved0[0] == '\0')) {
    DAT_004cc8d4 = 0;
    sfx_id_00 = 0;
    do {
      if (sfx_id_00 != sfx_id) {
        iVar1 = sfx_is_unmuted(sfx_id_00);
        if ((char)iVar1 != '\0') {
          sfx_mute_all(sfx_id_00);
        }
      }
      sfx_id_00 = sfx_id_00 + 1;
    } while (sfx_id_00 < 0x80);
    *(undefined1 *)((int)&sfx_mute_flags + sfx_id) = 1;
  }
  return;
}



/* sfx_update_mute_fades @ 0043d5b0 */

/* ramps volume up/down based on mute flags */

void sfx_update_mute_fades(void)

{
  float fVar1;
  int iVar2;
  music_entry_t *entry;
  float *pfVar3;
  float volume;
  byte abStack_4 [4];
  
  if ((audio_suspend_flag == '\0') && (sfx_unmuted_flag != '\0')) {
    iVar2 = 0;
    pfVar3 = (float *)&sfx_volume_table;
    entry = &music_entry_table;
    do {
      if (entry->vorbis_stream != (void *)0x0) {
        if (0.0 < config_blob.music_volume) {
          if (*(char *)((int)&sfx_mute_flags + iVar2) == '\0') {
            (**(code **)(*(int *)entry->buffers[0] + 0x24))(entry->buffers[0],abStack_4);
            if ((abStack_4[0] & 1) == 0) {
              console_printf(&console_log_queue,s_SND__detected_unsilenced_hearabl_00478610);
              sfx_entry_resume((int)entry);
            }
            goto LAB_0043d63c;
          }
        }
        else {
          (**(code **)(*(int *)entry->buffers[0] + 0x48))(entry->buffers[0]);
LAB_0043d63c:
          fVar1 = config_blob.music_volume;
          if (*(char *)((int)&sfx_mute_flags + iVar2) == '\0') {
            if (config_blob.music_volume <= *pfVar3) {
              if (*pfVar3 <= config_blob.music_volume) goto LAB_0043d709;
              *pfVar3 = config_blob.music_volume;
LAB_0043d6ff:
              volume = fVar1;
            }
            else {
              volume = frame_dt + *pfVar3;
              *pfVar3 = volume;
              fVar1 = config_blob.music_volume;
              if (config_blob.music_volume <= volume) goto LAB_0043d6ff;
            }
            sfx_entry_set_volume((int)entry,volume);
            goto LAB_0043d709;
          }
        }
        if (0.0 < *pfVar3) {
          fVar1 = *pfVar3 - frame_dt * 0.5;
          *pfVar3 = fVar1;
          if (0.0 < fVar1) {
            sfx_entry_set_volume((int)entry,fVar1);
          }
          else {
            sfx_entry_stop((int)entry);
          }
        }
        if (*pfVar3 < 0.0) {
          *pfVar3 = 0.0;
        }
      }
LAB_0043d709:
      entry = entry + 1;
      iVar2 = iVar2 + 1;
      pfVar3 = pfVar3 + 1;
    } while ((int)entry < 0x4c8450);
  }
  return;
}



/* audio_suspend_channels @ 0043d730 */

/* iterates channels and suspends playback */

void audio_suspend_channels(void)

{
  music_entry_t *entry;
  
  if (((sfx_unmuted_flag != '\0') && (config_blob.reserved0[1] == '\0')) &&
     (config_blob.reserved0[0] == '\0')) {
    entry = &music_entry_table;
    do {
      sfx_entry_stop((int)entry);
      entry = entry + 1;
    } while ((int)entry < 0x4c8450);
  }
  return;
}



/* audio_resume_channels @ 0043d770 */

/* iterates channels and resumes playback */

void audio_resume_channels(void)

{
  music_entry_t *entry;
  int iVar1;
  
  if (((sfx_unmuted_flag != '\0') && (config_blob.reserved0[1] == '\0')) &&
     (config_blob.reserved0[0] == '\0')) {
    iVar1 = 0;
    entry = &music_entry_table;
    do {
      if (*(char *)((int)&sfx_mute_flags + iVar1) == '\0') {
        sfx_entry_resume((int)entry);
      }
      entry = entry + 1;
      iVar1 = iVar1 + 1;
    } while ((int)entry < 0x4c8450);
  }
  return;
}



/* sfx_is_unmuted @ 0043d7c0 */

/* returns nonzero when sfx id is not muted */

int __cdecl sfx_is_unmuted(int sfx_id)

{
  uint in_EAX;
  
  if (sfx_unmuted_flag == '\0') {
    return in_EAX & 0xffffff00;
  }
  return (uint)(*(char *)((int)&sfx_mute_flags + sfx_id) == '\0');
}



/* ui_focus_set @ 0043d7e0 */

/* sets the active focus candidate; optionally resets the focus timer */

void __cdecl ui_focus_set(int id,char reset_timer)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  
  iVar1 = DAT_004d11e4;
  if ((&ui_focus_candidates)[DAT_004d11e4] != id) {
    if (reset_timer != '\0') {
      DAT_004d11ec = 1000;
    }
    iVar2 = 0;
    if (0 < DAT_004d11e0) {
      piVar3 = &ui_focus_candidates;
      while (iVar1 = iVar2, *piVar3 != id) {
        iVar2 = iVar2 + 1;
        piVar3 = piVar3 + 1;
        if (DAT_004d11e0 <= iVar2) {
          return;
        }
      }
    }
  }
  DAT_004d11e4 = iVar1;
  return;
}



/* ui_focus_update @ 0043d830 */

/* handles menu focus navigation and returns 1 when the given id is focused */

int __cdecl ui_focus_update(int id)

{
  int iVar1;
  int iVar2;
  uint unaff_EBX;
  uint unaff_ESI;
  uint unaff_retaddr;
  
  iVar1 = (&ui_focus_candidates)[DAT_004d11e4];
  if (DAT_004d11e8 == DAT_00480848) {
    if (0x1f < DAT_004d11e0) {
      DAT_004d11e0 = 0x1f;
    }
    (&ui_focus_candidates)[DAT_004d11e0] = id;
    DAT_004d11e0 = DAT_004d11e0 + 1;
    return CONCAT31((int3)((uint)DAT_004d11e0 >> 8),id == iVar1);
  }
  DAT_004d11ec = DAT_004d11ec - frame_dt_ms;
  if (DAT_004d11ec < 0) {
    DAT_004d11ec = 0;
  }
  if ((DAT_004871ca == '\0') &&
     (iVar2 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xf,unaff_ESI),
     (char)iVar2 != '\0')) {
    iVar2 = (*grim_interface_ptr->vtable->grim_is_key_down)((IGrim2D *)0x2a,unaff_EBX);
    if (((char)iVar2 == '\0') &&
       (iVar2 = (*grim_interface_ptr->vtable->grim_is_key_down)((IGrim2D *)0x36,unaff_retaddr),
       (char)iVar2 == '\0')) {
      DAT_004d11e4 = DAT_004d11e4 + 1;
    }
    else {
      DAT_004d11e4 = DAT_004d11e4 + -1;
    }
    DAT_004d11ec = 1000;
  }
  if (DAT_004d11e4 < 0) {
    DAT_004d11e4 = DAT_004d11e0 + -1;
  }
  if (DAT_004d11e0 + -1 < DAT_004d11e4) {
    DAT_004d11e4 = 0;
  }
  DAT_004d11e8 = DAT_00480848;
  ui_focus_candidates = id;
  DAT_004d11e0 = 1;
  return (uint)(id == iVar1);
}



/* ui_focus_draw @ 0043d940 */

/* draws the focus highlight for the active menu item */

void __cdecl ui_focus_draw(float *xy)

{
  IGrim2D local_18;
  float local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  float local_4;
  
  local_10 = 0x3f4ccccd;
  local_4 = (float)DAT_004d11ec * 0.00080000004;
  local_c = 0x3f4ccccd;
  local_8 = 0x3f19999a;
  local_18.vtable = (IGrim2D_vtbl *)*xy;
  local_14 = xy[1] + 4.0;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            (&local_18,(float *)0x40c00000,6.0,(float)&local_10);
  return;
}



/* FUN_0043d9b0 @ 0043d9b0 */

/* [binja] int32_t sub_43d9b0(int32_t* arg1, int32_t arg2) */

int __cdecl FUN_0043d9b0(int *arg1,int arg2)

{
  float x;
  int id;
  int iVar1;
  int iVar2;
  IGrim2D *unaff_EBX;
  char *unaff_EBP;
  uint unaff_ESI;
  uint unaff_EDI;
  longlong lVar3;
  IGrim2D *unaff_retaddr;
  char cStack00000010;
  float in_stack_00000020;
  float a;
  float v1;
  IGrim2D *self;
  int in_stack_fffffffc;
  
  id = arg2;
  iVar1 = ui_focus_update(arg2);
  arg2 = arg2 & 0xffffff00;
  self = (IGrim2D *)*arg1;
  a = (float)*arg1 - 3.0;
  x = (float)arg1[1];
  v1 = (float)arg1[1] - 1.0;
  lVar3 = __ftol();
  iVar2 = ui_mouse_inside_rect((float *)&stack0xfffffff0,0x12,(int)lVar3);
  if ((char)iVar2 != '\0') {
    arg2 = CONCAT31(SUB43(id,1),1);
    ui_focus_set(id,'\0');
  }
  if ((char)iVar1 != '\0') {
    a = (float)*arg1 - 16.0;
    v1 = (float)arg1[1];
    ui_focus_draw((float *)&stack0xfffffff0);
    if (*(char *)(id + 0xc) != '\0') {
      iVar1 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xcd,unaff_EDI);
      if ((char)iVar1 != '\0') {
        iVar1 = *(int *)id;
        *(int *)id = iVar1 + 1;
        if (*(int *)(id + 4) < iVar1 + 1) {
          *(int *)id = *(int *)(id + 4);
        }
      }
      iVar1 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xcb,unaff_ESI);
      if (((char)iVar1 != '\0') && (iVar1 = *(int *)id, *(int *)id = iVar1 + -1, iVar1 + -1 < 0)) {
        *(undefined4 *)id = 0;
      }
    }
  }
  if (((cStack00000010 != '\0') && (iVar1 = input_primary_is_down(), (char)iVar1 != '\0')) &&
     (*(char *)(id + 0xc) != '\0')) {
    lVar3 = __ftol();
    *(int *)id = (int)lVar3;
    if ((int)lVar3 < *(int *)(id + 8)) {
      *(int *)id = *(int *)(id + 8);
    }
    if (*(int *)(id + 4) < *(int *)id) {
      *(int *)id = *(int *)(id + 4);
    }
  }
  if (DAT_00478668 == -1) {
    DAT_00478668 = (*grim_interface_ptr->vtable->grim_get_texture_handle)
                             ((IGrim2D *)s_ui_rectOn_004743f4,unaff_EBP);
  }
  if (DAT_0047866c == -1) {
    DAT_0047866c = (*grim_interface_ptr->vtable->grim_get_texture_handle)
                             ((IGrim2D *)s_ui_rectOff_00474414,unaff_EBP);
  }
  (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)DAT_0047866c,0,(int)unaff_EBP);
  (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_EBX);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.5,a);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,v1);
  iVar1 = 0;
  if (0 < *(int *)(id + 4)) {
    in_stack_00000020 = 0.0;
    do {
      (*grim_interface_ptr->vtable->grim_draw_quad)
                ((IGrim2D *)(_cStack00000010 + 0.0),x,8.0,16.0,(float)self);
      iVar1 = iVar1 + 1;
    } while (iVar1 < *(int *)(id + 4));
  }
  iVar1 = (*grim_interface_ptr->vtable->grim_end_batch)(self);
  if (0 < *(int *)id) {
    (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)DAT_00478668,0,in_stack_fffffffc);
    (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_retaddr);
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,(float)arg1);
    iVar1 = 0;
    if (0 < *(int *)id) {
      do {
        (*grim_interface_ptr->vtable->grim_draw_quad)
                  ((IGrim2D *)(in_stack_00000020 + 0.0),x,8.0,16.0,(float)arg2);
        iVar1 = iVar1 + 1;
      } while (iVar1 < *(int *)id);
    }
    iVar1 = (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)arg2);
  }
  return iVar1;
}



/* ui_checkbox_update @ 0043dc80 */

/* draws a checkbox widget, handles hover/focus, toggles on click */

int __cdecl ui_checkbox_update(float *xy,char *checkbox)

{
  IGrim2D_vtbl *pIVar1;
  char *id;
  char cVar2;
  int iVar3;
  int iVar4;
  IGrim2D *self;
  undefined4 uVar5;
  float unaff_EBP;
  uint unaff_ESI;
  char *unaff_EDI;
  IGrim2D *unaff_retaddr;
  char in_stack_00000014;
  char *pcVar6;
  uint value;
  uint3 in_stack_fffffff4;
  IGrim2D *self_00;
  float a;
  float in_stack_fffffff8;
  float in_stack_fffffffc;
  
  id = checkbox;
  self_00 = (IGrim2D *)(uint)in_stack_fffffff4;
  iVar3 = ui_focus_update((int)checkbox);
  checkbox = (char *)CONCAT31(checkbox._1_3_,(char)iVar3);
  id[2] = '\0';
  if (*(IGrim2D **)(id + 4) == (IGrim2D *)0x0) {
    iVar4 = ui_mouse_inside_rect(xy,0x10,0x10);
    cVar2 = (char)iVar4;
    checkbox = (char *)xy;
  }
  else {
    iVar4 = (*grim_interface_ptr->vtable->grim_measure_text_width)(*(IGrim2D **)(id + 4),unaff_EDI);
    unaff_EDI = (char *)(iVar4 + 0x16);
    iVar4 = ui_mouse_inside_rect((float *)checkbox,0x10,(int)unaff_EDI);
    cVar2 = (char)iVar4;
  }
  if (cVar2 != '\0') {
    id[2] = '\x01';
  }
  if (id[1] != '\0') {
    id[2] = '\0';
  }
  if (id[2] != '\0') {
    ui_focus_set((int)id,'\0');
  }
  if ((char)iVar3 != '\0') {
    in_stack_fffffff8 = *(float *)checkbox - 16.0;
    in_stack_fffffffc = *(float *)((int)checkbox + 4);
    ui_focus_draw((float *)&stack0xfffffff8);
  }
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,(float)unaff_EDI);
  pIVar1 = grim_interface_ptr->vtable;
  if (*id == '\0') {
    pcVar6 = s_ui_checkOff_00474434;
  }
  else {
    pcVar6 = s_ui_checkOn_00474454;
  }
  self = (IGrim2D *)(*pIVar1->grim_get_texture_handle)((IGrim2D *)pcVar6,(char *)0x0);
  (*pIVar1->grim_bind_texture)(self,unaff_ESI,(int)unaff_EBP);
  if (DAT_004871ca != '\0') goto LAB_0043ddb8;
  if (in_stack_00000014 == '\0') {
LAB_0043dd9a:
    if (id[2] == '\0') goto LAB_0043ddb8;
    self_00 = (IGrim2D *)0x43dda6;
    iVar3 = input_primary_just_pressed();
    if ((char)iVar3 == '\0') goto LAB_0043ddb8;
  }
  else {
    unaff_EBP = 3.92364e-44;
    unaff_ESI = 0x43dd96;
    iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1c,(uint)self_00);
    if ((char)iVar3 == '\0') goto LAB_0043dd9a;
  }
  xy = (float *)0x1000000;
  *id = *id == '\0';
LAB_0043ddb8:
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,unaff_ESI);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_EBP);
  (*grim_interface_ptr->vtable->grim_begin_batch)(self_00);
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,in_stack_fffffff8);
  pcVar6 = (char *)0x41800000;
  (*grim_interface_ptr->vtable->grim_draw_quad)
            (*(IGrim2D **)checkbox,*(float *)((int)checkbox + 4),16.0,16.0,in_stack_fffffffc);
  (*grim_interface_ptr->vtable->grim_end_batch)(unaff_retaddr);
  value = 0x15;
  a = 2.8026e-45;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,(uint)pcVar6);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,value);
  if (id[2] == '\0') {
    uVar5 = (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.7,a);
  }
  else {
    uVar5 = (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,a);
  }
  if (*(float *)(id + 4) != 0.0) {
    uVar5 = (*grim_interface_ptr->vtable->grim_draw_text_small)
                      ((IGrim2D *)(*(float *)checkbox + 22.0),*(float *)((int)checkbox + 4) + 1.0,
                       *(float *)(id + 4),pcVar6);
  }
  return CONCAT31((int3)((uint)uVar5 >> 8),xy._3_1_);
}



/* ui_scrollbar_update @ 0043def0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* updates and renders a scroll bar (wheel, drag, key input) */

void __cdecl ui_scrollbar_update(float *xy,float *state)

{
  float fVar1;
  float fVar2;
  char cVar3;
  float fVar4;
  float *w;
  float *pfVar5;
  int iVar6;
  uint uVar7;
  uint unaff_EBX;
  uint unaff_EBP;
  char *y;
  IGrim2D *unaff_ESI;
  IGrim2D *unaff_EDI;
  char *pcVar8;
  float10 extraout_ST0;
  float10 extraout_ST0_00;
  float10 extraout_ST0_01;
  longlong lVar9;
  char cStack0000000c;
  undefined4 in_stack_00000010;
  undefined4 in_stack_00000014;
  int in_stack_00000018;
  float fStack0000001c;
  float in_stack_00000020;
  int in_stack_00000024;
  float fVar10;
  uint in_stack_ffffffc4;
  char *in_stack_ffffffc8;
  IGrim2D local_30;
  float local_2c;
  float *local_28;
  int local_24;
  float fStack_20;
  float fStack_1c;
  IGrim2D IStack_18;
  float fStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  float fStack_8;
  float fStack_4;
  
  lVar9 = __ftol();
  *xy = (float)(int)lVar9;
  lVar9 = __ftol();
  pfVar5 = state;
  xy[1] = (float)(int)lVar9;
  state[1] = -NAN;
  iVar6 = ui_focus_update((int)state);
  if ((char)iVar6 != '\0') {
    local_30.vtable = (IGrim2D_vtbl *)(*xy - 16.0);
    local_2c = xy[1];
    ui_focus_draw((float *)&local_30);
  }
  w = (float *)(float)((int)pfVar5[3] * 0x10 + 4);
  local_30.vtable = (IGrim2D_vtbl *)0x3f800000;
  local_2c = 1.0;
  local_28 = (float *)0x3f800000;
  local_24 = 0x3f800000;
  state = w;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            ((IGrim2D *)xy,(float *)0x437a0000,(float)w,(float)&local_30);
  local_30.vtable = (IGrim2D_vtbl *)(*xy + 1.0);
  uStack_10 = 0;
  local_2c = xy[1] + 1.0;
  uStack_c = 0;
  fStack_8 = 0.0;
  fStack_4 = 1.0;
  fVar10 = (float)state - 2.0;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            (&local_30,(float *)0x43780000,fVar10,(float)&uStack_10);
  if ((int)pfVar5[3] < (int)pfVar5[0xd]) {
    local_30.vtable = (IGrim2D_vtbl *)(*xy + 240.0);
    uStack_10 = 0x3f800000;
    local_2c = xy[1];
    uStack_c = 0x3f800000;
    fStack_8 = 1.0;
    fStack_4 = 0.8;
    (*grim_interface_ptr->vtable->grim_draw_rect_filled)
              (&local_30,(float *)0x3f800000,(float)w,(float)&uStack_10);
  }
  (*grim_interface_ptr->vtable->grim_get_mouse_wheel_delta)(unaff_EDI);
  if ((float10)0.0 < extraout_ST0) {
    *pfVar5 = *pfVar5 - 1.0;
  }
  (*grim_interface_ptr->vtable->grim_get_mouse_wheel_delta)(unaff_ESI);
  if (extraout_ST0_00 < (float10)0.0) {
    *pfVar5 = *pfVar5 + 1.0;
  }
  if (cStack0000000c != '\0') {
    iVar6 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xc8,unaff_EBP);
    if ((char)iVar6 != '\0') {
      *pfVar5 = *pfVar5 - 1.0;
    }
    iVar6 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xd0,unaff_EBX);
    if ((char)iVar6 != '\0') {
      *pfVar5 = *pfVar5 + 1.0;
    }
  }
  iVar6 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xc9,(uint)fVar10);
  if ((char)iVar6 != '\0') {
    in_stack_00000018 = (int)pfVar5[3] + -1;
    *pfVar5 = *pfVar5 - (float)in_stack_00000018;
  }
  iVar6 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xd1,in_stack_ffffffc4);
  if ((char)iVar6 != '\0') {
    *pfVar5 = (float)((int)pfVar5[3] + -1) + *pfVar5;
  }
  fVar10 = pfVar5[0xd];
  fVar4 = pfVar5[3];
  fStack_1c = (float)((int)fVar10 - (int)fVar4);
  if ((float)(int)fStack_1c < *pfVar5) {
    *pfVar5 = (float)(int)fStack_1c;
  }
  if (*pfVar5 < 0.0) {
    *pfVar5 = 0.0;
  }
  fStack0000001c = fVar10;
  fStack_20 = fVar4;
  lVar9 = __ftol();
  fStack_1c = (float)lVar9;
  fStack0000001c = ((float)(int)fStack_20 / (float)(int)fStack0000001c) * (float)local_28;
  if ((float)local_28 < fStack0000001c) {
    fStack0000001c = in_stack_00000020 - 3.0;
  }
  fVar1 = *xy;
  fVar2 = (float)(((((float10)in_stack_00000020 - (float10)3.0) - (float10)fStack0000001c) /
                  extraout_ST0_01) * (float10)(int)fStack_1c + (float10)1.0 + (float10)xy[1]);
  if ((int)fVar4 < (int)fVar10) {
    state = (float *)0x3f800000;
    _cStack0000000c = 0x3f800000;
    in_stack_00000010 = 0x3f800000;
    in_stack_00000014 = 0x3f4ccccd;
    (*grim_interface_ptr->vtable->grim_draw_rect_filled)
              ((IGrim2D *)&stack0x00000000,(float *)0x41000000,fStack0000001c + 1.0,(float)&state);
    IStack_18.vtable = (IGrim2D_vtbl *)(*xy + 240.0);
    iVar6 = 10;
    fStack_14 = xy[1];
    lVar9 = __ftol();
    iVar6 = ui_mouse_inside_rect((float *)&IStack_18,(int)lVar9,iVar6);
    if ((char)iVar6 == '\0') {
      IStack_18.vtable = (IGrim2D_vtbl *)(fVar1 + 241.0 + 1.0);
      fStack_14 = fVar2 + 1.0;
      state = (float *)0x3dcccccd;
      _cStack0000000c = 0x3e4ccccd;
      in_stack_00000010 = 0x3ecccccd;
      in_stack_00000014 = 0x3f800000;
      (*grim_interface_ptr->vtable->grim_draw_rect_filled)
                (&IStack_18,(float *)0x40c00000,fStack0000001c - 1.0,(float)&state);
      iVar6 = input_primary_is_down();
      if ((char)iVar6 == '\0') {
        DAT_004d11fa = '\0';
        goto LAB_0043e37f;
      }
    }
    else {
      IStack_18.vtable = (IGrim2D_vtbl *)(fVar1 + 241.0 + 1.0);
      fStack_14 = fVar2 + 1.0;
      state = (float *)0x3e4ccccd;
      _cStack0000000c = 0x3ecccccd;
      in_stack_00000010 = 0x3f4ccccd;
      in_stack_00000014 = 0x3f800000;
      (*grim_interface_ptr->vtable->grim_draw_rect_filled)
                (&IStack_18,(float *)0x40c00000,fStack0000001c - 1.0,(float)&state);
      DAT_004d11fa = '\x01';
      iVar6 = input_primary_just_pressed();
      if ((char)iVar6 != '\0') {
        iVar6 = 8;
        lVar9 = __ftol();
        iVar6 = ui_mouse_inside_rect((float *)&stack0x00000000,(int)lVar9,iVar6);
        if ((char)iVar6 == '\0') {
          _DAT_004d11fc = 0.0;
        }
        else {
          _DAT_004d11fc =
               (ui_mouse_y - xy[1]) - (*pfVar5 / (float)(int)pfVar5[0xd]) * in_stack_00000020;
        }
      }
    }
    if ((DAT_004d11fa != '\0') && (iVar6 = input_primary_is_down(), (char)iVar6 != '\0')) {
      fVar10 = (((ui_mouse_y - xy[1]) - _DAT_004d11fc) / in_stack_00000020) *
               (float)(int)pfVar5[0xd];
      *pfVar5 = fVar10;
      fStack0000001c = (float)((int)pfVar5[0xd] - (int)pfVar5[3]);
      if (fStack0000001c < fVar10) {
        *pfVar5 = fStack0000001c;
      }
      if (*pfVar5 < 0.0) {
        *pfVar5 = 0.0;
      }
    }
  }
LAB_0043e37f:
  fStack_4 = xy[1];
  fStack_8 = *xy - 2.0;
  local_24 = 0;
  if (0 < (int)pfVar5[3]) {
    fStack_20 = (float)((int)fStack_1c * 4);
    do {
      fVar10 = fStack_1c;
      if ((int)pfVar5[0xd] <= local_24) {
        return;
      }
      iVar6 = ui_mouse_inside_rect(&fStack_8,0x11,0xf0);
      if ((char)iVar6 == '\0') {
        fStack0000001c = 0.9;
        if (pfVar5[2] != fVar10) {
          fStack0000001c = 0.7;
        }
      }
      else {
        fStack0000001c = 1.0;
        pfVar5[1] = fVar10;
        iVar6 = input_primary_just_pressed();
        if ((char)iVar6 != '\0') {
          pfVar5[2] = fVar10;
        }
      }
      y = *(char **)((int)pfVar5[0xc] + (int)fStack_20);
      if (*y == '\\') {
        if (y[1] == 'g') {
          (*grim_interface_ptr->vtable->grim_set_color)
                    ((IGrim2D *)0x3f333333,1.0,0.7,fStack0000001c,(float)in_stack_ffffffc8);
          y = y + 2;
        }
      }
      else {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,fStack0000001c,(float)in_stack_ffffffc8);
      }
      uVar7 = 0xffffffff;
      iVar6 = 0;
      pcVar8 = y;
      do {
        if (uVar7 == 0) break;
        uVar7 = uVar7 - 1;
        cVar3 = *pcVar8;
        pcVar8 = pcVar8 + 1;
      } while (cVar3 != '\0');
      uVar7 = ~uVar7;
      in_stack_00000020 = 0.0;
      if (0 < (int)uVar7) {
        local_28 = pfVar5 + 4;
        do {
          if ((y[iVar6] == '\t') || (y[iVar6] == '\0')) {
            y[iVar6] = '\0';
            IStack_18.vtable = (IGrim2D_vtbl *)((int)*local_28 * (int)in_stack_00000020);
            (*grim_interface_ptr->vtable->grim_draw_text_small)
                      ((IGrim2D *)((float)(int)IStack_18.vtable + fStack_8 + 8.0),fStack_4 + 2.0,
                       (float)y,in_stack_ffffffc8);
            in_stack_00000024 = in_stack_00000024 + 1;
            local_24 = local_24 + 4;
            y = y + iVar6 + 1;
            uVar7 = uVar7 - (iVar6 + 1);
            iVar6 = 0;
          }
          iVar6 = iVar6 + 1;
        } while (iVar6 < (int)uVar7);
      }
      fStack_4 = fStack_4 + 16.0;
      local_24 = local_24 + 1;
      fStack_20 = (float)((int)fStack_20 + 4);
      fStack_1c = (float)((int)fStack_1c + 1);
    } while (local_24 < (int)pfVar5[3]);
  }
  return;
}



/* ui_menu_item_update @ 0043e5e0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* draws a text menu item, updates hover/press state, and returns 1 when activated */

int __cdecl ui_menu_item_update(float *xy,int *item)

{
  float *xy_00;
  int *id;
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  undefined3 uVar4;
  IGrim2D *unaff_EBX;
  char *unaff_ESI;
  float *unaff_EDI;
  longlong lVar5;
  float fStack0000000c;
  float *in_stack_00000014;
  float in_stack_fffffff8;
  IGrim2D *in_stack_fffffffc;
  
  id = item;
  iVar1 = ui_focus_update((int)item);
  if ((DAT_004cc910 & 1) == 0) {
    DAT_004cc910 = DAT_004cc910 | 1;
    _DAT_004ccd40 = 0x3e8c8c8d;
    _DAT_004ccd44 = 0x3f34b4b5;
    _DAT_004ccd48 = 0x3f70f0f1;
    _DAT_004ccd4c = 0x3f19999a;
    crt_atexit(&DAT_0043e820);
  }
  if ((DAT_004cc910 & 2) == 0) {
    DAT_004cc910 = DAT_004cc910 | 2;
    _DAT_004d0e28 = 0x3e8c8c8d;
    _DAT_004d0e2c = 0x3f34b4b5;
    _DAT_004d0e30 = 0x3f70f0f1;
    _DAT_004d0e34 = 0x3f800000;
    crt_atexit(&DAT_0043e810);
  }
  xy_00 = xy;
  if ((char)iVar1 != '\0') {
    in_stack_fffffff8 = *xy - 16.0;
    in_stack_fffffffc = (IGrim2D *)xy[1];
    ui_focus_draw((float *)&stack0xfffffff8);
  }
  iVar2 = (*grim_interface_ptr->vtable->grim_measure_text_width)((IGrim2D *)*id,unaff_ESI);
  fStack0000000c = (float)iVar2;
  if (fStack0000000c <= 0.0) {
    fStack0000000c = 8.0;
  }
  lVar5 = __ftol();
  iVar2 = ui_mouse_inside_rect(xy_00,0x10,(int)lVar5);
  *(char *)(id + 1) = (char)iVar2;
  if ((char)iVar2 == '\0') {
    (*grim_interface_ptr->vtable->grim_set_color_ptr)((IGrim2D *)&DAT_004ccd40,unaff_EDI);
  }
  else {
    ui_focus_set((int)id,'\0');
    (*grim_interface_ptr->vtable->grim_set_color_ptr)((IGrim2D *)&DAT_004d0e28,unaff_EDI);
  }
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,*xy_00,xy_00[1],&DAT_00471fc4,*id);
  (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_EBX);
  xy = (float *)*xy_00;
  item = (int *)(xy_00[1] + 13.0);
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            ((IGrim2D *)&xy,in_stack_00000014,1.0,in_stack_fffffff8);
  uVar3 = (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_fffffffc);
  uVar4 = (undefined3)((uint)uVar3 >> 8);
  if (*(char *)((int)id + 6) == '\0') {
    *(undefined1 *)((int)id + 5) = 0;
    goto LAB_0043e7e0;
  }
  if ((char)iVar1 != '\0') {
    iVar1 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1c,(uint)xy);
    if ((char)iVar1 != '\0') {
LAB_0043e7cb:
      uVar4 = 0;
      *(undefined1 *)((int)id + 5) = 1;
      goto LAB_0043e7e0;
    }
    if ((char)id[1] != '\0') {
      xy = (float *)0x43e7c7;
      iVar1 = input_primary_just_pressed();
      if ((char)iVar1 != '\0') goto LAB_0043e7cb;
    }
  }
  uVar4 = 0;
  *(undefined1 *)((int)id + 5) = 0;
LAB_0043e7e0:
  iVar1 = CONCAT31(uVar4,*(char *)((int)id + 5));
  if (*(char *)((int)id + 5) != '\0') {
    xy = (float *)0x3f800000;
    iVar1 = sfx_play(sfx_ui_buttonclick);
  }
  return CONCAT31((int3)((uint)iVar1 >> 8),*(undefined1 *)((int)id + 5));
}



/* ui_button_update @ 0043e830 */

/* draws a UI button, updates hover/press state, and returns 1 when activated */

int __cdecl ui_button_update(float *xy,ui_button_t *button)

{
  int iVar1;
  IGrim2D *self;
  undefined4 uVar2;
  undefined3 uVar3;
  IGrim2D_vtbl *pIVar4;
  char *unaff_EBP;
  char *unaff_ESI;
  char *unaff_EDI;
  longlong lVar5;
  float fStack0000000c;
  char in_stack_00000010;
  float in_stack_00000014;
  float in_stack_00000018;
  char in_stack_0000001c;
  uint uVar6;
  undefined *y;
  int in_stack_ffffffe4;
  float fVar7;
  IGrim2D *pIVar8;
  float fVar9;
  float in_stack_ffffffec;
  uint key;
  IGrim2D self_00;
  float fStack_8;
  float fStack_4;
  
  iVar1 = ui_focus_update((int)button);
  if ((char)iVar1 != '\0') {
    in_stack_ffffffec = xy[1];
    ui_focus_draw((float *)&stack0xffffffe8);
  }
  iVar1 = (*grim_interface_ptr->vtable->grim_measure_text_width)((IGrim2D *)button->label,unaff_EDI)
  ;
  pIVar8 = (IGrim2D *)(float)iVar1;
  if (DAT_00478670 == -1) {
    DAT_00478670 = (*grim_interface_ptr->vtable->grim_get_texture_handle)
                             ((IGrim2D *)s_ui_buttonSm_00474498,unaff_ESI);
  }
  if (DAT_00478674 == -1) {
    DAT_00478674 = (*grim_interface_ptr->vtable->grim_get_texture_handle)
                             ((IGrim2D *)s_ui_buttonMd_00474474,unaff_EBP);
  }
  if ((in_stack_ffffffec < 40.0) || (fStack0000000c = 145.0, button->force_small != '\0')) {
    fStack0000000c = 82.0;
  }
  if (button->force_wide != '\0') {
    fStack0000000c = 145.0;
  }
  xy[1] = xy[1] + 2.0;
  lVar5 = __ftol();
  iVar1 = ui_mouse_inside_rect(xy,0x1c,(int)lVar5);
  button->hovered = (uchar)iVar1;
  xy[1] = xy[1] - 2.0;
  if (button->hovered != '\0') {
    ui_focus_set((int)button,'\0');
  }
  if ((button->enabled == '\0') ||
     ((button->hovered == '\0' && ((in_stack_00000010 == '\0' || (DAT_004d11ec < 0x321)))))) {
    iVar1 = button->hover_anim + frame_dt_ms * -4;
  }
  else {
    iVar1 = button->hover_anim + frame_dt_ms * 6;
  }
  button->hover_anim = iVar1;
  if (0 < button->click_anim) {
    button->click_anim = button->click_anim + frame_dt_ms * -6;
  }
  if (button->click_anim < 0) {
    button->click_anim = 0;
  }
  if (button->hover_anim < 0) {
    button->hover_anim = 0;
  }
  else if (1000 < button->hover_anim) {
    button->hover_anim = 1000;
  }
  fStack_4 = 0.5;
  if ((0 < button->click_anim) &&
     (fStack_4 = (float)button->click_anim * 0.0005 + 0.5, 1.0 < fStack_4)) {
    fStack_4 = 1.0;
  }
  self_00.vtable = (IGrim2D_vtbl *)button->hover_anim;
  fStack_8 = fStack_4;
  if (0 < (int)self_00.vtable) {
    self_00.vtable = (IGrim2D_vtbl *)(*xy + 12.0);
    (*grim_interface_ptr->vtable->grim_draw_rect_filled)
              ((IGrim2D *)&stack0xfffffff0,(float *)(fStack0000000c - 24.0),22.0,(float)&fStack_8);
  }
  if ((in_stack_ffffffec < 40.0) || (button->force_small != '\0')) {
    pIVar4 = grim_interface_ptr->vtable;
    self = (IGrim2D *)DAT_00478670;
  }
  else {
    pIVar4 = grim_interface_ptr->vtable;
    self = (IGrim2D *)DAT_00478674;
  }
  (*pIVar4->grim_bind_texture)(self,0,(int)unaff_EBP);
  if (button->force_wide != '\0') {
    (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)DAT_00478674,0,in_stack_ffffffe4);
  }
  fVar7 = button->alpha;
  uVar6 = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,fVar7,(float)pIVar8);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,uVar6);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,fVar7);
  (*grim_interface_ptr->vtable->grim_begin_batch)(pIVar8);
  fVar9 = 32.0;
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)*xy,xy[1],in_stack_00000018,32.0,in_stack_ffffffec);
  key = 0x43ebba;
  (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)self_00.vtable);
  uVar6 = 0x15;
  fVar7 = 2.8026e-45;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,(uint)fVar9);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,uVar6);
  if (button->hovered == '\0') {
    fVar9 = button->alpha * 0.7;
  }
  else {
    fVar9 = button->alpha;
  }
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,fVar9,fVar7);
  pIVar8 = (IGrim2D *)button->label;
  y = &DAT_00471fc4;
  pIVar4 = grim_interface_ptr->vtable;
  fStack_8 = in_stack_00000014 * 0.5 + *xy;
  iVar1 = (*pIVar4->grim_measure_text_width)(pIVar8,(char *)(xy[1] + 10.0));
  uVar2 = (*pIVar4->grim_draw_text_small_fmt)
                    (grim_interface_ptr,(fStack_4 - (float)(iVar1 / 2)) + 1.0,(float)y,
                     (char *)pIVar8);
  uVar3 = (undefined3)((uint)uVar2 >> 8);
  if (button->enabled == '\0') {
    button->activated = '\0';
  }
  else if ((in_stack_0000001c == '\0') ||
          ((iVar1 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1c,key),
           (char)iVar1 == '\0' &&
           ((button->hovered == '\0' || (iVar1 = input_primary_just_pressed(), (char)iVar1 == '\0'))
           )))) {
    uVar3 = 0;
    button->activated = '\0';
  }
  else {
    uVar3 = 0;
    button->activated = '\x01';
  }
  iVar1 = CONCAT31(uVar3,button->activated);
  if (button->activated != '\0') {
    button->click_anim = 1000;
    iVar1 = sfx_play(sfx_ui_buttonclick);
  }
  return CONCAT31((int3)((uint)iVar1 >> 8),button->activated);
}



/* ui_text_input_update @ 0043ecf0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* updates a text input field: focus, input polling, sfx, and rendering */

int __cdecl ui_text_input_update(float *xy,int *input_state)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  float unaff_EBX;
  float unaff_EBP;
  float unaff_ESI;
  uint unaff_EDI;
  float10 fVar5;
  longlong lVar6;
  float *in_stack_00000010;
  float in_stack_00000014;
  float *xy_00;
  char *text;
  float *h;
  uint3 in_stack_ffffffe4;
  float h_00;
  float local_18;
  undefined4 local_14;
  IGrim2D IStack_c;
  IGrim2D IStack_8;
  float fStack_4;
  
  h_00 = (float)(uint)in_stack_ffffffe4;
  iVar1 = ui_focus_update((int)input_state);
  lVar6 = __ftol();
  iVar2 = ui_mouse_inside_rect(xy,0x12,(int)lVar6);
  if ((char)iVar2 != '\0') {
    ui_focus_set((int)input_state,'\0');
  }
  if ((char)iVar1 != '\0') {
    local_18 = *xy - 16.0;
    local_14 = xy[1];
    ui_focus_draw(&local_18);
  }
  *(undefined1 *)(*input_state + 1 + input_state[1]) = 0;
  iVar1 = console_input_poll();
  if (iVar1 == 0xd) {
    (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1c,unaff_EDI);
    (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x9c,(uint)unaff_ESI);
    unaff_ESI = 1.0;
    sfx_play(sfx_ui_typeenter);
    local_14 = (float)CONCAT13(1,(undefined3)local_14);
  }
  else {
    (*grim_interface_ptr->vtable->grim_set_key_char_buffer)
              ((IGrim2D *)*input_state,(uchar *)(input_state + 1),(int *)input_state[2],unaff_EDI);
    if (iVar1 != 0) {
      uVar3 = crt_rand();
      uVar3 = uVar3 & 0x80000001;
      if ((int)uVar3 < 0) {
        uVar3 = (uVar3 - 1 | 0xfffffffe) + 1;
      }
      sfx_play(uVar3 + _sfx_ui_typeclick_01);
    }
  }
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_ESI);
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            ((IGrim2D *)xy,in_stack_00000010,18.0,unaff_EBP);
  IStack_c.vtable = (IGrim2D_vtbl *)(*xy + 1.0);
  h = &fStack_4;
  text = (char *)0x41800000;
  IStack_8.vtable = (IGrim2D_vtbl *)(xy[1] + 1.0);
  fStack_4 = 0.0;
  xy_00 = (float *)(in_stack_00000014 - 2.0);
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)(&IStack_c,xy_00,16.0,(float)h);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,(uint)xy_00);
  iVar1 = 0;
  while( true ) {
    iVar2 = (*grim_interface_ptr->vtable->grim_measure_text_width)
                      ((IGrim2D *)(*input_state + iVar1),text);
    if ((float)iVar2 <= (float)in_stack_00000010) break;
    iVar1 = iVar1 + 1;
  }
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.8,(float)h);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,*xy + 4.0,xy[1] + 2.0,&DAT_00471fc4,*input_state + iVar1);
  in_stack_00000014 = 1.0;
  fVar5 = (float10)fsin((float10)_DAT_0047ea4c * (float10)4.0);
  if ((float10)0.0 < fVar5) {
    in_stack_00000014 = 0.4;
  }
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,in_stack_00000014,unaff_EBX);
  IStack_8.vtable = (IGrim2D_vtbl *)((float)(int)in_stack_00000014 + *xy + 4.0);
  fStack_4 = xy[1] + 2.0;
  uVar4 = (*grim_interface_ptr->vtable->grim_draw_rect_outline)
                    (&IStack_8,(float *)0x3f800000,14.0,h_00);
  return CONCAT31((int3)((uint)uVar4 >> 8),IStack_8.vtable._3_1_);
}



/* ui_list_widget_update @ 0043efc0 */

/* draws a list widget and updates selection/hover state */

int __cdecl ui_list_widget_update(float *xy,char *list)

{
  char *id;
  float *self;
  float *xy_00;
  int iVar1;
  int iVar2;
  IGrim2D *self_00;
  float unaff_EBX;
  IGrim2D *unaff_EBP;
  int iVar3;
  IGrim2D_vtbl *pIVar4;
  float unaff_ESI;
  char *unaff_EDI;
  int iVar5;
  longlong lVar6;
  float in_stack_00000010;
  int iStack00000018;
  char in_stack_0000001c;
  char in_stack_00000020;
  char *self_01;
  uint value;
  float a;
  IGrim2D *self_02;
  IGrim2D a_00;
  float a_01;
  undefined4 uStack_10;
  undefined4 uStack_c;
  int iStack_8;
  int iStack_4;
  
  id = list;
  iVar3 = 0;
  iVar1 = ui_focus_update((int)list);
  iVar5 = 0;
  list = (char *)CONCAT31(list._1_3_,(char)iVar1);
  if (0 < *(int *)(id + 0x10)) {
    do {
      iVar2 = (*grim_interface_ptr->vtable->grim_measure_text_width)
                        (*(IGrim2D **)(*(int *)(id + 0xc) + iVar5 * 4),unaff_EDI);
      if (iVar3 < iVar2) {
        iVar3 = iVar2;
      }
      iVar5 = iVar5 + 1;
    } while (iVar5 < *(int *)(id + 0x10));
  }
  self = xy;
  if (*id == '\0') {
    self_02 = (IGrim2D *)0x41800000;
    id[0x14] = '\0';
    xy = (float *)(float)(iVar3 + 0x30);
    id[4] = '\0';
    id[5] = '\0';
    id[6] = '\0';
    id[7] = '\0';
  }
  else if (*(int *)(id + 4) < 1) {
    self_02 = (IGrim2D *)0x41800000;
    id[0x14] = '\0';
    xy = (float *)(float)(iVar3 + 0x30);
  }
  else {
    xy = (float *)(float)(iVar3 + 0x30);
    self_02 = (IGrim2D *)(float)(*(int *)(id + 0x10) * 0x10 + 0x18);
    lVar6 = __ftol();
    iVar3 = (int)lVar6;
    lVar6 = __ftol();
    iVar3 = ui_mouse_inside_rect(self,(int)lVar6,iVar3);
    id[0x14] = (char)iVar3;
  }
  if (id[0x14] != '\0') {
    ui_focus_set((int)id,'\0');
  }
  if ((char)iVar1 != '\0') {
    ui_focus_draw((float *)&stack0xffffffe8);
    iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xc8,(uint)unaff_EDI);
    if ((char)iVar3 != '\0') {
      if (*(int *)(id + 4) == 0) {
        id[4] = '\x01';
        id[5] = '\0';
        id[6] = '\0';
        id[7] = '\0';
      }
      else {
        iVar3 = *(int *)(id + 0x18);
        *(int *)(id + 0x18) = iVar3 + -1;
        if (iVar3 + -1 < 0) {
          id[0x18] = '\0';
          id[0x19] = '\0';
          id[0x1a] = '\0';
          id[0x1b] = '\0';
        }
      }
    }
    unaff_EDI = (char *)0xd0;
    iVar3 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0xd0,(uint)unaff_ESI);
    if ((char)iVar3 != '\0') {
      if (*(int *)(id + 4) == 0) {
        id[4] = '\x01';
        id[5] = '\0';
        id[6] = '\0';
        id[7] = '\0';
      }
      else {
        iVar3 = *(int *)(id + 0x18);
        *(int *)(id + 0x18) = iVar3 + 1;
        if (*(int *)(id + 0x10) + -1 < iVar3 + 1) {
          *(int *)(id + 0x18) = *(int *)(id + 0x10) + -1;
        }
      }
    }
  }
  xy_00 = xy;
  uStack_10 = 0x3f800000;
  uStack_c = 0x3f800000;
  iStack_8 = 0x3f800000;
  iStack_4 = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            ((IGrim2D *)self,xy,(float)self_02,(float)&uStack_10);
  a_00.vtable = (IGrim2D_vtbl *)(*self + 1.0);
  a_01 = self[1] + 1.0;
  uStack_10 = 0;
  uStack_c = 0;
  iStack_8 = 0;
  iStack_4 = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            ((IGrim2D *)&stack0xffffffe8,(float *)((float)xy - 2.0),(float)self_02 - 2.0,
             (float)&uStack_10);
  if ((*(int *)(id + 4) < 1) && (id[0x14] == '\0')) {
    self_01 = s_ui_dropOff_00474134;
    pIVar4 = grim_interface_ptr->vtable;
  }
  else {
    a_00.vtable = (IGrim2D_vtbl *)*self;
    a_01 = self[1] + 15.0;
    uStack_10 = 0x3f800000;
    uStack_c = 0x3f800000;
    iStack_8 = 0x3f800000;
    iStack_4 = 0x3f000000;
    (*grim_interface_ptr->vtable->grim_draw_rect_filled)
              ((IGrim2D *)&stack0xffffffe8,xy_00,1.0,(float)&uStack_10);
    self_01 = s_ui_dropOn_00474158;
    pIVar4 = grim_interface_ptr->vtable;
  }
  self_00 = (IGrim2D *)(*pIVar4->grim_get_texture_handle)((IGrim2D *)self_01,(char *)0x0);
  (*pIVar4->grim_bind_texture)(self_00,(int)unaff_EDI,(int)unaff_ESI);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,(uint)self_00);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,(float)unaff_EDI);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,unaff_ESI);
  (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_EBP);
  value = 0x41800000;
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)(((in_stack_00000010 + *self) - 16.0) - 1.0),self[1],16.0,16.0,unaff_EBX);
  a = 6.240202e-39;
  (*grim_interface_ptr->vtable->grim_end_batch)(self_02);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,value);
  iVar3 = -2;
  if (*id != '\0') {
    lVar6 = __ftol();
    iVar1 = FUN_00403430(self,0xe,(int)lVar6);
    if ((char)iVar1 != '\0') {
      iVar3 = -1;
      (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.95,a);
      goto LAB_0043f3aa;
    }
  }
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.75,a);
LAB_0043f3aa:
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,*self + 4.0,self[1] + 1.0,&DAT_00471fc4,
             *(undefined4 *)(*(int *)(id + 0xc) + *(int *)(id + 8) * 4));
  if (*(int *)(id + 4) < 1) {
    return iVar3;
  }
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.7,(float)self_02);
  iVar3 = 0;
  if (0 < *(int *)(id + 0x10)) {
    lVar6 = __ftol();
    iStack_4 = (int)lVar6;
    iStack00000018 = 0;
    do {
      iVar1 = iStack00000018;
      iStack_8 = iStack00000018 + 0x10;
      xy = (float *)*self;
      list = (char *)((float)iStack_8 + self[1]);
      iVar5 = FUN_00403430((float *)&xy,0xe,iStack_4);
      if ((char)iVar5 == '\0') {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,0.6,(float)a_00.vtable);
      }
      else {
        *(int *)(id + 0x18) = iVar3;
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f800000,1.0,1.0,0.95,(float)a_00.vtable);
      }
      if ((in_stack_00000020 != '\0') && (*(int *)(id + 0x18) == iVar3)) {
        a_00.vtable = (IGrim2D_vtbl *)0x3f75c28f;
        (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.96,a_01);
      }
      (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                (grim_interface_ptr,*self + 4.0,(float)iStack00000018 + self[1] + 17.0,&DAT_00471fc4
                 ,*(undefined4 *)(*(int *)(id + 0xc) + iVar3 * 4));
      iVar3 = iVar3 + 1;
      iStack00000018 = iVar1 + 0x10;
    } while (iVar3 < *(int *)(id + 0x10));
  }
  if ((id[0x14] == '\0') && (in_stack_0000001c == '\0')) {
    id[4] = '\0';
    id[5] = '\0';
    id[6] = '\0';
    id[7] = '\0';
  }
  return *(int *)(id + 0x18);
}



/* FUN_004411c0 @ 004411c0 */

void FUN_004411c0(void)

{
  float *unaff_ESI;
  float unaff_retaddr;
  IGrim2D *in_stack_00000008;
  
  (*grim_interface_ptr->vtable->grim_set_color_ptr)((IGrim2D *)&DAT_004ccca8,unaff_ESI);
  in_stack_00000008->vtable = (IGrim2D_vtbl *)((float)in_stack_00000008->vtable - 16.0);
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            (in_stack_00000008,(float *)0x43400000,1.0,unaff_retaddr);
  in_stack_00000008->vtable = (IGrim2D_vtbl *)((float)in_stack_00000008->vtable + 16.0);
  in_stack_00000008[1].vtable = (IGrim2D_vtbl *)((float)in_stack_00000008[1].vtable + 4.0);
  return;
}



/* FUN_00441220 @ 00441220 */

void FUN_00441220(void)

{
  float *unaff_ESI;
  float unaff_retaddr;
  IGrim2D *in_stack_00000008;
  
  (*grim_interface_ptr->vtable->grim_set_color_ptr)((IGrim2D *)&DAT_004ccca8,unaff_ESI);
  in_stack_00000008->vtable = (IGrim2D_vtbl *)((float)in_stack_00000008->vtable - 16.0);
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            (in_stack_00000008,(float *)0x3f800000,48.0,unaff_retaddr);
  in_stack_00000008->vtable = (IGrim2D_vtbl *)((float)in_stack_00000008->vtable + 16.0);
  return;
}



/* FUN_00441270 @ 00441270 */

undefined * __cdecl FUN_00441270(undefined4 param_1,undefined4 param_2)

{
  undefined *puVar1;
  
  switch(param_2) {
  case 1:
    puVar1 = &DAT_004788b4;
    break;
  case 2:
    puVar1 = &DAT_004788b0;
    break;
  case 3:
    puVar1 = &DAT_004788ac;
    break;
  case 4:
    puVar1 = &DAT_004788a8;
    break;
  case 5:
    puVar1 = &DAT_004788a4;
    break;
  case 6:
    puVar1 = &DAT_004788a0;
    break;
  case 7:
    puVar1 = &DAT_0047889c;
    break;
  case 8:
    puVar1 = &DAT_00478898;
    break;
  case 9:
    puVar1 = &DAT_00478894;
    break;
  case 10:
    puVar1 = &DAT_00478890;
    break;
  case 0xb:
    puVar1 = &DAT_0047888c;
    break;
  case 0xc:
    puVar1 = &DAT_00478888;
    break;
  default:
    puVar1 = &DAT_00478884;
  }
  crt_sprintf(&DAT_004d0e38,s__d___s__d_00478878,param_1,puVar1);
  return &DAT_004d0e38;
}



/* ui_text_input_render @ 004413a0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders a text input field (focus, text, and caret) */

void __cdecl ui_text_input_render(void *input_state,float y,float alpha)

{
  IGrim2D_vtbl *pIVar1;
  float fVar2;
  undefined *x;
  IGrim2D *pIVar3;
  int iVar4;
  char *text;
  IGrim2D_vtbl *pIVar5;
  float *unaff_EBX;
  char *unaff_EBP;
  float unaff_ESI;
  char *unaff_EDI;
  longlong lVar6;
  longlong lVar7;
  float unaff_retaddr;
  float a;
  char *pcVar8;
  IGrim2D *in_stack_00000010;
  char *in_stack_00000014;
  char *in_stack_00000018;
  char *in_stack_0000001c;
  char *in_stack_00000020;
  char *in_stack_00000024;
  undefined *in_stack_00000028;
  float fVar9;
  char *in_stack_00000030;
  char *in_stack_00000038;
  float in_stack_0000003c;
  float fStack00000040;
  float in_stack_00000044;
  IGrim2D_vtbl *in_stack_00000048;
  float in_stack_0000004c;
  float in_stack_00000050;
  float in_stack_00000054;
  float in_stack_00000060;
  float in_stack_00000068;
  float fVar10;
  float in_stack_fffffff0;
  char *pcVar11;
  IGrim2D *pIVar12;
  char *in_stack_fffffffc;
  
  fVar2 = y;
  _DAT_004cccb4 = alpha * 0.7;
  DAT_00496604 = 0x3f333333;
  _DAT_004ccca8 = DAT_004965f8;
  _DAT_004cccac = DAT_004965fc;
  _DAT_004cccb0 = DAT_00496600;
  fVar10 = _DAT_004cccb4;
  alpha = (float)(*grim_interface_ptr->vtable->grim_measure_text_width)((IGrim2D *)y,unaff_EDI);
  pIVar12 = *(IGrim2D **)((int)y + 4);
  fVar9 = *(float *)y + 4.0;
  pIVar3 = in_stack_00000010;
  a = unaff_retaddr;
  if (((game_state_id != 7) && (game_state_id != 8)) && (game_state_id != 0xc)) {
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,(float)in_stack_00000010,unaff_ESI);
    (*grim_interface_ptr->vtable->grim_draw_text_small)
              (pIVar12,(float)in_stack_fffffffc,y,unaff_EBP);
    (*grim_interface_ptr->vtable->grim_set_color_ptr)((IGrim2D *)&DAT_004ccca8,unaff_EBX);
    alpha = (float)input_state + 13.0;
    a = unaff_retaddr;
    (*grim_interface_ptr->vtable->grim_draw_rect_outline)
              ((IGrim2D *)&y,(float *)(float)(int)in_stack_00000018,1.0,fVar10);
    if ((*(byte *)((int)y + 0x44) & 2) == 0) {
      if ((*(byte *)((int)y + 0x44) & 1) == 0) {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f4ccccd,0.8,0.8,(float)in_stack_00000020 * 0.8,in_stack_fffffff0);
        pcVar11 = s_Local_score_00478974;
        pIVar5 = grim_interface_ptr->vtable;
        fVar10 = fVar9;
      }
      else {
        (*grim_interface_ptr->vtable->grim_set_color)
                  ((IGrim2D *)0x3f333333,1.0,0.7,(float)in_stack_00000020 * 0.8,in_stack_fffffff0);
        pcVar11 = s_Score_from_the_Internet_00478980;
        pIVar5 = grim_interface_ptr->vtable;
        fVar10 = fVar9;
      }
      (*pIVar5->grim_draw_text_small_fmt)(grim_interface_ptr,unaff_retaddr,alpha + 14.0,pcVar11);
    }
    else {
      fVar10 = (float)in_stack_00000020 * 0.8;
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f4ccccd,0.8,0.8,fVar10,in_stack_fffffff0);
      (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                (grim_interface_ptr,unaff_retaddr,alpha + 14.0,
                 s_Internet_score_of_local_origin_004789a0);
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f000000,0.5,0.5,(float)in_stack_00000024 * 0.5,fVar9);
      (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
                (grim_interface_ptr,alpha + 94.0,(float)in_stack_00000010 - 12.0,s_uni__d_00478998,
                 *(undefined4 *)((int)y + 0x38));
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f4ccccd,0.8,0.8,fVar10,(float)pIVar12);
    }
    in_stack_0000001c = (char *)((float)in_stack_00000020 * 0.8);
    alpha = alpha + 15.0;
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f666666,0.9,0.9,(float)in_stack_0000001c,fVar10);
    pIVar5 = grim_interface_ptr->vtable;
    x = FUN_00441270((uint)*(byte *)((int)y + 0x40),(uint)*(byte *)((int)y + 0x42));
    pcVar11 = (char *)((float)in_stack_00000010 + 13.0);
    pIVar1 = grim_interface_ptr->vtable;
    in_stack_00000020 = (char *)(((alpha + 192.0) - 32.0) - 8.0);
    pIVar3 = (IGrim2D *)FUN_00441270((uint)*(byte *)((int)y + 0x40),(uint)*(byte *)((int)y + 0x42));
    iVar4 = (*pIVar1->grim_measure_text_width)(pIVar3,pcVar11);
    in_stack_00000028 = (undefined *)(iVar4 / 2);
    (*pIVar5->grim_draw_text_small)
              ((IGrim2D *)((float)in_stack_00000024 - (float)(int)in_stack_00000028),(float)x,
               (float)pIVar12,in_stack_fffffffc);
    in_stack_00000014 = (char *)(*(float *)y + 16.0);
    FUN_004411c0();
    in_stack_00000018 = (char *)((float)in_stack_00000018 + 13.0 + 14.0);
    pIVar3 = (IGrim2D *)in_stack_00000030;
    y = unaff_retaddr;
  }
  fVar9 = (float)in_stack_00000030 * 0.8;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f666666,0.9,0.9,fVar9,a);
  pcVar11 = (char *)((float)in_stack_00000018 + 32.0);
  pIVar5 = grim_interface_ptr->vtable;
  pcVar8 = s_Score_0047896c;
  iVar4 = (*pIVar5->grim_measure_text_width)((IGrim2D *)s_Score_0047896c,in_stack_0000001c);
  text = (char *)(iVar4 / 2);
  (*pIVar5->grim_draw_text_small)
            ((IGrim2D *)((float)in_stack_00000030 - (float)(int)text),(float)pcVar8,
             (float)input_state,(char *)y);
  if (*(char *)((int)fVar2 + 0x28) == '\x02') {
    crt_sprintf(&DAT_004d0da0,s___2f_secs_00478960);
  }
  else if (*(char *)((int)fVar2 + 0x28) == '\x03') {
    crt_sprintf(&DAT_004d0da0,s___2f_secs_00478960);
  }
  else {
    crt_sprintf(&DAT_004d0da0,&DAT_00471f40);
  }
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f666666,0.9,1.0,(float)pIVar3,alpha);
  alpha = (float)&DAT_004d0da0;
  iVar4 = (*grim_interface_ptr->vtable->grim_measure_text_width)
                    ((IGrim2D *)&DAT_004d0da0,(char *)in_stack_00000010);
  alpha = (float)pcVar11 + 15.0;
  fStack00000040 = (float)(iVar4 / 2);
  (*grim_interface_ptr->vtable->grim_draw_text_small)
            ((IGrim2D *)(((float)in_stack_00000028 + 32.0) - (float)(int)fStack00000040),alpha,
             7.076221e-39,in_stack_00000014);
  if (game_state_id != 0xc) {
    format_ordinal((int)in_stack_0000004c);
    alpha = (float)&DAT_004d0da0;
    crt_sprintf(&DAT_004d0da0,s_Rank___s_00478954);
    iVar4 = (*grim_interface_ptr->vtable->grim_measure_text_width)
                      ((IGrim2D *)&DAT_004d0da0,in_stack_00000018);
    alpha = 0.9;
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f666666,0.9,0.9,fVar9,(float)in_stack_0000001c);
    in_stack_00000048 = grim_interface_ptr->vtable;
    in_stack_0000004c = (float)(iVar4 / 2);
    (*in_stack_00000048->grim_draw_text_small)
              ((IGrim2D *)(((float)text + 32.0) - (float)(int)in_stack_0000004c),
               (float)in_stack_00000038 + 30.0,7.076221e-39,in_stack_00000020);
  }
  in_stack_00000038 = (char *)((float)in_stack_00000038 + 96.0);
  FUN_00441220();
  if (*(char *)((int)fVar2 + 0x28) == '\x03') {
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)in_stack_00000038,in_stack_0000003c,s_Experience_00478948);
    crt_sprintf(&DAT_004d0da0,&DAT_00471f40);
    iVar4 = (*grim_interface_ptr->vtable->grim_measure_text_width)
                      ((IGrim2D *)&DAT_004d0da0,in_stack_00000024);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f666666,0.9,0.9,fVar9,(float)in_stack_00000028);
    in_stack_00000028 = &DAT_004d0da0;
    (*grim_interface_ptr->vtable->grim_draw_text_small)
              ((IGrim2D *)((fStack00000040 + 32.0) - (float)(iVar4 / 2)),in_stack_00000044 + 15.0,
               7.076221e-39,pcVar11);
    _DAT_004d120c = _DAT_004d120c - (frame_dt + frame_dt);
  }
  else {
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,(float)in_stack_00000038 + 6.0,in_stack_0000003c,
               s_Game_time_0047893c);
    alpha = *(float *)((int)fVar2 + 0x20);
    __ftol();
    __ftol();
    ui_draw_clock_gauge();
    if (((ui_mouse_x <= (float)in_stack_00000038 + 8.0) ||
        ((float)in_stack_00000038 + 72.0 <= ui_mouse_x)) ||
       ((ui_mouse_y <= in_stack_0000003c + 16.0 || (in_stack_0000003c + 45.0 <= ui_mouse_y)))) {
      _DAT_004d120c = _DAT_004d120c - (frame_dt + frame_dt);
    }
    else {
      _DAT_004d120c = frame_dt + frame_dt + _DAT_004d120c;
    }
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f666666,0.9,0.9,fVar9,(float)in_stack_00000024);
    if ((*(int *)((int)fVar2 + 0x20) / 1000) % 0x3c < 10) {
      in_stack_0000001c = s__d_0_d_00473150;
    }
    else {
      in_stack_0000001c = s__d__d_00473148;
    }
    alpha = 6.254662e-39;
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,in_stack_0000003c + 40.0,fStack00000040 + 19.0,in_stack_0000001c);
  }
  fStack00000040 = fStack00000040 + 52.0;
  pcVar8 = (char *)(in_stack_0000003c - 96.0);
  if (((DAT_00487234 == 2) && (game_state_id == 8)) ||
     (((game_state_id == 7 || ((game_state_id == 8 || (game_state_id == 0xc)))) &&
      (DAT_00487234 == 0)))) {
    _DAT_004d1210 = 0.0;
  }
  else {
    FUN_004411c0();
    pIVar12 = ui_weapon_icons_texture;
    (*grim_interface_ptr->vtable->grim_bind_texture)
              (ui_weapon_icons_texture,0,(int)in_stack_00000028);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,(uint)pIVar12);
    (*grim_interface_ptr->vtable->grim_set_sub_rect)
              ((IGrim2D *)0x8,2,1,(&weapon_table)[*(byte *)((int)fVar2 + 0x2b)].hud_icon_id << 1,0);
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f800000,1.0,1.0,(float)pIVar3,(float)in_stack_00000028);
    pIVar5 = grim_interface_ptr->vtable;
    lVar6 = __ftol();
    lVar7 = __ftol();
    (*pIVar5->grim_draw_quad)
              ((IGrim2D *)(float)(int)lVar7,(float)(int)lVar6,64.0,32.0,(float)pcVar11);
    fVar9 = 6.255073e-39;
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)in_stack_00000030);
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,0x42000000);
    if ((((ui_mouse_x <= fStack00000040) || (fStack00000040 + 64.0 <= ui_mouse_x)) ||
        (ui_mouse_y <= in_stack_00000044)) || (in_stack_00000044 + 32.0 <= ui_mouse_y)) {
      _DAT_004d1208 = _DAT_004d1208 - (frame_dt + frame_dt);
    }
    else {
      _DAT_004d1208 = frame_dt + frame_dt + _DAT_004d1208;
    }
    (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f666666,0.9,0.9,(float)pcVar8,fVar9)
    ;
    iVar4 = (*grim_interface_ptr->vtable->grim_measure_text_width)
                      ((IGrim2D *)(&weapon_table + *(byte *)((int)fVar2 + 0x2b)),in_stack_00000030);
    in_stack_00000060 = (float)(0x20 - iVar4 / 2);
    fVar9 = (float)(int)in_stack_00000060;
    if (fVar9 < 0.0) {
      fVar9 = 0.0;
    }
    (*grim_interface_ptr->vtable->grim_draw_text_small)
              ((IGrim2D *)(fVar9 + (float)in_stack_00000048),in_stack_0000004c + 32.0,
               (float)(&weapon_table + *(byte *)((int)fVar2 + 0x2b)),text);
    (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
              (grim_interface_ptr,in_stack_0000004c + 110.0,in_stack_00000050 + 1.0,
               s_Frags___d_00478930);
    pIVar12 = grim_interface_ptr;
    pIVar5 = grim_interface_ptr->vtable;
    lVar6 = __ftol();
    text = (char *)lVar6;
    in_stack_00000030 = s_Hit______d___00478920;
    pcVar11 = (char *)((in_stack_00000050 + 16.0) - 1.0);
    in_stack_00000028 = (undefined *)(in_stack_0000004c + 110.0);
    (*pIVar5->grim_draw_text_small_fmt)
              (pIVar12,(float)in_stack_00000028,(float)pcVar11,s_Hit______d___00478920);
    if (((ui_mouse_x <= in_stack_0000004c + 110.0) || (in_stack_0000004c + 174.0 <= ui_mouse_x)) ||
       ((ui_mouse_y <= (in_stack_00000050 + 16.0) - 1.0 || (in_stack_00000050 + 32.0 <= ui_mouse_y))
       )) {
      _DAT_004d1210 = _DAT_004d1210 - (frame_dt + frame_dt);
    }
    else {
      _DAT_004d1210 = frame_dt + frame_dt + _DAT_004d1210;
    }
    in_stack_00000050 = in_stack_00000050 + 48.0;
  }
  (*grim_interface_ptr->vtable->grim_set_color)
            ((IGrim2D *)0x3f800000,1.0,1.0,(float)pIVar3,(float)in_stack_00000028);
  FUN_004411c0();
  if (_DAT_004d1208 <= 1.0) {
    if (_DAT_004d1208 < 0.0) {
      _DAT_004d1208 = 0.0;
    }
  }
  else {
    _DAT_004d1208 = 1.0;
  }
  if (_DAT_004d120c <= 1.0) {
    if (_DAT_004d120c < 0.0) {
      _DAT_004d120c = 0.0;
    }
  }
  else {
    _DAT_004d120c = 1.0;
  }
  if (_DAT_004d1210 <= 1.0) {
    if (_DAT_004d1210 < 0.0) {
      _DAT_004d1210 = 0.0;
    }
  }
  else {
    _DAT_004d1210 = 1.0;
  }
  if (((game_state_id == 7) || (game_state_id == 8)) || (game_state_id == 0xc)) {
    (*grim_interface_ptr->vtable->grim_set_color)
              ((IGrim2D *)0x3f666666,0.9,0.9,(float)pcVar8,(float)pcVar11);
    if (0.5 < _DAT_004d1208) {
      fVar9 = (_DAT_004d1208 - 0.5) * in_stack_00000060;
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f666666,0.9,0.9,fVar9 + fVar9,(float)in_stack_00000030);
      (*grim_interface_ptr->vtable->grim_draw_text_small)
                ((IGrim2D *)((float)in_stack_00000048 - 20.0),in_stack_0000004c,6.569461e-39,text);
    }
    if (0.5 < _DAT_004d120c) {
      fVar9 = (_DAT_004d120c - 0.5) * in_stack_00000068;
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f666666,0.9,0.9,fVar9 + fVar9,(float)in_stack_00000038);
      in_stack_00000038 = s_The_time_the_game_lasted_004788e0;
      (*grim_interface_ptr->vtable->grim_draw_text_small)
                ((IGrim2D *)(in_stack_00000050 + 12.0),in_stack_00000054,6.569422e-39,pcVar8);
    }
    if (0.5 < _DAT_004d1210) {
      fVar9 = (_DAT_004d1210 - 0.5) * in_stack_00000068;
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f666666,0.9,0.9,fVar9 + fVar9,(float)in_stack_00000038);
      (*grim_interface_ptr->vtable->grim_draw_text_small)
                ((IGrim2D *)(in_stack_00000050 - 22.0),in_stack_00000054,6.569366e-39,pcVar8);
    }
  }
  return;
}



/* ui_update_notice_update @ 00442150 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* renders the update-available notice and its button */

void __cdecl ui_update_notice_update(float *xy,float alpha)

{
  float unaff_EBX;
  float unaff_ESI;
  float in_stack_ffffffe8;
  float in_stack_ffffffec;
  undefined4 local_10;
  undefined4 local_c;
  float local_8;
  float local_4;
  
  local_4 = alpha * 0.8;
  local_10 = 0;
  local_c = 0;
  local_8 = 0.0;
  (*grim_interface_ptr->vtable->grim_draw_rect_filled)
            ((IGrim2D *)xy,(float *)0x43850000,76.0,(float)&local_10);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,alpha,unaff_ESI);
  (*grim_interface_ptr->vtable->grim_draw_rect_outline)
            ((IGrim2D *)xy,(float *)0x43850000,76.0,unaff_EBX);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,0.2,0.2,1.0,in_stack_ffffffe8)
  ;
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,*xy + 12.0,xy[1] + 14.0,s_NOTE__004789c0);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.8,in_stack_ffffffec)
  ;
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,*xy + 60.0,xy[1] + 4.0,s_There_is_a_newer_version_of_the_004789f8);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,*xy + 60.0,xy[1] + 18.0,s_game_available_for_download__004789d8);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,*xy + 60.0,xy[1] + 32.0,&DAT_0047f4d8);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,*xy + 60.0,xy[1] + 46.0,&DAT_0047f4d8);
  if ((DAT_004cc930 & 1) == 0) {
    DAT_004cc930 = DAT_004cc930 | 1;
    DAT_004d0ed6 = 1;
    DAT_004d0ee5 = 0;
    DAT_004d0ee4 = 0;
    _DAT_004d0ee0 = 0x3f800000;
    _DAT_004d0edc = 0;
    _DAT_004d0ed0 = (char *)0x0;
    DAT_004d0ed4 = 0;
    DAT_004d0ed5 = '\0';
    _DAT_004d0ed8 = 0;
    crt_atexit(&DAT_004423c0);
  }
  _DAT_004d0ed0 = s_Get_the_update_004789c8;
  local_8 = *xy + 65.0;
  local_4 = (xy[1] + 42.0) - 2.0;
  ui_button_update(&local_8,(ui_button_t *)&DAT_004d0ed0);
  if (DAT_004d0ed5 != '\0') {
    DAT_00480838 = 1;
  }
  return;
}



/* FUN_004443c0 @ 004443c0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_4443c0(float* arg1, char arg2) */

int __cdecl FUN_004443c0(float *arg1,char arg2)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  uint extraout_EAX;
  int *piVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  uint unaff_EDI;
  char *pcVar8;
  char (*pacVar9) [27];
  char (*pacVar10) [27];
  int local_c;
  float local_8;
  float local_4;
  
  if ((DAT_004cccd8 & 1) == 0) {
    DAT_004cccd8 = DAT_004cccd8 | 1;
    _DAT_004d0f38 = 0x3f800000;
    _DAT_004d0f28 = &DAT_004ccb18;
    _DAT_004d0f2c = 0;
    _DAT_004d0f30 = 0x1b;
    _DAT_004d0f34 = 0x60;
    crt_atexit(&DAT_00444800);
  }
  local_c = 0;
  if (0 < (int)config_blob.reserved0._132_4_) {
    piVar4 = &DAT_004ccb5c;
    iVar2 = 0x4803f0;
    local_c._0_1_ = config_blob.reserved0[0x84];
    local_c._1_1_ = config_blob.reserved0[0x85];
    local_c._2_1_ = config_blob.reserved0[0x86];
    local_c._3_1_ = config_blob.reserved0[0x87];
    iVar7 = config_blob.reserved0._132_4_;
    do {
      *piVar4 = iVar2;
      iVar2 = iVar2 + 0x1b;
      piVar4 = piVar4 + 1;
      iVar7 = iVar7 + -1;
    } while (iVar7 != 0);
  }
  pcVar3 = strdup_malloc(s_<add_new_named_list>_00478c6c);
  (&DAT_004ccb5c)[local_c] = pcVar3;
  if ((DAT_004cccd8 & 2) == 0) {
    DAT_004cccd8 = DAT_004cccd8 | 2;
    DAT_004ccc96 = 1;
    DAT_004ccca5 = 0;
    DAT_004ccca4 = 0;
    _DAT_004ccca0 = 0x3f800000;
    _DAT_004ccc9c = 0;
    _DAT_004ccc90 = (undefined *)0x0;
    DAT_004ccc94 = 0;
    DAT_004ccc95 = 0;
    _DAT_004ccc98 = 0;
    crt_atexit(&DAT_004447f0);
  }
  _DAT_004ccc90 = &DAT_00478c68;
  if ((DAT_004cccd8 & 4) == 0) {
    DAT_004cccd8 = DAT_004cccd8 | 4;
    DAT_004ccb06 = 1;
    DAT_004ccb15 = 0;
    DAT_004ccb14 = 0;
    _DAT_004ccb10 = 0x3f800000;
    _DAT_004ccb0c = 0;
    _DAT_004ccb00 = (char *)0x0;
    DAT_004ccb04 = 0;
    DAT_004ccb05 = 0;
    _DAT_004ccb08 = 0;
    crt_atexit(&DAT_004447e0);
  }
  _DAT_004ccb00 = s_Delete_00478c60;
  _DAT_004d0f34 = 0xae;
  if (DAT_004d1220 == '\0') {
    if ((DAT_004d121c != 0) || (config_blob.reserved0._128_4_ == 0)) goto LAB_004446ac;
    local_8 = *arg1;
    local_4 = arg1[1] + 22.0;
    iVar7 = ui_button_update(&local_8,(ui_button_t *)&DAT_004ccb00);
    if ((char)iVar7 == '\0') goto LAB_004446ac;
    uVar5 = 0xffffffff;
    pacVar9 = config_blob.saved_names + config_blob.reserved0._132_4_ + -1;
    do {
      pacVar10 = pacVar9;
      if (uVar5 == 0) break;
      uVar5 = uVar5 - 1;
      pacVar10 = (char (*) [27])(*pacVar9 + 1);
      pcVar3 = *pacVar9;
      pacVar9 = pacVar10;
    } while (*pcVar3 != '\0');
    uVar5 = ~uVar5;
    pcVar3 = (char *)((int)pacVar10 - uVar5);
    pacVar9 = config_blob.saved_names + config_blob.reserved0._128_4_;
    config_blob.reserved0._132_4_ = config_blob.reserved0._132_4_ + -1;
    for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
      *(undefined4 *)*pacVar9 = *(undefined4 *)pcVar3;
      pcVar3 = pcVar3 + 4;
      pacVar9 = (char (*) [27])(*pacVar9 + 4);
    }
    for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
      (*pacVar9)[0] = *pcVar3;
      pcVar3 = pcVar3 + 1;
      pacVar9 = (char (*) [27])(*pacVar9 + 1);
    }
    config_blob.reserved0[0x80] = '\0';
    config_blob.reserved0[0x81] = '\0';
    config_blob.reserved0[0x82] = '\0';
    config_blob.reserved0[0x83] = '\0';
  }
  else {
    local_8 = *arg1;
    local_4 = arg1[1] + 29.0;
    iVar7 = ui_text_input_update(&local_8,(int *)&DAT_004d0f28);
    if ((char)iVar7 == '\0') {
      local_8 = *arg1 + 180.0;
      local_4 = arg1[1] + 22.0;
      iVar7 = ui_button_update(&local_8,(ui_button_t *)&DAT_004ccc90);
      if ((char)iVar7 == '\0') goto LAB_004446ac;
    }
    uVar5 = 0xffffffff;
    pcVar3 = &DAT_004ccb18;
    do {
      pcVar8 = pcVar3;
      if (uVar5 == 0) break;
      uVar5 = uVar5 - 1;
      pcVar8 = pcVar3 + 1;
      cVar1 = *pcVar3;
      pcVar3 = pcVar8;
    } while (cVar1 != '\0');
    uVar5 = ~uVar5;
    pcVar3 = pcVar8 + -uVar5;
    pacVar9 = config_blob.saved_names + config_blob.reserved0._132_4_;
    for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
      *(undefined4 *)*pacVar9 = *(undefined4 *)pcVar3;
      pcVar3 = pcVar3 + 4;
      pacVar9 = (char (*) [27])(*pacVar9 + 4);
    }
    for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
      (*pacVar9)[0] = *pcVar3;
      pcVar3 = pcVar3 + 1;
      pacVar9 = (char (*) [27])(*pacVar9 + 1);
    }
    config_blob.reserved0[0x80] = config_blob.reserved0[0x84];
    config_blob.reserved0[0x81] = config_blob.reserved0[0x85];
    config_blob.reserved0[0x82] = config_blob.reserved0[0x86];
    config_blob.reserved0[0x83] = config_blob.reserved0[0x87];
    config_blob.reserved0._132_4_ = config_blob.reserved0._132_4_ + 1;
    if (7 < (int)config_blob.reserved0._132_4_) {
      uVar5 = 0xffffffff;
      pcVar3 = &DAT_004ccb18;
      do {
        pcVar8 = pcVar3;
        if (uVar5 == 0) break;
        uVar5 = uVar5 - 1;
        pcVar8 = pcVar3 + 1;
        cVar1 = *pcVar3;
        pcVar3 = pcVar8;
      } while (cVar1 != '\0');
      uVar5 = ~uVar5;
      pcVar3 = pcVar8 + -uVar5;
      pacVar9 = config_blob.saved_names + 1;
      for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
        *(undefined4 *)*pacVar9 = *(undefined4 *)pcVar3;
        pcVar3 = pcVar3 + 4;
        pacVar9 = (char (*) [27])(*pacVar9 + 4);
      }
      for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
        (*pacVar9)[0] = *pcVar3;
        pcVar3 = pcVar3 + 1;
        pacVar9 = (char (*) [27])(*pacVar9 + 1);
      }
      config_blob.reserved0._132_4_ = config_blob.reserved0._132_4_ + -1;
    }
    DAT_004ccb18 = 0;
    _DAT_004d0f2c = 0;
    DAT_004d1220 = '\0';
  }
  highscore_load_table();
LAB_004446ac:
  if ((DAT_004cccd8 & 8) == 0) {
    DAT_004cccd8 = DAT_004cccd8 | 8;
    DAT_004d0ee8 = '\x01';
    _DAT_004d0f00 = 0;
    DAT_004d0efc = 0;
    _DAT_004d0ef0 = 0;
    _DAT_004d0eec = 0;
    _DAT_004d0ef8 = 0;
    _DAT_004d0ef4 = (undefined4 *)0x0;
    crt_atexit(&DAT_004447d0);
  }
  _DAT_004d0ef8 = local_c + 1;
  _DAT_004d0ef4 = &DAT_004ccb5c;
  DAT_004d0ee8 = arg2;
  DAT_004d0ef0 = config_blob.reserved0[0x80];
  DAT_004d0ef0_1._0_1_ = config_blob.reserved0[0x81];
  DAT_004d0ef0_1._1_1_ = config_blob.reserved0[0x82];
  DAT_004d0ef0_1._2_1_ = config_blob.reserved0[0x83];
  iVar7 = ui_list_widget_update(arg1,&DAT_004d0ee8);
  if ((-2 < iVar7) &&
     ((iVar2 = input_primary_just_pressed(), (char)iVar2 != '\0' ||
      (iVar2 = (*grim_interface_ptr->vtable->grim_was_key_pressed)((IGrim2D *)0x1c,unaff_EDI),
      (char)iVar2 != '\0')))) {
    DAT_004d121c = 1 - DAT_004d121c;
    if (-1 < iVar7) {
      config_blob.reserved0._128_4_ = iVar7;
      _DAT_004d0ef0 = iVar7;
      if (iVar7 != local_c) {
        highscore_load_table();
      }
      DAT_004d1221 = 1;
      DAT_004d1222 = 1;
    }
    DAT_004d1220 = iVar7 == local_c;
  }
  _DAT_004d0eec = DAT_004d121c;
  crt_free((void *)(&DAT_004ccb5c)[(int)local_8]);
  return extraout_EAX & 0xffffff00;
}



/* creature_spawn_tinted @ 00444810 */

/* spawns a creature with tint and default stats */

int __cdecl creature_spawn_tinted(float *pos,float *rgba,int type_id)

{
  float fVar1;
  float fVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = creature_alloc_slot();
  (&creature_pool)[iVar3].pos_x = *pos;
  (&creature_pool)[iVar3].pos_y = pos[1];
  (&creature_pool)[iVar3].active = '\x01';
  (&creature_pool)[iVar3].state_flag = '\x01';
  (&creature_pool)[iVar3].vel_x = 0.0;
  (&creature_pool)[iVar3].ai_mode = 2;
  (&creature_pool)[iVar3].collision_flag = '\0';
  (&creature_pool)[iVar3].collision_timer = 0.0;
  (&creature_pool)[iVar3].type_id = type_id;
  *(undefined1 *)&(&creature_pool)[iVar3].force_target = 0;
  (&creature_pool)[iVar3].hitbox_size = 16.0;
  (&creature_pool)[iVar3].health = 1.0;
  (&creature_pool)[iVar3].vel_y = 0.0;
  iVar4 = crt_rand();
  (&creature_pool)[iVar3].move_speed = 1.7;
  (&creature_pool)[iVar3].reward_value = 1.0;
  (&creature_pool)[iVar3].attack_cooldown = 0.0;
  (&creature_pool)[iVar3].heading = (float)(iVar4 % 0x13a) * 0.01;
  (&creature_pool)[iVar3].tint_r = *rgba;
  (&creature_pool)[iVar3].tint_g = rgba[1];
  (&creature_pool)[iVar3].tint_b = rgba[2];
  (&creature_pool)[iVar3].tint_a = rgba[3];
  iVar4 = crt_rand();
  (&creature_pool)[iVar3].contact_damage = 100.0;
  (&creature_pool)[iVar3].max_health = (&creature_pool)[iVar3].health;
  fVar2 = (float)(iVar4 % 0x14) + 47.0;
  (&creature_pool)[iVar3].size = fVar2;
  if ((type_id != 3) && (type_id != 4)) {
    return iVar3;
  }
  fVar1 = (&creature_pool)[iVar3].move_speed;
  (&creature_pool)[iVar3].flags = (&creature_pool)[iVar3].flags | 0x80;
  (&creature_pool)[iVar3].move_speed = fVar1 * 1.2;
  (&creature_pool)[iVar3].size = fVar2 * 0.8;
  return iVar3;
}



/* player_fire_weapon @ 00444980 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* handles player firing: cooldowns, ammo, projectiles, and muzzle effects */

void __cdecl player_fire_weapon(char param_1,char param_2)

{
  float fVar1;
  float fVar2;
  bool bVar3;
  bool bVar4;
  player_state_t *ppVar5;
  int iVar6;
  int iVar7;
  float10 fVar8;
  float10 fVar9;
  undefined4 *unaff_retaddr;
  int iVar10;
  int owner_id;
  float fVar11;
  float local_14;
  float local_10;
  float local_c;
  float local_8;
  
  iVar6 = game_is_full_version();
  if ((char)iVar6 == '\0') {
    crt_exit(0);
  }
  iVar6 = render_overlay_player_index;
  if (console_open_flag == '\0') {
    iVar7 = render_overlay_player_index * 0x360;
    if (*(float *)(&player_health)[render_overlay_player_index]._pad0 <= 0.0) {
      (&player_death_timer)[render_overlay_player_index * 0xd8] =
           (float)(&player_death_timer)[render_overlay_player_index * 0xd8] - frame_dt * 20.0;
      return;
    }
    fVar2 = *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2d8) -
            (frame_dt + frame_dt);
    *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x2d8) = fVar2;
    if (fVar2 < 0.0) {
      ppVar5 = &player_health + iVar6;
      ppVar5->_pad0[0x2d8] = '\0';
      ppVar5->_pad0[0x2d9] = '\0';
      ppVar5->_pad0[0x2da] = '\0';
      ppVar5->_pad0[0x2db] = '\0';
    }
    ppVar5 = &player_health + iVar6;
    ppVar5->_pad0[0x2b0] = '\0';
    ppVar5->_pad0[0x2b1] = '\0';
    ppVar5->_pad0[0x2b2] = '\0';
    ppVar5->_pad0[0x2b3] = '\0';
    *(undefined4 *)(&player_move_dx + iVar7) = 0;
    *(undefined4 *)(&player_move_dy + iVar7) = 0;
    ppVar5 = &player_health + iVar6;
    ppVar5->_pad0[0x294] = '\0';
    ppVar5->_pad0[0x295] = '\0';
    ppVar5->_pad0[0x296] = '\0';
    ppVar5->_pad0[0x297] = '\0';
    *(undefined4 *)((&player_health)[iVar6]._pad0 + 0x2a8) =
         *(undefined4 *)((&player_health)[iVar6]._pad0 + 0x2a0);
    ppVar5 = &player_health + iVar6;
    ppVar5->_pad0[0x2ac] = '\0';
    ppVar5->_pad0[0x2ad] = '\0';
    ppVar5->_pad0[0x2ae] = '\0';
    ppVar5->_pad0[0x2af] = '\0';
    if (param_2 != '\0') {
      player_start_reload();
      iVar6 = render_overlay_player_index;
    }
    bVar3 = false;
    *(undefined4 *)((&player_health)[iVar6]._pad0 + 0x2c) = *unaff_retaddr;
    *(undefined4 *)((&player_health)[iVar6]._pad0 + 0x30) = unaff_retaddr[1];
    fVar9 = (float10)fpatan((float10)(float)(&player_pos_y)[iVar6 * 0xd8] -
                            (float10)*(float *)((&player_health)[iVar6]._pad0 + 0x30),
                            (float10)(float)(&player_pos_x)[iVar6 * 0xd8] -
                            (float10)*(float *)((&player_health)[iVar6]._pad0 + 0x2c));
    *(float *)((&player_health)[iVar6]._pad0 + 0x2dc) = (float)(fVar9 - (float10)1.5707964);
    if ((*(float *)((&player_health)[iVar6]._pad0 + 0x2b0) <= 0.0) &&
       (*(float *)((&player_health)[iVar6]._pad0 + 0x2ac) == 0.0)) {
      bVar3 = true;
      (&player_health)[iVar6]._pad0[0x2a4] = '\0';
    }
    bVar4 = false;
    if (((*(float *)((&player_health)[iVar6]._pad0 + 0x2b0) <= 0.0) &&
        (0 < *(int *)((&player_health)[iVar6]._pad0 + 0x88))) &&
       ((iVar6 = perk_count_get(perk_id_regression_bullets), iVar6 != 0 ||
        (iVar7 = perk_count_get(perk_id_ammunition_within), iVar6 = render_overlay_player_index,
        bVar4 = false, iVar7 != 0)))) {
      bVar4 = true;
      iVar6 = render_overlay_player_index;
    }
    if ((bVar3) || (bVar4)) {
      fVar2 = *(float *)((&player_health)[iVar6]._pad0 + 0x2dc);
      if (param_1 != '\0') {
        fVar9 = ((float10)fVar2 - (float10)1.5707964) - (float10)0.150915;
        fVar8 = (float10)fcos(fVar9);
        fVar11 = (float)(fVar8 * (float10)16.0);
        fVar9 = (float10)fsin(fVar9);
        fVar1 = (float)(fVar9 * (float10)16.0);
        if (((&weapon_table)[*(int *)((&player_health)[iVar6]._pad0 + 0x29c)].flags & 1) != 0) {
          crt_rand();
          crt_rand();
          iVar6 = render_overlay_player_index;
        }
        if (1.0 < *(float *)((&player_health)[iVar6]._pad0 + 0x2d8)) {
          ppVar5 = &player_health + iVar6;
          ppVar5->_pad0[0x2d8] = '\0';
          ppVar5->_pad0[0x2d9] = '\0';
          ppVar5->_pad0[0x2da] = 0x80;
          ppVar5->_pad0[0x2db] = '?';
        }
        *(float *)((&player_health)[iVar6]._pad0 + 0x2d8) =
             (&weapon_table)[*(int *)((&player_health)[iVar6]._pad0 + 0x29c)].spread_heat +
             *(float *)((&player_health)[iVar6]._pad0 + 0x2d8);
        sfx_play_panned((float)(&weapon_table)[*(int *)((&player_health)[iVar6]._pad0 + 0x29c)].
                               shot_sfx_base_id);
        if (*(int *)((&player_health)[render_overlay_player_index]._pad0 + 0x29c) == 3) {
          fVar9 = (float10)fcos((float10)fVar2);
          local_14 = (float)(fVar9 * (float10)25.0);
          fVar8 = (float10)fsin((float10)fVar2);
          local_10 = (float)(fVar8 * (float10)25.0);
          local_8 = fVar1 + (float)(&player_pos_y)[render_overlay_player_index * 0xd8];
          local_c = fVar11 + (float)(&player_pos_x)[render_overlay_player_index * 0xd8];
          iVar6 = fx_spawn_sprite(&local_c,&local_14,1.0);
          local_c = (float)fVar9 * 15.0;
          (&sprite_effect_pool)[iVar6].color_r = 0.5;
          (&sprite_effect_pool)[iVar6].color_g = 0.5;
          local_8 = (float)fVar8 * 15.0;
          (&sprite_effect_pool)[iVar6].color_b = 0.5;
          (&sprite_effect_pool)[iVar6].color_a = 0.25;
          local_10 = fVar1 + (float)(&player_pos_y)[render_overlay_player_index * 0xd8];
          local_14 = fVar11 + (float)(&player_pos_x)[render_overlay_player_index * 0xd8];
          iVar6 = fx_spawn_sprite(&local_14,&local_c,2.0);
          iVar7 = 0xc;
          (&sprite_effect_pool)[iVar6].color_r = 0.5;
          (&sprite_effect_pool)[iVar6].color_g = 0.5;
          (&sprite_effect_pool)[iVar6].color_b = 0.5;
          (&sprite_effect_pool)[iVar6].color_a = 0.223;
          do {
            owner_id = -100;
            iVar10 = 3;
            local_8 = fVar1 + (float)(&player_pos_y)[render_overlay_player_index * 0xd8];
            local_c = fVar11 + (float)(&player_pos_x)[render_overlay_player_index * 0xd8];
            iVar6 = crt_rand();
            iVar6 = projectile_spawn(&local_c,(float)(iVar6 % 200 + -100) * 0.0013 + fVar2,iVar10,
                                     owner_id);
            iVar10 = crt_rand();
            iVar7 = iVar7 + -1;
            (&projectile_pool)[iVar6].speed_scale = (float)(iVar10 % 100) * 0.01 + 1.0;
          } while (iVar7 != 0);
        }
        iVar7 = perk_id_sharpshooter;
        iVar6 = render_overlay_player_index;
        if (*(int *)(player_health._pad0 + perk_id_sharpshooter * 4 + 0x94) < 1) {
          *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x294) =
               _DAT_00473a40 * frame_dt * 150.0 +
               *(float *)((&player_health)[render_overlay_player_index]._pad0 + 0x294);
        }
        if (_DAT_00473a40 + _DAT_00473a40 < *(float *)((&player_health)[iVar6]._pad0 + 0x294)) {
          *(float *)((&player_health)[iVar6]._pad0 + 0x294) = _DAT_00473a40 + _DAT_00473a40;
        }
        iVar10 = perk_id_fastshot;
        *(float *)((&player_health)[iVar6]._pad0 + 0x294) =
             _DAT_00473a40 * *(float *)((&player_health)[iVar6]._pad0 + 0x294);
        if (0 < *(int *)(player_health._pad0 + iVar10 * 4 + 0x94)) {
          *(float *)((&player_health)[iVar6]._pad0 + 0x2b0) =
               *(float *)((&player_health)[iVar6]._pad0 + 0x2b0) * 0.88;
        }
        if (0 < *(int *)(player_health._pad0 + iVar7 * 4 + 0x94)) {
          *(float *)((&player_health)[iVar6]._pad0 + 0x2b0) =
               *(float *)((&player_health)[iVar6]._pad0 + 0x2b0) * 1.05;
        }
        if (*(float *)((&player_health)[iVar6]._pad0 + 0x2a8) <= 0.0) {
          player_start_reload();
          iVar6 = render_overlay_player_index;
        }
      }
    }
    fVar2 = *(float *)((&player_health)[iVar6]._pad0 + 0x70);
    while (14.0 < fVar2) {
      fVar2 = *(float *)((&player_health)[iVar6]._pad0 + 0x70) - 14.0;
      *(float *)((&player_health)[iVar6]._pad0 + 0x70) = fVar2;
    }
    fVar2 = *(float *)((&player_health)[iVar6]._pad0 + 0x10) * 0.5;
    if ((float)(&player_pos_x)[iVar6 * 0xd8] < fVar2) {
      (&player_pos_x)[iVar6 * 0xd8] = fVar2;
    }
    if ((float)terrain_texture_width - fVar2 < (float)(&player_pos_x)[iVar6 * 0xd8]) {
      (&player_pos_x)[iVar6 * 0xd8] = (float)terrain_texture_width - fVar2;
    }
    if ((float)(&player_pos_y)[iVar6 * 0xd8] < fVar2) {
      (&player_pos_y)[iVar6 * 0xd8] = fVar2;
    }
    if ((float)terrain_texture_height - fVar2 < (float)(&player_pos_y)[iVar6 * 0xd8]) {
      (&player_pos_y)[iVar6 * 0xd8] = (float)terrain_texture_height - fVar2;
    }
    if (0.8 < *(float *)((&player_health)[iVar6]._pad0 + 0x2d8)) {
      ppVar5 = &player_health + iVar6;
      ppVar5->_pad0[0x2d8] = 0xcd;
      ppVar5->_pad0[0x2d9] = 0xcc;
      ppVar5->_pad0[0x2da] = 'L';
      ppVar5->_pad0[0x2db] = '?';
    }
  }
  return;
}



/* FUN_00444f70 @ 00444f70 */

char * __cdecl FUN_00444f70(char param_1)

{
  int iVar1;
  int iVar2;
  
  iVar2 = 0x34;
  if (param_1 == '\0') {
    iVar2 = 0x33;
  }
  iVar1 = crt_rand();
  switch(iVar1 % iVar2) {
  case 0:
    return &DAT_00478dfc;
  case 1:
    return &DAT_00478df8;
  case 2:
    return &DAT_00478df0;
  case 3:
    return &DAT_00478de8;
  case 4:
    return &DAT_00478de4;
  case 5:
    return &DAT_00478ddc;
  case 6:
    return &DAT_00478dd4;
  case 7:
    return &DAT_00478dcc;
  case 8:
    return &DAT_00478dc4;
  case 9:
    return &DAT_00478dc0;
  case 10:
    return &DAT_00478dbc;
  case 0xb:
    return &DAT_00478db8;
  case 0xc:
    return &DAT_00478db0;
  case 0xd:
    return &DAT_00478da8;
  case 0xe:
    return &DAT_00478da0;
  case 0xf:
    return &DAT_00478d9c;
  case 0x10:
    return &DAT_00478d98;
  case 0x11:
    return &DAT_00478d90;
  case 0x12:
    return &DAT_00478d88;
  case 0x13:
    return &DAT_00478d80;
  case 0x14:
    return &DAT_00478d78;
  case 0x15:
    return &DAT_00478d70;
  case 0x16:
    return &DAT_00478d68;
  case 0x17:
    return &DAT_00478d64;
  case 0x18:
    return s_harry_00478d5c;
  case 0x19:
    return &DAT_00478d58;
  case 0x1a:
    return &DAT_00478d54;
  case 0x1b:
    return &DAT_00478d4c;
  case 0x1c:
    return &DAT_00478d44;
  case 0x1d:
    return &DAT_00478d3c;
  case 0x1e:
    return s_quick_00478d34;
  case 0x1f:
    return s_brown_00478d2c;
  case 0x20:
    return &DAT_00478d28;
  case 0x21:
    return s_jumper_00478d20;
  case 0x22:
    return &DAT_00478d18;
  case 0x23:
    return &DAT_00478d10;
  case 0x24:
    return &DAT_00478d0c;
  case 0x25:
    return &DAT_00478d04;
  case 0x26:
    return s_unique_00478cfc;
  default:
    return &DAT_00478c98;
  case 0x28:
    return &DAT_00478cf4;
  case 0x29:
    return s_sleep_00478cec;
  case 0x2a:
    return &DAT_00478ce4;
  case 0x2b:
    return &DAT_00478cdc;
  case 0x2c:
    return &DAT_00478cd4;
  case 0x2d:
    return s_below_00478ccc;
  case 0x2e:
    return s_scape_00478cc4;
  case 0x2f:
    return &DAT_00478cbc;
  case 0x30:
    return &DAT_00478cb4;
  case 0x31:
    return s_break_00478cac;
  case 0x32:
    return &DAT_00478ca4;
  case 0x33:
    return &DAT_00478ca0;
  }
}



/* FUN_004451b0 @ 004451b0 */

/* [binja] void* sub_4451b0() */

void * FUN_004451b0(void)

{
  byte bVar1;
  char *pcVar2;
  highscore_record_t *phVar3;
  int iVar4;
  uint uVar5;
  void *pvVar6;
  void *this;
  void *extraout_ECX;
  uint uVar7;
  int iVar8;
  int iVar9;
  highscore_record_t *phVar10;
  undefined4 *puVar11;
  byte *pbVar12;
  byte *pbVar13;
  highscore_record_t *phVar14;
  undefined4 *puVar15;
  bool bVar16;
  undefined4 *local_8;
  int local_4;
  
  if (DAT_004d7580 == '\0') {
    highscore_load_table();
    iVar9 = 0;
    phVar10 = &highscore_table;
    local_4 = 0;
    local_8 = (undefined4 *)&DAT_004d1228;
    do {
      pbVar12 = &DAT_004d1228;
      iVar8 = 0;
      phVar3 = phVar10;
      pbVar13 = pbVar12;
      if (0x4d1228 < (int)local_8) {
LAB_004451ef:
        do {
          bVar1 = phVar3->player_name[0];
          bVar16 = bVar1 < *pbVar12;
          if (bVar1 == *pbVar12) {
            if (bVar1 != 0) {
              bVar1 = phVar3->player_name[1];
              bVar16 = bVar1 < pbVar12[1];
              if (bVar1 != pbVar12[1]) goto LAB_00445213;
              pbVar12 = pbVar12 + 2;
              phVar3 = (highscore_record_t *)(phVar3->player_name + 2);
              if (bVar1 != 0) goto LAB_004451ef;
            }
            iVar4 = 0;
          }
          else {
LAB_00445213:
            iVar4 = (1 - (uint)bVar16) - (uint)(bVar16 != 0);
          }
          iVar9 = local_4;
          if (iVar4 == 0) goto LAB_004452a7;
          iVar8 = iVar8 + 1;
          pbVar12 = pbVar13 + 0x20;
          phVar3 = phVar10;
          pbVar13 = pbVar12;
        } while (iVar8 < local_4);
      }
      uVar5 = 0xffffffff;
      iVar8 = 0;
      phVar3 = phVar10;
      do {
        if (uVar5 == 0) break;
        uVar5 = uVar5 - 1;
        pcVar2 = phVar3->player_name;
        phVar3 = (highscore_record_t *)(phVar3->player_name + 1);
      } while (*pcVar2 != '\0');
      pvVar6 = (void *)(~uVar5 - 1);
      this = pvVar6;
      if (0 < (int)pvVar6) {
        do {
          uVar5 = crt_isalpha(this,(int)phVar10->player_name[iVar8]);
          if ((uVar5 == 0) && (phVar10->player_name[iVar8] != '.')) goto LAB_004452a7;
          iVar8 = iVar8 + 1;
          this = extraout_ECX;
        } while (iVar8 < (int)pvVar6);
      }
      uVar5 = 0xffffffff;
      local_4 = iVar9 + 1;
      phVar3 = phVar10;
      do {
        phVar14 = phVar3;
        if (uVar5 == 0) break;
        uVar5 = uVar5 - 1;
        phVar14 = (highscore_record_t *)(phVar3->player_name + 1);
        pcVar2 = phVar3->player_name;
        phVar3 = phVar14;
      } while (*pcVar2 != '\0');
      uVar5 = ~uVar5;
      puVar11 = (undefined4 *)((int)phVar14 - uVar5);
      puVar15 = local_8;
      for (uVar7 = uVar5 >> 2; uVar7 != 0; uVar7 = uVar7 - 1) {
        *puVar15 = *puVar11;
        puVar11 = puVar11 + 1;
        puVar15 = puVar15 + 1;
      }
      for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
        *(undefined1 *)puVar15 = *(undefined1 *)puVar11;
        puVar11 = (undefined4 *)((int)puVar11 + 1);
        puVar15 = (undefined4 *)((int)puVar15 + 1);
      }
      console_printf(&console_log_queue,s__d__unique___s_00478e14,local_4,phVar10);
      iVar9 = local_4;
      local_8 = local_8 + 8;
LAB_004452a7:
      phVar10 = phVar10 + 1;
    } while ((int)phVar10 < 0x484730);
    DAT_004d7580 = '\x01';
    DAT_004d7584 = iVar9;
    if (iVar9 == 0) {
      crt_sprintf(&DAT_004d1228,s_quickbrownfox_00478e04);
    }
  }
  if (DAT_004d7584 < 1) {
    return &DAT_004d1228;
  }
  iVar9 = crt_rand();
  return &DAT_004d1228 + (iVar9 % DAT_004d7584) * 0x20;
}



/* FUN_00445310 @ 00445310 */

/* [binja] int32_t sub_445310(char* arg1, int32_t arg2) */

int __cdecl FUN_00445310(char *arg1,int arg2)

{
  byte bVar1;
  int in_EAX;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  byte *pbVar5;
  creature_t *pcVar6;
  bool bVar7;
  
  iVar3 = 0;
  pbVar4 = &DAT_004d152c;
  pcVar6 = &creature_pool;
  do {
    if ((pcVar6->active != '\0') && (pbVar2 = pbVar4, pbVar5 = (byte *)arg1, iVar3 != arg2)) {
      do {
        bVar1 = *pbVar2;
        bVar7 = bVar1 < *pbVar5;
        if (bVar1 != *pbVar5) {
LAB_00445355:
          in_EAX = (1 - (uint)bVar7) - (uint)(bVar7 != 0);
          goto LAB_0044535a;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar2[1];
        bVar7 = bVar1 < pbVar5[1];
        if (bVar1 != pbVar5[1]) goto LAB_00445355;
        pbVar2 = pbVar2 + 2;
        pbVar5 = pbVar5 + 2;
      } while (bVar1 != 0);
      in_EAX = 0;
LAB_0044535a:
      if (in_EAX == 0) {
        return 0;
      }
    }
    pcVar6 = pcVar6 + 1;
    iVar3 = iVar3 + 1;
    pbVar4 = pbVar4 + 0x40;
    if (0x4aa337 < (int)pcVar6) {
      return CONCAT31((int3)((uint)in_EAX >> 8),1);
    }
  } while( true );
}



/* creature_name_assign_random @ 00445380 */

/* builds a randomized creature name string into DAT_004d152c for debug overlays */

void __cdecl creature_name_assign_random(int creature_id)

{
  char cVar1;
  bool bVar2;
  int iVar3;
  char *pcVar4;
  char *pcVar5;
  char *pcVar6;
  char *pcVar7;
  uint uVar8;
  uint uVar9;
  char *dst;
  int local_4;
  
  local_4 = 0;
  do {
    if ((int)highscore_active_record.score_xp < 0x79) {
LAB_0044544d:
      if ((((int)highscore_active_record.score_xp < 0x51) ||
          (iVar3 = crt_rand(), 0x4f < iVar3 % 100)) &&
         (((int)highscore_active_record.score_xp < 0x3d || (iVar3 = crt_rand(), 0x27 < iVar3 % 100))
         )) {
        if ((((int)highscore_active_record.score_xp < 0x29) ||
            (iVar3 = crt_rand(), 0x4f < iVar3 % 100)) &&
           (((int)highscore_active_record.score_xp < 0x15 ||
            (iVar3 = crt_rand(), 0x27 < iVar3 % 100)))) {
          dst = &DAT_004d152c + creature_id * 0x40;
          pcVar4 = FUN_00444f70('\0');
          crt_sprintf(dst,&DAT_00471fc4,pcVar4);
        }
        else {
          dst = &DAT_004d152c + creature_id * 0x40;
          pcVar4 = FUN_00444f70('\0');
          pcVar5 = FUN_00444f70('\x01');
          crt_sprintf(dst,&DAT_00477bf4,pcVar5,pcVar4);
        }
      }
      else {
        dst = &DAT_004d152c + creature_id * 0x40;
        pcVar4 = FUN_00444f70('\0');
        pcVar5 = FUN_00444f70('\0');
        pcVar6 = FUN_00444f70('\x01');
        crt_sprintf(dst,s__s_s_s_00478e24,pcVar6,pcVar5,pcVar4);
      }
    }
    else {
      iVar3 = crt_rand();
      if (iVar3 % 100 < 10) {
        dst = &DAT_004d152c + creature_id * 0x40;
        pcVar4 = FUN_004451b0();
        uVar8 = 0xffffffff;
        do {
          pcVar5 = pcVar4;
          if (uVar8 == 0) break;
          uVar8 = uVar8 - 1;
          pcVar5 = pcVar4 + 1;
          cVar1 = *pcVar4;
          pcVar4 = pcVar5;
        } while (cVar1 != '\0');
        uVar8 = ~uVar8;
        pcVar4 = pcVar5 + -uVar8;
        pcVar5 = dst;
        for (uVar9 = uVar8 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
          *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
          pcVar4 = pcVar4 + 4;
          pcVar5 = pcVar5 + 4;
        }
        for (uVar8 = uVar8 & 3; uVar8 != 0; uVar8 = uVar8 - 1) {
          *pcVar5 = *pcVar4;
          pcVar4 = pcVar4 + 1;
          pcVar5 = pcVar5 + 1;
        }
      }
      else {
        if (((int)highscore_active_record.score_xp < 0x79) ||
           (iVar3 = crt_rand(), 0x4f < iVar3 % 100)) goto LAB_0044544d;
        dst = &DAT_004d152c + creature_id * 0x40;
        pcVar4 = FUN_00444f70('\0');
        pcVar5 = FUN_00444f70('\0');
        pcVar6 = FUN_00444f70('\0');
        pcVar7 = FUN_00444f70('\x01');
        crt_sprintf(dst,s__s_s_s_s_00478e2c,pcVar7,pcVar6,pcVar5,pcVar4);
      }
    }
    iVar3 = FUN_00445310(dst,creature_id);
    if ((char)iVar3 != '\0') {
      uVar8 = 0xffffffff;
      do {
        if (uVar8 == 0) break;
        uVar8 = uVar8 - 1;
        cVar1 = *dst;
        dst = dst + 1;
      } while (cVar1 != '\0');
      if ((~uVar8 - 1 < 0x10) || (bVar2 = 99 < local_4, local_4 = local_4 + 1, bVar2)) {
        return;
      }
    }
  } while( true );
}



/* creature_find_by_name @ 00445590 */

/* returns the first creature index whose name matches DAT_004d152c, or -1 */

int __cdecl creature_find_by_name(char *name)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte *pbVar6;
  creature_t *pcVar7;
  bool bVar8;
  
  iVar2 = 0;
  pbVar5 = &DAT_004d152c;
  pcVar7 = &creature_pool;
  do {
    pbVar3 = pbVar5;
    pbVar6 = (byte *)name;
    if (pcVar7->active != '\0') {
      do {
        bVar1 = *pbVar3;
        bVar8 = bVar1 < *pbVar6;
        if (bVar1 != *pbVar6) {
LAB_004455cf:
          iVar4 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
          goto LAB_004455d4;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar3[1];
        bVar8 = bVar1 < pbVar6[1];
        if (bVar1 != pbVar6[1]) goto LAB_004455cf;
        pbVar3 = pbVar3 + 2;
        pbVar6 = pbVar6 + 2;
      } while (bVar1 != 0);
      iVar4 = 0;
LAB_004455d4:
      if (iVar4 == 0) {
        return iVar2;
      }
    }
    pcVar7 = pcVar7 + 1;
    iVar2 = iVar2 + 1;
    pbVar5 = pbVar5 + 0x40;
    if (0x4aa337 < (int)pcVar7) {
      return -1;
    }
  } while( true );
}



/* creature_name_draw_labels @ 00445600 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* debug overlay: draws creature name labels over world positions */

void creature_name_draw_labels(void)

{
  IGrim2D *self;
  int iVar1;
  char *unaff_ESI;
  float *pfVar2;
  IGrim2D *unaff_EDI;
  IGrim2D *self_00;
  uint value;
  IGrim2D text;
  float fStack_28;
  IGrim2D IStack_18;
  IGrim2D *pIStack_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  float local_4;
  
  text.vtable = (IGrim2D_vtbl *)0x3f800000;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  local_4 = 1.0;
  value = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,(float)unaff_EDI);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,value);
  self_00 = (IGrim2D *)&DAT_004d152c;
  pfVar2 = &creature_pool.hitbox_size;
  do {
    if (((creature_t *)(pfVar2 + -4))->active != '\0') {
      iVar1 = (*grim_interface_ptr->vtable->grim_measure_text_width)(self_00,(char *)text.vtable);
      if ((0.0 <= *pfVar2) || (fStack_28 = (*pfVar2 + 10.0) * 0.1, 1.0 < fStack_28)) {
        fStack_28 = 1.0;
      }
      else if (fStack_28 < 0.0) {
        fStack_28 = 0.0;
      }
      self = (IGrim2D *)((_camera_offset_y + pfVar2[2]) - 50.0);
      local_4 = fStack_28 * 0.67;
      IStack_18.vtable =
           (IGrim2D_vtbl *)(((_camera_offset_x + pfVar2[1]) - (float)iVar1 * 0.5) - 4.0);
      pIStack_14 = self;
      (*grim_interface_ptr->vtable->grim_draw_rect_filled)
                (&IStack_18,(float *)(float)(iVar1 + 8),15.0,(float)&local_10);
      (*grim_interface_ptr->vtable->grim_set_color)
                ((IGrim2D *)0x3f800000,1.0,1.0,fStack_28,(float)unaff_EDI);
      text.vtable = IStack_18.vtable;
      unaff_EDI = self_00;
      (*grim_interface_ptr->vtable->grim_draw_text_small)
                (self,(float)IStack_18.vtable,(float)self_00,unaff_ESI);
    }
    pfVar2 = pfVar2 + 0x26;
    self_00 = self_00 + 0x10;
  } while ((int)pfVar2 < 0x4aa348);
  return;
}



/* survival_gameplay_update_and_render @ 004457c0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* survival mode frame loop: effects, spawns, death handling, world render, HUD, and debug name
   input */

void survival_gameplay_update_and_render(void)

{
  undefined1 *puVar1;
  byte bVar2;
  IGrim2D_vtbl *pIVar3;
  IGrim2D *pIVar4;
  int iVar5;
  uint uVar6;
  undefined4 *puVar7;
  IGrim2D *unaff_EBX;
  float unaff_ESI;
  byte *pbVar8;
  uint unaff_EDI;
  bool bVar9;
  float10 fVar10;
  longlong lVar11;
  float unaff_retaddr;
  float in_stack_00000008;
  uint in_stack_ffffffd0;
  float in_stack_ffffffd4;
  float v1;
  float fVar12;
  uint in_stack_ffffffd8;
  float fVar13;
  undefined *y;
  IGrim2D *in_stack_ffffffdc;
  char *pcVar14;
  float h;
  IGrim2D *in_stack_ffffffe4;
  float fStack_18;
  float fStack_10;
  float fStack_c;
  float fStack_8;
  float fStack_4;
  
  fVar13 = (float)(in_stack_ffffffd0 & 0xffffff00);
  fVar12 = (float)(in_stack_ffffffd8 & 0xffffff00);
  if ((DAT_004d1528 & 1) == 0) {
    _DAT_004d7570 = player_pos_x + 128.0;
    DAT_004d1528 = DAT_004d1528 | 1;
    _DAT_004d7574 = player_pos_y;
    crt_atexit(&DAT_00445ff0);
  }
  pIVar4 = grim_interface_ptr;
  if (DAT_00478c94 != '\0') {
    DAT_004d7588 = 0;
    DAT_004d14a8 = 0;
    DAT_00478c94 = '\0';
  }
  (&DAT_004d14a9)[DAT_004d7588] = 0;
  iVar5 = (*pIVar4->vtable->grim_is_key_down)((IGrim2D *)0x1c,unaff_EDI);
  if (((char)iVar5 != '\0') && (0 < DAT_004d7588)) {
    sfx_play(sfx_ui_typeenter);
    DAT_004d7578 = DAT_004d7578 + 1;
    (&DAT_004d14a8)[DAT_004d7588] = 0;
    iVar5 = creature_find_by_name(&DAT_004d14a8);
    if (iVar5 == -1) {
      pbVar8 = &DAT_004d14a8;
      pcVar14 = s_reload_00478e38;
      do {
        bVar2 = *pcVar14;
        bVar9 = bVar2 < *pbVar8;
        if (bVar2 != *pbVar8) {
LAB_00445900:
          iVar5 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
          goto LAB_00445905;
        }
        if (bVar2 == 0) break;
        bVar2 = ((byte *)pcVar14)[1];
        bVar9 = bVar2 < pbVar8[1];
        if (bVar2 != pbVar8[1]) goto LAB_00445900;
        pcVar14 = (char *)((byte *)pcVar14 + 2);
        pbVar8 = pbVar8 + 2;
      } while (bVar2 != 0);
      iVar5 = 0;
LAB_00445905:
      if (iVar5 == 0) {
        in_stack_ffffffdc = (IGrim2D *)CONCAT31((int3)((uint)in_stack_ffffffdc >> 8),1);
      }
    }
    else {
      in_stack_ffffffd4 = (float)CONCAT31((int3)((uint)in_stack_ffffffd4 >> 8),1);
      _DAT_004d7570 = (&creature_pool)[iVar5].pos_x;
      _DAT_004d7574 = (&creature_pool)[iVar5].pos_y;
      DAT_004d757c = DAT_004d757c + 1;
    }
    DAT_004d7588 = 0;
    DAT_004d14a8 = 0;
  }
  iVar5 = console_input_poll();
  if ((iVar5 != 0) && (iVar5 != 0xd)) {
    if (iVar5 == 8) {
      uVar6 = crt_rand();
      uVar6 = uVar6 & 0x80000001;
      if ((int)uVar6 < 0) {
        uVar6 = (uVar6 - 1 | 0xfffffffe) + 1;
      }
      sfx_play(uVar6 + _sfx_ui_typeclick_01);
      if (DAT_004d7588 < 1) {
        DAT_004d14a8 = 0;
      }
      else {
        puVar1 = &DAT_004d14a7 + DAT_004d7588;
        DAT_004d7588 = DAT_004d7588 + -1;
        *puVar1 = 0;
      }
    }
    else {
      if (DAT_004d7588 < 0x11) {
        (&DAT_004d14a8)[DAT_004d7588] = (char)iVar5;
        DAT_004d7588 = DAT_004d7588 + 1;
      }
      (&DAT_004d14a8)[DAT_004d7588] = 0;
      uVar6 = crt_rand();
      uVar6 = uVar6 & 0x80000001;
      if ((int)uVar6 < 0) {
        uVar6 = (uVar6 - 1 | 0xfffffffe) + 1;
      }
      sfx_play(uVar6 + _sfx_ui_typeclick_01);
    }
  }
  perks_update_effects();
  h = frame_dt;
  if (time_scale_active != '\0') {
    _time_scale_factor = 0x3e99999a;
    frame_dt = frame_dt * 0.3;
    lVar11 = __ftol();
    frame_dt_ms = (int)lVar11;
  }
  effects_update();
  v1 = in_stack_ffffffd4;
  if (game_state_id == 0x12) {
    creature_update_all();
    projectile_update();
    v1 = in_stack_ffffffd4;
    if ((game_state_id == 0x12) &&
       (render_overlay_player_index = 0, 0 < (int)config_blob.reserved0._20_4_)) {
      do {
        player_fire_weapon('p',SUB41(in_stack_ffffffd4,0));
        render_overlay_player_index = render_overlay_player_index + 1;
      } while (render_overlay_player_index < (int)config_blob.reserved0._20_4_);
    }
  }
  render_overlay_player_index = 0;
  player_health._pad0[0x29c] = '\x03';
  player_health._pad0[0x29d] = '\0';
  player_health._pad0[0x29e] = '\0';
  player_health._pad0[0x29f] = '\0';
  player_health._pad0[0x2a8] = '\0';
  player_health._pad0[0x2a9] = '\0';
  player_health._pad0[0x2aa] = 0xf0;
  player_health._pad0[0x2ab] = 'A';
  if (console_open_flag == '\0') {
    survival_spawn_cooldown = survival_spawn_cooldown - config_blob.reserved0._20_4_ * frame_dt_ms;
  }
  while (survival_spawn_cooldown < 0) {
    survival_spawn_cooldown =
         survival_spawn_cooldown + (0xdac - (int)highscore_active_record.survival_elapsed_ms / 800);
    if (survival_spawn_cooldown < 100) {
      survival_spawn_cooldown = 100;
    }
    in_stack_ffffffdc = (IGrim2D *)(highscore_active_record.survival_elapsed_ms + 1);
    unaff_retaddr = 1.0;
    fVar10 = (float10)(int)in_stack_ffffffdc;
    fStack_c = (float)(fVar10 * (float10)8.333333e-06 + (float10)0.3);
    fStack_8 = (float)(fVar10 * (float10)10000.0 + (float10)0.3);
    fVar10 = (float10)fsin(fVar10 * (float10)0.000100000005);
    fStack_4 = (float)(fVar10 + (float10)0.3);
    if (0.0 <= fStack_c) {
      if (1.0 < fStack_c) {
        fStack_c = 1.0;
      }
    }
    else {
      fStack_c = 0.0;
    }
    if (0.0 <= fStack_8) {
      if (1.0 < fStack_8) {
        fStack_8 = 1.0;
      }
    }
    else {
      fStack_8 = 0.0;
    }
    if (0.0 <= fStack_4) {
      if (1.0 < fStack_4) {
        fStack_4 = 1.0;
      }
    }
    else {
      fStack_4 = 0.0;
    }
    DAT_004d758c = DAT_004d758c + 1;
    v1 = (float)terrain_texture_width + 64.0;
    fVar10 = (float10)fcos((float10)(int)highscore_active_record.survival_elapsed_ms *
                           (float10)0.001);
    fVar12 = (float)((float10)terrain_texture_height * (float10)0.5 + fVar10 * (float10)256.0);
    iVar5 = creature_spawn_tinted((float *)&stack0xffffffd4,&fStack_c,4);
    creature_name_assign_random(iVar5);
    in_stack_ffffffe4 = (IGrim2D *)0xc2800000;
    fVar10 = (float10)fcos((float10)(int)highscore_active_record.survival_elapsed_ms *
                           (float10)0.001);
    fStack_18 = (float)((float10)terrain_texture_height * (float10)0.5 + fVar10 * (float10)256.0);
    iVar5 = creature_spawn_tinted((float *)&stack0xffffffe4,&fStack_c,2);
    creature_name_assign_random(iVar5);
  }
  highscore_active_record.score_xp = player_health._pad0._136_4_;
  if (console_open_flag == '\0') {
    _bonus_weapon_power_up_timer = 0;
    highscore_active_record.survival_elapsed_ms =
         highscore_active_record.survival_elapsed_ms + frame_dt_ms;
    _bonus_reflex_boost_timer = 0;
    time_scale_active = '\0';
    (&DAT_0048708c)[player_health._pad0._668_4_] =
         (&DAT_0048708c)[player_health._pad0._668_4_] + frame_dt_ms;
  }
  camera_update();
  gameplay_render_world();
  creature_name_draw_labels();
  puVar7 = &bonus_pool;
  do {
    *puVar7 = 0;
    puVar7 = puVar7 + 7;
  } while ((int)puVar7 < 0x482b08);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,unaff_ESI);
  if ((((demo_mode_active == '\0') && ((float)player_health._pad0._0_4_ <= 0.0)) &&
      (player_death_timer < 0.0)) &&
     ((config_blob.reserved0._20_4_ == 1 ||
      ((player2_health <= 0.0 && ((float)player_health._pad1._16_4_ < 0.0)))))) {
    render_pass_mode = 0;
    game_state_pending = 7;
    ui_transition_direction = 0;
    (*grim_interface_ptr->vtable->grim_flush_input)(unaff_EBX);
    console_input_poll();
    sfx_mute_all(music_track_extra_0);
    sfx_mute_all(music_track_crimson_theme_id);
    sfx_mute_all(music_track_shortie_monk_id);
    sfx_play_exclusive(music_track_shortie_monk_id);
  }
  frame_dt = fStack_18;
  lVar11 = __ftol();
  frame_dt_ms = (int)lVar11;
  perk_prompt_update_and_render();
  hud_update_and_render();
  iVar5 = 0x3f800000;
  uVar6 = 0x3f800000;
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,1.0,fVar13);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,uVar6);
  (*grim_interface_ptr->vtable->grim_bind_texture)(DAT_0048f7c4,0,iVar5);
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,fVar13);
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,v1);
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,0.7,fVar12);
  (*grim_interface_ptr->vtable->grim_begin_batch)(in_stack_ffffffdc);
  pcVar14 = (char *)0x42540000;
  (*grim_interface_ptr->vtable->grim_draw_quad)
            ((IGrim2D *)0xbf800000,in_stack_00000008 - 16.0,182.0,53.0,h);
  (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_ffffffe4);
  fVar12 = 2.94273e-44;
  fVar13 = 2.8026e-45;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,(uint)pcVar14);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x18,0x3f000000,(uint)fVar12);
  (*grim_interface_ptr->vtable->grim_draw_text_small_fmt)
            (grim_interface_ptr,6.0,unaff_retaddr + 1.0,&DAT_004712bc);
  fStack_10 = 1.0;
  fVar10 = (float10)fsin((float10)_DAT_0047ea4c * (float10)4.0);
  if ((float10)0.0 < fVar10) {
    fStack_10 = 0.4;
  }
  (*grim_interface_ptr->vtable->grim_set_color)((IGrim2D *)0x3f800000,1.0,1.0,fStack_10,fVar13);
  y = &DAT_004712b8;
  pIVar3 = grim_interface_ptr->vtable;
  fStack_8 = (float)(*pIVar3->grim_measure_text_width)
                              ((IGrim2D *)&DAT_004d14a8,(char *)(unaff_retaddr + 1.0));
  (*pIVar3->grim_draw_text_small_fmt)
            (grim_interface_ptr,(float)(int)fStack_8 + 14.0,(float)y,pcVar14);
  highscore_active_record.shots_hit = DAT_004d757c;
  highscore_active_record.shots_fired = DAT_004d7578;
  ui_elements_update_and_render();
  return;
}



/* input_any_key_pressed @ 00446000 */

/* returns true if any key is down (scans keycodes 2..0x17e) */

int input_any_key_pressed(void)

{
  int iVar1;
  int unaff_ESI;
  IGrim2D *self;
  
  self = (IGrim2D *)0x2;
  do {
    iVar1 = (*grim_interface_ptr->vtable->grim_is_key_active)(self,unaff_ESI);
    if ((char)iVar1 != '\0') {
      return CONCAT31((int3)((uint)iVar1 >> 8),1);
    }
    self = (IGrim2D *)((int)&self->vtable + 1);
  } while ((int)self < 0x17f);
  return iVar1;
}



/* input_primary_just_pressed @ 00446030 */

/* edge-detect primary action (mouse button 0 or per-player fire key DAT_00490bec) */

int input_primary_just_pressed(void)

{
  undefined4 in_EAX;
  int iVar1;
  undefined3 uVar3;
  uint uVar2;
  int unaff_EBX;
  int unaff_ESI;
  int *piVar4;
  bool bVar5;
  
  uVar2 = CONCAT31((int3)((uint)in_EAX >> 8),console_open_flag);
  if (console_open_flag == '\0') {
    if (input_primary_latch == '\0') {
      iVar1 = (*grim_interface_ptr->vtable->grim_is_mouse_button_down)((IGrim2D *)0x0,unaff_ESI);
      if ((char)iVar1 != '\0') {
        input_primary_latch = '\x01';
      }
      piVar4 = &player_health.input.fire_key;
      do {
        iVar1 = (*grim_interface_ptr->vtable->grim_is_key_active)((IGrim2D *)*piVar4,unaff_EBX);
        if ((char)iVar1 != '\0') {
          input_primary_latch = '\x01';
        }
        piVar4 = piVar4 + 0xd8;
      } while ((int)piVar4 < 0x4912ac);
      uVar3 = (undefined3)((uint)iVar1 >> 8);
      uVar2 = CONCAT31(uVar3,input_primary_latch);
      if (input_primary_latch != '\0') {
        return CONCAT31(uVar3,1);
      }
    }
    else {
      iVar1 = (*grim_interface_ptr->vtable->grim_is_mouse_button_down)((IGrim2D *)0x0,unaff_ESI);
      bVar5 = (char)iVar1 == '\0';
      piVar4 = &player_health.input.fire_key;
      do {
        uVar2 = (*grim_interface_ptr->vtable->grim_is_key_active)((IGrim2D *)*piVar4,unaff_EBX);
        if ((char)uVar2 != '\0') {
          bVar5 = false;
        }
        piVar4 = piVar4 + 0xd8;
      } while ((int)piVar4 < 0x4912ac);
      if (bVar5) {
        input_primary_latch = '\0';
      }
    }
  }
  return uVar2 & 0xffffff00;
}



/* input_primary_is_down @ 004460f0 */

/* returns true while primary action is held (mouse button 0 or primary fire keys) */

int input_primary_is_down(void)

{
  int iVar1;
  int unaff_retaddr;
  int in_stack_00000004;
  int in_stack_00000008;
  
  iVar1 = (*grim_interface_ptr->vtable->grim_is_mouse_button_down)((IGrim2D *)0x0,unaff_retaddr);
  if ((char)iVar1 == '\0') {
    iVar1 = (*grim_interface_ptr->vtable->grim_is_key_active)
                      ((IGrim2D *)player_health.input.fire_key,in_stack_00000004);
    if ((char)iVar1 == '\0') {
      iVar1 = (*grim_interface_ptr->vtable->grim_is_key_active)
                        (player_alt_fire_key,in_stack_00000008);
      if ((char)iVar1 == '\0') {
        return 0;
      }
    }
  }
  return 1;
}



/* FUN_00446140 @ 00446140 */

void FUN_00446140(void)

{
  return;
}



/* FUN_00446150 @ 00446150 */

int __cdecl FUN_00446150(int param_1)

{
  int iVar1;
  ui_element_t **ppuVar2;
  
  iVar1 = 0;
  ppuVar2 = &ui_element_table_end;
  do {
    if ((ui_element_t *)param_1 == *ppuVar2) {
      return iVar1;
    }
    ppuVar2 = ppuVar2 + 1;
    iVar1 = iVar1 + 1;
  } while ((int)ppuVar2 < 0x48f20c);
  return -1;
}



/* ui_elements_reset_state @ 00446170 */

/* clears active flags and hover timers on all UI elements */

void ui_elements_reset_state(void)

{
  ui_element_t **ppuVar1;
  ui_element_t **ppuVar2;
  
  ppuVar1 = &ui_element_table_end;
  do {
    ppuVar2 = ppuVar1 + 1;
    (*ppuVar1)->active = '\0';
    (*ppuVar1)->counter_value = 0;
    ppuVar1 = ppuVar2;
  } while ((int)ppuVar2 < 0x48f20c);
  return;
}



/* ui_elements_max_timeline @ 00446190 */

/* returns max timeline value (element +0x10) among active UI elements */

int ui_elements_max_timeline(void)

{
  int iVar1;
  int iVar2;
  ui_element_t **ppuVar3;
  
  iVar2 = 0;
  ppuVar3 = &ui_element_table_end;
  do {
    if (((*ppuVar3)->active != '\0') && (iVar1 = *(int *)((*ppuVar3)->_pad0 + 0xe), iVar2 < iVar1))
    {
      iVar2 = iVar1;
    }
    ppuVar3 = ppuVar3 + 1;
  } while ((int)ppuVar3 < 0x48f20c);
  return iVar2;
}



/* game_state_set @ 004461c0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* resets UI state, updates game_state_prev/id, and seeds UI elements for the new state */

void __cdecl game_state_set(int state_id)

{
  bool bVar1;
  int iVar2;
  char *pcVar3;
  ui_element_t *puVar4;
  IGrim2D_vtbl *pIVar5;
  int unaff_ESI;
  IGrim2D *unaff_EDI;
  int iVar6;
  int iVar7;
  int in_stack_0000000c;
  IGrim2D IStack_c;
  IGrim2D aIStack_8 [2];
  
  ui_elements_reset_state();
  iVar6 = 0;
  game_paused_flag = 0;
  game_state_prev = game_state_id;
  game_state_id = state_id;
  _DAT_00487238 = 0;
  DAT_00487241 = 0;
  (*grim_interface_ptr->vtable->grim_flush_input)(unaff_EDI);
  console_input_poll();
  if (state_id == 0) {
    DAT_0048724d = '\0';
    render_pass_mode = '\0';
    ui_sign_crimson = 1;
    iVar2 = game_is_full_version();
    if ((char)iVar2 != '\0') {
      bVar1 = mods_any_available();
      if (bVar1) {
        DAT_00488208 = 1;
      }
    }
    iVar2 = game_is_full_version();
    if ((char)iVar2 == '\0') {
      DAT_00488208 = 1;
    }
    else {
      _DAT_0048823c = &LAB_00447350;
    }
    iVar2 = 2;
    do {
      iVar7 = iVar6;
      if (iVar2 == 2) {
        iVar6 = game_is_full_version();
        if ((char)iVar6 != '\0') {
          iVar7 = 4;
        }
      }
      pcVar3 = (char *)(*grim_interface_ptr->vtable->grim_get_config_var)
                                 (&IStack_c,(uint *)0x64,unaff_ESI);
      if (*pcVar3 == '\0') {
        if (iVar2 == 6) {
          iVar7 = 6;
          in_stack_0000000c = 6;
        }
        (&ui_element_table_end)[iVar2]->counter_id = DAT_0048f7f4;
        puVar4 = (&ui_element_table_end)[iVar2];
        puVar4->_pad4[0x14] = '\0';
        puVar4->_pad4[0x15] = '\0';
        puVar4->_pad4[0x16] = '\0';
        puVar4->_pad4[0x17] = '\0';
        *(float *)(puVar4->_pad4 + 0x18) = (float)in_stack_0000000c * 0.125;
        puVar4 = (&ui_element_table_end)[iVar2];
        puVar4->_pad4[0x30] = '\0';
        puVar4->_pad4[0x31] = '\0';
        puVar4->_pad4[0x32] = 0x80;
        puVar4->_pad4[0x33] = '?';
        *(float *)(puVar4->_pad4 + 0x34) = (float)in_stack_0000000c * 0.125;
        puVar4 = (&ui_element_table_end)[iVar2];
        puVar4->_pad4[0x4c] = '\0';
        puVar4->_pad4[0x4d] = '\0';
        puVar4->_pad4[0x4e] = 0x80;
        puVar4->_pad4[0x4f] = '?';
        pIVar5 = (IGrim2D_vtbl *)((float)(iVar7 + 1) * 0.125);
        *(IGrim2D_vtbl **)(puVar4->_pad4 + 0x50) = pIVar5;
        puVar4 = (&ui_element_table_end)[iVar2];
        puVar4->_pad4[0x68] = '\0';
        puVar4->_pad4[0x69] = '\0';
        puVar4->_pad4[0x6a] = '\0';
        puVar4->_pad4[0x6b] = '\0';
      }
      else {
        (&ui_element_table_end)[iVar2]->counter_id = DAT_0048f7f4;
        puVar4 = (&ui_element_table_end)[iVar2];
        puVar4->_pad4[0x14] = '\0';
        puVar4->_pad4[0x15] = '\0';
        puVar4->_pad4[0x16] = '\0';
        puVar4->_pad4[0x17] = '\0';
        *(float *)(puVar4->_pad4 + 0x18) = (float)in_stack_0000000c * 0.125;
        puVar4 = (&ui_element_table_end)[iVar2];
        puVar4->_pad4[0x30] = '\0';
        puVar4->_pad4[0x31] = '\0';
        puVar4->_pad4[0x32] = 0x80;
        puVar4->_pad4[0x33] = '?';
        *(float *)(puVar4->_pad4 + 0x34) = (float)in_stack_0000000c * 0.125;
        puVar4 = (&ui_element_table_end)[iVar2];
        puVar4->_pad4[0x4c] = '\0';
        puVar4->_pad4[0x4d] = '\0';
        puVar4->_pad4[0x4e] = 0x80;
        puVar4->_pad4[0x4f] = '?';
        pIVar5 = (IGrim2D_vtbl *)((float)(iVar7 + 1) * 0.125);
        *(IGrim2D_vtbl **)(puVar4->_pad4 + 0x50) = pIVar5;
        puVar4 = (&ui_element_table_end)[iVar2];
        puVar4->_pad4[0x68] = '\0';
        puVar4->_pad4[0x69] = '\0';
        puVar4->_pad4[0x6a] = '\0';
        puVar4->_pad4[0x6b] = '\0';
        IStack_c.vtable = pIVar5;
      }
      *(IGrim2D_vtbl **)(puVar4->_pad4 + 0x6c) = pIVar5;
      if (iVar2 == 2) {
        unaff_ESI = 0x44643d;
        iVar6 = game_is_full_version();
        if ((char)iVar6 != '\0') {
          iVar7 = 0;
        }
      }
      iVar6 = iVar7 + 1;
      if (iVar6 == 4) {
        iVar6 = iVar7 + 2;
      }
      iVar2 = iVar2 + 1;
      in_stack_0000000c = iVar6;
    } while (iVar2 < 8);
    iVar6 = game_is_full_version();
    if ((char)iVar6 == '\0') {
      DAT_00488208 = 1;
    }
    DAT_004878c0 = 1;
    DAT_00487bd8 = 1;
    DAT_00487ef0 = 1;
    DAT_00488520 = 1;
    pcVar3 = (char *)(*grim_interface_ptr->vtable->grim_get_config_var)(aIStack_8,(uint *)0x64,100);
    if (*pcVar3 == '\0') {
      DAT_00488520 = 0;
    }
    DAT_00488838 = 1;
  }
  else if (state_id == 0x16) {
    render_pass_mode = '\0';
    ui_sign_crimson_update_disabled = 0;
  }
  else if (state_id == 9) {
    DAT_0048eb38 = 1;
    DAT_0048702c = 0;
    if (render_pass_mode == '\0') {
      DAT_0048724d = '\0';
      gameplay_reset_state();
      iVar2 = _quest_stage_minor;
      iVar6 = _quest_stage_major;
      if (config_blob.reserved0._24_4_ == 3) {
        game_status_blob.quest_play_counts[_quest_stage_minor + _quest_stage_major * 10] =
             game_status_blob.quest_play_counts[_quest_stage_minor + _quest_stage_major * 10] + 1;
        quest_start_selected(iVar6,iVar2);
        render_pass_mode = '\x01';
        DAT_00487241 = 1;
      }
      else if (config_blob.reserved0._24_4_ == 2) {
        render_pass_mode = '\x01';
        game_status_blob.mode_play_rush = game_status_blob.mode_play_rush + 1;
        DAT_00487241 = 1;
      }
      else if (config_blob.reserved0._24_4_ == 1) {
        render_pass_mode = '\x01';
        game_status_blob.mode_play_survival = game_status_blob.mode_play_survival + 1;
        DAT_00487241 = 1;
      }
      else if (config_blob.reserved0._24_4_ == 4) {
        render_pass_mode = '\x01';
        game_status_blob.mode_play_typo = game_status_blob.mode_play_typo + 1;
        DAT_00487241 = 1;
      }
      else {
        render_pass_mode = '\x01';
        game_status_blob.mode_play_other = game_status_blob.mode_play_other + 1;
        DAT_00487241 = 1;
      }
    }
  }
  else if (state_id == 0x12) {
    config_blob.reserved0[0x14] = '\x01';
    config_blob.reserved0[0x15] = '\0';
    config_blob.reserved0[0x16] = '\0';
    config_blob.reserved0[0x17] = '\0';
    DAT_00478c94 = 1;
    DAT_0048eb38 = 1;
    DAT_0048702c = 0;
    if (render_pass_mode == '\0') {
      DAT_0048724d = '\0';
      gameplay_reset_state();
      render_pass_mode = '\x01';
      DAT_00487241 = 1;
    }
  }
  else if (state_id == 1) {
    ui_sign_crimson = 1;
    DAT_00489498 = 1;
    DAT_004897b0 = 1;
  }
  else if (state_id == 2) {
    if (DAT_004824d1 == '\0') {
      ui_sign_crimson = 1;
    }
    DAT_00488b50 = 1;
    _DAT_0048cf78 = 0xc2680000;
    DAT_00488e68 = 1;
    DAT_00487234 = 0;
    _DAT_0048cf7c = (((float)config_blob.screen_width * 0.0015625 * 150.0 + 10.0) - 150.0) + 135.0;
  }
  else if (state_id == 4) {
    DAT_0048724d = '\0';
    ui_sign_crimson = 1;
    DAT_0048e820 = 1;
    _DAT_0048e858 = &LAB_0043f550;
  }
  else if (state_id == 0xd) {
    _DAT_00489e18 = FUN_00446140;
LAB_00446764:
    DAT_00489de0._0_1_ = 1;
    ui_sign_crimson = 1;
    highscore_load_table();
  }
  else if (state_id == 3) {
    ui_sign_crimson = 1;
    _DAT_0048cf78 = 0xc3340000;
    DAT_0048d278 = 1;
    DAT_0048d590 = 1;
    DAT_0048ee50._0_1_ = 1;
    _DAT_0048cf7c = ((float)config_blob.screen_width * 0.0015625 * 150.0 - 150.0) + 139.0;
  }
  else if (state_id == 0xe) {
    DAT_0048a0f8 = 1;
    _DAT_00489e18 = (code *)&LAB_004423d0;
    goto LAB_00446764;
  }
  _DAT_0048a130 = 0;
  if (state_id == 0x13) {
    ui_sign_crimson = 1;
    DAT_00489de0._0_1_ = 1;
  }
  else if (state_id == 0x1a) {
    ui_sign_crimson = 1;
    DAT_00489de0._0_1_ = 1;
    _DAT_00489e18 = credits_secret_alien_zookeeper_update;
  }
  else if (state_id == 0x14) {
    ui_sign_crimson = 1;
    DAT_00489de0._0_1_ = 1;
    _DAT_00489e18 = (code *)&LAB_0040e9a0;
  }
  else if (state_id == 0xf) {
    ui_sign_crimson = 1;
    DAT_00489de0._0_1_ = 1;
    DAT_0048a0f8 = 1;
    _DAT_00489e18 = (code *)&LAB_00440110;
  }
  else if (state_id == 0x10) {
    ui_sign_crimson = 1;
    DAT_00489de0._0_1_ = 1;
    DAT_0048a0f8 = 1;
    _DAT_00489e18 = (code *)&LAB_00440960;
  }
  else if (state_id == 0x11) {
    DAT_00487234 = 0;
    ui_sign_crimson = 1;
    DAT_00489de0._0_1_ = 1;
    _DAT_00489e18 = credits_screen_update;
  }
  else if (state_id == 0xb) {
    ui_sign_crimson = 1;
    DAT_0048e1f0 = 1;
  }
  else if (state_id == 5) {
    if (DAT_004824d1 == '\0') {
      ui_sign_crimson = 1;
    }
    ui_sign_crimson_update_disabled = 0;
    DAT_0048b9b8 = 1;
    DAT_0048bcd0 = 1;
    DAT_0048bfe8 = 1;
  }
  else if (state_id == 6) {
    DAT_0048c618 = 1;
  }
  else if (state_id == 8) {
    DAT_0048dbc0 = 1;
    game_save_status();
    DAT_00487234 = 0xfffffffe;
  }
  else {
    if (state_id == 0x15) {
      DAT_0048dbc0 = 1;
    }
    else if (state_id == 0xc) {
      DAT_0048dbc0 = 1;
    }
    else {
      if (state_id != 7) goto LAB_004468da;
      DAT_0048cc48 = 1;
      _DAT_00487260 = 0;
    }
    DAT_00487234 = 0xffffffff;
  }
LAB_004468da:
  if (DAT_0048724d != '\0') {
    ui_sign_crimson = 0;
  }
  ui_elements_timeline = 0;
  ui_transition_direction = 1;
  return;
}



/* ui_element_update @ 00446900 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* updates hover/click/animation for a UI element and fires callbacks */

void __cdecl ui_element_update(ui_element_t *element)

{
  uchar uVar1;
  ui_element_t *puVar2;
  int iVar3;
  float fVar4;
  float fVar5;
  ui_element_t *puVar6;
  int iVar7;
  int iVar8;
  ui_element_t **ppuVar9;
  float10 fVar10;
  float10 fVar11;
  
  puVar6 = element;
  if ((element->_pad0[0] == '\0') && (element->active != '\0')) {
    if (((ui_mouse_x <= *(float *)element->_pad1) ||
        (((ui_mouse_y <= *(float *)(element->_pad1 + 4) ||
          (*(float *)(element->_pad1 + 8) <= ui_mouse_x)) ||
         (*(float *)(element->_pad1 + 0xc) <= ui_mouse_y)))) ||
       ((ui_mouse_blocked != '\0' || (DAT_004871ca != '\0')))) {
      element->_pad5[0xec] = '\0';
    }
    else {
      uVar1 = element->enabled;
      element->_pad5[0xec] = '\x01';
      if ((uVar1 != '\0') && (element->on_activate != (_func_1 *)0x0)) {
        _DAT_0048723c = element;
        _DAT_00487238 = 0;
        ppuVar9 = &ui_element_table_end;
        do {
          puVar2 = *ppuVar9;
          if ((puVar2->enabled != '\0') &&
             ((game_state_id != 0 || (puVar2->on_activate != (_func_1 *)0x0)))) {
            if (element == puVar2) break;
            _DAT_00487238 = _DAT_00487238 + 1;
          }
          ppuVar9 = ppuVar9 + 1;
        } while ((int)ppuVar9 < 0x48f20c);
      }
    }
    element->counter_timer = element->counter_timer + frame_dt_ms;
    uVar1 = element->_pad5[0xec];
    if (uVar1 == '\0') {
      element->counter_value = element->counter_value + frame_dt_ms * -2;
    }
    else {
      element->counter_value = element->counter_value + frame_dt_ms * 6;
    }
    if (element->counter_value < 0) {
      element->counter_value = 0;
    }
    if (1000 < element->counter_value) {
      element->counter_value = 1000;
    }
    if ((((element->on_activate != (_func_1 *)0x0) && (0xfe < element->counter_timer)) &&
        (uVar1 != '\0')) && (iVar7 = input_primary_just_pressed(), (char)iVar7 != '\0')) {
      sfx_play(sfx_ui_buttonclick);
      (*element->on_activate)();
    }
    iVar7 = *(int *)(element->_pad0 + 0xe);
    if (ui_elements_timeline < iVar7) {
      iVar3 = *(int *)(element->_pad0 + 0x12);
      if (ui_elements_timeline < iVar3) {
        uVar1 = element[1].active;
        element = (ui_element_t *)0x3fc90fdb;
        fVar4 = puVar6->quad0[0] - puVar6->quad0[7];
        puVar6->_pad0[10] = '\0';
        puVar6->_pad0[0xb] = '\0';
        puVar6->_pad0[0xc] = '\0';
        puVar6->_pad0[0xd] = '\0';
        if (uVar1 == '\0') {
          *(float *)(puVar6->_pad0 + 6) = -ABS(fVar4);
        }
        else {
          *(float *)(puVar6->_pad0 + 6) = ABS(fVar4);
        }
      }
      else {
        iVar8 = ui_elements_timeline - iVar3;
        puVar6->_pad0[10] = '\0';
        puVar6->_pad0[0xb] = '\0';
        puVar6->_pad0[0xc] = '\0';
        puVar6->_pad0[0xd] = '\0';
        fVar5 = (float)(iVar7 - iVar3);
        puVar2 = (ui_element_t *)(1.5707964 - ((float)iVar8 * 1.5707964) / fVar5);
        fVar4 = element->quad0[0] - element->quad0[7];
        if (element[1].active == '\0') {
          *(float *)(element->_pad0 + 6) =
               -((1.0 - ((float)ui_elements_timeline - (float)iVar3) / fVar5) * ABS(fVar4));
          element = puVar2;
        }
        else {
          *(float *)(element->_pad0 + 6) =
               (1.0 - ((float)ui_elements_timeline - (float)iVar3) / fVar5) * ABS(fVar4);
          element = puVar2;
        }
      }
    }
    else {
      if (element->enabled == '\0') {
        sfx_play(sfx_ui_panelclick);
        element->enabled = '\x01';
      }
      if (element->counter_timer < 0x100) {
        element->counter_timer = element->counter_timer + frame_dt_ms;
      }
      puVar6->_pad0[6] = '\0';
      puVar6->_pad0[7] = '\0';
      puVar6->_pad0[8] = '\0';
      puVar6->_pad0[9] = '\0';
      element = (ui_element_t *)0x0;
      puVar6->_pad0[10] = '\0';
      puVar6->_pad0[0xb] = '\0';
      puVar6->_pad0[0xc] = '\0';
      puVar6->_pad0[0xd] = '\0';
    }
    iVar7 = FUN_00446150((int)puVar6);
    if (iVar7 == 0) {
      element = (ui_element_t *)-ABS((float)element);
    }
    if ((ui_elements_timeline < *(int *)(puVar6->_pad0 + 0xe)) && (puVar6->enabled != '\0')) {
      puVar6->enabled = '\0';
    }
    fVar10 = (float10)fcos((float10)(float)element);
    puVar6->rot_m00 = (float)fVar10;
    fVar11 = (float10)fsin((float10)(float)element);
    puVar6->rot_m01 = (float)-fVar11;
    puVar6->rot_m10 = (float)fVar11;
    puVar6->rot_m11 = (float)fVar10;
  }
  return;
}



/* ui_element_render @ 00446c40 */

/* updates focus/click handling and renders a UI element */

void __cdecl ui_element_render(ui_element_t *element)

{
  float *offset;
  int iVar1;
  uchar *puVar2;
  char cVar3;
  IGrim2D *unaff_EBX;
  float *unaff_ESI;
  float *unaff_EDI;
  int iVar4;
  IGrim2D *self;
  uint uVar5;
  IGrim2D *self_00;
  float *pfVar6;
  uint value;
  uint in_stack_ffffffc8;
  float *pfVar7;
  float in_stack_ffffffcc;
  float *self_01;
  uchar *in_stack_ffffffd0;
  float *in_stack_ffffffe0;
  IGrim2D *in_stack_ffffffe4;
  float fStack_14;
  float fStack_10;
  float fStack_c;
  float fStack_8;
  float fStack_4;
  
  cVar3 = '\0';
  if (element->active == '\0') {
    return;
  }
  if ((element->render_scale == 0.0) && (*(float *)((int)cv_uiPointFilterPanels + 0xc) != 0.0)) {
    (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,1,in_stack_ffffffc8);
  }
  if ((element->on_activate != (_func_1 *)0x0) && (element != (ui_element_t *)&DAT_0048f20c)) {
    iVar1 = ui_focus_update((int)element);
    cVar3 = (char)iVar1;
    if (((cVar3 != '\0') &&
        (((iVar1 = (*grim_interface_ptr->vtable->grim_was_key_pressed)
                             ((IGrim2D *)0x1c,(uint)in_stack_ffffffcc), (char)iVar1 != '\0' &&
          (console_open_flag == '\0')) && (element->enabled != '\0')))) &&
       (element->on_activate != (_func_1 *)0x0)) {
      in_stack_ffffffcc = 6.283867e-39;
      (*element->on_activate)();
    }
  }
  (*grim_interface_ptr->vtable->grim_set_uv)((IGrim2D *)0x0,0.0,1.0,1.0,in_stack_ffffffcc);
  self_01 = (float *)0x0;
  pfVar7 = (float *)0x446d09;
  (*grim_interface_ptr->vtable->grim_set_rotation)((IGrim2D *)0x0,(float)in_stack_ffffffd0);
  if (element->counter_id != -1) {
    if ((cVar3 != '\0') && (0 < DAT_004d11ec)) {
      element->counter_value = DAT_004d11ec;
    }
    if (element->on_activate == (_func_1 *)0x0) {
      puVar2 = element->_pad4 + 0x13;
      iVar1 = 4;
      do {
        *puVar2 = 200;
        puVar2 = puVar2 + 0x1c;
        iVar1 = iVar1 + -1;
      } while (iVar1 != 0);
    }
    else {
      iVar1 = 4;
      puVar2 = element->_pad4 + 0x13;
      do {
        iVar4 = element->counter_value * 0x9b;
        iVar1 = iVar1 + -1;
        *puVar2 = (((char)(iVar4 / 1000) + (char)(iVar4 >> 0x1f)) -
                  (char)((longlong)iVar4 * 0x10624dd3 >> 0x3f)) + 'd';
        puVar2 = puVar2 + 0x1c;
      } while (iVar1 != 0);
    }
  }
  uVar5 = 0x13;
  pfVar6 = (float *)0x5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)pfVar7);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,uVar5);
  self = (IGrim2D *)element->texture_handle;
  if (self != (IGrim2D *)0xffffffff) {
    self_00 = (IGrim2D *)0x0;
    (*grim_interface_ptr->vtable->grim_bind_texture)(self,0,(int)pfVar6);
    fStack_8 = 785.06665;
    if (*(int *)(element->_pad0 + 2) == 0) {
      if (config_blob.reserved0[0xe] != '\0') {
        (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,1,(uint)self);
        (*grim_interface_ptr->vtable->grim_begin_batch)(self_00);
        in_stack_ffffffd0 = (uchar *)(element->pos_x + 7.0);
        offset = &element->rot_m00;
        unaff_EDI = (float *)(element->pos_y + 7.0);
        (*grim_interface_ptr->vtable->grim_submit_vertices_transform_color)
                  ((IGrim2D *)element->quad0,(float *)0x4,(int)&stack0xffffffd0,offset,&fStack_c,
                   pfVar6);
        if (element->quad_mode == 8) {
          unaff_EDI = (float *)(element->pos_x + 7.0);
          (*grim_interface_ptr->vtable->grim_submit_vertices_transform_color)
                    ((IGrim2D *)element->quad1,(float *)0x4,(int)&stack0xffffffd4,offset,&fStack_8,
                     pfVar7);
          unaff_ESI = (float *)(element->pos_x + 7.0);
          pfVar7 = &fStack_4;
          unaff_EBX = (IGrim2D *)(element->pos_y + 7.0);
          (*grim_interface_ptr->vtable->grim_submit_vertices_transform_color)
                    ((IGrim2D *)element->quad2,(float *)0x4,(int)&stack0xffffffd8,offset,pfVar7,
                     self_01);
        }
        self_01 = (float *)0x446edb;
        (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)in_stack_ffffffd0);
      }
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)pfVar7);
      (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)self_01);
      pfVar6 = &element->rot_m00;
      pfVar7 = &element->pos_x;
      self_01 = pfVar6;
      (*grim_interface_ptr->vtable->grim_submit_vertices_transform)
                ((IGrim2D *)element->quad0,(float *)0x4,(int)pfVar7,pfVar6,
                 (float *)in_stack_ffffffd0);
      if (element->quad_mode == 8) {
        (*grim_interface_ptr->vtable->grim_submit_vertices_transform)
                  ((IGrim2D *)element->quad1,(float *)0x4,(int)pfVar7,pfVar6,unaff_EDI);
        self_01 = (float *)0x4;
        (*grim_interface_ptr->vtable->grim_submit_vertices_transform)
                  ((IGrim2D *)element->quad2,(float *)0x4,(int)pfVar7,pfVar6,unaff_ESI);
        unaff_EDI = pfVar6;
      }
    }
    else {
      if (*(int *)(element->_pad0 + 2) != 1) goto LAB_00447154;
      if (config_blob.reserved0[0xe] != '\0') {
        (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,1,(uint)self);
        (*grim_interface_ptr->vtable->grim_begin_batch)(self_00);
        in_stack_ffffffd0 = (uchar *)(element->pos_x + 7.0 + *(float *)(element->_pad0 + 6));
        unaff_EDI = (float *)(element->pos_y + 7.0 + *(float *)(element->_pad0 + 10));
        (*grim_interface_ptr->vtable->grim_submit_vertices_offset_color)
                  ((IGrim2D *)element->quad0,(float *)0x4,(int)&stack0xffffffd0,&fStack_c,pfVar6);
        if (element->quad_mode == 8) {
          unaff_EDI = (float *)(element->pos_x + 7.0 + *(float *)(element->_pad0 + 6));
          (*grim_interface_ptr->vtable->grim_submit_vertices_offset_color)
                    ((IGrim2D *)element->quad1,(float *)0x4,(int)&stack0xffffffd4,&fStack_8,pfVar7);
          in_stack_ffffffe4 = (IGrim2D *)(element->pos_y + 7.0);
          pfVar7 = &fStack_4;
          unaff_ESI = (float *)(element->pos_x + 7.0 + *(float *)(element->_pad0 + 6));
          (*grim_interface_ptr->vtable->grim_submit_vertices_offset_color)
                    ((IGrim2D *)element->quad2,(float *)0x4,(int)&stack0xffffffd8,pfVar7,self_01);
        }
        self_01 = (float *)0x44708d;
        (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)in_stack_ffffffd0);
      }
      (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)pfVar7);
      (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)self_01);
      unaff_EBX = (IGrim2D *)(*(float *)(element->_pad0 + 6) + element->pos_x);
      self_01 = (float *)&stack0xffffffdc;
      in_stack_ffffffe0 = (float *)(*(float *)(element->_pad0 + 10) + element->pos_y);
      (*grim_interface_ptr->vtable->grim_submit_vertices_offset)
                ((IGrim2D *)element->quad0,(float *)0x4,(int)self_01,(float *)in_stack_ffffffd0);
      if (element->quad_mode == 8) {
        in_stack_ffffffe0 = (float *)(*(float *)(element->_pad0 + 6) + element->pos_x);
        (*grim_interface_ptr->vtable->grim_submit_vertices_offset)
                  ((IGrim2D *)element->quad1,(float *)0x4,(int)&stack0xffffffe0,unaff_EDI);
        in_stack_ffffffe4 = (IGrim2D *)(*(float *)(element->_pad0 + 6) + element->pos_x);
        unaff_EDI = (float *)&stack0xffffffe4;
        self_01 = element->quad2;
        (*grim_interface_ptr->vtable->grim_submit_vertices_offset)
                  ((IGrim2D *)self_01,(float *)0x4,(int)unaff_EDI,unaff_ESI);
      }
    }
    in_stack_ffffffd0 = (uchar *)0x447154;
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)unaff_EDI);
  }
LAB_00447154:
  if ((IGrim2D *)element->counter_id != (IGrim2D *)0xffffffff) {
    self_01 = (float *)0x447174;
    (*grim_interface_ptr->vtable->grim_bind_texture)
              ((IGrim2D *)element->counter_id,0,(int)unaff_ESI);
    (*grim_interface_ptr->vtable->grim_begin_batch)(unaff_EBX);
    if (*(int *)(element->_pad0 + 2) == 0) {
      in_stack_ffffffd0 = element->_pad4;
      unaff_EDI = (float *)0x4;
      self_01 = (float *)0x4471ab;
      (*grim_interface_ptr->vtable->grim_submit_vertices_transform)
                ((IGrim2D *)in_stack_ffffffd0,(float *)0x4,(int)&element->pos_x,&element->rot_m00,
                 in_stack_ffffffe0);
    }
    else {
      fStack_14 = *(float *)(element->_pad0 + 6) + element->pos_x;
      unaff_EDI = (float *)element->_pad4;
      fStack_10 = *(float *)(element->_pad0 + 10) + element->pos_y;
      in_stack_ffffffd0 = (uchar *)0x4471dd;
      (*grim_interface_ptr->vtable->grim_submit_vertices_offset)
                ((IGrim2D *)unaff_EDI,(float *)0x4,(int)&fStack_14,in_stack_ffffffe0);
    }
    (*grim_interface_ptr->vtable->grim_end_batch)(in_stack_ffffffe4);
  }
  uVar5 = 0x13;
  iVar1 = 5;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)self_01);
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,2,uVar5);
  if ((-1 < element->counter_timer) && (element->counter_timer < 0x100)) {
    iVar4 = 4;
    puVar2 = element->_pad5 + 0x17;
    do {
      puVar2[-0xe8] = 0xff - (char)(element->counter_timer / 2);
      iVar4 = iVar4 + -1;
      *puVar2 = 0xff - (char)(element->counter_timer / 2);
      puVar2 = puVar2 + 0x1c;
    } while (iVar4 != 0);
  }
  fStack_14 = element->rot_m10;
  fStack_10 = element->rot_m11;
  if (((element->enabled != '\0') && ((IGrim2D *)element->counter_id != (IGrim2D *)0xffffffff)) &&
     (element->on_activate != (_func_1 *)0x0)) {
    (*grim_interface_ptr->vtable->grim_bind_texture)((IGrim2D *)element->counter_id,0,iVar1);
    (*grim_interface_ptr->vtable->grim_begin_batch)((IGrim2D *)self_01);
    self_01 = &fStack_14;
    (*grim_interface_ptr->vtable->grim_submit_vertices_transform)
              ((IGrim2D *)element->_pad4,(float *)0x4,(int)&element->pos_x,self_01,
               (float *)in_stack_ffffffd0);
    (*grim_interface_ptr->vtable->grim_end_batch)((IGrim2D *)unaff_EDI);
  }
  value = 0x13;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x13,5,(uint)self_01);
  uVar5 = 0x14;
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x14,6,value);
  if (*(code **)element->_pad2 != (code *)0x0) {
    (**(code **)element->_pad2)();
  }
  (*grim_interface_ptr->vtable->grim_set_config_var)((IGrim2D *)0x15,2,uVar5);
  return;
}



/* ui_menu_main_click_options @ 00447370 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* main menu OPTIONS click callback (sets ui_transition_direction=0 and game_state_pending=2) */

void ui_menu_main_click_options(void)

{
  ui_transition_direction = 0;
  game_state_pending = 2;
  return;
}



/* FUN_004473e0 @ 004473e0 */

/* [binja] int32_t sub_4473e0() */

int FUN_004473e0(void)

{
  int in_EAX;
  
  ui_transition_direction = 0;
  game_state_pending = 3;
  return in_EAX;
}



/* ui_menu_main_click_play_game @ 00447400 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* main menu PLAY GAME click callback (sets ui_transition_direction=0 and game_state_pending=1) */

void ui_menu_main_click_play_game(void)

{
  ui_transition_direction = 0;
  game_state_pending = 1;
  return;
}



/* FUN_00447420 @ 00447420 */

/* [binja] int32_t sub_447420() */

int FUN_00447420(void)

{
  undefined4 in_EAX;
  
  ui_transition_direction = 0;
  if (DAT_004824d1 != '\0') {
    game_state_pending = 5;
    return CONCAT31((int3)((uint)in_EAX >> 8),DAT_004824d1);
  }
  game_state_pending = -(uint)(render_pass_mode != '\0') & 5;
  return game_state_pending;
}



/* ui_menu_main_click_quit @ 00447450 */

/* WARNING: Unknown calling convention -- yet parameter storage is locked */
/* main menu QUIT click callback (clears ui_sign_crimson_update_disabled, sets
   ui_transition_direction=0, game_state_pending=10, mutes music) */

void ui_menu_main_click_quit(void)

{
  game_state_pending = 10;
  ui_sign_crimson_update_disabled = 0;
  ui_transition_direction = 0;
  sfx_mute_all(music_track_crimson_theme_id);
  sfx_mute_all(music_track_extra_0);
  sfx_mute_all(music_track_shortie_monk_id);
  return;
}



/* config_apply_detail_preset @ 00447580 */

/* Applies config_detail_preset ("Graphics detail" 1..5) to the config_fx_detail_flag0/1/2 bytes. */

void config_apply_detail_preset(void)

{
  switch(config_blob.detail_preset) {
  case 1:
    config_blob.reserved0[0x11] = '\0';
  case 2:
    config_blob.reserved0[0xe] = '\0';
    config_blob.reserved0[0x10] = '\0';
    return;
  case 3:
  case 4:
  case 5:
    config_blob.reserved0[0x10] = '\x01';
    config_blob.reserved0[0x11] = '\x01';
    config_blob.reserved0[0xe] = '\x01';
  default:
    return;
  }
}



/* FUN_00447c90 @ 00447c90 */

/* [binja] int32_t sub_447c90(int32_t arg1) */

int __cdecl FUN_00447c90(int arg1)

{
  switch(arg1) {
  case 0:
    return 0x478f10;
  case 1:
    return 0x478ef4;
  case 2:
    return 0x478ee8;
  case 3:
    return 0x478f00;
  case 4:
    return 0x478ed8;
  case 5:
    return 0x478ecc;
  default:
    return 0x4714a0;
  }
}



/* input_scheme_label @ 00447cf0 */

/* maps control scheme ids to labels (Relative/Static/Dual Action Pad/etc) */

char * __cdecl input_scheme_label(int scheme)

{
  switch(scheme) {
  case 1:
    return s_Relative_00478f34;
  case 2:
    return s_Static_00478f2c;
  case 3:
    return s_Dual_Action_Pad_00478ed8;
  case 4:
    return s_Mouse_point_click_00478f18;
  case 5:
    return s_Computer_00478ecc;
  default:
    return s_Unknown_004714a0;
  }
}



/* FUN_00448b50 @ 00448b50 */

undefined4 __fastcall FUN_00448b50(int param_1)

{
  float10 extraout_ST0;
  float10 extraout_ST0_00;
  float10 extraout_ST0_01;
  float10 extraout_ST0_02;
  float10 extraout_ST0_03;
  float10 extraout_ST0_04;
  
  (*grim_interface_ptr->vtable->grim_get_config_float)((IGrim2D *)0x13f,param_1);
  if (0.5 < ABS((float)extraout_ST0)) {
    return 0x13f;
  }
  (*grim_interface_ptr->vtable->grim_get_config_float)
            ((IGrim2D *)0x140,(int)ABS((float)extraout_ST0));
  if (0.5 < ABS((float)extraout_ST0_00)) {
    return 0x140;
  }
  (*grim_interface_ptr->vtable->grim_get_config_float)
            ((IGrim2D *)0x141,(int)ABS((float)extraout_ST0_00));
  if (0.5 < ABS((float)extraout_ST0_01)) {
    return 0x141;
  }
  (*grim_interface_ptr->vtable->grim_get_config_float)
            ((IGrim2D *)0x153,(int)ABS((float)extraout_ST0_01));
  if (0.5 < ABS((float)extraout_ST0_02)) {
    return 0x153;
  }
  (*grim_interface_ptr->vtable->grim_get_config_float)
            ((IGrim2D *)0x154,(int)ABS((float)extraout_ST0_02));
  if (0.5 < ABS((float)extraout_ST0_03)) {
    return 0x154;
  }
  (*grim_interface_ptr->vtable->grim_get_config_float)
            ((IGrim2D *)0x155,(int)ABS((float)extraout_ST0_03));
  if (0.5 < ABS((float)extraout_ST0_04)) {
    return 0x155;
  }
  (*grim_interface_ptr->vtable->grim_flush_input)((IGrim2D *)ABS((float)extraout_ST0_04));
  return 0;
}



/* FUN_0044ecf0 @ 0044ecf0 */

/* [binja] float* __thiscall sub_44ecf0(float* arg1, float* arg2, float* arg3) */

float * __thiscall FUN_0044ecf0(void *this,float *arg1,float *arg2,float *arg3)

{
  float fVar1;
  float fVar2;
  
  fVar1 = arg2[1];
  fVar2 = *(float *)((int)this + 4);
  *arg1 = *arg2 + *(float *)this;
  arg1[1] = fVar1 + fVar2;
  return arg1;
}



/* FUN_0044faa0 @ 0044faa0 */

/* [binja] char* sub_44faa0(char* arg1) */

char * __cdecl FUN_0044faa0(char *arg1)

{
  char cVar1;
  undefined3 extraout_var;
  
  if (arg1 == (char *)0x0) {
    cVar1 = console_printf(&console_log_queue,s_____Elem____NULL__0047928c);
    return (char *)CONCAT31(extraout_var,cVar1);
  }
  arg1[0x11c] = -1;
  arg1[0x11d] = -1;
  arg1[0x11e] = -1;
  arg1[0x11f] = -1;
  arg1[0x204] = -1;
  arg1[0x205] = -1;
  arg1[0x206] = -1;
  arg1[0x207] = -1;
  arg1[0x2ec] = -1;
  arg1[0x2ed] = -1;
  arg1[0x2ee] = -1;
  arg1[0x2ef] = -1;
  arg1[0x20] = '\0';
  arg1[0x21] = '\0';
  arg1[0x22] = 'i';
  arg1[0x23] = 'C';
  arg1[0x24] = '\0';
  arg1[0x25] = '\0';
  arg1[0x26] = -0x20;
  arg1[0x27] = 'A';
  arg1[0x28] = '\0';
  arg1[0x29] = -0x80;
  arg1[0x2a] = -0x29;
  arg1[0x2b] = 'C';
  arg1[0x2fc] = '\0';
  arg1[0x2fd] = '\x01';
  arg1[0x2fe] = '\0';
  arg1[0x2ff] = '\0';
  arg1[0x34] = '\0';
  arg1[0x35] = '\0';
  arg1[0x36] = '\0';
  arg1[0x37] = '\0';
  arg1[0x38] = '\0';
  arg1[0x39] = '\0';
  arg1[0x3a] = '\0';
  arg1[0x3b] = '\0';
  arg1[0x2c] = '\0';
  arg1[0x2d] = '\0';
  arg1[0x2e] = -0x78;
  arg1[0x2f] = 'B';
  arg1[0x300] = '\0';
  arg1[0x301] = '\0';
  arg1[0x302] = '\0';
  arg1[0x303] = '\0';
  *arg1 = '\0';
  arg1[0x30] = '9';
  arg1[0x31] = '\0';
  arg1[0x32] = '\0';
  arg1[0x33] = '\0';
  arg1[0x2f4] = '\0';
  arg1[0x10] = ',';
  arg1[0x11] = '\x01';
  arg1[0x12] = '\0';
  arg1[0x13] = '\0';
  arg1[0x14] = '\0';
  arg1[0x15] = '\0';
  arg1[0x16] = '\0';
  arg1[0x17] = '\0';
  arg1[2] = '\0';
  arg1[4] = '\0';
  arg1[5] = '\0';
  arg1[6] = '\0';
  arg1[7] = '\0';
  return arg1;
}



/* FUN_0044fb50 @ 0044fb50 */

/* [binja] float sub_44fb50(float arg1) */

float __cdecl FUN_0044fb50(float arg1)

{
  undefined4 uVar1;
  float fVar2;
  float fVar3;
  undefined4 *puVar4;
  int iVar5;
  float10 in_ST0;
  
  if (((undefined *)arg1 != &DAT_0048c300) && ((undefined *)arg1 != &DAT_0048c618)) {
    *(float *)((int)arg1 + 0x20) =
         *(float *)((int)arg1 + 0x3c) + *(float *)((int)arg1 + 0x18) + *(float *)((int)arg1 + 0x20);
    *(float *)((int)arg1 + 0x24) =
         *(float *)((int)arg1 + 0x40) + *(float *)((int)arg1 + 0x1c) + *(float *)((int)arg1 + 0x24);
    *(float *)((int)arg1 + 0x28) =
         *(float *)((int)arg1 + 0x3c) + *(float *)((int)arg1 + 0x18) + *(float *)((int)arg1 + 0x28);
    *(float *)((int)arg1 + 0x2c) =
         *(float *)((int)arg1 + 0x40) + *(float *)((int)arg1 + 0x1c) + *(float *)((int)arg1 + 0x2c);
    *(float *)((int)arg1 + 0x20) = *(float *)((int)arg1 + 0x3c) + *(float *)((int)arg1 + 0x18);
    fVar2 = *(float *)((int)arg1 + 0x74) - *(float *)((int)arg1 + 0x3c);
    *(float *)((int)arg1 + 0x24) = *(float *)((int)arg1 + 0x40) + *(float *)((int)arg1 + 0x1c);
    *(float *)((int)arg1 + 0x20) = fVar2 * 0.54 + *(float *)((int)arg1 + 0x20);
    fVar3 = *(float *)((int)arg1 + 0x78) - *(float *)((int)arg1 + 0x40);
    *(float *)((int)arg1 + 0x24) = fVar3 * 0.28 + *(float *)((int)arg1 + 0x24);
    *(float *)((int)arg1 + 0x28) = *(float *)((int)arg1 + 0x74) + *(float *)((int)arg1 + 0x18);
    *(float *)((int)arg1 + 0x2c) = *(float *)((int)arg1 + 0x78) + *(float *)((int)arg1 + 0x1c);
    *(float *)((int)arg1 + 0x28) = *(float *)((int)arg1 + 0x28) - fVar2 * 0.05;
    *(float *)((int)arg1 + 0x2c) = *(float *)((int)arg1 + 0x2c) - fVar3 * 0.1;
    if ((*(char *)((int)arg1 + 0x314) != '\0') && (iVar5 = 0, 0 < *(int *)((int)arg1 + 0x120))) {
      puVar4 = (undefined4 *)((int)arg1 + 0x6c);
      do {
        uVar1 = puVar4[-7];
        iVar5 = iVar5 + 2;
        puVar4[-7] = *puVar4;
        *puVar4 = uVar1;
        puVar4 = puVar4 + 0xe;
      } while (iVar5 < *(int *)((int)arg1 + 0x120));
    }
  }
  return (float)in_ST0;
}



/* ui_menu_layout_init @ 0044fcb0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* initializes menu UI element layout and text textures */

void ui_menu_layout_init(void)

{
  uchar *puVar1;
  undefined *puVar2;
  char *pcVar3;
  ui_element_t *puVar4;
  undefined **ppuVar5;
  float *pfVar6;
  int iVar7;
  float *pfVar8;
  int iVar9;
  int iVar10;
  char *unaff_EBX;
  int unaff_EBP;
  ui_element_t **ppuVar11;
  undefined4 *puVar12;
  int unaff_EDI;
  float fVar13;
  float fVar14;
  undefined4 *puVar15;
  char *pcVar16;
  float fStack_5c;
  int iStack_54;
  IGrim2D local_20;
  IGrim2D IStack_1c;
  float fStack_18;
  float fStack_14;
  float fStack_10;
  IGrim2D aIStack_8 [2];
  
  screen_fade_alpha = 0;
  _DAT_00487288 = (float)config_blob.screen_width * 0.0015625;
  _DAT_0048723c = 0;
  DAT_0048702c = 0;
  _DAT_0048728c = (float)config_blob.screen_height * 0.0020833334;
  ppuVar11 = &ui_element_table_end;
  for (iVar9 = 0x29; iVar9 != 0; iVar9 = iVar9 + -1) {
    *ppuVar11 = (ui_element_t *)0x0;
    ppuVar11 = ppuVar11 + 1;
  }
  ui_element_table_end = (ui_element_t *)&ui_sign_crimson;
  DAT_0048f16c = &DAT_004875a8;
  DAT_0048f170 = &DAT_00488208;
  _DAT_0048f174 = &DAT_004878c0;
  _DAT_0048f178 = &DAT_00487bd8;
  _DAT_0048f17c = &DAT_00487ef0;
  pcVar3 = (char *)(*grim_interface_ptr->vtable->grim_get_config_var)
                             (&local_20,(uint *)0x64,unaff_EDI);
  if (*pcVar3 == '\0') {
    _DAT_0048f184 = &DAT_00488520;
    _DAT_0048f180 = &DAT_00488838;
  }
  else {
    _DAT_0048f180 = &DAT_00488520;
    _DAT_0048f184 = &DAT_00488838;
  }
  _DAT_0048f1e4 = &DAT_00488b50;
  DAT_0048f1e8 = &DAT_00488e68;
  _DAT_0048f190 = &DAT_00489180;
  _DAT_0048f194 = &DAT_00489498;
  DAT_0048f198 = &DAT_004897b0;
  _DAT_0048f1a4 = &DAT_0048a410;
  _DAT_0048f1a8 = &DAT_0048a728;
  _DAT_0048f1ac = &DAT_0048aa40;
  _DAT_0048f1b4 = &DAT_0048ad58;
  _DAT_0048f1b8 = &DAT_0048b070;
  _DAT_0048f1bc = &DAT_0048b388;
  DAT_0048f1c0 = &DAT_0048b6a0;
  DAT_0048f1c4 = &DAT_0048b9b8;
  _DAT_0048f1c8 = &DAT_0048bcd0;
  _DAT_0048f1cc = &DAT_0048bfe8;
  _DAT_0048f1d0 = &DAT_0048c300;
  _DAT_0048f1d4 = &DAT_0048c618;
  _DAT_0048f1d8 = &DAT_0048eb38;
  _DAT_0048f1dc = &DAT_0048c930;
  _DAT_0048f1e0 = &DAT_0048cc48;
  _DAT_0048f19c = &DAT_0048cf60;
  _DAT_0048f1a0 = &DAT_0048d278;
  DAT_0048f1b0 = &DAT_0048d590;
  _DAT_0048f188 = &DAT_00489ac8;
  _DAT_0048f18c = &DAT_00489de0;
  _DAT_0048f1ec = &DAT_0048a0f8;
  _DAT_0048f1f0 = &DAT_0048d8a8;
  _DAT_0048f1f4 = &DAT_0048dbc0;
  _DAT_0048f1f8 = &DAT_0048ded8;
  _DAT_0048f1fc = &DAT_0048e1f0;
  _DAT_0048f200 = &DAT_0048e508;
  DAT_0048f204 = &DAT_0048e820;
  ui_element_table_start = (ui_element_t *)&DAT_0048ee50;
  ppuVar11 = &ui_element_table_end;
  do {
    FUN_0044faa0((char *)*ppuVar11);
    iVar9 = config_blob.screen_width;
    ppuVar11 = ppuVar11 + 1;
  } while ((int)ppuVar11 < 0x48f20c);
  puVar12 = &DAT_0048fac0;
  puVar15 = &DAT_004872cc;
  for (iVar10 = 0x3a; iVar10 != 0; iVar10 = iVar10 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_004872a8 = (float)(iVar9 + 4);
  _DAT_004872ac = 0x428c0000;
  if (iVar9 < 0x281) {
    _DAT_004872ac = 0x42700000;
  }
  pcVar16 = s_ui_ui_itemTexts_jaz_00479318;
  DAT_0048f7f4 = texture_get_or_load_alt(s_ui_ui_itemTexts_jaz_00479318,unaff_EBX);
  pcVar3 = s_ui_ui_textReaper_jaz_00479300;
  DAT_0048f7f8 = texture_get_or_load_alt(s_ui_ui_textReaper_jaz_00479300,pcVar16);
  pcVar16 = s_ui_ui_textControls_jaz_004792e8;
  DAT_0048f7fc = texture_get_or_load_alt(s_ui_ui_textControls_jaz_004792e8,pcVar3);
  pcVar3 = s_ui_ui_textPickAPerk_jaz_004792d0;
  DAT_0048f800 = texture_get_or_load_alt(s_ui_ui_textPickAPerk_jaz_004792d0,pcVar16);
  DAT_0048f804 = texture_get_or_load_alt(s_ui_ui_textWellDone_jaz_004792b8,pcVar3);
  puVar12 = &DAT_0048fba8;
  puVar15 = &DAT_00488244;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  DAT_00488220 = 0xc2700000;
  DAT_00488224 = 0x43520000;
  IStack_1c.vtable = (IGrim2D_vtbl *)0x43870000;
  fStack_18 = -38.0;
  ui_element_set_rect((ui_element_t *)&DAT_0048832c,124.0,30.0,(float *)&IStack_1c);
  _DAT_00488238 = 0x30;
  _DAT_0048823c = &LAB_0044fc70;
  iVar9 = game_is_full_version();
  if ((char)iVar9 != '\0') {
    _DAT_0048823c = &LAB_00447350;
  }
  puVar12 = &DAT_0048fba8;
  puVar15 = &DAT_004878fc;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_004878d8 = 0xc2700000;
  _DAT_004878dc = 0x43870000;
  IStack_1c.vtable = (IGrim2D_vtbl *)0x43870000;
  fStack_18 = -38.0;
  ui_element_set_rect((ui_element_t *)&DAT_004879e4,124.0,30.0,(float *)&IStack_1c);
  _DAT_004878f4 = ui_menu_main_click_play_game;
  _DAT_004878f0 = 0x19;
  IStack_1c.vtable = (IGrim2D_vtbl *)0x43870000;
  puVar12 = &DAT_0048fba8;
  puVar15 = &DAT_00487c14;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_00487bf0 = 0xc2700000;
  _DAT_00487bf4 = 0x43a50000;
  fStack_18 = -38.0;
  ui_element_set_rect((ui_element_t *)&DAT_00487cfc,124.0,30.0,(float *)&IStack_1c);
  _DAT_00487c0c = ui_menu_main_click_options;
  _DAT_00487c08 = 0x18;
  IStack_1c.vtable = (IGrim2D_vtbl *)0x43870000;
  puVar12 = &DAT_0048fba8;
  puVar15 = &DAT_00487f2c;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_00487f08 = 0xc2700000;
  _DAT_00487f0c = 0x43c30000;
  fStack_18 = -38.0;
  ui_element_set_rect((ui_element_t *)&DAT_00488014,124.0,30.0,(float *)&IStack_1c);
  _DAT_00487f24 = &LAB_00447390;
  _DAT_00487f20 = 0x1f;
  iVar9 = 5;
  pcVar3 = (char *)(*grim_interface_ptr->vtable->grim_get_config_var)
                             (&IStack_1c,(uint *)0x64,unaff_EBP);
  if (*pcVar3 != '\0') {
    puVar12 = &DAT_0048fba8;
    puVar15 = &DAT_0048855c;
    for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
      *puVar15 = *puVar12;
      puVar12 = puVar12 + 1;
      puVar15 = puVar15 + 1;
    }
    _DAT_00488538 = 0xc2700000;
    _DAT_0048853c = 0x43e10000;
    fStack_18 = 270.0;
    fStack_14 = -38.0;
    ui_element_set_rect((ui_element_t *)&DAT_00488644,124.0,30.0,&fStack_18);
    _DAT_00488550 = 0x30;
    _DAT_00488554 = &LAB_0044fca0;
    iVar9 = 6;
  }
  puVar12 = &DAT_0048fba8;
  puVar15 = &DAT_00488874;
  for (iVar10 = 0x3a; iVar10 != 0; iVar10 = iVar10 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  fStack_18 = 270.0;
  _DAT_00488850 = 0xc2700000;
  fStack_5c = (float)(iVar9 * 0x3c + 0x96);
  fStack_14 = -38.0;
  _DAT_00488854 = fStack_5c;
  ui_element_set_rect((ui_element_t *)&DAT_0048895c,124.0,30.0,&fStack_18);
  fVar13 = 0.0;
  _DAT_0048886c = ui_menu_main_click_quit;
  _DAT_00488868 = 0x10;
  iVar9 = 2;
  do {
    fVar14 = fVar13;
    if ((iVar9 == 2) && (iVar10 = game_is_full_version(), (char)iVar10 != '\0')) {
      fVar14 = 5.60519e-45;
    }
    pcVar3 = (char *)(*grim_interface_ptr->vtable->grim_get_config_var)
                               (aIStack_8,(uint *)0x64,(int)unaff_EBX);
    if (*pcVar3 == '\0') {
      if (iVar9 == 6) {
        fVar14 = 8.40779e-45;
        fStack_5c = 8.40779e-45;
      }
      (&ui_element_table_end)[iVar9]->counter_id = DAT_0048f7f4;
      puVar4 = (&ui_element_table_end)[iVar9];
      puVar4->_pad4[0x14] = '\0';
      puVar4->_pad4[0x15] = '\0';
      puVar4->_pad4[0x16] = '\0';
      puVar4->_pad4[0x17] = '\0';
      *(float *)(puVar4->_pad4 + 0x18) = (float)(int)fStack_5c * 0.125;
      puVar4 = (&ui_element_table_end)[iVar9];
      puVar4->_pad4[0x30] = '\0';
      puVar4->_pad4[0x31] = '\0';
      puVar4->_pad4[0x32] = 0x80;
      puVar4->_pad4[0x33] = '?';
      *(float *)(puVar4->_pad4 + 0x34) = (float)(int)fStack_5c * 0.125;
      puVar4 = (&ui_element_table_end)[iVar9];
      puVar4->_pad4[0x4c] = '\0';
      puVar4->_pad4[0x4d] = '\0';
      puVar4->_pad4[0x4e] = 0x80;
      puVar4->_pad4[0x4f] = '?';
      fVar13 = (float)((int)fVar14 + 1) * 0.125;
      *(float *)(puVar4->_pad4 + 0x50) = fVar13;
      puVar4 = (&ui_element_table_end)[iVar9];
      puVar4->_pad4[0x68] = '\0';
      puVar4->_pad4[0x69] = '\0';
      puVar4->_pad4[0x6a] = '\0';
      puVar4->_pad4[0x6b] = '\0';
    }
    else {
      local_20.vtable = (IGrim2D_vtbl *)((float)(int)fStack_5c * 0.125);
      (&ui_element_table_end)[iVar9]->counter_id = DAT_0048f7f4;
      puVar4 = (&ui_element_table_end)[iVar9];
      IStack_1c.vtable = (IGrim2D_vtbl *)0x3f800000;
      puVar4->_pad4[0x14] = '\0';
      puVar4->_pad4[0x15] = '\0';
      puVar4->_pad4[0x16] = '\0';
      puVar4->_pad4[0x17] = '\0';
      fStack_14 = 0.0;
      *(IGrim2D_vtbl **)(puVar4->_pad4 + 0x18) = local_20.vtable;
      puVar4 = (&ui_element_table_end)[iVar9];
      puVar4->_pad4[0x30] = '\0';
      puVar4->_pad4[0x31] = '\0';
      puVar4->_pad4[0x32] = 0x80;
      puVar4->_pad4[0x33] = '?';
      *(IGrim2D_vtbl **)(puVar4->_pad4 + 0x34) = local_20.vtable;
      puVar4 = (&ui_element_table_end)[iVar9];
      puVar4->_pad4[0x4c] = '\0';
      puVar4->_pad4[0x4d] = '\0';
      puVar4->_pad4[0x4e] = 0x80;
      puVar4->_pad4[0x4f] = '?';
      fVar13 = (float)((int)fVar14 + 1) * 0.125;
      *(float *)(puVar4->_pad4 + 0x50) = fVar13;
      puVar4 = (&ui_element_table_end)[iVar9];
      puVar4->_pad4[0x68] = '\0';
      puVar4->_pad4[0x69] = '\0';
      puVar4->_pad4[0x6a] = '\0';
      puVar4->_pad4[0x6b] = '\0';
      fStack_18 = fVar13;
      fStack_10 = fVar13;
    }
    *(float *)(puVar4->_pad4 + 0x6c) = fVar13;
    if (iVar9 == 2) {
      unaff_EBX = (char *)0x450461;
      iVar10 = game_is_full_version();
      if ((char)iVar10 != '\0') {
        fVar14 = 0.0;
      }
    }
    fVar13 = (float)((int)fVar14 + 1);
    if (fVar13 == 5.60519e-45) {
      fVar13 = (float)((int)fVar14 + 2);
    }
    iVar9 = iVar9 + 1;
    fStack_5c = fVar13;
  } while (iVar9 < 8);
  if (config_blob.screen_width < 0x281) {
    iVar9 = 0;
    do {
      pfVar8 = (float *)((int)ui_element_table_end->quad0 + iVar9);
      *pfVar8 = *(float *)((int)ui_element_table_end->quad0 + iVar9) * 0.8;
      pfVar8[1] = pfVar8[1] * 0.8;
      puVar1 = ui_element_table_end->_pad5 + iVar9 + 4;
      *(float *)puVar1 = *(float *)(ui_element_table_end->_pad5 + iVar9 + 4) * 0.8;
      *(float *)(puVar1 + 4) = *(float *)(puVar1 + 4) * 0.8;
      puVar1 = ui_element_table_end->_pad4 + iVar9;
      iVar10 = iVar9 + 0x1c;
      *(float *)puVar1 = *(float *)(ui_element_table_end->_pad4 + iVar9) * 0.8;
      *(float *)(puVar1 + 4) = *(float *)(puVar1 + 4) * 0.8;
      *(float *)((int)ui_element_table_end->quad0 + iVar9) =
           *(float *)((int)ui_element_table_end->quad0 + iVar9) + 10.0;
      *(float *)(ui_element_table_end->_pad5 + iVar9 + 4) =
           *(float *)(ui_element_table_end->_pad5 + iVar9 + 4) + 10.0;
      *(float *)(ui_element_table_end->_pad4 + iVar9) =
           *(float *)(ui_element_table_end->_pad4 + iVar9) + 10.0;
      *(float *)(DAT_0048f16c + iVar9 + 0x40) = *(float *)(DAT_0048f16c + iVar9 + 0x40) - 14.0;
      *(float *)(DAT_0048f16c + iVar9 + 0x210) = *(float *)(DAT_0048f16c + iVar9 + 0x210) - 14.0;
      *(float *)(DAT_0048f16c + iVar9 + 0x128) = *(float *)(DAT_0048f16c + iVar9 + 0x128) - 14.0;
      iVar9 = iVar10;
    } while (iVar10 < 0x70);
  }
  else if ((800 < config_blob.screen_width) && (config_blob.screen_width < 0x401)) {
    iVar9 = 0;
    do {
      pfVar8 = (float *)((int)ui_element_table_end->quad0 + iVar9);
      *pfVar8 = *(float *)((int)ui_element_table_end->quad0 + iVar9) * 1.2;
      pfVar8[1] = pfVar8[1] * 1.2;
      puVar1 = ui_element_table_end->_pad5 + iVar9 + 4;
      *(float *)puVar1 = *(float *)(ui_element_table_end->_pad5 + iVar9 + 4) * 1.2;
      *(float *)(puVar1 + 4) = *(float *)(puVar1 + 4) * 1.2;
      puVar1 = ui_element_table_end->_pad4 + iVar9;
      iVar10 = iVar9 + 0x1c;
      *(float *)puVar1 = *(float *)(ui_element_table_end->_pad4 + iVar9) * 1.2;
      *(float *)(puVar1 + 4) = *(float *)(puVar1 + 4) * 1.2;
      *(float *)((int)ui_element_table_end->quad0 + iVar9) =
           *(float *)((int)ui_element_table_end->quad0 + iVar9) + 10.0;
      *(float *)(ui_element_table_end->_pad5 + iVar9 + 4) =
           *(float *)(ui_element_table_end->_pad5 + iVar9 + 4) + 10.0;
      *(float *)(ui_element_table_end->_pad4 + iVar9) =
           *(float *)(ui_element_table_end->_pad4 + iVar9) + 10.0;
      iVar9 = iVar10;
    } while (iVar10 < 0x70);
  }
  iVar9 = 100;
  ppuVar5 = &DAT_0048f16c;
  fStack_5c = -NAN;
  do {
    *(int *)(*ppuVar5 + 0x14) = *(int *)(*ppuVar5 + 0x14) + iVar9;
    *(int *)(*ppuVar5 + 0x10) = *(int *)(*ppuVar5 + 0x10) + iVar9;
    if (0 < (int)fStack_5c) {
      *(float *)(*ppuVar5 + 0x18) = *(float *)(*ppuVar5 + 0x18) - (float)(int)fStack_5c;
    }
    fStack_5c = (float)((int)fStack_5c + 0x14);
    iVar9 = iVar9 + 100;
    ppuVar5 = ppuVar5 + 1;
  } while ((int)fStack_5c < 0x65);
  iVar9 = game_is_full_version();
  if ((char)iVar9 != '\0') {
    DAT_00486faa = 1;
  }
  puVar12 = &DAT_0048fc90;
  puVar15 = &DAT_00488b8c;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_00488b78 = _DAT_00488b70 + 280.0;
  _DAT_00488b7c = _DAT_00488b74 + 180.0;
  _DAT_00488b68 = 0xc2340000;
  _DAT_00488b6c = 0x43520000;
  _DAT_00488b84 = 0;
  _DAT_00488b88 = &LAB_004475d0;
  _DAT_00488b54 = 1;
  puVar12 = &DAT_0048fba8;
  puVar15 = &DAT_00488ea4;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_00488e80 = 0xc25c0000;
  _DAT_00488e84 = 0x43d70000;
  fStack_14 = 270.0;
  fStack_10 = -38.0;
  ui_element_set_rect((ui_element_t *)&DAT_00488f8c,124.0,30.0,&fStack_14);
  _DAT_0048906c = DAT_0048f7f4;
  _DAT_00488fa0 = 0;
  _DAT_00488fa4 = 0x3f600000;
  _DAT_00488fc0 = 0x3f600000;
  _DAT_00488fbc = 0x3f800000;
  _DAT_00488fd8 = 0x3f800000;
  _DAT_00488ff4 = 0;
  _DAT_00488fdc = 0x3f800000;
  _DAT_00488ff8 = 0x3f800000;
  _DAT_00488e9c = FUN_00447420;
  _DAT_00488e6c = 1;
  _DAT_00488e98 = 0x30;
  puVar12 = &DAT_0048fba8;
  puVar15 = &DAT_0048b9f4;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048b9d0 = 0xc2700000;
  _DAT_0048b9d4 = 0x43520000;
  puVar12 = &DAT_00487cfc;
  puVar15 = &DAT_0048badc;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  DAT_0048b9c8 = DAT_0048b9c8 + 100;
  DAT_0048b9cc = DAT_0048b9cc + 100;
  _DAT_0048b9ec = ui_menu_main_click_options;
  puVar12 = &DAT_0048fba8;
  puVar15 = &DAT_0048bd0c;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048bce8 = 0xc2a00000;
  _DAT_0048bcec = 0x43870000;
  puVar12 = &DAT_0048895c;
  puVar15 = &DAT_0048bdf4;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048bd04 = &LAB_004474e0;
  DAT_0048bce0 = DAT_0048bce0 + 200;
  DAT_0048bce4 = DAT_0048bce4 + 200;
  puVar12 = &DAT_0048fba8;
  puVar15 = &DAT_0048c024;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048c000 = 0xc2c80000;
  _DAT_0048c004 = 0x43a50000;
  puVar12 = &DAT_00488f8c;
  puVar15 = &DAT_0048c10c;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  DAT_0048bff8 = DAT_0048bff8 + 300;
  DAT_0048bffc = DAT_0048bffc + 300;
  _DAT_0048c318 = 0xc32f0000;
  _DAT_0048c31c = 0x42340000;
  _DAT_0048c01c = &LAB_00447490;
  _DAT_0048c018 = 0x30;
  _DAT_0048c304 = 1;
  puVar12 = &DAT_0048fd78;
  puVar15 = &DAT_0048c654;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048c630 = 0xc2340000;
  DAT_0048c628 = DAT_0048c628 + 100;
  _DAT_0048c634 = 0x42dc0000;
  DAT_0048c62c = DAT_0048c62c + 100;
  _DAT_0048919c = 0x43110000;
  _DAT_0048c61c = 1;
  _DAT_00489198 = 0xc2700000;
  _DAT_00489184 = 1;
  puVar12 = &DAT_0048fe60;
  puVar15 = &DAT_004894d4;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_004894b0 = 0xc2340000;
  _DAT_004894b4 = 0x43520000;
  pfVar8 = (float *)&DAT_004895bc;
  do {
    pfVar6 = pfVar8 + 7;
    *pfVar8 = *pfVar8 + 10.0;
    pfVar8[1] = pfVar8[1] + 10.0;
    pfVar8 = pfVar6;
  } while ((int)pfVar6 < 0x48962c);
  _DAT_004894d0 = &LAB_0044ed80;
  _DAT_0048949c = 1;
  puVar12 = &DAT_0048fba8;
  puVar15 = &DAT_004897ec;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_004897cc = 0x43e70000;
  _DAT_004897c8 = 0xc25c0000;
  puVar12 = &DAT_00488f8c;
  puVar15 = &DAT_004898d4;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_004897e4 = FUN_00447420;
  _DAT_0048c948 = 0xc32f0000;
  _DAT_004897b4 = 1;
  _DAT_004897e0 = 0x30;
  _DAT_0048c94c = 0x42340000;
  _DAT_0048c934 = 1;
  puVar12 = &DAT_0048fd78;
  puVar15 = &DAT_0048cc84;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048cc64 = 0x42dc0000;
  _DAT_0048cc60 = 0xc2340000;
  DAT_0048cc5c = DAT_0048cc5c + 100;
  DAT_0048cc58 = DAT_0048cc58 + 100;
  _DAT_0048cf78 = 0xc3340000;
  _DAT_0048cf7c = 0x43070000;
  _DAT_0048cc4c = 1;
  _DAT_0048cf64 = 1;
  puVar12 = &DAT_0048fc90;
  puVar15 = &DAT_0048d2b4;
  for (iVar9 = 0x3a; iVar10 = config_blob.screen_width, iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048d290 = 0xc3250000;
  if (config_blob.screen_width < 0x281) {
    _DAT_0048d290 = 0xc3370000;
  }
  DAT_0048d294 = 0x43480000;
  _DAT_0048d2b0 = &LAB_00448cd0;
  _DAT_0048d27c = 1;
  puVar12 = &DAT_0048fba8;
  puVar15 = &DAT_0048d5cc;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048d5a8 = 0xc31b0000;
  _DAT_0048d5ac = 0x43d20000;
  puVar12 = &DAT_00488f8c;
  puVar15 = &DAT_0048d6b4;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048d8c0 = 0xc32f0000;
  _DAT_0048d8c4 = 0x42340000;
  _DAT_0048d5c4 = ui_menu_main_click_options;
  _DAT_0048d594 = 0;
  _DAT_0048d5c0 = 0x30;
  _DAT_0048d8ac = 1;
  puVar12 = &DAT_0048fd78;
  puVar15 = &DAT_0048dbfc;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048dbd8 = 0xc2340000;
  DAT_0048dbd0 = DAT_0048dbd0 + 100;
  _DAT_0048dbdc = 0x42dc0000;
  DAT_0048dbd4 = DAT_0048dbd4 + 100;
  _DAT_0048def4 = 0x42f40000;
  _DAT_0048dbc4 = 1;
  _DAT_0048def0 = 0xc3070000;
  _DAT_0048dedc = 1;
  puVar12 = &DAT_0048fd78;
  puVar15 = &DAT_0048e22c;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048e20c = 0x43390000;
  _DAT_0048e208 = 0xc0a00000;
  _DAT_0048e524 = 0x42f40000;
  _DAT_0048e228 = &LAB_00447d40;
  _DAT_0048e1f4 = 1;
  _DAT_0048e520 = 0xc3070000;
  _DAT_0048e50c = 1;
  puVar12 = &DAT_0048fd78;
  puVar15 = &DAT_0048e85c;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048e83c = 0x43390000;
  _DAT_0048e838 = 0xc0a00000;
  _DAT_0048e824 = 1;
  _DAT_0048a110 = (float)(iVar10 + -0x15e);
  puVar12 = &DAT_0048fc90;
  puVar15 = &DAT_0048a134;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048a114 = 0x43480000;
  if (iVar10 < 0x321) {
    if (iVar10 < 0x281) {
      _DAT_0048a110 = _DAT_0048a110 + 10.0;
    }
    else {
      _DAT_0048a110 = _DAT_0048a110 - 30.0;
    }
  }
  else {
    _DAT_0048a110 = _DAT_0048a110 - 65.0;
  }
  _DAT_0048a0fc = 1;
  DAT_0048a40c = 1;
  _DAT_00489ae4 = 0x42f40000;
  _DAT_00489ae0 = 0xc3250000;
  if (iVar10 < 0x281) {
    _DAT_00489ae0 = 0xc3570000;
  }
  _DAT_00489acc = 1;
  puVar12 = &DAT_0048fd78;
  puVar15 = &DAT_00489e1c;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  fStack_14 = -60.0;
  fStack_10 = 185.0;
  _DAT_00489dfc = 0x43390000;
  _DAT_00489df8 = 0xc20c0000;
  if (iVar10 < 0x281) {
    _DAT_00489df8 = 0xc2aa0000;
  }
  DAT_00489de4 = 1;
  DAT_0048eb48 = 500;
  ppuVar5 = &DAT_0048f16c;
  fStack_5c = -NAN;
  do {
    if (iVar10 < 0x281) {
      fVar13 = (float)(int)fStack_5c;
      iVar9 = 0;
      do {
        pfVar8 = (float *)(*ppuVar5 + iVar9 + 0x3c);
        *pfVar8 = *(float *)(*ppuVar5 + iVar9 + 0x3c) * 0.9;
        pfVar8[1] = pfVar8[1] * 0.9;
        pfVar8 = (float *)(*ppuVar5 + iVar9 + 0x20c);
        *pfVar8 = *(float *)(*ppuVar5 + iVar9 + 0x20c) * 0.9;
        pfVar8[1] = pfVar8[1] * 0.9;
        pfVar8 = (float *)(*ppuVar5 + iVar9 + 0x124);
        *pfVar8 = *(float *)(*ppuVar5 + iVar9 + 0x124) * 0.9;
        pfVar8[1] = pfVar8[1] * 0.9;
        *(float *)(*ppuVar5 + iVar9 + 0x40) = *(float *)(*ppuVar5 + iVar9 + 0x40) - fVar13;
        *(float *)(*ppuVar5 + iVar9 + 0x210) = *(float *)(*ppuVar5 + iVar9 + 0x210) - fVar13;
        iVar10 = iVar9 + 0x128;
        iVar7 = iVar9 + 0x128;
        iVar9 = iVar9 + 0x1c;
        *(float *)(*ppuVar5 + iVar7) = *(float *)(*ppuVar5 + iVar10) - fVar13;
        iVar10 = config_blob.screen_width;
      } while (iVar9 < 0x70);
    }
    fStack_5c = (float)((int)fStack_5c + 0xb);
    ppuVar5 = ppuVar5 + 1;
  } while ((int)fStack_5c < 0x38);
  ppuVar5 = &DAT_0048f1c0;
  fStack_5c = -NAN;
  iStack_54 = -0xb;
  do {
    if (iVar10 < 0x281) {
      fVar13 = (float)iStack_54;
      iVar9 = 0;
      do {
        pfVar8 = (float *)(*ppuVar5 + iVar9 + 0x3c);
        *pfVar8 = *(float *)(*ppuVar5 + iVar9 + 0x3c) * 0.8;
        pfVar8[1] = pfVar8[1] * 0.8;
        pfVar8 = (float *)(*ppuVar5 + iVar9 + 0x20c);
        *pfVar8 = *(float *)(*ppuVar5 + iVar9 + 0x20c) * 0.8;
        pfVar8[1] = pfVar8[1] * 0.8;
        pfVar8 = (float *)(*ppuVar5 + iVar9 + 0x124);
        *pfVar8 = *(float *)(*ppuVar5 + iVar9 + 0x124) * 0.8;
        pfVar8[1] = pfVar8[1] * 0.8;
        *(float *)(*ppuVar5 + iVar9 + 0x40) = *(float *)(*ppuVar5 + iVar9 + 0x40) - fVar13;
        *(float *)(*ppuVar5 + iVar9 + 0x210) = *(float *)(*ppuVar5 + iVar9 + 0x210) - fVar13;
        iVar10 = iVar9 + 0x128;
        iVar7 = iVar9 + 0x128;
        iVar9 = iVar9 + 0x1c;
        *(float *)(*ppuVar5 + iVar7) = *(float *)(*ppuVar5 + iVar10) - fVar13;
        iVar10 = config_blob.screen_width;
      } while (iVar9 < 0x70);
    }
    else if (iVar10 < 0x321) {
      fVar13 = (float)(int)fStack_5c;
      iVar9 = 0;
      do {
        pfVar8 = (float *)(*ppuVar5 + iVar9 + 0x3c);
        *pfVar8 = *(float *)(*ppuVar5 + iVar9 + 0x3c) * 0.9;
        pfVar8[1] = pfVar8[1] * 0.9;
        pfVar8 = (float *)(*ppuVar5 + iVar9 + 0x20c);
        *pfVar8 = *(float *)(*ppuVar5 + iVar9 + 0x20c) * 0.9;
        pfVar8[1] = pfVar8[1] * 0.9;
        pfVar8 = (float *)(*ppuVar5 + iVar9 + 0x124);
        *pfVar8 = *(float *)(*ppuVar5 + iVar9 + 0x124) * 0.9;
        pfVar8[1] = pfVar8[1] * 0.9;
        *(float *)(*ppuVar5 + iVar9 + 0x40) = *(float *)(*ppuVar5 + iVar9 + 0x40) - fVar13;
        *(float *)(*ppuVar5 + iVar9 + 0x210) = *(float *)(*ppuVar5 + iVar9 + 0x210) - fVar13;
        iVar10 = iVar9 + 0x128;
        iVar7 = iVar9 + 0x128;
        iVar9 = iVar9 + 0x1c;
        *(float *)(*ppuVar5 + iVar7) = *(float *)(*ppuVar5 + iVar10) - fVar13;
        iVar10 = config_blob.screen_width;
      } while (iVar9 < 0x70);
    }
    iStack_54 = iStack_54 + 0xb;
    fStack_5c = (float)((int)fStack_5c + 5);
    ppuVar5 = ppuVar5 + 1;
  } while (iStack_54 < 0x17);
  if (iVar10 < 0x281) {
    iVar9 = 0;
    do {
      pfVar8 = (float *)(DAT_0048f1e8 + iVar9 + 0x3c);
      *pfVar8 = *(float *)(DAT_0048f1e8 + iVar9 + 0x3c) * 0.8;
      pfVar8[1] = pfVar8[1] * 0.8;
      pfVar8 = (float *)(DAT_0048f1e8 + iVar9 + 0x20c);
      *pfVar8 = *(float *)(DAT_0048f1e8 + iVar9 + 0x20c) * 0.8;
      pfVar8[1] = pfVar8[1] * 0.8;
      pfVar8 = (float *)(DAT_0048f1e8 + iVar9 + 0x124);
      iVar7 = iVar9 + 0x1c;
      *pfVar8 = *(float *)(DAT_0048f1e8 + iVar9 + 0x124) * 0.8;
      pfVar8[1] = pfVar8[1] * 0.8;
      *(float *)(DAT_0048f1e8 + iVar9 + 0x40) = *(float *)(DAT_0048f1e8 + iVar9 + 0x40) - 11.0;
      *(float *)(DAT_0048f1e8 + iVar9 + 0x210) = *(float *)(DAT_0048f1e8 + iVar9 + 0x210) - 11.0;
      *(float *)(DAT_0048f1e8 + iVar9 + 0x128) = *(float *)(DAT_0048f1e8 + iVar9 + 0x128) - 11.0;
      iVar9 = iVar7;
      iVar10 = config_blob.screen_width;
    } while (iVar7 < 0x70);
  }
  else if (iVar10 < 0x321) {
    iVar9 = 0;
    do {
      pfVar8 = (float *)(DAT_0048f1e8 + iVar9 + 0x3c);
      *pfVar8 = *(float *)(DAT_0048f1e8 + iVar9 + 0x3c) * 0.9;
      pfVar8[1] = pfVar8[1] * 0.9;
      pfVar8 = (float *)(DAT_0048f1e8 + iVar9 + 0x20c);
      *pfVar8 = *(float *)(DAT_0048f1e8 + iVar9 + 0x20c) * 0.9;
      pfVar8[1] = pfVar8[1] * 0.9;
      pfVar8 = (float *)(DAT_0048f1e8 + iVar9 + 0x124);
      iVar7 = iVar9 + 0x1c;
      *pfVar8 = *(float *)(DAT_0048f1e8 + iVar9 + 0x124) * 0.9;
      pfVar8[1] = pfVar8[1] * 0.9;
      *(float *)(DAT_0048f1e8 + iVar9 + 0x40) = *(float *)(DAT_0048f1e8 + iVar9 + 0x40) - 3.0;
      *(float *)(DAT_0048f1e8 + iVar9 + 0x210) = *(float *)(DAT_0048f1e8 + iVar9 + 0x210) - 3.0;
      *(float *)(DAT_0048f1e8 + iVar9 + 0x128) = *(float *)(DAT_0048f1e8 + iVar9 + 0x128) - 3.0;
      iVar9 = iVar7;
      iVar10 = config_blob.screen_width;
    } while (iVar7 < 0x70);
  }
  if (iVar10 < 0x281) {
    iVar9 = 0;
    do {
      pfVar8 = (float *)(DAT_0048f198 + iVar9 + 0x3c);
      *pfVar8 = *(float *)(DAT_0048f198 + iVar9 + 0x3c) * 0.8;
      pfVar8[1] = pfVar8[1] * 0.8;
      pfVar8 = (float *)(DAT_0048f198 + iVar9 + 0x20c);
      *pfVar8 = *(float *)(DAT_0048f198 + iVar9 + 0x20c) * 0.8;
      pfVar8[1] = pfVar8[1] * 0.8;
      pfVar8 = (float *)(DAT_0048f198 + iVar9 + 0x124);
      iVar7 = iVar9 + 0x1c;
      *pfVar8 = *(float *)(DAT_0048f198 + iVar9 + 0x124) * 0.8;
      pfVar8[1] = pfVar8[1] * 0.8;
      *(float *)(DAT_0048f198 + iVar9 + 0x40) = *(float *)(DAT_0048f198 + iVar9 + 0x40) - 11.0;
      *(float *)(DAT_0048f198 + iVar9 + 0x210) = *(float *)(DAT_0048f198 + iVar9 + 0x210) - 11.0;
      *(float *)(DAT_0048f198 + iVar9 + 0x128) = *(float *)(DAT_0048f198 + iVar9 + 0x128) - 11.0;
      iVar9 = iVar7;
      iVar10 = config_blob.screen_width;
    } while (iVar7 < 0x70);
  }
  else if (iVar10 < 0x321) {
    iVar9 = 0;
    do {
      pfVar8 = (float *)(DAT_0048f198 + iVar9 + 0x3c);
      *pfVar8 = *(float *)(DAT_0048f198 + iVar9 + 0x3c) * 0.9;
      pfVar8[1] = pfVar8[1] * 0.9;
      pfVar8 = (float *)(DAT_0048f198 + iVar9 + 0x20c);
      *pfVar8 = *(float *)(DAT_0048f198 + iVar9 + 0x20c) * 0.9;
      pfVar8[1] = pfVar8[1] * 0.9;
      pfVar8 = (float *)(DAT_0048f198 + iVar9 + 0x124);
      iVar7 = iVar9 + 0x1c;
      *pfVar8 = *(float *)(DAT_0048f198 + iVar9 + 0x124) * 0.9;
      pfVar8[1] = pfVar8[1] * 0.9;
      *(float *)(DAT_0048f198 + iVar9 + 0x40) = *(float *)(DAT_0048f198 + iVar9 + 0x40) - 3.0;
      *(float *)(DAT_0048f198 + iVar9 + 0x210) = *(float *)(DAT_0048f198 + iVar9 + 0x210) - 3.0;
      *(float *)(DAT_0048f198 + iVar9 + 0x128) = *(float *)(DAT_0048f198 + iVar9 + 0x128) - 3.0;
      iVar9 = iVar7;
      iVar10 = config_blob.screen_width;
    } while (iVar7 < 0x70);
  }
  if (iVar10 < 0x281) {
    iVar9 = 0;
    do {
      pfVar8 = (float *)(DAT_0048f1b0 + iVar9 + 0x3c);
      *pfVar8 = *(float *)(DAT_0048f1b0 + iVar9 + 0x3c) * 0.8;
      pfVar8[1] = pfVar8[1] * 0.8;
      pfVar8 = (float *)(DAT_0048f1b0 + iVar9 + 0x20c);
      *pfVar8 = *(float *)(DAT_0048f1b0 + iVar9 + 0x20c) * 0.8;
      pfVar8[1] = pfVar8[1] * 0.8;
      pfVar8 = (float *)(DAT_0048f1b0 + iVar9 + 0x124);
      iVar10 = iVar9 + 0x1c;
      *pfVar8 = *(float *)(DAT_0048f1b0 + iVar9 + 0x124) * 0.8;
      pfVar8[1] = pfVar8[1] * 0.8;
      *(float *)(DAT_0048f1b0 + iVar9 + 0x40) = *(float *)(DAT_0048f1b0 + iVar9 + 0x40) - 11.0;
      *(float *)(DAT_0048f1b0 + iVar9 + 0x210) = *(float *)(DAT_0048f1b0 + iVar9 + 0x210) - 11.0;
      *(float *)(DAT_0048f1b0 + iVar9 + 0x128) = *(float *)(DAT_0048f1b0 + iVar9 + 0x128) - 11.0;
      iVar9 = iVar10;
    } while (iVar10 < 0x70);
  }
  else if (iVar10 < 0x321) {
    iVar9 = 0;
    do {
      pfVar8 = (float *)(DAT_0048f1b0 + iVar9 + 0x3c);
      *pfVar8 = *(float *)(DAT_0048f1b0 + iVar9 + 0x3c) * 0.9;
      pfVar8[1] = pfVar8[1] * 0.9;
      pfVar8 = (float *)(DAT_0048f1b0 + iVar9 + 0x20c);
      *pfVar8 = *(float *)(DAT_0048f1b0 + iVar9 + 0x20c) * 0.9;
      pfVar8[1] = pfVar8[1] * 0.9;
      pfVar8 = (float *)(DAT_0048f1b0 + iVar9 + 0x124);
      iVar10 = iVar9 + 0x1c;
      *pfVar8 = *(float *)(DAT_0048f1b0 + iVar9 + 0x124) * 0.9;
      pfVar8[1] = pfVar8[1] * 0.9;
      *(float *)(DAT_0048f1b0 + iVar9 + 0x40) = *(float *)(DAT_0048f1b0 + iVar9 + 0x40) - 3.0;
      *(float *)(DAT_0048f1b0 + iVar9 + 0x210) = *(float *)(DAT_0048f1b0 + iVar9 + 0x210) - 3.0;
      *(float *)(DAT_0048f1b0 + iVar9 + 0x128) = *(float *)(DAT_0048f1b0 + iVar9 + 0x128) - 3.0;
      iVar9 = iVar10;
    } while (iVar10 < 0x70);
  }
  FUN_0044faa0((char *)0x4516dc);
  _DAT_0048f240 = FUN_00446140;
  puVar12 = &DAT_0048fba8;
  puVar15 = &perk_prompt_bounds_min_x;
  for (iVar9 = 0x3a; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048f25c = 0x3f800000;
  _DAT_0048f278 = 0;
  _DAT_0048f2b0 = 0x3f800000;
  _DAT_0048f294 = 0;
  ui_element_load((ui_element_t *)&DAT_0048f330,s_ui_ui_textLevelUp_jaz_004792a0);
  fStack_14 = -230.0;
  fStack_10 = -27.0;
  ui_element_set_rect((ui_element_t *)&DAT_0048f330,75.0,25.0,&fStack_14);
  pfVar8 = (float *)&DAT_0048f334;
  do {
    pfVar6 = pfVar8 + 7;
    pfVar8[-0x3b] = pfVar8[-0x3b] - 300.0;
    pfVar8[-0x3b] = pfVar8[-0x3b] * 0.75;
    pfVar8[-0x3a] = pfVar8[-0x3a] * 0.75;
    pfVar8[-1] = pfVar8[-1] * 0.85;
    *pfVar8 = *pfVar8 * 0.85;
    pfVar8[-1] = pfVar8[-1] - 46.0;
    *pfVar8 = *pfVar8 - 4.0;
    pfVar8 = pfVar6;
  } while ((int)pfVar6 < 0x48f3a4);
  if (config_blob.screen_width == 0x280) {
    fStack_14 = 690.0;
    fStack_10 = 80.0;
    _perk_prompt_origin_y = 0x42a00000;
  }
  else {
    fStack_10 = 40.0;
    fStack_14 = (float)(config_blob.screen_width + 0x32);
    _perk_prompt_origin_y = 0x42200000;
  }
  ppuVar5 = &DAT_0048f16c;
  _perk_prompt_origin_x = fStack_14;
  do {
    puVar2 = *ppuVar5;
    ppuVar5 = ppuVar5 + 1;
    *(float *)(puVar2 + 0x1c) =
         ((float)config_blob.screen_width * 0.0015625 * 150.0 - 150.0) + *(float *)(puVar2 + 0x1c);
    iVar9 = config_blob.screen_width;
  } while ((int)ppuVar5 < 0x48f20c);
  _DAT_0048ee68 = (float)(config_blob.screen_width + -0x15e);
  puVar12 = &DAT_00489de0;
  puVar15 = &DAT_0048ee50;
  for (iVar10 = 0xc6; iVar10 != 0; iVar10 = iVar10 + -1) {
    *puVar15 = *puVar12;
    puVar12 = puVar12 + 1;
    puVar15 = puVar15 + 1;
  }
  _DAT_0048ee6c = 0x43480000;
  if (iVar9 < 0x281) {
    _DAT_0048ee68 = _DAT_0048ee68 + 80.0;
    _DAT_0048ee6c = 0x433a0000;
  }
  DAT_0048ee54 = 1;
  DAT_0048f164 = 1;
  ppuVar11 = &ui_element_table_end;
  do {
    FUN_0044fb50((float)*ppuVar11);
    ppuVar11 = ppuVar11 + 1;
  } while ((int)ppuVar11 < 0x48f20c);
  return;
}



/* weapon_table_init @ 004519b0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* initializes the weapon stats table at DAT_004d7a28 */

void weapon_table_init(void)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  char *pcVar7;
  char *pcVar8;
  
  iVar4 = 0;
  piVar3 = &weapon_table.pellet_count;
  do {
    iVar1 = iVar4 + -1;
    iVar4 = iVar4 + 1;
    piVar3[-4] = iVar1;
    *piVar3 = 1;
    piVar3 = piVar3 + 0x1f;
  } while ((int)piVar3 < 0x4d99a0);
  uVar5 = 0xffffffff;
  weapon_table.hud_icon_id = 0;
  pcVar7 = s_Fire_bullets_0047958c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d7ef4 = 0x41f00000;
  _DAT_004d7fec = 0x420c0000;
  _DAT_004d84c4 = 0x41700000;
  _DAT_004d8540 = 0x41a00000;
  _DAT_004d85bc = 0x41200000;
  _DAT_004d8828 = 0x41200000;
  _DAT_004d83cc = 0x41a00000;
  _DAT_004d7d80 = 0x43570000;
  _DAT_004d8e74 = 0x41700000;
  _DAT_004d8f6c = 0x41200000;
  _DAT_004d7c0c = 0x42700000;
  DAT_004d7b14 = 0x425c0000;
  _DAT_004d7b90 = 0x42480000;
  _DAT_004d86b4 = 0x41a00000;
  _DAT_004d86b8 = 0x41300000;
  DAT_004d9064 = 0x42700000;
  _DAT_004d9068 = 0x3e800000;
  _DAT_004d8730 = 0x41200000;
  _DAT_004d8734 = 0x3f000000;
  _DAT_004d7ef8 = 0x40a00000;
  _DAT_004d7ff0 = 0x40066666;
  _DAT_004d84c8 = 0x40400000;
  _DAT_004d8544 = 0x3fb33333;
  _DAT_004d85c0 = 0x4185999a;
  _DAT_004d882c = 0x41e00000;
  _DAT_004d83d0 = 0x3f800000;
  _DAT_004d8e78 = 0;
  _DAT_004d7c10 = 0x3f99999a;
  DAT_004d7b18 = 0x40833333;
  _DAT_004d863c = 0;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8ff8;
  for (uVar6 = uVar5 >> 2; _DAT_004d7b7c = sfx_autorifle_fire, uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; _DAT_004d7b08 = sfx_pistol_reload, uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  uVar5 = 0xffffffff;
  pcVar7 = s_Pistol_00479584;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d9060 = 1;
  _DAT_004d903c = 0x70;
  DAT_004d9040 = 0x3e0f5c29;
  _DAT_004d9044 = 0x3f99999a;
  _DAT_004d9048 = 0x3e6147ae;
  DAT_004d9050 = _DAT_004d7b7c;
  _DAT_004d9058 = sfx_pistol_reload;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7aa8;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  DAT_004d7b10 = 5;
  _DAT_004d7aec = 0xc;
  _DAT_004d7af0 = 0x3f3631f9;
  DAT_004d7af4 = 0x3f99999a;
  _DAT_004d7af8 = 0x3e6147ae;
  _DAT_004d7b00 = sfx_pistol_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Assault_Rifle_00479574;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7b24;
  for (uVar6 = uVar5 >> 2; _DAT_004d93bc = sfx_shotgun_reload, uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; _DAT_004d83c0 = sfx_autorifle_reload, uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  uVar5 = 0xffffffff;
  pcVar7 = &DAT_0047956c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d7b8c = 1;
  _DAT_004d7b68 = 0x19;
  _DAT_004d7b6c = 0x3def9db2;
  _DAT_004d7b70 = 0x3f99999a;
  _DAT_004d7b74 = 0x3db851ec;
  _DAT_004d7b84 = sfx_autorifle_reload;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7ba0;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; _DAT_004d8434 = sfx_shotgun_fire, uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d7be4 = 0xc;
  _DAT_004d7c14 = 0xc;
  uVar5 = 0xffffffff;
  _DAT_004d7c08 = 1;
  pcVar7 = s_Sawed_off_Shotgun_00479558;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  _DAT_004d7be8 = 0x3f59999a;
  uVar5 = ~uVar5;
  _DAT_004d7bec = 0x3ff33333;
  _DAT_004d7bf0 = 0x3e8a3d71;
  _DAT_004d7bf8 = sfx_shotgun_fire;
  _DAT_004d7c00 = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7c1c;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d7c60 = 0xc;
  _DAT_004d7c90 = 0xc;
  uVar5 = 0xffffffff;
  _DAT_004d7c84 = 1;
  pcVar7 = s_Jackhammer_0047954c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d7c64 = 0x3f5eb852;
  _DAT_004d7c68 = 0x3ff33333;
  _DAT_004d7c6c = 0x3e051eb8;
  _DAT_004d7c74 = _DAT_004d8434;
  _DAT_004d7c7c = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d83dc;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  uVar5 = 0xffffffff;
  pcVar7 = s_Submachine_Gun_0047953c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8444 = 1;
  _DAT_004d8420 = 0x10;
  _DAT_004d8424 = 0x3e0f5c29;
  _DAT_004d8428 = 0x40400000;
  _DAT_004d842c = 0x3e23d70a;
  _DAT_004d8450 = 4;
  _DAT_004d843c = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7c98;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d7cf0 = sfx_hrpm_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Flamethrower_0047952c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d7d00 = 5;
  _DAT_004d7cdc = 0x1e;
  _DAT_004d7ce0 = 0x3db476b0;
  _DAT_004d7ce4 = 0x3f99999a;
  _DAT_004d7ce8 = 0x3da7ef9e;
  _DAT_004d7cf8 = _DAT_004d83c0;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7e0c;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d7e64 = sfx_flamer_fire_01;
  uVar5 = 0xffffffff;
  pcVar7 = s_Plasma_Rifle_0047951c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d7e74 = 8;
  _DAT_004d7e68 = 2;
  _DAT_004d7e50 = 0x1e;
  _DAT_004d7e54 = 0x3c04ec63;
  _DAT_004d7e58 = 0x40000000;
  _DAT_004d7e5c = 0x3c75c28f;
  _DAT_004d7e08 = 1;
  _DAT_004d7e6c = _DAT_004d83c0;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7e88;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d7ecc = 0x14;
  _DAT_004d7ee0 = sfx_shock_fire;
  uVar5 = 0xffffffff;
  _DAT_004d7ed0 = 0x3e94e545;
  _DAT_004d7ed4 = 0x3f99999a;
  _DAT_004d7ed8 = 0x3e3a5e35;
  _DAT_004d7ee8 = _DAT_004d83c0;
  pcVar7 = s_Multi_Plasma_0047950c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7f04;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d7f5c = sfx_shock_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Plasma_Minigun_004794fc;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d7f48 = 8;
  _DAT_004d7f4c = 0x3f1eed84;
  _DAT_004d7f50 = 0x3fb33333;
  _DAT_004d7f54 = 0x3ea3d70a;
  _DAT_004d7f78 = 3;
  _DAT_004d7f64 = _DAT_004d83c0;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7f80;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  DAT_004d7fd8 = sfx_plasmaminigun_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Gauss_Gun_004794f0;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d7fc4 = 0x1e;
  _DAT_004d7fc8 = 0x3de147ae;
  _DAT_004d7fcc = 0x3fa66666;
  _DAT_004d7fd0 = 0x3dc6a7f0;
  _DAT_004d7fe0 = _DAT_004d83c0;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7d14;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d7d6c = sfx_gauss_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Rocket_Launcher_004794e0;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d7d7c = 1;
  _DAT_004d7d58 = 6;
  _DAT_004d7d5c = 0x3f19999a;
  _DAT_004d7d60 = 0x3fcccccd;
  _DAT_004d7d64 = 0x3ed70a3d;
  _DAT_004d7d74 = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7ffc;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d8064 = 8;
  _DAT_004d8040 = 5;
  _DAT_004d8044 = 0x3f3da5d6;
  _DAT_004d8048 = 0x3f99999a;
  _DAT_004d804c = 0x3ed70a3d;
  _DAT_004d8054 = sfx_rocket_fire;
  _DAT_004d805c = sfx_autorifle_reload_alt;
  uVar5 = 0xffffffff;
  _DAT_004d7ff8 = 2;
  pcVar7 = s_Seeker_Rockets_004794d0;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8078;
  for (uVar6 = uVar5 >> 2; _DAT_004d80d8 = sfx_autorifle_reload_alt, uVar6 != 0; uVar6 = uVar6 - 1)
  {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d80d0 = sfx_rocket_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Mean_Minigun_004794c0;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d80e0 = 8;
  _DAT_004d80bc = 8;
  _DAT_004d80c0 = 0x3e9f22b6;
  _DAT_004d80c4 = 0x3f99999a;
  _DAT_004d80c8 = 0x3ea3d70a;
  _DAT_004d8074 = 2;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d7d90;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d7de8 = sfx_autorifle_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Plasma_Shotgun_004794b0;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d7df8 = 3;
  _DAT_004d7dd4 = 0x78;
  _DAT_004d7dd8 = 0x3db851ec;
  _DAT_004d7ddc = 0x40800000;
  _DAT_004d7de0 = 0x3d7df3b6;
  _DAT_004d7df0 = _DAT_004d83c0;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d80f4;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d814c = sfx_plasmashotgun_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Blow_Torch_004794a4;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8138 = 8;
  _DAT_004d813c = 0x3ef5c28f;
  _DAT_004d8140 = 0x40466666;
  _DAT_004d8144 = 0x3de147ae;
  _DAT_004d8168 = 0xe;
  _DAT_004d8154 = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8170;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d81c8 = sfx_flamer_fire_01;
  uVar5 = 0xffffffff;
  pcVar7 = s_HR_Flamer_00479498;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d81d8 = 8;
  _DAT_004d81cc = 2;
  _DAT_004d81b4 = 0x1e;
  _DAT_004d81b8 = 0x3bc84f90;
  _DAT_004d81bc = 0x3fc00000;
  _DAT_004d81c0 = 0x3c23d70a;
  _DAT_004d816c = 1;
  _DAT_004d81d0 = _DAT_004d83c0;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d81ec;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d8244 = sfx_flamer_fire_01;
  uVar5 = 0xffffffff;
  pcVar7 = s_Mini_Rocket_Swarmers_00479480;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8254 = 8;
  _DAT_004d8248 = 2;
  _DAT_004d8230 = 0x1e;
  _DAT_004d8234 = 0x3c0b4396;
  _DAT_004d8238 = 0x3fe66666;
  _DAT_004d823c = 0x3c23d70a;
  _DAT_004d81e8 = 1;
  _DAT_004d824c = _DAT_004d83c0;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8268;
  for (uVar6 = uVar5 >> 2; _DAT_004d82c8 = sfx_autorifle_reload_alt, uVar6 != 0; uVar6 = uVar6 - 1)
  {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d82c0 = sfx_rocket_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Rocket_Minigun_00479470;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d82d0 = 8;
  _DAT_004d82ac = 5;
  _DAT_004d82b0 = 0x3fe66666;
  _DAT_004d82b4 = 0x3fe66666;
  _DAT_004d82b8 = 0x3df5c28f;
  _DAT_004d8264 = 2;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d82e4;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d834c = 8;
  _DAT_004d8328 = 0x10;
  _DAT_004d832c = 0x3df5c28f;
  _DAT_004d833c = sfx_rocketmini_fire;
  _DAT_004d8344 = sfx_autorifle_reload_alt;
  uVar5 = 0xffffffff;
  _DAT_004d8330 = 0x3fe66666;
  pcVar7 = s_Pulse_Gun_00479464;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8334 = 0x3df5c28f;
  _DAT_004d82e0 = 2;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8360;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; _DAT_004d86a8 = sfx_shock_reload, uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d83b8 = sfx_pulse_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Ion_Rifle_00479458;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d83c8 = 8;
  _DAT_004d83a4 = 0x10;
  _DAT_004d83a8 = 0x3dcccccd;
  _DAT_004d83ac = 0x3dcccccd;
  _DAT_004d83b0 = 0;
  _DAT_004d835c = 3;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8458;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d84b0 = sfx_shock_fire_alt;
  uVar5 = 0xffffffff;
  pcVar7 = s_Ion_Minigun_0047944c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d84c0 = 8;
  _DAT_004d849c = 8;
  _DAT_004d84a0 = 0x3ecccccd;
  _DAT_004d84a4 = 0x3faccccd;
  _DAT_004d84a8 = 0x3de56042;
  _DAT_004d8454 = 4;
  _DAT_004d84b8 = _DAT_004d86a8;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d84d4;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d852c = sfx_shockminigun_fire;
  uVar5 = 0xffffffff;
  _DAT_004d853c = 8;
  _DAT_004d8518 = 0x14;
  _DAT_004d851c = 0x3dcccccd;
  _DAT_004d8520 = 0x3fe66666;
  _DAT_004d8524 = 0x3db851ec;
  _DAT_004d84d0 = 4;
  _DAT_004d8534 = _DAT_004d86a8;
  pcVar7 = s_Ion_Cannon_00479440;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8550;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d85a8 = sfx_shock_fire_alt;
  uVar5 = 0xffffffff;
  pcVar7 = s_Ion_Shotgun_00479434;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8594 = 3;
  _DAT_004d8598 = 0x3f800000;
  _DAT_004d859c = 0x40400000;
  _DAT_004d85a0 = 0x3f2e147b;
  _DAT_004d854c = 4;
  _DAT_004d85b0 = _DAT_004d86a8;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8930;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d8988 = sfx_shock_fire_alt;
  uVar5 = 0xffffffff;
  pcVar7 = s_Gauss_Shotgun_00479424;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8998 = 1;
  _DAT_004d8974 = 10;
  _DAT_004d8978 = 0x3f59999a;
  _DAT_004d897c = 0x3ff33333;
  _DAT_004d8980 = 0x3e8a3d71;
  _DAT_004d89a4 = 8;
  _DAT_004d892c = 4;
  _DAT_004d8990 = _DAT_004d86a8;
  _DAT_004d8994 = 0x1f;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d88b4;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d890c = sfx_gauss_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Plasma_Cannon_00479414;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d891c = 1;
  _DAT_004d88f8 = 4;
  _DAT_004d88fc = 0x3f866666;
  _DAT_004d8900 = 0x40066666;
  _DAT_004d8904 = 0x3e8a3d71;
  _DAT_004d88b0 = 0;
  _DAT_004d8914 = _DAT_004d93bc;
  _DAT_004d8918 = 0x1e;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d87bc;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d8814 = sfx_shock_fire;
  uVar5 = 0xffffffff;
  _DAT_004d8800 = 3;
  pcVar7 = s_Evil_Scythe_00479408;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8804 = 0x3f666666;
  _DAT_004d8808 = 0x402ccccd;
  _DAT_004d880c = 0x3f19999a;
  _DAT_004d881c = _DAT_004d86a8;
  _DAT_004d8820 = 0x19;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8740;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d8798 = sfx_shock_fire_alt;
  uVar5 = 0xffffffff;
  pcVar7 = s_Flameburst_004793fc;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8784 = 3;
  _DAT_004d8788 = 0x3f800000;
  _DAT_004d878c = 0x40400000;
  _DAT_004d8790 = 0x3f2e147b;
  _DAT_004d873c = 4;
  _DAT_004d87a0 = _DAT_004d86a8;
  _DAT_004d87a4 = 0x19;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d89ac;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d8a04 = sfx_flamer_fire_01;
  uVar5 = 0xffffffff;
  pcVar7 = &DAT_004793f4;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d89f0 = 0x3c;
  _DAT_004d89f4 = 0x3ca3d70a;
  _DAT_004d89f8 = 0x40400000;
  _DAT_004d89fc = 0x3e3851ec;
  _DAT_004d89a8 = 4;
  _DAT_004d8a0c = _DAT_004d86a8;
  _DAT_004d8a10 = 0x1d;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8a28;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d8a80 = sfx_shock_fire_alt;
  uVar5 = 0xffffffff;
  _DAT_004d8a6c = 0xc;
  _DAT_004d8a70 = 0x3f333333;
  _DAT_004d8a74 = 0x40000000;
  _DAT_004d8a78 = 0x3ec28f5c;
  _DAT_004d8a24 = 4;
  _DAT_004d8a88 = _DAT_004d86a8;
  _DAT_004d8a8c = 0x1e;
  pcVar7 = s_Splitter_Gun_004793e4;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8838;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d8890 = sfx_shock_fire_alt;
  uVar5 = 0xffffffff;
  pcVar7 = s_Shrinkifier_5k_004793d4;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d887c = 6;
  _DAT_004d8880 = 0x3f333333;
  _DAT_004d8884 = 0x400ccccd;
  _DAT_004d8888 = 0x3e8f5c29;
  _DAT_004d8834 = 0;
  _DAT_004d8898 = _DAT_004d86a8;
  _DAT_004d88a8 = 0x40c00000;
  _DAT_004d88a4 = 0x41f00000;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d85cc;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d8624 = sfx_shock_fire_alt;
  uVar5 = 0xffffffff;
  pcVar7 = s_Blade_Gun_004793c8;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8634 = 8;
  _DAT_004d8610 = 8;
  _DAT_004d8614 = 0x3e570a3d;
  _DAT_004d8618 = 0x3f9c28f6;
  _DAT_004d861c = 0x3d23d70a;
  _DAT_004d862c = _DAT_004d86a8;
  _DAT_004d8630 = 0x17;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8648;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d86a0 = sfx_shock_fire_alt;
  uVar5 = 0xffffffff;
  pcVar7 = s_Plague_Sphreader_Gun_004793b0;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d86b0 = 8;
  _DAT_004d868c = 6;
  _DAT_004d8690 = 0x3eb33333;
  _DAT_004d8694 = 0x40600000;
  _DAT_004d8698 = 0x3d23d70a;
  _DAT_004d86ac = 0x18;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8e08;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; _DAT_004d92bc = sfx_bloodspill_01, uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d8e70 = 8;
  uVar5 = 0xffffffff;
  pcVar7 = s_Rainbow_Gun_004793a4;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8e4c = 5;
  _DAT_004d8e50 = 0x3e4ccccd;
  _DAT_004d8e54 = 0x3f99999a;
  _DAT_004d8e58 = 0x3d23d70a;
  _DAT_004d8e60 = sfx_bloodspill_01;
  _DAT_004d8e68 = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8f00;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  uVar5 = 0xffffffff;
  pcVar7 = s_Grim_Weapon_00479398;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8f68 = 8;
  _DAT_004d8f44 = 10;
  _DAT_004d8f48 = 0x3e4ccccd;
  _DAT_004d8f4c = 0x3f99999a;
  _DAT_004d8f50 = 0x3db851ec;
  _DAT_004d8f58 = _DAT_004d92bc;
  _DAT_004d8f60 = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8f7c;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  uVar5 = 0xffffffff;
  pcVar7 = s_Bubblegun_0047938c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8fc0 = 3;
  _DAT_004d8fc4 = 0x3f000000;
  _DAT_004d8fc8 = 0x3f99999a;
  _DAT_004d8fcc = 0x3ecccccd;
  _DAT_004d8fd4 = _DAT_004d92bc;
  _DAT_004d8fdc = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d8e84;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  uVar5 = 0xffffffff;
  pcVar7 = s_Spider_Plasma_0047937c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d8eec = 8;
  _DAT_004d8ec8 = 0xf;
  _DAT_004d8ecc = 0x3e252bd4;
  _DAT_004d8ed0 = 0x3f99999a;
  _DAT_004d8ed4 = 0x3d4ccccd;
  _DAT_004d8edc = _DAT_004d92bc;
  _DAT_004d8ee4 = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d86c4;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  uVar5 = 0xffffffff;
  pcVar7 = s_Transmutator_0047936c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d872c = 8;
  _DAT_004d8708 = 5;
  _DAT_004d870c = 0x3e4ccccd;
  _DAT_004d8710 = 0x3f99999a;
  _DAT_004d8714 = 0x3d23d70a;
  _DAT_004d871c = _DAT_004d92bc;
  _DAT_004d8724 = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d9264;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; _DAT_004d93b4 = sfx_explosion_large, uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  uVar5 = 0xffffffff;
  pcVar7 = s_Blaster_R_300_0047935c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d92cc = 9;
  _DAT_004d92a8 = 0x32;
  _DAT_004d92ac = 0x3d23d70a;
  _DAT_004d92b0 = 0x40a00000;
  _DAT_004d92b4 = 0x3d23d70a;
  _DAT_004d92c4 = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d92e0;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d9338 = sfx_shock_fire;
  uVar5 = 0xffffffff;
  pcVar7 = s_Nuke_Launcher_0047934c;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d9348 = 9;
  _DAT_004d9324 = 0x14;
  _DAT_004d9328 = 0x3da3d70a;
  _DAT_004d932c = 0x40000000;
  _DAT_004d9330 = 0x3d4ccccd;
  _DAT_004d9340 = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d93d8;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  uVar5 = 0xffffffff;
  pcVar7 = s___Lighting_Rifle_0047933a + 2;
  do {
    pcVar8 = pcVar7;
    if (uVar5 == 0) break;
    uVar5 = uVar5 - 1;
    pcVar8 = pcVar7 + 1;
    cVar2 = *pcVar7;
    pcVar7 = pcVar8;
  } while (cVar2 != '\0');
  uVar5 = ~uVar5;
  _DAT_004d9440 = 8;
  _DAT_004d941c = 1;
  _DAT_004d9420 = 0x40800000;
  _DAT_004d9424 = 0x41000000;
  _DAT_004d9428 = 0x3f800000;
  _DAT_004d9430 = _DAT_004d93b4;
  _DAT_004d9438 = _DAT_004d93bc;
  pcVar7 = pcVar8 + -uVar5;
  pcVar8 = (char *)&DAT_004d935c;
  for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar8 = *(undefined4 *)pcVar7;
    pcVar7 = pcVar7 + 4;
    pcVar8 = pcVar8 + 4;
  }
  for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar8 = *pcVar7;
    pcVar7 = pcVar7 + 1;
    pcVar8 = pcVar8 + 1;
  }
  _DAT_004d93c4 = 8;
  _DAT_004d93a0 = 500;
  _DAT_004d93a4 = 0x40800000;
  _DAT_004d93a8 = 0x41000000;
  _DAT_004d93ac = 0x3f800000;
  return;
}



/* weapon_pick_random_available @ 00452cd0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* selects a random weapon id that is marked available */

int weapon_pick_random_available(void)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  
  do {
    iVar1 = crt_rand();
    iVar3 = iVar1 % 0x21 + 1;
    if (game_status_blob.weapon_usage_counts[iVar1 % 0x21 + 1] != 0) {
      uVar2 = crt_rand();
      if ((uVar2 & 1) == 0) {
        iVar1 = crt_rand();
        iVar3 = iVar1 % 0x21 + 1;
      }
    }
  } while (((&weapon_table)[iVar3].unlocked == '\0') ||
          ((((config_blob.reserved0._24_4_ == 3 && (_quest_stage_major == 5)) &&
            (_quest_stage_minor == 10)) && (iVar3 == 0x17))));
  return iVar3;
}



/* weapon_assign_player @ 00452d40 */

/* assigns a weapon to a player and resets ammo timers */

void __cdecl weapon_assign_player(int player_index,int weapon_id)

{
  float sfx_id;
  player_state_t *ppVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  
  iVar2 = weapon_id;
  if (demo_mode_active == '\0') {
    game_status_blob.weapon_usage_counts[weapon_id] =
         game_status_blob.weapon_usage_counts[weapon_id] + 1;
  }
  *(int *)((&player_health)[player_index]._pad0 + 0x29c) = weapon_id;
  iVar3 = perk_id_ammo_maniac;
  *(float *)((&player_health)[player_index]._pad0 + 0x2a0) =
       (float)(&weapon_table)[weapon_id].clip_size;
  iVar3 = perk_count_get(iVar3);
  if (iVar3 != 0) {
    lVar4 = __ftol();
    weapon_id = (int)lVar4;
    if (weapon_id < 2) {
      weapon_id = 1;
    }
    *(float *)((&player_health)[player_index]._pad0 + 0x2a0) =
         (float)weapon_id + *(float *)((&player_health)[player_index]._pad0 + 0x2a0);
  }
  iVar3 = perk_count_get(perk_id_my_favourite_weapon);
  if (iVar3 != 0) {
    *(float *)((&player_health)[player_index]._pad0 + 0x2a0) =
         *(float *)((&player_health)[player_index]._pad0 + 0x2a0) + 2.0;
  }
  sfx_id = (float)(&weapon_table)[iVar2].reload_sfx_id;
  *(undefined4 *)((&player_health)[player_index]._pad0 + 0x2a8) =
       *(undefined4 *)((&player_health)[player_index]._pad0 + 0x2a0);
  ppVar1 = &player_health + player_index;
  ppVar1->_pad0[0x3c] = '\0';
  ppVar1->_pad0[0x3d] = '\0';
  ppVar1->_pad0[0x3e] = '\0';
  ppVar1->_pad0[0x3f] = '\0';
  ppVar1 = &player_health + player_index;
  ppVar1->_pad0[0x2b0] = '\0';
  ppVar1->_pad0[0x2b1] = '\0';
  ppVar1->_pad0[0x2b2] = '\0';
  ppVar1->_pad0[0x2b3] = '\0';
  ppVar1 = &player_health + player_index;
  ppVar1->_pad0[0x2ac] = '\0';
  ppVar1->_pad0[0x2ad] = '\0';
  ppVar1->_pad0[0x2ae] = '\0';
  ppVar1->_pad0[0x2af] = '\0';
  (&DAT_004871d0)[player_index] = 0x40000000;
  sfx_play_panned(sfx_id);
  return;
}



/* weapon_refresh_available @ 00452e40 */

/* rebuilds availability flags from the unlock list */

void weapon_refresh_available(void)

{
  int iVar1;
  uchar *puVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  
  puVar2 = &weapon_table.unlocked;
  do {
    *puVar2 = '\0';
    iVar3 = quest_unlock_index;
    puVar2 = puVar2 + 0x7c;
  } while ((int)puVar2 < 0x4d996c);
  iVar5 = 0;
  DAT_004d7ae8 = 1;
  if (0 < quest_unlock_index) {
    piVar4 = &quest_unlock_weapon_id;
    do {
      if (0x484feb < (int)piVar4) break;
      iVar1 = *piVar4;
      piVar4 = piVar4 + 0xb;
      iVar5 = iVar5 + 1;
      (&weapon_table)[iVar1].unlocked = '\x01';
    } while (iVar5 < iVar3);
  }
  if (config_blob.reserved0._24_4_ == 1) {
    DAT_004d7b64 = 1;
    DAT_004d7be0 = 1;
    DAT_004d7cd8 = 1;
  }
  iVar3 = game_is_full_version();
  if ((uchar)iVar3 == '\0') {
    quest_unlock_index_full = 0;
    weapon_table.unlocked = (uchar)iVar3;
    return;
  }
  if (0x27 < quest_unlock_index_full) {
    DAT_004d8878 = 1;
  }
  weapon_table.unlocked = '\0';
  return;
}



/* float_near_equal @ 00452ef0 */

/* returns 1 when |a-b| < 1.1920929e-07 (FLT_EPSILON) */

int __cdecl float_near_equal(float a,float b)

{
  float fVar1;
  
  fVar1 = a - b;
  if ((!NAN(fVar1) && -1.1920929e-07 < fVar1 != (fVar1 == -1.1920929e-07)) &&
     (fVar1 < 1.1920929e-07 != (fVar1 == 1.1920929e-07))) {
    return 1;
  }
  return 0;
}



/* FUN_00452f1d @ 00452f1d */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_452f1d() */

int FUN_00452f1d(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x00452f24. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*_DAT_00479658)();
  return iVar1;
}



/* FUN_00452f30 @ 00452f30 */

void FUN_00452f30(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,undefined4 param_6)

{
  renderer_select_backend(1);
  (*(code *)PTR_FUN_004795e4)(param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



/* FUN_00452f5a @ 00452f5a */

void FUN_00452f5a(float *param_1,float *param_2,float *param_3,float *param_4,float *param_5,
                 float param_6)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  
  fVar1 = param_6 * param_6;
  fVar2 = param_6 * fVar1;
  fVar5 = ((fVar2 + fVar2) - fVar1 * 3.0) + 1.0;
  fVar3 = (fVar2 - (fVar1 + fVar1)) + param_6;
  fVar4 = fVar1 * 3.0 - (fVar2 + fVar2);
  *param_1 = (fVar2 - fVar1) * *param_5 + fVar4 * *param_4 + fVar3 * *param_3 + fVar5 * *param_2;
  param_1[1] = fVar5 * param_2[1] +
               fVar3 * param_3[1] + fVar4 * param_4[1] + (fVar2 - fVar1) * param_5[1];
  return;
}



/* FUN_00452fe8 @ 00452fe8 */

void FUN_00452fe8(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,undefined4 param_6)

{
  renderer_select_backend(1);
  (*(code *)PTR_FUN_0047965c)(param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



/* FUN_00453012 @ 00453012 */

void FUN_00453012(float *param_1,float *param_2,float *param_3,float *param_4,float *param_5,
                 float param_6)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  
  fVar1 = param_6 * param_6;
  fVar2 = param_6 * fVar1;
  fVar5 = (fVar1 * 2.0 - fVar2) - param_6;
  fVar4 = (fVar2 * 3.0 - fVar1 * 5.0) + 2.0;
  fVar3 = (fVar1 * 4.0 - fVar2 * 3.0) + param_6;
  *param_1 = ((fVar2 - fVar1) * *param_5 + fVar3 * *param_4 + fVar4 * *param_3 + fVar5 * *param_2) *
             0.5;
  param_1[1] = (fVar5 * param_2[1] +
               fVar4 * param_3[1] + fVar3 * param_4[1] + (fVar2 - fVar1) * param_5[1]) * 0.5;
  return;
}



/* FUN_004530c1 @ 004530c1 */

void FUN_004530c1(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,undefined4 param_6)

{
  renderer_select_backend(1);
  (*(code *)PTR_FUN_00479660)(param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



/* FUN_004530f0 @ 004530f0 */

void FUN_004530f0(float *param_1,float *param_2,float *param_3,float *param_4,float param_5,
                 float param_6)

{
  *param_1 = (*param_4 - *param_2) * param_6 + (*param_3 - *param_2) * param_5 + *param_2;
  param_1[1] = (param_4[1] - param_2[1]) * param_6 + (param_3[1] - param_2[1]) * param_5 +
               param_2[1];
  return;
}



/* FUN_0045315a @ 0045315a */

/* [binja] int32_t sub_45315a() */

int FUN_0045315a(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x00453161. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*(code *)PTR_FUN_004795bc)();
  return iVar1;
}



/* FUN_00453197 @ 00453197 */

void FUN_00453197(float *param_1,float *param_2,float *param_3,float *param_4,float *param_5,
                 float param_6)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  
  fVar1 = param_6 * param_6;
  fVar2 = param_6 * fVar1;
  fVar5 = ((fVar2 + fVar2) - fVar1 * 3.0) + 1.0;
  fVar3 = (fVar2 - (fVar1 + fVar1)) + param_6;
  fVar4 = fVar1 * 3.0 - (fVar2 + fVar2);
  fVar2 = fVar2 - fVar1;
  *param_1 = fVar2 * *param_5 + fVar4 * *param_4 + fVar3 * *param_3 + fVar5 * *param_2;
  param_1[1] = fVar5 * param_2[1] + fVar3 * param_3[1] + fVar4 * param_4[1] + fVar2 * param_5[1];
  param_1[2] = fVar5 * param_2[2] + fVar3 * param_3[2] + fVar4 * param_4[2] + fVar2 * param_5[2];
  return;
}



/* FUN_00453245 @ 00453245 */

void FUN_00453245(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,undefined4 param_6)

{
  renderer_select_backend(1);
  (*(code *)PTR_FUN_00479668)(param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



/* FUN_0045326f @ 0045326f */

void FUN_0045326f(float *param_1,float *param_2,float *param_3,float *param_4,float *param_5,
                 float param_6)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  
  fVar1 = param_6 * param_6;
  fVar2 = param_6 * fVar1;
  fVar5 = (fVar1 * 2.0 - fVar2) - param_6;
  fVar4 = (fVar2 * 3.0 - fVar1 * 5.0) + 2.0;
  fVar3 = (fVar1 * 4.0 - fVar2 * 3.0) + param_6;
  fVar2 = fVar2 - fVar1;
  *param_1 = (fVar2 * *param_5 + fVar3 * *param_4 + fVar4 * *param_3 + fVar5 * *param_2) * 0.5;
  param_1[1] = (fVar5 * param_2[1] + fVar4 * param_3[1] + fVar3 * param_4[1] + fVar2 * param_5[1]) *
               0.5;
  param_1[2] = (fVar5 * param_2[2] + fVar4 * param_3[2] + fVar3 * param_4[2] + fVar2 * param_5[2]) *
               0.5;
  return;
}



/* FUN_00453340 @ 00453340 */

void FUN_00453340(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,undefined4 param_6)

{
  renderer_select_backend(1);
  (*(code *)PTR_FUN_0047966c)(param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



/* FUN_0045336f @ 0045336f */

void FUN_0045336f(float *param_1,float *param_2,float *param_3,float *param_4,float param_5,
                 float param_6)

{
  *param_1 = (*param_4 - *param_2) * param_6 + (*param_3 - *param_2) * param_5 + *param_2;
  param_1[1] = (param_4[1] - param_2[1]) * param_6 + (param_3[1] - param_2[1]) * param_5 +
               param_2[1];
  param_1[2] = (param_4[2] - param_2[2]) * param_6 + (param_3[2] - param_2[2]) * param_5 +
               param_2[2];
  return;
}



/* FUN_00453464 @ 00453464 */

/* [binja] int32_t sub_453464() */

int FUN_00453464(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x0045346b. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*(code *)PTR_FUN_004795c8)();
  return iVar1;
}



/* FUN_004534ea @ 004534ea */

/* [binja] int32_t sub_4534ea() */

int FUN_004534ea(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x004534f5. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*(code *)PTR_FUN_004795d8)();
  return iVar1;
}



/* FUN_00453640 @ 00453640 */

void FUN_00453640(float *param_1,float *param_2,float *param_3,float *param_4,float *param_5,
                 float param_6)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  
  fVar1 = param_6 * param_6;
  fVar2 = param_6 * fVar1;
  fVar5 = ((fVar2 + fVar2) - fVar1 * 3.0) + 1.0;
  fVar4 = (fVar2 - (fVar1 + fVar1)) + param_6;
  fVar3 = fVar1 * 3.0 - (fVar2 + fVar2);
  fVar2 = fVar2 - fVar1;
  *param_1 = fVar2 * *param_5 + fVar3 * *param_4 + fVar4 * *param_3 + fVar5 * *param_2;
  param_1[1] = fVar5 * param_2[1] + fVar4 * param_3[1] + fVar3 * param_4[1] + fVar2 * param_5[1];
  param_1[2] = fVar5 * param_2[2] + fVar4 * param_3[2] + fVar3 * param_4[2] + fVar2 * param_5[2];
  param_1[3] = fVar5 * param_2[3] + fVar4 * param_3[3] + fVar3 * param_4[3] + fVar2 * param_5[3];
  return;
}



/* FUN_00453711 @ 00453711 */

void FUN_00453711(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,undefined4 param_6)

{
  renderer_select_backend(1);
  (*(code *)PTR_FUN_00479674)(param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



/* FUN_0045373b @ 0045373b */

void FUN_0045373b(float *param_1,float *param_2,float *param_3,float *param_4,float *param_5,
                 float param_6)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  
  fVar1 = param_6 * param_6;
  fVar2 = param_6 * fVar1;
  fVar5 = (fVar1 * 2.0 - fVar2) - param_6;
  fVar4 = (fVar2 * 3.0 - fVar1 * 5.0) + 2.0;
  fVar3 = (fVar1 * 4.0 - fVar2 * 3.0) + param_6;
  fVar2 = fVar2 - fVar1;
  *param_1 = (fVar2 * *param_5 + fVar3 * *param_4 + fVar4 * *param_3 + fVar5 * *param_2) * 0.5;
  param_1[1] = (fVar5 * param_2[1] + fVar4 * param_3[1] + fVar3 * param_4[1] + fVar2 * param_5[1]) *
               0.5;
  param_1[2] = (fVar5 * param_2[2] + fVar4 * param_3[2] + fVar3 * param_4[2] + fVar2 * param_5[2]) *
               0.5;
  param_1[3] = (fVar5 * param_2[3] + fVar4 * param_3[3] + fVar3 * param_4[3] + fVar2 * param_5[3]) *
               0.5;
  return;
}



/* FUN_0045382e @ 0045382e */

void FUN_0045382e(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,undefined4 param_6)

{
  renderer_select_backend(1);
  (*(code *)PTR_FUN_00479678)(param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



/* FUN_0045385d @ 0045385d */

void FUN_0045385d(float *param_1,float *param_2,float *param_3,float *param_4,float param_5,
                 float param_6)

{
  *param_1 = (*param_4 - *param_2) * param_6 + (*param_3 - *param_2) * param_5 + *param_2;
  param_1[1] = (param_4[1] - param_2[1]) * param_6 + (param_3[1] - param_2[1]) * param_5 +
               param_2[1];
  param_1[2] = (param_4[2] - param_2[2]) * param_6 + (param_3[2] - param_2[2]) * param_5 +
               param_2[2];
  param_1[3] = (param_4[3] - param_2[3]) * param_6 + (param_3[3] - param_2[3]) * param_5 +
               param_2[3];
  return;
}



/* FUN_00453a57 @ 00453a57 */

/* [binja] int32_t sub_453a57() */

int FUN_00453a57(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x00453a5e. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*(code *)PTR_FUN_004795ac)();
  return iVar1;
}



/* FUN_00453ca0 @ 00453ca0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_453ca0() */

int FUN_00453ca0(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x00453ca7. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*_DAT_00479634)();
  return iVar1;
}



/* FUN_00453f63 @ 00453f63 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_453f63() */

int FUN_00453f63(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x00453f6a. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*_DAT_004795e8)();
  return iVar1;
}



/* FUN_00454303 @ 00454303 */

/* [binja] int32_t __stdcall sub_454303(float arg1, float arg2, float arg3); wrapper calls
   PTR_FUN_00479624 (idx 0x21) */

float * FUN_00454303(float *arg1,float arg2,float arg3,float arg4)

{
  float *pfVar1;
  
  renderer_select_backend(1);
  pfVar1 = (float *)(*(code *)PTR_FUN_00479624)(arg1,arg2,arg3,arg4);
  return pfVar1;
}



/* FUN_0045438d @ 0045438d */

/* [binja] int32_t __stdcall sub_45438d(float arg1, float arg2, float arg3); wrapper calls
   PTR_FUN_00479608 (idx 0x1a) */

float * FUN_0045438d(float *arg1,float arg2,float arg3,float arg4)

{
  float *pfVar1;
  
  renderer_select_backend(1);
  pfVar1 = (float *)(*(code *)PTR_FUN_00479608)(arg1,arg2,arg3,arg4);
  return pfVar1;
}



/* FUN_00454417 @ 00454417 */

/* [binja] int32_t __stdcall sub_454417(float arg1); wrapper calls PTR_FUN_00479618 (idx 0x1e) */

float * FUN_00454417(float *arg1,float arg2)

{
  float *pfVar1;
  
  renderer_select_backend(1);
  pfVar1 = (float *)(*(code *)PTR_FUN_00479618)(arg1,arg2);
  return pfVar1;
}



/* FUN_00454433 @ 00454433 */

/* [binja] float* __stdcall sub_454433(float* arg1, float arg2) */

float * FUN_00454433(float *arg1,float arg2)

{
  float10 fVar1;
  float10 fVar2;
  
  fVar1 = (float10)fcos((float10)arg2);
  fVar2 = (float10)fsin((float10)arg2);
  *arg1 = 1.0;
  arg1[1] = 0.0;
  arg1[6] = (float)fVar2;
  arg1[2] = 0.0;
  arg1[3] = 0.0;
  arg1[4] = 0.0;
  arg1[5] = (float)fVar1;
  arg1[7] = 0.0;
  arg1[8] = 0.0;
  arg1[9] = -(float)fVar2;
  arg1[10] = (float)fVar1;
  arg1[0xb] = 0.0;
  arg1[0xc] = 0.0;
  arg1[0xd] = 0.0;
  arg1[0xe] = 0.0;
  arg1[0xf] = 1.0;
  return arg1;
}



/* FUN_004544ad @ 004544ad */

/* [binja] int32_t __stdcall sub_4544ad(float arg1); wrapper calls PTR_FUN_0047961c (idx 0x1f) */

float * FUN_004544ad(float *arg1,float arg2)

{
  float *pfVar1;
  
  renderer_select_backend(1);
  pfVar1 = (float *)(*(code *)PTR_FUN_0047961c)(arg1,arg2);
  return pfVar1;
}



/* FUN_004544c9 @ 004544c9 */

/* [binja] float* __stdcall sub_4544c9(float* arg1, float arg2) */

float * FUN_004544c9(float *arg1,float arg2)

{
  float10 fVar1;
  float10 fVar2;
  
  fVar1 = (float10)fcos((float10)arg2);
  fVar2 = (float10)fsin((float10)arg2);
  *arg1 = (float)fVar1;
  arg1[1] = 0.0;
  arg1[2] = -(float)fVar2;
  arg1[3] = 0.0;
  arg1[4] = 0.0;
  arg1[5] = 1.0;
  arg1[6] = 0.0;
  arg1[7] = 0.0;
  arg1[8] = (float)fVar2;
  arg1[9] = 0.0;
  arg1[10] = (float)fVar1;
  arg1[0xb] = 0.0;
  arg1[0xc] = 0.0;
  arg1[0xd] = 0.0;
  arg1[0xe] = 0.0;
  arg1[0xf] = 1.0;
  return arg1;
}



/* FUN_00454544 @ 00454544 */

/* [binja] int32_t __stdcall sub_454544(float arg1); wrapper calls PTR_FUN_00479620 (idx 0x20) */

float * FUN_00454544(float *arg1,float arg2)

{
  float *pfVar1;
  
  renderer_select_backend(1);
  pfVar1 = (float *)(*(code *)PTR_FUN_00479620)(arg1,arg2);
  return pfVar1;
}



/* FUN_00454560 @ 00454560 */

/* [binja] float* __stdcall sub_454560(float* arg1, float arg2) */

float * FUN_00454560(float *arg1,float arg2)

{
  float10 fVar1;
  float10 fVar2;
  
  fVar1 = (float10)fcos((float10)arg2);
  fVar2 = (float10)fsin((float10)arg2);
  *arg1 = (float)fVar1;
  arg1[1] = (float)fVar2;
  arg1[2] = 0.0;
  arg1[3] = 0.0;
  arg1[4] = -(float)fVar2;
  arg1[5] = (float)fVar1;
  arg1[6] = 0.0;
  arg1[7] = 0.0;
  arg1[8] = 0.0;
  arg1[9] = 0.0;
  arg1[10] = 1.0;
  arg1[0xb] = 0.0;
  arg1[0xc] = 0.0;
  arg1[0xd] = 0.0;
  arg1[0xe] = 0.0;
  arg1[0xf] = 1.0;
  return arg1;
}



/* FUN_004545dc @ 004545dc */

/* [binja] int32_t __stdcall sub_4545dc(int arg1, float arg2); wrapper calls PTR_FUN_00479648 (idx
   0x2a) */

float * FUN_004545dc(float *arg1,float *arg2,float arg3)

{
  float *pfVar1;
  
  renderer_select_backend(1);
  pfVar1 = (float *)(*(code *)PTR_FUN_00479648)(arg1,arg2,arg3);
  return pfVar1;
}



/* FUN_004545fc @ 004545fc */

/* [binja] float* __stdcall sub_4545fc(float* arg1, float arg2, float arg3) */

float * FUN_004545fc(float *arg1,float arg2,float arg3)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  float10 fVar6;
  float fVar7;
  float fVar8;
  float fVar9;
  float fVar10;
  float10 fVar11;
  
  fVar6 = (float10)fcos((float10)arg3);
  fVar11 = (float10)fsin((float10)arg3);
  fVar1 = (float)fVar6;
  fVar2 = (float)fVar11;
  fVar7 = 1.0 - fVar1;
  fVar3 = *(float *)arg2;
  fVar4 = *(float *)((int)arg2 + 4);
  fVar5 = *(float *)((int)arg2 + 8);
  thunk_FUN_0045315a();
  fVar8 = fVar4 * fVar3 * fVar7;
  fVar9 = fVar4 * fVar5 * fVar7;
  fVar10 = fVar5 * fVar3 * fVar7;
  *arg1 = fVar3 * fVar3 * fVar7 + fVar1;
  arg1[1] = fVar8 + fVar5 * fVar2;
  arg1[2] = fVar10 - fVar4 * fVar2;
  arg1[3] = 0.0;
  arg1[4] = fVar8 - fVar5 * fVar2;
  arg1[5] = fVar4 * fVar4 * fVar7 + fVar1;
  arg1[6] = fVar3 * fVar2 + fVar9;
  arg1[7] = 0.0;
  arg1[8] = fVar4 * fVar2 + fVar10;
  arg1[9] = fVar9 - fVar3 * fVar2;
  arg1[10] = fVar5 * fVar5 * fVar7 + fVar1;
  arg1[0xb] = 0.0;
  arg1[0xc] = 0.0;
  arg1[0xd] = 0.0;
  arg1[0xe] = 0.0;
  arg1[0xf] = 1.0;
  return arg1;
}



/* FUN_004546fe @ 004546fe */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_4546fe() */

int FUN_004546fe(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x00454705. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*_DAT_00479638)();
  return iVar1;
}



/* FUN_004547f3 @ 004547f3 */

/* [binja] int32_t __stdcall sub_4547f3(float arg1, float arg2, float arg3); wrapper calls
   PTR_FUN_00479640 (idx 0x28) */

float * FUN_004547f3(float *arg1,float arg2,float arg3,float arg4)

{
  float *pfVar1;
  
  renderer_select_backend(1);
  pfVar1 = (float *)(*(code *)PTR_FUN_00479640)(arg1,arg2,arg3,arg4);
  return pfVar1;
}



/* FUN_00454821 @ 00454821 */

/* [binja] int32_t sub_454821() */

int FUN_00454821(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x0045482c. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*(code *)PTR_FUN_0047963c)();
  return iVar1;
}



/* FUN_00454832 @ 00454832 */

void FUN_00454832(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5)

{
  renderer_select_backend(1);
  (*(code *)PTR_FUN_00479644)(param_1,param_2,param_3,param_4,param_5);
  return;
}



/* FUN_00454859 @ 00454859 */

undefined4 *
FUN_00454859(undefined4 *param_1,undefined4 param_2,float *param_3,int param_4,float *param_5)

{
  param_1[0xe] = 0;
  param_1[0xd] = 0;
  param_1[0xc] = 0;
  param_1[0xb] = 0;
  param_1[9] = 0;
  param_1[8] = 0;
  param_1[7] = 0;
  param_1[6] = 0;
  param_1[4] = 0;
  param_1[3] = 0;
  param_1[2] = 0;
  param_1[1] = 0;
  *param_1 = param_2;
  param_1[5] = param_2;
  param_1[10] = param_2;
  param_1[0xf] = 0x3f800000;
  if (param_4 != 0) {
    thunk_FUN_004546fe();
    if (param_3 == (float *)0x0) {
      thunk_FUN_00453a57();
    }
    else {
      param_1[0xc] = (float)param_1[0xc] - *param_3;
      param_1[0xd] = (float)param_1[0xd] - param_3[1];
      param_1[0xe] = (float)param_1[0xe] - param_3[2];
      thunk_FUN_00453a57();
      param_1[0xc] = *param_3 + (float)param_1[0xc];
      param_1[0xd] = (float)param_1[0xd] + param_3[1];
      param_1[0xe] = param_3[2] + (float)param_1[0xe];
    }
  }
  if (param_5 != (float *)0x0) {
    param_1[0xc] = *param_5 + (float)param_1[0xc];
    param_1[0xd] = param_5[1] + (float)param_1[0xd];
    param_1[0xe] = param_5[2] + (float)param_1[0xe];
  }
  return param_1;
}



/* FUN_00454b44 @ 00454b44 */

/* [binja] int32_t __stdcall sub_454b44(int arg1, float arg2); wrapper calls PTR_FUN_00479614 (idx
   0x1d) */

float * FUN_00454b44(float *arg1,float *arg2,float arg3)

{
  float *pfVar1;
  
  renderer_select_backend(1);
  pfVar1 = (float *)(*(code *)PTR_FUN_00479614)(arg1,arg2,arg3);
  return pfVar1;
}



/* FUN_00454b64 @ 00454b64 */

/* [binja] float* __stdcall sub_454b64(float arg1, float arg2, float arg3) */

float * FUN_00454b64(float arg1,float arg2,float arg3)

{
  float fVar1;
  float10 fVar2;
  float10 fVar3;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  
  thunk_FUN_0045315a();
  fVar2 = (float10)fcos((float10)(arg3 * 0.5));
  fVar3 = (float10)fsin((float10)(arg3 * 0.5));
  *(float *)((int)arg1 + 0xc) = (float)fVar2;
  fVar1 = (float)fVar3;
  *(float *)arg1 = local_18 * fVar1;
  *(float *)((int)arg1 + 4) = local_14 * fVar1;
  *(float *)((int)arg1 + 8) = local_10 * fVar1;
  return (float *)arg1;
}



/* FUN_00454bc0 @ 00454bc0 */

/* [binja] int32_t __stdcall sub_454bc0(float arg1, float arg2, float arg3); wrapper calls
   PTR_FUN_00479604 (idx 0x19) */

float * FUN_00454bc0(float *arg1,float arg2,float arg3,float arg4)

{
  float *pfVar1;
  
  renderer_select_backend(1);
  pfVar1 = (float *)(*(code *)PTR_FUN_00479604)(arg1,arg2,arg3,arg4);
  return pfVar1;
}



/* FUN_00454ccd @ 00454ccd */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_454ccd() */

int FUN_00454ccd(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x00454cd4. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*_DAT_004795ec)();
  return iVar1;
}



/* FUN_00454e3c @ 00454e3c */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_454e3c() */

int FUN_00454e3c(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x00454e43. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*_DAT_00479650)();
  return iVar1;
}



/* FUN_00454f03 @ 00454f03 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_454f03() */

int FUN_00454f03(void)

{
  int iVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00454f03. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*_DAT_0047967c)();
  return iVar1;
}



/* FUN_00454f87 @ 00454f87 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_454f87() */

int FUN_00454f87(void)

{
  int iVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00454f87. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*_DAT_00479680)();
  return iVar1;
}



/* FUN_00455028 @ 00455028 */

/* [binja] int32_t __stdcall sub_455028(int arg1, int arg2, float arg3); wrapper calls
   PTR_FUN_0047962c (idx 0x23) */

float * FUN_00455028(float *arg1,float *arg2,float *arg3,float arg4)

{
  float *pfVar1;
  
  renderer_select_backend(1);
  pfVar1 = (float *)(*(code *)PTR_FUN_0047962c)(arg1,arg2,arg3,arg4);
  return pfVar1;
}



/* FUN_00455135 @ 00455135 */

void FUN_00455135(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,undefined4 param_6)

{
  renderer_select_backend(1);
  (*(code *)PTR_FUN_0047964c)(param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



/* FUN_0045515f @ 0045515f */

float * FUN_0045515f(float *param_1,float *param_2,float *param_3,float *param_4,float *param_5,
                    float param_6)

{
  float fVar1;
  float local_24 [4];
  float local_14 [4];
  
  thunk_FUN_00455028(local_24,param_2,param_5,param_6);
  thunk_FUN_00455028(local_14,param_3,param_4,param_6);
  fVar1 = (1.0 - param_6) * param_6;
  thunk_FUN_00455028(param_1,local_24,local_14,fVar1 + fVar1);
  return param_1;
}



/* FUN_004551b6 @ 004551b6 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_4551b6() */

int FUN_004551b6(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x004551c1. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*_DAT_00479654)();
  return iVar1;
}



/* FUN_004551f6 @ 004551f6 */

undefined4 *
FUN_004551f6(undefined4 *param_1,undefined4 *param_2,float *param_3,float *param_4,float param_5,
            float param_6)

{
  float a;
  int iVar1;
  float local_24 [4];
  float local_14 [4];
  
  a = param_5 + param_6;
  iVar1 = float_near_equal(a,0.0);
  if (iVar1 == 0) {
    thunk_FUN_00455028(local_24,(float *)param_2,param_3,a);
    thunk_FUN_00455028(local_14,(float *)param_2,param_4,a);
    thunk_FUN_00455028((float *)param_1,local_24,local_14,param_6 / a);
  }
  else if (param_1 != param_2) {
    *param_1 = *param_2;
    param_1[1] = param_2[1];
    param_1[2] = param_2[2];
    param_1[3] = param_2[3];
  }
  return param_1;
}



/* FUN_00455281 @ 00455281 */

/* [binja] int32_t sub_455281() */

int FUN_00455281(void)

{
  int iVar1;
  
  renderer_select_backend(1);
                    /* WARNING: Could not recover jumptable at 0x00455288. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*(code *)PTR_FUN_004795f4)();
  return iVar1;
}



/* FUN_00455587 @ 00455587 */

/* [binja] int32_t* __stdcall sub_455587(int32_t* arg1, float arg2) */

int * FUN_00455587(int *arg1,float arg2)

{
  float a;
  int iVar1;
  float *extraout_ECX;
  float fVar2;
  
  a = *(float *)((int)arg2 + 4) * *(float *)((int)arg2 + 4) + *(float *)arg2 * *(float *)arg2;
  iVar1 = float_near_equal(a,1.0);
  if (iVar1 == 0) {
    if (a <= 1.1754944e-38) {
      *arg1 = 0;
      arg1[1] = 0;
      return arg1;
    }
    fVar2 = (1.0 / SQRT(a)) * extraout_ECX[1];
    *arg1 = (int)((1.0 / SQRT(a)) * *extraout_ECX);
  }
  else {
    if ((float *)arg1 == extraout_ECX) {
      return arg1;
    }
    *arg1 = (int)*extraout_ECX;
    fVar2 = extraout_ECX[1];
  }
  arg1[1] = (int)fVar2;
  return arg1;
}



/* FUN_00455614 @ 00455614 */

/* [binja] float* __stdcall sub_455614(float* arg1, float* arg2, float* arg3) */

float * FUN_00455614(float *arg1,float *arg2,float *arg3)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  float fVar6;
  float fVar7;
  float fVar8;
  float fVar9;
  float fVar10;
  float fVar11;
  float fVar12;
  float fVar13;
  float fVar14;
  float fVar15;
  
  fVar1 = arg3[1];
  fVar2 = *arg2;
  fVar3 = arg3[5];
  fVar4 = arg2[1];
  fVar5 = arg3[0xd];
  fVar6 = arg3[2];
  fVar7 = *arg2;
  fVar8 = arg3[6];
  fVar9 = arg2[1];
  fVar10 = arg3[0xe];
  fVar11 = arg3[3];
  fVar12 = *arg2;
  fVar13 = arg3[7];
  fVar14 = arg2[1];
  fVar15 = arg3[0xf];
  *arg1 = *arg2 * *arg3 + arg3[4] * arg2[1] + arg3[0xc];
  arg1[1] = fVar3 * fVar4 + fVar1 * fVar2 + fVar5;
  arg1[2] = fVar8 * fVar9 + fVar6 * fVar7 + fVar10;
  arg1[3] = fVar13 * fVar14 + fVar11 * fVar12 + fVar15;
  return arg1;
}



/* FUN_0045567f @ 0045567f */

/* [binja] float* __stdcall sub_45567f(float* arg1, float* arg2, float* arg3) */

float * FUN_0045567f(float *arg1,float *arg2,float *arg3)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  float fVar6;
  int iVar7;
  
  fVar1 = *arg2;
  fVar2 = arg3[1];
  fVar3 = arg2[1];
  fVar4 = arg3[5];
  fVar5 = arg3[0xd];
  fVar6 = arg3[0xf] + arg2[1] * arg3[7] + *arg2 * arg3[3];
  *arg1 = arg3[0xc] + arg2[1] * arg3[4] + *arg2 * *arg3;
  arg1[1] = fVar5 + fVar3 * fVar4 + fVar1 * fVar2;
  iVar7 = float_near_equal(fVar6,1.0);
  if (iVar7 == 0) {
    fVar6 = 1.0 / fVar6;
    *arg1 = fVar6 * *arg1;
    arg1[1] = fVar6 * arg1[1];
  }
  return arg1;
}



/* FUN_004556ff @ 004556ff */

/* [binja] float* __stdcall sub_4556ff(float* arg1, float* arg2, float* arg3) */

float * FUN_004556ff(float *arg1,float *arg2,float *arg3)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  
  fVar1 = arg3[1];
  fVar2 = *arg2;
  fVar3 = arg3[5];
  fVar4 = arg2[1];
  *arg1 = *arg2 * *arg3 + arg3[4] * arg2[1];
  arg1[1] = fVar3 * fVar4 + fVar1 * fVar2;
  return arg1;
}



/* FUN_0045573b @ 0045573b */

/* [binja] float* __stdcall sub_45573b(float* arg1, float arg2) */

float * FUN_0045573b(float *arg1,float arg2)

{
  float *pfVar1;
  float fVar2;
  int iVar3;
  float local_10;
  float local_c;
  float local_8;
  
  fVar2 = *(float *)((int)arg2 + 8) * *(float *)((int)arg2 + 8) +
          *(float *)((int)arg2 + 4) * *(float *)((int)arg2 + 4) + *(float *)arg2 * *(float *)arg2;
  iVar3 = float_near_equal(fVar2,1.0);
  if (iVar3 == 0) {
    if (fVar2 <= 1.1754944e-38) {
      *arg1 = 0.0;
      arg1[1] = 0.0;
      arg1[2] = 0.0;
      return arg1;
    }
    fVar2 = 1.0 / SQRT(fVar2);
    local_10 = fVar2 * *(float *)arg2;
    local_c = fVar2 * *(float *)((int)arg2 + 4);
    pfVar1 = (float *)((int)arg2 + 8);
    arg2 = (float)&local_10;
    local_8 = fVar2 * *pfVar1;
  }
  else if (arg1 == (float *)arg2) {
    return arg1;
  }
  *arg1 = *(float *)arg2;
  arg1[1] = *(float *)((int)arg2 + 4);
  arg1[2] = *(float *)((int)arg2 + 8);
  return arg1;
}



/* FUN_004557db @ 004557db */

/* [binja] float* __stdcall sub_4557db(float* arg1, float* arg2, float* arg3) */

float * FUN_004557db(float *arg1,float *arg2,float *arg3)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  float fVar6;
  float fVar7;
  float fVar8;
  float fVar9;
  float fVar10;
  float fVar11;
  float fVar12;
  float fVar13;
  float fVar14;
  float fVar15;
  int iVar16;
  
  fVar1 = *arg2;
  fVar2 = arg3[2];
  fVar3 = *arg2;
  fVar4 = arg3[1];
  fVar5 = arg2[1];
  fVar6 = arg3[6];
  fVar7 = arg2[1];
  fVar8 = arg3[5];
  fVar9 = arg2[2];
  fVar10 = arg3[10];
  fVar11 = arg2[2];
  fVar12 = arg3[9];
  fVar13 = arg3[0xd];
  fVar14 = arg3[0xe];
  fVar15 = arg3[0xf] + arg2[2] * arg3[0xb] + arg2[1] * arg3[7] + *arg2 * arg3[3];
  *arg1 = arg3[0xc] + arg2[2] * arg3[8] + arg2[1] * arg3[4] + *arg2 * *arg3;
  arg1[1] = fVar13 + fVar11 * fVar12 + fVar7 * fVar8 + fVar3 * fVar4;
  arg1[2] = fVar14 + fVar9 * fVar10 + fVar5 * fVar6 + fVar1 * fVar2;
  iVar16 = float_near_equal(fVar15,1.0);
  if (iVar16 == 0) {
    fVar15 = 1.0 / fVar15;
    *arg1 = fVar15 * *arg1;
    arg1[1] = fVar15 * arg1[1];
    arg1[2] = fVar15 * arg1[2];
  }
  return arg1;
}



/* FUN_0045589a @ 0045589a */

float * FUN_0045589a(float *param_1,undefined4 param_2,int *param_3,int param_4,int param_5,
                    int param_6)

{
  float fVar1;
  float fVar2;
  
  switch(((param_6 != 0) << 1 | param_5 != 0) << 1 | param_4 != 0) {
  case '\0':
    break;
  case '\x01':
    break;
  case '\x02':
    break;
  case '\x03':
    goto LAB_0045596b;
  case '\x04':
    break;
  case '\x05':
    goto LAB_0045596b;
  case '\x06':
    goto LAB_0045596b;
  case '\a':
    thunk_FUN_00453a57();
LAB_0045596b:
    thunk_FUN_00453a57();
  }
  thunk_FUN_00453464();
  if (param_3 != (int *)0x0) {
    fVar2 = (float)param_3[2];
    if (param_3[2] < 0) {
      fVar2 = fVar2 + 4.2949673e+09;
    }
    fVar1 = (float)*param_3;
    if (*param_3 < 0) {
      fVar1 = fVar1 + 4.2949673e+09;
    }
    *param_1 = fVar1 + fVar2 * (*param_1 + 1.0) * 0.5;
    fVar2 = (float)param_3[3];
    if (param_3[3] < 0) {
      fVar2 = fVar2 + 4.2949673e+09;
    }
    fVar1 = (float)param_3[1];
    if (param_3[1] < 0) {
      fVar1 = fVar1 + 4.2949673e+09;
    }
    param_1[1] = fVar1 + fVar2 * (1.0 - param_1[1]) * 0.5;
    param_1[2] = ((float)param_3[5] - (float)param_3[4]) * param_1[2] + (float)param_3[4];
  }
  return param_1;
}



/* FUN_00455a27 @ 00455a27 */

/* [binja] float* __stdcall sub_455a27(float* arg1, float* arg2, int32_t* arg3, int32_t* arg4,
   int32_t* arg5, int32_t* arg6) */

float * FUN_00455a27(float *arg1,float *arg2,int *arg3,int *arg4,int *arg5,int *arg6)

{
  float fVar1;
  float fVar2;
  
  switch(((arg6 != (int *)0x0) << 1 | arg5 != (int *)0x0) << 1 | arg4 != (int *)0x0) {
  case '\0':
    goto switchD_00455a64_default;
  case '\x01':
    goto LAB_00455b02;
  case '\x02':
    goto LAB_00455b02;
  case '\x03':
    break;
  case '\x04':
    goto LAB_00455b02;
  case '\x05':
    break;
  case '\x06':
    break;
  case '\a':
    thunk_FUN_00453a57();
    break;
  default:
    goto switchD_00455a64_default;
  }
  thunk_FUN_00453a57();
LAB_00455b02:
  thunk_FUN_00453f63();
switchD_00455a64_default:
  if (arg3 != (int *)0x0) {
    fVar1 = (float)*arg3;
    if (*arg3 < 0) {
      fVar1 = fVar1 + 4.2949673e+09;
    }
    fVar2 = (float)arg3[2];
    if (arg3[2] < 0) {
      fVar2 = fVar2 + 4.2949673e+09;
    }
    fVar2 = (*arg2 - fVar1) / fVar2;
    *arg1 = (fVar2 + fVar2) - 1.0;
    fVar1 = (float)arg3[1];
    if (arg3[1] < 0) {
      fVar1 = fVar1 + 4.2949673e+09;
    }
    fVar2 = (float)arg3[3];
    if (arg3[3] < 0) {
      fVar2 = fVar2 + 4.2949673e+09;
    }
    fVar2 = (arg2[1] - fVar1) / fVar2;
    arg1[1] = -((fVar2 + fVar2) - 1.0);
    arg1[2] = (arg2[2] - (float)arg3[4]) / ((float)arg3[5] - (float)arg3[4]);
  }
  thunk_FUN_00453464();
  return arg1;
}



/* FUN_00455bcd @ 00455bcd */

/* [binja] float* __stdcall sub_455bcd(float* arg1, float arg2) */

float * FUN_00455bcd(float *arg1,float arg2)

{
  float *pfVar1;
  float fVar2;
  int iVar3;
  float local_14;
  float local_10;
  float local_c;
  float local_8;
  
  fVar2 = *(float *)((int)arg2 + 0xc) * *(float *)((int)arg2 + 0xc) +
          *(float *)((int)arg2 + 8) * *(float *)((int)arg2 + 8) +
          *(float *)((int)arg2 + 4) * *(float *)((int)arg2 + 4) + *(float *)arg2 * *(float *)arg2;
  iVar3 = float_near_equal(fVar2,1.0);
  if (iVar3 == 0) {
    if (fVar2 <= 1.1754944e-38) {
      *arg1 = 0.0;
      arg1[1] = 0.0;
      arg1[2] = 0.0;
      arg1[3] = 0.0;
      return arg1;
    }
    fVar2 = 1.0 / SQRT(fVar2);
    local_14 = fVar2 * *(float *)arg2;
    local_10 = fVar2 * *(float *)((int)arg2 + 4);
    local_c = fVar2 * *(float *)((int)arg2 + 8);
    pfVar1 = (float *)((int)arg2 + 0xc);
    arg2 = (float)&local_14;
    local_8 = fVar2 * *pfVar1;
  }
  else if (arg1 == (float *)arg2) {
    return arg1;
  }
  *arg1 = *(float *)arg2;
  arg1[1] = *(float *)((int)arg2 + 4);
  arg1[2] = *(float *)((int)arg2 + 8);
  arg1[3] = *(float *)((int)arg2 + 0xc);
  return arg1;
}



/* FUN_00455c86 @ 00455c86 */

/* [binja] int32_t __stdcall sub_455c86(int32_t arg1, float arg2, float arg3, float arg4) */

int FUN_00455c86(int arg1,float arg2,float arg3,float arg4)

{
  float local_14 [4];
  
  thunk_FUN_00454bc0(local_14,arg2,arg3,arg4);
  thunk_FUN_004546fe();
  return arg1;
}



/* FUN_00455cbf @ 00455cbf */

undefined4 *
FUN_00455cbf(undefined4 *param_1,float *param_2,int param_3,undefined4 *param_4,float *param_5,
            int param_6,float *param_7)

{
  undefined4 uVar1;
  
  if (param_4 == (undefined4 *)0x0) {
    param_1[0xe] = 0;
    param_1[0xd] = 0;
    param_1[0xc] = 0;
    param_1[0xb] = 0;
    param_1[9] = 0;
    param_1[8] = 0;
    param_1[7] = 0;
    param_1[6] = 0;
    param_1[4] = 0;
    param_1[3] = 0;
    param_1[2] = 0;
    param_1[1] = 0;
    param_1[0xf] = 0x3f800000;
    param_1[10] = 0x3f800000;
    param_1[5] = 0x3f800000;
    *param_1 = 0x3f800000;
  }
  else if (param_3 == 0) {
    param_1[0xe] = 0;
    param_1[0xd] = 0;
    param_1[0xc] = 0;
    param_1[0xb] = 0;
    param_1[9] = 0;
    param_1[8] = 0;
    param_1[7] = 0;
    param_1[6] = 0;
    param_1[4] = 0;
    param_1[3] = 0;
    param_1[2] = 0;
    param_1[1] = 0;
    *param_1 = *param_4;
    param_1[5] = param_4[1];
    uVar1 = param_4[2];
    param_1[0xf] = 0x3f800000;
    param_1[10] = uVar1;
  }
  else {
    thunk_FUN_004546fe();
    if (param_2 == (float *)0x0) {
      thunk_FUN_00453ca0();
      thunk_FUN_00453a57();
      thunk_FUN_00453a57();
    }
    else {
      thunk_FUN_00453ca0();
      param_1[0xe] = 0;
      param_1[0xd] = 0;
      param_1[0xc] = 0;
      param_1[0xb] = 0;
      param_1[9] = 0;
      param_1[8] = 0;
      param_1[7] = 0;
      param_1[6] = 0;
      param_1[4] = 0;
      param_1[3] = 0;
      param_1[2] = 0;
      param_1[1] = 0;
      param_1[0xf] = 0x3f800000;
      param_1[10] = 0x3f800000;
      param_1[5] = 0x3f800000;
      *param_1 = 0x3f800000;
      param_1[0xc] = -*param_2;
      param_1[0xd] = -param_2[1];
      param_1[0xe] = -param_2[2];
      thunk_FUN_00453a57();
      thunk_FUN_00453a57();
      thunk_FUN_00453a57();
      param_1[0xc] = (float)param_1[0xc] + *param_2;
      param_1[0xd] = param_2[1] + (float)param_1[0xd];
      param_1[0xe] = (float)param_1[0xe] + param_2[2];
    }
  }
  if (param_6 != 0) {
    thunk_FUN_004546fe();
    if (param_5 == (float *)0x0) {
      thunk_FUN_00453a57();
    }
    else {
      param_1[0xc] = (float)param_1[0xc] - *param_5;
      param_1[0xd] = (float)param_1[0xd] - param_5[1];
      param_1[0xe] = (float)param_1[0xe] - param_5[2];
      thunk_FUN_00453a57();
      param_1[0xc] = (float)param_1[0xc] + *param_5;
      param_1[0xd] = (float)param_1[0xd] + param_5[1];
      param_1[0xe] = (float)param_1[0xe] + param_5[2];
    }
  }
  if (param_7 != (float *)0x0) {
    param_1[0xc] = (float)param_1[0xc] + *param_7;
    param_1[0xd] = param_7[1] + (float)param_1[0xd];
    param_1[0xe] = param_7[2] + (float)param_1[0xe];
  }
  return param_1;
}



/* FUN_00455f73 @ 00455f73 */

void FUN_00455f73(float *param_1,float *param_2)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  float local_14;
  float local_10;
  float local_c;
  float local_8;
  
  thunk_FUN_00455281();
  fVar1 = local_c * param_2[2] + local_8 * param_2[3] + local_14 * *param_2 + local_10 * param_2[1];
  fVar4 = -local_14;
  fVar3 = -local_10;
  fVar2 = -local_c;
  fVar5 = -local_8;
  *param_1 = fVar4 * *param_2 + fVar1;
  param_1[4] = fVar3 * *param_2;
  param_1[8] = fVar2 * *param_2;
  param_1[0xc] = fVar5 * *param_2;
  param_1[1] = fVar4 * param_2[1];
  param_1[5] = fVar3 * param_2[1] + fVar1;
  param_1[9] = fVar2 * param_2[1];
  param_1[0xd] = fVar5 * param_2[1];
  param_1[2] = fVar4 * param_2[2];
  param_1[6] = fVar3 * param_2[2];
  param_1[10] = fVar2 * param_2[2] + fVar1;
  param_1[0xe] = fVar5 * param_2[2];
  param_1[3] = fVar4 * param_2[3];
  param_1[7] = fVar3 * param_2[3];
  param_1[0xb] = fVar2 * param_2[3];
  param_1[0xf] = fVar5 * param_2[3] + fVar1;
  return;
}



/* FUN_0045604d @ 0045604d */

void FUN_0045604d(float *param_1)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float local_14;
  float local_10;
  float local_c;
  float local_8;
  
  thunk_FUN_00455281();
  fVar1 = local_14 * -2.0;
  fVar3 = local_10 * -2.0;
  fVar2 = local_c * -2.0;
  *param_1 = local_14 * fVar1 + 1.0;
  param_1[1] = fVar3 * local_14;
  param_1[2] = fVar2 * local_14;
  param_1[3] = 0.0;
  param_1[4] = local_10 * fVar1;
  param_1[5] = local_10 * fVar3 + 1.0;
  param_1[6] = fVar2 * local_10;
  param_1[7] = 0.0;
  param_1[8] = local_c * fVar1;
  param_1[9] = local_c * fVar3;
  param_1[10] = local_c * fVar2 + 1.0;
  param_1[0xb] = 0.0;
  param_1[0xc] = local_8 * fVar1;
  param_1[0xd] = local_8 * fVar3;
  param_1[0xe] = local_8 * fVar2;
  param_1[0xf] = 1.0;
  return;
}



/* FUN_004564e6 @ 004564e6 */

undefined4 __cdecl FUN_004564e6(DWORD param_1,LPCSTR param_2,LPBYTE param_3)

{
  LONG LVar1;
  DWORD local_c;
  HKEY local_8;
  
  local_8 = (HKEY)0x0;
  LVar1 = RegOpenKeyA((HKEY)0x80000002,"Software\\Microsoft\\Direct3D",&local_8);
  if (LVar1 == 0) {
    LVar1 = RegQueryValueExA(local_8,param_2,(LPDWORD)0x0,&local_c,param_3,(LPDWORD)&stack0x00000010
                            );
    RegCloseKey(local_8);
    if ((LVar1 == 0) && (local_c == param_1)) {
      return 1;
    }
  }
  return 0;
}



/* FUN_00456542 @ 00456542 */

/* WARNING: Removing unreachable block (ram,0x00456561) */
/* WARNING: Removing unreachable block (ram,0x00456553) */
/* WARNING: Restarted to delay deadcode elimination for space: stack */

undefined8 __fastcall FUN_00456542(undefined4 param_1,undefined4 param_2)

{
  uint *puVar1;
  int iVar2;
  undefined4 local_8;
  
  local_8 = 0;
  puVar1 = (uint *)cpuid(0x80000000);
  if (0x80000000 < *puVar1) {
    iVar2 = cpuid(0x80000001);
    local_8 = (uint)((*(uint *)(iVar2 + 8) & 0x80000000) != 0);
  }
  return CONCAT44(param_2,local_8);
}



/* FUN_0045657a @ 0045657a */

/* WARNING: Removing unreachable block (ram,0x004565a4) */

void FUN_0045657a(void)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  int unaff_EBP;
  
  FUN_004636c8();
  *(undefined1 **)(unaff_EBP + -0x10) = &stack0xffffffc4;
  *(undefined4 *)(unaff_EBP + -0x14) = 0;
  builtin_strncpy((char *)(unaff_EBP + -0x24),"Genu",4);
  builtin_strncpy((char *)(unaff_EBP + -0x20),"ineI",4);
  builtin_strncpy((char *)(unaff_EBP + -0x1c),"ntel",4);
  *(char *)(unaff_EBP + -0x18) = '\0';
  *(undefined4 *)(unaff_EBP + -4) = 0;
  puVar1 = (undefined4 *)cpuid_basic_info(0);
  uVar4 = puVar1[1];
  uVar3 = puVar1[2];
  uVar2 = puVar1[3];
  *(undefined4 *)(unaff_EBP + -0x2c) = *puVar1;
  *(undefined4 *)(unaff_EBP + -0x38) = uVar4;
  *(undefined4 *)(unaff_EBP + -0x34) = uVar3;
  *(undefined4 *)(unaff_EBP + -0x30) = uVar2;
  FUN_004565c0();
  return;
}



/* Catch@004565b4 @ 004565b4 */

undefined * Catch_004565b4(void)

{
  int unaff_EBP;
  
  *(undefined4 *)(unaff_EBP + -0x3c) = *(undefined4 *)(unaff_EBP + -0x14);
  return &DAT_004565c6;
}



/* FUN_004565c0 @ 004565c0 */

/* WARNING: Removing unreachable block (ram,0x004565db) */

undefined4 FUN_004565c0(void)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int unaff_EBP;
  
  *(undefined4 *)(unaff_EBP + -4) = 0xffffffff;
  if (*(int *)(unaff_EBP + -0x2c) == 0) {
    uVar2 = *(undefined4 *)(unaff_EBP + -0x14);
  }
  else {
    puVar1 = (undefined4 *)cpuid_Version_info(1);
    uVar2 = puVar1[2];
    *(undefined4 *)(unaff_EBP + -0x2c) = *puVar1;
    *(undefined4 *)(unaff_EBP + -0x28) = uVar2;
    if ((*(uint *)(unaff_EBP + -0x28) & 0x2000000) != 0) {
      *(uint *)(unaff_EBP + -0x14) = *(uint *)(unaff_EBP + -0x14) | 4;
    }
    if ((*(uint *)(unaff_EBP + -0x28) & 0x4000000) != 0) {
      *(uint *)(unaff_EBP + -0x14) = *(uint *)(unaff_EBP + -0x14) | 8;
    }
    uVar2 = *(undefined4 *)(unaff_EBP + -0x14);
  }
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return uVar2;
}



/* FUN_0045661f @ 0045661f */

uint __cdecl FUN_0045661f(DWORD param_1)

{
  WINBOOL WVar1;
  uint uVar2;
  int iVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  _OSVERSIONINFOA *p_Var4;
  undefined8 uVar5;
  _OSVERSIONINFOA local_9c;
  char local_5;
  
  p_Var4 = &local_9c;
  for (iVar3 = 0x25; iVar3 != 0; iVar3 = iVar3 + -1) {
    p_Var4->dwOSVersionInfoSize = 0;
    p_Var4 = (_OSVERSIONINFOA *)&p_Var4->dwMajorVersion;
  }
  local_5 = '\0';
  local_9c.dwOSVersionInfoSize = 0x94;
  WVar1 = GetVersionExA(&local_9c);
  if (WVar1 == 0) {
    local_5 = '\x01';
  }
  if (local_9c.dwPlatformId == 1) {
    if ((local_9c.dwMajorVersion < 5) &&
       (((local_9c.dwMajorVersion != 4 || (local_9c.dwMinorVersion < 10)) ||
        ((ushort)local_9c.dwBuildNumber < 0x55d)))) {
      local_5 = '\x01';
    }
  }
  else {
    if (local_9c.dwPlatformId != 2) {
      return 0;
    }
    if (WVar1 != 0) {
      if (param_1 != 10) {
        uVar2 = IsProcessorFeaturePresent(param_1);
        return uVar2;
      }
      goto LAB_004566c4;
    }
  }
  if (param_1 == 6) {
    if (local_5 == '\0') {
      uVar2 = FUN_0045657a();
      return uVar2 & 4;
    }
  }
  else {
    if (param_1 == 7) {
      uVar5 = FUN_00456542(extraout_ECX,extraout_EDX);
      return (uint)uVar5;
    }
    if ((param_1 == 10) && (local_5 == '\0')) {
LAB_004566c4:
      uVar2 = FUN_0045657a();
      return uVar2 & 8;
    }
  }
  return 0;
}



/* renderer_select_backend @ 004566d3 */

/* selects renderer table based on config */

int renderer_select_backend(int reset)

{
  uint uVar1;
  int iVar2;
  undefined **ppuVar3;
  undefined **ppuVar4;
  
  if (reset == 0) {
    DAT_00479770 = 0xffff;
    ppuVar3 = &PTR_FUN_00479688;
    ppuVar4 = &PTR_LAB_004795a0;
    for (iVar2 = 0x39; iVar2 != 0; iVar2 = iVar2 + -1) {
      *ppuVar4 = *ppuVar3;
      ppuVar3 = ppuVar3 + 1;
      ppuVar4 = ppuVar4 + 1;
    }
  }
  else if (DAT_00479770 == 0xffff) {
    DAT_00479770 = 0;
    ppuVar3 = &PTR_FUN_00479688;
    ppuVar4 = &PTR_LAB_004795a0;
    for (iVar2 = 0x39; iVar2 != 0; iVar2 = iVar2 + -1) {
      *ppuVar4 = *ppuVar3;
      ppuVar3 = ppuVar3 + 1;
      ppuVar4 = ppuVar4 + 1;
    }
    FUN_00457127(&PTR_LAB_004795a0);
    iVar2 = FUN_004564e6(4,"DisableD3DXPSGP",(LPBYTE)&reset);
    if (iVar2 == 0) {
      reset = 0;
    }
    if (reset != 1) {
      uVar1 = FUN_0045661f(7);
      if (uVar1 == 0) {
        uVar1 = FUN_0045661f(10);
        if (uVar1 == 0) {
          uVar1 = FUN_0045661f(6);
          if (uVar1 != 0) {
            FUN_004567b0(&PTR_LAB_004795a0);
            DAT_00479770 = 3;
          }
        }
        else {
          FUN_004568c0(&PTR_LAB_004795a0);
          DAT_00479770 = 2;
        }
      }
      else {
        FUN_00456aa5(&PTR_LAB_004795a0);
        DAT_00479770 = 1;
      }
    }
  }
  return DAT_00479770;
}



/* FUN_004567b0 @ 004567b0 */

void __cdecl FUN_004567b0(undefined4 *param_1)

{
  param_1[0x1c] = &LAB_00457e90;
  *param_1 = FUN_00457170;
  param_1[0xd] = &LAB_00457c10;
  param_1[0x1b] = &LAB_00457d00;
  param_1[0xb] = &LAB_00458e20;
  param_1[0x30] = &LAB_00457af0;
  param_1[0x2f] = &LAB_00457710;
  param_1[0x11] = &LAB_004579b0;
  param_1[0x36] = &LAB_00457aa0;
  param_1[0x35] = &LAB_004577a0;
  param_1[0x34] = &LAB_00457910;
  param_1[0x33] = &LAB_00457a40;
  param_1[0x32] = &LAB_00457650;
  param_1[0x31] = &LAB_00457850;
  param_1[0x12] = &LAB_00458840;
  param_1[0x16] = &LAB_00457b50;
  param_1[0x19] = &LAB_00458230;
  param_1[0x18] = &LAB_00458110;
  param_1[0x13] = &LAB_00457f70;
  param_1[0x2c] = &LAB_004580a0;
  param_1[0x14] = &LAB_00458000;
  param_1[0x10] = &LAB_00457500;
  param_1[0x15] = &LAB_00457420;
  param_1[8] = &LAB_004575b0;
  param_1[7] = &LAB_00457350;
  param_1[10] = &LAB_00457250;
  param_1[9] = FUN_004571b0;
  param_1[6] = &LAB_00458300;
  param_1[5] = &LAB_00457210;
  param_1[4] = &LAB_00458b00;
  param_1[3] = &LAB_00458540;
  param_1[2] = &LAB_00458480;
  param_1[1] = &LAB_004583c0;
  return;
}



/* FUN_004568c0 @ 004568c0 */

void __cdecl FUN_004568c0(undefined4 *param_1)

{
  param_1[0x1c] = &LAB_00459170;
  *param_1 = FUN_00457170;
  param_1[0xd] = &LAB_00458ef0;
  param_1[0x1b] = &LAB_00458fe0;
  param_1[0xb] = &LAB_00458e20;
  param_1[0x30] = &LAB_00457af0;
  param_1[0x2f] = &LAB_00457710;
  param_1[0x11] = &LAB_004579b0;
  param_1[0x36] = &LAB_00457aa0;
  param_1[0x35] = &LAB_004577a0;
  param_1[0x34] = &LAB_00457910;
  param_1[0x33] = &LAB_00457a40;
  param_1[0x32] = &LAB_00457650;
  param_1[0x31] = &LAB_00457850;
  param_1[0x12] = &LAB_00458840;
  param_1[0x16] = &LAB_00457b50;
  param_1[0x19] = &LAB_00459370;
  param_1[0x18] = &LAB_00459250;
  param_1[0x1f] = &LAB_00458d90;
  param_1[0x1e] = &LAB_00458d10;
  param_1[0x13] = &LAB_00457f70;
  param_1[0x14] = &LAB_00458000;
  param_1[0x10] = &LAB_00458c60;
  param_1[0x15] = &LAB_00458760;
  param_1[8] = &LAB_004575b0;
  param_1[7] = &LAB_00458690;
  param_1[10] = &LAB_00457250;
  param_1[9] = FUN_004571b0;
  param_1[6] = &LAB_00458300;
  param_1[5] = &LAB_00457210;
  param_1[4] = &LAB_00458b00;
  param_1[3] = &LAB_00458540;
  param_1[2] = &LAB_00458480;
  param_1[1] = &LAB_004583c0;
  return;
}



/* FUN_004569d0 @ 004569d0 */

/* WARNING: Removing unreachable block (ram,0x00456a4d) */
/* WARNING: Removing unreachable block (ram,0x00456a3b) */
/* WARNING: Removing unreachable block (ram,0x00456a20) */
/* WARNING: Removing unreachable block (ram,0x00456a04) */
/* WARNING: Removing unreachable block (ram,0x004569f9) */
/* [binja] int32_t sub_4569d0() */

int FUN_004569d0(void)

{
  undefined4 *puVar1;
  uint *puVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  int *piVar7;
  bool bVar8;
  char local_2c [16];
  int local_1c;
  int local_18;
  int local_14;
  char cStack_10;
  undefined4 local_c;
  uint local_8;
  
  cStack_10 = '\0';
  builtin_strncpy(local_2c,"AuthenticAMD",0xd);
  cpuid_basic_info(0);
  local_8 = 1;
  piVar7 = (int *)cpuid_basic_info(0);
  local_1c = piVar7[1];
  local_18 = piVar7[2];
  local_14 = piVar7[3];
  if (*piVar7 != 0) {
    puVar1 = (undefined4 *)cpuid_Version_info(1);
    local_c = *puVar1;
    uVar3 = -(uint)((puVar1[2] & 0x800000) != 0) & 0x20;
    local_8 = uVar3 | 3;
    puVar2 = (uint *)cpuid(0x80000000);
    if (0x80000000 < *puVar2) {
      iVar4 = cpuid(0x80000001);
      uVar5 = *(uint *)(iVar4 + 8);
      local_8 = uVar3 | 7 | -(uint)((uVar5 & 0x80000000) != 0) & 0x80;
      bVar8 = local_8 == 0;
      iVar4 = 0xc;
      pcVar6 = local_2c;
      piVar7 = &local_1c;
      do {
        if (iVar4 == 0) break;
        iVar4 = iVar4 + -1;
        bVar8 = *pcVar6 == (char)*piVar7;
        pcVar6 = pcVar6 + 1;
        piVar7 = (int *)((int)piVar7 + 1);
      } while (bVar8);
      if (bVar8) {
        local_8 = local_8 | -(uint)((uVar5 & 0x40000000) != 0) & 0x100 |
                  -(uint)((uVar5 & 0x400000) != 0) & 0x200;
      }
    }
  }
  return local_8;
}



/* FUN_00456aa5 @ 00456aa5 */

void __cdecl FUN_00456aa5(undefined4 *param_1)

{
  uint uVar1;
  
  uVar1 = FUN_004569d0();
  if (((uVar1 & 0x20) != 0) && ((char)uVar1 < '\0')) {
    *param_1 = &LAB_0045f218;
    param_1[1] = &LAB_0045e75a;
    param_1[2] = &LAB_0045f4d9;
    param_1[3] = &LAB_0045a9aa;
    param_1[5] = &LAB_0045f26d;
    param_1[6] = &LAB_0045e7cb;
    param_1[7] = FUN_0045e832;
    param_1[8] = &LAB_0045f55b;
    param_1[9] = &LAB_0045f2a6;
    param_1[10] = &LAB_0045ed12;
    param_1[0xb] = &LAB_0045abdc;
    param_1[0xc] = &LAB_0045f903;
    param_1[0xd] = &LAB_0045f946;
    param_1[0xe] = vec3_project;
    param_1[0xf] = vec3_unproject;
    param_1[0x10] = &LAB_0045f5ba;
    param_1[0x11] = &LAB_0045f30a;
    param_1[0x12] = &LAB_0045e73e;
    param_1[0x13] = &LAB_00459440;
    param_1[0x14] = &LAB_004594d9;
    param_1[0x15] = FUN_0045fae8;
    param_1[0x16] = &LAB_0045fa2a;
    param_1[0x17] = FUN_00459536;
    param_1[0x18] = &LAB_004595e9;
    param_1[0x19] = &LAB_00459a1a;
    param_1[0x1a] = &LAB_0045acab;
    param_1[0x1b] = &LAB_0045acfb;
    param_1[0x1c] = &LAB_0045ade6;
    param_1[0x1d] = FUN_00459adf;
    param_1[0x1e] = &LAB_0045aec2;
    param_1[0x1f] = &LAB_0045af25;
    param_1[0x20] = &LAB_0045af83;
    param_1[0x21] = &LAB_0045afdc;
    param_1[0x22] = &LAB_0045fb4c;
    param_1[0x23] = FUN_00459b4b;
    param_1[0x24] = FUN_00459c82;
    param_1[0x25] = &LAB_0045b023;
    param_1[0x26] = &LAB_0045b0cb;
    param_1[0x27] = FUN_0045b252;
    param_1[0x28] = FUN_0045c3ea;
    param_1[0x29] = &LAB_0045c58f;
    param_1[0x2a] = FUN_0045cac3;
    param_1[0x2b] = FUN_00459d0f;
    param_1[0x2c] = &LAB_00459da1;
    param_1[0x36] = &LAB_0045f6ec;
    param_1[0x33] = &LAB_0045e891;
    param_1[0x30] = &LAB_0045f3a2;
    param_1[0x2e] = &LAB_0045f3eb;
    param_1[0x34] = &LAB_0045f75d;
    param_1[0x31] = &LAB_0045e902;
    param_1[0x37] = FUN_00459e05;
    param_1[0x38] = &LAB_00459eac;
    param_1[0x35] = &LAB_0045f825;
    param_1[0x2f] = &LAB_0045f42e;
    param_1[0x32] = &LAB_0045e9d6;
    param_1[4] = &LAB_0045e012;
    param_1[0x2d] = FUN_00459f51;
    if (((uVar1 & 0x100) != 0) && ((uVar1 & 0x200) != 0)) {
      param_1[0xf] = FUN_0045f0c5;
      param_1[0x12] = FUN_0045dd30;
      param_1[0x26] = &LAB_0045b19d;
      param_1[0x27] = FUN_0045cbdc;
      param_1[0x18] = &LAB_00459805;
    }
  }
  return;
}



/* FUN_00456eec @ 00456eec */

/* [binja] float* __stdcall sub_456eec(float* arg1, float* arg2) */

float * FUN_00456eec(float *arg1,float *arg2)

{
  float fVar1;
  float fVar2;
  float fVar3;
  uint uVar4;
  float10 fVar5;
  
  fVar5 = (float10)*arg2 * (float10)*arg2 + (float10)arg2[1] * (float10)arg2[1] +
          (float10)arg2[2] * (float10)arg2[2];
  fVar1 = (float)fVar5;
  if (fVar1 == 0.0) {
    ffree(fVar5);
    *arg1 = 0.0;
    arg1[1] = 0.0;
    arg1[2] = 0.0;
  }
  else if ((uint)ABS((float)(fVar5 - (float10)1)) < 0x3727c5ad) {
    if (arg1 != arg2) {
      *arg1 = *arg2;
      arg1[1] = arg2[1];
      arg1[2] = arg2[2];
    }
  }
  else {
    uVar4 = (uint)fVar1 >> 0xc & 0xff8;
    fVar3 = ((float)((uint)fVar1 & 0xffffff | 0x3f000000) * *(float *)(&DAT_00479780 + uVar4) +
            *(float *)(&DAT_00479784 + uVar4)) * (float)(0xbeffffffU - (int)fVar1 >> 1 & 0xff800000)
    ;
    fVar1 = arg2[1];
    fVar2 = arg2[2];
    *arg1 = *arg2 * fVar3;
    arg1[1] = fVar1 * fVar3;
    arg1[2] = fVar2 * fVar3;
  }
  return arg1;
}



/* FUN_00456fb6 @ 00456fb6 */

/* [binja] int32_t __stdcall sub_456fb6(int32_t arg1, int32_t arg2, void* arg3) */

int FUN_00456fb6(int arg1,int arg2,void *arg3)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined4 *puVar8;
  float10 fVar9;
  float10 fVar10;
  float10 fVar11;
  float10 fVar12;
  undefined4 local_44 [16];
  
  iVar5 = arg1;
  if (arg3 == (void *)arg1) {
    if (arg2 != arg1) {
      iVar7 = -4;
      do {
        iVar6 = -0x10;
        fVar9 = (float10)*(float *)((int)arg3 + iVar7 * 4 + 0x10);
        fVar10 = (float10)*(float *)((int)arg3 + iVar7 * 4 + 0x20);
        fVar11 = (float10)*(float *)((int)arg3 + iVar7 * 4 + 0x30);
        fVar12 = (float10)*(float *)((int)arg3 + iVar7 * 4 + 0x40);
        do {
          *(float *)(arg1 + 0x40 + iVar6 * 4) =
               (float)(fVar12 * (float10)*(float *)(arg2 + 0x4c + iVar6 * 4) +
                       fVar10 * (float10)*(float *)(arg2 + 0x44 + iVar6 * 4) +
                      fVar9 * (float10)*(float *)(arg2 + 0x40 + iVar6 * 4) +
                      fVar11 * (float10)*(float *)(arg2 + 0x48 + iVar6 * 4));
          iVar6 = iVar6 + 4;
        } while (iVar6 != 0);
        ffree(fVar9);
        ffree(fVar10);
        ffree(fVar11);
        ffree(fVar12);
        arg1 = arg1 + 4;
        iVar7 = iVar7 + 1;
      } while (iVar7 != 0);
      return iVar5;
    }
    puVar8 = local_44;
    for (iVar7 = 0x10; iVar7 != 0; iVar7 = iVar7 + -1) {
      *puVar8 = *(undefined4 *)arg3;
      arg3 = (undefined4 *)((int)arg3 + 4);
      puVar8 = puVar8 + 1;
    }
    arg3 = local_44;
  }
  iVar7 = -4;
  do {
    iVar6 = -4;
    fVar1 = *(float *)arg2;
    fVar2 = *(float *)(arg2 + 4);
    fVar3 = *(float *)(arg2 + 8);
    fVar4 = *(float *)(arg2 + 0xc);
    do {
      *(float *)(arg1 + 0x10 + iVar6 * 4) =
           (float)((float10)fVar4 * (float10)*(float *)((int)arg3 + iVar6 * 4 + 0x40) +
                   (float10)fVar2 * (float10)*(float *)((int)arg3 + iVar6 * 4 + 0x20) +
                  (float10)fVar1 * (float10)*(float *)((int)arg3 + iVar6 * 4 + 0x10) +
                  (float10)fVar3 * (float10)*(float *)((int)arg3 + iVar6 * 4 + 0x30));
      iVar6 = iVar6 + 1;
    } while (iVar6 != 0);
    ffree((float10)fVar1);
    ffree((float10)fVar2);
    ffree((float10)fVar3);
    ffree((float10)fVar4);
    arg2 = arg2 + 0x10;
    arg1 = arg1 + 0x10;
    iVar7 = iVar7 + 1;
  } while (iVar7 != 0);
  return iVar5;
}



/* FUN_00457099 @ 00457099 */

/* [binja] void* __stdcall sub_457099(void* arg1, int32_t arg2, int32_t arg3) */

void * FUN_00457099(void *arg1,int arg2,int arg3)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  undefined4 *puVar5;
  float *pfVar6;
  int iVar7;
  int iVar8;
  undefined4 *puVar9;
  undefined4 local_48 [17];
  
  if ((arg1 == (void *)arg2) || (puVar5 = arg1, arg1 == (void *)arg3)) {
    puVar5 = local_48;
  }
  iVar8 = -4;
  do {
    iVar7 = -4;
    pfVar6 = (float *)(puVar5 + iVar8 + 4);
    fVar1 = *(float *)arg2;
    fVar2 = *(float *)(arg2 + 4);
    fVar3 = *(float *)(arg2 + 8);
    fVar4 = *(float *)(arg2 + 0xc);
    do {
      *pfVar6 = (float)((float10)fVar4 * (float10)*(float *)(arg3 + 0x40 + iVar7 * 4) +
                        (float10)fVar2 * (float10)*(float *)(arg3 + 0x20 + iVar7 * 4) +
                       (float10)fVar1 * (float10)*(float *)(arg3 + 0x10 + iVar7 * 4) +
                       (float10)fVar3 * (float10)*(float *)(arg3 + 0x30 + iVar7 * 4));
      pfVar6 = pfVar6 + 4;
      iVar7 = iVar7 + 1;
    } while (iVar7 != 0);
    ffree((float10)fVar1);
    ffree((float10)fVar2);
    ffree((float10)fVar3);
    ffree((float10)fVar4);
    arg2 = arg2 + 0x10;
    iVar8 = iVar8 + 1;
  } while (iVar8 != 0);
  if (puVar5 != arg1) {
    puVar9 = arg1;
    for (iVar8 = 0x10; iVar8 != 0; iVar8 = iVar8 + -1) {
      *puVar9 = *puVar5;
      puVar5 = puVar5 + 1;
      puVar9 = puVar9 + 1;
    }
  }
  return arg1;
}



/* FUN_00457127 @ 00457127 */

void __cdecl FUN_00457127(undefined4 *param_1)

{
  *param_1 = &LAB_00456ccb;
  param_1[1] = &LAB_00456d69;
  param_1[2] = &LAB_00456e53;
  param_1[3] = FUN_00456fb6;
  param_1[4] = FUN_00457099;
  param_1[5] = &LAB_00456d34;
  param_1[6] = &LAB_00456df4;
  param_1[7] = FUN_00456eec;
  return;
}



/* FUN_00457170 @ 00457170 */

float * FUN_00457170(float *param_1,float *param_2,float *param_3)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  float fVar6;
  float fVar7;
  float fVar8;
  float fVar9;
  float fVar10;
  float fVar11;
  
  fVar3 = param_3[1];
  fVar4 = param_3[2];
  fVar5 = param_3[3];
  fVar1 = *param_2;
  fVar6 = param_3[5];
  fVar7 = param_3[6];
  fVar8 = param_3[7];
  fVar2 = param_2[1];
  fVar9 = param_3[0xd];
  fVar10 = param_3[0xe];
  fVar11 = param_3[0xf];
  *param_1 = fVar1 * *param_3 + param_3[0xc] + fVar2 * param_3[4];
  param_1[1] = fVar1 * fVar3 + fVar9 + fVar2 * fVar6;
  param_1[2] = fVar1 * fVar4 + fVar10 + fVar2 * fVar7;
  param_1[3] = fVar1 * fVar5 + fVar11 + fVar2 * fVar8;
  return param_1;
}



/* FUN_004571b0 @ 004571b0 */

undefined8 * FUN_004571b0(undefined8 *param_1,float *param_2,float *param_3)

{
  float fVar1;
  float fVar2;
  undefined1 in_XMM0 [16];
  undefined1 auVar3 [16];
  float fVar4;
  float fVar5;
  float fVar6;
  
  fVar1 = *param_2;
  fVar2 = param_2[1];
  fVar4 = fVar1 * *param_3 + param_3[0xc] + fVar2 * param_3[4];
  fVar5 = fVar1 * param_3[1] + param_3[0xd] + fVar2 * param_3[5];
  fVar6 = fVar1 * param_3[3] + param_3[0xf] + fVar2 * param_3[7];
  auVar3._4_4_ = fVar5;
  auVar3._0_4_ = fVar4;
  auVar3._8_4_ = fVar1 * param_3[2] + param_3[0xe] + fVar2 * param_3[6];
  auVar3._12_4_ = fVar6;
  auVar3 = rcpps(in_XMM0,auVar3);
  fVar6 = auVar3._12_4_ * auVar3._12_4_ * fVar6;
  *param_1 = CONCAT44(fVar5 * fVar6,fVar4 * fVar6);
  return param_1;
}



/* FUN_00459536 @ 00459536 */

ulonglong FUN_00459536(undefined8 *param_1,undefined8 *param_2,undefined4 *param_3)

{
  undefined8 uVar1;
  int iVar2;
  undefined8 extraout_MM0;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  ulonglong uVar7;
  
  uVar4 = *param_1;
  uVar1 = param_1[1];
  uVar5 = PackedFloatingMUL(uVar4,uVar4);
  uVar3 = PackedFloatingMUL(uVar1,uVar1);
  uVar5 = PackedFloatingADD(uVar5,uVar3);
  uVar5 = PackedFloatingAccumulate(uVar5,uVar5);
  uVar6 = PackedFloatingCompareGE(0x80000000800000,uVar5);
  uVar3 = PackedFloatingReciprocalSQRAprox(uVar3,uVar5);
  iVar2 = (int)uVar6;
  if (iVar2 == 0) {
    uVar6 = PackedFloatingMUL(uVar3,uVar3);
    if (param_2 != (undefined8 *)0x0) {
      uVar5 = PackedFloatingReciprocalSQRIter1(uVar6,uVar5);
      uVar3 = PackedFloatingReciprocalIter2(uVar5,uVar3);
      uVar5 = PackedFloatingMUL(uVar4,uVar3);
      uVar4 = PackedFloatingMUL(uVar3,uVar1);
      *param_2 = uVar5;
      *(int *)(param_2 + 1) = (int)uVar4;
    }
    uVar7 = CONCAT44(param_2,iVar2);
    if (param_3 != (undefined4 *)0x0) {
      uVar7 = math_acos_packed();
      uVar4 = PackedFloatingMUL(extraout_MM0,0x4000000040000000);
      *param_3 = (int)uVar4;
    }
  }
  else {
    if (param_2 != (undefined8 *)0x0) {
      *(undefined8 *)((int)param_2 + 4) = 0;
      *(undefined4 *)param_2 = 0x3f800000;
    }
    uVar7 = CONCAT44(param_2,iVar2);
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = 0;
      uVar7 = CONCAT44(param_2,iVar2);
    }
  }
  FastExitMediaState();
  return uVar7;
}



/* FUN_00459adf @ 00459adf */

void FUN_00459adf(undefined8 *param_1,ulonglong *param_2,uint param_3)

{
  undefined8 extraout_MM0;
  undefined8 uVar1;
  undefined8 uVar2;
  undefined4 uVar3;
  undefined8 local_18;
  uint local_10;
  
  FastExitMediaState();
  FUN_0045e832(&local_18,param_2);
  PackedFloatingMUL((ulonglong)param_3,0x3f0000003f000000);
  math_sincos_packed();
  uVar3 = (undefined4)((ulonglong)extraout_MM0 >> 0x20);
  uVar2 = CONCAT44(uVar3,uVar3);
  uVar1 = PackedFloatingMUL(local_18,uVar2);
  uVar2 = PackedFloatingMUL((ulonglong)local_10,uVar2);
  *param_1 = uVar1;
  param_1[1] = CONCAT44((int)extraout_MM0,(int)uVar2);
  FastExitMediaState();
  return;
}



/* FUN_00459b4b @ 00459b4b */

void FUN_00459b4b(undefined8 *param_1,undefined8 *param_2,undefined8 *param_3,uint param_4)

{
  undefined4 uVar1;
  uint extraout_MM0_Da;
  ulonglong extraout_MM0;
  undefined8 extraout_MM0_00;
  undefined8 uVar3;
  ulonglong uVar4;
  undefined8 uVar5;
  uint uVar6;
  undefined8 uVar7;
  undefined8 uVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  ulonglong uVar2;
  
  FastExitMediaState();
  uVar3 = PackedFloatingMUL(*param_2,*param_3);
  uVar5 = PackedFloatingMUL(param_2[1],param_3[1]);
  uVar3 = PackedFloatingADD(uVar3,uVar5);
  uVar2 = PackedFloatingSUB(0x3f800000,(ulonglong)param_4);
  uVar1 = (undefined4)uVar2;
  uVar4 = PackedFloatingAccumulate(uVar3,uVar3);
  uVar9 = PackedFloatingCompareGE(0,uVar4);
  uVar10 = uVar9 & 0x8000000080000000;
  uVar4 = uVar4 ^ uVar10;
  uVar5 = PackedFloatingCompareGE(0x3f7fff583f7fff58,uVar4);
  uVar3 = PackedFloatingMUL(uVar4,uVar4);
  uVar3 = PackedFloatingSUBR(uVar3,0x3f8000003f800000);
  if ((int)uVar5 != 0) {
    uVar7 = PackedFloatingReciprocalSQRAprox((ulonglong)param_4,uVar3);
    uVar5 = PackedFloatingMUL(uVar7,uVar7);
    uVar3 = PackedFloatingReciprocalSQRIter1(uVar3,uVar5);
    uVar4 = PackedFloatingReciprocalIter2(uVar3,uVar7);
    uVar3 = FloatingReciprocalAprox(uVar5,uVar4);
    uVar5 = PackedFloatingReciprocalIter1(uVar4,uVar3);
    PackedFloatingReciprocalIter2(uVar5,uVar3);
    math_atan2_packed();
    PackedFloatingMUL(extraout_MM0,(ulonglong)param_4);
    math_sin_packed();
    PackedFloatingMUL(extraout_MM0 & 0xffffffff,uVar2 & 0xffffffff);
    math_sin_packed();
    uVar10 = uVar9 & 0x80000000;
    uVar3 = PackedFloatingMUL(extraout_MM0_00,uVar4 & 0xffffffff);
    uVar1 = (undefined4)uVar3;
    uVar3 = PackedFloatingMUL((ulonglong)extraout_MM0_Da,uVar4 & 0xffffffff);
    param_4 = (uint)uVar3;
  }
  uVar6 = param_4 ^ (uint)uVar10;
  uVar5 = CONCAT44(uVar6,uVar6);
  uVar3 = PackedFloatingMUL(CONCAT44(uVar1,uVar1),*param_2);
  uVar7 = PackedFloatingMUL(uVar5,*param_3);
  uVar8 = PackedFloatingMUL(CONCAT44(uVar1,uVar1),param_2[1]);
  uVar5 = PackedFloatingMUL(uVar5,param_3[1]);
  uVar3 = PackedFloatingADD(uVar3,uVar7);
  uVar5 = PackedFloatingADD(uVar8,uVar5);
  *param_1 = uVar3;
  param_1[1] = uVar5;
  FastExitMediaState();
  return;
}



/* FUN_00459c82 @ 00459c82 */

undefined8 *
FUN_00459c82(undefined8 *param_1,undefined8 *param_2,undefined8 *param_3,undefined8 *param_4,
            uint param_5,uint param_6)

{
  ulonglong uVar1;
  undefined8 uVar2;
  undefined8 in_MM2;
  undefined8 uVar3;
  undefined8 local_28 [2];
  undefined8 local_18 [2];
  
  FastExitMediaState();
  uVar1 = PackedFloatingADD((ulonglong)param_5,(ulonglong)param_6);
  FUN_00459b4b(local_28,param_2,param_3,(uint)uVar1);
  FUN_00459b4b(local_18,param_2,param_4,(uint)uVar1);
  uVar3 = FloatingReciprocalAprox(in_MM2,uVar1 & 0xffffffff);
  uVar2 = PackedFloatingReciprocalIter1(uVar1 & 0xffffffff,uVar3);
  uVar2 = PackedFloatingReciprocalIter2(uVar2,uVar3);
  uVar2 = PackedFloatingMUL(uVar2,(ulonglong)param_6);
  FUN_00459b4b(param_1,local_28,local_18,(uint)uVar2);
  FastExitMediaState();
  return param_1;
}



/* FUN_00459d0f @ 00459d0f */

void FUN_00459d0f(undefined8 *param_1,undefined8 *param_2,undefined8 *param_3,undefined8 *param_4,
                 undefined8 *param_5,uint param_6)

{
  ulonglong uVar1;
  undefined8 uVar2;
  undefined8 local_20 [2];
  undefined8 local_10 [2];
  
  FUN_00459b4b(local_20,param_2,param_5,param_6);
  FUN_00459b4b(local_10,param_3,param_4,param_6);
  uVar1 = (ulonglong)param_6;
  uVar2 = PackedFloatingMUL(uVar1,uVar1);
  uVar2 = PackedFloatingSUB(uVar1,uVar2);
  uVar2 = PackedFloatingMUL(uVar2,0x4000000040000000);
  FUN_00459b4b(param_1,local_20,local_10,(uint)uVar2);
  FastExitMediaState();
  return;
}



/* FUN_00459e05 @ 00459e05 */

void FUN_00459e05(undefined8 *param_1,undefined8 *param_2)

{
  undefined4 extraout_MM0_Da;
  ulonglong extraout_MM0;
  undefined8 uVar1;
  ulonglong uVar2;
  undefined4 uVar4;
  undefined8 uVar3;
  undefined8 in_MM4;
  undefined8 uVar5;
  
  FastExitMediaState();
  uVar1 = *param_2;
  uVar2 = param_2[1];
  uVar4 = (undefined4)(uVar2 >> 0x20);
  uVar3 = PackedFloatingCompareGE(CONCAT44(uVar4,uVar4),0x3f8000003f800000);
  if ((int)uVar3 == 0) {
    math_acos_packed();
    math_sin_packed();
    uVar3 = PackedFloatingCompareGE(extraout_MM0 & 0x7fffffff7fffffff,0x3400000034000000);
    uVar1 = *param_2;
    uVar2 = param_2[1];
    if ((int)uVar3 != 0) {
      uVar5 = FloatingReciprocalAprox(in_MM4,extraout_MM0);
      uVar3 = PackedFloatingReciprocalIter1(extraout_MM0,uVar5);
      uVar3 = PackedFloatingReciprocalIter2(uVar3,uVar5);
      uVar3 = PackedFloatingMUL(CONCAT44(extraout_MM0_Da,extraout_MM0_Da),uVar3);
      uVar1 = PackedFloatingMUL(uVar1,uVar3);
      uVar2 = PackedFloatingMUL(uVar2,uVar3);
    }
  }
  *param_1 = uVar1;
  param_1[1] = uVar2 & 0xffffffff;
  FastExitMediaState();
  return;
}



/* FUN_00459f51 @ 00459f51 */

void FUN_00459f51(undefined8 *param_1,undefined8 *param_2,ulonglong *param_3,ulonglong *param_4,
                 ulonglong *param_5,ulonglong *param_6,ulonglong *param_7)

{
  undefined4 unaff_ESI;
  undefined4 extraout_MM0_Da;
  undefined4 extraout_MM0_Da_00;
  undefined4 extraout_MM0_Da_01;
  undefined4 extraout_MM0_Da_02;
  undefined8 uVar1;
  ulonglong extraout_MM0;
  ulonglong extraout_MM0_00;
  ulonglong extraout_MM0_01;
  ulonglong extraout_MM0_02;
  ulonglong extraout_MM0_03;
  ulonglong extraout_MM0_04;
  undefined8 uVar2;
  undefined4 uVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  undefined8 uVar7;
  ulonglong uVar8;
  undefined8 uVar9;
  ulonglong uVar10;
  undefined8 uVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  undefined8 uVar14;
  ulonglong local_a8;
  ulonglong local_a0;
  ulonglong local_88;
  ulonglong local_80;
  ulonglong local_78;
  ulonglong local_70;
  undefined4 local_20;
  
  local_a8 = *param_4;
  local_a0 = param_4[1];
  uVar6 = *param_5;
  uVar13 = param_5[1];
  uVar1 = PackedFloatingADD(local_a8,uVar6);
  uVar2 = PackedFloatingADD(local_a0,uVar13);
  uVar4 = PackedFloatingSUB(local_a8,uVar6);
  uVar1 = PackedFloatingMUL(uVar1,uVar1);
  uVar7 = PackedFloatingSUB(local_a0,uVar13);
  uVar2 = PackedFloatingMUL(uVar2,uVar2);
  uVar4 = PackedFloatingMUL(uVar4,uVar4);
  uVar7 = PackedFloatingMUL(uVar7,uVar7);
  uVar1 = PackedFloatingADD(uVar1,uVar2);
  uVar4 = PackedFloatingADD(uVar4,uVar7);
  local_88 = *param_6;
  local_80 = param_6[1];
  uVar9 = PackedFloatingADD(uVar6,local_88);
  uVar11 = PackedFloatingADD(uVar13,local_80);
  uVar2 = PackedFloatingSUB(uVar6,local_88);
  uVar7 = PackedFloatingSUB(uVar13,local_80);
  uVar9 = PackedFloatingMUL(uVar9,uVar9);
  uVar11 = PackedFloatingMUL(uVar11,uVar11);
  uVar2 = PackedFloatingMUL(uVar2,uVar2);
  uVar7 = PackedFloatingMUL(uVar7,uVar7);
  uVar9 = PackedFloatingADD(uVar9,uVar11);
  uVar2 = PackedFloatingADD(uVar2,uVar7);
  uVar1 = PackedFloatingAccumulate(uVar1,uVar9);
  uVar2 = PackedFloatingAccumulate(uVar4,uVar2);
  uVar1 = PackedFloatingCompareGT(uVar2,uVar1);
  uVar5 = packsswb(uVar1,uVar1);
  if ((uVar5 & 1) != 0) {
    local_a8 = *param_4 ^ 0x8000000080000000;
    local_a0 = param_4[1] ^ 0x8000000080000000;
  }
  if ((uVar5 & 0x10000) != 0) {
    local_88 = *param_6 ^ 0x8000000080000000;
    local_80 = param_6[1] ^ 0x8000000080000000;
  }
  local_78 = *param_7;
  uVar5 = param_7[1];
  uVar4 = PackedFloatingADD(local_88,local_78);
  uVar7 = PackedFloatingADD(local_80,uVar5);
  uVar1 = PackedFloatingSUB(local_88,local_78);
  uVar2 = PackedFloatingSUB(local_80,uVar5);
  uVar4 = PackedFloatingMUL(uVar4,uVar4);
  uVar7 = PackedFloatingMUL(uVar7,uVar7);
  uVar1 = PackedFloatingMUL(uVar1,uVar1);
  uVar2 = PackedFloatingMUL(uVar2,uVar2);
  uVar4 = PackedFloatingADD(uVar4,uVar7);
  uVar1 = PackedFloatingADD(uVar1,uVar2);
  uVar2 = PackedFloatingAccumulate(uVar4,uVar4);
  uVar1 = PackedFloatingAccumulate(uVar1,uVar1);
  uVar8 = PackedFloatingCompareGT(uVar1,uVar2);
  local_70 = uVar5;
  if ((uVar8 & 1) != 0) {
    local_78 = *param_7 ^ 0x8000000080000000;
    local_70 = param_7[1] ^ 0x8000000080000000;
  }
  uVar1 = PackedFloatingMUL(uVar6,uVar6);
  uVar2 = PackedFloatingMUL(uVar13,uVar13);
  uVar1 = PackedFloatingADD(uVar1,uVar2);
  uVar1 = PackedFloatingAccumulate(uVar1,uVar1);
  uVar2 = FloatingReciprocalAprox(uVar5,uVar1);
  uVar5 = PackedFloatingCompareGT(uVar1,0x80000000800000);
  uVar1 = PackedFloatingReciprocalIter1(uVar1,uVar2);
  uVar1 = PackedFloatingReciprocalIter2(uVar1,uVar2);
  uVar2 = PackedFloatingMUL((uVar6 ^ 0x8000000080000000) & uVar5,uVar1);
  uVar9 = PackedFloatingMUL((uVar13 ^ 0x80000000) & uVar5,uVar1);
  uVar8 = CONCAT44((int)local_a8,(int)(local_a8 >> 0x20));
  uVar10 = CONCAT44((int)local_a0,(int)(local_a0 >> 0x20));
  uVar5 = PackedFloatingMUL(local_a8,uVar9);
  uVar1 = PackedFloatingMUL(local_a0,uVar2);
  uVar7 = PackedFloatingMUL(uVar10 ^ 0x80000000,uVar2);
  uVar4 = PackedFloatingMUL(uVar8,uVar9);
  uVar1 = PackedFloatingADD(uVar5 ^ 0x80000000,uVar1);
  uVar4 = PackedFloatingSUB(uVar4,uVar7);
  uVar14 = PackedFloatingMUL(uVar10,uVar9);
  uVar4 = PackedFloatingAccumulate(uVar4,uVar1);
  uVar11 = PackedFloatingMUL(uVar8 ^ 0x80000000,uVar2);
  uVar1 = PackedFloatingMUL(local_a8,uVar2);
  uVar7 = PackedFloatingMUL(local_a0 ^ 0x80000000,uVar9);
  uVar11 = PackedFloatingADD(uVar11,uVar14);
  uVar1 = PackedFloatingSUB(uVar7,uVar1);
  uVar8 = PackedFloatingAccumulate(uVar11,uVar1);
  uVar10 = CONCAT44((int)local_88,(int)(local_88 >> 0x20));
  uVar12 = CONCAT44((int)local_80,(int)(local_80 >> 0x20));
  uVar5 = PackedFloatingMUL(local_88,uVar9);
  uVar1 = PackedFloatingMUL(local_80,uVar2);
  uVar11 = PackedFloatingMUL(uVar12 ^ 0x80000000,uVar2);
  uVar7 = PackedFloatingMUL(uVar10,uVar9);
  uVar1 = PackedFloatingADD(uVar5 ^ 0x80000000,uVar1);
  uVar7 = PackedFloatingSUB(uVar7,uVar11);
  uVar14 = PackedFloatingMUL(uVar12,uVar9);
  uVar7 = PackedFloatingAccumulate(uVar7,uVar1);
  uVar11 = PackedFloatingMUL(uVar10 ^ 0x80000000,uVar2);
  uVar1 = PackedFloatingMUL(local_88,uVar2);
  uVar2 = PackedFloatingMUL(local_80 ^ 0x80000000,uVar9);
  uVar9 = PackedFloatingADD(uVar11,uVar14);
  uVar1 = PackedFloatingSUB(uVar2,uVar1);
  uVar5 = PackedFloatingAccumulate(uVar9,uVar1);
  uVar3 = (undefined4)(uVar8 >> 0x20);
  uVar2 = PackedFloatingCompareGE(CONCAT44(uVar3,uVar3),0x3f8000003f800000);
  uVar1 = uVar7;
  if ((int)uVar2 == 0) {
    math_acos_packed();
    math_sin_packed();
    uVar2 = PackedFloatingCompareGE(extraout_MM0 & 0x7fffffff7fffffff,0x3400000034000000);
    if ((int)uVar2 != 0) {
      uVar1 = FloatingReciprocalAprox(uVar1,extraout_MM0);
      uVar2 = PackedFloatingReciprocalIter1(extraout_MM0,uVar1);
      uVar2 = PackedFloatingReciprocalIter2(uVar2,uVar1);
      uVar2 = PackedFloatingMUL(CONCAT44(extraout_MM0_Da,extraout_MM0_Da),uVar2);
      uVar4 = PackedFloatingMUL(uVar4,uVar2);
      uVar8 = PackedFloatingMUL(uVar8,uVar2);
    }
  }
  uVar3 = (undefined4)(uVar5 >> 0x20);
  uVar2 = PackedFloatingCompareGE(CONCAT44(uVar3,uVar3),0x3f8000003f800000);
  if ((int)uVar2 == 0) {
    math_acos_packed();
    math_sin_packed();
    uVar2 = PackedFloatingCompareGE(extraout_MM0_00 & 0x7fffffff7fffffff,0x3400000034000000);
    if ((int)uVar2 != 0) {
      uVar2 = FloatingReciprocalAprox(uVar1,extraout_MM0_00);
      uVar1 = PackedFloatingReciprocalIter1(extraout_MM0_00,uVar2);
      uVar1 = PackedFloatingReciprocalIter2(uVar1,uVar2);
      uVar1 = PackedFloatingMUL(CONCAT44(extraout_MM0_Da_00,extraout_MM0_Da_00),uVar1);
      uVar7 = PackedFloatingMUL(uVar7,uVar1);
      uVar5 = PackedFloatingMUL(uVar5,uVar1);
    }
  }
  uVar1 = PackedFloatingADD(uVar4,uVar7);
  uVar2 = PackedFloatingADD(uVar8 & 0xffffffff,uVar5 & 0xffffffff);
  uVar1 = PackedFloatingMUL(uVar1,0xbe800000be800000);
  uVar8 = PackedFloatingMUL(uVar2,0xbe800000be800000);
  uVar2 = PackedFloatingMUL(uVar1,uVar1);
  uVar4 = PackedFloatingMUL(uVar8 & 0xffffffff,uVar8 & 0xffffffff);
  uVar2 = PackedFloatingADD(uVar2,uVar4);
  uVar2 = PackedFloatingAccumulate(uVar2,uVar2);
  uVar4 = PackedFloatingReciprocalSQRAprox(uVar4,uVar2);
  uVar7 = PackedFloatingMUL(uVar4,uVar4);
  uVar7 = PackedFloatingReciprocalSQRIter1(uVar7,uVar2);
  uVar4 = PackedFloatingReciprocalIter2(uVar7,uVar4);
  PackedFloatingMUL(uVar2,uVar4);
  math_sincos_packed();
  uVar5 = PackedFloatingCompareGE(extraout_MM0_01 & 0x7fffffffffffffff,0x3400000034000000);
  uVar3 = (undefined4)(extraout_MM0_01 >> 0x20);
  uVar2 = PackedFloatingMUL(CONCAT44(uVar3,uVar3),CONCAT44(unaff_ESI,(int)uVar4));
  local_20 = (undefined4)uVar8;
  if ((uVar5 & 0x100000000) != 0) {
    uVar2 = CONCAT44((int)uVar2,(int)uVar2);
    uVar4 = PackedFloatingMUL(uVar8 & 0xffffffff,uVar2);
    local_20 = (undefined4)uVar4;
    uVar1 = PackedFloatingMUL(uVar1,uVar2);
  }
  uVar8 = CONCAT44((int)extraout_MM0_01,local_20);
  uVar10 = CONCAT44((int)uVar1,(int)((ulonglong)uVar1 >> 0x20));
  uVar12 = CONCAT44(local_20,(int)extraout_MM0_01);
  uVar5 = PackedFloatingMUL(uVar1,uVar13);
  uVar2 = PackedFloatingMUL(uVar8,uVar6);
  uVar7 = PackedFloatingMUL(uVar12 ^ 0x80000000,uVar6);
  uVar4 = PackedFloatingMUL(uVar10,uVar13);
  uVar2 = PackedFloatingADD(uVar5 ^ 0x80000000,uVar2);
  uVar4 = PackedFloatingSUB(uVar4,uVar7);
  uVar9 = PackedFloatingMUL(uVar12,uVar13);
  uVar4 = PackedFloatingAccumulate(uVar4,uVar2);
  uVar7 = PackedFloatingMUL(uVar10 ^ 0x80000000,uVar6);
  uVar1 = PackedFloatingMUL(uVar1,uVar6);
  *param_1 = uVar4;
  uVar2 = PackedFloatingMUL(uVar8 ^ 0x80000000,uVar13);
  uVar7 = PackedFloatingADD(uVar7,uVar9);
  uVar1 = PackedFloatingSUB(uVar2,uVar1);
  uVar1 = PackedFloatingAccumulate(uVar7,uVar1);
  param_1[1] = uVar1;
  uVar1 = PackedFloatingMUL(local_88,local_88);
  uVar2 = PackedFloatingMUL(local_80,local_80);
  uVar1 = PackedFloatingADD(uVar1,uVar2);
  uVar1 = PackedFloatingAccumulate(uVar1,uVar1);
  uVar2 = FloatingReciprocalAprox(uVar4,uVar1);
  uVar5 = PackedFloatingCompareGT(uVar1,0x80000000800000);
  uVar1 = PackedFloatingReciprocalIter1(uVar1,uVar2);
  uVar1 = PackedFloatingReciprocalIter2(uVar1,uVar2);
  uVar2 = PackedFloatingMUL((local_88 ^ 0x8000000080000000) & uVar5,uVar1);
  uVar9 = PackedFloatingMUL((local_80 ^ 0x80000000) & uVar5,uVar1);
  uVar8 = CONCAT44((int)uVar6,(int)(uVar6 >> 0x20));
  uVar10 = CONCAT44((int)uVar13,(int)(uVar13 >> 0x20));
  uVar5 = PackedFloatingMUL(uVar6,uVar9);
  uVar1 = PackedFloatingMUL(uVar13,uVar2);
  uVar7 = PackedFloatingMUL(uVar10 ^ 0x80000000,uVar2);
  uVar4 = PackedFloatingMUL(uVar8,uVar9);
  uVar1 = PackedFloatingADD(uVar5 ^ 0x80000000,uVar1);
  uVar4 = PackedFloatingSUB(uVar4,uVar7);
  uVar14 = PackedFloatingMUL(uVar10,uVar9);
  uVar4 = PackedFloatingAccumulate(uVar4,uVar1);
  uVar11 = PackedFloatingMUL(uVar8 ^ 0x80000000,uVar2);
  uVar1 = PackedFloatingMUL(uVar6,uVar2);
  uVar7 = PackedFloatingMUL(uVar13 ^ 0x80000000,uVar9);
  uVar11 = PackedFloatingADD(uVar11,uVar14);
  uVar1 = PackedFloatingSUB(uVar7,uVar1);
  uVar13 = PackedFloatingAccumulate(uVar11,uVar1);
  uVar5 = CONCAT44((int)local_78,(int)(local_78 >> 0x20));
  uVar8 = CONCAT44((int)local_70,(int)(local_70 >> 0x20));
  uVar6 = PackedFloatingMUL(local_78,uVar9);
  uVar1 = PackedFloatingMUL(local_70,uVar2);
  uVar11 = PackedFloatingMUL(uVar8 ^ 0x80000000,uVar2);
  uVar7 = PackedFloatingMUL(uVar5,uVar9);
  uVar1 = PackedFloatingADD(uVar6 ^ 0x80000000,uVar1);
  uVar7 = PackedFloatingSUB(uVar7,uVar11);
  uVar14 = PackedFloatingMUL(uVar8,uVar9);
  uVar7 = PackedFloatingAccumulate(uVar7,uVar1);
  uVar11 = PackedFloatingMUL(uVar5 ^ 0x80000000,uVar2);
  uVar1 = PackedFloatingMUL(local_78,uVar2);
  uVar2 = PackedFloatingMUL(local_70 ^ 0x80000000,uVar9);
  uVar9 = PackedFloatingADD(uVar11,uVar14);
  uVar1 = PackedFloatingSUB(uVar2,uVar1);
  uVar6 = PackedFloatingAccumulate(uVar9,uVar1);
  uVar3 = (undefined4)(uVar13 >> 0x20);
  uVar2 = PackedFloatingCompareGE(CONCAT44(uVar3,uVar3),0x3f8000003f800000);
  uVar1 = uVar7;
  if ((int)uVar2 == 0) {
    math_acos_packed();
    math_sin_packed();
    uVar2 = PackedFloatingCompareGE(extraout_MM0_02 & 0x7fffffff7fffffff,0x3400000034000000);
    if ((int)uVar2 != 0) {
      uVar1 = FloatingReciprocalAprox(uVar1,extraout_MM0_02);
      uVar2 = PackedFloatingReciprocalIter1(extraout_MM0_02,uVar1);
      uVar2 = PackedFloatingReciprocalIter2(uVar2,uVar1);
      uVar2 = PackedFloatingMUL(CONCAT44(extraout_MM0_Da_01,extraout_MM0_Da_01),uVar2);
      uVar4 = PackedFloatingMUL(uVar4,uVar2);
      uVar13 = PackedFloatingMUL(uVar13,uVar2);
    }
  }
  uVar3 = (undefined4)(uVar6 >> 0x20);
  uVar2 = PackedFloatingCompareGE(CONCAT44(uVar3,uVar3),0x3f8000003f800000);
  if ((int)uVar2 == 0) {
    math_acos_packed();
    math_sin_packed();
    uVar2 = PackedFloatingCompareGE(extraout_MM0_03 & 0x7fffffff7fffffff,0x3400000034000000);
    if ((int)uVar2 != 0) {
      uVar2 = FloatingReciprocalAprox(uVar1,extraout_MM0_03);
      uVar1 = PackedFloatingReciprocalIter1(extraout_MM0_03,uVar2);
      uVar1 = PackedFloatingReciprocalIter2(uVar1,uVar2);
      uVar1 = PackedFloatingMUL(CONCAT44(extraout_MM0_Da_02,extraout_MM0_Da_02),uVar1);
      uVar7 = PackedFloatingMUL(uVar7,uVar1);
      uVar6 = PackedFloatingMUL(uVar6,uVar1);
    }
  }
  uVar1 = PackedFloatingADD(uVar4,uVar7);
  uVar2 = PackedFloatingADD(uVar13 & 0xffffffff,uVar6 & 0xffffffff);
  uVar1 = PackedFloatingMUL(uVar1,0xbe800000be800000);
  uVar13 = PackedFloatingMUL(uVar2,0xbe800000be800000);
  uVar2 = PackedFloatingMUL(uVar1,uVar1);
  uVar4 = PackedFloatingMUL(uVar13 & 0xffffffff,uVar13 & 0xffffffff);
  uVar2 = PackedFloatingADD(uVar2,uVar4);
  uVar2 = PackedFloatingAccumulate(uVar2,uVar2);
  uVar4 = PackedFloatingReciprocalSQRAprox(uVar4,uVar2);
  uVar7 = PackedFloatingMUL(uVar4,uVar4);
  uVar7 = PackedFloatingReciprocalSQRIter1(uVar7,uVar2);
  uVar4 = PackedFloatingReciprocalIter2(uVar7,uVar4);
  PackedFloatingMUL(uVar2,uVar4);
  math_sincos_packed();
  uVar6 = PackedFloatingCompareGE(extraout_MM0_04 & 0x7fffffffffffffff,0x3400000034000000);
  uVar3 = (undefined4)(extraout_MM0_04 >> 0x20);
  uVar2 = PackedFloatingMUL(CONCAT44(uVar3,uVar3),CONCAT44(unaff_ESI,(int)uVar4));
  local_20 = (undefined4)uVar13;
  if ((uVar6 & 0x100000000) != 0) {
    uVar2 = CONCAT44((int)uVar2,(int)uVar2);
    uVar4 = PackedFloatingMUL(uVar13 & 0xffffffff,uVar2);
    local_20 = (undefined4)uVar4;
    uVar1 = PackedFloatingMUL(uVar1,uVar2);
  }
  uVar13 = CONCAT44((int)extraout_MM0_04,local_20);
  uVar5 = CONCAT44((int)uVar1,(int)((ulonglong)uVar1 >> 0x20));
  uVar8 = CONCAT44(local_20,(int)extraout_MM0_04);
  uVar6 = PackedFloatingMUL(uVar1,local_80);
  uVar2 = PackedFloatingMUL(uVar13,local_88);
  uVar7 = PackedFloatingMUL(uVar8 ^ 0x80000000,local_88);
  uVar4 = PackedFloatingMUL(uVar5,local_80);
  uVar2 = PackedFloatingADD(uVar6 ^ 0x80000000,uVar2);
  uVar4 = PackedFloatingSUB(uVar4,uVar7);
  uVar7 = PackedFloatingMUL(uVar8,local_80);
  uVar2 = PackedFloatingAccumulate(uVar4,uVar2);
  uVar4 = PackedFloatingMUL(uVar5 ^ 0x80000000,local_88);
  uVar1 = PackedFloatingMUL(uVar1,local_88);
  *param_2 = uVar2;
  uVar2 = PackedFloatingMUL(uVar13 ^ 0x80000000,local_80);
  uVar4 = PackedFloatingADD(uVar4,uVar7);
  uVar1 = PackedFloatingSUB(uVar2,uVar1);
  uVar1 = PackedFloatingAccumulate(uVar4,uVar1);
  param_2[1] = uVar1;
  *param_3 = local_88;
  param_3[1] = local_80;
  FastExitMediaState();
  return;
}



/* FUN_0045b092 @ 0045b092 */

void __cdecl FUN_0045b092(undefined8 *param_1)

{
  *param_1 = 0x3f800000;
  param_1[1] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0x3f800000;
  param_1[6] = 0;
  param_1[2] = 0x3f80000000000000;
  param_1[7] = 0x3f80000000000000;
  FastExitMediaState();
  return;
}



/* FUN_0045b252 @ 0045b252 */

void FUN_0045b252(ulonglong *param_1,undefined8 *param_2,undefined8 *param_3,ulonglong *param_4,
                 undefined8 *param_5,undefined8 *param_6,undefined8 *param_7)

{
  undefined4 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined4 uVar7;
  ulonglong uVar5;
  ulonglong uVar6;
  undefined8 uVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  undefined4 uVar16;
  ulonglong uVar14;
  undefined8 uVar15;
  ulonglong uVar17;
  undefined8 uVar18;
  undefined8 uVar19;
  undefined8 uVar20;
  undefined8 uVar21;
  uint uVar24;
  undefined8 uVar22;
  undefined8 uVar23;
  undefined4 uVar25;
  undefined8 uVar26;
  undefined4 uVar29;
  ulonglong uVar27;
  ulonglong uVar28;
  
  if (param_4 == (ulonglong *)0x0) {
    *param_1 = 0x3f800000;
    param_1[1] = 0;
    param_1[2] = 0x3f80000000000000;
    param_1[3] = 0;
    param_1[4] = 0;
    param_1[5] = 0x3f800000;
    param_1[6] = 0;
    param_1[7] = 0x3f80000000000000;
  }
  else if (param_3 == (undefined8 *)0x0) {
    uVar12 = *param_4;
    uVar11 = param_4[1];
    *param_1 = uVar12 & 0xffffffff;
    param_1[1] = 0;
    param_1[2] = uVar12 & 0xffffffff00000000;
    param_1[3] = 0;
    param_1[4] = 0;
    param_1[5] = (ulonglong)(uint)uVar11;
    param_1[6] = 0;
    param_1[7] = 0x3f80000000000000;
  }
  else {
    uVar13 = (ulonglong)(uint)param_4[1];
    uVar27 = *param_4 & 0xffffffff;
    uVar17 = *param_4 & 0xffffffff00000000;
    uVar21 = *param_3;
    uVar4 = param_3[1];
    uVar2 = PackedFloatingADD(uVar21,uVar21);
    uVar3 = PackedFloatingADD(uVar4,uVar4);
    uVar7 = (undefined4)((ulonglong)uVar21 >> 0x20);
    uVar16 = (undefined4)((ulonglong)uVar4 >> 0x20);
    uVar26 = CONCAT44(uVar16,uVar16);
    uVar8 = PackedFloatingMUL(uVar21,uVar2);
    uVar21 = CONCAT44((int)uVar2,(int)uVar3);
    uVar18 = PackedFloatingMUL(uVar2,uVar26);
    uVar3 = PackedFloatingMUL(CONCAT44((int)uVar4,(int)uVar4),uVar21);
    uVar4 = PackedFloatingMUL(uVar21,CONCAT44(uVar7,uVar7));
    uVar21 = PackedFloatingMUL(uVar21,uVar26);
    uVar2 = CONCAT44((int)((ulonglong)uVar3 >> 0x20),(int)((ulonglong)uVar4 >> 0x20));
    uVar26 = PackedFloatingADD(CONCAT44((int)uVar3,(int)uVar3),uVar8);
    uVar3 = PackedFloatingAccumulate(uVar8,uVar8);
    uVar21 = CONCAT44((int)((ulonglong)uVar18 >> 0x20),(int)uVar21);
    uVar9 = PackedFloatingSUBR(uVar3,0x3f8000003f800000);
    uVar8 = PackedFloatingSUBR(uVar26,0x3f8000003f800000);
    uVar10 = uVar9 & 0xffffffff;
    uVar3 = PackedFloatingADD(uVar2,uVar21);
    uVar14 = PackedFloatingSUB(uVar2,uVar21);
    uVar5 = PackedFloatingADD(uVar4,uVar18);
    uVar11 = PackedFloatingSUB(uVar4,uVar18);
    uVar28 = uVar5 & 0xffffffff;
    uVar16 = (undefined4)uVar14;
    uVar25 = (undefined4)uVar8;
    uVar4 = CONCAT44(uVar25,uVar16);
    uVar7 = (undefined4)uVar3;
    uVar12 = uVar14 >> 0x20;
    uVar24 = (uint)((ulonglong)uVar3 >> 0x20);
    uVar29 = (undefined4)((ulonglong)uVar8 >> 0x20);
    uVar21 = CONCAT44(uVar7,uVar29);
    uVar2 = CONCAT44((int)uVar11,uVar24);
    uVar1 = (undefined4)(uVar14 >> 0x20);
    if (param_2 == (undefined8 *)0x0) {
      *param_1 = CONCAT44(uVar16,uVar29);
      param_1[2] = CONCAT44(uVar25,uVar7);
      param_1[5] = uVar9 & 0xffffffff;
      param_1[7] = 0x3f80000000000000;
      param_1[4] = CONCAT44((int)uVar5,uVar1);
      param_1[6] = 0;
      param_1[3] = uVar11 & 0xffffffff;
      param_1[1] = (ulonglong)uVar24;
      uVar7 = (undefined4)(*param_1 >> 0x20);
      uVar16 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar27,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,0);
      uVar20 = PackedFloatingMUL(uVar17,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(0,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar13);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar5 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      *param_1 = uVar5;
      param_1[1] = uVar11;
      uVar7 = (undefined4)(param_1[2] >> 0x20);
      uVar16 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar27,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,0);
      uVar20 = PackedFloatingMUL(uVar17,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(0,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar13);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar5 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      param_1[2] = uVar5;
      param_1[3] = uVar11;
      uVar7 = (undefined4)(param_1[4] >> 0x20);
      uVar16 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar27,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,0);
      uVar20 = PackedFloatingMUL(uVar17,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(0,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar13);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar5 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      param_1[4] = uVar5;
      param_1[5] = uVar11;
      uVar7 = (undefined4)(param_1[6] >> 0x20);
      uVar16 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar27,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,0);
      uVar20 = PackedFloatingMUL(uVar17,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(0,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar13);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar27 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      param_1[6] = uVar27;
      param_1[7] = uVar11;
      uVar7 = (undefined4)(*param_1 >> 0x20);
      uVar16 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar4,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar28);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar2,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar10);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar27 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      *param_1 = uVar27;
      param_1[1] = uVar11;
      uVar7 = (undefined4)(param_1[2] >> 0x20);
      uVar16 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar4,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar28);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar2,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar10);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar27 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      param_1[2] = uVar27;
      param_1[3] = uVar11;
      uVar7 = (undefined4)(param_1[4] >> 0x20);
      uVar16 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar4,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar28);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar2,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar10);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar27 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      param_1[4] = uVar27;
      param_1[5] = uVar11;
      uVar7 = (undefined4)(param_1[6] >> 0x20);
      uVar16 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar3 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar26 = PackedFloatingMUL(uVar21,uVar3);
      uVar21 = CONCAT44(uVar7,uVar7);
      uVar3 = PackedFloatingMUL(uVar3,uVar12);
      uVar18 = PackedFloatingMUL(uVar4,uVar21);
      uVar4 = CONCAT44(uVar16,uVar16);
      uVar21 = PackedFloatingMUL(uVar21,uVar28);
      uVar26 = PackedFloatingADD(uVar18,uVar26);
      uVar18 = PackedFloatingMUL(uVar2,uVar8);
      uVar2 = PackedFloatingADD(uVar21,uVar3);
      uVar21 = PackedFloatingMUL(uVar8,uVar10);
      uVar3 = PackedFloatingADD(uVar18,uVar26);
      uVar8 = PackedFloatingMUL(0,uVar4);
      uVar21 = PackedFloatingADD(uVar2,uVar21);
      uVar4 = PackedFloatingMUL(uVar4,0x3f80000000000000);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      uVar12 = PackedFloatingADD(uVar4,uVar21);
      param_1[6] = uVar11;
      param_1[7] = uVar12;
    }
    else {
      uVar26 = CONCAT44(uVar16,uVar29);
      uVar20 = CONCAT44(uVar25,uVar7);
      uVar9 = uVar9 & 0xffffffff;
      uVar22 = CONCAT44((int)uVar5,uVar1);
      uVar11 = uVar11 & 0xffffffff;
      uVar14 = (ulonglong)uVar24;
      uVar3 = *param_2;
      uVar24 = *(uint *)(param_2 + 1);
      *param_1 = 0x3f800000;
      param_1[1] = 0;
      param_1[2] = 0x3f80000000000000;
      param_1[3] = 0;
      param_1[4] = 0;
      param_1[5] = 0x3f800000;
      uVar6 = PackedFloatingSUB(0x3f80000000000000,(ulonglong)uVar24);
      uVar5 = PackedFloatingSUB(0,uVar3);
      param_1[7] = uVar6;
      param_1[6] = uVar5;
      uVar7 = (undefined4)(*param_1 >> 0x20);
      uVar16 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar23 = CONCAT44(uVar1,uVar1);
      uVar15 = PackedFloatingMUL(uVar26,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar18 = PackedFloatingMUL(uVar8,uVar14);
      uVar19 = PackedFloatingMUL(uVar20,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar11);
      uVar15 = PackedFloatingADD(uVar19,uVar15);
      uVar19 = PackedFloatingMUL(uVar22,uVar23);
      uVar18 = PackedFloatingADD(uVar3,uVar18);
      uVar3 = PackedFloatingMUL(uVar23,uVar9);
      uVar23 = PackedFloatingADD(uVar19,uVar15);
      uVar15 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar18,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar6 = PackedFloatingADD(uVar15,uVar23);
      uVar5 = PackedFloatingADD(uVar8,uVar3);
      *param_1 = uVar6;
      param_1[1] = uVar5;
      uVar7 = (undefined4)(param_1[2] >> 0x20);
      uVar16 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar23 = CONCAT44(uVar1,uVar1);
      uVar15 = PackedFloatingMUL(uVar26,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar18 = PackedFloatingMUL(uVar8,uVar14);
      uVar19 = PackedFloatingMUL(uVar20,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar11);
      uVar15 = PackedFloatingADD(uVar19,uVar15);
      uVar19 = PackedFloatingMUL(uVar22,uVar23);
      uVar18 = PackedFloatingADD(uVar3,uVar18);
      uVar3 = PackedFloatingMUL(uVar23,uVar9);
      uVar23 = PackedFloatingADD(uVar19,uVar15);
      uVar15 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar18,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar6 = PackedFloatingADD(uVar15,uVar23);
      uVar5 = PackedFloatingADD(uVar8,uVar3);
      param_1[2] = uVar6;
      param_1[3] = uVar5;
      uVar7 = (undefined4)(param_1[4] >> 0x20);
      uVar16 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar23 = CONCAT44(uVar1,uVar1);
      uVar15 = PackedFloatingMUL(uVar26,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar18 = PackedFloatingMUL(uVar8,uVar14);
      uVar19 = PackedFloatingMUL(uVar20,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar11);
      uVar15 = PackedFloatingADD(uVar19,uVar15);
      uVar19 = PackedFloatingMUL(uVar22,uVar23);
      uVar18 = PackedFloatingADD(uVar3,uVar18);
      uVar3 = PackedFloatingMUL(uVar23,uVar9);
      uVar23 = PackedFloatingADD(uVar19,uVar15);
      uVar15 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar18,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar6 = PackedFloatingADD(uVar15,uVar23);
      uVar5 = PackedFloatingADD(uVar8,uVar3);
      param_1[4] = uVar6;
      param_1[5] = uVar5;
      uVar7 = (undefined4)(param_1[6] >> 0x20);
      uVar16 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar26,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar14);
      uVar20 = PackedFloatingMUL(uVar20,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar11);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar22,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar9);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar5 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      param_1[6] = uVar5;
      param_1[7] = uVar11;
      uVar7 = (undefined4)(*param_1 >> 0x20);
      uVar16 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar27,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,0);
      uVar20 = PackedFloatingMUL(uVar17,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(0,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar13);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar5 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      *param_1 = uVar5;
      param_1[1] = uVar11;
      uVar7 = (undefined4)(param_1[2] >> 0x20);
      uVar16 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar27,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,0);
      uVar20 = PackedFloatingMUL(uVar17,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(0,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar13);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar5 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      param_1[2] = uVar5;
      param_1[3] = uVar11;
      uVar7 = (undefined4)(param_1[4] >> 0x20);
      uVar16 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar27,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,0);
      uVar20 = PackedFloatingMUL(uVar17,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(0,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar13);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar5 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      param_1[4] = uVar5;
      param_1[5] = uVar11;
      uVar7 = (undefined4)(param_1[6] >> 0x20);
      uVar16 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar27,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,0);
      uVar20 = PackedFloatingMUL(uVar17,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(0,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar13);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar27 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      param_1[6] = uVar27;
      param_1[7] = uVar11;
      uVar7 = (undefined4)(*param_1 >> 0x20);
      uVar16 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar4,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar28);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar2,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar10);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar27 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      *param_1 = uVar27;
      param_1[1] = uVar11;
      uVar7 = (undefined4)(param_1[2] >> 0x20);
      uVar16 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar4,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar28);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar2,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar10);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar27 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      param_1[2] = uVar27;
      param_1[3] = uVar11;
      uVar7 = (undefined4)(param_1[4] >> 0x20);
      uVar16 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar4,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar28);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar2,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar10);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar27 = PackedFloatingADD(uVar23,uVar18);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      param_1[4] = uVar27;
      param_1[5] = uVar11;
      uVar7 = (undefined4)(param_1[6] >> 0x20);
      uVar16 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar3 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar26 = PackedFloatingMUL(uVar21,uVar3);
      uVar21 = CONCAT44(uVar7,uVar7);
      uVar3 = PackedFloatingMUL(uVar3,uVar12);
      uVar18 = PackedFloatingMUL(uVar4,uVar21);
      uVar4 = CONCAT44(uVar16,uVar16);
      uVar21 = PackedFloatingMUL(uVar21,uVar28);
      uVar26 = PackedFloatingADD(uVar18,uVar26);
      uVar18 = PackedFloatingMUL(uVar2,uVar8);
      uVar2 = PackedFloatingADD(uVar21,uVar3);
      uVar21 = PackedFloatingMUL(uVar8,uVar10);
      uVar3 = PackedFloatingADD(uVar18,uVar26);
      uVar8 = PackedFloatingMUL(0,uVar4);
      uVar21 = PackedFloatingADD(uVar2,uVar21);
      uVar4 = PackedFloatingMUL(uVar4,0x3f80000000000000);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      uVar12 = PackedFloatingADD(uVar4,uVar21);
      param_1[6] = uVar11;
      param_1[7] = uVar12;
      uVar12 = PackedFloatingADD(*param_2,param_1[6]);
      uVar21 = PackedFloatingADD((ulonglong)*(uint *)(param_2 + 1),(ulonglong)(uint)param_1[7]);
      param_1[6] = uVar12;
      *(int *)(param_1 + 7) = (int)uVar21;
    }
  }
  if (param_6 != (undefined8 *)0x0) {
    uVar21 = *param_6;
    uVar4 = param_6[1];
    uVar2 = PackedFloatingADD(uVar21,uVar21);
    uVar3 = PackedFloatingADD(uVar4,uVar4);
    uVar7 = (undefined4)((ulonglong)uVar21 >> 0x20);
    uVar16 = (undefined4)((ulonglong)uVar4 >> 0x20);
    uVar26 = CONCAT44(uVar16,uVar16);
    uVar8 = PackedFloatingMUL(uVar21,uVar2);
    uVar21 = CONCAT44((int)uVar2,(int)uVar3);
    uVar18 = PackedFloatingMUL(uVar2,uVar26);
    uVar3 = PackedFloatingMUL(CONCAT44((int)uVar4,(int)uVar4),uVar21);
    uVar4 = PackedFloatingMUL(uVar21,CONCAT44(uVar7,uVar7));
    uVar21 = PackedFloatingMUL(uVar21,uVar26);
    uVar2 = CONCAT44((int)((ulonglong)uVar3 >> 0x20),(int)((ulonglong)uVar4 >> 0x20));
    uVar26 = PackedFloatingADD(CONCAT44((int)uVar3,(int)uVar3),uVar8);
    uVar3 = PackedFloatingAccumulate(uVar8,uVar8);
    uVar21 = CONCAT44((int)((ulonglong)uVar18 >> 0x20),(int)uVar21);
    uVar27 = PackedFloatingSUBR(uVar3,0x3f8000003f800000);
    uVar8 = PackedFloatingSUBR(uVar26,0x3f8000003f800000);
    uVar27 = uVar27 & 0xffffffff;
    uVar3 = PackedFloatingADD(uVar2,uVar21);
    uVar12 = PackedFloatingSUB(uVar2,uVar21);
    uVar11 = PackedFloatingADD(uVar4,uVar18);
    uVar4 = PackedFloatingSUB(uVar4,uVar18);
    uVar11 = uVar11 & 0xffffffff;
    uVar2 = CONCAT44((int)uVar8,(int)uVar12);
    uVar12 = uVar12 >> 0x20;
    uVar21 = CONCAT44((int)uVar3,(int)((ulonglong)uVar8 >> 0x20));
    uVar4 = CONCAT44((int)uVar4,(int)((ulonglong)uVar3 >> 0x20));
    if (param_5 == (undefined8 *)0x0) {
      uVar7 = (undefined4)(*param_1 >> 0x20);
      uVar16 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar2,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar11);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar4,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar27);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar23,uVar18);
      uVar5 = PackedFloatingADD(uVar8,uVar3);
      *param_1 = uVar28;
      param_1[1] = uVar5;
      uVar7 = (undefined4)(param_1[2] >> 0x20);
      uVar16 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar2,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar11);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar4,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar27);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar23,uVar18);
      uVar5 = PackedFloatingADD(uVar8,uVar3);
      param_1[2] = uVar28;
      param_1[3] = uVar5;
      uVar7 = (undefined4)(param_1[4] >> 0x20);
      uVar16 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar2,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar11);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar4,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar27);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar23,uVar18);
      uVar5 = PackedFloatingADD(uVar8,uVar3);
      param_1[4] = uVar28;
      param_1[5] = uVar5;
      uVar7 = (undefined4)(param_1[6] >> 0x20);
      uVar16 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar3 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar26 = PackedFloatingMUL(uVar21,uVar3);
      uVar21 = CONCAT44(uVar7,uVar7);
      uVar3 = PackedFloatingMUL(uVar3,uVar12);
      uVar18 = PackedFloatingMUL(uVar2,uVar21);
      uVar2 = CONCAT44(uVar16,uVar16);
      uVar21 = PackedFloatingMUL(uVar21,uVar11);
      uVar26 = PackedFloatingADD(uVar18,uVar26);
      uVar18 = PackedFloatingMUL(uVar4,uVar8);
      uVar4 = PackedFloatingADD(uVar21,uVar3);
      uVar21 = PackedFloatingMUL(uVar8,uVar27);
      uVar3 = PackedFloatingADD(uVar18,uVar26);
      uVar8 = PackedFloatingMUL(0,uVar2);
      uVar21 = PackedFloatingADD(uVar4,uVar21);
      uVar4 = PackedFloatingMUL(uVar2,0x3f80000000000000);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      uVar12 = PackedFloatingADD(uVar4,uVar21);
      param_1[6] = uVar11;
      param_1[7] = uVar12;
    }
    else {
      uVar5 = PackedFloatingSUB(param_1[6],*param_5);
      uVar3 = PackedFloatingSUB((ulonglong)(uint)param_1[7],(ulonglong)*(uint *)(param_5 + 1));
      param_1[6] = uVar5;
      *(int *)(param_1 + 7) = (int)uVar3;
      uVar7 = (undefined4)(*param_1 >> 0x20);
      uVar16 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar2,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar11);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar4,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar27);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar23,uVar18);
      uVar5 = PackedFloatingADD(uVar8,uVar3);
      *param_1 = uVar28;
      param_1[1] = uVar5;
      uVar7 = (undefined4)(param_1[2] >> 0x20);
      uVar16 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar2,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar11);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar4,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar27);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar23,uVar18);
      uVar5 = PackedFloatingADD(uVar8,uVar3);
      param_1[2] = uVar28;
      param_1[3] = uVar5;
      uVar7 = (undefined4)(param_1[4] >> 0x20);
      uVar16 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar18 = CONCAT44(uVar1,uVar1);
      uVar23 = PackedFloatingMUL(uVar21,uVar8);
      uVar3 = CONCAT44(uVar7,uVar7);
      uVar26 = PackedFloatingMUL(uVar8,uVar12);
      uVar20 = PackedFloatingMUL(uVar2,uVar3);
      uVar8 = CONCAT44(uVar16,uVar16);
      uVar3 = PackedFloatingMUL(uVar3,uVar11);
      uVar23 = PackedFloatingADD(uVar20,uVar23);
      uVar20 = PackedFloatingMUL(uVar4,uVar18);
      uVar26 = PackedFloatingADD(uVar3,uVar26);
      uVar3 = PackedFloatingMUL(uVar18,uVar27);
      uVar18 = PackedFloatingADD(uVar20,uVar23);
      uVar23 = PackedFloatingMUL(0,uVar8);
      uVar3 = PackedFloatingADD(uVar26,uVar3);
      uVar8 = PackedFloatingMUL(uVar8,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar23,uVar18);
      uVar5 = PackedFloatingADD(uVar8,uVar3);
      param_1[4] = uVar28;
      param_1[5] = uVar5;
      uVar7 = (undefined4)(param_1[6] >> 0x20);
      uVar16 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar3 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar26 = PackedFloatingMUL(uVar21,uVar3);
      uVar21 = CONCAT44(uVar7,uVar7);
      uVar3 = PackedFloatingMUL(uVar3,uVar12);
      uVar18 = PackedFloatingMUL(uVar2,uVar21);
      uVar2 = CONCAT44(uVar16,uVar16);
      uVar21 = PackedFloatingMUL(uVar21,uVar11);
      uVar26 = PackedFloatingADD(uVar18,uVar26);
      uVar18 = PackedFloatingMUL(uVar4,uVar8);
      uVar4 = PackedFloatingADD(uVar21,uVar3);
      uVar21 = PackedFloatingMUL(uVar8,uVar27);
      uVar3 = PackedFloatingADD(uVar18,uVar26);
      uVar8 = PackedFloatingMUL(0,uVar2);
      uVar21 = PackedFloatingADD(uVar4,uVar21);
      uVar4 = PackedFloatingMUL(uVar2,0x3f80000000000000);
      uVar11 = PackedFloatingADD(uVar8,uVar3);
      uVar12 = PackedFloatingADD(uVar4,uVar21);
      param_1[6] = uVar11;
      param_1[7] = uVar12;
      uVar12 = PackedFloatingADD(param_1[6],*param_5);
      uVar21 = PackedFloatingADD((ulonglong)(uint)param_1[7],(ulonglong)*(uint *)(param_5 + 1));
      param_1[6] = uVar12;
      *(int *)(param_1 + 7) = (int)uVar21;
    }
  }
  if (param_7 != (undefined8 *)0x0) {
    uVar12 = PackedFloatingADD(param_1[6],*param_7);
    uVar21 = PackedFloatingADD((ulonglong)(uint)param_1[7],(ulonglong)*(uint *)(param_7 + 1));
    param_1[6] = uVar12;
    *(int *)(param_1 + 7) = (int)uVar21;
  }
  FastExitMediaState();
  return;
}



/* FUN_0045c3ea @ 0045c3ea */

void FUN_0045c3ea(undefined8 *param_1,undefined8 param_2,undefined8 param_3)

{
  undefined4 uVar1;
  undefined8 extraout_MM0;
  undefined8 extraout_MM0_00;
  undefined8 extraout_MM0_01;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  undefined4 uVar8;
  undefined8 uVar6;
  ulonglong uVar7;
  undefined8 uVar9;
  undefined8 uVar10;
  undefined4 uVar11;
  undefined8 uVar12;
  
  PackedFloatingMUL(0x3f0000003f000000,param_3);
  PackedFloatingMUL(0x3f0000003f000000,param_2);
  math_sincos_packed();
  math_sincos_packed();
  math_sincos_packed();
  uVar1 = (undefined4)extraout_MM0_01;
  uVar8 = (undefined4)((ulonglong)extraout_MM0_01 >> 0x20);
  uVar4 = CONCAT44((int)extraout_MM0_00,(int)extraout_MM0_00);
  uVar11 = (undefined4)((ulonglong)extraout_MM0_00 >> 0x20);
  uVar9 = CONCAT44(uVar11,uVar11);
  uVar2 = PackedFloatingMUL(CONCAT44(uVar1,uVar1) ^ 0x8000000000000000,uVar9);
  uVar3 = PackedFloatingMUL(CONCAT44(uVar1,uVar1),uVar4);
  uVar6 = PackedFloatingMUL(CONCAT44(uVar8,uVar8),uVar4);
  uVar9 = PackedFloatingMUL(CONCAT44(uVar8,uVar8) ^ 0x80000000,uVar9);
  uVar12 = CONCAT44((int)extraout_MM0,(int)((ulonglong)extraout_MM0 >> 0x20));
  uVar2 = PackedFloatingMUL(uVar2,extraout_MM0);
  uVar4 = PackedFloatingMUL(uVar3,uVar12);
  uVar3 = PackedFloatingMUL(uVar6,uVar12);
  uVar6 = PackedFloatingMUL(uVar9,extraout_MM0);
  uVar2 = PackedFloatingADD(uVar2,uVar3);
  uVar6 = PackedFloatingADD(uVar4,uVar6);
  uVar4 = PackedFloatingADD(uVar2,uVar2);
  uVar3 = PackedFloatingADD(uVar6,uVar6);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  uVar8 = (undefined4)((ulonglong)uVar6 >> 0x20);
  uVar12 = CONCAT44(uVar8,uVar8);
  uVar9 = PackedFloatingMUL(uVar2,uVar4);
  uVar2 = CONCAT44((int)uVar4,(int)uVar3);
  uVar10 = PackedFloatingMUL(uVar4,uVar12);
  uVar6 = PackedFloatingMUL(CONCAT44((int)uVar6,(int)uVar6),uVar2);
  uVar4 = PackedFloatingMUL(uVar2,CONCAT44(uVar1,uVar1));
  uVar2 = PackedFloatingMUL(uVar2,uVar12);
  uVar3 = CONCAT44((int)((ulonglong)uVar6 >> 0x20),(int)((ulonglong)uVar4 >> 0x20));
  param_1[6] = 0;
  uVar12 = PackedFloatingADD(CONCAT44((int)uVar6,(int)uVar6),uVar9);
  uVar6 = PackedFloatingAccumulate(uVar9,uVar9);
  uVar2 = CONCAT44((int)((ulonglong)uVar10 >> 0x20),(int)uVar2);
  uVar5 = PackedFloatingSUBR(uVar6,0x3f8000003f800000);
  uVar9 = PackedFloatingSUBR(uVar12,0x3f8000003f800000);
  uVar6 = PackedFloatingADD(uVar3,uVar2);
  param_1[5] = uVar5 & 0xffffffff;
  uVar7 = PackedFloatingSUB(uVar3,uVar2);
  uVar5 = PackedFloatingADD(uVar4,uVar10);
  uVar2 = PackedFloatingSUB(uVar4,uVar10);
  param_1[3] = uVar5 & 0xffffffff;
  param_1[1] = uVar7 >> 0x20;
  param_1[2] = CONCAT44((int)uVar9,(int)uVar7);
  *param_1 = CONCAT44((int)uVar6,(int)((ulonglong)uVar9 >> 0x20));
  param_1[4] = CONCAT44((int)uVar2,(int)((ulonglong)uVar6 >> 0x20));
  param_1[7] = 0x3f80000000000000;
  FastExitMediaState();
  return;
}



/* FUN_0045cac3 @ 0045cac3 */

void FUN_0045cac3(undefined8 *param_1,ulonglong *param_2)

{
  undefined8 extraout_MM0;
  undefined8 uVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  ulonglong uVar7;
  undefined8 uVar8;
  undefined4 uVar9;
  ulonglong local_20;
  uint local_18;
  
  local_20 = *param_2;
  local_18 = (uint)param_2[1];
  FUN_0045e832(&local_20,&local_20);
  math_sincos_packed();
  uVar1 = PackedFloatingSUBR(extraout_MM0,0x3f8000003f800000);
  uVar9 = (undefined4)((ulonglong)extraout_MM0 >> 0x20);
  uVar3 = (ulonglong)local_18;
  uVar4 = PackedFloatingMUL(CONCAT44(local_18,local_18),local_20);
  uVar1 = CONCAT44((int)uVar1,(int)uVar1);
  uVar2 = PackedFloatingMUL(CONCAT44(local_18,(int)(local_20 >> 0x20)),local_20);
  uVar8 = CONCAT44((int)extraout_MM0,(int)extraout_MM0);
  uVar2 = PackedFloatingMUL(uVar2,uVar1);
  uVar4 = PackedFloatingMUL(uVar4,uVar1);
  uVar5 = PackedFloatingMUL(local_20,local_20);
  uVar6 = PackedFloatingMUL(uVar3,uVar3);
  uVar5 = PackedFloatingMUL(uVar5,uVar1);
  uVar1 = PackedFloatingMUL(uVar6,uVar1);
  uVar5 = PackedFloatingADD(uVar5,uVar8);
  uVar7 = PackedFloatingADD(uVar1,uVar8);
  uVar1 = CONCAT44(uVar9,uVar9);
  uVar8 = PackedFloatingMUL(local_20,uVar1);
  uVar1 = PackedFloatingMUL(uVar3,uVar1);
  param_1[6] = 0;
  uVar6 = CONCAT44((int)uVar8,(int)uVar1);
  uVar9 = (undefined4)((ulonglong)uVar8 >> 0x20);
  uVar8 = CONCAT44(uVar9,uVar9);
  param_1[5] = uVar7 & 0xffffffff;
  uVar1 = PackedFloatingSUB(uVar2,uVar6);
  uVar3 = PackedFloatingADD(uVar2,uVar6);
  uVar7 = PackedFloatingSUB(uVar4,uVar8);
  *param_1 = CONCAT44((int)uVar3,(int)uVar5);
  param_1[1] = uVar7 & 0xffffffff;
  uVar8 = PackedFloatingADD(CONCAT44((int)uVar4,(int)uVar4),uVar8);
  param_1[3] = uVar3 >> 0x20;
  param_1[7] = 0x3f80000000000000;
  param_1[4] = CONCAT44((int)((ulonglong)uVar1 >> 0x20),(int)((ulonglong)uVar8 >> 0x20));
  param_1[2] = CONCAT44((int)((ulonglong)uVar5 >> 0x20),(int)uVar1);
  FastExitMediaState();
  return;
}



/* FUN_0045cbdc @ 0045cbdc */

void FUN_0045cbdc(ulonglong *param_1,undefined8 *param_2,undefined8 *param_3,ulonglong *param_4,
                 undefined8 *param_5,undefined8 *param_6,undefined8 *param_7)

{
  undefined4 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined8 uVar7;
  undefined8 in_MM2;
  undefined8 uVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  uint uVar11;
  ulonglong in_MM3;
  undefined8 uVar12;
  undefined8 uVar13;
  ulonglong uVar14;
  ulonglong uVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  undefined8 uVar18;
  ulonglong uVar19;
  undefined8 uVar20;
  ulonglong uVar21;
  ulonglong uVar22;
  undefined8 uVar23;
  undefined8 uVar24;
  undefined4 uVar26;
  undefined8 uVar25;
  undefined4 uVar27;
  ulonglong uVar28;
  ulonglong uVar29;
  
  if (param_4 == (ulonglong *)0x0) {
    uVar16 = PackedSwapDWords(in_MM2,0x3f800000);
    *param_1 = 0x3f800000;
    param_1[1] = 0;
    param_1[2] = uVar16;
    param_1[3] = 0;
    param_1[4] = 0;
    param_1[5] = 0x3f800000;
    param_1[6] = 0;
    param_1[7] = uVar16;
  }
  else if (param_3 == (undefined8 *)0x0) {
    in_MM3 = *param_4;
    uVar16 = param_4[1];
    *param_1 = in_MM3 & 0xffffffff;
    param_1[1] = 0;
    param_1[2] = in_MM3 & 0xffffffff00000000;
    param_1[3] = 0;
    param_1[4] = 0;
    param_1[5] = (ulonglong)(uint)uVar16;
    param_1[6] = 0;
    param_1[7] = 0x3f80000000000000;
  }
  else {
    uVar16 = *param_4;
    uVar17 = (ulonglong)(uint)param_4[1];
    uVar28 = uVar16 & 0xffffffff;
    uVar21 = uVar16 & 0xffffffff00000000;
    uVar4 = *param_3;
    uVar18 = param_3[1];
    uVar12 = PackedSwapDWords(uVar16,uVar4);
    uVar2 = PackedFloatingADD(uVar4,uVar4);
    uVar7 = PackedFloatingADD(uVar18,uVar18);
    uVar3 = PackedFloatingMUL(uVar2,uVar4);
    uVar8 = PackedFloatingMUL(uVar4,uVar7);
    uVar13 = PackedFloatingMUL(uVar12,uVar7);
    uVar12 = PackedFloatingMUL(uVar7,uVar18);
    uVar2 = PackedFloatingMUL(CONCAT44((int)((ulonglong)uVar18 >> 0x20),
                                       (int)((ulonglong)uVar4 >> 0x20)),
                              CONCAT44((int)uVar7,(int)uVar2));
    uVar4 = PackedFloatingSUBR(uVar3,0x3f8000003f800000);
    uVar14 = PackedFloatingPosNegAccumulate(uVar13,uVar13);
    uVar18 = PackedFloatingAccumulate(uVar3,uVar3);
    uVar3 = PackedFloatingPosNegAccumulate(uVar2,uVar2);
    uVar9 = PackedFloatingPosNegAccumulate(uVar8,uVar8);
    uVar4 = PackedFloatingSUB(uVar4,CONCAT44((int)uVar12,(int)uVar12));
    uVar22 = PackedSwapDWords(uVar12,uVar9);
    uVar19 = PackedFloatingSUBR(uVar18,0x3f8000003f800000);
    uVar2 = CONCAT44((int)uVar14,(int)uVar22);
    uVar10 = uVar9 & 0xffffffff;
    uVar16 = uVar19 >> 0x20;
    uVar5 = (undefined4)((ulonglong)uVar4 >> 0x20);
    uVar26 = (undefined4)((ulonglong)uVar3 >> 0x20);
    uVar18 = CONCAT44(uVar26,uVar5);
    uVar29 = uVar14 >> 0x20;
    uVar6 = (undefined4)uVar4;
    uVar1 = (undefined4)uVar3;
    uVar4 = CONCAT44(uVar6,uVar1);
    uVar27 = (undefined4)(uVar14 >> 0x20);
    uVar11 = (uint)(uVar19 >> 0x20);
    if (param_2 == (undefined8 *)0x0) {
      *param_1 = CONCAT44(uVar1,uVar5);
      param_1[2] = CONCAT44(uVar6,uVar26);
      param_1[5] = (ulonglong)uVar11;
      param_1[7] = 0x3f80000000000000;
      param_1[4] = CONCAT44(uVar27,(int)uVar9);
      param_1[6] = 0;
      param_1[3] = uVar14 & 0xffffffff;
      param_1[1] = uVar22 & 0xffffffff;
      uVar5 = (undefined4)(*param_1 >> 0x20);
      uVar6 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar28,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,0);
      uVar24 = PackedFloatingMUL(uVar21,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(0,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar17);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      *param_1 = uVar9;
      param_1[1] = uVar14;
      uVar5 = (undefined4)(param_1[2] >> 0x20);
      uVar6 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar28,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,0);
      uVar24 = PackedFloatingMUL(uVar21,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(0,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar17);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      param_1[2] = uVar9;
      param_1[3] = uVar14;
      uVar5 = (undefined4)(param_1[4] >> 0x20);
      uVar6 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar28,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,0);
      uVar24 = PackedFloatingMUL(uVar21,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(0,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar17);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      param_1[4] = uVar9;
      param_1[5] = uVar14;
      uVar5 = (undefined4)(param_1[6] >> 0x20);
      uVar6 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar28,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,0);
      uVar24 = PackedFloatingMUL(uVar21,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(0,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar17);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      param_1[6] = uVar28;
      param_1[7] = uVar14;
      uVar5 = (undefined4)(*param_1 >> 0x20);
      uVar6 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar10);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      *param_1 = uVar28;
      param_1[1] = uVar14;
      uVar5 = (undefined4)(param_1[2] >> 0x20);
      uVar6 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar10);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      param_1[2] = uVar28;
      param_1[3] = uVar14;
      uVar5 = (undefined4)(param_1[4] >> 0x20);
      uVar6 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar10);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      param_1[4] = uVar28;
      param_1[5] = uVar14;
      uVar5 = (undefined4)(param_1[6] >> 0x20);
      uVar6 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar3 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar12 = PackedFloatingMUL(uVar18,uVar3);
      uVar18 = CONCAT44(uVar5,uVar5);
      uVar3 = PackedFloatingMUL(uVar3,uVar10);
      uVar8 = PackedFloatingMUL(uVar4,uVar18);
      uVar4 = CONCAT44(uVar6,uVar6);
      uVar18 = PackedFloatingMUL(uVar18,uVar29);
      uVar12 = PackedFloatingADD(uVar8,uVar12);
      uVar8 = PackedFloatingMUL(uVar2,uVar7);
      uVar2 = PackedFloatingADD(uVar18,uVar3);
      uVar18 = PackedFloatingMUL(uVar7,uVar16);
      uVar3 = PackedFloatingADD(uVar8,uVar12);
      uVar7 = PackedFloatingMUL(0,uVar4);
      uVar18 = PackedFloatingADD(uVar2,uVar18);
      uVar4 = PackedFloatingMUL(uVar4,0x3f80000000000000);
      uVar16 = PackedFloatingADD(uVar7,uVar3);
      in_MM3 = PackedFloatingADD(uVar4,uVar18);
      param_1[6] = uVar16;
      param_1[7] = in_MM3;
    }
    else {
      uVar12 = CONCAT44(uVar1,uVar5);
      uVar24 = CONCAT44(uVar6,uVar26);
      uVar15 = (ulonglong)uVar11;
      uVar25 = CONCAT44(uVar27,(int)uVar9);
      uVar14 = uVar14 & 0xffffffff;
      uVar22 = uVar22 & 0xffffffff;
      uVar3 = *param_2;
      uVar11 = *(uint *)(param_2 + 1);
      uVar9 = PackedSwapDWords(uVar22,0x3f800000);
      *param_1 = 0x3f800000;
      param_1[1] = 0;
      param_1[2] = uVar9;
      param_1[3] = 0;
      param_1[4] = 0;
      param_1[5] = 0x3f800000;
      uVar19 = PackedFloatingSUB(uVar9,(ulonglong)uVar11);
      uVar9 = PackedFloatingSUB(0,uVar3);
      param_1[7] = uVar19;
      param_1[6] = uVar9;
      uVar5 = (undefined4)(*param_1 >> 0x20);
      uVar6 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar13 = CONCAT44(uVar1,uVar1);
      uVar20 = PackedFloatingMUL(uVar12,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar8 = PackedFloatingMUL(uVar7,uVar22);
      uVar23 = PackedFloatingMUL(uVar24,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar14);
      uVar20 = PackedFloatingADD(uVar23,uVar20);
      uVar23 = PackedFloatingMUL(uVar25,uVar13);
      uVar8 = PackedFloatingADD(uVar3,uVar8);
      uVar3 = PackedFloatingMUL(uVar13,uVar15);
      uVar13 = PackedFloatingADD(uVar23,uVar20);
      uVar20 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar8,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar19 = PackedFloatingADD(uVar20,uVar13);
      uVar9 = PackedFloatingADD(uVar7,uVar3);
      *param_1 = uVar19;
      param_1[1] = uVar9;
      uVar5 = (undefined4)(param_1[2] >> 0x20);
      uVar6 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar13 = CONCAT44(uVar1,uVar1);
      uVar20 = PackedFloatingMUL(uVar12,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar8 = PackedFloatingMUL(uVar7,uVar22);
      uVar23 = PackedFloatingMUL(uVar24,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar14);
      uVar20 = PackedFloatingADD(uVar23,uVar20);
      uVar23 = PackedFloatingMUL(uVar25,uVar13);
      uVar8 = PackedFloatingADD(uVar3,uVar8);
      uVar3 = PackedFloatingMUL(uVar13,uVar15);
      uVar13 = PackedFloatingADD(uVar23,uVar20);
      uVar20 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar8,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar19 = PackedFloatingADD(uVar20,uVar13);
      uVar9 = PackedFloatingADD(uVar7,uVar3);
      param_1[2] = uVar19;
      param_1[3] = uVar9;
      uVar5 = (undefined4)(param_1[4] >> 0x20);
      uVar6 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar13 = CONCAT44(uVar1,uVar1);
      uVar20 = PackedFloatingMUL(uVar12,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar8 = PackedFloatingMUL(uVar7,uVar22);
      uVar23 = PackedFloatingMUL(uVar24,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar14);
      uVar20 = PackedFloatingADD(uVar23,uVar20);
      uVar23 = PackedFloatingMUL(uVar25,uVar13);
      uVar8 = PackedFloatingADD(uVar3,uVar8);
      uVar3 = PackedFloatingMUL(uVar13,uVar15);
      uVar13 = PackedFloatingADD(uVar23,uVar20);
      uVar20 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar8,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar19 = PackedFloatingADD(uVar20,uVar13);
      uVar9 = PackedFloatingADD(uVar7,uVar3);
      param_1[4] = uVar19;
      param_1[5] = uVar9;
      uVar5 = (undefined4)(param_1[6] >> 0x20);
      uVar6 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar12,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar22);
      uVar24 = PackedFloatingMUL(uVar24,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar14);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar25,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar15);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      param_1[6] = uVar9;
      param_1[7] = uVar14;
      uVar5 = (undefined4)(*param_1 >> 0x20);
      uVar6 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar28,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,0);
      uVar24 = PackedFloatingMUL(uVar21,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(0,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar17);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      *param_1 = uVar9;
      param_1[1] = uVar14;
      uVar5 = (undefined4)(param_1[2] >> 0x20);
      uVar6 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar28,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,0);
      uVar24 = PackedFloatingMUL(uVar21,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(0,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar17);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      param_1[2] = uVar9;
      param_1[3] = uVar14;
      uVar5 = (undefined4)(param_1[4] >> 0x20);
      uVar6 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar28,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,0);
      uVar24 = PackedFloatingMUL(uVar21,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(0,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar17);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      param_1[4] = uVar9;
      param_1[5] = uVar14;
      uVar5 = (undefined4)(param_1[6] >> 0x20);
      uVar6 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar28,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,0);
      uVar24 = PackedFloatingMUL(uVar21,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,0);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(0,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar17);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      param_1[6] = uVar28;
      param_1[7] = uVar14;
      uVar5 = (undefined4)(*param_1 >> 0x20);
      uVar6 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar10);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      *param_1 = uVar28;
      param_1[1] = uVar14;
      uVar5 = (undefined4)(param_1[2] >> 0x20);
      uVar6 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar10);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      param_1[2] = uVar28;
      param_1[3] = uVar14;
      uVar5 = (undefined4)(param_1[4] >> 0x20);
      uVar6 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar10);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar28 = PackedFloatingADD(uVar13,uVar8);
      uVar14 = PackedFloatingADD(uVar7,uVar3);
      param_1[4] = uVar28;
      param_1[5] = uVar14;
      uVar5 = (undefined4)(param_1[6] >> 0x20);
      uVar6 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar3 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar12 = PackedFloatingMUL(uVar18,uVar3);
      uVar18 = CONCAT44(uVar5,uVar5);
      uVar3 = PackedFloatingMUL(uVar3,uVar10);
      uVar8 = PackedFloatingMUL(uVar4,uVar18);
      uVar4 = CONCAT44(uVar6,uVar6);
      uVar18 = PackedFloatingMUL(uVar18,uVar29);
      uVar12 = PackedFloatingADD(uVar8,uVar12);
      uVar8 = PackedFloatingMUL(uVar2,uVar7);
      uVar2 = PackedFloatingADD(uVar18,uVar3);
      uVar18 = PackedFloatingMUL(uVar7,uVar16);
      uVar3 = PackedFloatingADD(uVar8,uVar12);
      uVar7 = PackedFloatingMUL(0,uVar4);
      uVar18 = PackedFloatingADD(uVar2,uVar18);
      uVar4 = PackedFloatingMUL(uVar4,0x3f80000000000000);
      uVar29 = PackedFloatingADD(uVar7,uVar3);
      uVar16 = PackedFloatingADD(uVar4,uVar18);
      param_1[6] = uVar29;
      param_1[7] = uVar16;
      in_MM3 = (ulonglong)(uint)param_1[7];
      uVar16 = PackedFloatingADD(*param_2,param_1[6]);
      uVar4 = PackedFloatingADD((ulonglong)*(uint *)(param_2 + 1),in_MM3);
      param_1[6] = uVar16;
      *(int *)(param_1 + 7) = (int)uVar4;
    }
  }
  if (param_6 != (undefined8 *)0x0) {
    uVar4 = *param_6;
    uVar18 = param_6[1];
    uVar12 = PackedSwapDWords(in_MM3,uVar4);
    uVar2 = PackedFloatingADD(uVar4,uVar4);
    uVar7 = PackedFloatingADD(uVar18,uVar18);
    uVar3 = PackedFloatingMUL(uVar2,uVar4);
    uVar8 = PackedFloatingMUL(uVar4,uVar7);
    uVar13 = PackedFloatingMUL(uVar12,uVar7);
    uVar12 = PackedFloatingMUL(uVar7,uVar18);
    uVar2 = PackedFloatingMUL(CONCAT44((int)((ulonglong)uVar18 >> 0x20),
                                       (int)((ulonglong)uVar4 >> 0x20)),
                              CONCAT44((int)uVar7,(int)uVar2));
    uVar4 = PackedFloatingSUBR(uVar3,0x3f8000003f800000);
    uVar29 = PackedFloatingPosNegAccumulate(uVar13,uVar13);
    uVar18 = PackedFloatingAccumulate(uVar3,uVar3);
    uVar3 = PackedFloatingPosNegAccumulate(uVar2,uVar2);
    uVar14 = PackedFloatingPosNegAccumulate(uVar8,uVar8);
    uVar4 = PackedFloatingSUB(uVar4,CONCAT44((int)uVar12,(int)uVar12));
    uVar2 = PackedSwapDWords(uVar12,uVar14);
    uVar16 = PackedFloatingSUBR(uVar18,0x3f8000003f800000);
    uVar2 = CONCAT44((int)uVar29,(int)uVar2);
    uVar14 = uVar14 & 0xffffffff;
    uVar16 = uVar16 >> 0x20;
    uVar18 = CONCAT44((int)((ulonglong)uVar3 >> 0x20),(int)((ulonglong)uVar4 >> 0x20));
    uVar29 = uVar29 >> 0x20;
    uVar4 = CONCAT44((int)uVar4,(int)uVar3);
    if (param_5 == (undefined8 *)0x0) {
      uVar5 = (undefined4)(*param_1 >> 0x20);
      uVar6 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar14);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar28 = PackedFloatingADD(uVar7,uVar3);
      *param_1 = uVar9;
      param_1[1] = uVar28;
      uVar5 = (undefined4)(param_1[2] >> 0x20);
      uVar6 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar14);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar28 = PackedFloatingADD(uVar7,uVar3);
      param_1[2] = uVar9;
      param_1[3] = uVar28;
      uVar5 = (undefined4)(param_1[4] >> 0x20);
      uVar6 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar14);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar28 = PackedFloatingADD(uVar7,uVar3);
      param_1[4] = uVar9;
      param_1[5] = uVar28;
      uVar5 = (undefined4)(param_1[6] >> 0x20);
      uVar6 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar3 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar12 = PackedFloatingMUL(uVar18,uVar3);
      uVar18 = CONCAT44(uVar5,uVar5);
      uVar3 = PackedFloatingMUL(uVar3,uVar14);
      uVar8 = PackedFloatingMUL(uVar4,uVar18);
      uVar4 = CONCAT44(uVar6,uVar6);
      uVar18 = PackedFloatingMUL(uVar18,uVar29);
      uVar12 = PackedFloatingADD(uVar8,uVar12);
      uVar8 = PackedFloatingMUL(uVar2,uVar7);
      uVar2 = PackedFloatingADD(uVar18,uVar3);
      uVar18 = PackedFloatingMUL(uVar7,uVar16);
      uVar3 = PackedFloatingADD(uVar8,uVar12);
      uVar7 = PackedFloatingMUL(0,uVar4);
      uVar18 = PackedFloatingADD(uVar2,uVar18);
      uVar4 = PackedFloatingMUL(uVar4,0x3f80000000000000);
      uVar29 = PackedFloatingADD(uVar7,uVar3);
      uVar16 = PackedFloatingADD(uVar4,uVar18);
      param_1[6] = uVar29;
      param_1[7] = uVar16;
    }
    else {
      uVar28 = PackedFloatingSUB(param_1[6],*param_5);
      uVar3 = PackedFloatingSUB((ulonglong)(uint)param_1[7],(ulonglong)*(uint *)(param_5 + 1));
      param_1[6] = uVar28;
      *(int *)(param_1 + 7) = (int)uVar3;
      uVar5 = (undefined4)(*param_1 >> 0x20);
      uVar6 = (undefined4)(param_1[1] >> 0x20);
      uVar1 = (undefined4)*param_1;
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[1];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar14);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar28 = PackedFloatingADD(uVar7,uVar3);
      *param_1 = uVar9;
      param_1[1] = uVar28;
      uVar5 = (undefined4)(param_1[2] >> 0x20);
      uVar6 = (undefined4)(param_1[3] >> 0x20);
      uVar1 = (undefined4)param_1[2];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[3];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar14);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar28 = PackedFloatingADD(uVar7,uVar3);
      param_1[2] = uVar9;
      param_1[3] = uVar28;
      uVar5 = (undefined4)(param_1[4] >> 0x20);
      uVar6 = (undefined4)(param_1[5] >> 0x20);
      uVar1 = (undefined4)param_1[4];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[5];
      uVar8 = CONCAT44(uVar1,uVar1);
      uVar13 = PackedFloatingMUL(uVar18,uVar7);
      uVar3 = CONCAT44(uVar5,uVar5);
      uVar12 = PackedFloatingMUL(uVar7,uVar14);
      uVar24 = PackedFloatingMUL(uVar4,uVar3);
      uVar7 = CONCAT44(uVar6,uVar6);
      uVar3 = PackedFloatingMUL(uVar3,uVar29);
      uVar13 = PackedFloatingADD(uVar24,uVar13);
      uVar24 = PackedFloatingMUL(uVar2,uVar8);
      uVar12 = PackedFloatingADD(uVar3,uVar12);
      uVar3 = PackedFloatingMUL(uVar8,uVar16);
      uVar8 = PackedFloatingADD(uVar24,uVar13);
      uVar13 = PackedFloatingMUL(0,uVar7);
      uVar3 = PackedFloatingADD(uVar12,uVar3);
      uVar7 = PackedFloatingMUL(uVar7,0x3f80000000000000);
      uVar9 = PackedFloatingADD(uVar13,uVar8);
      uVar28 = PackedFloatingADD(uVar7,uVar3);
      param_1[4] = uVar9;
      param_1[5] = uVar28;
      uVar5 = (undefined4)(param_1[6] >> 0x20);
      uVar6 = (undefined4)(param_1[7] >> 0x20);
      uVar1 = (undefined4)param_1[6];
      uVar3 = CONCAT44(uVar1,uVar1);
      uVar1 = (undefined4)param_1[7];
      uVar7 = CONCAT44(uVar1,uVar1);
      uVar12 = PackedFloatingMUL(uVar18,uVar3);
      uVar18 = CONCAT44(uVar5,uVar5);
      uVar3 = PackedFloatingMUL(uVar3,uVar14);
      uVar8 = PackedFloatingMUL(uVar4,uVar18);
      uVar4 = CONCAT44(uVar6,uVar6);
      uVar18 = PackedFloatingMUL(uVar18,uVar29);
      uVar12 = PackedFloatingADD(uVar8,uVar12);
      uVar8 = PackedFloatingMUL(uVar2,uVar7);
      uVar2 = PackedFloatingADD(uVar18,uVar3);
      uVar18 = PackedFloatingMUL(uVar7,uVar16);
      uVar3 = PackedFloatingADD(uVar8,uVar12);
      uVar7 = PackedFloatingMUL(0,uVar4);
      uVar18 = PackedFloatingADD(uVar2,uVar18);
      uVar4 = PackedFloatingMUL(uVar4,0x3f80000000000000);
      uVar29 = PackedFloatingADD(uVar7,uVar3);
      uVar16 = PackedFloatingADD(uVar4,uVar18);
      param_1[6] = uVar29;
      param_1[7] = uVar16;
      uVar16 = PackedFloatingADD(param_1[6],*param_5);
      uVar4 = PackedFloatingADD((ulonglong)(uint)param_1[7],(ulonglong)*(uint *)(param_5 + 1));
      param_1[6] = uVar16;
      *(int *)(param_1 + 7) = (int)uVar4;
    }
  }
  if (param_7 != (undefined8 *)0x0) {
    uVar16 = PackedFloatingADD(param_1[6],*param_7);
    uVar4 = PackedFloatingADD((ulonglong)(uint)param_1[7],(ulonglong)*(uint *)(param_7 + 1));
    param_1[6] = uVar16;
    *(int *)(param_1 + 7) = (int)uVar4;
  }
  FastExitMediaState();
  return;
}



/* FUN_0045dd30 @ 0045dd30 */

void FUN_0045dd30(undefined8 *param_1,undefined4 *param_2,undefined8 *param_3)

{
  undefined8 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined8 in_MM4;
  undefined8 uVar8;
  undefined4 uVar10;
  undefined8 uVar9;
  undefined8 in_MM5;
  undefined8 uVar11;
  undefined8 uVar12;
  undefined8 uVar13;
  undefined8 in_MM6;
  undefined8 uVar14;
  undefined8 uVar15;
  undefined8 uVar16;
  undefined8 in_MM7;
  undefined8 uVar17;
  undefined4 uStack_2c;
  
  uVar2 = param_3[2];
  uVar3 = param_3[4];
  uVar11 = PackedSwapDWords(in_MM5,uVar2);
  uVar8 = PackedSwapDWords(in_MM4,uVar3);
  uVar1 = *param_3;
  uVar14 = PackedSwapDWords(in_MM6,param_3[6]);
  uVar17 = PackedSwapDWords(in_MM7,uVar3);
  uVar11 = PackedFloatingMUL(uVar11,uVar1);
  uVar8 = PackedFloatingMUL(uVar8,uVar1);
  uVar14 = PackedFloatingMUL(uVar14,uVar1);
  uVar1 = PackedSwapDWords(uVar1,param_3[6]);
  uVar17 = PackedFloatingMUL(uVar17,uVar2);
  uVar12 = PackedFloatingNegAccumulate(uVar11,uVar8);
  uVar2 = PackedFloatingMUL(uVar2,uVar1);
  uVar3 = PackedFloatingMUL(uVar3,uVar1);
  uVar17 = PackedFloatingNegAccumulate(uVar14,uVar17);
  uVar1 = PackedFloatingNegAccumulate(uVar2,uVar3);
  uVar2 = param_3[7];
  uVar3 = param_3[5];
  uVar4 = (undefined4)((ulonglong)uVar17 >> 0x20);
  uVar10 = (undefined4)((ulonglong)uVar1 >> 0x20);
  uVar8 = PackedFloatingMUL(CONCAT44(uVar4,uVar4),uVar2);
  uVar6 = (undefined4)uVar1;
  uVar1 = PackedFloatingMUL(CONCAT44(uVar10,uVar10),param_3[3]);
  uVar11 = PackedFloatingMUL(CONCAT44(uVar6,uVar6),uVar3);
  uVar1 = PackedFloatingADD(uVar8,uVar1);
  uVar14 = PackedFloatingSUB(uVar1,uVar11);
  uVar7 = (undefined4)uVar17;
  uVar5 = (undefined4)((ulonglong)uVar12 >> 0x20);
  uVar8 = PackedFloatingMUL(CONCAT44(uVar10,uVar10),param_3[1]);
  uVar1 = PackedFloatingMUL(CONCAT44(uVar5,uVar5),uVar2);
  uVar9 = PackedFloatingMUL(CONCAT44(uVar7,uVar7),uVar3);
  uVar1 = PackedFloatingSUB(uVar1,uVar9);
  uVar17 = PackedFloatingADD(uVar1,uVar8);
  uVar8 = CONCAT44((int)uVar12,(int)uVar12);
  uVar1 = PackedFloatingMUL(CONCAT44(uVar6,uVar6),param_3[1]);
  uVar2 = PackedFloatingMUL(uVar2,uVar8);
  uVar11 = PackedFloatingMUL(CONCAT44(uVar7,uVar7),param_3[3]);
  uVar2 = PackedFloatingADD(uVar2,uVar1);
  uVar11 = PackedFloatingSUB(uVar2,uVar11);
  uVar1 = PackedFloatingMUL(uVar8,uVar3);
  uVar13 = PackedFloatingMUL(CONCAT44(uVar5,uVar5),param_3[3]);
  uVar2 = param_3[1];
  uVar15 = PackedFloatingMUL(CONCAT44(uVar4,uVar4),param_3[1]);
  uVar1 = PackedFloatingSUB(uVar1,uVar13);
  uVar12 = PackedFloatingADD(uVar1,uVar15);
  uVar1 = param_3[3];
  uVar8 = param_3[5];
  uVar13 = PackedSwapDWords(uVar13,uVar1);
  uVar9 = PackedSwapDWords(uVar9,uVar8);
  uVar13 = PackedFloatingMUL(uVar13,uVar2);
  uVar15 = PackedSwapDWords(uVar15,param_3[7]);
  uVar9 = PackedFloatingMUL(uVar9,uVar2);
  uVar3 = PackedSwapDWords(uVar3,uVar8);
  uVar16 = PackedFloatingMUL(uVar15,uVar2);
  uVar2 = PackedSwapDWords(uVar2,param_3[7]);
  uVar15 = PackedFloatingNegAccumulate(uVar13,uVar9);
  uVar9 = PackedFloatingMUL(uVar3,uVar1);
  uVar3 = PackedFloatingMUL(uVar1,uVar2);
  uVar2 = PackedFloatingMUL(uVar8,uVar2);
  uVar13 = PackedFloatingNegAccumulate(uVar16,uVar9);
  uVar1 = PackedFloatingNegAccumulate(uVar3,uVar2);
  uVar2 = param_3[6];
  uVar3 = param_3[4];
  uVar10 = (undefined4)((ulonglong)uVar1 >> 0x20);
  uVar6 = (undefined4)uVar1;
  uVar4 = (undefined4)((ulonglong)uVar13 >> 0x20);
  uVar9 = PackedFloatingMUL(CONCAT44(uVar10,uVar10),param_3[2]);
  uVar1 = PackedFloatingMUL(CONCAT44(uVar4,uVar4),uVar2);
  uVar8 = PackedFloatingMUL(CONCAT44(uVar6,uVar6),uVar3);
  uVar1 = PackedFloatingADD(uVar1,uVar9);
  uVar9 = PackedFloatingSUB(uVar1,uVar8);
  uVar7 = (undefined4)uVar13;
  uVar5 = (undefined4)((ulonglong)uVar15 >> 0x20);
  uVar8 = PackedFloatingMUL(CONCAT44(uVar10,uVar10),*param_3);
  uVar1 = PackedFloatingMUL(CONCAT44(uVar5,uVar5),uVar2);
  uVar13 = PackedFloatingMUL(CONCAT44(uVar7,uVar7),uVar3);
  uVar1 = PackedFloatingSUB(uVar1,uVar13);
  uVar13 = PackedFloatingADD(uVar1,uVar8);
  uVar15 = CONCAT44((int)uVar15,(int)uVar15);
  uVar8 = PackedFloatingMUL(CONCAT44(uVar6,uVar6),*param_3);
  uVar1 = PackedFloatingMUL(uVar2,uVar15);
  uVar16 = PackedFloatingMUL(CONCAT44(uVar7,uVar7),param_3[2]);
  uVar1 = PackedFloatingADD(uVar1,uVar8);
  uVar1 = PackedFloatingSUB(uVar1,uVar16);
  uVar8 = PackedFloatingMUL(uVar15,uVar3);
  uVar15 = PackedFloatingMUL(CONCAT44(uVar5,uVar5),param_3[2]);
  uVar16 = PackedFloatingMUL(CONCAT44(uVar4,uVar4),*param_3);
  uVar8 = PackedFloatingSUB(uVar8,uVar15);
  uVar15 = PackedFloatingADD(uVar8,uVar16);
  uStack_2c = (undefined4)((ulonglong)uVar13 >> 0x20);
  uVar8 = CONCAT44(uStack_2c,(int)((ulonglong)uVar9 >> 0x20));
  uVar2 = PackedFloatingMUL(CONCAT44((int)((ulonglong)uVar15 >> 0x20),
                                     (int)((ulonglong)uVar1 >> 0x20)),
                            CONCAT44((int)uVar2,(int)uVar3));
  uVar3 = PackedFloatingMUL(CONCAT44(*(undefined4 *)(param_3 + 2),(int)*param_3),uVar8);
  uVar2 = PackedFloatingNegAccumulate(uVar2,uVar3);
  uVar2 = PackedFloatingAccumulate(uVar2,uVar2);
  uVar4 = (undefined4)uVar2;
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = uVar4;
  }
  uVar3 = FloatingReciprocalAprox(uVar8,uVar2);
  uVar8 = PackedFloatingCompareEQ(0,uVar2);
  uVar2 = PackedFloatingReciprocalIter1(CONCAT44(uVar4,uVar4),uVar3);
  uVar2 = PackedFloatingReciprocalIter2(uVar2,uVar3);
  uVar2 = PackedFloatingMUL(uVar2,0xbf8000003f800000);
  uVar3 = PackedSwapDWords(uVar3,uVar2);
  if ((int)uVar8 == 0) {
    uVar8 = PackedFloatingMUL(uVar9,uVar3);
    uVar9 = PackedFloatingMUL(uVar13,uVar2);
    uVar14 = PackedFloatingMUL(uVar14,uVar3);
    uVar17 = PackedFloatingMUL(uVar17,uVar2);
    *param_1 = CONCAT44((int)((ulonglong)uVar9 >> 0x20),(int)((ulonglong)uVar8 >> 0x20));
    param_1[2] = CONCAT44((int)uVar9,(int)uVar8);
    param_1[4] = CONCAT44((int)((ulonglong)uVar17 >> 0x20),(int)((ulonglong)uVar14 >> 0x20));
    param_1[6] = CONCAT44((int)uVar17,(int)uVar14);
    uVar1 = PackedFloatingMUL(uVar1,uVar3);
    uVar8 = PackedFloatingMUL(uVar15,uVar2);
    uVar3 = PackedFloatingMUL(uVar11,uVar3);
    uVar2 = PackedFloatingMUL(uVar12,uVar2);
    param_1[1] = CONCAT44((int)((ulonglong)uVar8 >> 0x20),(int)((ulonglong)uVar1 >> 0x20));
    param_1[3] = CONCAT44((int)uVar8,(int)uVar1);
    param_1[5] = CONCAT44((int)((ulonglong)uVar2 >> 0x20),(int)((ulonglong)uVar3 >> 0x20));
    param_1[7] = CONCAT44((int)uVar2,(int)uVar3);
  }
  FastExitMediaState();
  return;
}



/* mat4_invert @ 0045e40a */

/* inverts a 4x4 matrix; optionally writes determinant */

float * mat4_invert(float *out,float *det_out,float *mat)

{
  float fVar1;
  float *pfVar2;
  undefined4 uVar3;
  undefined4 uVar5;
  undefined8 uVar4;
  undefined4 uVar6;
  undefined8 uVar7;
  undefined8 uVar8;
  undefined4 uVar9;
  undefined4 uVar12;
  undefined8 uVar10;
  undefined8 uVar11;
  undefined4 uVar13;
  undefined8 uVar14;
  undefined8 uVar15;
  undefined8 uVar16;
  undefined4 uVar17;
  undefined8 uVar18;
  undefined8 uVar19;
  undefined8 uVar20;
  undefined4 uVar22;
  undefined8 uVar21;
  undefined4 uStack_34;
  
  uVar12 = (undefined4)((ulonglong)*(undefined8 *)mat >> 0x20);
  uVar3 = (undefined4)*(undefined8 *)(mat + 8);
  uVar17 = (undefined4)*(undefined8 *)(mat + 4);
  uVar13 = (undefined4)*(undefined8 *)mat;
  uVar22 = (undefined4)((ulonglong)*(undefined8 *)(mat + 4) >> 0x20);
  uVar5 = (undefined4)((ulonglong)*(undefined8 *)(mat + 8) >> 0x20);
  uVar10 = PackedFloatingMUL(CONCAT44(uVar12,uVar12),CONCAT44(uVar3,uVar17));
  uVar14 = PackedFloatingMUL(CONCAT44(uVar13,uVar13),CONCAT44(uVar5,uVar22));
  uVar15 = PackedFloatingSUB(uVar14,uVar10);
  uVar6 = (undefined4)((ulonglong)*(undefined8 *)(mat + 0xc) >> 0x20);
  uVar9 = (undefined4)*(undefined8 *)(mat + 0xc);
  uVar18 = PackedFloatingMUL(CONCAT44(uVar5,uVar6),CONCAT44(uVar17,uVar13));
  uVar21 = PackedFloatingMUL(CONCAT44(uVar22,uVar12),CONCAT44(uVar3,uVar9));
  uVar10 = PackedFloatingMUL(CONCAT44(uVar3,uVar17),CONCAT44(uVar6,uVar6));
  uVar14 = PackedFloatingMUL(CONCAT44(uVar5,uVar22),CONCAT44(uVar9,uVar9));
  uVar19 = PackedFloatingSUB(uVar18,uVar21);
  uVar18 = PackedFloatingSUBR(uVar14,uVar10);
  uVar10 = *(undefined8 *)(mat + 0xe);
  uVar14 = *(undefined8 *)(mat + 10);
  uVar3 = (undefined4)((ulonglong)uVar19 >> 0x20);
  uVar12 = (undefined4)((ulonglong)uVar18 >> 0x20);
  uVar21 = PackedFloatingMUL(CONCAT44(uVar3,uVar3),uVar10);
  uVar6 = (undefined4)uVar18;
  uVar18 = PackedFloatingMUL(CONCAT44(uVar12,uVar12),*(undefined8 *)(mat + 6));
  uVar7 = PackedFloatingMUL(CONCAT44(uVar6,uVar6),uVar14);
  uVar18 = PackedFloatingADD(uVar21,uVar18);
  uVar4 = PackedFloatingSUB(uVar18,uVar7);
  uVar9 = (undefined4)uVar19;
  uVar5 = (undefined4)((ulonglong)uVar15 >> 0x20);
  uVar21 = PackedFloatingMUL(CONCAT44(uVar12,uVar12),*(undefined8 *)(mat + 2));
  uVar18 = PackedFloatingMUL(CONCAT44(uVar5,uVar5),uVar10);
  uVar7 = PackedFloatingMUL(CONCAT44(uVar9,uVar9),uVar14);
  uVar18 = PackedFloatingSUB(uVar18,uVar7);
  uVar19 = PackedFloatingADD(uVar18,uVar21);
  uVar21 = CONCAT44((int)uVar15,(int)uVar15);
  uVar18 = PackedFloatingMUL(CONCAT44(uVar6,uVar6),*(undefined8 *)(mat + 2));
  uVar10 = PackedFloatingMUL(uVar10,uVar21);
  uVar7 = PackedFloatingMUL(CONCAT44(uVar9,uVar9),*(undefined8 *)(mat + 6));
  uVar10 = PackedFloatingADD(uVar10,uVar18);
  uVar18 = PackedFloatingSUB(uVar10,uVar7);
  uVar10 = PackedFloatingMUL(uVar21,uVar14);
  uVar14 = PackedFloatingMUL(CONCAT44(uVar5,uVar5),*(undefined8 *)(mat + 6));
  uVar21 = PackedFloatingMUL(CONCAT44(uVar3,uVar3),*(undefined8 *)(mat + 2));
  uVar10 = PackedFloatingSUB(uVar10,uVar14);
  uVar15 = PackedFloatingADD(uVar10,uVar21);
  uVar12 = (undefined4)((ulonglong)*(undefined8 *)(mat + 2) >> 0x20);
  uVar3 = (undefined4)*(undefined8 *)(mat + 10);
  uVar17 = (undefined4)*(undefined8 *)(mat + 6);
  uVar13 = (undefined4)*(undefined8 *)(mat + 2);
  uVar22 = (undefined4)((ulonglong)*(undefined8 *)(mat + 6) >> 0x20);
  uVar5 = (undefined4)((ulonglong)*(undefined8 *)(mat + 10) >> 0x20);
  uVar10 = PackedFloatingMUL(CONCAT44(uVar12,uVar12),CONCAT44(uVar3,uVar17));
  uVar14 = PackedFloatingMUL(CONCAT44(uVar13,uVar13),CONCAT44(uVar5,uVar22));
  uVar16 = PackedFloatingSUB(uVar14,uVar10);
  uVar6 = (undefined4)((ulonglong)*(undefined8 *)(mat + 0xe) >> 0x20);
  uVar9 = (undefined4)*(undefined8 *)(mat + 0xe);
  uVar21 = PackedFloatingMUL(CONCAT44(uVar5,uVar6),CONCAT44(uVar17,uVar13));
  uVar7 = PackedFloatingMUL(CONCAT44(uVar22,uVar12),CONCAT44(uVar3,uVar9));
  uVar10 = PackedFloatingMUL(CONCAT44(uVar3,uVar17),CONCAT44(uVar6,uVar6));
  uVar14 = PackedFloatingMUL(CONCAT44(uVar5,uVar22),CONCAT44(uVar9,uVar9));
  uVar20 = PackedFloatingSUB(uVar21,uVar7);
  uVar21 = PackedFloatingSUBR(uVar14,uVar10);
  uVar10 = *(undefined8 *)(mat + 0xc);
  uVar14 = *(undefined8 *)(mat + 8);
  uVar12 = (undefined4)((ulonglong)uVar21 >> 0x20);
  uVar6 = (undefined4)uVar21;
  uVar3 = (undefined4)((ulonglong)uVar20 >> 0x20);
  uVar11 = PackedFloatingMUL(CONCAT44(uVar12,uVar12),*(undefined8 *)(mat + 4));
  uVar21 = PackedFloatingMUL(CONCAT44(uVar3,uVar3),uVar10);
  uVar7 = PackedFloatingMUL(CONCAT44(uVar6,uVar6),uVar14);
  uVar21 = PackedFloatingADD(uVar21,uVar11);
  uVar11 = PackedFloatingSUB(uVar21,uVar7);
  uVar9 = (undefined4)uVar20;
  uVar5 = (undefined4)((ulonglong)uVar16 >> 0x20);
  uVar7 = PackedFloatingMUL(CONCAT44(uVar12,uVar12),*(undefined8 *)mat);
  uVar21 = PackedFloatingMUL(CONCAT44(uVar5,uVar5),uVar10);
  uVar20 = PackedFloatingMUL(CONCAT44(uVar9,uVar9),uVar14);
  uVar21 = PackedFloatingSUB(uVar21,uVar20);
  uVar20 = PackedFloatingADD(uVar21,uVar7);
  uVar16 = CONCAT44((int)uVar16,(int)uVar16);
  uVar7 = PackedFloatingMUL(CONCAT44(uVar6,uVar6),*(undefined8 *)mat);
  uVar21 = PackedFloatingMUL(uVar10,uVar16);
  uVar8 = PackedFloatingMUL(CONCAT44(uVar9,uVar9),*(undefined8 *)(mat + 4));
  uVar21 = PackedFloatingADD(uVar21,uVar7);
  uVar21 = PackedFloatingSUB(uVar21,uVar8);
  uVar7 = PackedFloatingMUL(uVar16,uVar14);
  uVar16 = PackedFloatingMUL(CONCAT44(uVar5,uVar5),*(undefined8 *)(mat + 4));
  uVar8 = PackedFloatingMUL(CONCAT44(uVar3,uVar3),*(undefined8 *)mat);
  uVar7 = PackedFloatingSUB(uVar7,uVar16);
  uVar7 = PackedFloatingADD(uVar7,uVar8);
  uVar10 = PackedFloatingMUL(CONCAT44((int)uVar10,(int)uVar14),0xbf8000003f800000);
  uStack_34 = (undefined4)((ulonglong)uVar20 >> 0x20);
  uVar14 = CONCAT44(uStack_34,(int)((ulonglong)uVar11 >> 0x20));
  uVar16 = PackedFloatingMUL(CONCAT44(mat[4],(int)*(undefined8 *)mat),0xbf8000003f800000);
  uVar10 = PackedFloatingMUL(CONCAT44((int)((ulonglong)uVar7 >> 0x20),
                                      (int)((ulonglong)uVar21 >> 0x20)),uVar10);
  uVar16 = PackedFloatingMUL(uVar16,uVar14);
  uVar10 = PackedFloatingADD(uVar10,uVar16);
  uVar10 = PackedFloatingAccumulate(uVar10,uVar10);
  fVar1 = (float)uVar10;
  if (det_out != (float *)0x0) {
    *det_out = fVar1;
  }
  uVar14 = FloatingReciprocalAprox(uVar14,uVar10);
  uVar16 = PackedFloatingCompareEQ(0,uVar10);
  uVar10 = PackedFloatingReciprocalIter1(CONCAT44(fVar1,fVar1),uVar14);
  uVar10 = PackedFloatingReciprocalIter2(uVar10,uVar14);
  uVar14 = PackedFloatingMUL(uVar10,0xbf8000003f800000);
  uVar10 = CONCAT44((int)uVar14,(int)((ulonglong)uVar14 >> 0x20));
  pfVar2 = (float *)uVar16;
  if ((float *)uVar16 == (float *)0x0) {
    uVar11 = PackedFloatingMUL(uVar11,uVar10);
    uVar20 = PackedFloatingMUL(uVar20,uVar14);
    uVar4 = PackedFloatingMUL(uVar4,uVar10);
    uVar19 = PackedFloatingMUL(uVar19,uVar14);
    *(ulonglong *)out = CONCAT44((int)((ulonglong)uVar20 >> 0x20),(int)((ulonglong)uVar11 >> 0x20));
    *(ulonglong *)(out + 4) = CONCAT44((int)uVar20,(int)uVar11);
    *(ulonglong *)(out + 8) =
         CONCAT44((int)((ulonglong)uVar19 >> 0x20),(int)((ulonglong)uVar4 >> 0x20));
    *(ulonglong *)(out + 0xc) = CONCAT44((int)uVar19,(int)uVar4);
    uVar21 = PackedFloatingMUL(uVar21,uVar10);
    uVar7 = PackedFloatingMUL(uVar7,uVar14);
    uVar10 = PackedFloatingMUL(uVar18,uVar10);
    uVar14 = PackedFloatingMUL(uVar15,uVar14);
    *(ulonglong *)(out + 2) =
         CONCAT44((int)((ulonglong)uVar7 >> 0x20),(int)((ulonglong)uVar21 >> 0x20));
    *(ulonglong *)(out + 6) = CONCAT44((int)uVar7,(int)uVar21);
    *(ulonglong *)(out + 10) =
         CONCAT44((int)((ulonglong)uVar14 >> 0x20),(int)((ulonglong)uVar10 >> 0x20));
    *(ulonglong *)(out + 0xe) = CONCAT44((int)uVar14,(int)uVar10);
    pfVar2 = out;
  }
  return pfVar2;
}



/* FUN_0045e832 @ 0045e832 */

void FUN_0045e832(undefined8 *param_1,ulonglong *param_2)

{
  ulonglong uVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  undefined8 uVar4;
  undefined8 in_MM4;
  undefined8 uVar5;
  ulonglong uVar6;
  
  FastExitMediaState();
  uVar1 = *param_2;
  uVar3 = (ulonglong)(uint)param_2[1];
  uVar2 = PackedFloatingMUL(uVar1,uVar1);
  uVar4 = PackedFloatingMUL(uVar3,uVar3);
  uVar2 = PackedFloatingADD(uVar2,uVar4);
  uVar2 = PackedFloatingAccumulate(uVar2,uVar2);
  uVar5 = PackedFloatingReciprocalSQRAprox(in_MM4,uVar2);
  uVar6 = PackedFloatingCompareGT(uVar2,0x80000000800000);
  uVar4 = PackedFloatingMUL(uVar5,uVar5);
  uVar2 = PackedFloatingReciprocalSQRIter1(uVar2,uVar4);
  uVar2 = PackedFloatingReciprocalIter2(uVar2,uVar5);
  uVar4 = PackedFloatingMUL(uVar1 & uVar6,uVar2);
  uVar2 = PackedFloatingMUL(uVar3 & uVar6,uVar2);
  *param_1 = uVar4;
  *(int *)(param_1 + 1) = (int)uVar2;
  FastExitMediaState();
  return;
}



/* vec3_transform_coord @ 0045eac0 */

/* transforms a vec3 by a matrix and divides by W (perspective) */

float * vec3_transform_coord(float *out,float *vec,float *mat)

{
  undefined4 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  undefined8 uVar7;
  undefined8 uVar8;
  
  FastExitMediaState();
  uVar1 = (undefined4)*(undefined8 *)vec;
  uVar4 = CONCAT44(uVar1,uVar1);
  uVar1 = (undefined4)((ulonglong)*(undefined8 *)vec >> 0x20);
  uVar7 = CONCAT44(uVar1,uVar1);
  uVar8 = CONCAT44(vec[2],vec[2]);
  uVar2 = PackedFloatingMUL(uVar4,*(undefined8 *)mat);
  uVar3 = PackedFloatingMUL(uVar7,*(undefined8 *)(mat + 4));
  uVar5 = PackedFloatingMUL(uVar8,*(undefined8 *)(mat + 8));
  uVar2 = PackedFloatingADD(uVar2,*(undefined8 *)(mat + 0xc));
  uVar6 = PackedFloatingMUL(uVar4,*(undefined8 *)(mat + 2));
  uVar4 = PackedFloatingADD(uVar3,uVar5);
  uVar3 = PackedFloatingMUL(uVar7,*(undefined8 *)(mat + 6));
  uVar8 = PackedFloatingMUL(uVar8,*(undefined8 *)(mat + 10));
  uVar7 = PackedFloatingADD(uVar6,*(undefined8 *)(mat + 0xe));
  uVar4 = PackedFloatingADD(uVar2,uVar4);
  uVar3 = PackedFloatingADD(uVar3,uVar8);
  uVar2 = PackedFloatingADD(uVar7,uVar3);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  uVar8 = CONCAT44(uVar1,uVar1);
  uVar7 = FloatingReciprocalAprox(uVar3,uVar8);
  uVar3 = PackedFloatingReciprocalIter1(uVar8,uVar7);
  uVar7 = PackedFloatingReciprocalIter2(uVar3,uVar7);
  uVar4 = PackedFloatingMUL(uVar4,uVar7);
  uVar2 = PackedFloatingMUL(uVar2,uVar7);
  *(undefined8 *)out = uVar4;
  out[2] = (float)uVar2;
  FastExitMediaState();
  return out;
}



/* mat4_mul @ 0045eb4b */

/* multiplies two 4x4 matrices (SSE) */

float * mat4_mul(float *out,float *lhs,float *rhs)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  undefined8 uVar7;
  undefined8 uVar8;
  undefined8 uVar9;
  
  uVar1 = (undefined4)((ulonglong)*(undefined8 *)lhs >> 0x20);
  uVar2 = (undefined4)((ulonglong)*(undefined8 *)(lhs + 2) >> 0x20);
  uVar3 = (undefined4)*(undefined8 *)lhs;
  uVar6 = CONCAT44(uVar3,uVar3);
  uVar3 = (undefined4)*(undefined8 *)(lhs + 2);
  uVar9 = CONCAT44(uVar3,uVar3);
  uVar7 = PackedFloatingMUL(*(undefined8 *)rhs,uVar6);
  uVar5 = CONCAT44(uVar1,uVar1);
  uVar4 = PackedFloatingMUL(uVar6,*(undefined8 *)(rhs + 2));
  uVar8 = PackedFloatingMUL(*(undefined8 *)(rhs + 4),uVar5);
  uVar6 = CONCAT44(uVar2,uVar2);
  uVar5 = PackedFloatingMUL(uVar5,*(undefined8 *)(rhs + 6));
  uVar7 = PackedFloatingADD(uVar8,uVar7);
  uVar8 = PackedFloatingMUL(*(undefined8 *)(rhs + 8),uVar9);
  uVar4 = PackedFloatingADD(uVar5,uVar4);
  uVar5 = PackedFloatingMUL(uVar9,*(undefined8 *)(rhs + 10));
  uVar9 = PackedFloatingADD(uVar8,uVar7);
  uVar7 = PackedFloatingMUL(*(undefined8 *)(rhs + 0xc),uVar6);
  uVar4 = PackedFloatingADD(uVar4,uVar5);
  uVar6 = PackedFloatingMUL(uVar6,*(undefined8 *)(rhs + 0xe));
  uVar7 = PackedFloatingADD(uVar7,uVar9);
  uVar5 = *(undefined8 *)(lhs + 4);
  uVar9 = PackedFloatingADD(uVar6,uVar4);
  uVar6 = *(undefined8 *)(lhs + 6);
  *(undefined8 *)out = uVar7;
  uVar4 = *(undefined8 *)rhs;
  *(undefined8 *)(out + 2) = uVar9;
  uVar1 = (undefined4)((ulonglong)uVar5 >> 0x20);
  uVar2 = (undefined4)((ulonglong)uVar6 >> 0x20);
  uVar3 = (undefined4)uVar5;
  uVar9 = CONCAT44(uVar3,uVar3);
  uVar3 = (undefined4)uVar6;
  uVar7 = CONCAT44(uVar3,uVar3);
  uVar8 = PackedFloatingMUL(uVar4,uVar9);
  uVar5 = CONCAT44(uVar1,uVar1);
  uVar4 = PackedFloatingMUL(uVar9,*(undefined8 *)(rhs + 2));
  uVar9 = PackedFloatingMUL(*(undefined8 *)(rhs + 4),uVar5);
  uVar6 = CONCAT44(uVar2,uVar2);
  uVar5 = PackedFloatingMUL(uVar5,*(undefined8 *)(rhs + 6));
  uVar9 = PackedFloatingADD(uVar9,uVar8);
  uVar8 = PackedFloatingMUL(*(undefined8 *)(rhs + 8),uVar7);
  uVar4 = PackedFloatingADD(uVar5,uVar4);
  uVar5 = PackedFloatingMUL(uVar7,*(undefined8 *)(rhs + 10));
  uVar9 = PackedFloatingADD(uVar8,uVar9);
  uVar7 = PackedFloatingMUL(*(undefined8 *)(rhs + 0xc),uVar6);
  uVar4 = PackedFloatingADD(uVar4,uVar5);
  uVar6 = PackedFloatingMUL(uVar6,*(undefined8 *)(rhs + 0xe));
  uVar7 = PackedFloatingADD(uVar7,uVar9);
  uVar5 = *(undefined8 *)(lhs + 8);
  uVar9 = PackedFloatingADD(uVar6,uVar4);
  uVar6 = *(undefined8 *)(lhs + 10);
  *(undefined8 *)(out + 4) = uVar7;
  uVar4 = *(undefined8 *)rhs;
  *(undefined8 *)(out + 6) = uVar9;
  uVar1 = (undefined4)((ulonglong)uVar5 >> 0x20);
  uVar2 = (undefined4)((ulonglong)uVar6 >> 0x20);
  uVar3 = (undefined4)uVar5;
  uVar9 = CONCAT44(uVar3,uVar3);
  uVar3 = (undefined4)uVar6;
  uVar7 = CONCAT44(uVar3,uVar3);
  uVar8 = PackedFloatingMUL(uVar4,uVar9);
  uVar5 = CONCAT44(uVar1,uVar1);
  uVar4 = PackedFloatingMUL(uVar9,*(undefined8 *)(rhs + 2));
  uVar9 = PackedFloatingMUL(*(undefined8 *)(rhs + 4),uVar5);
  uVar6 = CONCAT44(uVar2,uVar2);
  uVar5 = PackedFloatingMUL(uVar5,*(undefined8 *)(rhs + 6));
  uVar9 = PackedFloatingADD(uVar9,uVar8);
  uVar8 = PackedFloatingMUL(*(undefined8 *)(rhs + 8),uVar7);
  uVar4 = PackedFloatingADD(uVar5,uVar4);
  uVar5 = PackedFloatingMUL(uVar7,*(undefined8 *)(rhs + 10));
  uVar9 = PackedFloatingADD(uVar8,uVar9);
  uVar7 = PackedFloatingMUL(*(undefined8 *)(rhs + 0xc),uVar6);
  uVar4 = PackedFloatingADD(uVar4,uVar5);
  uVar6 = PackedFloatingMUL(uVar6,*(undefined8 *)(rhs + 0xe));
  uVar7 = PackedFloatingADD(uVar7,uVar9);
  uVar5 = *(undefined8 *)(lhs + 0xc);
  uVar9 = PackedFloatingADD(uVar6,uVar4);
  uVar6 = *(undefined8 *)(lhs + 0xe);
  *(undefined8 *)(out + 8) = uVar7;
  uVar4 = *(undefined8 *)rhs;
  *(undefined8 *)(out + 10) = uVar9;
  uVar1 = (undefined4)((ulonglong)uVar5 >> 0x20);
  uVar2 = (undefined4)((ulonglong)uVar6 >> 0x20);
  uVar3 = (undefined4)uVar5;
  uVar9 = CONCAT44(uVar3,uVar3);
  uVar3 = (undefined4)uVar6;
  uVar7 = CONCAT44(uVar3,uVar3);
  uVar8 = PackedFloatingMUL(uVar4,uVar9);
  uVar5 = CONCAT44(uVar1,uVar1);
  uVar4 = PackedFloatingMUL(uVar9,*(undefined8 *)(rhs + 2));
  uVar9 = PackedFloatingMUL(*(undefined8 *)(rhs + 4),uVar5);
  uVar6 = CONCAT44(uVar2,uVar2);
  uVar5 = PackedFloatingMUL(uVar5,*(undefined8 *)(rhs + 6));
  uVar9 = PackedFloatingADD(uVar9,uVar8);
  uVar8 = PackedFloatingMUL(*(undefined8 *)(rhs + 8),uVar7);
  uVar4 = PackedFloatingADD(uVar5,uVar4);
  uVar5 = PackedFloatingMUL(uVar7,*(undefined8 *)(rhs + 10));
  uVar9 = PackedFloatingADD(uVar8,uVar9);
  uVar7 = PackedFloatingMUL(*(undefined8 *)(rhs + 0xc),uVar6);
  uVar5 = PackedFloatingADD(uVar4,uVar5);
  uVar6 = PackedFloatingMUL(uVar6,*(undefined8 *)(rhs + 0xe));
  uVar4 = PackedFloatingADD(uVar7,uVar9);
  uVar5 = PackedFloatingADD(uVar6,uVar5);
  *(undefined8 *)(out + 0xc) = uVar4;
  *(undefined8 *)(out + 0xe) = uVar5;
  FastExitMediaState();
  return out;
}



/* vec3_project @ 0045ed17 */

/* projects a vec3 through optional matrices and viewport scale/bias */

float * vec3_project(float *out,float *vec,float *viewport,float *world,float *view,float *proj)

{
  float *mat;
  undefined8 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined4 uVar6;
  undefined8 uVar5;
  float local_44 [16];
  
  mat = local_44;
  switch(((proj != (float *)0x0) << 1 | view != (float *)0x0) << 1 | world != (float *)0x0) {
  case '\0':
    local_44[0xe] = 0.0;
    local_44[0xd] = 0.0;
    local_44[0xc] = 0.0;
    local_44[0xb] = 0.0;
    local_44[9] = 0.0;
    local_44[8] = 0.0;
    local_44[7] = 0.0;
    local_44[6] = 0.0;
    local_44[4] = 0.0;
    local_44[3] = 0.0;
    local_44[2] = 0.0;
    local_44[1] = 0.0;
    local_44[0xf] = 1.0;
    local_44[10] = 1.0;
    local_44[5] = 1.0;
    local_44[0] = 1.0;
    break;
  case '\x01':
    mat = world;
    break;
  case '\x02':
    mat = view;
    break;
  case '\x03':
    FastExitMediaState();
    mat4_mul(local_44,view,world);
    FastExitMediaState();
    break;
  case '\x04':
    mat = proj;
    break;
  case '\x05':
    FastExitMediaState();
    mat4_mul(local_44,proj,world);
    FastExitMediaState();
    break;
  case '\x06':
    FastExitMediaState();
    mat4_mul(local_44,proj,view);
    FastExitMediaState();
    break;
  case '\a':
    FastExitMediaState();
    mat4_mul(local_44,proj,view);
    mat4_mul(local_44,local_44,world);
    FastExitMediaState();
  }
  vec3_transform_coord(out,vec,mat);
  if (viewport != (float *)0x0) {
    FastExitMediaState();
    uVar2 = *(undefined8 *)(viewport + 4);
    uVar3 = PackedIntToFloatingDwordConv(*(undefined8 *)viewport,*(undefined8 *)viewport);
    uVar4 = PackedIntToFloatingDwordConv
                      (*(undefined8 *)(viewport + 2),*(undefined8 *)(viewport + 2));
    uVar1 = PackedFloatingADD(*(ulonglong *)out ^ 0x8000000000000000,0x3f8000003f800000);
    uVar4 = PackedFloatingMUL(uVar4,0x3f0000003f000000);
    uVar6 = (undefined4)((ulonglong)uVar2 >> 0x20);
    uVar5 = PackedFloatingSUB(CONCAT44(uVar6,uVar6),uVar2);
    uVar1 = PackedFloatingMUL(uVar1,uVar4);
    uVar4 = PackedFloatingMUL((ulonglong)(uint)out[2],uVar5);
    uVar4 = PackedFloatingADD(uVar4,uVar2);
    uVar2 = PackedFloatingADD(uVar1,uVar3);
    *(undefined8 *)out = uVar2;
    out[2] = (float)uVar4;
    FastExitMediaState();
  }
  return out;
}



/* vec3_unproject @ 0045ee9f */

/* unprojects a screen-space vec3 using inverse matrices and viewport */

float * vec3_unproject(float *out,float *vec,float *viewport,float *world,float *view,float *proj)

{
  undefined8 uVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined4 uVar7;
  undefined8 uVar6;
  undefined8 uVar8;
  unkbyte10 in_ST5;
  undefined8 uVar9;
  unkbyte10 in_ST6;
  float local_44 [16];
  
  uVar2 = (undefined8)in_ST5;
  uVar9 = (undefined8)in_ST6;
  switch(((proj != (float *)0x0) << 1 | view != (float *)0x0) << 1 | world != (float *)0x0) {
  case '\0':
    local_44[0xe] = 0.0;
    local_44[0xd] = 0.0;
    local_44[0xc] = 0.0;
    local_44[0xb] = 0.0;
    local_44[9] = 0.0;
    local_44[8] = 0.0;
    local_44[7] = 0.0;
    local_44[6] = 0.0;
    local_44[4] = 0.0;
    local_44[3] = 0.0;
    local_44[2] = 0.0;
    local_44[1] = 0.0;
    local_44[0xf] = 1.0;
    local_44[10] = 1.0;
    local_44[5] = 1.0;
    local_44[0] = 1.0;
    break;
  case '\x01':
    FastExitMediaState();
    mat4_invert(local_44,(float *)0x0,world);
    uVar2 = (undefined8)in_ST5;
    uVar9 = (undefined8)in_ST6;
    FastExitMediaState();
    break;
  case '\x02':
    FastExitMediaState();
    mat4_invert(local_44,(float *)0x0,view);
    uVar2 = (undefined8)in_ST5;
    uVar9 = (undefined8)in_ST6;
    FastExitMediaState();
    break;
  case '\x03':
    FastExitMediaState();
    mat4_mul(local_44,view,world);
    mat4_invert(local_44,(float *)0x0,local_44);
    uVar2 = (undefined8)in_ST5;
    uVar9 = (undefined8)in_ST6;
    FastExitMediaState();
    break;
  case '\x04':
    FastExitMediaState();
    mat4_invert(local_44,(float *)0x0,proj);
    uVar2 = (undefined8)in_ST5;
    uVar9 = (undefined8)in_ST6;
    FastExitMediaState();
    break;
  case '\x05':
    FastExitMediaState();
    mat4_mul(local_44,proj,world);
    mat4_invert(local_44,(float *)0x0,local_44);
    uVar2 = (undefined8)in_ST5;
    uVar9 = (undefined8)in_ST6;
    FastExitMediaState();
    break;
  case '\x06':
    FastExitMediaState();
    mat4_mul(local_44,proj,view);
    mat4_invert(local_44,(float *)0x0,local_44);
    uVar2 = (undefined8)in_ST5;
    uVar9 = (undefined8)in_ST6;
    FastExitMediaState();
    break;
  case '\a':
    FastExitMediaState();
    mat4_mul(local_44,proj,view);
    mat4_mul(local_44,local_44,world);
    mat4_invert(local_44,(float *)0x0,local_44);
    uVar2 = (undefined8)in_ST5;
    uVar9 = (undefined8)in_ST6;
    FastExitMediaState();
  }
  if (viewport != (float *)0x0) {
    FastExitMediaState();
    uVar4 = PackedIntToFloatingDwordConv(*(undefined8 *)viewport,*(undefined8 *)viewport);
    uVar1 = *(undefined8 *)(viewport + 4);
    uVar5 = PackedIntToFloatingDwordConv
                      (*(undefined8 *)(viewport + 2),*(undefined8 *)(viewport + 2));
    uVar7 = (undefined4)((ulonglong)uVar5 >> 0x20);
    uVar6 = CONCAT44(uVar7,uVar7);
    uVar8 = FloatingReciprocalAprox(uVar2,uVar5);
    uVar6 = FloatingReciprocalAprox(uVar6,uVar6);
    uVar2 = PackedFloatingSUB(*(undefined8 *)vec,uVar4);
    uVar6 = CONCAT44((int)uVar6,(int)uVar8);
    uVar4 = PackedFloatingReciprocalIter1(uVar5,uVar6);
    uVar4 = PackedFloatingReciprocalIter2(uVar4,uVar6);
    uVar4 = PackedFloatingMUL(uVar4,0x4000000040000000);
    uVar2 = PackedFloatingMUL(uVar2,uVar4);
    uVar7 = (undefined4)((ulonglong)uVar1 >> 0x20);
    uVar3 = PackedFloatingSUB(uVar2,0x3f8000003f800000);
    uVar2 = PackedFloatingSUB(CONCAT44(uVar7,uVar7),uVar1);
    uVar9 = FloatingReciprocalAprox(uVar9,uVar2);
    uVar2 = PackedFloatingReciprocalIter1(uVar2,uVar9);
    uVar9 = PackedFloatingReciprocalIter2(uVar2,uVar9);
    uVar2 = PackedFloatingSUB((ulonglong)(uint)vec[2],uVar1);
    uVar2 = PackedFloatingMUL(uVar2,uVar9);
    *(ulonglong *)out = uVar3 ^ 0x8000000000000000;
    out[2] = (float)uVar2;
    FastExitMediaState();
    vec = out;
  }
  vec3_transform_coord(out,vec,local_44);
  return out;
}



/* FUN_0045f0c5 @ 0045f0c5 */

ulonglong *
FUN_0045f0c5(ulonglong *param_1,ulonglong *param_2,undefined8 *param_3,undefined8 *param_4,
            undefined8 *param_5,undefined8 *param_6)

{
  ulonglong uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined4 uVar6;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 in_MM5;
  undefined8 uVar7;
  undefined8 in_MM6;
  float local_44 [16];
  
  switch(((param_6 != (undefined8 *)0x0) << 1 | param_5 != (undefined8 *)0x0) << 1 |
         param_4 != (undefined8 *)0x0) {
  case '\0':
    FUN_0045b092((undefined8 *)local_44);
    goto switchD_0045f0fb_default;
  case '\x01':
    param_6 = param_4;
    goto LAB_0045f13f;
  case '\x02':
    param_6 = param_5;
    goto LAB_0045f13f;
  case '\x03':
    param_6 = param_5;
    break;
  case '\x04':
    goto LAB_0045f13f;
  case '\x05':
    break;
  case '\x06':
    param_4 = param_5;
    break;
  case '\a':
    mat4_mul(local_44,(float *)param_6,(float *)param_5);
    param_6 = (undefined8 *)local_44;
    break;
  default:
    goto switchD_0045f0fb_default;
  }
  mat4_mul(local_44,(float *)param_6,(float *)param_4);
  param_6 = (undefined8 *)local_44;
LAB_0045f13f:
  FUN_0045dd30((undefined8 *)local_44,(undefined4 *)0x0,param_6);
switchD_0045f0fb_default:
  if (param_3 != (undefined8 *)0x0) {
    FastExitMediaState();
    uVar2 = PackedIntToFloatingDwordConv(*param_3,*param_3);
    uVar5 = param_3[2];
    uVar3 = PackedIntToFloatingDwordConv(param_3[1],param_3[1]);
    uVar6 = (undefined4)((ulonglong)uVar3 >> 0x20);
    uVar4 = CONCAT44(uVar6,uVar6);
    uVar7 = FloatingReciprocalAprox(in_MM5,uVar3);
    uVar4 = FloatingReciprocalAprox(uVar4,uVar4);
    uVar2 = PackedFloatingSUB(*param_2,uVar2);
    uVar4 = CONCAT44((int)uVar4,(int)uVar7);
    uVar3 = PackedFloatingReciprocalIter1(uVar3,uVar4);
    uVar3 = PackedFloatingReciprocalIter2(uVar3,uVar4);
    uVar3 = PackedFloatingMUL(uVar3,0x4000000040000000);
    uVar2 = PackedFloatingMUL(uVar2,uVar3);
    uVar6 = (undefined4)((ulonglong)uVar5 >> 0x20);
    uVar1 = PackedFloatingSUB(uVar2,0x3f8000003f800000);
    uVar2 = PackedFloatingSUB(CONCAT44(uVar6,uVar6),uVar5);
    uVar3 = FloatingReciprocalAprox(in_MM6,uVar2);
    uVar2 = PackedFloatingReciprocalIter1(uVar2,uVar3);
    uVar2 = PackedFloatingReciprocalIter2(uVar2,uVar3);
    uVar5 = PackedFloatingSUB((ulonglong)(uint)param_2[1],uVar5);
    uVar5 = PackedFloatingMUL(uVar5,uVar2);
    *param_1 = uVar1 ^ 0x8000000000000000;
    *(int *)(param_1 + 1) = (int)uVar5;
    FastExitMediaState();
    param_2 = param_1;
  }
  vec3_transform_coord((float *)param_1,(float *)param_2,local_44);
  return param_1;
}



/* FUN_0045fae8 @ 0045fae8 */

void FUN_0045fae8(undefined8 *param_1,ulonglong *param_2)

{
  ulonglong uVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  undefined8 uVar4;
  undefined8 in_MM4;
  undefined8 uVar5;
  
  uVar1 = *param_2;
  uVar3 = param_2[1] & 0xffffffff;
  uVar2 = PackedFloatingMUL(uVar1,uVar1);
  uVar4 = PackedFloatingMUL(uVar3,uVar3);
  uVar2 = PackedFloatingADD(uVar2,uVar4);
  uVar2 = PackedFloatingAccumulate(uVar2,uVar2);
  uVar5 = PackedFloatingReciprocalSQRAprox(in_MM4,uVar2);
  uVar3 = PackedFloatingCompareGT(uVar2,0x80000000800000);
  uVar4 = PackedFloatingMUL(uVar5,uVar5);
  uVar2 = PackedFloatingReciprocalSQRIter1(uVar2,uVar4);
  uVar2 = PackedFloatingReciprocalIter2(uVar2,uVar5);
  uVar4 = PackedFloatingMUL(uVar1 & uVar3,uVar2);
  uVar2 = PackedFloatingMUL(param_2[1] & uVar3,uVar2);
  *param_1 = uVar4;
  param_1[1] = uVar2;
  FastExitMediaState();
  return;
}



/* FUN_0045fbd0 @ 0045fbd0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl FUN_0045fbd0(uint *param_1,uint *param_2,uint *param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  float fVar6;
  float fVar7;
  float fVar8;
  uint uVar9;
  float fVar10;
  float fVar11;
  float fVar12;
  uint uVar13;
  float fVar14;
  float fVar15;
  float fVar16;
  uint uVar17;
  float fVar18;
  float fVar19;
  float fVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  uint uVar24;
  uint uVar25;
  uint uVar26;
  uint uVar27;
  uint uVar28;
  
  fVar6 = (float)(*param_1 & _DAT_0047ada0);
  fVar10 = (float)(param_1[1] & uRam0047ada4);
  fVar14 = (float)(param_1[2] & uRam0047ada8);
  fVar18 = (float)(param_1[3] & uRam0047adac);
  uVar22 = param_1[1] & uRam0047ad94;
  uVar23 = param_1[2] & uRam0047ad98;
  uVar24 = param_1[3] & uRam0047ad9c;
  fVar7 = fVar6 * _DAT_0047ad80 + _DAT_0047ad30;
  fVar11 = fVar10 * fRam0047ad84 + fRam0047ad34;
  fVar15 = fVar14 * fRam0047ad88 + fRam0047ad38;
  fVar19 = fVar18 * fRam0047ad8c + fRam0047ad3c;
  fVar8 = fVar7 - _DAT_0047ad30;
  fVar12 = fVar11 - fRam0047ad34;
  fVar16 = fVar15 - fRam0047ad38;
  fVar20 = fVar19 - fRam0047ad3c;
  fVar6 = (((fVar6 - _DAT_0047ad70 * fVar8) - _DAT_0047ad60 * fVar8) - _DAT_0047ad50 * fVar8) -
          _DAT_0047ad40 * fVar8;
  fVar8 = (((fVar10 - fRam0047ad74 * fVar12) - fRam0047ad64 * fVar12) - fRam0047ad54 * fVar12) -
          fRam0047ad44 * fVar12;
  fVar10 = (((fVar14 - fRam0047ad78 * fVar16) - fRam0047ad68 * fVar16) - fRam0047ad58 * fVar16) -
           fRam0047ad48 * fVar16;
  fVar12 = (((fVar18 - fRam0047ad7c * fVar20) - fRam0047ad6c * fVar20) - fRam0047ad5c * fVar20) -
           fRam0047ad4c * fVar20;
  fVar14 = fVar6 * fVar6;
  fVar16 = fVar8 * fVar8;
  fVar18 = fVar10 * fVar10;
  fVar20 = fVar12 * fVar12;
  uVar25 = (uint)fVar7 & _DAT_0047ad00;
  uVar26 = (uint)fVar11 & uRam0047ad04;
  uVar27 = (uint)fVar15 & uRam0047ad08;
  uVar28 = (uint)fVar19 & uRam0047ad0c;
  uVar9 = uVar25 & _DAT_0047acf0;
  uVar13 = uVar26 & uRam0047acf4;
  uVar17 = uVar27 & uRam0047acf8;
  uVar21 = uVar28 & uRam0047acfc;
  uVar1 = uVar26 - uVar13 & _DAT_0047ace0;
  uVar2 = uVar27 - uVar17 & _DAT_0047ace0;
  uVar3 = uVar28 - uVar21 & _DAT_0047ace0;
  uVar4 = uVar25 + uVar9 & _DAT_0047ace0;
  uVar26 = uVar26 + uVar13 & _DAT_0047ace0;
  uVar27 = uVar27 + uVar17 & _DAT_0047ace0;
  uVar28 = uVar28 + uVar21 & _DAT_0047ace0;
  uVar5 = -(uint)((float)(uVar9 << 0x1e) != 0.0);
  uVar13 = -(uint)((float)(uVar13 << 0x1e) != 0.0);
  uVar17 = -(uint)((float)(uVar17 << 0x1e) != 0.0);
  uVar21 = -(uint)((float)(uVar21 << 0x1e) != 0.0);
  fVar6 = (((_DAT_0047ad20 * fVar14 + _DAT_0047acd0) * fVar14 + _DAT_0047acb0) * fVar14 +
          _DAT_0047ac90) * fVar6;
  fVar8 = (((fRam0047ad24 * fVar16 + fRam0047acd4) * fVar16 + fRam0047acb4) * fVar16 + fRam0047ac94)
          * fVar8;
  fVar10 = (((fRam0047ad28 * fVar18 + fRam0047acd8) * fVar18 + fRam0047acb8) * fVar18 + fRam0047ac98
           ) * fVar10;
  fVar12 = (((fRam0047ad2c * fVar20 + fRam0047acdc) * fVar20 + fRam0047acbc) * fVar20 + fRam0047ac9c
           ) * fVar12;
  fVar7 = (((_DAT_0047ad10 * fVar14 + _DAT_0047acc0) * fVar14 + _DAT_0047aca0) * fVar14 +
          _DAT_0047ac80) * fVar14 + _DAT_0047ac70;
  fVar11 = (((fRam0047ad14 * fVar16 + fRam0047acc4) * fVar16 + fRam0047aca4) * fVar16 + fRam0047ac84
           ) * fVar16 + fRam0047ac74;
  fVar14 = (((fRam0047ad18 * fVar18 + fRam0047acc8) * fVar18 + fRam0047aca8) * fVar18 + fRam0047ac88
           ) * fVar18 + fRam0047ac78;
  fVar15 = (((fRam0047ad1c * fVar20 + fRam0047accc) * fVar20 + fRam0047acac) * fVar20 + fRam0047ac8c
           ) * fVar20 + fRam0047ac7c;
  *param_2 = (~uVar5 & (uint)fVar6 | uVar5 & (uint)fVar7) ^
             (uVar25 - uVar9 & _DAT_0047ace0) << 0x1e ^ *param_1 & _DAT_0047ad90;
  param_2[1] = (~uVar13 & (uint)fVar8 | uVar13 & (uint)fVar11) ^ uVar1 << 0x1e ^ uVar22;
  param_2[2] = (~uVar17 & (uint)fVar10 | uVar17 & (uint)fVar14) ^ uVar2 << 0x1e ^ uVar23;
  param_2[3] = (~uVar21 & (uint)fVar12 | uVar21 & (uint)fVar15) ^ uVar3 << 0x1e ^ uVar24;
  *param_3 = (uVar5 & (uint)fVar6 | ~uVar5 & (uint)fVar7) ^ uVar4 << 0x1e;
  param_3[1] = (uVar13 & (uint)fVar8 | ~uVar13 & (uint)fVar11) ^ uVar26 << 0x1e;
  param_3[2] = (uVar17 & (uint)fVar10 | ~uVar17 & (uint)fVar14) ^ uVar27 << 0x1e;
  param_3[3] = (uVar21 & (uint)fVar12 | ~uVar21 & (uint)fVar15) ^ uVar28 << 0x1e;
  return;
}



/* FUN_0045fdc0 @ 0045fdc0 */

void FUN_0045fdc0(void)

{
  return;
}



/* FUN_0045feb0 @ 0045feb0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl FUN_0045feb0(uint *param_1,uint *param_2,uint *param_3)

{
  float fVar1;
  float fVar2;
  uint uVar3;
  float fVar4;
  float fVar5;
  uint uVar6;
  float fVar7;
  float fVar8;
  uint uVar9;
  float fVar10;
  float fVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  float fVar16;
  float fVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  uint uVar24;
  float fVar25;
  float fVar26;
  uint uVar27;
  uint uVar28;
  
  fVar16 = (float)(*param_1 & _DAT_0047afc0);
  fVar17 = (float)(param_1[1] & uRam0047afc4);
  fVar25 = (float)(param_1[2] & uRam0047afc8);
  fVar26 = (float)(param_1[3] & uRam0047afcc);
  uVar13 = param_1[1] & uRam0047afb4;
  uVar14 = param_1[2] & uRam0047afb8;
  uVar15 = param_1[3] & uRam0047afbc;
  fVar1 = fVar16 * _DAT_0047afa0 + _DAT_0047af50;
  fVar4 = fVar17 * fRam0047afa4 + fRam0047af54;
  fVar7 = fVar25 * fRam0047afa8 + fRam0047af58;
  fVar10 = fVar26 * fRam0047afac + fRam0047af5c;
  fVar2 = fVar1 - _DAT_0047af50;
  fVar5 = fVar4 - fRam0047af54;
  fVar8 = fVar7 - fRam0047af58;
  fVar11 = fVar10 - fRam0047af5c;
  fVar16 = (((fVar16 - _DAT_0047af90 * fVar2) - _DAT_0047af80 * fVar2) - _DAT_0047af70 * fVar2) -
           _DAT_0047af60 * fVar2;
  fVar2 = (((fVar17 - fRam0047af94 * fVar5) - fRam0047af84 * fVar5) - fRam0047af74 * fVar5) -
          fRam0047af64 * fVar5;
  fVar17 = (((fVar25 - fRam0047af98 * fVar8) - fRam0047af88 * fVar8) - fRam0047af78 * fVar8) -
           fRam0047af68 * fVar8;
  fVar5 = (((fVar26 - fRam0047af9c * fVar11) - fRam0047af8c * fVar11) - fRam0047af7c * fVar11) -
          fRam0047af6c * fVar11;
  fVar25 = fVar16 * fVar16;
  fVar8 = fVar2 * fVar2;
  fVar26 = fVar17 * fVar17;
  fVar11 = fVar5 * fVar5;
  uVar18 = (uint)fVar1 & _DAT_0047af20;
  uVar19 = (uint)fVar4 & uRam0047af24;
  uVar21 = (uint)fVar7 & uRam0047af28;
  uVar23 = (uint)fVar10 & uRam0047af2c;
  uVar3 = uVar18 & _DAT_0047af10;
  uVar6 = uVar19 & uRam0047af14;
  uVar9 = uVar21 & uRam0047af18;
  uVar12 = uVar23 & uRam0047af1c;
  uVar20 = uVar19 - uVar6 & uRam0047af04;
  uVar22 = uVar21 - uVar9 & uRam0047af08;
  uVar24 = uVar23 - uVar12 & uRam0047af0c;
  uVar27 = uVar18 + uVar3 & _DAT_0047af00;
  uVar28 = uVar19 + uVar6 & uRam0047af04;
  uVar21 = uVar21 + uVar9 & uRam0047af08;
  uVar23 = uVar23 + uVar12 & uRam0047af0c;
  uVar19 = -(uint)((float)(uVar3 << 0x1e) != 0.0);
  uVar6 = -(uint)((float)(uVar6 << 0x1e) != 0.0);
  uVar9 = -(uint)((float)(uVar9 << 0x1e) != 0.0);
  uVar12 = -(uint)((float)(uVar12 << 0x1e) != 0.0);
  fVar16 = (((_DAT_0047af40 * fVar25 + _DAT_0047aef0) * fVar25 + _DAT_0047aed0) * fVar25 +
           _DAT_0047aeb0) * fVar16;
  fVar2 = (((fRam0047af44 * fVar8 + fRam0047aef4) * fVar8 + fRam0047aed4) * fVar8 + fRam0047aeb4) *
          fVar2;
  fVar17 = (((fRam0047af48 * fVar26 + fRam0047aef8) * fVar26 + fRam0047aed8) * fVar26 + fRam0047aeb8
           ) * fVar17;
  fVar5 = (((fRam0047af4c * fVar11 + fRam0047aefc) * fVar11 + fRam0047aedc) * fVar11 + fRam0047aebc)
          * fVar5;
  fVar1 = (((_DAT_0047af30 * fVar25 + _DAT_0047aee0) * fVar25 + _DAT_0047aec0) * fVar25 +
          _DAT_0047aea0) * fVar25 + _DAT_0047ae90;
  fVar4 = (((fRam0047af34 * fVar8 + fRam0047aee4) * fVar8 + fRam0047aec4) * fVar8 + fRam0047aea4) *
          fVar8 + fRam0047ae94;
  fVar25 = (((fRam0047af38 * fVar26 + fRam0047aee8) * fVar26 + fRam0047aec8) * fVar26 + fRam0047aea8
           ) * fVar26 + fRam0047ae98;
  fVar7 = (((fRam0047af3c * fVar11 + fRam0047aeec) * fVar11 + fRam0047aecc) * fVar11 + fRam0047aeac)
          * fVar11 + fRam0047ae9c;
  *param_2 = (~uVar19 & (uint)fVar16 | uVar19 & (uint)fVar1) ^
             (uVar18 - uVar3 & _DAT_0047af00) << 0x1e ^ *param_1 & _DAT_0047afb0;
  param_2[1] = (~uVar6 & (uint)fVar2 | uVar6 & (uint)fVar4) ^ uVar20 << 0x1e ^ uVar13;
  param_2[2] = (~uVar9 & (uint)fVar17 | uVar9 & (uint)fVar25) ^ uVar22 << 0x1e ^ uVar14;
  param_2[3] = (~uVar12 & (uint)fVar5 | uVar12 & (uint)fVar7) ^ uVar24 << 0x1e ^ uVar15;
  *param_3 = (uVar19 & (uint)fVar16 | ~uVar19 & (uint)fVar1) ^ uVar27 << 0x1e;
  param_3[1] = (uVar6 & (uint)fVar2 | ~uVar6 & (uint)fVar4) ^ uVar28 << 0x1e;
  param_3[2] = (uVar9 & (uint)fVar17 | ~uVar9 & (uint)fVar25) ^ uVar21 << 0x1e;
  param_3[3] = (uVar12 & (uint)fVar5 | ~uVar12 & (uint)fVar7) ^ uVar23 << 0x1e;
  return;
}



/* math_atan2_packed @ 004600c0 */

/* packed atan2 approximation; inputs in MM0/MM1 */

ulonglong math_atan2_packed(void)

{
  undefined4 in_EAX;
  undefined4 in_EDX;
  ulonglong in_MM0;
  ulonglong uVar1;
  undefined8 uVar2;
  ulonglong in_MM1;
  ulonglong uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  uint uVar7;
  uint uVar8;
  
  uVar3 = in_MM1 & DAT_0047b09c;
  uVar1 = in_MM0 & DAT_0047b09c;
  uVar2 = PackedFloatingMAX(uVar1,uVar3);
  uVar7 = (uint)((int)uVar1 < (int)uVar3) * -0x80000000;
  uVar4 = PackedFloatingMIN(uVar3,uVar1);
  uVar5 = FloatingReciprocalAprox(uVar1,uVar2);
  uVar2 = PackedFloatingReciprocalIter1(uVar2,uVar5);
  uVar2 = PackedFloatingReciprocalIter2(uVar2,uVar5);
  uVar2 = PackedFloatingMUL(uVar2,uVar4);
  uVar4 = PackedFloatingMUL(uVar2,uVar2);
  uVar5 = PackedFloatingADD((ulonglong)DAT_0047b0d0,uVar4);
  uVar6 = PackedFloatingMUL((ulonglong)DAT_0047b0dc,uVar4);
  uVar5 = PackedFloatingMUL(uVar5,uVar4);
  uVar6 = PackedFloatingADD(uVar6,(ulonglong)DAT_0047b0d8);
  uVar5 = PackedFloatingADD(uVar5,(ulonglong)DAT_0047b0cc);
  uVar6 = PackedFloatingMUL(uVar6,uVar4);
  uVar5 = PackedFloatingMUL(uVar5,uVar4);
  uVar6 = PackedFloatingADD(uVar6,(ulonglong)DAT_0047b0d4);
  uVar5 = PackedFloatingADD(uVar5,(ulonglong)DAT_0047b0c8);
  uVar4 = PackedFloatingMUL(uVar4,uVar6);
  uVar4 = PackedFloatingMUL(uVar4,uVar2);
  uVar6 = FloatingReciprocalAprox((ulonglong)DAT_0047b0d4,uVar5);
  uVar8 = ((uint)((DAT_0047b098 & in_MM0) >> 1) | DAT_0047b098 & (uint)in_MM1) << 1;
  uVar5 = PackedFloatingReciprocalIter1(uVar5,uVar6);
  uVar5 = PackedFloatingReciprocalIter2(uVar5,uVar6);
  uVar4 = PackedFloatingMUL(uVar4,uVar5);
  uVar1 = PackedFloatingADD(uVar4,uVar2);
  uVar2 = PackedFloatingSUB(~(ulonglong)(uint)((int)uVar7 >> 0x1f) &
                            (ulonglong)(uVar8 ^ DAT_0047b0f8),(ulonglong)DAT_0047b0f8);
  PackedFloatingADD(uVar1 | uVar8 ^ uVar7,uVar2);
  return CONCAT44(in_EDX,in_EAX);
}



/* math_acos_packed @ 004601c0 */

/* packed acos approximation; input in MM0 */

ulonglong math_acos_packed(void)

{
  uint uVar1;
  undefined4 in_EAX;
  undefined4 in_EDX;
  ulonglong in_MM0;
  ulonglong uVar2;
  undefined8 uVar3;
  uint uVar4;
  undefined8 uVar6;
  undefined8 uVar7;
  ulonglong uVar8;
  ulonglong uVar5;
  
  uVar2 = in_MM0 & DAT_0047b09c;
  uVar3 = PackedFloatingMUL(uVar2,(ulonglong)DAT_0047b0ac);
  uVar3 = PackedFloatingSUBR(uVar3,(ulonglong)DAT_0047b0ac);
  uVar6 = PackedFloatingReciprocalSQRAprox((ulonglong)DAT_0047b09c,uVar3);
  uVar7 = PackedFloatingMUL(uVar6,uVar6);
  uVar1 = (uint)((int)uVar2 < DAT_0047b0e0);
  uVar4 = -uVar1;
  uVar5 = (ulonglong)uVar4;
  uVar7 = PackedFloatingReciprocalSQRIter1(uVar7,uVar3);
  uVar6 = PackedFloatingReciprocalIter2(uVar7,uVar6);
  uVar8 = PackedFloatingMUL(uVar6,uVar3);
  uVar2 = ~uVar5 & uVar8 | uVar2 & uVar4;
  uVar3 = PackedFloatingMUL(uVar2,uVar2);
  uVar7 = PackedFloatingMUL((ulonglong)DAT_0047b0e8,uVar3);
  uVar6 = PackedFloatingADD((ulonglong)DAT_0047b0f0,uVar3);
  uVar7 = PackedFloatingADD(uVar7,(ulonglong)DAT_0047b0e4);
  uVar7 = PackedFloatingMUL(uVar7,uVar3);
  uVar3 = PackedFloatingMUL(uVar3,uVar6);
  uVar3 = PackedFloatingADD(uVar3,(ulonglong)DAT_0047b0ec);
  uVar7 = PackedFloatingMUL(uVar7,uVar2);
  uVar6 = FloatingReciprocalAprox(uVar6,uVar3);
  uVar3 = PackedFloatingReciprocalIter1(uVar3,uVar6);
  uVar3 = PackedFloatingReciprocalIter2(uVar3,uVar6);
  uVar3 = PackedFloatingMUL(uVar3,uVar7);
  uVar2 = PackedFloatingADD(uVar2,uVar3);
  uVar3 = PackedFloatingADD(~uVar5 & (ulonglong)DAT_0047b0f8 ^ DAT_0047b098 & in_MM0,
                            (ulonglong)DAT_0047b0f4);
  uVar2 = PackedFloatingADD(uVar2,~uVar5 & uVar2);
  PackedFloatingADD(uVar3,uVar2 | (ulonglong)(uVar1 * -0x80000000) ^ DAT_0047b098 & in_MM0);
  return CONCAT44(in_EDX,in_EAX);
}



/* math_sincos_packed @ 004607a0 */

/* packed sin/cos approximation for the angle in MM0 */

ulonglong math_sincos_packed(void)

{
  uint uVar1;
  uint uVar2;
  ulonglong in_MM0;
  undefined8 uVar3;
  ulonglong uVar4;
  undefined4 uVar5;
  undefined8 uVar6;
  undefined8 uVar7;
  undefined8 uVar8;
  undefined8 uVar9;
  
  uVar1 = (uint)in_MM0;
  uVar2 = uVar1 >> 0x1f;
  uVar1 = uVar1 ^ uVar1 & 0x80000000;
  if ((int)uVar1 < DAT_0047b154) {
    uVar3 = PackedFloatingMUL(in_MM0 & DAT_0047b09c,(ulonglong)DAT_0047b150);
    uVar4 = PackedFloatingToIntDwordConv(uVar3,uVar3);
    uVar3 = PackedIntToFloatingDwordConv(uVar4,uVar4);
    uVar3 = PackedFloatingMUL(CONCAT44((int)uVar3,(int)uVar3),DAT_0047b060);
    uVar6 = PackedFloatingADD(in_MM0 & DAT_0047b09c,uVar3);
    uVar5 = (undefined4)((ulonglong)uVar3 >> 0x20);
    uVar3 = PackedFloatingADD(uVar6,CONCAT44(uVar5,uVar5));
    uVar3 = CONCAT44((int)uVar3,(int)uVar3);
    if ((uVar4 & 1) != 0) {
      uVar3 = PackedFloatingSUBR(uVar3,DAT_0047b070);
    }
    uVar2 = (uVar2 ^ (uint)uVar4 >> 2) << 0x1f;
    uVar6 = PackedFloatingMUL(uVar3,uVar3);
    uVar8 = PackedFloatingMUL(DAT_0047b068,uVar6);
    uVar7 = PackedFloatingMUL(DAT_0047b078,uVar6);
    uVar9 = PackedFloatingADD(uVar8,DAT_0047b018);
    uVar8 = PackedFloatingMUL(DAT_0047b080,uVar6);
    uVar7 = PackedFloatingMUL(uVar9,uVar7);
    uVar9 = PackedFloatingADD(uVar7,DAT_0047b018);
    uVar7 = PackedFloatingMUL(DAT_0047b088,uVar6);
    uVar6 = PackedFloatingMUL(uVar8,uVar9);
    uVar6 = PackedFloatingADD(uVar6,DAT_0047b018);
    uVar6 = PackedFloatingMUL(uVar6,CONCAT44((int)DAT_0047b018,(int)uVar7));
    uVar6 = PackedFloatingADD(uVar6,DAT_0047b018 >> 0x20);
    PackedFloatingMUL(uVar6,CONCAT44((int)uVar3,(int)DAT_0047b018));
  }
  return CONCAT44(uVar2,uVar1);
}



/* math_sin_packed @ 004608c0 */

/* packed sin approximation; input in MM0 */

ulonglong math_sin_packed(void)

{
  uint uVar1;
  uint uVar2;
  ulonglong in_MM0;
  undefined8 uVar3;
  ulonglong uVar4;
  undefined4 uVar5;
  undefined8 uVar6;
  undefined8 uVar7;
  undefined8 uVar8;
  undefined8 uVar9;
  
  uVar1 = (uint)in_MM0;
  uVar2 = uVar1 >> 0x1f;
  uVar1 = uVar1 ^ uVar1 & 0x80000000;
  if ((int)uVar1 < DAT_0047b154) {
    uVar3 = PackedFloatingMUL(in_MM0 & DAT_0047b09c,(ulonglong)DAT_0047b150);
    uVar4 = PackedFloatingToIntDwordConv(uVar3,uVar3);
    uVar3 = PackedIntToFloatingDwordConv(uVar4,uVar4);
    uVar3 = PackedFloatingMUL(CONCAT44((int)uVar3,(int)uVar3),DAT_0047b060);
    uVar6 = PackedFloatingADD(in_MM0 & DAT_0047b09c,uVar3);
    uVar5 = (undefined4)((ulonglong)uVar3 >> 0x20);
    uVar3 = PackedFloatingADD(uVar6,CONCAT44(uVar5,uVar5));
    uVar3 = CONCAT44((int)uVar3,(int)uVar3);
    if ((uVar4 & 1) != 0) {
      uVar3 = PackedFloatingSUBR(uVar3,DAT_0047b070);
    }
    uVar2 = (uVar2 ^ (uint)uVar4 >> 2) << 0x1f;
    uVar6 = PackedFloatingMUL(uVar3,uVar3);
    uVar8 = PackedFloatingMUL(DAT_0047b068,uVar6);
    uVar7 = PackedFloatingMUL(DAT_0047b078,uVar6);
    uVar9 = PackedFloatingADD(uVar8,DAT_0047b018);
    uVar8 = PackedFloatingMUL(DAT_0047b080,uVar6);
    uVar7 = PackedFloatingMUL(uVar9,uVar7);
    uVar9 = PackedFloatingADD(uVar7,DAT_0047b018);
    uVar7 = PackedFloatingMUL(DAT_0047b088,uVar6);
    uVar6 = PackedFloatingMUL(uVar8,uVar9);
    uVar6 = PackedFloatingADD(uVar6,DAT_0047b018);
    uVar6 = PackedFloatingMUL(uVar6,CONCAT44((int)DAT_0047b018,(int)uVar7));
    uVar6 = PackedFloatingADD(uVar6,DAT_0047b018 >> 0x20);
    PackedFloatingMUL(uVar6,CONCAT44((int)uVar3,(int)DAT_0047b018));
  }
  return CONCAT44(uVar2,uVar1);
}



/* FUN_00460cb8 @ 00460cb8 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_460cb8() */

int FUN_00460cb8(void)

{
  int iVar1;
  void *extraout_ECX;
  
  FUN_00460cd0();
  _DAT_004d9964 = FUN_00463737();
  iVar1 = FUN_004636e7(extraout_ECX);
  return iVar1;
}



/* FUN_00460ccf @ 00460ccf */

void FUN_00460ccf(void)

{
  return;
}



/* FUN_00460cd0 @ 00460cd0 */

void FUN_00460cd0(void)

{
  PTR_FUN_0047b1ac = &LAB_004637ba;
  PTR_FUN_0047b1a8 = __cfltcvt;
  PTR_FUN_0047b1b0 = __fassign;
  PTR_FUN_0047b1b4 = FUN_00463760;
  PTR_FUN_0047b1b8 = &LAB_00463808;
  PTR_FUN_0047b1bc = __cfltcvt;
  return;
}



/* crt_onexit @ 00460d08 */

/* registers an onexit/atexit callback */

void * __cdecl crt_onexit(void *func)

{
  size_t sVar1;
  void *pvVar2;
  
  crt_exit_lock();
  sVar1 = crt_msize(crt_onexit_table_end);
  if (sVar1 < (uint)((int)crt_onexit_table_begin + (4 - (int)crt_onexit_table_end))) {
    sVar1 = crt_msize(crt_onexit_table_end);
    pvVar2 = crt_realloc(crt_onexit_table_end,sVar1 + 0x10);
    if (pvVar2 == (void *)0x0) {
      func = (void *)0x0;
      goto LAB_00460d7d;
    }
    crt_onexit_table_begin =
         (undefined4 *)
         ((int)pvVar2 + ((int)crt_onexit_table_begin - (int)crt_onexit_table_end >> 2) * 4);
    crt_onexit_table_end = pvVar2;
  }
  *crt_onexit_table_begin = func;
  crt_onexit_table_begin = crt_onexit_table_begin + 1;
LAB_00460d7d:
  crt_exit_unlock();
  return func;
}



/* crt_atexit @ 00460d86 */

/* atexit wrapper (returns 0/-1) */

int __cdecl crt_atexit(void *func)

{
  void *pvVar1;
  
  pvVar1 = crt_onexit(func);
  return (pvVar1 != (void *)0x0) - 1;
}



/* crt_free @ 00460dc7 */

/* CRT free wrapper */

void __cdecl crt_free(void *ptr)

{
  crt_free_base(ptr);
  return;
}



/* FUN_00460dd2 @ 00460dd2 */

int __thiscall FUN_00460dd2(void *this,byte *param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint c;
  byte *pbVar4;
  undefined *puVar5;
  
  while( true ) {
    if (DAT_0047b3cc < 2) {
      uVar1 = (byte)crt_ctype_table[(uint)*param_1 * 2] & 8;
      this = crt_ctype_table;
    }
    else {
      puVar5 = (undefined *)0x8;
      uVar1 = crt_isctype(this,(uint)*param_1,8);
      this = puVar5;
    }
    if (uVar1 == 0) break;
    param_1 = param_1 + 1;
  }
  uVar1 = (uint)*param_1;
  pbVar4 = param_1 + 1;
  if ((uVar1 == 0x2d) || (c = uVar1, uVar1 == 0x2b)) {
    c = (uint)*pbVar4;
    pbVar4 = param_1 + 2;
  }
  iVar3 = 0;
  while( true ) {
    if (DAT_0047b3cc < 2) {
      uVar2 = (byte)crt_ctype_table[c * 2] & 4;
    }
    else {
      puVar5 = (undefined *)0x4;
      uVar2 = crt_isctype(this,c,4);
      this = puVar5;
    }
    if (uVar2 == 0) break;
    iVar3 = (c - 0x30) + iVar3 * 10;
    c = (uint)*pbVar4;
    pbVar4 = pbVar4 + 1;
  }
  if (uVar1 == 0x2d) {
    iVar3 = -iVar3;
  }
  return iVar3;
}



/* crt_fclose @ 00460e5d */

/* fclose wrapper with CRT lock/unlock */

int __cdecl crt_fclose(FILE *fp)

{
  int iVar1;
  
  iVar1 = -1;
  if ((fp->_flag & 0x40) == 0) {
    crt_lock_file(fp);
    iVar1 = __fclose_lk(fp);
    crt_unlock_file(fp);
  }
  else {
    fp->_flag = 0;
  }
  return iVar1;
}



/* __fclose_lk @ 00460e8e */

/* Library Function - Single Match
    __fclose_lk
   
   Library: Visual Studio 2003 Release */

int __cdecl __fclose_lk(FILE *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar2 = -1;
  if ((param_1->_flag & 0x83) != 0) {
    iVar2 = crt_flushbuf(param_1);
    __freebuf(param_1);
    iVar1 = crt_close(param_1->_file);
    if (iVar1 < 0) {
      iVar2 = -1;
    }
    else if (param_1->_tmpfname != (char *)0x0) {
      crt_free_base(param_1->_tmpfname);
      param_1->_tmpfname = (char *)0x0;
    }
  }
  param_1->_flag = 0;
  return iVar2;
}



/* _strchr @ 00460ef0 */

/* Library Function - Single Match
    _strchr
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

char * __cdecl _strchr(char *_Str,int _Val)

{
  uint uVar1;
  char cVar2;
  uint uVar3;
  uint uVar4;
  uint *puVar5;
  
  while (((uint)_Str & 3) != 0) {
    uVar1 = *(uint *)_Str;
    if ((char)uVar1 == (char)_Val) {
      return (char *)(uint *)_Str;
    }
    _Str = (char *)((int)_Str + 1);
    if ((char)uVar1 == '\0') {
      return (char *)0x0;
    }
  }
  while( true ) {
    while( true ) {
      uVar1 = *(uint *)_Str;
      uVar4 = uVar1 ^ CONCAT22(CONCAT11((char)_Val,(char)_Val),CONCAT11((char)_Val,(char)_Val));
      uVar3 = uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff;
      puVar5 = (uint *)((int)_Str + 4);
      if (((uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff) & 0x81010100) != 0) break;
      _Str = (char *)puVar5;
      if ((uVar3 & 0x81010100) != 0) {
        if ((uVar3 & 0x1010100) != 0) {
          return (char *)0x0;
        }
        if ((uVar1 + 0x7efefeff & 0x80000000) == 0) {
          return (char *)0x0;
        }
      }
    }
    uVar1 = *(uint *)_Str;
    if ((char)uVar1 == (char)_Val) {
      return (char *)(uint *)_Str;
    }
    if ((char)uVar1 == '\0') {
      return (char *)0x0;
    }
    cVar2 = (char)(uVar1 >> 8);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 1);
    }
    if (cVar2 == '\0') {
      return (char *)0x0;
    }
    cVar2 = (char)(uVar1 >> 0x10);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 2);
    }
    if (cVar2 == '\0') break;
    cVar2 = (char)(uVar1 >> 0x18);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 3);
    }
    _Str = (char *)puVar5;
    if (cVar2 == '\0') {
      return (char *)0x0;
    }
  }
  return (char *)0x0;
}



/* crt_fgets @ 00460fac */

/* CRT fgets wrapper with file lock/unlock (reads until newline or size-1) */

char * __cdecl crt_fgets(char *dst,int dst_len,FILE *fp)

{
  int *piVar1;
  uint uVar2;
  char *pcVar3;
  
  if (dst_len < 1) {
    dst = (char *)0x0;
  }
  else {
    crt_lock_file(fp);
    pcVar3 = dst;
    do {
      dst_len = dst_len + -1;
      if (dst_len == 0) break;
      piVar1 = &fp->_cnt;
      *piVar1 = *piVar1 + -1;
      if (*piVar1 < 0) {
        uVar2 = crt_filbuf(fp);
      }
      else {
        uVar2 = (uint)(byte)*fp->_ptr;
        fp->_ptr = fp->_ptr + 1;
      }
      if (uVar2 == 0xffffffff) {
        if (pcVar3 == dst) {
          dst = (char *)0x0;
          goto LAB_00461000;
        }
        break;
      }
      *pcVar3 = (char)uVar2;
      pcVar3 = pcVar3 + 1;
    } while ((char)uVar2 != '\n');
    *pcVar3 = '\0';
LAB_00461000:
    crt_unlock_file(fp);
  }
  return dst;
}



/* crt_fsopen @ 0046100e */

/* opens file with explicit share mode (fopen uses share=0x40) */

FILE * __cdecl crt_fsopen(char *path,char *mode,uint share)

{
  FILE *stream;
  FILE *pFVar1;
  
  stream = crt_getstream();
  if (stream == (FILE *)0x0) {
    return (FILE *)0x0;
  }
  pFVar1 = crt_openfile(path,mode,share,stream);
  crt_unlock_file(stream);
  return pFVar1;
}



/* crt_fopen @ 0046103f */

/* fopen wrapper (calls crt_fsopen with share=0x40) */

FILE * __cdecl crt_fopen(char *path,char *mode)

{
  FILE *pFVar1;
  
  pFVar1 = crt_fsopen(path,mode,0x40);
  return pFVar1;
}



/* __ftol @ 00461054 */

/* Library Function - Single Match
    __ftol
   
   Library: Visual Studio */

longlong __ftol(void)

{
  float10 in_ST0;
  
  return (longlong)ROUND(in_ST0);
}



/* operator_new @ 0046107b */

/* Library Function - Single Match
    void * __cdecl operator new(unsigned int)
   
   Library: Visual Studio 2003 Release */

void * __cdecl operator_new(uint param_1)

{
  void *pvVar1;
  
  pvVar1 = __nh_malloc(param_1,1);
  return pvVar1;
}



/* crt_vsprintf @ 00461089 */

/* CRT: format string to buffer */

int __cdecl crt_vsprintf(char *dst,char *fmt,void *args)

{
  int iVar1;
  FILE local_24;
  
  local_24._base = dst;
  local_24._ptr = dst;
  local_24._flag = 0x42;
  local_24._cnt = 0x7fffffff;
  iVar1 = crt_output(&local_24,fmt,args);
  local_24._cnt = local_24._cnt + -1;
  if (local_24._cnt < 0) {
    crt_flsbuf(0,&local_24);
  }
  else {
    *local_24._ptr = '\0';
  }
  return iVar1;
}



/* crt_atof_l @ 004610da */

/* CRT: parse string to double (atof-style, locale) */

double __thiscall crt_atof_l(void *this,void *locale,char *str)

{
  uint uVar1;
  int iVar2;
  byte *this_00;
  undefined *puVar3;
  uint local_1c [6];
  
  while( true ) {
    if (DAT_0047b3cc < 2) {
      uVar1 = (byte)crt_ctype_table[(uint)*(byte *)locale * 2] & 8;
      this = crt_ctype_table;
    }
    else {
      puVar3 = (undefined *)0x8;
      uVar1 = crt_isctype(this,(uint)*(byte *)locale,8);
      this = puVar3;
    }
    if (uVar1 == 0) break;
    locale = (void *)((int)locale + 1);
  }
  this_00 = locale;
  _strlen(locale);
  iVar2 = FUN_00464be7(this_00,local_1c,locale);
  return *(double *)(iVar2 + 0x10);
}



/* crt_ci_pow @ 00461140 */

/* x87 helper for pow(base, exp) using ST0/ST1 */

void crt_ci_pow(void)

{
  float10 in_ST0;
  float10 in_ST1;
  
  FUN_00461162(SUB84((double)in_ST1,0),(uint)((ulonglong)(double)in_ST1 >> 0x20),
               SUB84((double)in_ST0,0),(uint)((ulonglong)(double)in_ST0 >> 0x20));
  return;
}



/* FUN_00461335 @ 00461335 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00461335(void)

{
  float10 in_ST0;
  
  if (ROUND(in_ST0) == in_ST0) {
    return;
  }
  return;
}



/* crt_strtok @ 0046135d */

/* CRT: tokenize string, uses TLS for state */

char * __cdecl crt_strtok(char *str,char *delim)

{
  byte bVar1;
  DWORD *pDVar2;
  int iVar3;
  byte *pbVar4;
  byte local_24 [32];
  
  pDVar2 = crt_get_thread_data();
  pbVar4 = local_24;
  for (iVar3 = 8; iVar3 != 0; iVar3 = iVar3 + -1) {
    pbVar4[0] = 0;
    pbVar4[1] = 0;
    pbVar4[2] = 0;
    pbVar4[3] = 0;
    pbVar4 = pbVar4 + 4;
  }
  do {
    bVar1 = *delim;
    local_24[bVar1 >> 3] = local_24[bVar1 >> 3] | '\x01' << (bVar1 & 7);
    delim = (char *)((byte *)delim + 1);
  } while (bVar1 != 0);
  if (str == (char *)0x0) {
    str = (char *)pDVar2[6];
  }
  for (; (bVar1 = *str, pbVar4 = (byte *)str, (local_24[bVar1 >> 3] & (byte)(1 << (bVar1 & 7))) != 0
         && (bVar1 != 0)); str = (char *)((byte *)str + 1)) {
  }
  do {
    bVar1 = *pbVar4;
    if (bVar1 == 0) {
LAB_004613ec:
      pDVar2[6] = (DWORD)pbVar4;
      return (char *)(-(uint)((byte *)str != pbVar4) & (uint)str);
    }
    if ((local_24[bVar1 >> 3] & (byte)(1 << (bVar1 & 7))) != 0) {
      *pbVar4 = 0;
      pbVar4 = pbVar4 + 1;
      goto LAB_004613ec;
    }
    pbVar4 = pbVar4 + 1;
  } while( true );
}



/* _strncmp @ 00461410 */

/* Library Function - Single Match
    _strncmp
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

int __cdecl _strncmp(char *_Str1,char *_Str2,size_t _MaxCount)

{
  char cVar1;
  char cVar2;
  size_t sVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  char *pcVar7;
  
  uVar5 = 0;
  sVar3 = _MaxCount;
  pcVar6 = _Str1;
  if (_MaxCount != 0) {
    do {
      if (sVar3 == 0) break;
      sVar3 = sVar3 - 1;
      cVar1 = *pcVar6;
      pcVar6 = pcVar6 + 1;
    } while (cVar1 != '\0');
    iVar4 = _MaxCount - sVar3;
    do {
      pcVar6 = _Str2;
      pcVar7 = _Str1;
      if (iVar4 == 0) break;
      iVar4 = iVar4 + -1;
      pcVar7 = _Str1 + 1;
      pcVar6 = _Str2 + 1;
      cVar2 = *_Str1;
      cVar1 = *_Str2;
      _Str2 = pcVar6;
      _Str1 = pcVar7;
    } while (cVar1 == cVar2);
    uVar5 = 0;
    if ((byte)pcVar6[-1] <= (byte)pcVar7[-1]) {
      if (pcVar6[-1] == pcVar7[-1]) {
        return 0;
      }
      uVar5 = 0xfffffffe;
    }
    uVar5 = ~uVar5;
  }
  return uVar5;
}



/* crt_fflush @ 00461448 */

/* CRT: fflush wrapper (NULL flushes all) */

int __cdecl crt_fflush(FILE *fp)

{
  int iVar1;
  
  if (fp == (FILE *)0x0) {
    iVar1 = crt_flushall(0);
    return iVar1;
  }
  crt_lock_file(fp);
  iVar1 = crt_fflush_nolock(fp);
  crt_unlock_file(fp);
  return iVar1;
}



/* crt_fflush_nolock @ 00461477 */

/* CRT: fflush without lock */

int __cdecl crt_fflush_nolock(FILE *fp)

{
  int iVar1;
  
  iVar1 = crt_flushbuf(fp);
  if (iVar1 != 0) {
    return -1;
  }
  if ((fp->_flag & 0x4000) != 0) {
    iVar1 = crt_commit(fp->_file);
    return -(uint)(iVar1 != 0);
  }
  return 0;
}



/* crt_flushbuf @ 004614a5 */

/* CRT: flush write buffer */

int __cdecl crt_flushbuf(FILE *fp)

{
  uint uVar1;
  int iVar2;
  uint count;
  
  iVar2 = 0;
  if ((((byte)fp->_flag & 3) == 2) && ((fp->_flag & 0x108U) != 0)) {
    count = (int)fp->_ptr - (int)fp->_base;
    if (0 < (int)count) {
      uVar1 = crt_write(fp->_file,fp->_base,count);
      if (uVar1 == count) {
        if ((fp->_flag & 0x80U) != 0) {
          fp->_flag = fp->_flag & 0xfffffffd;
        }
      }
      else {
        fp->_flag = fp->_flag | 0x20;
        iVar2 = -1;
      }
    }
  }
  fp->_cnt = 0;
  fp->_ptr = fp->_base;
  return iVar2;
}



/* crt_flushall @ 0046150a */

/* CRT: flush all streams (mode 0/1) */

int __cdecl crt_flushall(int mode)

{
  FILE *pFVar1;
  int iVar2;
  int iVar3;
  int stream_index;
  int iVar4;
  
  iVar3 = 0;
  iVar4 = 0;
  crt_lock(2);
  stream_index = 0;
  if (0 < DAT_004db4e0) {
    do {
      pFVar1 = *(FILE **)(DAT_004da4c4 + stream_index * 4);
      if ((pFVar1 != (FILE *)0x0) && ((pFVar1->_flag & 0x83) != 0)) {
        crt_lock_file2(stream_index,pFVar1);
        pFVar1 = *(FILE **)(DAT_004da4c4 + stream_index * 4);
        if ((pFVar1->_flag & 0x83U) != 0) {
          if (mode == 1) {
            iVar2 = crt_fflush_nolock(pFVar1);
            if (iVar2 != -1) {
              iVar3 = iVar3 + 1;
            }
          }
          else if ((mode == 0) && ((pFVar1->_flag & 2U) != 0)) {
            iVar2 = crt_fflush_nolock(pFVar1);
            if (iVar2 == -1) {
              iVar4 = -1;
            }
          }
        }
        crt_unlock_file2(stream_index,*(FILE **)(DAT_004da4c4 + stream_index * 4));
      }
      stream_index = stream_index + 1;
    } while (stream_index < DAT_004db4e0);
  }
  crt_unlock(2);
  if (mode != 1) {
    iVar3 = iVar4;
  }
  return iVar3;
}



/* crt_fwrite @ 004615ae */

/* fwrite wrapper with CRT lock/unlock */

uint __cdecl crt_fwrite(void *ptr,uint size,uint count,FILE *fp)

{
  uint uVar1;
  
  crt_lock_file(fp);
  uVar1 = crt_fwrite_nolock(ptr,size,count,fp);
  crt_unlock_file(fp);
  return uVar1;
}



/* crt_fwrite_nolock @ 004615dd */

/* fwrite implementation (no locking) */

uint __cdecl crt_fwrite_nolock(void *ptr,uint size,uint count,FILE *fp)

{
  FILE *fp_00;
  int iVar1;
  FILE *size_00;
  uint uVar2;
  FILE *pFVar3;
  FILE *pFVar4;
  FILE *pFVar5;
  
  fp_00 = fp;
  pFVar4 = (FILE *)(size * count);
  if (pFVar4 == (FILE *)0x0) {
    count = 0;
  }
  else {
    pFVar3 = pFVar4;
    if ((fp->_flag & 0x10c) == 0) {
      fp = (FILE *)0x1000;
    }
    else {
      fp = (FILE *)fp->_bufsiz;
    }
    do {
      uVar2 = fp_00->_flag & 0x108;
      if ((uVar2 == 0) || (pFVar5 = (FILE *)fp_00->_cnt, pFVar5 == (FILE *)0x0)) {
        if (fp <= pFVar3) {
          if ((uVar2 != 0) && (iVar1 = crt_flushbuf(fp_00), iVar1 != 0)) {
LAB_004616de:
            return (uint)((int)pFVar4 - (int)pFVar3) / size;
          }
          pFVar5 = pFVar3;
          if (fp != (FILE *)0x0) {
            pFVar5 = (FILE *)((int)pFVar3 - (uint)pFVar3 % (uint)fp);
          }
          size_00 = (FILE *)crt_write(fp_00->_file,ptr,(uint)pFVar5);
          if ((size_00 == (FILE *)0xffffffff) ||
             (pFVar3 = (FILE *)((int)pFVar3 - (int)size_00), size_00 < pFVar5)) {
            fp_00->_flag = fp_00->_flag | 0x20;
            goto LAB_004616de;
          }
          goto LAB_00461695;
        }
        iVar1 = crt_flsbuf((int)*(char *)ptr,fp_00);
        if (iVar1 == -1) goto LAB_004616de;
        ptr = (void *)((int)ptr + 1);
        fp = (FILE *)fp_00->_bufsiz;
        pFVar3 = (FILE *)((int)&pFVar3[-1]._tmpfname + 3);
        if ((int)fp < 1) {
          fp = (FILE *)0x1;
        }
      }
      else {
        size_00 = pFVar3;
        if (pFVar5 <= pFVar3) {
          size_00 = pFVar5;
        }
        crt_bufcpy(fp_00->_ptr,ptr,(size_t)size_00);
        fp_00->_cnt = fp_00->_cnt - (int)size_00;
        fp_00->_ptr = (char *)((int)&size_00->_ptr + (int)fp_00->_ptr);
        pFVar3 = (FILE *)((int)pFVar3 - (int)size_00);
LAB_00461695:
        ptr = (void *)((int)ptr + (int)size_00);
      }
    } while (pFVar3 != (FILE *)0x0);
  }
  return count;
}



/* crt_sprintf @ 004616e7 */

/* sprintf-style formatter (uses CRT output core) */

int __cdecl crt_sprintf(char *dst,char *fmt,...)

{
  int iVar1;
  FILE local_24;
  
  local_24._base = dst;
  local_24._ptr = dst;
  local_24._flag = 0x42;
  local_24._cnt = 0x7fffffff;
  iVar1 = crt_output(&local_24,fmt,&stack0x0000000c);
  local_24._cnt = local_24._cnt + -1;
  if (local_24._cnt < 0) {
    crt_flsbuf(0,&local_24);
  }
  else {
    *local_24._ptr = '\0';
  }
  return iVar1;
}



/* crt_srand @ 00461739 */

/* sets the per-thread RNG seed (srand) */

void __cdecl crt_srand(uint seed)

{
  DWORD *pDVar1;
  
  pDVar1 = crt_get_thread_data();
  pDVar1[5] = seed;
  return;
}



/* crt_rand @ 00461746 */

/* returns a pseudo-random value using the per-thread seed (rand) */

int __cdecl crt_rand(void)

{
  DWORD *pDVar1;
  uint uVar2;
  
  pDVar1 = crt_get_thread_data();
  uVar2 = pDVar1[5] * 0x343fd + 0x269ec3;
  pDVar1[5] = uVar2;
  return uVar2 >> 0x10 & 0x7fff;
}



/* crt_findfirst @ 00461768 */

/* CRT _findfirst wrapper over FindFirstFileA */

HANDLE __cdecl crt_findfirst(char *pattern,uint *finddata)

{
  HANDLE pvVar1;
  DWORD DVar2;
  int *piVar3;
  uint uVar4;
  _WIN32_FIND_DATAA local_144;
  
  pvVar1 = FindFirstFileA(pattern,&local_144);
  if (pvVar1 != (HANDLE)0xffffffff) {
    *finddata = -(uint)(local_144.dwFileAttributes != 0x80) & local_144.dwFileAttributes;
    uVar4 = ___timet_from_ft((FILETIME *)&local_144.ftCreationTime);
    finddata[1] = uVar4;
    uVar4 = ___timet_from_ft((FILETIME *)&local_144.ftLastAccessTime);
    finddata[2] = uVar4;
    uVar4 = ___timet_from_ft((FILETIME *)&local_144.ftLastWriteTime);
    finddata[3] = uVar4;
    finddata[4] = local_144.nFileSizeLow;
    crt_strcpy((char *)(finddata + 5),local_144.cFileName);
    return pvVar1;
  }
  DVar2 = GetLastError();
  if (DVar2 < 2) {
LAB_004617a6:
    piVar3 = crt_errno_ptr();
    *piVar3 = 0x16;
  }
  else {
    if (3 < DVar2) {
      if (DVar2 == 8) {
        piVar3 = crt_errno_ptr();
        *piVar3 = 0xc;
        return (HANDLE)0xffffffff;
      }
      if (DVar2 != 0x12) goto LAB_004617a6;
    }
    piVar3 = crt_errno_ptr();
    *piVar3 = 2;
  }
  return (HANDLE)0xffffffff;
}



/* crt_findnext @ 00461835 */

/* CRT _findnext wrapper over FindNextFileA (returns 0/-1) */

int __cdecl crt_findnext(HANDLE handle,uint *finddata)

{
  WINBOOL WVar1;
  DWORD DVar2;
  int *piVar3;
  uint uVar4;
  _WIN32_FIND_DATAA local_144;
  
  WVar1 = FindNextFileA(handle,&local_144);
  if (WVar1 != 0) {
    *finddata = -(uint)(local_144.dwFileAttributes != 0x80) & local_144.dwFileAttributes;
    uVar4 = ___timet_from_ft((FILETIME *)&local_144.ftCreationTime);
    finddata[1] = uVar4;
    uVar4 = ___timet_from_ft((FILETIME *)&local_144.ftLastAccessTime);
    finddata[2] = uVar4;
    uVar4 = ___timet_from_ft((FILETIME *)&local_144.ftLastWriteTime);
    finddata[3] = uVar4;
    finddata[4] = local_144.nFileSizeLow;
    crt_strcpy((char *)(finddata + 5),local_144.cFileName);
    return 0;
  }
  DVar2 = GetLastError();
  if (DVar2 < 2) {
LAB_0046186f:
    piVar3 = crt_errno_ptr();
    *piVar3 = 0x16;
  }
  else {
    if (3 < DVar2) {
      if (DVar2 == 8) {
        piVar3 = crt_errno_ptr();
        *piVar3 = 0xc;
        return -1;
      }
      if (DVar2 != 0x12) goto LAB_0046186f;
    }
    piVar3 = crt_errno_ptr();
    *piVar3 = 2;
  }
  return -1;
}



/* crt_findclose @ 004618fd */

/* CRT _findclose wrapper over FindClose */

int __cdecl crt_findclose(HANDLE handle)

{
  WINBOOL WVar1;
  int *piVar2;
  
  WVar1 = FindClose(handle);
  if (WVar1 == 0) {
    piVar2 = crt_errno_ptr();
    *piVar2 = 0x16;
    return -1;
  }
  return 0;
}



/* ___timet_from_ft @ 0046191d */

/* Library Function - Single Match
    ___timet_from_ft
   
   Library: Visual Studio 2003 Release */

int __cdecl ___timet_from_ft(FILETIME *param_1)

{
  WINBOOL WVar1;
  long lVar2;
  _SYSTEMTIME local_1c;
  _FILETIME local_c;
  
  if ((param_1->dwLowDateTime != 0) || (param_1->dwHighDateTime != 0)) {
    WVar1 = FileTimeToLocalFileTime((FILETIME *)param_1,&local_c);
    if (WVar1 != 0) {
      WVar1 = FileTimeToSystemTime(&local_c,&local_1c);
      if (WVar1 != 0) {
        lVar2 = crt_mktime((uint)local_1c.wYear,(uint)local_1c.wMonth,(uint)local_1c.wDay,
                           (uint)local_1c.wHour,(uint)local_1c.wMinute,(uint)local_1c.wSecond,-1);
        return lVar2;
      }
    }
  }
  return -1;
}



/* crt_ehvec_ctor @ 00461981 */

/* MSVC __ehvec_ctor: constructs an array; uses dtor to unwind on exception */

void crt_ehvec_ctor(void *ptr,uint size,int count,void *ctor,void *dtor)

{
  int local_20;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0046f9e0;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  local_8 = 0;
  ExceptionList = &local_14;
  for (local_20 = 0; local_20 < count; local_20 = local_20 + 1) {
    (*ctor)();
  }
  local_8 = 0xffffffff;
  FUN_004619eb();
  ExceptionList = local_14;
  return;
}



/* FUN_004619eb @ 004619eb */

void FUN_004619eb(void)

{
  int unaff_EBP;
  
  if (*(int *)(unaff_EBP + -0x20) == 0) {
    crt_array_unwind(*(void **)(unaff_EBP + 8),*(uint *)(unaff_EBP + 0xc),
                     *(int *)(unaff_EBP + -0x1c),*(void **)(unaff_EBP + 0x18));
  }
  return;
}



/* crt_ehvec_dtor @ 00461a03 */

/* MSVC __ehvec_dtor: destroys an array with exception handling */

void crt_ehvec_dtor(void *ptr,uint size,int count,void *dtor)

{
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0046f9f0;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  local_8 = 0;
  ExceptionList = &local_14;
  while( true ) {
    count = count + -1;
    if (count < 0) break;
    (*dtor)();
  }
  local_8 = 0xffffffff;
  FUN_00461a6b();
  ExceptionList = local_14;
  return;
}



/* FUN_00461a6b @ 00461a6b */

void FUN_00461a6b(void)

{
  int unaff_EBP;
  
  if (*(int *)(unaff_EBP + -0x1c) == 0) {
    crt_array_unwind(*(void **)(unaff_EBP + 8),*(uint *)(unaff_EBP + 0xc),*(int *)(unaff_EBP + 0x10)
                     ,*(void **)(unaff_EBP + 0x14));
  }
  return;
}



/* crt_array_unwind @ 00461a83 */

/* destructor loop used for array unwinding (backward walk) */

void crt_array_unwind(void *ptr,uint size,int count,void *dtor)

{
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0046fa00;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  local_8 = 0;
  ExceptionList = &local_14;
  while( true ) {
    count = count + -1;
    if (count < 0) break;
    (*dtor)();
  }
  ExceptionList = local_14;
  return;
}



/* crt_fread @ 00461af7 */

/* fread wrapper with CRT lock/unlock */

uint __cdecl crt_fread(void *ptr,uint size,uint count,FILE *fp)

{
  uint uVar1;
  
  crt_lock_file(fp);
  uVar1 = crt_fread_nolock(ptr,size,count,fp);
  crt_unlock_file(fp);
  return uVar1;
}



/* crt_fread_nolock @ 00461b26 */

/* fread implementation (no locking) */

uint __cdecl crt_fread_nolock(void *ptr,uint size,uint count,FILE *fp)

{
  FILE *fp_00;
  void *pvVar1;
  int iVar2;
  char *pcVar3;
  void *pvVar4;
  void *size_00;
  
  fp_00 = fp;
  pvVar4 = (void *)(size * count);
  if (pvVar4 == (void *)0x0) {
    count = 0;
  }
  else {
    pcVar3 = ptr;
    ptr = pvVar4;
    if ((fp->_flag & 0x10c) == 0) {
      fp = (FILE *)0x1000;
    }
    else {
      fp = (FILE *)fp->_bufsiz;
    }
    do {
      if (((fp_00->_flag & 0x10c) == 0) || (pvVar1 = (void *)fp_00->_cnt, pvVar1 == (void *)0x0)) {
        if (ptr < fp) {
          iVar2 = crt_filbuf(fp_00);
          if (iVar2 == -1) goto LAB_00461c02;
          *pcVar3 = (char)iVar2;
          fp = (FILE *)fp_00->_bufsiz;
          pcVar3 = pcVar3 + 1;
          ptr = (void *)((int)ptr + -1);
        }
        else {
          pvVar1 = ptr;
          if (fp != (FILE *)0x0) {
            pvVar1 = (void *)((int)ptr - (uint)ptr % (uint)fp);
          }
          iVar2 = crt_read(fp_00->_file,pcVar3,(uint)pvVar1);
          if (iVar2 == 0) {
            fp_00->_flag = fp_00->_flag | 0x10;
LAB_00461c02:
            return (uint)((int)pvVar4 - (int)ptr) / size;
          }
          if (iVar2 == -1) {
            fp_00->_flag = fp_00->_flag | 0x20;
            goto LAB_00461c02;
          }
          ptr = (void *)((int)ptr - iVar2);
          pcVar3 = pcVar3 + iVar2;
        }
      }
      else {
        size_00 = ptr;
        if (pvVar1 <= ptr) {
          size_00 = pvVar1;
        }
        crt_bufcpy(pcVar3,fp_00->_ptr,(size_t)size_00);
        ptr = (void *)((int)ptr - (int)size_00);
        fp_00->_cnt = fp_00->_cnt - (int)size_00;
        fp_00->_ptr = fp_00->_ptr + (int)size_00;
        pcVar3 = pcVar3 + (int)size_00;
      }
    } while (ptr != (void *)0x0);
  }
  return count;
}



/* crt_ftell @ 00461c0e */

/* CRT: ftell with file lock */

long __cdecl crt_ftell(FILE *fp)

{
  long lVar1;
  
  crt_lock_file(fp);
  lVar1 = crt_ftell_nolock(fp);
  crt_unlock_file(fp);
  return lVar1;
}



/* crt_ftell_nolock @ 00461c30 */

/* CRT: ftell without lock */

long __cdecl crt_ftell_nolock(FILE *fp)

{
  uint fd;
  uint uVar1;
  byte bVar2;
  int *piVar3;
  FILE *pFVar4;
  long lVar5;
  char *pcVar6;
  FILE *pFVar7;
  char *pcVar8;
  char *pcVar9;
  int iVar10;
  int local_c;
  int local_8;
  
  pFVar7 = fp;
  fd = fp->_file;
  if (fp->_cnt < 0) {
    fp->_cnt = 0;
  }
  local_8 = crt_lseek(fd,0,1);
  if (local_8 < 0) {
LAB_00461cbe:
    local_c = -1;
  }
  else {
    uVar1 = fp->_flag;
    if ((uVar1 & 0x108) == 0) {
      return local_8 - fp->_cnt;
    }
    pcVar6 = fp->_ptr;
    pcVar9 = fp->_base;
    local_c = (int)pcVar6 - (int)pcVar9;
    if ((uVar1 & 3) == 0) {
      if ((uVar1 & 0x80) == 0) {
        piVar3 = crt_errno_ptr();
        *piVar3 = 0x16;
        goto LAB_00461cbe;
      }
    }
    else {
      pcVar8 = pcVar9;
      if ((*(byte *)((&DAT_004da3c0)[(int)fd >> 5] + 4 + (fd & 0x1f) * 0x24) & 0x80) != 0) {
        for (; pcVar8 < pcVar6; pcVar8 = pcVar8 + 1) {
          if (*pcVar8 == '\n') {
            local_c = local_c + 1;
          }
        }
      }
    }
    if (local_8 != 0) {
      if ((fp->_flag & 1) != 0) {
        if (fp->_cnt == 0) {
          local_c = 0;
        }
        else {
          pFVar4 = (FILE *)(pcVar6 + (fp->_cnt - (int)pcVar9));
          iVar10 = (fd & 0x1f) * 0x24;
          if ((*(byte *)(iVar10 + 4 + (&DAT_004da3c0)[(int)fd >> 5]) & 0x80) != 0) {
            lVar5 = crt_lseek(fd,0,2);
            if (lVar5 == local_8) {
              pcVar6 = fp->_base;
              pcVar9 = pcVar6 + (int)&pFVar4->_ptr;
              fp = pFVar4;
              for (; pcVar6 < pcVar9; pcVar6 = pcVar6 + 1) {
                if (*pcVar6 == '\n') {
                  fp = (FILE *)((int)&fp->_ptr + 1);
                }
              }
              bVar2 = *(byte *)((int)&pFVar7->_flag + 1) & 0x20;
            }
            else {
              crt_lseek(fd,local_8,0);
              pFVar7 = (FILE *)0x200;
              if ((((FILE *)0x200 < pFVar4) || ((fp->_flag & 8U) == 0)) ||
                 ((fp->_flag & 0x400U) != 0)) {
                pFVar7 = (FILE *)fp->_bufsiz;
              }
              bVar2 = *(byte *)(iVar10 + 4 + (&DAT_004da3c0)[(int)fd >> 5]) & 4;
              fp = pFVar7;
            }
            pFVar4 = fp;
            if (bVar2 != 0) {
              pFVar4 = (FILE *)((int)&fp->_ptr + 1);
            }
          }
          fp = pFVar4;
          local_8 = local_8 - (int)fp;
        }
      }
      local_c = local_c + local_8;
    }
  }
  return local_c;
}



/* crt_fseek @ 00461d91 */

/* fseek wrapper with CRT lock/unlock */

int __cdecl crt_fseek(FILE *fp,long offset,int origin)

{
  int iVar1;
  
  crt_lock_file(fp);
  iVar1 = crt_fseek_nolock(fp,offset,origin);
  crt_unlock_file(fp);
  return iVar1;
}



/* crt_fseek_nolock @ 00461dbd */

/* fseek implementation (uses crt_lseek) */

int __cdecl crt_fseek_nolock(FILE *fp,long offset,int origin)

{
  uint uVar1;
  long lVar2;
  int *piVar3;
  int iVar4;
  
  if (((fp->_flag & 0x83U) == 0) || (((origin != 0 && (origin != 1)) && (origin != 2)))) {
    piVar3 = crt_errno_ptr();
    *piVar3 = 0x16;
    iVar4 = -1;
  }
  else {
    fp->_flag = fp->_flag & 0xffffffef;
    if (origin == 1) {
      lVar2 = crt_ftell_nolock(fp);
      offset = offset + lVar2;
      origin = 0;
    }
    crt_flushbuf(fp);
    uVar1 = fp->_flag;
    if ((uVar1 & 0x80) == 0) {
      if ((((uVar1 & 1) != 0) && ((uVar1 & 8) != 0)) && ((uVar1 & 0x400) == 0)) {
        fp->_bufsiz = 0x200;
      }
    }
    else {
      fp->_flag = uVar1 & 0xfffffffc;
    }
    lVar2 = crt_lseek(fp->_file,offset,origin);
    iVar4 = (lVar2 != -1) - 1;
  }
  return iVar4;
}



/* crt_snprintf @ 00461e4a */

/* CRT: size-limited sprintf */

int __cdecl crt_snprintf(char *dst,int size,char *fmt,...)

{
  int iVar1;
  FILE local_24;
  
  local_24._base = dst;
  local_24._ptr = dst;
  local_24._flag = 0x42;
  local_24._cnt = size;
  iVar1 = crt_output(&local_24,fmt,&stack0x00000010);
  local_24._cnt = local_24._cnt + -1;
  if (local_24._cnt < 0) {
    crt_flsbuf(0,&local_24);
  }
  else {
    *local_24._ptr = '\0';
  }
  return iVar1;
}



/* crt_tolower @ 00461e9b */

/* CRT: tolower (current locale) */

int __cdecl crt_tolower(int c)

{
  void *extraout_ECX;
  int unaff_EDI;
  bool bVar1;
  void *this;
  
  if (DAT_004d9a4c == 0) {
    if ((0x40 < c) && (c < 0x5b)) {
      return c + 0x20;
    }
  }
  else {
    InterlockedIncrement((LONG *)&DAT_004da3b0);
    bVar1 = DAT_004da3ac != 0;
    this = extraout_ECX;
    if (bVar1) {
      InterlockedDecrement((LONG *)&DAT_004da3b0);
      this = (void *)0x13;
      crt_lock(0x13);
    }
    c = crt_tolower_l(this,(void *)c,unaff_EDI);
    if (bVar1) {
      crt_unlock(0x13);
    }
    else {
      InterlockedDecrement((LONG *)&DAT_004da3b0);
    }
  }
  return c;
}



/* crt_tolower_l @ 00461f0a */

/* CRT: tolower with locale */

int __thiscall crt_tolower_l(void *this,void *locale,int c)

{
  void *pvVar1;
  uint uVar2;
  int iVar3;
  void *local_8;
  
  pvVar1 = locale;
  if (DAT_004d9a4c == 0) {
    if ((0x40 < (int)locale) && ((int)locale < 0x5b)) {
      pvVar1 = (void *)((int)locale + 0x20);
    }
  }
  else {
    iVar3 = 1;
    local_8 = this;
    if ((int)locale < 0x100) {
      if (DAT_0047b3cc < 2) {
        uVar2 = (byte)crt_ctype_table[(int)locale * 2] & 1;
      }
      else {
        uVar2 = crt_isctype(this,(int)locale,1);
      }
      if (uVar2 == 0) {
        return (int)pvVar1;
      }
    }
    if ((crt_ctype_table[((int)pvVar1 >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      locale = (void *)(CONCAT31((int3)((uint)locale >> 8),(char)pvVar1) & 0xffff00ff);
    }
    else {
      uVar2 = (uint)locale >> 0x10;
      locale._0_2_ = CONCAT11((char)pvVar1,(char)((uint)pvVar1 >> 8));
      locale = (void *)(CONCAT22((short)uVar2,locale._0_2_) & 0xff00ffff);
      iVar3 = 2;
    }
    iVar3 = crt_lcmap_string(DAT_004d9a4c,0x100,(char *)&locale,iVar3,(ushort *)&local_8,3,0,1);
    if (iVar3 != 0) {
      if (iVar3 == 1) {
        pvVar1 = (void *)((uint)local_8 & 0xff);
      }
      else {
        pvVar1 = (void *)((uint)local_8 & 0xffff);
      }
    }
  }
  return (int)pvVar1;
}



/* FUN_00461fd5 @ 00461fd5 */

int __cdecl FUN_00461fd5(byte *param_1)

{
  int iVar1;
  int iVar2;
  
  crt_lock_file2(1,(FILE *)&DAT_0047b3f8);
  iVar1 = FUN_004666f5((int *)&DAT_0047b3f8);
  iVar2 = crt_output((FILE *)&DAT_0047b3f8,(char *)param_1,&stack0x00000008);
  FUN_00466782(iVar1,(int *)&DAT_0047b3f8);
  crt_unlock_file2(1,(FILE *)&DAT_0047b3f8);
  return iVar2;
}



/* __alldiv @ 00462020 */

/* Library Function - Single Match
    __alldiv
   
   Library: Visual Studio */

undefined8 __alldiv(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  bool bVar10;
  char cVar11;
  uint uVar9;
  
  cVar11 = (int)param_2 < 0;
  if ((bool)cVar11) {
    bVar10 = param_1 != 0;
    param_1 = -param_1;
    param_2 = -(uint)bVar10 - param_2;
  }
  if ((int)param_4 < 0) {
    cVar11 = cVar11 + '\x01';
    bVar10 = param_3 != 0;
    param_3 = -param_3;
    param_4 = -(uint)bVar10 - param_4;
  }
  uVar3 = param_1;
  uVar5 = param_3;
  uVar6 = param_2;
  uVar9 = param_4;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar8 = uVar9 >> 1;
      uVar5 = uVar5 >> 1 | (uint)((uVar9 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar6 = uVar7;
      uVar9 = uVar8;
    } while (uVar8 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar5;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar5 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar5)) ||
       ((param_2 <= uVar5 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  if (cVar11 == '\x01') {
    bVar10 = iVar4 != 0;
    iVar4 = -iVar4;
    uVar3 = -(uint)bVar10 - uVar3;
  }
  return CONCAT44(uVar3,iVar4);
}



/* __allmul @ 004620d0 */

/* Library Function - Single Match
    __allmul
   
   Library: Visual Studio */

longlong __allmul(uint param_1,int param_2,uint param_3,int param_4)

{
  if (param_4 == 0 && param_2 == 0) {
    return (ulonglong)param_1 * (ulonglong)param_3;
  }
  return CONCAT44((int)((ulonglong)param_1 * (ulonglong)param_3 >> 0x20) +
                  param_2 * param_3 + param_1 * param_4,
                  (int)((ulonglong)param_1 * (ulonglong)param_3));
}



/* crt_toupper @ 00462104 */

/* CRT: toupper (current locale) */

int __cdecl crt_toupper(int c)

{
  void *extraout_ECX;
  int unaff_EDI;
  bool bVar1;
  void *this;
  
  if (DAT_004d9a4c == 0) {
    if ((0x60 < c) && (c < 0x7b)) {
      return c + -0x20;
    }
  }
  else {
    InterlockedIncrement((LONG *)&DAT_004da3b0);
    bVar1 = DAT_004da3ac != 0;
    this = extraout_ECX;
    if (bVar1) {
      InterlockedDecrement((LONG *)&DAT_004da3b0);
      this = (void *)0x13;
      crt_lock(0x13);
    }
    c = crt_toupper_l(this,(void *)c,unaff_EDI);
    if (bVar1) {
      crt_unlock(0x13);
    }
    else {
      InterlockedDecrement((LONG *)&DAT_004da3b0);
    }
  }
  return c;
}



/* crt_toupper_l @ 00462173 */

/* CRT: toupper with locale */

int __thiscall crt_toupper_l(void *this,void *locale,int c)

{
  void *pvVar1;
  uint uVar2;
  int iVar3;
  void *local_8;
  
  pvVar1 = locale;
  if (DAT_004d9a4c == 0) {
    if ((0x60 < (int)locale) && ((int)locale < 0x7b)) {
      pvVar1 = (void *)((int)locale - 0x20);
    }
  }
  else {
    local_8 = this;
    if ((int)locale < 0x100) {
      if (DAT_0047b3cc < 2) {
        uVar2 = (byte)crt_ctype_table[(int)locale * 2] & 2;
      }
      else {
        uVar2 = crt_isctype(this,(int)locale,2);
      }
      if (uVar2 == 0) {
        return (int)pvVar1;
      }
    }
    if ((crt_ctype_table[((int)pvVar1 >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      locale = (void *)(CONCAT31((int3)((uint)locale >> 8),(char)pvVar1) & 0xffff00ff);
      iVar3 = 1;
    }
    else {
      uVar2 = (uint)locale >> 0x10;
      locale._0_2_ = CONCAT11((char)pvVar1,(char)((uint)pvVar1 >> 8));
      locale = (void *)(CONCAT22((short)uVar2,locale._0_2_) & 0xff00ffff);
      iVar3 = 2;
    }
    iVar3 = crt_lcmap_string(DAT_004d9a4c,0x200,(char *)&locale,iVar3,(ushort *)&local_8,3,0,1);
    if (iVar3 != 0) {
      if (iVar3 == 1) {
        pvVar1 = (void *)((uint)local_8 & 0xff);
      }
      else {
        pvVar1 = (void *)((uint)local_8 & 0xffff);
      }
    }
  }
  return (int)pvVar1;
}



/* crt_beginthread @ 0046223f */

/* CRT: beginthread (CreateThread wrapper) */

void * __cdecl crt_beginthread(void *start,uint stack_size,void *arg)

{
  void *lpThreadId;
  HANDLE hThread;
  DWORD DVar1;
  
  DVar1 = 0;
  lpThreadId = crt_calloc(1,0x74);
  if (lpThreadId != (void *)0x0) {
    crt_init_thread_data(lpThreadId);
    *(void **)((int)lpThreadId + 0x48) = start;
    *(void **)((int)lpThreadId + 0x4c) = arg;
    hThread = CreateThread((LPSECURITY_ATTRIBUTES)0x0,stack_size,crt_thread_entry,lpThreadId,4,
                           lpThreadId);
    *(HANDLE *)((int)lpThreadId + 4) = hThread;
    if ((hThread != (HANDLE)0x0) && (DVar1 = ResumeThread(hThread), DVar1 != 0xffffffff)) {
      return hThread;
    }
    DVar1 = GetLastError();
  }
  crt_free_base(lpThreadId);
  if (DVar1 != 0) {
    crt_dosmaperr(DVar1);
  }
  return (void *)0xffffffff;
}



/* crt_thread_entry @ 004622b6 */

/* CRT: thread start trampoline */

uint crt_thread_entry(void *thread_data)

{
  LPVOID pvVar1;
  WINBOOL WVar2;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0046fa10;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  pvVar1 = TlsGetValue(DAT_0047b6f0);
  if (pvVar1 != (LPVOID)0x0) {
    *(undefined4 *)((int)pvVar1 + 0x48) = *(undefined4 *)((int)thread_data + 0x48);
    *(undefined4 *)((int)pvVar1 + 0x4c) = *(undefined4 *)((int)thread_data + 0x4c);
    crt_free_thread_data(thread_data);
    thread_data = pvVar1;
  }
  WVar2 = TlsSetValue(DAT_0047b6f0,thread_data);
  if (WVar2 == 0) {
    __amsg_exit(0x10);
  }
  if (PTR_FUN_0047b164 != (undefined *)0x0) {
    (*(code *)PTR_FUN_0047b164)();
  }
  local_8 = 0;
  (**(code **)((int)thread_data + 0x48))(*(undefined4 *)((int)thread_data + 0x4c));
  crt_endthread();
  ExceptionList = local_14;
  return 0;
}



/* crt_endthread @ 00462373 */

/* CRT: thread cleanup and exit */

void crt_endthread(void)

{
  DWORD *pDVar1;
  
  if (PTR_FUN_0047b168 != (undefined *)0x0) {
    (*(code *)PTR_FUN_0047b168)();
  }
  pDVar1 = crt_get_thread_data();
  if (pDVar1 == (DWORD *)0x0) {
    __amsg_exit(0x10);
  }
  if ((HANDLE)pDVar1[1] != (HANDLE)0xffffffff) {
    CloseHandle((HANDLE)pDVar1[1]);
  }
  crt_free_thread_data((undefined *)pDVar1);
                    /* WARNING: Subroutine does not return */
  ExitThread(0);
}



/* FUN_004623b2 @ 004623b2 */

/* [binja] int32_t sub_4623b2(int32_t* arg1) */

int __cdecl FUN_004623b2(int *arg1)

{
  DWORD DVar1;
  long lVar2;
  _TIME_ZONE_INFORMATION local_d0;
  _SYSTEMTIME local_24;
  _SYSTEMTIME local_14;
  
  GetLocalTime(&local_14);
  GetSystemTime(&local_24);
  if (local_24.wMinute == DAT_004d9978._2_2_) {
    if (local_24.wHour == (WORD)DAT_004d9978) {
      if (local_24.wDay == DAT_004d9974._2_2_) {
        if (local_24.wMonth == DAT_004d9970._2_2_) {
          if (local_24.wYear == (WORD)DAT_004d9970) goto LAB_0046245c;
        }
      }
    }
  }
  DVar1 = GetTimeZoneInformation(&local_d0);
  if (DVar1 == 0xffffffff) {
    DAT_004d9968 = -1;
  }
  else if (((DVar1 == 2) && (local_d0.DaylightDate.wMonth != 0)) && (local_d0.DaylightBias != 0)) {
    DAT_004d9968 = 1;
  }
  else {
    DAT_004d9968 = 0;
  }
  DAT_004d9970._0_2_ = local_24.wYear;
  DAT_004d9970._2_2_ = local_24.wMonth;
  DAT_004d9974._0_2_ = local_24.wDayOfWeek;
  DAT_004d9974._2_2_ = local_24.wDay;
  DAT_004d9978._0_2_ = local_24.wHour;
  DAT_004d9978._2_2_ = local_24.wMinute;
  DAT_004d997c._0_2_ = local_24.wSecond;
  DAT_004d997c._2_2_ = local_24.wMilliseconds;
LAB_0046245c:
  lVar2 = crt_mktime((uint)local_14.wYear,(uint)local_14.wMonth,(uint)local_14.wDay,
                     (uint)local_14.wHour,(uint)local_14.wMinute,(uint)local_14.wSecond,DAT_004d9968
                    );
  if (arg1 != (int *)0x0) {
    *arg1 = lVar2;
  }
  return lVar2;
}



/* crt_getcwd @ 0046248e */

/* CRT: get current working directory */

char * __cdecl crt_getcwd(char *buf,uint size)

{
  char *pcVar1;
  
  crt_lock(0xc);
  pcVar1 = crt_getdcwd(0,buf,size);
  crt_unlock(0xc);
  return pcVar1;
}



/* crt_getdcwd @ 004624b5 */

/* CRT: get current working directory for drive */

char * __cdecl crt_getdcwd(int drive,char *buf,uint size)

{
  int iVar1;
  int iVar2;
  uint *puVar3;
  int *piVar4;
  DWORD DVar5;
  uint _Size;
  char *pcVar6;
  CHAR local_10c [260];
  LPSTR local_8;
  
  iVar1 = drive;
  if (drive == 0) {
    DVar5 = GetCurrentDirectoryA(0x104,local_10c);
  }
  else {
    iVar2 = FUN_0046258a(drive);
    if (iVar2 == 0) {
      puVar3 = crt_doserrno_ptr();
      *puVar3 = 0xf;
      piVar4 = crt_errno_ptr();
      *piVar4 = 0xd;
      return (char *)0x0;
    }
    drive = (int)CONCAT12(0x2e,CONCAT11(0x3a,(char)iVar1 + '@'));
    DVar5 = GetFullPathNameA((LPCSTR)&drive,0x104,local_10c,&local_8);
  }
  if ((DVar5 != 0) && (_Size = DVar5 + 1, _Size < 0x105)) {
    if (buf == (char *)0x0) {
      if ((int)_Size <= (int)size) {
        _Size = size;
      }
      pcVar6 = _malloc(_Size);
      if (pcVar6 != (char *)0x0) {
LAB_00462576:
        pcVar6 = crt_strcpy(pcVar6,local_10c);
        return pcVar6;
      }
      piVar4 = crt_errno_ptr();
      *piVar4 = 0xc;
    }
    else {
      pcVar6 = buf;
      if ((int)_Size <= (int)size) goto LAB_00462576;
      piVar4 = crt_errno_ptr();
      *piVar4 = 0x22;
    }
  }
  return (char *)0x0;
}



/* FUN_0046258a @ 0046258a */

/* [binja] int32_t sub_46258a(int32_t arg1) */

int __cdecl FUN_0046258a(int arg1)

{
  char cVar1;
  UINT UVar2;
  
  if (arg1 != 0) {
    cVar1 = (char)arg1;
    arg1 = (int)CONCAT12(0x5c,CONCAT11(0x3a,cVar1 + '@'));
    UVar2 = GetDriveTypeA((LPCSTR)&arg1);
    if ((UVar2 == 0) || (UVar2 == 1)) {
      return 0;
    }
  }
  return 1;
}



/* crt_free_base @ 004625c1 */

/* CRT heap free implementation */

void __cdecl crt_free_base(void *ptr)

{
  char *pcVar1;
  void *local_2c;
  char *local_28;
  uint local_24;
  char *local_20;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0046fa20;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  if (ptr == (void *)0x0) {
    return;
  }
  if (crt_heap_mode == 3) {
    ExceptionList = &local_14;
    crt_lock(9);
    local_8 = 0;
    local_20 = crt_sbh_find_region(ptr);
    if (local_20 != (char *)0x0) {
      FUN_00466ca6(local_20,ptr);
    }
    local_8 = 0xffffffff;
    FUN_0046262b();
    pcVar1 = local_20;
  }
  else {
    ExceptionList = &local_14;
    if (crt_heap_mode != 2) goto LAB_0046268d;
    ExceptionList = &local_14;
    crt_lock(9);
    local_8 = 1;
    local_28 = crt_sbh_find_block(ptr,&local_2c,&local_24);
    if (local_28 != (char *)0x0) {
      FUN_00467a2d(local_2c,local_24,local_28);
    }
    local_8 = 0xffffffff;
    FUN_00462683();
    pcVar1 = local_28;
  }
  if (pcVar1 != (char *)0x0) {
    ExceptionList = local_14;
    return;
  }
LAB_0046268d:
  HeapFree(DAT_004da3a4,0,ptr);
  ExceptionList = local_14;
  return;
}



/* FUN_0046262b @ 0046262b */

/* [binja] int32_t sub_46262b() */

int FUN_0046262b(void)

{
  int iVar1;
  
  iVar1 = crt_unlock(9);
  return iVar1;
}



/* FUN_00462683 @ 00462683 */

/* [binja] int32_t sub_462683() */

int FUN_00462683(void)

{
  int iVar1;
  
  iVar1 = crt_unlock(9);
  return iVar1;
}



/* crt_realloc @ 004626aa */

/* CRT: realloc with heap mode handling and new-handler retry */

void * __cdecl crt_realloc(void *ptr,size_t size)

{
  void *pvVar1;
  int iVar2;
  uint uVar3;
  LPVOID pvVar4;
  byte *arg3;
  void *local_3c;
  uint local_38;
  byte *local_34;
  void **local_30;
  int *local_2c;
  byte *local_28;
  void *local_24;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0046fa38;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  arg3 = (byte *)0x0;
  if (ptr == (void *)0x0) {
    ExceptionList = &local_14;
    pvVar1 = _malloc(size);
  }
  else {
    if (size == 0) {
      ExceptionList = &local_14;
      crt_free_base(ptr);
    }
    else {
      ExceptionList = &local_14;
      if (crt_heap_mode == 3) {
        do {
          local_28 = (void *)0x0;
          if (size < (void *)0xffffffe1) {
            crt_lock(9);
            local_8 = 0;
            local_2c = crt_sbh_find_region(ptr);
            if (local_2c != (int *)0x0) {
              if (size <= DAT_004da3a0) {
                iVar2 = FUN_00467484(local_2c,ptr,(void *)size);
                if (iVar2 == 0) {
                  local_28 = crt_sbh_alloc(size);
                  if (local_28 != (void *)0x0) {
                    local_24 = (void *)(*(int *)((int)ptr + -4) - 1);
                    pvVar1 = local_24;
                    if (size <= local_24) {
                      pvVar1 = (void *)size;
                    }
                    crt_bufcpy(local_28,ptr,(size_t)pvVar1);
                    local_2c = crt_sbh_find_region(ptr);
                    FUN_00466ca6(local_2c,ptr);
                  }
                }
                else {
                  local_28 = ptr;
                }
              }
              if (local_28 == (void *)0x0) {
                if ((void *)size == (void *)0x0) {
                  size = 1;
                }
                size = size + 0xf & 0xfffffff0;
                local_28 = HeapAlloc(DAT_004da3a4,0,size);
                if (local_28 != (LPVOID)0x0) {
                  local_24 = (void *)(*(int *)((int)ptr + -4) - 1);
                  pvVar1 = local_24;
                  if (size <= local_24) {
                    pvVar1 = (void *)size;
                  }
                  crt_bufcpy(local_28,ptr,(size_t)pvVar1);
                  FUN_00466ca6(local_2c,ptr);
                }
              }
            }
            local_8 = 0xffffffff;
            FUN_00462835();
            if (local_2c == (int *)0x0) {
              if ((void *)size == (void *)0x0) {
                size = 1;
              }
              size = size + 0xf & 0xfffffff0;
              local_28 = HeapReAlloc(DAT_004da3a4,0,ptr,size);
            }
          }
          if (local_28 != (void *)0x0) {
            ExceptionList = local_14;
            return local_28;
          }
          if (DAT_004d9a78 == (byte *)0x0) {
            ExceptionList = local_14;
            return (void *)0x0;
          }
          iVar2 = crt_call_new_handler(size);
        } while (iVar2 != 0);
      }
      else {
        ExceptionList = &local_14;
        if (crt_heap_mode == 2) {
          ExceptionList = &local_14;
          if (size < 0xffffffe1) {
            if (size == 0) {
              size = 0x10;
              ExceptionList = &local_14;
            }
            else {
              size = size + 0xf & 0xfffffff0;
              ExceptionList = &local_14;
            }
          }
          do {
            local_28 = arg3;
            if (size < 0xffffffe1) {
              crt_lock(9);
              local_8 = 1;
              arg3 = crt_sbh_find_block(ptr,&local_3c,(uint *)&local_30);
              local_34 = arg3;
              if (arg3 == (byte *)0x0) {
                local_28 = HeapReAlloc(DAT_004da3a4,0,ptr,size);
              }
              else {
                if (size < DAT_0047db14) {
                  iVar2 = FUN_00467d9e(local_3c,local_30,(char *)arg3,size >> 4);
                  if (iVar2 == 0) {
                    local_28 = crt_sbh_alloc_units(size >> 4);
                    if (local_28 != (byte *)0x0) {
                      local_38 = (uint)*arg3 << 4;
                      uVar3 = local_38;
                      if (size <= local_38) {
                        uVar3 = size;
                      }
                      crt_bufcpy(local_28,ptr,uVar3);
                      FUN_00467a2d(local_3c,(int)local_30,(char *)arg3);
                    }
                  }
                  else {
                    local_28 = ptr;
                  }
                }
                if ((local_28 == (byte *)0x0) &&
                   (local_28 = HeapAlloc(DAT_004da3a4,0,size), local_28 != (byte *)0x0)) {
                  local_38 = (uint)*arg3 << 4;
                  uVar3 = local_38;
                  if (size <= local_38) {
                    uVar3 = size;
                  }
                  crt_bufcpy(local_28,ptr,uVar3);
                  FUN_00467a2d(local_3c,(int)local_30,(char *)arg3);
                }
              }
              local_8 = 0xffffffff;
              FUN_00462983();
            }
            if (local_28 != arg3) {
              ExceptionList = local_14;
              return local_28;
            }
            if (DAT_004d9a78 == arg3) {
              ExceptionList = local_14;
              return local_28;
            }
            iVar2 = crt_call_new_handler(size);
          } while (iVar2 != 0);
        }
        else {
          do {
            pvVar4 = (LPVOID)0x0;
            if (size < 0xffffffe1) {
              if (size == 0) {
                size = 1;
              }
              size = size + 0xf & 0xfffffff0;
              pvVar4 = HeapReAlloc(DAT_004da3a4,0,ptr,size);
            }
            if (pvVar4 != (LPVOID)0x0) {
              ExceptionList = local_14;
              return pvVar4;
            }
            if (DAT_004d9a78 == (byte *)0x0) {
              ExceptionList = local_14;
              return (void *)0x0;
            }
            iVar2 = crt_call_new_handler(size);
          } while (iVar2 != 0);
        }
      }
    }
    pvVar1 = (void *)0x0;
  }
  ExceptionList = local_14;
  return pvVar1;
}



/* FUN_00462835 @ 00462835 */

/* [binja] int32_t sub_462835() */

int FUN_00462835(void)

{
  int iVar1;
  
  iVar1 = crt_unlock(9);
  return iVar1;
}



/* FUN_00462983 @ 00462983 */

/* [binja] int32_t sub_462983() */

int FUN_00462983(void)

{
  int iVar1;
  
  iVar1 = crt_unlock(9);
  return iVar1;
}



/* _malloc @ 004629d9 */

/* Library Function - Single Match
    _malloc
   
   Library: Visual Studio 2003 Release */

void * __cdecl _malloc(size_t _Size)

{
  void *pvVar1;
  
  pvVar1 = __nh_malloc(_Size,DAT_004d9a78);
  return pvVar1;
}



/* __nh_malloc @ 004629eb */

/* Library Function - Single Match
    __nh_malloc
   
   Library: Visual Studio 2003 Release */

void * __cdecl __nh_malloc(size_t _Size,int _NhFlag)

{
  void *pvVar1;
  int iVar2;
  
  if (_Size < 0xffffffe1) {
    do {
      pvVar1 = FUN_00462a17(_Size);
      if (pvVar1 != (void *)0x0) {
        return pvVar1;
      }
      if (_NhFlag == 0) {
        return (void *)0x0;
      }
      iVar2 = crt_call_new_handler(_Size);
    } while (iVar2 != 0);
  }
  return (void *)0x0;
}



/* FUN_00462a17 @ 00462a17 */

/* [binja] void* sub_462a17(uint32_t arg1) */

void * __cdecl FUN_00462a17(uint arg1)

{
  void *pvVar1;
  LPVOID pvVar2;
  uint dwBytes;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0046fa50;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  if (crt_heap_mode == 3) {
    ExceptionList = &local_14;
    if (arg1 <= DAT_004da3a0) {
      ExceptionList = &local_14;
      crt_lock(9);
      local_8 = 0;
      pvVar1 = crt_sbh_alloc(arg1);
      local_8 = 0xffffffff;
      FUN_00462a7e();
      if (pvVar1 != (void *)0x0) {
        ExceptionList = local_14;
        return pvVar1;
      }
    }
  }
  else {
    ExceptionList = &local_14;
    if (crt_heap_mode == 2) {
      if (arg1 == 0) {
        dwBytes = 0x10;
      }
      else {
        dwBytes = arg1 + 0xf & 0xfffffff0;
      }
      ExceptionList = &local_14;
      if (dwBytes <= DAT_0047db14) {
        ExceptionList = &local_14;
        crt_lock(9);
        local_8 = 1;
        pvVar1 = crt_sbh_alloc_units(dwBytes >> 4);
        local_8 = 0xffffffff;
        FUN_00462add();
        if (pvVar1 != (void *)0x0) {
          ExceptionList = local_14;
          return pvVar1;
        }
      }
      goto LAB_00462af6;
    }
  }
  if (arg1 == 0) {
    arg1 = 1;
  }
  dwBytes = arg1 + 0xf & 0xfffffff0;
LAB_00462af6:
  pvVar2 = HeapAlloc(DAT_004da3a4,0,dwBytes);
  ExceptionList = local_14;
  return pvVar2;
}



/* FUN_00462a7e @ 00462a7e */

/* [binja] int32_t sub_462a7e() */

int FUN_00462a7e(void)

{
  int iVar1;
  
  iVar1 = crt_unlock(9);
  return iVar1;
}



/* FUN_00462add @ 00462add */

/* [binja] int32_t sub_462add() */

int FUN_00462add(void)

{
  int iVar1;
  
  iVar1 = crt_unlock(9);
  return iVar1;
}



/* _strstr @ 00462b20 */

/* Library Function - Single Match
    _strstr
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

char * __cdecl _strstr(char *_Str,char *_SubStr)

{
  char *pcVar1;
  char *pcVar2;
  char cVar3;
  uint uVar4;
  char cVar5;
  uint uVar6;
  uint uVar7;
  char *pcVar8;
  uint *puVar9;
  char *pcVar10;
  
  cVar3 = *_SubStr;
  if (cVar3 == '\0') {
    return _Str;
  }
  if (_SubStr[1] == '\0') {
    while (((uint)_Str & 3) != 0) {
      uVar4 = *(uint *)_Str;
      if ((char)uVar4 == cVar3) {
        return (char *)(uint *)_Str;
      }
      _Str = (char *)((int)_Str + 1);
      if ((char)uVar4 == '\0') {
        return (char *)0x0;
      }
    }
    while( true ) {
      while( true ) {
        uVar4 = *(uint *)_Str;
        uVar7 = uVar4 ^ CONCAT22(CONCAT11(cVar3,cVar3),CONCAT11(cVar3,cVar3));
        uVar6 = uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff;
        puVar9 = (uint *)((int)_Str + 4);
        if (((uVar7 ^ 0xffffffff ^ uVar7 + 0x7efefeff) & 0x81010100) != 0) break;
        _Str = (char *)puVar9;
        if ((uVar6 & 0x81010100) != 0) {
          if ((uVar6 & 0x1010100) != 0) {
            return (char *)0x0;
          }
          if ((uVar4 + 0x7efefeff & 0x80000000) == 0) {
            return (char *)0x0;
          }
        }
      }
      uVar4 = *(uint *)_Str;
      if ((char)uVar4 == cVar3) {
        return (char *)(uint *)_Str;
      }
      if ((char)uVar4 == '\0') {
        return (char *)0x0;
      }
      cVar5 = (char)(uVar4 >> 8);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 1);
      }
      if (cVar5 == '\0') {
        return (char *)0x0;
      }
      cVar5 = (char)(uVar4 >> 0x10);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 2);
      }
      if (cVar5 == '\0') break;
      cVar5 = (char)(uVar4 >> 0x18);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 3);
      }
      _Str = (char *)puVar9;
      if (cVar5 == '\0') {
        return (char *)0x0;
      }
    }
    return (char *)0x0;
  }
  do {
    cVar5 = *_Str;
    do {
      while (_Str = _Str + 1, cVar5 != cVar3) {
        if (cVar5 == '\0') {
          return (char *)0x0;
        }
        cVar5 = *_Str;
      }
      cVar5 = *_Str;
      pcVar10 = _Str + 1;
      pcVar8 = _SubStr;
    } while (cVar5 != _SubStr[1]);
    do {
      if (pcVar8[2] == '\0') {
LAB_00462b93:
        return _Str + -1;
      }
      if (*pcVar10 != pcVar8[2]) break;
      pcVar1 = pcVar8 + 3;
      if (*pcVar1 == '\0') goto LAB_00462b93;
      pcVar2 = pcVar10 + 1;
      pcVar8 = pcVar8 + 2;
      pcVar10 = pcVar10 + 2;
    } while (*pcVar1 == *pcVar2);
  } while( true );
}



/* FUN_00462ba0 @ 00462ba0 */

/* [binja] int32_t sub_462ba0(char* arg1, char* arg2) */

int __cdecl FUN_00462ba0(char *arg1,char *arg2)

{
  int iVar1;
  void *this;
  char *local_24;
  size_t local_20;
  char *local_1c;
  undefined4 local_18;
  
  local_18 = 0x49;
  local_1c = arg1;
  local_24 = arg1;
  local_20 = _strlen(arg1);
  iVar1 = FUN_00467e62(this,(int *)&local_24,(byte *)arg2,(undefined4 *)&stack0x0000000c);
  return iVar1;
}



/* crt_qsort @ 00462bd4 */

/* CRT: quicksort with callback (cmp) */

void __cdecl crt_qsort(void *base,size_t num,size_t size,void *cmp)

{
  char *pcVar1;
  uint uVar2;
  char *b;
  int iVar3;
  char *hi;
  char *b_00;
  undefined1 local_fc [120];
  undefined1 local_84 [120];
  char *local_c;
  int local_8;
  
  if ((num < 2) || (size == 0)) {
    return;
  }
  local_8 = 0;
  iVar3 = num - 1;
  num = (size_t)local_fc;
  hi = (char *)(iVar3 * size + (int)base);
  b = base;
  base = local_84;
LAB_00462c13:
  uVar2 = (uint)((int)hi - (int)b) / size + 1;
  if (8 < uVar2) {
    crt_swap(b + (uVar2 >> 1) * size,b,size);
    b_00 = hi + size;
    local_c = b;
LAB_00462c6a:
    local_c = local_c + size;
    if (local_c <= hi) goto code_r0x00462c77;
    goto LAB_00462c82;
  }
  crt_shortsort(b,hi,size,cmp);
  goto LAB_00462c32;
code_r0x00462c77:
  iVar3 = (*cmp)(local_c,b);
  if (iVar3 < 1) goto LAB_00462c6a;
LAB_00462c82:
  do {
    b_00 = b_00 + -size;
    if (b_00 <= b) break;
    iVar3 = (*cmp)(b_00,b);
  } while (-1 < iVar3);
  if (local_c <= b_00) {
    crt_swap(local_c,b_00,size);
    goto LAB_00462c6a;
  }
  crt_swap(b,b_00,size);
  pcVar1 = local_c;
  if ((int)(b_00 + (-1 - (int)b)) < (int)hi - (int)local_c) {
    if (local_c < hi) {
      local_8 = local_8 + 1;
      *(char **)num = local_c;
      *(char **)base = hi;
      base = (void *)((int)base + 4);
      num = num + 4;
    }
    if (b + size < b_00) {
      hi = b_00 + -size;
      goto LAB_00462c13;
    }
  }
  else {
    if (b + size < b_00) {
      local_8 = local_8 + 1;
      *(char **)num = b;
      *(size_t *)base = (int)b_00 - size;
      base = (void *)((int)base + 4);
      num = num + 4;
    }
    b = pcVar1;
    if (pcVar1 < hi) goto LAB_00462c13;
  }
LAB_00462c32:
  local_8 = local_8 + -1;
  num = num - 4;
  base = (void *)((int)base + -4);
  if (local_8 < 0) {
    return;
  }
  hi = *(char **)base;
  b = *(char **)num;
  goto LAB_00462c13;
}



/* crt_shortsort @ 00462d28 */

/* CRT: insertion sort for small arrays (cmp) */

void __cdecl crt_shortsort(char *lo,char *hi,size_t width,void *cmp)

{
  int iVar1;
  char *a;
  char *pcVar2;
  
  for (; a = lo, pcVar2 = lo, lo < hi; hi = hi + -width) {
    while (pcVar2 = pcVar2 + width, pcVar2 <= hi) {
      iVar1 = (*cmp)(pcVar2,a);
      if (0 < iVar1) {
        a = pcVar2;
      }
    }
    crt_swap(a,hi,width);
  }
  return;
}



/* crt_swap @ 00462d76 */

/* CRT: swap elements for qsort */

void __cdecl crt_swap(char *a,char *b,size_t width)

{
  char cVar1;
  
  if (a != b) {
    for (; width != 0; width = width - 1) {
      cVar1 = *a;
      *a = *b;
      a = a + 1;
      *b = cVar1;
      b = b + 1;
    }
  }
  return;
}



/* crt_getc @ 00462da2 */

/* CRT: get character with stream lock */

int __cdecl crt_getc(FILE *fp)

{
  int *piVar1;
  uint uVar2;
  
  crt_lock_file(fp);
  piVar1 = &fp->_cnt;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 < 0) {
    uVar2 = crt_filbuf(fp);
  }
  else {
    uVar2 = (uint)(byte)*fp->_ptr;
    fp->_ptr = fp->_ptr + 1;
  }
  crt_unlock_file(fp);
  return uVar2;
}



/* FUN_00462de0 @ 00462de0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint __thiscall FUN_00462de0(void *this,byte *param_1,byte *param_2)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  byte bVar4;
  byte bVar5;
  byte bVar6;
  char cVar7;
  void *extraout_ECX;
  void *this_00;
  void *extraout_ECX_00;
  void *locale_00;
  uint c;
  void *locale;
  
  iVar3 = _DAT_004da3b0;
  if (DAT_004d9a4c == 0) {
    bVar6 = 0xff;
    do {
      do {
        cVar7 = '\0';
        if (bVar6 == 0) goto LAB_00462e2e;
        bVar6 = *param_2;
        param_2 = param_2 + 1;
        bVar5 = *param_1;
        param_1 = param_1 + 1;
      } while (bVar5 == bVar6);
      bVar4 = bVar6 + 0xbf + (-((byte)(bVar6 + 0xbf) < 0x1a) & 0x20U) + 0x41;
      bVar5 = bVar5 + 0xbf;
      bVar6 = bVar5 + (-(bVar5 < 0x1a) & 0x20U) + 0x41;
    } while (bVar6 == bVar4);
    cVar7 = (bVar6 < bVar4) * -2 + '\x01';
LAB_00462e2e:
    locale = (void *)(int)cVar7;
  }
  else {
    LOCK();
    _DAT_004da3b0 = _DAT_004da3b0 + 1;
    UNLOCK();
    bVar1 = 0 < DAT_004da3ac;
    if (bVar1) {
      LOCK();
      UNLOCK();
      _DAT_004da3b0 = iVar3;
      crt_lock(0x13);
      this = extraout_ECX;
    }
    c = (uint)bVar1;
    locale = (void *)0xff;
    locale_00 = (void *)0x0;
    do {
      do {
        if ((char)locale == '\0') goto LAB_00462e8f;
        bVar6 = *param_2;
        locale = (void *)CONCAT31((int3)((uint)locale >> 8),bVar6);
        param_2 = param_2 + 1;
        bVar5 = *param_1;
        locale_00 = (void *)CONCAT31((int3)((uint)locale_00 >> 8),bVar5);
        param_1 = param_1 + 1;
      } while (bVar6 == bVar5);
      locale_00 = (void *)crt_tolower_l(this,locale_00,(int)locale);
      locale = (void *)crt_tolower_l(this_00,locale,c);
      this = extraout_ECX_00;
    } while ((byte)locale_00 == (byte)locale);
    uVar2 = (uint)((byte)locale_00 < (byte)locale);
    locale = (void *)((1 - uVar2) - (uint)(uVar2 != 0));
LAB_00462e8f:
    if (c == 0) {
      LOCK();
      _DAT_004da3b0 = _DAT_004da3b0 + -1;
      UNLOCK();
    }
    else {
      crt_unlock(0x13);
    }
  }
  return (uint)locale;
}



/* crt_run_initializers @ 00462eb0 */

/* invokes CRT initializer function ranges */

void crt_run_initializers(void)

{
  if (PTR_FUN_0047b160 != (undefined *)0x0) {
    (*(code *)PTR_FUN_0047b160)();
  }
  crt_call_fn_range((undefined4 *)&DAT_004710e4,(undefined4 *)&DAT_004710f8);
  crt_call_fn_range((undefined4 *)&DAT_00471000,(undefined4 *)&DAT_004710e0);
  return;
}



/* crt_exit @ 00462edd */

/* CRT exit path (atexit/onexit + ExitProcess) */

void __cdecl crt_exit(uint code)

{
  crt_doexit(code,0,0);
  return;
}



/* __exit @ 00462eee */

/* Library Function - Single Match
    __exit
   
   Library: Visual Studio 2003 Release */

void __cdecl __exit(int _Code)

{
  crt_doexit(_Code,1,0);
  return;
}



/* crt_doexit @ 00462eff */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* CRT exit worker (atexit/onexit + ExitProcess) */

void __cdecl crt_doexit(uint code,int full,int quick)

{
  HANDLE hProcess;
  undefined4 *puVar1;
  uint uExitCode;
  
  crt_exit_lock();
  if (DAT_004d99c0 == 1) {
    uExitCode = code;
    hProcess = GetCurrentProcess();
    TerminateProcess(hProcess,uExitCode);
  }
  _DAT_004d99bc = 1;
  DAT_004d99b8 = (undefined1)quick;
  if (full == 0) {
    if ((crt_onexit_table_end != (undefined4 *)0x0) &&
       (puVar1 = (undefined4 *)(crt_onexit_table_begin - 4), crt_onexit_table_end <= puVar1)) {
      do {
        if ((code *)*puVar1 != (code *)0x0) {
          (*(code *)*puVar1)();
        }
        puVar1 = puVar1 + -1;
      } while (crt_onexit_table_end <= puVar1);
    }
    crt_call_fn_range((undefined4 *)&DAT_004710fc,(undefined4 *)&DAT_00471104);
  }
  crt_call_fn_range((undefined4 *)&DAT_00471108,(undefined4 *)&DAT_00471110);
  if (quick == 0) {
    DAT_004d99c0 = 1;
                    /* WARNING: Subroutine does not return */
    ExitProcess(code);
  }
  crt_exit_unlock();
  return;
}



/* crt_exit_lock @ 00462fa4 */

/* exit lock */

void crt_exit_lock(void)

{
  crt_lock(0xd);
  return;
}



/* crt_exit_unlock @ 00462fad */

/* exit unlock */

void crt_exit_unlock(void)

{
  crt_unlock(0xd);
  return;
}



/* crt_call_fn_range @ 00462fb6 */

/* call function pointers in a range */

void __cdecl crt_call_fn_range(undefined4 *param_1,undefined4 *param_2)

{
  for (; param_1 < param_2; param_1 = param_1 + 1) {
    if ((code *)*param_1 != (code *)0x0) {
      (*(code *)*param_1)();
    }
  }
  return;
}



/* crt_isalpha @ 00462fd0 */

/* ctype alpha check (MBCS-aware) */

uint __thiscall crt_isalpha(void *this,int c)

{
  uint uVar1;
  
  if (1 < DAT_0047b3cc) {
    uVar1 = crt_isctype(this,c,0x103);
    return uVar1;
  }
  return *(ushort *)(crt_ctype_table + c * 2) & 0x103;
}



/* crt_isspace @ 00462ffe */

/* ctype space check (MBCS-aware) */

uint __thiscall crt_isspace(void *this,int c)

{
  uint uVar1;
  
  if (1 < DAT_0047b3cc) {
    uVar1 = crt_isctype(this,c,8);
    return uVar1;
  }
  return (byte)crt_ctype_table[c * 2] & 8;
}



/* entry @ 00463026 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void entry(void)

{
  DWORD DVar1;
  int iVar2;
  uint code;
  _STARTUPINFOA local_60;
  undefined1 *local_1c;
  _EXCEPTION_POINTERS *local_18;
  void *pvStack_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0046fa68;
  puStack_10 = &LAB_00465e70;
  pvStack_14 = ExceptionList;
  local_1c = &stack0xffffff88;
  ExceptionList = &pvStack_14;
  DVar1 = GetVersion();
  _DAT_004d9990 = DVar1 >> 8 & 0xff;
  _DAT_004d998c = DVar1 & 0xff;
  _DAT_004d9988 = _DAT_004d998c * 0x100 + _DAT_004d9990;
  _DAT_004d9984 = DVar1 >> 0x10;
  iVar2 = crt_heap_init(1);
  if (iVar2 == 0) {
    FUN_00463153(0x1c);
  }
  iVar2 = crt_mt_init();
  if (iVar2 == 0) {
    FUN_00463153(0x10);
  }
  local_8 = 0;
  crt_io_init();
  DAT_004db4e4 = GetCommandLineA();
  DAT_004d99c4 = crt_get_environment_strings();
  crt_build_argv();
  crt_build_environ();
  crt_run_initializers();
  local_60.dwFlags = 0;
  GetStartupInfoA(&local_60);
  crt_skip_program_name();
  GetModuleHandleA((LPCSTR)0x0);
  code = crimsonland_main();
  crt_exit(code);
  crt_exception_filter(local_18->ExceptionRecord->ExceptionCode,local_18);
  return;
}



/* __amsg_exit @ 0046312e */

/* Library Function - Single Match
    __amsg_exit
   
   Library: Visual Studio 2003 Release */

void __cdecl __amsg_exit(int param_1)

{
  if (DAT_004d99cc == 1) {
    crt_runtime_error_banner();
  }
  crt_report_runtime_error(param_1);
  (*(code *)PTR___exit_0047b180)(0xff);
  return;
}



/* FUN_00463153 @ 00463153 */

void __cdecl FUN_00463153(DWORD param_1)

{
  if (DAT_004d99cc == 1) {
    crt_runtime_error_banner();
  }
  crt_report_runtime_error(param_1);
                    /* WARNING: Subroutine does not return */
  ExitProcess(0xff);
}



/* FUN_00463180 @ 00463180 */

void FUN_00463180(void)

{
  float10 in_ST0;
  double dVar1;
  
  dVar1 = (double)in_ST0;
  FUN_004651b8(SUB84(dVar1,0),(uint)((ulonglong)dVar1 >> 0x20));
  FUN_0046319d(SUB84(dVar1,0),(uint)((ulonglong)dVar1 >> 0x20));
  return;
}



/* FUN_0046319d @ 0046319d */

void __cdecl FUN_0046319d(int param_1,uint param_2)

{
  uint in_EAX;
  bool in_ZF;
  ushort in_FPUControlWord;
  float10 in_ST0;
  float10 extraout_ST0;
  undefined4 unaff_retaddr;
  
  if (in_ZF) {
    if (((in_EAX & 0xfffff) != 0) || (param_1 != 0)) {
      FUN_0046515c();
    }
LAB_0046322c:
    if (DAT_004d9960 == 0) {
      __startOneArgErrorHandling(&DAT_0047b190,0xd,in_FPUControlWord,unaff_retaddr,param_1,param_2);
      return;
    }
  }
  else {
    if (in_FPUControlWord != 0x27f) {
      in_EAX = FUN_00465145();
      in_ST0 = extraout_ST0;
    }
    if (in_EAX < 0x3ff00000) {
      fpatan(SQRT(((float10)1 - in_ST0) * ((float10)1 + in_ST0)),in_ST0);
    }
    else if ((0x3ff00000 < in_EAX) || ((param_2 & 0xfffff) != 0 || param_1 != 0)) goto LAB_0046322c;
    if (DAT_004d9960 == 0) {
      __math_exit(&DAT_0047b190,0xd,unaff_retaddr,param_1,param_2);
      return;
    }
  }
  return;
}



/* FUN_0046324b @ 0046324b */

bool __cdecl FUN_0046324b(undefined4 param_1,undefined4 param_2)

{
  return (param_2._2_2_ & 0x7ff0) != 0x7ff0;
}



/* FUN_0046325f @ 0046325f */

int __cdecl FUN_0046325f(int param_1,uint param_2)

{
  int iVar1;
  
  if ((param_2._2_2_ & 0x7ff0) == 0x7ff0) {
    iVar1 = FUN_00468f58(param_1,(uint)(CONCAT26(param_2._2_2_,CONCAT24((undefined2)param_2,param_1)
                                                ) >> 0x20));
    if (iVar1 != 1) {
      if (iVar1 == 2) {
        iVar1 = 4;
      }
      else if (iVar1 == 3) {
        iVar1 = 2;
      }
      else {
        iVar1 = 1;
      }
      return iVar1;
    }
    return 0x200;
  }
  if (((param_2 & 0x7ff00000) == 0) && (((param_2 & 0xfffff) != 0 || (param_1 != 0)))) {
    return (-(uint)((param_2 & 0x80000000) != 0) & 0xffffff90) + 0x80;
  }
  if ((double)CONCAT26(param_2._2_2_,CONCAT24((undefined2)param_2,param_1)) == 0.0) {
    return (-(uint)((param_2 & 0x80000000) != 0) & 0xffffffe0) + 0x40;
  }
  return (-(uint)((param_2 & 0x80000000) != 0) & 0xffffff08) + 0x100;
}



/* FUN_004632f1 @ 004632f1 */

void FUN_004632f1(undefined *UNRECOVERED_JUMPTABLE)

{
  ExceptionList = *(void **)ExceptionList;
                    /* WARNING: Could not recover jumptable at 0x0046331c. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  (*(code *)UNRECOVERED_JUMPTABLE)();
  return;
}



/* FUN_00463325 @ 00463325 */

/* [binja] int32_t sub_463325(int32_t arg1, void* const arg2) */

int FUN_00463325(int arg1,void *arg2)

{
  int iVar1;
  
  LOCK();
  UNLOCK();
                    /* WARNING: Could not recover jumptable at 0x0046332a. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*arg2)();
  return iVar1;
}



/* FUN_0046332c @ 0046332c */

/* [binja] int32_t sub_46332c(int32_t arg1, void* const arg2) */

int FUN_0046332c(int arg1,void *arg2)

{
  int iVar1;
  
  LOCK();
  UNLOCK();
                    /* WARNING: Could not recover jumptable at 0x00463331. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (*arg2)();
  return iVar1;
}



/* FUN_00463333 @ 00463333 */

/* [binja] struct _EXCEPTION_REGISTRATION_RECORD* __stdcall sub_463333(int32_t arg1,
   EXCEPTION_RECORD* arg2) */

void * FUN_00463333(int arg1,void *arg2)

{
  void *pvVar1;
  void *pvVar2;
  
  pvVar1 = ExceptionList;
  RtlUnwind((PVOID)arg1,(PVOID)0x46335b,arg2,(PVOID)0x0);
  *(uint *)((int)arg2 + 4) = *(uint *)((int)arg2 + 4) & 0xfffffffd;
  pvVar2 = ExceptionList;
  *(void **)pvVar1 = ExceptionList;
  ExceptionList = pvVar1;
  return pvVar2;
}



/* FUN_00463382 @ 00463382 */

int __cdecl FUN_00463382(PEXCEPTION_RECORD param_1,PVOID param_2,DWORD param_3,void *param_4)

{
  int *in_EAX;
  int iVar1;
  
  iVar1 = crt_cxx_frame_handler(param_1,param_2,param_3,param_4,in_EAX,0,(PVOID)0x0,'\0');
  return iVar1;
}



/* FUN_004633b8 @ 004633b8 */

undefined4 __cdecl
FUN_004633b8(undefined4 param_1,undefined4 param_2,undefined4 param_3,int param_4,int param_5)

{
  undefined4 uVar1;
  void *local_18;
  code *local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
  local_10 = param_2;
  local_14 = FUN_0046340c;
  local_8 = param_4 + 1;
  local_c = param_1;
  local_18 = ExceptionList;
  ExceptionList = &local_18;
  uVar1 = __CallSettingFrame_12(param_3,param_1,param_5);
  ExceptionList = local_18;
  return uVar1;
}



/* FUN_0046340c @ 0046340c */

/* [binja] int32_t sub_46340c(PEXCEPTION_RECORD arg1, PVOID arg2, DWORD arg3) */

int __cdecl FUN_0046340c(PEXCEPTION_RECORD arg1,PVOID arg2,DWORD arg3)

{
  int iVar1;
  
  iVar1 = crt_cxx_frame_handler
                    (arg1,*(PVOID *)((int)arg2 + 0xc),arg3,(void *)0x0,*(int **)((int)arg2 + 8),
                     *(int *)((int)arg2 + 0x10),arg2,'\0');
  return iVar1;
}



/* FUN_00463431 @ 00463431 */

undefined4 __cdecl
FUN_00463431(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined4 param_6,undefined4 param_7)

{
  DWORD *pDVar1;
  undefined4 uVar2;
  undefined4 **ppuVar3;
  undefined4 *local_34;
  undefined4 local_30;
  undefined4 *local_2c;
  code *local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined1 *local_10;
  undefined1 *local_c;
  int local_8;
  
  local_c = &stack0xfffffffc;
  local_10 = &stack0xffffffbc;
  local_28 = FUN_004634e7;
  local_24 = param_5;
  local_20 = param_2;
  local_1c = param_6;
  local_18 = param_7;
  local_8 = 0;
  local_14 = 0x4634b9;
  local_2c = ExceptionList;
  ExceptionList = &local_2c;
  local_34 = param_1;
  local_30 = param_3;
  ppuVar3 = &local_34;
  uVar2 = *param_1;
  pDVar1 = crt_get_thread_data();
  (*(code *)pDVar1[0x1a])(uVar2,ppuVar3);
  if (local_8 != 0) {
    *local_2c = *(undefined4 *)ExceptionList;
  }
  ExceptionList = local_2c;
  return 0;
}



/* FUN_004634e7 @ 004634e7 */

/* [binja] int32_t sub_4634e7(EXCEPTION_RECORD* arg1, void* arg2, DWORD arg3) */

int __cdecl FUN_004634e7(EXCEPTION_RECORD *arg1,void *arg2,DWORD arg3)

{
  int iVar1;
  
  if ((arg1->ExceptionFlags & 0x66) != 0) {
    *(undefined4 *)((int)arg2 + 0x24) = 1;
    return 1;
  }
  crt_cxx_frame_handler
            (arg1,*(PVOID *)((int)arg2 + 0xc),arg3,(void *)0x0,*(int **)((int)arg2 + 8),
             *(int *)((int)arg2 + 0x10),*(PVOID *)((int)arg2 + 0x14),'\x01');
  if (*(int *)((int)arg2 + 0x24) == 0) {
    FUN_00463333((int)arg2,arg1);
  }
                    /* WARNING: Could not recover jumptable at 0x00463551. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = (**(code **)((int)arg2 + 0x18))();
  return iVar1;
}



/* FUN_0046355c @ 0046355c */

int __cdecl FUN_0046355c(int param_1,int param_2,int param_3,uint *param_4,uint *param_5)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  
  uVar5 = *(uint *)(param_1 + 0xc);
  iVar1 = *(int *)(param_1 + 0x10);
  uVar4 = uVar5;
  uVar3 = uVar5;
  while (uVar2 = uVar4, -1 < param_2) {
    if (uVar5 == 0xffffffff) {
      crt_invalid_parameter_noinfo_noreturn();
    }
    uVar5 = uVar5 - 1;
    if (((*(int *)(iVar1 + 4 + uVar5 * 0x14) < param_3) &&
        (param_3 <= *(int *)(iVar1 + uVar5 * 0x14 + 8))) || (uVar4 = uVar2, uVar5 == 0xffffffff)) {
      param_2 = param_2 + -1;
      uVar4 = uVar5;
      uVar3 = uVar2;
    }
  }
  uVar5 = uVar5 + 1;
  *param_4 = uVar5;
  *param_5 = uVar3;
  if ((*(uint *)(param_1 + 0xc) < uVar3) || (uVar3 < uVar5)) {
    crt_invalid_parameter_noinfo_noreturn();
  }
  return iVar1 + uVar5 * 0x14;
}



/* __global_unwind2 @ 004635d8 */

/* Library Function - Single Match
    __global_unwind2
   
   Library: Visual Studio */

void __cdecl __global_unwind2(PVOID param_1)

{
  RtlUnwind(param_1,(PVOID)0x4635f0,(PEXCEPTION_RECORD)0x0,(PVOID)0x0);
  return;
}



/* __local_unwind2 @ 0046361a */

/* Library Function - Single Match
    __local_unwind2
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release, Visual Studio 2003 Debug, Visual
   Studio 2003 Release */

void __cdecl __local_unwind2(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  void *pvStack_1c;
  undefined1 *puStack_18;
  undefined4 local_14;
  int iStack_10;
  
  iStack_10 = param_1;
  puStack_18 = &LAB_004635f8;
  pvStack_1c = ExceptionList;
  ExceptionList = &pvStack_1c;
  while( true ) {
    iVar1 = *(int *)(param_1 + 8);
    iVar2 = *(int *)(param_1 + 0xc);
    if ((iVar2 == -1) || (iVar2 == param_2)) break;
    local_14 = *(undefined4 *)(iVar1 + iVar2 * 0xc);
    *(undefined4 *)(param_1 + 0xc) = local_14;
    if (*(int *)(iVar1 + 4 + iVar2 * 0xc) == 0) {
      FUN_004636ae();
      (**(code **)(iVar1 + 8 + iVar2 * 0xc))();
    }
  }
  ExceptionList = pvStack_1c;
  return;
}



/* __abnormal_termination @ 00463682 */

/* Library Function - Single Match
    __abnormal_termination
   
   Library: Visual Studio */

int __cdecl __abnormal_termination(void)

{
  int iVar1;
  
  iVar1 = 0;
  if ((*(undefined1 **)((int)ExceptionList + 4) == &LAB_004635f8) &&
     (*(int *)((int)ExceptionList + 8) == *(int *)(*(int *)((int)ExceptionList + 0xc) + 0xc))) {
    iVar1 = 1;
  }
  return iVar1;
}



/* __NLG_Notify1 @ 004636a5 */

/* Library Function - Single Match
    __NLG_Notify1
   
   Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
   Studio 2019 Release */

void __fastcall __NLG_Notify1(undefined4 param_1)

{
  undefined4 in_EAX;
  undefined4 unaff_EBP;
  
  DAT_0047b1a0 = param_1;
  DAT_0047b19c = in_EAX;
  DAT_0047b1a4 = unaff_EBP;
  return;
}



/* FUN_004636ae @ 004636ae */

void FUN_004636ae(void)

{
  undefined4 in_EAX;
  int unaff_EBP;
  
  DAT_0047b1a0 = *(undefined4 *)(unaff_EBP + 8);
  DAT_0047b19c = in_EAX;
  DAT_0047b1a4 = unaff_EBP;
  return;
}



/* FUN_004636c8 @ 004636c8 */

/* [binja] void* const __EH_prolog() */

void * FUN_004636c8(void)

{
  void *unaff_retaddr;
  undefined1 auStack_c [12];
  
  ExceptionList = auStack_c;
  return unaff_retaddr;
}



/* FUN_004636e7 @ 004636e7 */

void __fastcall FUN_004636e7(void *param_1)

{
  FUN_00469e81(param_1,0x10000,0x30000);
  return;
}



/* FUN_004636f9 @ 004636f9 */

/* WARNING: Removing unreachable block (ram,0x0046372e) */

undefined4 FUN_004636f9(void)

{
  return 0;
}



/* FUN_00463737 @ 00463737 */

/* [binja] int32_t sub_463737() */

int FUN_00463737(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  int iVar2;
  
  hModule = GetModuleHandleA("KERNEL32");
  if (hModule != (HMODULE)0x0) {
    pFVar1 = GetProcAddress(hModule,"IsProcessorFeaturePresent");
    if (pFVar1 != (FARPROC)0x0) {
      iVar2 = (*pFVar1)(0);
      return iVar2;
    }
  }
  iVar2 = FUN_004636f9();
  return iVar2;
}



/* FUN_00463760 @ 00463760 */

/* [binja] int32_t sub_463760(char* arg1) */

int __cdecl FUN_00463760(char *arg1)

{
  char cVar1;
  undefined *this;
  int iVar2;
  uint uVar3;
  undefined *puVar4;
  
  this = (undefined *)(int)*arg1;
  iVar2 = crt_tolower((int)this);
  if (iVar2 != 0x65) {
    do {
      arg1 = arg1 + 1;
      if (DAT_0047b3cc < 2) {
        uVar3 = (byte)crt_ctype_table[*arg1 * 2] & 4;
        this = crt_ctype_table;
      }
      else {
        puVar4 = (undefined *)0x4;
        uVar3 = crt_isctype(this,(int)*arg1,4);
        this = puVar4;
      }
      iVar2 = 0;
    } while (uVar3 != 0);
  }
  iVar2 = CONCAT31((int3)((uint)iVar2 >> 8),*arg1);
  *arg1 = DAT_0047b3d0;
  do {
    arg1 = arg1 + 1;
    cVar1 = *arg1;
    *arg1 = (char)iVar2;
    iVar2 = CONCAT31((int3)((uint)iVar2 >> 8),cVar1);
  } while (*arg1 != '\0');
  return iVar2;
}



/* __fassign @ 00463820 */

/* Library Function - Single Match
    __fassign
   
   Library: Visual Studio 2003 Release */

void __cdecl __fassign(int flag,char *argument,char *number)

{
  void *in_ECX;
  void *local_c;
  void *local_8;
  
  if (flag != 0) {
    local_c = in_ECX;
    local_8 = in_ECX;
    FUN_0046a344(in_ECX,(uint *)&local_c,(byte *)number);
    *(void **)argument = local_c;
    *(void **)(argument + 4) = local_8;
    return;
  }
  FUN_0046a371(in_ECX,(uint *)&number,(byte *)number);
  *(char **)argument = number;
  return;
}



/* FUN_0046385e @ 0046385e */

undefined1 * __cdecl FUN_0046385e(undefined8 *param_1,undefined1 *param_2,int param_3,int param_4)

{
  uint local_2c [6];
  int local_14 [4];
  
  crt_fp_to_string((double)*param_1,local_14,local_2c);
  crt_fp_round_digits(param_2 + (uint)(0 < param_3) + (uint)(local_14[0] == 0x2d),param_3 + 1,
                      local_14);
  crt_fp_format_exp(param_2,param_3,param_4,local_14,0);
  return param_2;
}



/* crt_fp_format_exp @ 004638bf */

/* CRT: formats floating output in scientific notation (adds decimal/exponent) */

char * __cdecl crt_fp_format_exp(char *dst,int precision,int caps,int *fp_info,int force_decimal)

{
  char *pcVar1;
  char *pcVar2;
  int iVar3;
  
  if ((char)force_decimal != '\0') {
    crt_str_shift_right(dst + (*fp_info == 0x2d),(uint)(0 < precision));
  }
  pcVar2 = dst;
  if (*fp_info == 0x2d) {
    *dst = '-';
    pcVar2 = dst + 1;
  }
  pcVar1 = pcVar2;
  if (0 < precision) {
    pcVar1 = pcVar2 + 1;
    *pcVar2 = pcVar2[1];
    *pcVar1 = DAT_0047b3d0;
  }
  pcVar2 = crt_strcpy(pcVar1 + precision + (uint)((char)force_decimal == '\0'),"e+000");
  if (caps != 0) {
    *pcVar2 = 'E';
  }
  if (*(char *)fp_info[3] != '0') {
    iVar3 = fp_info[1] + -1;
    if (iVar3 < 0) {
      iVar3 = -iVar3;
      pcVar2[1] = '-';
    }
    if (99 < iVar3) {
      pcVar2[2] = pcVar2[2] + (char)(iVar3 / 100);
      iVar3 = iVar3 % 100;
    }
    if (9 < iVar3) {
      pcVar2[3] = pcVar2[3] + (char)(iVar3 / 10);
      iVar3 = iVar3 % 10;
    }
    pcVar2[4] = pcVar2[4] + (char)iVar3;
  }
  return dst;
}



/* FUN_00463981 @ 00463981 */

char * __cdecl FUN_00463981(undefined8 *param_1,char *param_2,size_t param_3)

{
  uint local_2c [6];
  int local_14;
  int local_10;
  
  crt_fp_to_string((double)*param_1,&local_14,local_2c);
  crt_fp_round_digits(param_2 + (local_14 == 0x2d),local_10 + param_3,&local_14);
  crt_fp_format_fixed(param_2,param_3,&local_14,0);
  return param_2;
}



/* crt_fp_format_fixed @ 004639d6 */

/* CRT: formats floating output in fixed notation (adds decimal/zeros) */

char * __cdecl crt_fp_format_fixed(char *dst,size_t precision,int *fp_info,int force_decimal)

{
  int iVar1;
  int iVar2;
  char *pcVar3;
  
  iVar1 = fp_info[1];
  if (((char)force_decimal != '\0') && (iVar1 - 1U == precision)) {
    iVar2 = *fp_info;
    dst[(uint)(iVar2 == 0x2d) + (iVar1 - 1U)] = '0';
    (dst + (uint)(iVar2 == 0x2d) + (iVar1 - 1U))[1] = '\0';
  }
  pcVar3 = dst;
  if (*fp_info == 0x2d) {
    *dst = '-';
    pcVar3 = dst + 1;
  }
  if (fp_info[1] < 1) {
    crt_str_shift_right(pcVar3,1);
    *pcVar3 = '0';
    pcVar3 = pcVar3 + 1;
  }
  else {
    pcVar3 = pcVar3 + fp_info[1];
  }
  if (0 < (int)precision) {
    crt_str_shift_right(pcVar3,1);
    *pcVar3 = DAT_0047b3d0;
    iVar1 = fp_info[1];
    if (iVar1 < 0) {
      if (((char)force_decimal != '\0') || (-iVar1 <= (int)precision)) {
        precision = -iVar1;
      }
      crt_str_shift_right(pcVar3 + 1,precision);
      _memset(pcVar3 + 1,0x30,precision);
    }
  }
  return dst;
}



/* FUN_00463a7d @ 00463a7d */

void __cdecl FUN_00463a7d(undefined8 *param_1,char *param_2,size_t param_3,int param_4)

{
  int iVar1;
  char *pcVar2;
  char *pcVar3;
  uint local_2c [6];
  int local_14;
  int local_10;
  
  crt_fp_to_string((double)*param_1,&local_14,local_2c);
  iVar1 = local_10 + -1;
  crt_fp_round_digits(param_2 + (local_14 == 0x2d),param_3,&local_14);
  local_10 = local_10 + -1;
  if ((local_10 < -4) || ((int)param_3 <= local_10)) {
    crt_fp_format_exp(param_2,param_3,param_4,&local_14,1);
  }
  else {
    pcVar2 = param_2 + (local_14 == 0x2d);
    if (iVar1 < local_10) {
      do {
        pcVar3 = pcVar2;
        pcVar2 = pcVar3 + 1;
      } while (*pcVar3 != '\0');
      pcVar3[-1] = '\0';
    }
    crt_fp_format_fixed(param_2,param_3,&local_14,1);
  }
  return;
}



/* __cfltcvt @ 00463b10 */

/* Library Function - Single Match
    __cfltcvt
   
   Library: Visual Studio 2003 Release */

errno_t __cdecl
__cfltcvt(double *arg,char *buffer,size_t sizeInBytes,int format,int precision,int caps)

{
  char *pcVar1;
  undefined1 *puVar2;
  
  if ((sizeInBytes == 0x65) || (sizeInBytes == 0x45)) {
    puVar2 = FUN_0046385e(arg,buffer,format,precision);
  }
  else {
    if (sizeInBytes == 0x66) {
      pcVar1 = FUN_00463981(arg,buffer,format);
      return (errno_t)pcVar1;
    }
    puVar2 = (undefined1 *)FUN_00463a7d(arg,buffer,format,precision);
  }
  return (errno_t)puVar2;
}



/* crt_str_shift_right @ 00463b61 */

/* CRT: shift string right by count (memmove) */

void __cdecl crt_str_shift_right(char *str,int count)

{
  size_t sVar1;
  
  if (count != 0) {
    sVar1 = _strlen(str);
    crt_memmove(str + count,str,sVar1 + 1);
  }
  return;
}



/* crt_msize @ 00463b86 */

/* CRT: allocation size */

size_t __cdecl crt_msize(void *ptr)

{
  byte *pbVar1;
  SIZE_T SVar2;
  size_t sVar3;
  void *local_30;
  byte *local_2c;
  uint local_28;
  size_t local_24;
  byte *local_20;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0046fac0;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  if (crt_heap_mode == 3) {
    ExceptionList = &local_14;
    crt_lock(9);
    local_8 = 0;
    local_20 = crt_sbh_find_region(ptr);
    if (local_20 != (byte *)0x0) {
      local_24 = *(int *)((int)ptr + -4) - 9;
    }
    sVar3 = local_24;
    local_8 = 0xffffffff;
    FUN_00463bf0();
    pbVar1 = local_20;
  }
  else {
    ExceptionList = &local_14;
    if (crt_heap_mode != 2) goto LAB_00463c44;
    ExceptionList = &local_14;
    crt_lock(9);
    local_8 = 1;
    local_2c = crt_sbh_find_block(ptr,&local_30,&local_28);
    if (local_2c != (byte *)0x0) {
      local_24 = (uint)*local_2c << 4;
    }
    sVar3 = local_24;
    local_8 = 0xffffffff;
    FUN_00463c6b();
    pbVar1 = local_2c;
  }
  if (pbVar1 != (byte *)0x0) {
    ExceptionList = local_14;
    return sVar3;
  }
LAB_00463c44:
  SVar2 = HeapSize(DAT_004da3a4,0,ptr);
  ExceptionList = local_14;
  return SVar2;
}



/* FUN_00463bf0 @ 00463bf0 */

/* [binja] int32_t sub_463bf0() */

int FUN_00463bf0(void)

{
  int iVar1;
  
  iVar1 = crt_unlock(9);
  return iVar1;
}



/* FUN_00463c6b @ 00463c6b */

/* [binja] int32_t sub_463c6b() */

int FUN_00463c6b(void)

{
  int iVar1;
  
  iVar1 = crt_unlock(9);
  return iVar1;
}



/* crt_isctype @ 00463c74 */

/* ctype classification (MBCS via GetStringTypeA/W) */

uint __thiscall crt_isctype(void *this,int c,uint mask)

{
  BOOL BVar1;
  int iVar2;
  undefined4 local_8;
  
  if (c + 1U < 0x101) {
    c._2_2_ = *(ushort *)(crt_ctype_table + c * 2);
  }
  else {
    if ((crt_ctype_table[(c >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      local_8 = CONCAT31((int3)((uint)this >> 8),(char)c) & 0xffff00ff;
      iVar2 = 1;
    }
    else {
      local_8._0_2_ = CONCAT11((char)c,(char)((uint)c >> 8));
      local_8 = CONCAT22((short)((uint)this >> 0x10),(undefined2)local_8) & 0xff00ffff;
      iVar2 = 2;
    }
    BVar1 = FUN_0046a8ce(1,(LPCSTR)&local_8,iVar2,(LPWORD)((int)&c + 2),0,0,1);
    if (BVar1 == 0) {
      return 0;
    }
  }
  return c._2_2_ & mask;
}



/* crt_lock_file @ 00463da5 */

/* lock a FILE stream (CRT lock or critical section) */

void __cdecl crt_lock_file(FILE *fp)

{
  if (((FILE *)0x47b3d7 < fp) && (fp < (FILE *)0x47b639)) {
    crt_lock(((int)&fp[-0x23d9f]._base >> 5) + 0x1c);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(fp + 1));
  return;
}



/* crt_lock_file2 @ 00463dd4 */

/* CRT: lock FILE by index or per-stream critical section */

void __cdecl crt_lock_file2(int stream_index,FILE *fp)

{
  if (stream_index < 0x14) {
    crt_lock(stream_index + 0x1c);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(fp + 1));
  return;
}



/* crt_unlock_file @ 00463df7 */

/* unlock a FILE stream (CRT lock or critical section) */

void __cdecl crt_unlock_file(FILE *fp)

{
  if (((FILE *)0x47b3d7 < fp) && (fp < (FILE *)0x47b639)) {
    crt_unlock(((int)&fp[-0x23d9f]._base >> 5) + 0x1c);
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(fp + 1));
  return;
}



/* crt_unlock_file2 @ 00463e26 */

/* CRT: unlock FILE by index or per-stream critical section */

void __cdecl crt_unlock_file2(int stream_index,FILE *fp)

{
  if (stream_index < 0x14) {
    crt_unlock(stream_index + 0x1c);
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(fp + 1));
  return;
}



/* crt_close @ 00463e49 */

/* CRT: close file handle with lock */

int __cdecl crt_close(int fd)

{
  int iVar1;
  int *piVar2;
  uint *puVar3;
  
  if (((uint)fd < DAT_004da4c0) &&
     ((*(byte *)((&DAT_004da3c0)[fd >> 5] + 4 + (fd & 0x1fU) * 0x24) & 1) != 0)) {
    crt_lock_fh(fd);
    iVar1 = crt_close_nolock(fd);
    crt_unlock_fh(fd);
    return iVar1;
  }
  piVar2 = crt_errno_ptr();
  *piVar2 = 9;
  puVar3 = crt_doserrno_ptr();
  *puVar3 = 0;
  return -1;
}



/* crt_close_nolock @ 00463ea6 */

/* CRT: close file handle without lock */

int __cdecl crt_close_nolock(int fd)

{
  void *pvVar1;
  void *pvVar2;
  WINBOOL WVar3;
  DWORD os_error;
  int iVar4;
  
  pvVar1 = crt_get_osfhandle(fd);
  if (pvVar1 != (void *)0xffffffff) {
    if ((fd == 1) || (fd == 2)) {
      pvVar1 = crt_get_osfhandle(2);
      pvVar2 = crt_get_osfhandle(1);
      if (pvVar2 == pvVar1) goto LAB_00463ef4;
    }
    pvVar1 = crt_get_osfhandle(fd);
    WVar3 = CloseHandle(pvVar1);
    if (WVar3 == 0) {
      os_error = GetLastError();
      goto LAB_00463ef6;
    }
  }
LAB_00463ef4:
  os_error = 0;
LAB_00463ef6:
  FUN_0046ac37(fd);
  *(undefined1 *)((&DAT_004da3c0)[fd >> 5] + 4 + (fd & 0x1fU) * 0x24) = 0;
  if (os_error == 0) {
    iVar4 = 0;
  }
  else {
    crt_dosmaperr(os_error);
    iVar4 = -1;
  }
  return iVar4;
}



/* __freebuf @ 00463f29 */

/* Library Function - Single Match
    __freebuf
   
   Library: Visual Studio 2003 Release */

void __cdecl __freebuf(FILE *_File)

{
  if (((_File->_flag & 0x83U) != 0) && ((_File->_flag & 8U) != 0)) {
    crt_free_base(_File->_base);
    *(ushort *)&_File->_flag = (ushort)_File->_flag & 0xfbf7;
    _File->_ptr = (char *)0x0;
    _File->_base = (char *)0x0;
    _File->_cnt = 0;
  }
  return;
}



/* crt_filbuf @ 00463f54 */

/* CRT: fill read buffer */

int __cdecl crt_filbuf(FILE *fp)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  undefined *puVar4;
  
  uVar2 = fp->_flag;
  if (((uVar2 & 0x83) != 0) && ((uVar2 & 0x40) == 0)) {
    if ((uVar2 & 2) == 0) {
      fp->_flag = uVar2 | 1;
      if ((uVar2 & 0x10c) == 0) {
        crt_file_buffer_init(fp);
      }
      else {
        fp->_ptr = fp->_base;
      }
      iVar3 = crt_read(fp->_file,fp->_base,fp->_bufsiz);
      fp->_cnt = iVar3;
      if ((iVar3 != 0) && (iVar3 != -1)) {
        if ((fp->_flag & 0x82U) == 0) {
          uVar2 = fp->_file;
          if (uVar2 == 0xffffffff) {
            puVar4 = &DAT_0047b930;
          }
          else {
            puVar4 = (undefined *)((&DAT_004da3c0)[(int)uVar2 >> 5] + (uVar2 & 0x1f) * 0x24);
          }
          if ((puVar4[4] & 0x82) == 0x82) {
            fp->_flag = fp->_flag | 0x2000;
          }
        }
        if (((fp->_bufsiz == 0x200) && ((fp->_flag & 8U) != 0)) && ((fp->_flag & 0x400U) == 0)) {
          fp->_bufsiz = 0x1000;
        }
        fp->_cnt = iVar3 + -1;
        bVar1 = *fp->_ptr;
        fp->_ptr = fp->_ptr + 1;
        return (uint)bVar1;
      }
      fp->_flag = fp->_flag | (-(uint)(iVar3 != 0) & 0x10) + 0x10;
      fp->_cnt = 0;
    }
    else {
      fp->_flag = uVar2 | 0x20;
    }
  }
  return -1;
}



/* crt_openfile @ 00464030 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* CRT: open file with mode string parsing */

FILE * __cdecl crt_openfile(char *filename,char *mode,int shflag,FILE *stream)

{
  char cVar1;
  bool bVar2;
  bool bVar3;
  bool bVar4;
  int iVar5;
  uint oflag;
  uint uVar6;
  
  bVar4 = false;
  bVar3 = false;
  cVar1 = *mode;
  if (cVar1 == 'a') {
    oflag = 0x109;
  }
  else {
    if (cVar1 == 'r') {
      oflag = 0;
      uVar6 = DAT_004d9b8c | 1;
      goto LAB_00464071;
    }
    if (cVar1 != 'w') {
      return (FILE *)0x0;
    }
    oflag = 0x301;
  }
  uVar6 = DAT_004d9b8c | 2;
LAB_00464071:
  bVar2 = true;
LAB_00464074:
  cVar1 = mode[1];
  mode = mode + 1;
  if ((cVar1 == '\0') || (!bVar2)) {
    iVar5 = crt_sopen(filename,oflag,shflag,0x1a4);
    if (iVar5 < 0) {
      return (FILE *)0x0;
    }
    _DAT_004d99d0 = _DAT_004d99d0 + 1;
    stream->_flag = uVar6;
    stream->_cnt = 0;
    stream->_ptr = (char *)0x0;
    stream->_base = (char *)0x0;
    stream->_tmpfname = (char *)0x0;
    stream->_file = iVar5;
    return stream;
  }
  if (cVar1 < 'U') {
    if (cVar1 == 'T') {
      if ((oflag & 0x1000) == 0) {
        oflag = oflag | 0x1000;
        goto LAB_00464074;
      }
    }
    else if (cVar1 == '+') {
      if ((oflag & 2) == 0) {
        oflag = oflag & 0xfffffffe | 2;
        uVar6 = uVar6 & 0xfffffffc | 0x80;
        goto LAB_00464074;
      }
    }
    else if (cVar1 == 'D') {
      if ((oflag & 0x40) == 0) {
        oflag = oflag | 0x40;
        goto LAB_00464074;
      }
    }
    else if (cVar1 == 'R') {
      if (!bVar3) {
        bVar3 = true;
        oflag = oflag | 0x10;
        goto LAB_00464074;
      }
    }
    else if ((cVar1 == 'S') && (!bVar3)) {
      bVar3 = true;
      oflag = oflag | 0x20;
      goto LAB_00464074;
    }
  }
  else {
    if (cVar1 == 'b') {
      if ((oflag & 0xc000) != 0) goto LAB_00464154;
      oflag = oflag | 0x8000;
      goto LAB_00464074;
    }
    if (cVar1 == 'c') {
      if (!bVar4) {
        bVar4 = true;
        uVar6 = uVar6 | 0x4000;
        goto LAB_00464074;
      }
    }
    else {
      if (cVar1 != 'n') {
        if ((cVar1 != 't') || ((oflag & 0xc000) != 0)) goto LAB_00464154;
        oflag = oflag | 0x4000;
        goto LAB_00464074;
      }
      if (!bVar4) {
        bVar4 = true;
        uVar6 = uVar6 & 0xffffbfff;
        goto LAB_00464074;
      }
    }
  }
LAB_00464154:
  bVar2 = false;
  goto LAB_00464074;
}



/* crt_getstream @ 004641a0 */

/* CRT: allocate FILE struct from pool */

FILE * crt_getstream(void)

{
  FILE *pFVar1;
  void *pvVar2;
  int iVar3;
  FILE *pFVar4;
  
  pFVar4 = (FILE *)0x0;
  crt_lock(2);
  iVar3 = 0;
  if (0 < DAT_004db4e0) {
    do {
      pFVar1 = *(FILE **)(DAT_004da4c4 + iVar3 * 4);
      if (pFVar1 == (FILE *)0x0) {
        iVar3 = iVar3 * 4;
        pvVar2 = _malloc(0x38);
        *(void **)(iVar3 + DAT_004da4c4) = pvVar2;
        if (*(int *)(iVar3 + DAT_004da4c4) != 0) {
          InitializeCriticalSection((LPCRITICAL_SECTION)(*(int *)(iVar3 + DAT_004da4c4) + 0x20));
          EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(iVar3 + DAT_004da4c4) + 0x20));
          pFVar4 = *(FILE **)(iVar3 + DAT_004da4c4);
LAB_00464244:
          if (pFVar4 != (FILE *)0x0) {
            pFVar4->_file = -1;
            pFVar4->_cnt = 0;
            pFVar4->_flag = 0;
            pFVar4->_base = (char *)0x0;
            pFVar4->_ptr = (char *)0x0;
            pFVar4->_tmpfname = (char *)0x0;
          }
        }
        break;
      }
      if ((pFVar1->_flag & 0x83) == 0) {
        crt_lock_file2(iVar3,pFVar1);
        pFVar1 = *(FILE **)(DAT_004da4c4 + iVar3 * 4);
        if ((pFVar1->_flag & 0x83) == 0) {
          pFVar4 = *(FILE **)(DAT_004da4c4 + iVar3 * 4);
          goto LAB_00464244;
        }
        crt_unlock_file2(iVar3,pFVar1);
      }
      iVar3 = iVar3 + 1;
    } while (iVar3 < DAT_004db4e0);
  }
  crt_unlock(2);
  return pFVar4;
}



/* crt_flsbuf @ 00464268 */

/* flush buffer or write single char (fputc core) */

int __cdecl crt_flsbuf(int ch,FILE *fp)

{
  uint uVar1;
  uint fd;
  char *buf;
  FILE *fp_00;
  byte bVar2;
  undefined3 extraout_var;
  undefined *puVar3;
  FILE *count;
  
  fp_00 = fp;
  uVar1 = fp->_flag;
  fd = fp->_file;
  if (((uVar1 & 0x82) == 0) || ((uVar1 & 0x40) != 0)) {
LAB_00464374:
    fp->_flag = uVar1 | 0x20;
  }
  else {
    if ((uVar1 & 1) != 0) {
      fp->_cnt = 0;
      if ((uVar1 & 0x10) == 0) goto LAB_00464374;
      fp->_ptr = fp->_base;
      fp->_flag = uVar1 & 0xfffffffe;
    }
    uVar1 = fp->_flag;
    fp->_cnt = 0;
    fp = (FILE *)0x0;
    fp_00->_flag = uVar1 & 0xffffffef | 2;
    if (((uVar1 & 0x10c) == 0) &&
       (((fp_00 != (FILE *)&DAT_0047b3f8 && (fp_00 != (FILE *)&DAT_0047b418)) ||
        (bVar2 = FUN_0046b08c(fd), CONCAT31(extraout_var,bVar2) == 0)))) {
      crt_file_buffer_init(fp_00);
    }
    if ((fp_00->_flag & 0x108) == 0) {
      count = (FILE *)0x1;
      fp = (FILE *)crt_write(fd,(char *)&ch,1);
    }
    else {
      buf = fp_00->_base;
      count = (FILE *)(fp_00->_ptr + -(int)buf);
      fp_00->_ptr = buf + 1;
      fp_00->_cnt = fp_00->_bufsiz + -1;
      if ((int)count < 1) {
        if (fd == 0xffffffff) {
          puVar3 = &DAT_0047b930;
        }
        else {
          puVar3 = (undefined *)((&DAT_004da3c0)[(int)fd >> 5] + (fd & 0x1f) * 0x24);
        }
        if ((puVar3[4] & 0x20) != 0) {
          crt_lseek(fd,0,2);
        }
      }
      else {
        fp = (FILE *)crt_write(fd,buf,(uint)count);
      }
      *fp_00->_base = (char)ch;
    }
    if (fp == count) {
      return ch & 0xff;
    }
    fp_00->_flag = fp_00->_flag | 0x20;
  }
  return -1;
}



/* crt_output @ 00464380 */

/* CRT: core printf formatter */

int __cdecl crt_output(FILE *stream,char *format,void *args)

{
  char *pcVar1;
  uint uVar2;
  WCHAR *pWVar3;
  void *pvVar4;
  short *psVar5;
  int *piVar6;
  int iVar7;
  int extraout_EDX;
  byte bVar8;
  int iVar9;
  WCHAR *pWVar10;
  undefined1 *puVar11;
  undefined8 uVar12;
  WCHAR local_250 [255];
  undefined1 local_51;
  undefined4 local_50;
  undefined4 local_4c;
  CHAR local_48 [4];
  undefined4 local_44;
  int local_40;
  int local_3c;
  int local_38;
  WCHAR *local_34;
  int local_30;
  int local_2c;
  int local_28;
  undefined8 local_24;
  char local_1a;
  char local_19;
  int local_18;
  undefined1 *local_14;
  WCHAR *local_10;
  int local_c;
  uint local_8;
  
  local_40 = 0;
  local_14 = (undefined1 *)0x0;
  bVar8 = *format;
  local_18 = 0;
  local_34 = (WCHAR *)0x0;
  pcVar1 = format;
  do {
    if ((bVar8 == 0) || (format = pcVar1 + 1, local_18 < 0)) {
      return local_18;
    }
    if (((char)bVar8 < ' ') || ('x' < (char)bVar8)) {
      uVar2 = 0;
    }
    else {
      uVar2 = (byte)"e+000"[(char)bVar8] & 0xf;
    }
    local_40 = (int)(char)(&DAT_0046fad8)[uVar2 * 8 + local_40] >> 4;
    switch(local_40) {
    case 0:
switchD_004643fc_caseD_0:
      local_30 = 0;
      if ((crt_ctype_table[(uint)bVar8 * 2 + 1] & 0x80) != 0) {
        crt_putc_nolock((int)(char)bVar8,stream,&local_18);
        bVar8 = *format;
        format = pcVar1 + 2;
      }
      crt_putc_nolock((int)(char)bVar8,stream,&local_18);
      break;
    case 1:
      local_c = -1;
      local_44 = 0;
      local_3c = 0;
      local_2c = 0;
      local_28 = 0;
      local_8 = 0;
      local_30 = 0;
      break;
    case 2:
      if (bVar8 == 0x20) {
        local_8 = local_8 | 2;
      }
      else if (bVar8 == 0x23) {
        local_8 = local_8 | 0x80;
      }
      else if (bVar8 == 0x2b) {
        local_8 = local_8 | 1;
      }
      else if (bVar8 == 0x2d) {
        local_8 = local_8 | 4;
      }
      else if (bVar8 == 0x30) {
        local_8 = local_8 | 8;
      }
      break;
    case 3:
      if (bVar8 == 0x2a) {
        local_2c = FUN_00464bbc((int *)&args);
        if (local_2c < 0) {
          local_8 = local_8 | 4;
          local_2c = -local_2c;
        }
      }
      else {
        local_2c = (char)bVar8 + -0x30 + local_2c * 10;
      }
      break;
    case 4:
      local_c = 0;
      break;
    case 5:
      if (bVar8 == 0x2a) {
        local_c = FUN_00464bbc((int *)&args);
        if (local_c < 0) {
          local_c = -1;
        }
      }
      else {
        local_c = (char)bVar8 + -0x30 + local_c * 10;
      }
      break;
    case 6:
      if (bVar8 == 0x49) {
        if ((*format != 0x36) || (pcVar1[2] != '4')) {
          local_40 = 0;
          goto switchD_004643fc_caseD_0;
        }
        format = pcVar1 + 3;
        local_8 = local_8 | 0x8000;
      }
      else if (bVar8 == 0x68) {
        local_8 = local_8 | 0x20;
      }
      else if (bVar8 == 0x6c) {
        local_8 = local_8 | 0x10;
      }
      else if (bVar8 == 0x77) {
        local_8 = local_8 | 0x800;
      }
      break;
    case 7:
      pWVar10 = local_10;
      if ((char)bVar8 < 'h') {
        if ((char)bVar8 < 'e') {
          if ((char)bVar8 < 'Y') {
            if (bVar8 != 0x58) {
              if (bVar8 == 0x43) {
                if ((local_8 & 0x830) == 0) {
                  local_8 = local_8 | 0x800;
                }
                goto LAB_00464651;
              }
              if ((bVar8 != 0x45) && (bVar8 != 0x47)) {
                if (bVar8 == 0x53) {
                  if ((local_8 & 0x830) == 0) {
                    local_8 = local_8 | 0x800;
                  }
                  goto LAB_004645c1;
                }
                goto LAB_004649d4;
              }
              local_44 = 1;
              bVar8 = bVar8 + 0x20;
              goto LAB_00464623;
            }
LAB_00464830:
            local_38 = 7;
LAB_00464837:
            local_14 = (undefined1 *)0x10;
            if ((local_8 & 0x80) != 0) {
              local_1a = '0';
              local_19 = (char)local_38 + 'Q';
              local_28 = 2;
            }
            goto LAB_004648a0;
          }
          if (bVar8 == 0x5a) {
            psVar5 = (short *)FUN_00464bbc((int *)&args);
            if ((psVar5 == (short *)0x0) ||
               (pWVar10 = *(WCHAR **)(psVar5 + 2), pWVar10 == (WCHAR *)0x0)) {
              local_10 = (WCHAR *)PTR_DAT_0047b658;
              pWVar10 = (WCHAR *)PTR_DAT_0047b658;
              goto LAB_004647b1;
            }
            if ((local_8 & 0x800) == 0) {
              local_30 = 0;
              local_14 = (undefined1 *)(int)*psVar5;
            }
            else {
              local_30 = 1;
              local_14 = (undefined1 *)((uint)(int)*psVar5 >> 1);
            }
          }
          else if (bVar8 == 99) {
LAB_00464651:
            if ((local_8 & 0x810) == 0) {
              iVar9 = FUN_00464bbc((int *)&args);
              local_250[0]._0_1_ = (undefined1)iVar9;
              local_14 = (undefined1 *)0x1;
            }
            else {
              pvVar4 = FUN_00464bd9((int *)&args);
              local_14 = (undefined1 *)FUN_0046b0b5((LPSTR)local_250,(WCHAR)pvVar4);
              if ((int)local_14 < 0) {
                local_3c = 1;
              }
            }
            pWVar10 = local_250;
          }
          else if (bVar8 == 100) goto LAB_00464895;
        }
        else {
LAB_00464623:
          local_8 = local_8 | 0x40;
          pWVar10 = local_250;
          pWVar3 = local_250;
          if (local_c < 0) {
            local_c = 6;
          }
          else if (local_c == 0) {
            if (bVar8 == 0x67) {
              local_c = 1;
            }
          }
          else {
            if (0x200 < local_c) {
              local_c = 0x200;
            }
            if ((0xa3 < local_c) &&
               (local_10 = local_250, local_34 = _malloc(local_c + 0x15d), pWVar10 = local_34,
               pWVar3 = local_34, local_34 == (WCHAR *)0x0)) {
              local_c = 0xa3;
              pWVar10 = local_250;
              pWVar3 = local_10;
            }
          }
          local_10 = pWVar3;
          local_50 = *(undefined4 *)args;
          local_4c = *(undefined4 *)((int)args + 4);
          args = (void *)((int)args + 8);
          (*(code *)PTR_FUN_0047b1a8)(&local_50,pWVar10,(int)(char)bVar8,local_c,local_44);
          uVar2 = local_8 & 0x80;
          if ((uVar2 != 0) && (local_c == 0)) {
            (*(code *)PTR_FUN_0047b1b4)(pWVar10);
          }
          if ((bVar8 == 0x67) && (uVar2 == 0)) {
            (*(code *)PTR_FUN_0047b1ac)(pWVar10);
          }
          if ((char)*pWVar10 == '-') {
            local_8 = local_8 | 0x100;
            pWVar10 = (WCHAR *)((int)pWVar10 + 1);
            local_10 = pWVar10;
          }
LAB_004647b1:
          local_14 = (undefined1 *)_strlen((char *)pWVar10);
          pWVar10 = local_10;
        }
LAB_004649d4:
        local_10 = pWVar10;
        uVar2 = local_8;
        if (local_3c == 0) {
          if ((local_8 & 0x40) != 0) {
            if ((local_8 & 0x100) == 0) {
              if ((local_8 & 1) == 0) {
                if ((local_8 & 2) == 0) goto LAB_00464a0c;
                local_1a = ' ';
              }
              else {
                local_1a = '+';
              }
            }
            else {
              local_1a = '-';
            }
            local_28 = 1;
          }
LAB_00464a0c:
          iVar9 = (local_2c - local_28) - (int)local_14;
          if ((local_8 & 0xc) == 0) {
            crt_putc_repeat_nolock(0x20,iVar9,stream,&local_18);
          }
          crt_putc_buffer_nolock(&local_1a,local_28,stream,&local_18);
          if (((uVar2 & 8) != 0) && ((uVar2 & 4) == 0)) {
            crt_putc_repeat_nolock(0x30,iVar9,stream,&local_18);
          }
          if ((local_30 == 0) || (puVar11 = local_14, pWVar10 = local_10, (int)local_14 < 1)) {
            crt_putc_buffer_nolock((char *)local_10,(int)local_14,stream,&local_18);
          }
          else {
            do {
              puVar11 = puVar11 + -1;
              iVar7 = FUN_0046b0b5(local_48,*pWVar10);
              if (iVar7 < 1) break;
              crt_putc_buffer_nolock(local_48,iVar7,stream,&local_18);
              pWVar10 = pWVar10 + 1;
            } while (puVar11 != (undefined1 *)0x0);
          }
          if ((local_8 & 4) != 0) {
            crt_putc_repeat_nolock(0x20,iVar9,stream,&local_18);
          }
        }
      }
      else {
        if (bVar8 == 0x69) {
LAB_00464895:
          local_8 = local_8 | 0x40;
LAB_00464899:
          local_14 = (undefined1 *)0xa;
LAB_004648a0:
          if ((local_8 & 0x8000) == 0) {
            if ((local_8 & 0x20) == 0) {
              if ((local_8 & 0x40) == 0) {
                uVar2 = FUN_00464bbc((int *)&args);
                iVar9 = 0;
                goto LAB_004648f3;
              }
              uVar2 = FUN_00464bbc((int *)&args);
            }
            else if ((local_8 & 0x40) == 0) {
              uVar2 = FUN_00464bbc((int *)&args);
              uVar2 = uVar2 & 0xffff;
            }
            else {
              iVar9 = FUN_00464bbc((int *)&args);
              uVar2 = (uint)(short)iVar9;
            }
            iVar9 = (int)uVar2 >> 0x1f;
          }
          else {
            uVar2 = FUN_00464bc9((int *)&args);
            iVar9 = extraout_EDX;
          }
LAB_004648f3:
          if ((((local_8 & 0x40) == 0) || (0 < iVar9)) || (-1 < iVar9)) {
            local_24 = CONCAT44(iVar9,uVar2);
          }
          else {
            local_8 = local_8 | 0x100;
            local_24 = CONCAT44(-(iVar9 + (uint)(uVar2 != 0)),-uVar2);
          }
          if ((local_8 & 0x8000) == 0) {
            local_24 = local_24 & 0xffffffff;
          }
          if (local_c < 0) {
            local_c = 1;
          }
          else {
            local_8 = local_8 & 0xfffffff7;
            if (0x200 < local_c) {
              local_c = 0x200;
            }
          }
          if ((uint)local_24 == 0 && local_24._4_4_ == 0) {
            local_28 = 0;
          }
          local_10 = (WCHAR *)&local_51;
          while( true ) {
            puVar11 = local_14;
            iVar9 = local_c + -1;
            if ((local_c < 1) && ((uint)local_24 == 0 && local_24._4_4_ == 0)) break;
            uVar2 = (int)local_14 >> 0x1f;
            local_c = iVar9;
            uVar12 = __aullrem((uint)local_24,local_24._4_4_,(uint)local_14,uVar2);
            iVar9 = (int)uVar12 + 0x30;
            local_24 = __aulldiv((uint)local_24,local_24._4_4_,(uint)puVar11,uVar2);
            if (0x39 < iVar9) {
              iVar9 = iVar9 + local_38;
            }
            pWVar10 = (WCHAR *)((int)local_10 + -1);
            *(char *)local_10 = (char)iVar9;
            local_10 = pWVar10;
          }
          iVar7 = -(int)local_10;
          local_14 = &local_51 + iVar7;
          pWVar10 = (WCHAR *)((int)local_10 + 1);
          local_c = iVar9;
          if (((local_8 & 0x200) != 0) &&
             ((*(char *)pWVar10 != '0' || (local_14 == (undefined1 *)0x0)))) {
            *(char *)local_10 = '0';
            local_14 = (undefined1 *)((int)&local_50 + iVar7);
            pWVar10 = local_10;
          }
          goto LAB_004649d4;
        }
        if (bVar8 != 0x6e) {
          if (bVar8 == 0x6f) {
            local_14 = (undefined1 *)0x8;
            if ((local_8 & 0x80) != 0) {
              local_8 = local_8 | 0x200;
            }
            goto LAB_004648a0;
          }
          if (bVar8 == 0x70) {
            local_c = 8;
            goto LAB_00464830;
          }
          if (bVar8 == 0x73) {
LAB_004645c1:
            iVar9 = 0x7fffffff;
            if (local_c != -1) {
              iVar9 = local_c;
            }
            pWVar3 = (WCHAR *)FUN_00464bbc((int *)&args);
            if ((local_8 & 0x810) == 0) {
              pWVar10 = pWVar3;
              if (pWVar3 == (WCHAR *)0x0) {
                pWVar3 = (WCHAR *)PTR_DAT_0047b658;
                pWVar10 = (WCHAR *)PTR_DAT_0047b658;
              }
              for (; (iVar9 != 0 && ((char)*pWVar3 != '\0')); pWVar3 = (WCHAR *)((int)pWVar3 + 1)) {
                iVar9 = iVar9 + -1;
              }
              local_14 = (undefined1 *)((int)pWVar3 - (int)pWVar10);
            }
            else {
              if (pWVar3 == (WCHAR *)0x0) {
                pWVar3 = (WCHAR *)PTR_DAT_0047b65c;
              }
              local_30 = 1;
              for (pWVar10 = pWVar3; (iVar9 != 0 && (*pWVar10 != L'\0')); pWVar10 = pWVar10 + 1) {
                iVar9 = iVar9 + -1;
              }
              local_14 = (undefined1 *)((int)pWVar10 - (int)pWVar3 >> 1);
              pWVar10 = pWVar3;
            }
            goto LAB_004649d4;
          }
          if (bVar8 != 0x75) {
            if (bVar8 != 0x78) goto LAB_004649d4;
            local_38 = 0x27;
            goto LAB_00464837;
          }
          goto LAB_00464899;
        }
        piVar6 = (int *)FUN_00464bbc((int *)&args);
        if ((local_8 & 0x20) == 0) {
          *piVar6 = local_18;
        }
        else {
          *(undefined2 *)piVar6 = (undefined2)local_18;
        }
        local_3c = 1;
      }
      if (local_34 != (WCHAR *)0x0) {
        crt_free_base(local_34);
        local_34 = (WCHAR *)0x0;
      }
    }
    bVar8 = *format;
    pcVar1 = format;
  } while( true );
}



/* crt_putc_nolock @ 00464b1e */

/* putc_nolock-style helper (increments count or sets -1 on error) */

void __cdecl crt_putc_nolock(int ch,FILE *fp,int *count)

{
  int *piVar1;
  uint uVar2;
  
  piVar1 = &fp->_cnt;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 < 0) {
    uVar2 = crt_flsbuf(ch,fp);
  }
  else {
    *fp->_ptr = (char)ch;
    fp->_ptr = fp->_ptr + 1;
    uVar2 = ch & 0xff;
  }
  if (uVar2 == 0xffffffff) {
    *count = -1;
    return;
  }
  *count = *count + 1;
  return;
}



/* crt_putc_repeat_nolock @ 00464b53 */

/* emit repeated chars via crt_putc_nolock (printf padding helper) */

void __cdecl crt_putc_repeat_nolock(int ch,int count,FILE *fp,int *out_count)

{
  do {
    if (count < 1) {
      return;
    }
    count = count + -1;
    crt_putc_nolock(ch,fp,out_count);
  } while (*out_count != -1);
  return;
}



/* crt_putc_buffer_nolock @ 00464b84 */

/* emit buffer chars via crt_putc_nolock (printf string helper) */

void __cdecl crt_putc_buffer_nolock(char *buf,int count,FILE *fp,int *out_count)

{
  char cVar1;
  
  do {
    if (count < 1) {
      return;
    }
    count = count + -1;
    cVar1 = *buf;
    buf = buf + 1;
    crt_putc_nolock((int)cVar1,fp,out_count);
  } while (*out_count != -1);
  return;
}



/* FUN_00464bbc @ 00464bbc */

/* [binja] int32_t sub_464bbc(int32_t* arg1) */

int __cdecl FUN_00464bbc(int *arg1)

{
  *arg1 = *arg1 + 4;
  return *(int *)(*arg1 + -4);
}



/* FUN_00464bc9 @ 00464bc9 */

/* [binja] int32_t sub_464bc9(int32_t* arg1) */

int __cdecl FUN_00464bc9(int *arg1)

{
  *arg1 = *arg1 + 8;
  return *(int *)(*arg1 + -8);
}



/* FUN_00464bd9 @ 00464bd9 */

/* [binja] void* sub_464bd9(int32_t* arg1) */

void * __cdecl FUN_00464bd9(int *arg1)

{
  *arg1 = *arg1 + 4;
  return (void *)CONCAT22((short)((uint)*arg1 >> 0x10),*(undefined2 *)(*arg1 + -4));
}



/* FUN_00464be7 @ 00464be7 */

void __thiscall FUN_00464be7(void *this,uint *param_1,byte *param_2)

{
  uint uVar1;
  int iVar2;
  int unaff_EDI;
  uint uVar3;
  short local_1c [6];
  int local_10;
  undefined4 uStack_c;
  int local_8;
  
  uVar3 = 0;
  uVar1 = crt_fp_parse(this,local_1c,(ushort *)&local_8,(int *)param_2,(byte *)0x0,0,0,0,unaff_EDI);
  if ((uVar1 & 4) == 0) {
    iVar2 = FUN_0046a318(local_1c,&local_10);
    if (((uVar1 & 2) != 0) || (iVar2 == 1)) {
      uVar3 = 0x80;
    }
    if (((uVar1 & 1) != 0) || (iVar2 == 2)) {
      uVar3 = uVar3 | 0x100;
    }
  }
  else {
    uVar3 = 0x200;
    local_10 = 0;
    uStack_c = 0;
  }
  *param_1 = uVar3;
  *(ulonglong *)(param_1 + 4) = CONCAT44(uStack_c,local_10);
  param_1[1] = local_8 - (int)param_2;
  return;
}



/* _strlen @ 00464c70 */

/* Library Function - Single Match
    _strlen
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

size_t __cdecl _strlen(char *_Str)

{
  uint uVar1;
  uint *puVar2;
  uint *puVar3;
  
  puVar2 = (uint *)_Str;
  do {
    if (((uint)puVar2 & 3) == 0) goto LAB_00464c90;
    uVar1 = *puVar2;
    puVar2 = (uint *)((int)puVar2 + 1);
  } while ((char)uVar1 != '\0');
LAB_00464cc3:
  return (size_t)((int)puVar2 + (-1 - (int)_Str));
LAB_00464c90:
  do {
    do {
      puVar3 = puVar2;
      puVar2 = puVar3 + 1;
    } while (((*puVar3 ^ 0xffffffff ^ *puVar3 + 0x7efefeff) & 0x81010100) == 0);
    uVar1 = *puVar3;
    if ((char)uVar1 == '\0') {
      return (int)puVar3 - (int)_Str;
    }
    if ((char)(uVar1 >> 8) == '\0') {
      return (size_t)((int)puVar3 + (1 - (int)_Str));
    }
    if ((uVar1 & 0xff0000) == 0) {
      return (size_t)((int)puVar3 + (2 - (int)_Str));
    }
  } while ((uVar1 & 0xff000000) != 0);
  goto LAB_00464cc3;
}



/* FUN_004650d0 @ 004650d0 */

float10 __fastcall
FUN_004650d0(undefined4 param_1,int param_2,undefined2 param_3,undefined4 param_4,undefined4 param_5
            ,undefined4 param_6,undefined4 param_7,undefined4 param_8)

{
  float10 in_ST0;
  int local_24;
  undefined4 uStack_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  undefined4 local_14;
  undefined4 local_10;
  double dStack_c;
  
  local_14 = param_7;
  local_10 = param_8;
  dStack_c = (double)in_ST0;
  uStack_1c = param_5;
  uStack_18 = param_6;
  uStack_20 = param_1;
  FUN_0046c4cb(param_2,&local_24,(uint)&param_3);
  return (float10)dStack_c;
}



/* __startOneArgErrorHandling @ 004650e7 */

/* Library Function - Single Match
    __startOneArgErrorHandling
   
   Library: Visual Studio */

float10 __fastcall
__startOneArgErrorHandling
          (undefined4 param_1,uint param_2,ushort param_3,undefined4 param_4,undefined4 param_5,
          undefined4 param_6)

{
  float10 in_ST0;
  int local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  double local_c;
  
  local_c = (double)in_ST0;
  local_1c = param_5;
  local_18 = param_6;
  local_20 = param_1;
  FUN_0046c4cb(param_2,&local_24,(uint)&param_3);
  return (float10)local_c;
}



/* FUN_00465130 @ 00465130 */

undefined1  [10] FUN_00465130(void)

{
  float10 in_ST0;
  float10 fVar1;
  undefined1 auVar2 [10];
  
  fVar1 = (float10)f2xm1(-(ROUND(in_ST0) - in_ST0));
  auVar2 = (undefined1  [10])fscale((float10)1 + fVar1,ROUND(in_ST0));
  return auVar2;
}



/* FUN_00465145 @ 00465145 */

void FUN_00465145(void)

{
  return;
}



/* FUN_0046515c @ 0046515c */

undefined4 FUN_0046515c(void)

{
  uint in_EAX;
  
  if ((in_EAX & 0x80000) != 0) {
    return 7;
  }
  return 1;
}



/* __fload_withFB @ 00465175 */

/* Library Function - Single Match
    __fload_withFB
   
   Library: Visual Studio */

uint __fastcall __fload_withFB(undefined4 param_1,int param_2)

{
  uint uVar1;
  
  uVar1 = *(uint *)(param_2 + 4) & 0x7ff00000;
  if (uVar1 != 0x7ff00000) {
    return uVar1;
  }
  return *(uint *)(param_2 + 4);
}



/* FUN_004651b8 @ 004651b8 */

uint __cdecl FUN_004651b8(undefined4 param_1,uint param_2)

{
  if ((param_2 & 0x7ff00000) != 0x7ff00000) {
    return param_2 & 0x7ff00000;
  }
  return param_2;
}



/* FUN_004651ce @ 004651ce */

void FUN_004651ce(void)

{
  return;
}



/* __math_exit @ 004651db */

/* Library Function - Single Match
    __math_exit
   
   Library: Visual Studio */

void __fastcall
__math_exit(undefined4 param_1,uint param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5
           )

{
  ushort in_FPUStatusWord;
  ushort unaff_retaddr;
  
  if (((unaff_retaddr != 0x27f) && ((unaff_retaddr & 0x20) != 0)) &&
     ((in_FPUStatusWord & 0x20) != 0)) {
    __startOneArgErrorHandling(param_1,param_2,unaff_retaddr,param_3,param_4,param_5);
    return;
  }
  return;
}



/* FUN_00465219 @ 00465219 */

void __fastcall
FUN_00465219(undefined4 param_1,uint param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined4 param_6,undefined4 param_7)

{
  ushort in_FPUStatusWord;
  float10 in_ST0;
  ushort unaff_retaddr;
  uint uStack_4;
  
  uStack_4 = (uint)((ulonglong)(double)in_ST0 >> 0x20);
  if (((ulonglong)(double)in_ST0 & 0x7ff0000000000000) == 0) {
    fscale(in_ST0,(float10)1536.0);
  }
  else if ((uStack_4 & 0x7ff00000) == 0x7ff00000) {
    fscale(in_ST0,(float10)-1536.0);
  }
  else if (((unaff_retaddr == 0x27f) || ((unaff_retaddr & 0x20) != 0)) ||
          ((in_FPUStatusWord & 0x20) == 0)) {
    return;
  }
  if (param_2 == 0x1d) {
    FUN_004650d0(param_1,0x1d,unaff_retaddr,param_3,param_4,param_5,param_6,param_7);
    return;
  }
  __startOneArgErrorHandling(param_1,param_2,unaff_retaddr,param_3,param_4,param_5);
  return;
}



/* FUN_004652bc @ 004652bc */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_4652bc(double arg1, int32_t arg2, int32_t arg3, double* arg4) */

int __cdecl FUN_004652bc(double arg1,int arg2,int arg3,double *arg4)

{
  double dVar1;
  double dVar2;
  int iVar3;
  
  dVar1 = arg1;
  if (arg1 < 0.0) {
    dVar1 = -arg1;
  }
  dVar2 = _DAT_0047dbb8;
  if (arg3 == 0x7ff00000) {
    if (arg2 != 0) {
LAB_00465347:
      if (arg1._4_4_ == 0x7ff00000) {
        if (arg1._0_4_ != 0) {
          return 0;
        }
        if (0.0 < _arg2) goto LAB_004653e2;
        if (_arg2 < 0.0) goto LAB_00465379;
      }
      else {
        if (arg1 != -INFINITY) {
          return 0;
        }
        iVar3 = FUN_004653ec(_arg2);
        if (0.0 < _arg2) {
          dVar2 = _DAT_0047dbb8;
          if (iVar3 == 1) {
            dVar2 = -_DAT_0047dbb8;
          }
          goto LAB_004653e2;
        }
        if (_arg2 < 0.0) {
          dVar2 = _DAT_0047dbd8;
          if (iVar3 != 1) {
            dVar2 = 0.0;
          }
          goto LAB_004653e2;
        }
      }
      dVar2 = 1.0;
      goto LAB_004653e2;
    }
    if (1.0 < dVar1) goto LAB_004653e2;
    if (1.0 <= dVar1) {
LAB_0046530c:
      *arg4 = _DAT_0047dbc0;
      return 1;
    }
  }
  else {
    if ((arg3 != -0x100000) || (arg2 != 0)) goto LAB_00465347;
    if (dVar1 <= 1.0) {
      if (1.0 <= dVar1) goto LAB_0046530c;
      goto LAB_004653e2;
    }
  }
LAB_00465379:
  dVar2 = 0.0;
LAB_004653e2:
  *arg4 = dVar2;
  return 0;
}



/* FUN_004653ec @ 004653ec */

undefined4 __cdecl FUN_004653ec(double param_1)

{
  uint uVar1;
  float10 fVar2;
  undefined4 uVar3;
  
  uVar1 = FUN_0046325f(SUB84(param_1,0),(uint)((ulonglong)param_1 >> 0x20));
  if ((uVar1 & 0x90) == 0) {
    fVar2 = __frnd(param_1);
    if ((double)fVar2 == param_1) {
      fVar2 = __frnd(param_1 / 2.0);
      if (fVar2 == (float10)(param_1 / 2.0)) {
        uVar3 = 2;
      }
      else {
        uVar3 = 1;
      }
      return uVar3;
    }
  }
  return 0;
}



/* crt_mt_init @ 00465451 */

/* CRT thread init (TLS + locks) */

undefined4 crt_mt_init(void)

{
  DWORD *lpTlsValue;
  WINBOOL WVar1;
  DWORD DVar2;
  
  crt_init_locks();
  DAT_0047b6f0 = TlsAlloc();
  if (DAT_0047b6f0 != 0xffffffff) {
    lpTlsValue = crt_calloc(1,0x74);
    if (lpTlsValue != (DWORD *)0x0) {
      WVar1 = TlsSetValue(DAT_0047b6f0,lpTlsValue);
      if (WVar1 != 0) {
        crt_init_thread_data(lpTlsValue);
        DVar2 = GetCurrentThreadId();
        lpTlsValue[1] = 0xffffffff;
        *lpTlsValue = DVar2;
        return 1;
      }
    }
  }
  return 0;
}



/* crt_init_thread_data @ 004654a5 */

/* CRT: initialize per-thread data defaults */

void __cdecl crt_init_thread_data(void *ptd)

{
  *(undefined **)((int)ptd + 0x50) = &DAT_0047ba60;
  *(undefined4 *)((int)ptd + 0x14) = 1;
  return;
}



/* crt_get_thread_data @ 004654b8 */

/* CRT per-thread data accessor */

DWORD * crt_get_thread_data(void)

{
  DWORD dwErrCode;
  DWORD *lpTlsValue;
  WINBOOL WVar1;
  DWORD DVar2;
  
  dwErrCode = GetLastError();
  lpTlsValue = TlsGetValue(DAT_0047b6f0);
  if (lpTlsValue == (DWORD *)0x0) {
    lpTlsValue = crt_calloc(1,0x74);
    if (lpTlsValue != (DWORD *)0x0) {
      WVar1 = TlsSetValue(DAT_0047b6f0,lpTlsValue);
      if (WVar1 != 0) {
        crt_init_thread_data(lpTlsValue);
        DVar2 = GetCurrentThreadId();
        lpTlsValue[1] = 0xffffffff;
        *lpTlsValue = DVar2;
        goto LAB_00465513;
      }
    }
    __amsg_exit(0x10);
  }
LAB_00465513:
  SetLastError(dwErrCode);
  return lpTlsValue;
}



/* crt_free_thread_data @ 0046551f */

/* frees CRT per-thread data */

void __cdecl crt_free_thread_data(undefined *param_1)

{
  if (DAT_0047b6f0 != 0xffffffff) {
    if ((param_1 != (undefined *)0x0) ||
       (param_1 = TlsGetValue(DAT_0047b6f0), param_1 != (undefined *)0x0)) {
      if (*(void **)(param_1 + 0x24) != (void *)0x0) {
        crt_free_base(*(void **)(param_1 + 0x24));
      }
      if (*(void **)(param_1 + 0x28) != (void *)0x0) {
        crt_free_base(*(void **)(param_1 + 0x28));
      }
      if (*(void **)(param_1 + 0x30) != (void *)0x0) {
        crt_free_base(*(void **)(param_1 + 0x30));
      }
      if (*(void **)(param_1 + 0x38) != (void *)0x0) {
        crt_free_base(*(void **)(param_1 + 0x38));
      }
      if (*(void **)(param_1 + 0x40) != (void *)0x0) {
        crt_free_base(*(void **)(param_1 + 0x40));
      }
      if (*(void **)(param_1 + 0x44) != (void *)0x0) {
        crt_free_base(*(void **)(param_1 + 0x44));
      }
      if (*(undefined **)(param_1 + 0x50) != &DAT_0047ba60) {
        crt_free_base(*(undefined **)(param_1 + 0x50));
      }
      crt_free_base(param_1);
    }
    TlsSetValue(DAT_0047b6f0,(LPVOID)0x0);
    return;
  }
  return;
}



/* crt_commit @ 004655bf */

/* CRT: commit file buffers to disk */

int __cdecl crt_commit(int fd)

{
  void *hFile;
  WINBOOL WVar1;
  DWORD DVar2;
  uint *puVar3;
  int *piVar4;
  int iVar5;
  
  if (DAT_004da4c0 <= (uint)fd) {
LAB_00465640:
    piVar4 = crt_errno_ptr();
    *piVar4 = 9;
    return -1;
  }
  iVar5 = (fd & 0x1fU) * 0x24;
  if ((*(byte *)((&DAT_004da3c0)[fd >> 5] + 4 + iVar5) & 1) == 0) goto LAB_00465640;
  crt_lock_fh(fd);
  if ((*(byte *)((&DAT_004da3c0)[fd >> 5] + 4 + iVar5) & 1) != 0) {
    hFile = crt_get_osfhandle(fd);
    WVar1 = FlushFileBuffers(hFile);
    if (WVar1 == 0) {
      DVar2 = GetLastError();
    }
    else {
      DVar2 = 0;
    }
    iVar5 = 0;
    if (DVar2 == 0) goto LAB_00465635;
    puVar3 = crt_doserrno_ptr();
    *puVar3 = DVar2;
  }
  piVar4 = crt_errno_ptr();
  *piVar4 = 9;
  iVar5 = -1;
LAB_00465635:
  crt_unlock_fh(fd);
  return iVar5;
}



/* crt_write @ 00465652 */

/* CRT: write handle with lock */

int __cdecl crt_write(int fd,char *buf,uint count)

{
  int iVar1;
  int *piVar2;
  uint *puVar3;
  
  if (((uint)fd < DAT_004da4c0) &&
     ((*(byte *)((&DAT_004da3c0)[fd >> 5] + 4 + (fd & 0x1fU) * 0x24) & 1) != 0)) {
    crt_lock_fh(fd);
    iVar1 = crt_write_nolock(fd,buf,count);
    crt_unlock_fh(fd);
    return iVar1;
  }
  piVar2 = crt_errno_ptr();
  *piVar2 = 9;
  puVar3 = crt_doserrno_ptr();
  *puVar3 = 0;
  return -1;
}



/* crt_write_nolock @ 004656b7 */

/* CRT: write handle (no lock), text-mode CRLF translation */

int __cdecl crt_write_nolock(int fd,char *buf,uint count)

{
  char *pcVar1;
  char cVar2;
  int iVar3;
  char *pcVar4;
  WINBOOL WVar5;
  int *piVar6;
  uint *puVar7;
  char local_418 [1028];
  int local_14;
  DWORD local_10;
  DWORD local_c;
  char *local_8;
  
  local_c = 0;
  local_14 = 0;
  if (count == 0) {
LAB_004656d0:
    iVar3 = 0;
  }
  else {
    piVar6 = &DAT_004da3c0 + (fd >> 5);
    iVar3 = (fd & 0x1fU) * 0x24;
    if ((*(byte *)(*piVar6 + 4 + iVar3) & 0x20) != 0) {
      crt_lseek_nolock(fd,0,2);
    }
    if ((*(byte *)((undefined4 *)(*piVar6 + iVar3) + 1) & 0x80) == 0) {
      WVar5 = WriteFile(*(HANDLE *)(*piVar6 + iVar3),buf,count,&local_10,(LPOVERLAPPED)0x0);
      if (WVar5 == 0) {
        fd = GetLastError();
      }
      else {
        local_c = local_10;
        fd = 0;
      }
LAB_0046579f:
      if (local_c != 0) {
        return local_c - local_14;
      }
      if (fd == 0) goto LAB_00465811;
      if (fd == 5) {
        piVar6 = crt_errno_ptr();
        *piVar6 = 9;
        puVar7 = crt_doserrno_ptr();
        *puVar7 = 5;
      }
      else {
        crt_dosmaperr(fd);
      }
    }
    else {
      local_8 = buf;
      fd = 0;
      if (count != 0) {
        do {
          pcVar4 = local_418;
          do {
            if (count <= (uint)((int)local_8 - (int)buf)) break;
            pcVar1 = local_8 + 1;
            cVar2 = *local_8;
            local_8 = pcVar1;
            if (cVar2 == '\n') {
              local_14 = local_14 + 1;
              *pcVar4 = '\r';
              pcVar4 = pcVar4 + 1;
            }
            *pcVar4 = cVar2;
            pcVar4 = pcVar4 + 1;
          } while ((int)pcVar4 - (int)local_418 < 0x400);
          WVar5 = WriteFile(*(HANDLE *)(*piVar6 + iVar3),local_418,(int)pcVar4 - (int)local_418,
                            &local_10,(LPOVERLAPPED)0x0);
          if (WVar5 == 0) {
            fd = GetLastError();
            goto LAB_0046579f;
          }
          local_c = local_c + local_10;
          if (((int)local_10 < (int)pcVar4 - (int)local_418) ||
             (count <= (uint)((int)local_8 - (int)buf))) goto LAB_0046579f;
        } while( true );
      }
LAB_00465811:
      if (((*(byte *)(*piVar6 + 4 + iVar3) & 0x40) != 0) && (*buf == '\x1a')) goto LAB_004656d0;
      piVar6 = crt_errno_ptr();
      *piVar6 = 0x1c;
      puVar7 = crt_doserrno_ptr();
      *puVar7 = 0;
    }
    iVar3 = -1;
  }
  return iVar3;
}



/* crt_init_locks @ 00465842 */

/* initializes CRT critical sections */

void crt_init_locks(void)

{
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_0047b738);
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_0047b728);
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_0047b718);
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_0047b6f8);
  return;
}



/* crt_lock @ 0046586b */

/* CRT lock table enter */

void __cdecl crt_lock(int param_1)

{
  int *piVar1;
  LPCRITICAL_SECTION lpCriticalSection;
  
  piVar1 = (int *)(&DAT_0047b6f4 + param_1 * 4);
  if (*(int *)(&DAT_0047b6f4 + param_1 * 4) == 0) {
    lpCriticalSection = _malloc(0x18);
    if (lpCriticalSection == (LPCRITICAL_SECTION)0x0) {
      __amsg_exit(0x11);
    }
    crt_lock(0x11);
    if (*piVar1 == 0) {
      InitializeCriticalSection(lpCriticalSection);
      *piVar1 = (int)lpCriticalSection;
    }
    else {
      crt_free_base(lpCriticalSection);
    }
    crt_unlock(0x11);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)*piVar1);
  return;
}



/* crt_unlock @ 004658cc */

/* CRT lock table leave */

void __cdecl crt_unlock(int param_1)

{
  LeaveCriticalSection(*(LPCRITICAL_SECTION *)(&DAT_0047b6f4 + param_1 * 4));
  return;
}



/* crt_bufcpy @ 004658f0 */

/* CRT: buffer copy helper (overlap-safe) */

void * __cdecl crt_bufcpy(void *dst,void *src,size_t size)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  if ((src < dst) && (dst < (void *)(size + (int)src))) {
    puVar3 = (undefined4 *)((size - 4) + (int)src);
    puVar4 = (undefined4 *)((size - 4) + (int)dst);
    if (((uint)puVar4 & 3) == 0) {
      uVar1 = size >> 2;
      uVar2 = size & 3;
      if (7 < uVar1) {
        for (; uVar1 != 0; uVar1 = uVar1 - 1) {
          *puVar4 = *puVar3;
          puVar3 = puVar3 + -1;
          puVar4 = puVar4 + -1;
        }
        switch(uVar2) {
        case 0:
          return dst;
        case 2:
          goto switchD_00465aa7_caseD_2;
        case 3:
          goto switchD_00465aa7_caseD_3;
        }
        goto switchD_00465aa7_caseD_1;
      }
    }
    else {
      switch(size) {
      case 0:
        goto switchD_00465aa7_caseD_0;
      case 1:
        goto switchD_00465aa7_caseD_1;
      case 2:
        goto switchD_00465aa7_caseD_2;
      case 3:
        goto switchD_00465aa7_caseD_3;
      default:
        uVar1 = size - ((uint)puVar4 & 3);
        switch((uint)puVar4 & 3) {
        case 1:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          puVar3 = (undefined4 *)((int)puVar3 + -1);
          uVar1 = uVar1 >> 2;
          puVar4 = (undefined4 *)((int)puVar4 - 1);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return dst;
            case 2:
              goto switchD_00465aa7_caseD_2;
            case 3:
              goto switchD_00465aa7_caseD_3;
            }
            goto switchD_00465aa7_caseD_1;
          }
          break;
        case 2:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          puVar3 = (undefined4 *)((int)puVar3 + -2);
          puVar4 = (undefined4 *)((int)puVar4 - 2);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return dst;
            case 2:
              goto switchD_00465aa7_caseD_2;
            case 3:
              goto switchD_00465aa7_caseD_3;
            }
            goto switchD_00465aa7_caseD_1;
          }
          break;
        case 3:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
          puVar3 = (undefined4 *)((int)puVar3 + -3);
          puVar4 = (undefined4 *)((int)puVar4 - 3);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return dst;
            case 2:
              goto switchD_00465aa7_caseD_2;
            case 3:
              goto switchD_00465aa7_caseD_3;
            }
            goto switchD_00465aa7_caseD_1;
          }
        }
      }
    }
    switch(uVar1) {
    case 7:
      puVar4[7 - uVar1] = puVar3[7 - uVar1];
    case 6:
      puVar4[6 - uVar1] = puVar3[6 - uVar1];
    case 5:
      puVar4[5 - uVar1] = puVar3[5 - uVar1];
    case 4:
      puVar4[4 - uVar1] = puVar3[4 - uVar1];
    case 3:
      puVar4[3 - uVar1] = puVar3[3 - uVar1];
    case 2:
      puVar4[2 - uVar1] = puVar3[2 - uVar1];
    case 1:
      puVar4[1 - uVar1] = puVar3[1 - uVar1];
      puVar3 = puVar3 + -uVar1;
      puVar4 = puVar4 + -uVar1;
    }
    switch(uVar2) {
    case 1:
switchD_00465aa7_caseD_1:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      return dst;
    case 2:
switchD_00465aa7_caseD_2:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      return dst;
    case 3:
switchD_00465aa7_caseD_3:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
      return dst;
    }
switchD_00465aa7_caseD_0:
    return dst;
  }
  puVar3 = dst;
  if (((uint)dst & 3) == 0) {
    uVar1 = size >> 2;
    uVar2 = size & 3;
    if (7 < uVar1) {
      for (; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar3 = *(undefined4 *)src;
        src = (undefined4 *)((int)src + 4);
        puVar3 = puVar3 + 1;
      }
      switch(uVar2) {
      case 0:
        return dst;
      case 2:
        goto switchD_00465925_caseD_2;
      case 3:
        goto switchD_00465925_caseD_3;
      }
      goto switchD_00465925_caseD_1;
    }
  }
  else {
    switch(size) {
    case 0:
      goto switchD_00465925_caseD_0;
    case 1:
      goto switchD_00465925_caseD_1;
    case 2:
      goto switchD_00465925_caseD_2;
    case 3:
      goto switchD_00465925_caseD_3;
    default:
      uVar1 = (size - 4) + ((uint)dst & 3);
      switch((uint)dst & 3) {
      case 1:
        uVar2 = uVar1 & 3;
        *(undefined1 *)dst = *(undefined1 *)src;
        *(undefined1 *)((int)dst + 1) = *(undefined1 *)((int)src + 1);
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)dst + 2) = *(undefined1 *)((int)src + 2);
        src = (void *)((int)src + 3);
        puVar3 = (undefined4 *)((int)dst + 3);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *(undefined4 *)src;
            src = (undefined4 *)((int)src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return dst;
          case 2:
            goto switchD_00465925_caseD_2;
          case 3:
            goto switchD_00465925_caseD_3;
          }
          goto switchD_00465925_caseD_1;
        }
        break;
      case 2:
        uVar2 = uVar1 & 3;
        *(undefined1 *)dst = *(undefined1 *)src;
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)dst + 1) = *(undefined1 *)((int)src + 1);
        src = (void *)((int)src + 2);
        puVar3 = (undefined4 *)((int)dst + 2);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *(undefined4 *)src;
            src = (undefined4 *)((int)src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return dst;
          case 2:
            goto switchD_00465925_caseD_2;
          case 3:
            goto switchD_00465925_caseD_3;
          }
          goto switchD_00465925_caseD_1;
        }
        break;
      case 3:
        uVar2 = uVar1 & 3;
        *(undefined1 *)dst = *(undefined1 *)src;
        src = (void *)((int)src + 1);
        uVar1 = uVar1 >> 2;
        puVar3 = (undefined4 *)((int)dst + 1);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *(undefined4 *)src;
            src = (undefined4 *)((int)src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return dst;
          case 2:
            goto switchD_00465925_caseD_2;
          case 3:
            goto switchD_00465925_caseD_3;
          }
          goto switchD_00465925_caseD_1;
        }
      }
    }
  }
  switch(uVar1) {
  case 7:
    puVar3[uVar1 - 7] = *(undefined4 *)((int)src + (uVar1 - 7) * 4);
  case 6:
    puVar3[uVar1 - 6] = *(undefined4 *)((int)src + (uVar1 - 6) * 4);
  case 5:
    puVar3[uVar1 - 5] = *(undefined4 *)((int)src + (uVar1 - 5) * 4);
  case 4:
    puVar3[uVar1 - 4] = *(undefined4 *)((int)src + (uVar1 - 4) * 4);
  case 3:
    puVar3[uVar1 - 3] = *(undefined4 *)((int)src + (uVar1 - 3) * 4);
  case 2:
    puVar3[uVar1 - 2] = *(undefined4 *)((int)src + (uVar1 - 2) * 4);
  case 1:
    puVar3[uVar1 - 1] = *(undefined4 *)((int)src + (uVar1 - 1) * 4);
    src = (void *)((int)src + uVar1 * 4);
    puVar3 = puVar3 + uVar1;
  }
  switch(uVar2) {
  case 1:
switchD_00465925_caseD_1:
    *(undefined1 *)puVar3 = *(undefined1 *)src;
    return dst;
  case 2:
switchD_00465925_caseD_2:
    *(undefined1 *)puVar3 = *(undefined1 *)src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)src + 1);
    return dst;
  case 3:
switchD_00465925_caseD_3:
    *(undefined1 *)puVar3 = *(undefined1 *)src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)src + 1);
    *(undefined1 *)((int)puVar3 + 2) = *(undefined1 *)((int)src + 2);
    return dst;
  }
switchD_00465925_caseD_0:
  return dst;
}



/* crt_strcpy @ 00465c30 */

/* CRT strcpy implementation (word copy + null detection) */

char * __cdecl crt_strcpy(char *dst,char *src)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  
  puVar4 = (uint *)dst;
  while (((uint)src & 3) != 0) {
    bVar1 = (byte)*(uint *)src;
    uVar3 = (uint)bVar1;
    src = (char *)((int)src + 1);
    if (bVar1 == 0) goto LAB_00465d18;
    *(byte *)puVar4 = bVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
  }
  do {
    uVar2 = *(uint *)src;
    uVar3 = *(uint *)src;
    src = (char *)((int)src + 4);
    if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
      if ((char)uVar3 == '\0') {
LAB_00465d18:
        *(byte *)puVar4 = (byte)uVar3;
        return dst;
      }
      if ((char)(uVar3 >> 8) == '\0') {
        *(short *)puVar4 = (short)uVar3;
        return dst;
      }
      if ((uVar3 & 0xff0000) == 0) {
        *(short *)puVar4 = (short)uVar3;
        *(byte *)((int)puVar4 + 2) = 0;
        return dst;
      }
      if ((uVar3 & 0xff000000) == 0) {
        *puVar4 = uVar3;
        return dst;
      }
    }
    *puVar4 = uVar3;
    puVar4 = puVar4 + 1;
  } while( true );
}



/* crt_strcat @ 00465c40 */

/* CRT strcat implementation (seek end, then copy) */

char * __cdecl crt_strcat(char *dst,char *src)

{
  byte bVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  uint *puVar5;
  
  puVar3 = (uint *)dst;
  do {
    if (((uint)puVar3 & 3) == 0) goto LAB_00465c5c;
    uVar4 = *puVar3;
    puVar3 = (uint *)((int)puVar3 + 1);
  } while ((byte)uVar4 != 0);
  goto LAB_00465c8f;
  while( true ) {
    if ((uVar4 & 0xff0000) == 0) {
      puVar5 = (uint *)((int)puVar5 + 2);
      goto joined_r0x00465cab;
    }
    if ((uVar4 & 0xff000000) == 0) break;
LAB_00465c5c:
    do {
      puVar5 = puVar3;
      puVar3 = puVar5 + 1;
    } while (((*puVar5 ^ 0xffffffff ^ *puVar5 + 0x7efefeff) & 0x81010100) == 0);
    uVar4 = *puVar5;
    if ((char)uVar4 == '\0') goto joined_r0x00465cab;
    if ((char)(uVar4 >> 8) == '\0') {
      puVar5 = (uint *)((int)puVar5 + 1);
      goto joined_r0x00465cab;
    }
  }
LAB_00465c8f:
  puVar5 = (uint *)((int)puVar3 + -1);
joined_r0x00465cab:
  do {
    if (((uint)src & 3) == 0) {
      do {
        uVar2 = *(uint *)src;
        uVar4 = *(uint *)src;
        src = (char *)((int)src + 4);
        if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
          if ((char)uVar4 == '\0') {
LAB_00465d18:
            *(byte *)puVar5 = (byte)uVar4;
            return dst;
          }
          if ((char)(uVar4 >> 8) == '\0') {
            *(short *)puVar5 = (short)uVar4;
            return dst;
          }
          if ((uVar4 & 0xff0000) == 0) {
            *(short *)puVar5 = (short)uVar4;
            *(byte *)((int)puVar5 + 2) = 0;
            return dst;
          }
          if ((uVar4 & 0xff000000) == 0) {
            *puVar5 = uVar4;
            return dst;
          }
        }
        *puVar5 = uVar4;
        puVar5 = puVar5 + 1;
      } while( true );
    }
    bVar1 = (byte)*(uint *)src;
    uVar4 = (uint)bVar1;
    src = (char *)((int)src + 1);
    if (bVar1 == 0) goto LAB_00465d18;
    *(byte *)puVar5 = bVar1;
    puVar5 = (uint *)((int)puVar5 + 1);
  } while( true );
}



/* crt_dosmaperr @ 00465d20 */

/* map Win32 error to errno/doserrno */

void __cdecl crt_dosmaperr(uint os_error)

{
  uint *puVar1;
  undefined **ppuVar2;
  int *piVar3;
  int iVar4;
  
  puVar1 = crt_doserrno_ptr();
  iVar4 = 0;
  *puVar1 = os_error;
  ppuVar2 = (undefined **)&crt_dosmaperr_table;
  do {
    if ((undefined *)os_error == *ppuVar2) {
      piVar3 = crt_errno_ptr();
      *piVar3 = *(int *)(iVar4 * 8 + 0x47b7c4);
      return;
    }
    ppuVar2 = ppuVar2 + 2;
    iVar4 = iVar4 + 1;
  } while (ppuVar2 < &PTR_crt_terminate_0047b928);
  if ((0x12 < os_error) && (os_error < 0x25)) {
    piVar3 = crt_errno_ptr();
    *piVar3 = 0xd;
    return;
  }
  if ((0xbb < os_error) && (os_error < 0xcb)) {
    piVar3 = crt_errno_ptr();
    *piVar3 = 8;
    return;
  }
  piVar3 = crt_errno_ptr();
  *piVar3 = 0x16;
  return;
}



/* crt_errno_ptr @ 00465d93 */

/* CRT errno pointer accessor (thread-local) */

int * crt_errno_ptr(void)

{
  DWORD *pDVar1;
  
  pDVar1 = crt_get_thread_data();
  return (int *)(pDVar1 + 2);
}



/* crt_doserrno_ptr @ 00465d9c */

/* CRT doserrno pointer accessor (thread-local) */

uint * crt_doserrno_ptr(void)

{
  DWORD *pDVar1;
  
  pDVar1 = crt_get_thread_data();
  return pDVar1 + 3;
}



/* crt_mktime @ 00465da5 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* CRT: convert date/time to timestamp (mktime) */

long __cdecl crt_mktime(int year,int month,int day,int hour,int min,int sec,int dst)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  uint uVar3;
  int iVar4;
  int local_28 [2];
  int local_20;
  int local_18;
  uint local_14;
  int local_c;
  
  uVar3 = year - 0x76c;
  if (((int)uVar3 < 0x46) || (0x8a < (int)uVar3)) {
    iVar2 = -1;
  }
  else {
    iVar4 = *(int *)(&DAT_0047df54 + month * 4) + day;
    if (((uVar3 & 3) == 0) && (2 < month)) {
      iVar4 = iVar4 + 1;
    }
    FUN_0046c5ad();
    local_20 = hour;
    local_18 = month + -1;
    iVar2 = ((hour + (uVar3 * 0x16d + iVar4 + (year + -0x76d >> 2)) * 0x18) * 0x3c + min) * 0x3c +
            DAT_0047de70 + 0x7c558180 + sec;
    if ((dst == 1) ||
       (((dst == -1 && (DAT_0047de74 != 0)) &&
        (local_14 = uVar3, local_c = iVar4, bVar1 = FUN_0046c862(local_28),
        CONCAT31(extraout_var,bVar1) != 0)))) {
      iVar2 = iVar2 + _DAT_0047de78;
    }
  }
  return iVar2;
}



/* FUN_00465f2d @ 00465f2d */

void FUN_00465f2d(int param_1)

{
  __local_unwind2(*(int *)(param_1 + 0x18),*(int *)(param_1 + 0x1c));
  return;
}



/* crt_terminate @ 00465f48 */

/* invokes the per-thread terminate handler then aborts */

void crt_terminate(void)

{
  DWORD *pDVar1;
  void *pvStack_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0046fb98;
  puStack_10 = &LAB_00465e70;
  pvStack_14 = ExceptionList;
  local_8 = 0;
  ExceptionList = &pvStack_14;
  pDVar1 = crt_get_thread_data();
  if (pDVar1[0x18] != 0) {
    local_8 = 1;
    pDVar1 = crt_get_thread_data();
    (*(code *)pDVar1[0x18])();
  }
  local_8 = 0xffffffff;
  FUN_0046cb6f();
  return;
}



/* crt_invalid_parameter_noinfo_noreturn @ 00465fa9 */

/* invokes invalid-parameter handler (if set) then terminates */

void crt_invalid_parameter_noinfo_noreturn(void)

{
  void *pvStack_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0046fbb0;
  puStack_10 = &LAB_00465e70;
  pvStack_14 = ExceptionList;
  ExceptionList = &pvStack_14;
  if (PTR_crt_terminate_0047b928 != (undefined *)0x0) {
    local_8 = 1;
    ExceptionList = &pvStack_14;
    (*(code *)PTR_crt_terminate_0047b928)();
  }
  local_8 = 0xffffffff;
  crt_terminate();
  return;
}



/* crt_read @ 00465fff */

/* CRT: read handle with lock */

int __cdecl crt_read(int fd,char *buf,uint count)

{
  int iVar1;
  int *piVar2;
  uint *puVar3;
  
  if (((uint)fd < DAT_004da4c0) &&
     ((*(byte *)((&DAT_004da3c0)[fd >> 5] + 4 + (fd & 0x1fU) * 0x24) & 1) != 0)) {
    crt_lock_fh(fd);
    iVar1 = crt_read_nolock(fd,buf,count);
    crt_unlock_fh(fd);
    return iVar1;
  }
  piVar2 = crt_errno_ptr();
  *piVar2 = 9;
  puVar3 = crt_doserrno_ptr();
  *puVar3 = 0;
  return -1;
}



/* crt_read_nolock @ 00466064 */

/* CRT: read handle (no lock), CRLF translation */

int __cdecl crt_read_nolock(int fd,char *buf,uint count)

{
  byte *pbVar1;
  char cVar2;
  byte bVar3;
  WINBOOL WVar4;
  DWORD DVar5;
  int *piVar6;
  uint *puVar7;
  char *pcVar8;
  int iVar9;
  DWORD local_10;
  char *local_c;
  char local_5;
  
  local_c = (char *)0x0;
  if (count != 0) {
    piVar6 = &DAT_004da3c0 + (fd >> 5);
    iVar9 = (fd & 0x1fU) * 0x24;
    bVar3 = *(byte *)((&DAT_004da3c0)[fd >> 5] + iVar9 + 4);
    if ((bVar3 & 2) == 0) {
      pcVar8 = buf;
      if (((bVar3 & 0x48) != 0) &&
         (cVar2 = *(char *)((&DAT_004da3c0)[fd >> 5] + iVar9 + 5), cVar2 != '\n')) {
        count = count - 1;
        *buf = cVar2;
        pcVar8 = buf + 1;
        local_c = (char *)0x1;
        *(undefined1 *)(*piVar6 + 5 + iVar9) = 10;
      }
      WVar4 = ReadFile(*(HANDLE *)(*piVar6 + iVar9),pcVar8,count,&local_10,(LPOVERLAPPED)0x0);
      if (WVar4 == 0) {
        DVar5 = GetLastError();
        if (DVar5 == 5) {
          piVar6 = crt_errno_ptr();
          *piVar6 = 9;
          puVar7 = crt_doserrno_ptr();
          *puVar7 = 5;
        }
        else {
          if (DVar5 == 0x6d) {
            return 0;
          }
          crt_dosmaperr(DVar5);
        }
        return -1;
      }
      bVar3 = *(byte *)(*piVar6 + 4 + iVar9);
      if ((bVar3 & 0x80) == 0) {
        return (int)local_c + local_10;
      }
      if ((local_10 == 0) || (*buf != '\n')) {
        bVar3 = bVar3 & 0xfb;
      }
      else {
        bVar3 = bVar3 | 4;
      }
      *(byte *)(*piVar6 + 4 + iVar9) = bVar3;
      count = (uint)buf;
      local_c = buf + (int)local_c + local_10;
      pcVar8 = buf;
      if (buf < local_c) {
        do {
          cVar2 = *(char *)count;
          if (cVar2 == '\x1a') {
            pbVar1 = (byte *)(*piVar6 + 4 + iVar9);
            bVar3 = *pbVar1;
            if ((bVar3 & 0x40) == 0) {
              *pbVar1 = bVar3 | 2;
            }
            break;
          }
          if (cVar2 == '\r') {
            if (count < local_c + -1) {
              if (*(char *)(count + 1) == '\n') {
                count = count + 2;
                goto LAB_004661ef;
              }
              *pcVar8 = '\r';
              pcVar8 = pcVar8 + 1;
              count = count + 1;
            }
            else {
              count = count + 1;
              WVar4 = ReadFile(*(HANDLE *)(*piVar6 + iVar9),&local_5,1,&local_10,(LPOVERLAPPED)0x0);
              if (((WVar4 == 0) && (DVar5 = GetLastError(), DVar5 != 0)) || (local_10 == 0)) {
LAB_00466209:
                *pcVar8 = '\r';
LAB_0046620c:
                pcVar8 = pcVar8 + 1;
              }
              else if ((*(byte *)(*piVar6 + 4 + iVar9) & 0x48) == 0) {
                if ((pcVar8 == buf) && (local_5 == '\n')) {
LAB_004661ef:
                  *pcVar8 = '\n';
                  goto LAB_0046620c;
                }
                crt_lseek_nolock(fd,-1,1);
                if (local_5 != '\n') goto LAB_00466209;
              }
              else {
                if (local_5 == '\n') goto LAB_004661ef;
                *pcVar8 = '\r';
                pcVar8 = pcVar8 + 1;
                *(char *)(*piVar6 + 5 + iVar9) = local_5;
              }
            }
          }
          else {
            *pcVar8 = cVar2;
            pcVar8 = pcVar8 + 1;
            count = count + 1;
          }
        } while (count < local_c);
      }
      return (int)pcVar8 - (int)buf;
    }
  }
  return 0;
}



/* crt_io_init @ 0046623d */

/* CRT file handle table init */

void crt_io_init(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  DWORD DVar4;
  HANDLE hFile;
  UINT *pUVar5;
  int iVar6;
  uint uVar7;
  UINT UVar8;
  UINT UVar9;
  _STARTUPINFOA local_4c;
  byte *local_8;
  
  puVar2 = _malloc(0x480);
  if (puVar2 == (undefined4 *)0x0) {
    __amsg_exit(0x1b);
  }
  DAT_004da4c0 = 0x20;
  DAT_004da3c0 = puVar2;
  for (; puVar2 < DAT_004da3c0 + 0x120; puVar2 = puVar2 + 9) {
    *(undefined1 *)(puVar2 + 1) = 0;
    *puVar2 = 0xffffffff;
    puVar2[2] = 0;
    *(undefined1 *)((int)puVar2 + 5) = 10;
  }
  GetStartupInfoA(&local_4c);
  if ((local_4c.cbReserved2 != 0) && ((UINT *)local_4c.lpReserved2 != (UINT *)0x0)) {
    UVar8 = *(UINT *)local_4c.lpReserved2;
    pUVar5 = (UINT *)((int)local_4c.lpReserved2 + 4);
    local_8 = (byte *)((int)pUVar5 + UVar8);
    if (0x7ff < (int)UVar8) {
      UVar8 = 0x800;
    }
    UVar9 = UVar8;
    if ((int)DAT_004da4c0 < (int)UVar8) {
      puVar2 = &DAT_004da3c4;
      do {
        puVar3 = _malloc(0x480);
        UVar9 = DAT_004da4c0;
        if (puVar3 == (undefined4 *)0x0) break;
        DAT_004da4c0 = DAT_004da4c0 + 0x20;
        *puVar2 = puVar3;
        puVar1 = puVar3;
        for (; puVar3 < puVar1 + 0x120; puVar3 = puVar3 + 9) {
          *(undefined1 *)(puVar3 + 1) = 0;
          *puVar3 = 0xffffffff;
          puVar3[2] = 0;
          *(undefined1 *)((int)puVar3 + 5) = 10;
          puVar1 = (undefined4 *)*puVar2;
        }
        puVar2 = puVar2 + 1;
        UVar9 = UVar8;
      } while ((int)DAT_004da4c0 < (int)UVar8);
    }
    uVar7 = 0;
    if (0 < (int)UVar9) {
      do {
        if (((*(HANDLE *)local_8 != (HANDLE)0xffffffff) && ((*pUVar5 & 1) != 0)) &&
           (((*pUVar5 & 8) != 0 || (DVar4 = GetFileType(*(HANDLE *)local_8), DVar4 != 0)))) {
          puVar2 = (undefined4 *)((int)(&DAT_004da3c0)[(int)uVar7 >> 5] + (uVar7 & 0x1f) * 0x24);
          *puVar2 = *(undefined4 *)local_8;
          *(byte *)(puVar2 + 1) = (byte)*pUVar5;
        }
        local_8 = local_8 + 4;
        uVar7 = uVar7 + 1;
        pUVar5 = (UINT *)((int)pUVar5 + 1);
      } while ((int)uVar7 < (int)UVar9);
    }
  }
  iVar6 = 0;
  do {
    puVar2 = DAT_004da3c0 + iVar6 * 9;
    if (DAT_004da3c0[iVar6 * 9] == -1) {
      *(undefined1 *)(puVar2 + 1) = 0x81;
      if (iVar6 == 0) {
        DVar4 = 0xfffffff6;
      }
      else {
        DVar4 = 0xfffffff5 - (iVar6 != 1);
      }
      hFile = GetStdHandle(DVar4);
      if ((hFile != (HANDLE)0xffffffff) && (DVar4 = GetFileType(hFile), DVar4 != 0)) {
        *puVar2 = hFile;
        if ((DVar4 & 0xff) != 2) {
          if ((DVar4 & 0xff) == 3) {
            *(byte *)(puVar2 + 1) = *(byte *)(puVar2 + 1) | 8;
          }
          goto LAB_004663e2;
        }
      }
      *(byte *)(puVar2 + 1) = *(byte *)(puVar2 + 1) | 0x40;
    }
    else {
      *(byte *)(puVar2 + 1) = *(byte *)(puVar2 + 1) | 0x80;
    }
LAB_004663e2:
    iVar6 = iVar6 + 1;
    if (2 < iVar6) {
      SetHandleCount(DAT_004da4c0);
      return;
    }
  } while( true );
}



/* crt_lseek @ 004663f9 */

/* lseek wrapper (locks file handle, then SetFilePointer) */

long __cdecl crt_lseek(int fd,long offset,int origin)

{
  long lVar1;
  int *piVar2;
  uint *puVar3;
  
  if (((uint)fd < DAT_004da4c0) &&
     ((*(byte *)((&DAT_004da3c0)[fd >> 5] + 4 + (fd & 0x1fU) * 0x24) & 1) != 0)) {
    crt_lock_fh(fd);
    lVar1 = crt_lseek_nolock(fd,offset,origin);
    crt_unlock_fh(fd);
    return lVar1;
  }
  piVar2 = crt_errno_ptr();
  *piVar2 = 9;
  puVar3 = crt_doserrno_ptr();
  *puVar3 = 0;
  return -1;
}



/* crt_lseek_nolock @ 0046645e */

/* lseek implementation via SetFilePointer */

long __cdecl crt_lseek_nolock(int fd,long offset,int origin)

{
  byte *pbVar1;
  void *hFile;
  int *piVar2;
  DWORD DVar3;
  uint os_error;
  
  hFile = crt_get_osfhandle(fd);
  if (hFile == (void *)0xffffffff) {
    piVar2 = crt_errno_ptr();
    *piVar2 = 9;
  }
  else {
    DVar3 = SetFilePointer(hFile,offset,(PLONG)0x0,origin);
    if (DVar3 == 0xffffffff) {
      os_error = GetLastError();
    }
    else {
      os_error = 0;
    }
    if (os_error == 0) {
      pbVar1 = (byte *)((&DAT_004da3c0)[fd >> 5] + 4 + (fd & 0x1fU) * 0x24);
      *pbVar1 = *pbVar1 & 0xfd;
      return DVar3;
    }
    crt_dosmaperr(os_error);
  }
  return -1;
}



/* crt_lcmap_string @ 004664d1 */

/* CRT: LCMapString wrapper with multibyte/Unicode handling */

int __cdecl
crt_lcmap_string(uint locale,uint flags,char *src,int srclen,ushort *dst,int dstlen,uint codepage,
                int use_cp)

{
  int iVar1;
  int iVar2;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0046fbd0;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  if (DAT_004d9a64 == 0) {
    ExceptionList = &local_14;
    iVar1 = LCMapStringW(0,0x100,L"",1,(LPWSTR)0x0,0);
    if (iVar1 == 0) {
      iVar1 = LCMapStringA(0,0x100,&DAT_004ab1a8,1,(LPSTR)0x0,0);
      if (iVar1 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      DAT_004d9a64 = 2;
    }
    else {
      DAT_004d9a64 = 1;
    }
  }
  if (0 < srclen) {
    srclen = FUN_0046e5ec(src,srclen);
  }
  if (DAT_004d9a64 == 2) {
    iVar1 = LCMapStringA(locale,flags,src,srclen,(LPSTR)dst,dstlen);
    ExceptionList = local_14;
    return iVar1;
  }
  if (DAT_004d9a64 == 1) {
    if (codepage == 0) {
      codepage = DAT_004d9a5c;
    }
    iVar1 = MultiByteToWideChar(codepage,(-(uint)(use_cp != 0) & 8) + 1,src,srclen,(LPWSTR)0x0,0);
    if (iVar1 != 0) {
      local_8 = 0;
      crt_chkstk();
      local_8 = 0xffffffff;
      if ((&stack0x00000000 != (undefined1 *)0x3c) &&
         (iVar2 = MultiByteToWideChar(codepage,1,src,srclen,(LPWSTR)&stack0xffffffc4,iVar1),
         iVar2 != 0)) {
        iVar2 = LCMapStringW(locale,flags,(LPCWSTR)&stack0xffffffc4,iVar1,(LPWSTR)0x0,0);
        if (iVar2 != 0) {
          if ((flags & 0x400) == 0) {
            local_8 = 1;
            crt_chkstk();
            local_8 = 0xffffffff;
            if (&stack0x00000000 == (undefined1 *)0x3c) {
              ExceptionList = local_14;
              return 0;
            }
            iVar1 = LCMapStringW(locale,flags,(LPCWSTR)&stack0xffffffc4,iVar1,
                                 (LPWSTR)&stack0xffffffc4,iVar2);
            if (iVar1 == 0) {
              ExceptionList = local_14;
              return 0;
            }
            if (dstlen == 0) {
              dstlen = 0;
              dst = (ushort *)0x0;
            }
            iVar2 = WideCharToMultiByte(codepage,0x220,(LPCWCH)&stack0xffffffc4,iVar2,(LPSTR)dst,
                                        dstlen,(LPCCH)0x0,(LPBOOL)0x0);
            iVar1 = iVar2;
          }
          else {
            if (dstlen == 0) {
              ExceptionList = local_14;
              return iVar2;
            }
            if (dstlen < iVar2) {
              ExceptionList = local_14;
              return 0;
            }
            iVar1 = LCMapStringW(locale,flags,(LPCWSTR)&stack0xffffffc4,iVar1,(LPWSTR)dst,dstlen);
          }
          if (iVar1 != 0) {
            ExceptionList = local_14;
            return iVar2;
          }
        }
      }
    }
  }
  ExceptionList = local_14;
  return 0;
}



/* FUN_004666f5 @ 004666f5 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_4666f5(int32_t* arg1) */

int __cdecl FUN_004666f5(int *arg1)

{
  byte bVar1;
  undefined3 extraout_var;
  int iVar2;
  void *pvVar3;
  
  bVar1 = FUN_0046b08c(arg1[4]);
  if (CONCAT31(extraout_var,bVar1) == 0) {
    return 0;
  }
  if (arg1 == (int *)&DAT_0047b3f8) {
    iVar2 = 0;
  }
  else {
    if (arg1 != (int *)&DAT_0047b418) {
      return 0;
    }
    iVar2 = 1;
  }
  _DAT_004d99d0 = _DAT_004d99d0 + 1;
  if ((*(ushort *)(arg1 + 3) & 0x10c) != 0) {
    return 0;
  }
  if ((&DAT_004d9a68)[iVar2] == 0) {
    pvVar3 = _malloc(0x1000);
    (&DAT_004d9a68)[iVar2] = pvVar3;
    if (pvVar3 == (void *)0x0) {
      arg1[2] = (int)(arg1 + 5);
      *arg1 = (int)(arg1 + 5);
      arg1[6] = 2;
      arg1[1] = 2;
      goto LAB_00466771;
    }
  }
  iVar2 = (&DAT_004d9a68)[iVar2];
  arg1[6] = 0x1000;
  arg1[2] = iVar2;
  *arg1 = iVar2;
  arg1[1] = 0x1000;
LAB_00466771:
  *(ushort *)(arg1 + 3) = *(ushort *)(arg1 + 3) | 0x1102;
  return 1;
}



/* FUN_00466782 @ 00466782 */

void __cdecl FUN_00466782(int param_1,int *param_2)

{
  if ((param_1 != 0) && ((*(byte *)((int)param_2 + 0xd) & 0x10) != 0)) {
    crt_flushbuf((FILE *)param_2);
    *(byte *)((int)param_2 + 0xd) = *(byte *)((int)param_2 + 0xd) & 0xee;
    param_2[6] = 0;
    *param_2 = 0;
    param_2[2] = 0;
  }
  return;
}



/* crt_calloc @ 004667ac */

/* CRT: allocate zeroed block (count*size) */

void * __cdecl crt_calloc(uint count,uint size)

{
  int iVar1;
  uint size_00;
  uint uVar2;
  uint _Size;
  LPVOID local_24;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0046fbe8;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  size_00 = count * size;
  uVar2 = size_00;
  ExceptionList = &local_14;
  if (size_00 < 0xffffffe1) {
    if (size_00 == 0) {
      uVar2 = 1;
    }
    uVar2 = uVar2 + 0xf & 0xfffffff0;
    ExceptionList = &local_14;
  }
  do {
    local_24 = (LPVOID)0x0;
    if (uVar2 < 0xffffffe1) {
      if (crt_heap_mode == 3) {
        if (size_00 <= DAT_004da3a0) {
          crt_lock(9);
          local_8 = 0;
          local_24 = crt_sbh_alloc(size_00);
          local_8 = 0xffffffff;
          FUN_00466845();
          _Size = size_00;
          if (local_24 == (void *)0x0) goto LAB_00466899;
LAB_00466888:
          _memset(local_24,0,_Size);
        }
LAB_00466894:
        if (local_24 != (LPVOID)0x0) {
          ExceptionList = local_14;
          return local_24;
        }
      }
      else {
        if ((crt_heap_mode != 2) || (DAT_0047db14 < uVar2)) goto LAB_00466894;
        crt_lock(9);
        local_8 = 1;
        local_24 = crt_sbh_alloc_units(uVar2 >> 4);
        local_8 = 0xffffffff;
        FUN_004668ce();
        _Size = uVar2;
        if (local_24 != (void *)0x0) goto LAB_00466888;
      }
LAB_00466899:
      local_24 = HeapAlloc(DAT_004da3a4,8,uVar2);
    }
    if (local_24 != (LPVOID)0x0) {
      ExceptionList = local_14;
      return local_24;
    }
    if (DAT_004d9a78 == 0) {
      ExceptionList = local_14;
      return (void *)0x0;
    }
    iVar1 = crt_call_new_handler(uVar2);
    if (iVar1 == 0) {
      ExceptionList = local_14;
      return (void *)0x0;
    }
  } while( true );
}



/* FUN_00466845 @ 00466845 */

/* [binja] int32_t sub_466845() */

int FUN_00466845(void)

{
  int iVar1;
  
  iVar1 = crt_unlock(9);
  return iVar1;
}



/* FUN_004668ce @ 004668ce */

/* [binja] int32_t sub_4668ce() */

int FUN_004668ce(void)

{
  int iVar1;
  
  iVar1 = crt_unlock(9);
  return iVar1;
}



/* crt_exception_filter @ 004668e9 */

/* CRT exception filter/dispatch */

long __cdecl crt_exception_filter(int code,_EXCEPTION_POINTERS *info)

{
  code *pcVar1;
  DWORD DVar2;
  DWORD DVar3;
  DWORD *pDVar4;
  int *piVar5;
  long lVar6;
  int iVar7;
  int iVar8;
  
  pDVar4 = crt_get_thread_data();
  piVar5 = FUN_00466a27(code,(int *)pDVar4[0x14]);
  if ((piVar5 == (int *)0x0) || (pcVar1 = (code *)piVar5[2], pcVar1 == (code *)0x0)) {
    lVar6 = UnhandledExceptionFilter((_EXCEPTION_POINTERS *)info);
  }
  else if (pcVar1 == (code *)0x5) {
    piVar5[2] = 0;
    lVar6 = 1;
  }
  else {
    if (pcVar1 != (code *)0x1) {
      DVar2 = pDVar4[0x15];
      pDVar4[0x15] = (DWORD)info;
      if (piVar5[1] == 8) {
        if (DAT_0047bad8 < DAT_0047badc + DAT_0047bad8) {
          iVar7 = DAT_0047bad8 * 0xc;
          iVar8 = DAT_0047bad8;
          do {
            *(undefined4 *)(iVar7 + 8 + pDVar4[0x14]) = 0;
            iVar8 = iVar8 + 1;
            iVar7 = iVar7 + 0xc;
          } while (iVar8 < DAT_0047badc + DAT_0047bad8);
        }
        iVar7 = *piVar5;
        DVar3 = pDVar4[0x16];
        if (iVar7 == -0x3fffff72) {
          pDVar4[0x16] = 0x83;
        }
        else if (iVar7 == -0x3fffff70) {
          pDVar4[0x16] = 0x81;
        }
        else if (iVar7 == -0x3fffff6f) {
          pDVar4[0x16] = 0x84;
        }
        else if (iVar7 == -0x3fffff6d) {
          pDVar4[0x16] = 0x85;
        }
        else if (iVar7 == -0x3fffff73) {
          pDVar4[0x16] = 0x82;
        }
        else if (iVar7 == -0x3fffff71) {
          pDVar4[0x16] = 0x86;
        }
        else if (iVar7 == -0x3fffff6e) {
          pDVar4[0x16] = 0x8a;
        }
        (*pcVar1)(8,pDVar4[0x16]);
        pDVar4[0x16] = DVar3;
      }
      else {
        piVar5[2] = 0;
        (*pcVar1)(piVar5[1]);
      }
      pDVar4[0x15] = DVar2;
    }
    lVar6 = -1;
  }
  return lVar6;
}



/* FUN_00466a27 @ 00466a27 */

int * __cdecl FUN_00466a27(int param_1,int *param_2)

{
  int *piVar1;
  
  piVar1 = param_2;
  if (*param_2 != param_1) {
    do {
      piVar1 = piVar1 + 3;
      if (param_2 + DAT_0047bae4 * 3 <= piVar1) break;
    } while (*piVar1 != param_1);
  }
  if ((param_2 + DAT_0047bae4 * 3 <= piVar1) || (*piVar1 != param_1)) {
    piVar1 = (int *)0x0;
  }
  return piVar1;
}



/* FUN_00466a61 @ 00466a61 */

/* [binja] HMODULE sub_466a61(int32_t* arg1) */

void * __cdecl FUN_00466a61(int *arg1)

{
  HMODULE pHVar1;
  int iVar2;
  
  *arg1 = 0;
  pHVar1 = GetModuleHandleA((LPCSTR)0x0);
  if (((short)pHVar1->unused == 0x5a4d) && (pHVar1[0xf].unused != 0)) {
    iVar2 = (int)&pHVar1->unused + pHVar1[0xf].unused;
    *(undefined1 *)arg1 = *(undefined1 *)(iVar2 + 0x1a);
    pHVar1 = (HMODULE)CONCAT31((int3)((uint)iVar2 >> 8),*(undefined1 *)(iVar2 + 0x1b));
    *(undefined1 *)((int)arg1 + 1) = *(undefined1 *)(iVar2 + 0x1b);
  }
  return pHVar1;
}



/* crt_heap_select @ 00466a8e */

/* selects CRT heap strategy */

int crt_heap_select(void)

{
  char cVar1;
  WINBOOL WVar2;
  DWORD DVar3;
  int iVar4;
  long lVar5;
  char *pcVar6;
  char *this;
  int unaff_EBX;
  char local_1230 [4240];
  char local_1a0 [260];
  DWORD local_9c;
  uint local_98;
  DWORD local_8c;
  CHAR aCStackY_18 [4];
  byte bVar7;
  
  crt_chkstk();
  local_9c = 0x94;
  WVar2 = GetVersionExA((LPOSVERSIONINFOA)&local_9c);
  if (((WVar2 == 0) || (local_8c != 2)) || (local_98 < 5)) {
    aCStackY_18[0] = -0x18;
    aCStackY_18[1] = 'j';
    aCStackY_18[2] = 'F';
    aCStackY_18[3] = '\0';
    DVar3 = GetEnvironmentVariableA("__MSVCRT_HEAP_SELECT",local_1230,0x1090);
    if (DVar3 != 0) {
      pcVar6 = local_1230;
      while (local_1230[0] != '\0') {
        cVar1 = *pcVar6;
        if (('`' < cVar1) && (cVar1 < '{')) {
          *pcVar6 = cVar1 + -0x20;
        }
        pcVar6 = pcVar6 + 1;
        local_1230[0] = *pcVar6;
      }
      builtin_memcpy(aCStackY_18,"&kF",4);
      iVar4 = _strncmp("__GLOBAL_HEAP_SELECTED",local_1230,0x16);
      if (iVar4 == 0) {
        pcVar6 = local_1230;
      }
      else {
        builtin_memcpy(aCStackY_18,"HkF",4);
        GetModuleFileNameA((HMODULE)0x0,local_1a0,0x104);
        pcVar6 = local_1a0;
        while (local_1a0[0] != '\0') {
          cVar1 = *pcVar6;
          if (('`' < cVar1) && (cVar1 < '{')) {
            *pcVar6 = cVar1 + -0x20;
          }
          pcVar6 = pcVar6 + 1;
          local_1a0[0] = *pcVar6;
        }
        pcVar6 = _strstr(local_1230,local_1a0);
      }
      if ((pcVar6 != (char *)0x0) && (pcVar6 = _strchr(pcVar6,0x2c), pcVar6 != (char *)0x0)) {
        pcVar6 = pcVar6 + 1;
        cVar1 = *pcVar6;
        this = pcVar6;
        while (cVar1 != '\0') {
          if (*this == ';') {
            *this = '\0';
          }
          else {
            this = this + 1;
          }
          cVar1 = *this;
        }
        aCStackY_18[0] = -0x52;
        aCStackY_18[1] = 'k';
        aCStackY_18[2] = 'F';
        aCStackY_18[3] = '\0';
        lVar5 = crt_strtol_l(this,pcVar6,(char *)0x0,(char **)0xa,unaff_EBX);
        if (lVar5 == 2) {
          return 2;
        }
        if (lVar5 == 3) {
          return 3;
        }
        if (lVar5 == 1) {
          return 1;
        }
      }
    }
    bVar7 = (byte)unaff_EBX;
    FUN_00466a61((int *)&stack0xfffffff8);
    iVar4 = 3 - (uint)(bVar7 < 6);
  }
  else {
    iVar4 = 1;
  }
  return iVar4;
}



/* crt_heap_init @ 00466bd6 */

/* CRT heap init (small/large block selection) */

undefined4 __cdecl crt_heap_init(int param_1)

{
  undefined **ppuVar1;
  
  DAT_004da3a4 = HeapCreate((uint)(param_1 == 0),0x1000,0);
  if (DAT_004da3a4 != (HANDLE)0x0) {
    crt_heap_mode = crt_heap_select();
    if (crt_heap_mode == 3) {
      ppuVar1 = (undefined **)crt_sbh_init(0x3f8);
    }
    else {
      if (crt_heap_mode != 2) {
        return 1;
      }
      ppuVar1 = crt_sbh_create_region();
    }
    if (ppuVar1 != (undefined **)0x0) {
      return 1;
    }
    HeapDestroy(DAT_004da3a4);
  }
  return 0;
}



/* crt_sbh_init @ 00466c33 */

/* CRT small-block heap init */

undefined4 __cdecl crt_sbh_init(undefined4 param_1)

{
  DAT_004da39c = HeapAlloc(DAT_004da3a4,0,0x140);
  if (DAT_004da39c == (LPVOID)0x0) {
    return 0;
  }
  DAT_004da394 = 0;
  DAT_004da398 = 0;
  DAT_004da390 = DAT_004da39c;
  DAT_004da3a0 = param_1;
  DAT_004da388 = 0x10;
  return 1;
}



/* crt_sbh_find_region @ 00466c7b */

/* CRT: find small-block heap region for a pointer */

void * __cdecl crt_sbh_find_region(void *ptr)

{
  void *pvVar1;
  
  pvVar1 = DAT_004da39c;
  while( true ) {
    if ((void *)((int)DAT_004da39c + DAT_004da398 * 0x14) <= pvVar1) {
      return (void *)0x0;
    }
    if ((uint)((int)ptr - *(int *)((int)pvVar1 + 0xc)) < 0x100000) break;
    pvVar1 = (void *)((int)pvVar1 + 0x14);
  }
  return pvVar1;
}



/* FUN_00466ca6 @ 00466ca6 */

/* [binja] int32_t* sub_466ca6(void* arg1, int32_t* arg2) */

int * __cdecl FUN_00466ca6(void *arg1,int *arg2)

{
  char *pcVar1;
  int *piVar2;
  char cVar3;
  uint uVar4;
  uint uVar5;
  int *piVar6;
  byte bVar7;
  uint uVar8;
  void *pvVar9;
  void *pvVar10;
  uint *puVar11;
  uint uVar12;
  uint uVar13;
  uint local_8;
  
  piVar6 = *(int **)((int)arg1 + 0x10);
  puVar11 = (uint *)(arg2 + -1);
  uVar13 = (uint)((int)arg2 - *(int *)((int)arg1 + 0xc)) >> 0xf;
  piVar2 = piVar6 + uVar13 * 0x81 + 0x51;
  uVar12 = *puVar11;
  local_8 = uVar12 - 1;
  if ((local_8 & 1) == 0) {
    uVar4 = *(uint *)(local_8 + (int)puVar11);
    uVar5 = arg2[-2];
    if ((uVar4 & 1) == 0) {
      uVar8 = ((int)uVar4 >> 4) - 1;
      if (0x3f < uVar8) {
        uVar8 = 0x3f;
      }
      if (*(int *)((int)puVar11 + uVar12 + 3) == *(int *)((int)puVar11 + uVar12 + 7)) {
        if (uVar8 < 0x20) {
          pcVar1 = (char *)(uVar8 + 4 + (int)piVar6);
          uVar8 = ~(0x80000000U >> ((byte)uVar8 & 0x1f));
          piVar6[uVar13 + 0x11] = piVar6[uVar13 + 0x11] & uVar8;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            *(uint *)arg1 = *(uint *)arg1 & uVar8;
          }
        }
        else {
          pcVar1 = (char *)(uVar8 + 4 + (int)piVar6);
          uVar8 = ~(0x80000000U >> ((byte)uVar8 - 0x20 & 0x1f));
          piVar6[uVar13 + 0x31] = piVar6[uVar13 + 0x31] & uVar8;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            *(uint *)((int)arg1 + 4) = *(uint *)((int)arg1 + 4) & uVar8;
          }
        }
      }
      local_8 = local_8 + uVar4;
      *(undefined4 *)(*(int *)((int)puVar11 + uVar12 + 7) + 4) =
           *(undefined4 *)((int)puVar11 + uVar12 + 3);
      *(undefined4 *)(*(int *)((int)puVar11 + uVar12 + 3) + 8) =
           *(undefined4 *)((int)puVar11 + uVar12 + 7);
    }
    pvVar9 = (void *)(((int)local_8 >> 4) - 1);
    if ((void *)0x3f < pvVar9) {
      pvVar9 = (void *)0x3f;
    }
    pvVar10 = arg1;
    if ((uVar5 & 1) == 0) {
      puVar11 = (uint *)((int)puVar11 - uVar5);
      pvVar10 = (void *)(((int)uVar5 >> 4) - 1);
      if ((void *)0x3f < pvVar10) {
        pvVar10 = (void *)0x3f;
      }
      local_8 = local_8 + uVar5;
      pvVar9 = (void *)(((int)local_8 >> 4) - 1);
      if ((void *)0x3f < pvVar9) {
        pvVar9 = (void *)0x3f;
      }
      if (pvVar10 != pvVar9) {
        if (puVar11[1] == puVar11[2]) {
          if (pvVar10 < (void *)0x20) {
            uVar12 = ~(0x80000000U >> ((byte)pvVar10 & 0x1f));
            piVar6[uVar13 + 0x11] = piVar6[uVar13 + 0x11] & uVar12;
            pcVar1 = (char *)((int)pvVar10 + 4U + (int)piVar6);
            *pcVar1 = *pcVar1 + -1;
            if (*pcVar1 == '\0') {
              *(uint *)arg1 = *(uint *)arg1 & uVar12;
            }
          }
          else {
            uVar12 = ~(0x80000000U >> ((byte)pvVar10 - 0x20 & 0x1f));
            piVar6[uVar13 + 0x31] = piVar6[uVar13 + 0x31] & uVar12;
            pcVar1 = (char *)((int)pvVar10 + 4U + (int)piVar6);
            *pcVar1 = *pcVar1 + -1;
            if (*pcVar1 == '\0') {
              *(uint *)((int)arg1 + 4) = *(uint *)((int)arg1 + 4) & uVar12;
            }
          }
        }
        *(uint *)(puVar11[2] + 4) = puVar11[1];
        *(uint *)(puVar11[1] + 8) = puVar11[2];
      }
    }
    if (((uVar5 & 1) != 0) || (pvVar10 != pvVar9)) {
      puVar11[1] = piVar2[(int)pvVar9 * 2 + 1];
      puVar11[2] = (uint)(piVar2 + (int)pvVar9 * 2);
      (piVar2 + (int)pvVar9 * 2)[1] = (int)puVar11;
      *(uint **)(puVar11[1] + 8) = puVar11;
      if (puVar11[1] == puVar11[2]) {
        cVar3 = *(char *)((int)pvVar9 + 4U + (int)piVar6);
        *(char *)((int)pvVar9 + 4U + (int)piVar6) = cVar3 + '\x01';
        bVar7 = (byte)pvVar9;
        if (pvVar9 < (void *)0x20) {
          if (cVar3 == '\0') {
            *(uint *)arg1 = *(uint *)arg1 | 0x80000000U >> (bVar7 & 0x1f);
          }
          piVar6[uVar13 + 0x11] = piVar6[uVar13 + 0x11] | 0x80000000U >> (bVar7 & 0x1f);
        }
        else {
          if (cVar3 == '\0') {
            *(uint *)((int)arg1 + 4) =
                 *(uint *)((int)arg1 + 4) | 0x80000000U >> (bVar7 - 0x20 & 0x1f);
          }
          piVar6[uVar13 + 0x31] = piVar6[uVar13 + 0x31] | 0x80000000U >> (bVar7 - 0x20 & 0x1f);
        }
      }
    }
    *puVar11 = local_8;
    *(uint *)((local_8 - 4) + (int)puVar11) = local_8;
    *piVar2 = *piVar2 + -1;
    piVar6 = piVar2;
    if (*piVar2 == 0) {
      if (DAT_004da394 != (void *)0x0) {
        VirtualFree((LPVOID)(DAT_004da38c * 0x8000 + *(int *)((int)DAT_004da394 + 0xc)),0x8000,
                    0x4000);
        *(uint *)((int)DAT_004da394 + 8) =
             *(uint *)((int)DAT_004da394 + 8) | 0x80000000U >> ((byte)DAT_004da38c & 0x1f);
        *(undefined4 *)(*(int *)((int)DAT_004da394 + 0x10) + 0xc4 + DAT_004da38c * 4) = 0;
        pcVar1 = (char *)(*(int *)((int)DAT_004da394 + 0x10) + 0x43);
        *pcVar1 = *pcVar1 + -1;
        if (*(char *)(*(int *)((int)DAT_004da394 + 0x10) + 0x43) == '\0') {
          *(uint *)((int)DAT_004da394 + 4) = *(uint *)((int)DAT_004da394 + 4) & 0xfffffffe;
        }
        if (*(int *)((int)DAT_004da394 + 8) == -1) {
          VirtualFree(*(LPVOID *)((int)DAT_004da394 + 0xc),0,0x8000);
          HeapFree(DAT_004da3a4,0,*(LPVOID *)((int)DAT_004da394 + 0x10));
          crt_memmove(DAT_004da394,(void *)((int)DAT_004da394 + 0x14),
                      (DAT_004da398 * 0x14 - (int)DAT_004da394) + -0x14 + DAT_004da39c);
          DAT_004da398 = DAT_004da398 + -1;
          if (DAT_004da394 < arg1) {
            arg1 = (void *)((int)arg1 + -0x14);
          }
          DAT_004da390 = DAT_004da39c;
        }
      }
      DAT_004da394 = arg1;
      piVar6 = arg1;
      DAT_004da38c = uVar13;
    }
  }
  return piVar6;
}



/* crt_sbh_alloc @ 00466fcf */

/* allocates a small-block heap chunk (size rounded to 16 bytes) */

void * __cdecl crt_sbh_alloc(uint size)

{
  char *pcVar1;
  int *piVar2;
  char cVar3;
  int *piVar4;
  byte bVar5;
  uint uVar6;
  int iVar7;
  uint *puVar8;
  int iVar9;
  int *piVar10;
  uint *puVar11;
  uint *puVar12;
  uint uVar13;
  int iVar14;
  uint local_10;
  uint local_c;
  int local_8;
  
  puVar8 = DAT_004da39c + DAT_004da398 * 5;
  uVar6 = size + 0x17 & 0xfffffff0;
  iVar7 = ((int)(size + 0x17) >> 4) + -1;
  bVar5 = (byte)iVar7;
  size = (uint)DAT_004da390;
  if (iVar7 < 0x20) {
    local_10 = 0xffffffff >> (bVar5 & 0x1f);
    local_c = 0xffffffff;
  }
  else {
    local_c = 0xffffffff >> (bVar5 - 0x20 & 0x1f);
    local_10 = 0;
  }
  for (; (size < puVar8 && ((*(uint *)(size + 4) & local_c) == 0 && (*(uint *)size & local_10) == 0)
         ); size = (uint)(size + 0x14)) {
  }
  puVar11 = DAT_004da39c;
  if ((uint *)size == puVar8) {
    for (; (puVar11 < DAT_004da390 && ((puVar11[1] & local_c) == 0 && (*puVar11 & local_10) == 0));
        puVar11 = puVar11 + 5) {
    }
    size = (uint)puVar11;
    if (puVar11 == DAT_004da390) {
      for (; (puVar11 < puVar8 && (puVar11[2] == 0)); puVar11 = puVar11 + 5) {
      }
      puVar12 = DAT_004da39c;
      size = (uint)puVar11;
      if (puVar11 == puVar8) {
        for (; (puVar12 < DAT_004da390 && (puVar12[2] == 0)); puVar12 = puVar12 + 5) {
        }
        size = (uint)puVar12;
        if ((puVar12 == DAT_004da390) && (size = (uint)FUN_004672d8(), (int *)size == (int *)0x0)) {
          return (void *)0x0;
        }
      }
      iVar7 = FUN_00467389(size);
      **(int **)(size + 0x10) = iVar7;
      if (**(int **)(size + 0x10) == -1) {
        return (void *)0x0;
      }
    }
  }
  piVar4 = *(int **)(size + 0x10);
  local_8 = *piVar4;
  if ((local_8 == -1) ||
     ((piVar4[local_8 + 0x31] & local_c) == 0 && (piVar4[local_8 + 0x11] & local_10) == 0)) {
    local_8 = 0;
    puVar8 = (uint *)(piVar4 + 0x11);
    if ((piVar4[0x31] & local_c) == 0 && (piVar4[0x11] & local_10) == 0) {
      do {
        puVar11 = puVar8 + 0x21;
        local_8 = local_8 + 1;
        puVar8 = puVar8 + 1;
      } while ((*puVar11 & local_c) == 0 && (local_10 & *puVar8) == 0);
    }
  }
  iVar7 = 0;
  piVar2 = piVar4 + local_8 * 0x81 + 0x51;
  local_10 = piVar4[local_8 + 0x11] & local_10;
  if (local_10 == 0) {
    local_10 = piVar4[local_8 + 0x31] & local_c;
    iVar7 = 0x20;
  }
  for (; -1 < (int)local_10; local_10 = local_10 << 1) {
    iVar7 = iVar7 + 1;
  }
  piVar10 = (int *)piVar2[iVar7 * 2 + 1];
  iVar9 = *piVar10 - uVar6;
  iVar14 = (iVar9 >> 4) + -1;
  if (0x3f < iVar14) {
    iVar14 = 0x3f;
  }
  DAT_004da390 = (uint *)size;
  if (iVar14 != iVar7) {
    if (piVar10[1] == piVar10[2]) {
      if (iVar7 < 0x20) {
        pcVar1 = (char *)((int)piVar4 + iVar7 + 4);
        uVar13 = ~(0x80000000U >> ((byte)iVar7 & 0x1f));
        piVar4[local_8 + 0x11] = uVar13 & piVar4[local_8 + 0x11];
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          *(uint *)size = *(uint *)size & uVar13;
        }
      }
      else {
        pcVar1 = (char *)((int)piVar4 + iVar7 + 4);
        uVar13 = ~(0x80000000U >> ((byte)iVar7 - 0x20 & 0x1f));
        piVar4[local_8 + 0x31] = piVar4[local_8 + 0x31] & uVar13;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          *(uint *)(size + 4) = *(uint *)(size + 4) & uVar13;
        }
      }
    }
    *(int *)(piVar10[2] + 4) = piVar10[1];
    *(int *)(piVar10[1] + 8) = piVar10[2];
    if (iVar9 == 0) goto LAB_00467295;
    piVar10[1] = piVar2[iVar14 * 2 + 1];
    piVar10[2] = (int)(piVar2 + iVar14 * 2);
    (piVar2 + iVar14 * 2)[1] = (int)piVar10;
    *(int **)(piVar10[1] + 8) = piVar10;
    if (piVar10[1] == piVar10[2]) {
      cVar3 = *(char *)(iVar14 + 4 + (int)piVar4);
      bVar5 = (byte)iVar14;
      if (iVar14 < 0x20) {
        *(char *)(iVar14 + 4 + (int)piVar4) = cVar3 + '\x01';
        if (cVar3 == '\0') {
          *(uint *)size = *(uint *)size | 0x80000000U >> (bVar5 & 0x1f);
        }
        piVar4[local_8 + 0x11] = piVar4[local_8 + 0x11] | 0x80000000U >> (bVar5 & 0x1f);
      }
      else {
        *(char *)(iVar14 + 4 + (int)piVar4) = cVar3 + '\x01';
        if (cVar3 == '\0') {
          *(uint *)(size + 4) = *(uint *)(size + 4) | 0x80000000U >> (bVar5 - 0x20 & 0x1f);
        }
        piVar4[local_8 + 0x31] = piVar4[local_8 + 0x31] | 0x80000000U >> (bVar5 - 0x20 & 0x1f);
      }
    }
  }
  if (iVar9 != 0) {
    *piVar10 = iVar9;
    *(int *)(iVar9 + -4 + (int)piVar10) = iVar9;
  }
LAB_00467295:
  piVar10 = (int *)((int)piVar10 + iVar9);
  *piVar10 = uVar6 + 1;
  *(uint *)((int)piVar10 + (uVar6 - 4)) = uVar6 + 1;
  iVar7 = *piVar2;
  *piVar2 = iVar7 + 1;
  if (((iVar7 == 0) && (size == DAT_004da394)) && (local_8 == DAT_004da38c)) {
    DAT_004da394 = 0;
  }
  *piVar4 = local_8;
  return piVar10 + 1;
}



/* FUN_004672d8 @ 004672d8 */

/* [binja] int32_t* sub_4672d8() */

int * FUN_004672d8(void)

{
  int *piVar1;
  LPVOID pvVar2;
  
  if (DAT_004da398 == DAT_004da388) {
    pvVar2 = HeapReAlloc(DAT_004da3a4,0,DAT_004da39c,(DAT_004da388 * 5 + 0x50) * 4);
    if (pvVar2 == (LPVOID)0x0) {
      return (int *)0x0;
    }
    DAT_004da388 = DAT_004da388 + 0x10;
    DAT_004da39c = pvVar2;
  }
  piVar1 = (int *)((int)DAT_004da39c + DAT_004da398 * 0x14);
  pvVar2 = HeapAlloc(DAT_004da3a4,8,0x41c4);
  piVar1[4] = (int)pvVar2;
  if (pvVar2 != (LPVOID)0x0) {
    pvVar2 = VirtualAlloc((LPVOID)0x0,0x100000,0x2000,4);
    piVar1[3] = (int)pvVar2;
    if (pvVar2 != (LPVOID)0x0) {
      piVar1[2] = -1;
      *piVar1 = 0;
      piVar1[1] = 0;
      DAT_004da398 = DAT_004da398 + 1;
      *(undefined4 *)piVar1[4] = 0xffffffff;
      return piVar1;
    }
    HeapFree(DAT_004da3a4,0,(LPVOID)piVar1[4]);
  }
  return (int *)0x0;
}



/* FUN_00467389 @ 00467389 */

int __cdecl FUN_00467389(int param_1)

{
  int *piVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  LPVOID pvVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  int *lpAddress;
  
  iVar3 = *(int *)(param_1 + 0x10);
  iVar9 = 0;
  for (iVar4 = *(int *)(param_1 + 8); -1 < iVar4; iVar4 = iVar4 << 1) {
    iVar9 = iVar9 + 1;
  }
  iVar8 = 0x3f;
  iVar4 = iVar9 * 0x204 + 0x144 + iVar3;
  iVar5 = iVar4;
  do {
    *(int *)(iVar5 + 8) = iVar5;
    *(int *)(iVar5 + 4) = iVar5;
    iVar5 = iVar5 + 8;
    iVar8 = iVar8 + -1;
  } while (iVar8 != 0);
  lpAddress = (int *)(iVar9 * 0x8000 + *(int *)(param_1 + 0xc));
  pvVar6 = VirtualAlloc(lpAddress,0x8000,0x1000,4);
  if (pvVar6 == (LPVOID)0x0) {
    iVar9 = -1;
  }
  else {
    if (lpAddress <= lpAddress + 0x1c00) {
      piVar7 = lpAddress + 4;
      do {
        piVar7[-2] = -1;
        piVar7[0x3fb] = -1;
        piVar7[-1] = 0xff0;
        *piVar7 = (int)(piVar7 + 0x3ff);
        piVar7[1] = (int)(piVar7 + -0x401);
        piVar7[0x3fa] = 0xff0;
        piVar1 = piVar7 + 0x3fc;
        piVar7 = piVar7 + 0x400;
      } while (piVar1 <= lpAddress + 0x1c00);
    }
    *(int **)(iVar4 + 0x1fc) = lpAddress + 3;
    lpAddress[5] = iVar4 + 0x1f8;
    *(int **)(iVar4 + 0x200) = lpAddress + 0x1c03;
    lpAddress[0x1c04] = iVar4 + 0x1f8;
    *(undefined4 *)(iVar3 + 0x44 + iVar9 * 4) = 0;
    *(undefined4 *)(iVar3 + 0xc4 + iVar9 * 4) = 1;
    cVar2 = *(char *)(iVar3 + 0x43);
    *(char *)(iVar3 + 0x43) = cVar2 + '\x01';
    if (cVar2 == '\0') {
      *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) | 1;
    }
    *(uint *)(param_1 + 8) = *(uint *)(param_1 + 8) & ~(0x80000000U >> ((byte)iVar9 & 0x1f));
  }
  return iVar9;
}



/* FUN_00467484 @ 00467484 */

/* [binja] int32_t sub_467484(int32_t* arg1, void** arg2, void* arg3) */

int __cdecl FUN_00467484(int *arg1,void **arg2,void *arg3)

{
  char *pcVar1;
  int iVar2;
  int *piVar3;
  undefined4 *puVar4;
  int iVar5;
  char cVar6;
  int iVar7;
  void *pvVar8;
  uint *puVar9;
  byte bVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint local_c;
  
  iVar7 = arg1[4];
  uVar14 = (int)arg3 + 0x17U & 0xfffffff0;
  uVar12 = (uint)((int)arg2 - arg1[3]) >> 0xf;
  iVar5 = uVar12 * 0x204 + 0x144 + iVar7;
  pvVar8 = arg2[-1];
  iVar11 = (int)pvVar8 + -1;
  uVar15 = *(uint *)((int)pvVar8 + -5 + (int)arg2);
  if (iVar11 < (int)uVar14) {
    if (((uVar15 & 1) != 0) || ((int)(uVar15 + iVar11) < (int)uVar14)) {
      return 0;
    }
    local_c = ((int)uVar15 >> 4) - 1;
    if (0x3f < local_c) {
      local_c = 0x3f;
    }
    if (*(int *)((int)arg2 + (int)pvVar8 + -1) == *(int *)((int)arg2 + (int)pvVar8 + 3)) {
      if (local_c < 0x20) {
        pcVar1 = (char *)(local_c + 4 + iVar7);
        uVar13 = ~(0x80000000U >> ((byte)local_c & 0x1f));
        puVar9 = (uint *)(iVar7 + 0x44 + uVar12 * 4);
        *puVar9 = *puVar9 & uVar13;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          *arg1 = *arg1 & uVar13;
        }
      }
      else {
        pcVar1 = (char *)(local_c + 4 + iVar7);
        uVar13 = ~(0x80000000U >> ((byte)local_c - 0x20 & 0x1f));
        puVar9 = (uint *)(iVar7 + 0xc4 + uVar12 * 4);
        *puVar9 = *puVar9 & uVar13;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          arg1[1] = arg1[1] & uVar13;
        }
      }
    }
    *(undefined4 *)(*(int *)((int)arg2 + (int)pvVar8 + 3) + 4) =
         *(undefined4 *)((int)arg2 + (int)pvVar8 + -1);
    *(undefined4 *)(*(int *)((int)arg2 + (int)pvVar8 + -1) + 8) =
         *(undefined4 *)((int)arg2 + (int)pvVar8 + 3);
    iVar11 = uVar15 + (iVar11 - uVar14);
    if (0 < iVar11) {
      uVar15 = (iVar11 >> 4) - 1;
      iVar2 = (int)arg2 + (uVar14 - 4);
      if (0x3f < uVar15) {
        uVar15 = 0x3f;
      }
      iVar5 = iVar5 + uVar15 * 8;
      *(undefined4 *)(iVar2 + 4) = *(undefined4 *)(iVar5 + 4);
      *(int *)(iVar2 + 8) = iVar5;
      *(int *)(iVar5 + 4) = iVar2;
      *(int *)(*(int *)(iVar2 + 4) + 8) = iVar2;
      if (*(int *)(iVar2 + 4) == *(int *)(iVar2 + 8)) {
        cVar6 = *(char *)(uVar15 + 4 + iVar7);
        *(char *)(uVar15 + 4 + iVar7) = cVar6 + '\x01';
        bVar10 = (byte)uVar15;
        if (uVar15 < 0x20) {
          if (cVar6 == '\0') {
            *arg1 = *arg1 | 0x80000000U >> (bVar10 & 0x1f);
          }
          puVar9 = (uint *)(iVar7 + 0x44 + uVar12 * 4);
        }
        else {
          if (cVar6 == '\0') {
            arg1[1] = arg1[1] | 0x80000000U >> (bVar10 - 0x20 & 0x1f);
          }
          puVar9 = (uint *)(iVar7 + 0xc4 + uVar12 * 4);
          bVar10 = bVar10 - 0x20;
        }
        *puVar9 = *puVar9 | 0x80000000U >> (bVar10 & 0x1f);
      }
      piVar3 = (int *)((int)arg2 + (uVar14 - 4));
      *piVar3 = iVar11;
      *(int *)(iVar11 + -4 + (int)piVar3) = iVar11;
    }
    arg2[-1] = (void *)(uVar14 + 1);
    *(void **)((int)arg2 + (uVar14 - 8)) = (void *)(uVar14 + 1);
  }
  else if ((int)uVar14 < iVar11) {
    arg3 = (void *)(iVar11 - uVar14);
    arg2[-1] = (void *)(uVar14 + 1);
    puVar4 = (undefined4 *)((int)arg2 + (uVar14 - 4));
    uVar13 = ((int)arg3 >> 4) - 1;
    puVar4[-1] = (void *)(uVar14 + 1);
    if (0x3f < uVar13) {
      uVar13 = 0x3f;
    }
    if ((uVar15 & 1) == 0) {
      uVar14 = ((int)uVar15 >> 4) - 1;
      if (0x3f < uVar14) {
        uVar14 = 0x3f;
      }
      if (*(int *)((int)arg2 + (int)pvVar8 + -1) == *(int *)((int)arg2 + (int)pvVar8 + 3)) {
        if (uVar14 < 0x20) {
          pcVar1 = (char *)(uVar14 + 4 + iVar7);
          uVar14 = ~(0x80000000U >> ((byte)uVar14 & 0x1f));
          puVar9 = (uint *)(iVar7 + 0x44 + uVar12 * 4);
          *puVar9 = *puVar9 & uVar14;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            *arg1 = *arg1 & uVar14;
          }
        }
        else {
          pcVar1 = (char *)(uVar14 + 4 + iVar7);
          uVar14 = ~(0x80000000U >> ((byte)uVar14 - 0x20 & 0x1f));
          puVar9 = (uint *)(iVar7 + 0xc4 + uVar12 * 4);
          *puVar9 = *puVar9 & uVar14;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            arg1[1] = arg1[1] & uVar14;
          }
        }
      }
      *(undefined4 *)(*(int *)((int)arg2 + (int)pvVar8 + 3) + 4) =
           *(undefined4 *)((int)arg2 + (int)pvVar8 + -1);
      *(undefined4 *)(*(int *)((int)arg2 + (int)pvVar8 + -1) + 8) =
           *(undefined4 *)((int)arg2 + (int)pvVar8 + 3);
      arg3 = (void *)((int)arg3 + uVar15);
      uVar13 = ((int)arg3 >> 4) - 1;
      if (0x3f < uVar13) {
        uVar13 = 0x3f;
      }
    }
    iVar11 = iVar5 + uVar13 * 8;
    puVar4[1] = *(undefined4 *)(iVar5 + 4 + uVar13 * 8);
    puVar4[2] = iVar11;
    *(undefined4 **)(iVar11 + 4) = puVar4;
    *(undefined4 **)(puVar4[1] + 8) = puVar4;
    if (puVar4[1] == puVar4[2]) {
      cVar6 = *(char *)(uVar13 + 4 + iVar7);
      *(char *)(uVar13 + 4 + iVar7) = cVar6 + '\x01';
      bVar10 = (byte)uVar13;
      if (uVar13 < 0x20) {
        if (cVar6 == '\0') {
          *arg1 = *arg1 | 0x80000000U >> (bVar10 & 0x1f);
        }
        puVar9 = (uint *)(iVar7 + 0x44 + uVar12 * 4);
      }
      else {
        if (cVar6 == '\0') {
          arg1[1] = arg1[1] | 0x80000000U >> (bVar10 - 0x20 & 0x1f);
        }
        puVar9 = (uint *)(iVar7 + 0xc4 + uVar12 * 4);
        bVar10 = bVar10 - 0x20;
      }
      *puVar9 = *puVar9 | 0x80000000U >> (bVar10 & 0x1f);
    }
    *puVar4 = arg3;
    *(void **)((int)arg3 + -4 + (int)puVar4) = arg3;
  }
  return 1;
}



/* crt_sbh_create_region @ 0046777a */

/* CRT small-block heap region init */

undefined ** crt_sbh_create_region(void)

{
  bool bVar1;
  int *lpAddress;
  LPVOID pvVar2;
  undefined **ppuVar3;
  int iVar4;
  undefined **lpMem;
  
  if (DAT_0047bb00 == -1) {
    lpMem = &PTR_LOOP_0047baf0;
  }
  else {
    lpMem = HeapAlloc(DAT_004da3a4,0,0x2020);
    if (lpMem == (undefined **)0x0) {
      return (undefined **)0x0;
    }
  }
  lpAddress = VirtualAlloc((LPVOID)0x0,0x400000,0x2000,4);
  if (lpAddress != (int *)0x0) {
    pvVar2 = VirtualAlloc(lpAddress,0x10000,0x1000,4);
    if (pvVar2 != (LPVOID)0x0) {
      if (lpMem == &PTR_LOOP_0047baf0) {
        if (PTR_LOOP_0047baf0 == (undefined *)0x0) {
          PTR_LOOP_0047baf0 = (undefined *)&PTR_LOOP_0047baf0;
        }
        if (PTR_LOOP_0047baf4 == (undefined *)0x0) {
          PTR_LOOP_0047baf4 = (undefined *)&PTR_LOOP_0047baf0;
        }
      }
      else {
        *lpMem = (undefined *)&PTR_LOOP_0047baf0;
        lpMem[1] = PTR_LOOP_0047baf4;
        PTR_LOOP_0047baf4 = (undefined *)lpMem;
        *(undefined ***)lpMem[1] = lpMem;
      }
      lpMem[5] = (undefined *)(lpAddress + 0x100000);
      ppuVar3 = lpMem + 6;
      lpMem[3] = (undefined *)(lpMem + 0x26);
      lpMem[4] = (undefined *)lpAddress;
      lpMem[2] = (undefined *)ppuVar3;
      iVar4 = 0;
      do {
        bVar1 = 0xf < iVar4;
        iVar4 = iVar4 + 1;
        *ppuVar3 = (undefined *)((bVar1 - 1 & 0xf1) - 1);
        ppuVar3[1] = (undefined *)0xf1;
        ppuVar3 = ppuVar3 + 2;
      } while (iVar4 < 0x400);
      _memset(lpAddress,0,0x10000);
      for (; lpAddress < lpMem[4] + 0x10000; lpAddress = lpAddress + 0x400) {
        *(undefined1 *)(lpAddress + 0x3e) = 0xff;
        *lpAddress = (int)(lpAddress + 2);
        lpAddress[1] = 0xf0;
      }
      return lpMem;
    }
    VirtualFree(lpAddress,0,0x8000);
  }
  if (lpMem != &PTR_LOOP_0047baf0) {
    HeapFree(DAT_004da3a4,0,lpMem);
  }
  return (undefined **)0x0;
}



/* FUN_004678be @ 004678be */

/* [binja] BOOL sub_4678be(int32_t* arg1) */

BOOL __cdecl FUN_004678be(int *arg1)

{
  undefined *puVar1;
  WINBOOL WVar2;
  
  puVar1 = (undefined *)VirtualFree((LPVOID)arg1[4],0,0x8000);
  if ((int *)PTR_LOOP_0047db10 == arg1) {
    puVar1 = (undefined *)arg1[1];
    PTR_LOOP_0047db10 = puVar1;
  }
  if ((undefined **)arg1 != &PTR_LOOP_0047baf0) {
    *(int *)arg1[1] = *arg1;
    *(int *)(*arg1 + 4) = arg1[1];
    WVar2 = HeapFree(DAT_004da3a4,0,arg1);
    return WVar2;
  }
  DAT_0047bb00 = 0xffffffff;
  return (BOOL)puVar1;
}



/* FUN_00467914 @ 00467914 */

void __cdecl FUN_00467914(int param_1)

{
  WINBOOL WVar1;
  int *piVar2;
  int iVar3;
  int *arg1;
  int *piVar4;
  int local_8;
  
  arg1 = (int *)PTR_LOOP_0047baf4;
  do {
    piVar4 = arg1;
    if (arg1[4] != -1) {
      local_8 = 0;
      piVar4 = arg1 + 0x804;
      iVar3 = 0x3ff000;
      do {
        if (*piVar4 == 0xf0) {
          WVar1 = VirtualFree((LPVOID)(iVar3 + arg1[4]),0x1000,0x4000);
          if (WVar1 != 0) {
            *piVar4 = -1;
            DAT_004d9a70 = DAT_004d9a70 + -1;
            if (((int *)arg1[3] == (int *)0x0) || (piVar4 < (int *)arg1[3])) {
              arg1[3] = (int)piVar4;
            }
            local_8 = local_8 + 1;
            param_1 = param_1 + -1;
            if (param_1 == 0) break;
          }
        }
        iVar3 = iVar3 + -0x1000;
        piVar4 = piVar4 + -2;
      } while (-1 < iVar3);
      piVar4 = (int *)arg1[1];
      if ((local_8 != 0) && (arg1[6] == -1)) {
        piVar2 = arg1 + 8;
        iVar3 = 1;
        do {
          if (*piVar2 != -1) break;
          iVar3 = iVar3 + 1;
          piVar2 = piVar2 + 2;
        } while (iVar3 < 0x400);
        if (iVar3 == 0x400) {
          FUN_004678be(arg1);
        }
      }
    }
    if ((piVar4 == (int *)PTR_LOOP_0047baf4) || (arg1 = piVar4, param_1 < 1)) {
      return;
    }
  } while( true );
}



/* crt_sbh_find_block @ 004679d6 */

/* CRT: map a pointer to its small-block heap block header */

void * __cdecl crt_sbh_find_block(void *ptr,void **region_out,uint *page_base)

{
  undefined **ppuVar1;
  uint uVar2;
  
  ppuVar1 = &PTR_LOOP_0047baf0;
  while ((ptr <= ppuVar1[4] || (ppuVar1[5] <= ptr))) {
    ppuVar1 = (undefined **)*ppuVar1;
    if (ppuVar1 == &PTR_LOOP_0047baf0) {
      return (void *)0x0;
    }
  }
  if (((uint)ptr & 0xf) != 0) {
    return (void *)0x0;
  }
  if (((uint)ptr & 0xfff) < 0x100) {
    return (void *)0x0;
  }
  *region_out = ppuVar1;
  uVar2 = (uint)ptr & 0xfffff000;
  *page_base = uVar2;
  return (void *)(((int)((int)ptr + (-0x100 - uVar2)) >> 4) + 8 + uVar2);
}



/* FUN_00467a2d @ 00467a2d */

/* [binja] void* sub_467a2d(void* arg1, int32_t arg2, char* arg3) */

void * __cdecl FUN_00467a2d(void *arg1,int arg2,char *arg3)

{
  int *piVar1;
  
  piVar1 = (int *)((int)arg1 + (arg2 - *(int *)((int)arg1 + 0x10) >> 0xc) * 8 + 0x18);
  *piVar1 = *piVar1 + (uint)(byte)*arg3;
  *arg3 = '\0';
  piVar1[1] = 0xf1;
  if ((*piVar1 == 0xf0) && (DAT_004d9a70 = DAT_004d9a70 + 1, DAT_004d9a70 == 0x20)) {
    piVar1 = (int *)FUN_00467914(0x10);
  }
  return piVar1;
}



/* crt_sbh_alloc_units @ 00467a72 */

/* WARNING: Type propagation algorithm not settling */
/* allocates small-block heap blocks in 16-byte units */

void * __cdecl crt_sbh_alloc_units(uint blocks)

{
  uint *puVar1;
  undefined **ppuVar2;
  undefined *puVar3;
  int *piVar4;
  void *pvVar5;
  undefined **ppuVar6;
  int *piVar7;
  uint *puVar8;
  undefined **ppuVar9;
  int local_8;
  
  piVar7 = (int *)PTR_LOOP_0047db10;
  do {
    if (piVar7[4] != -1) {
      puVar8 = (uint *)piVar7[2];
      piVar4 = (int *)(((int)puVar8 + (-0x18 - (int)piVar7) >> 3) * 0x1000 + piVar7[4]);
      if (puVar8 < piVar7 + 0x806) {
        do {
          if (((int)blocks <= (int)*puVar8) && (blocks < puVar8[1])) {
            pvVar5 = (void *)FUN_00467c7a(piVar4,*puVar8,blocks);
            if (pvVar5 != (void *)0x0) goto LAB_00467b3d;
            puVar8[1] = blocks;
          }
          puVar8 = puVar8 + 2;
          piVar4 = piVar4 + 0x400;
        } while (puVar8 < piVar7 + 0x806);
      }
      puVar1 = (uint *)piVar7[2];
      piVar4 = (int *)piVar7[4];
      for (puVar8 = (uint *)(piVar7 + 6); puVar8 < puVar1; puVar8 = puVar8 + 2) {
        if (((int)blocks <= (int)*puVar8) && (blocks < puVar8[1])) {
          pvVar5 = (void *)FUN_00467c7a(piVar4,*puVar8,blocks);
          if (pvVar5 != (void *)0x0) {
LAB_00467b3d:
            PTR_LOOP_0047db10 = (undefined *)piVar7;
            *puVar8 = *puVar8 - blocks;
            piVar7[2] = (int)puVar8;
            return pvVar5;
          }
          puVar8[1] = blocks;
        }
        piVar4 = piVar4 + 0x400;
      }
    }
    piVar7 = (int *)*piVar7;
    if (piVar7 == (int *)PTR_LOOP_0047db10) {
      ppuVar9 = &PTR_LOOP_0047baf0;
      while ((ppuVar9[4] == (undefined *)0xffffffff || (ppuVar9[3] == (undefined *)0x0))) {
        ppuVar9 = (undefined **)*ppuVar9;
        if (ppuVar9 == &PTR_LOOP_0047baf0) {
          ppuVar9 = crt_sbh_create_region();
          if (ppuVar9 == (undefined **)0x0) {
            return (void *)0x0;
          }
          piVar7 = (int *)ppuVar9[4];
          *(char *)(piVar7 + 2) = (char)blocks;
          PTR_LOOP_0047db10 = (undefined *)ppuVar9;
          *piVar7 = (int)piVar7 + blocks + 8;
          piVar7[1] = 0xf0 - blocks;
          ppuVar9[6] = ppuVar9[6] + -(blocks & 0xff);
          return piVar7 + 0x40;
        }
      }
      ppuVar2 = (undefined **)ppuVar9[3];
      local_8 = 0;
      piVar7 = (int *)(ppuVar9[4] + ((int)ppuVar2 + (-0x18 - (int)ppuVar9) >> 3) * 0x1000);
      puVar3 = *ppuVar2;
      ppuVar6 = ppuVar2;
      for (; (puVar3 == (undefined *)0xffffffff && (local_8 < 0x10)); local_8 = local_8 + 1) {
        ppuVar6 = ppuVar6 + 2;
        puVar3 = *ppuVar6;
      }
      piVar4 = VirtualAlloc(piVar7,local_8 << 0xc,0x1000,4);
      if (piVar4 != piVar7) {
        return (void *)0x0;
      }
      _memset(piVar7,local_8 << 0xc,0);
      ppuVar6 = ppuVar2;
      if (0 < local_8) {
        piVar4 = piVar7 + 1;
        do {
          *(undefined1 *)(piVar4 + 0x3d) = 0xff;
          piVar4[-1] = (int)(piVar4 + 1);
          *piVar4 = 0xf0;
          *ppuVar6 = (undefined *)0xf0;
          ppuVar6[1] = (undefined *)0xf1;
          piVar4 = piVar4 + 0x400;
          ppuVar6 = ppuVar6 + 2;
          local_8 = local_8 + -1;
        } while (local_8 != 0);
      }
      for (; (ppuVar6 < ppuVar9 + 0x806 && (*ppuVar6 != (undefined *)0xffffffff));
          ppuVar6 = ppuVar6 + 2) {
      }
      PTR_LOOP_0047db10 = (undefined *)ppuVar9;
      ppuVar9[3] = (undefined *)(-(uint)(ppuVar6 < ppuVar9 + 0x806) & (uint)ppuVar6);
      *(char *)(piVar7 + 2) = (char)blocks;
      ppuVar9[2] = (undefined *)ppuVar2;
      *ppuVar2 = *ppuVar2 + -blocks;
      piVar7[1] = piVar7[1] - blocks;
      *piVar7 = (int)piVar7 + blocks + 8;
      return piVar7 + 0x40;
    }
  } while( true );
}



/* FUN_00467c7a @ 00467c7a */

int __cdecl FUN_00467c7a(int *param_1,uint param_2,uint param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  byte bVar3;
  byte *pbVar4;
  uint uVar5;
  byte *pbVar6;
  
  pbVar2 = (byte *)*param_1;
  pbVar1 = (byte *)(param_1 + 0x3e);
  bVar3 = (byte)param_3;
  if ((uint)param_1[1] < param_3) {
    pbVar6 = pbVar2;
    if (pbVar2[param_1[1]] != 0) {
      pbVar6 = pbVar2 + param_1[1];
    }
    while( true ) {
      while( true ) {
        if (pbVar1 <= pbVar6 + param_3) {
          pbVar6 = (byte *)(param_1 + 2);
          while( true ) {
            while( true ) {
              if (pbVar2 <= pbVar6) {
                return 0;
              }
              if (pbVar1 <= pbVar6 + param_3) {
                return 0;
              }
              if (*pbVar6 == 0) break;
              pbVar6 = pbVar6 + *pbVar6;
            }
            uVar5 = 1;
            pbVar4 = pbVar6;
            while (pbVar4 = pbVar4 + 1, *pbVar4 == 0) {
              uVar5 = uVar5 + 1;
            }
            if (param_3 <= uVar5) break;
            param_2 = param_2 - uVar5;
            pbVar6 = pbVar4;
            if (param_2 < param_3) {
              return 0;
            }
          }
          if (pbVar6 + param_3 < pbVar1) {
            *param_1 = (int)(pbVar6 + param_3);
            param_1[1] = uVar5 - param_3;
          }
          else {
            param_1[1] = 0;
            *param_1 = (int)(param_1 + 2);
          }
          *pbVar6 = bVar3;
          pbVar2 = pbVar6 + 8;
          goto LAB_00467d8d;
        }
        if (*pbVar6 == 0) break;
        pbVar6 = pbVar6 + *pbVar6;
      }
      uVar5 = 1;
      pbVar4 = pbVar6;
      while (pbVar4 = pbVar4 + 1, *pbVar4 == 0) {
        uVar5 = uVar5 + 1;
      }
      if (param_3 <= uVar5) break;
      if (pbVar6 == pbVar2) {
        param_1[1] = uVar5;
        pbVar6 = pbVar4;
      }
      else {
        param_2 = param_2 - uVar5;
        pbVar6 = pbVar4;
        if (param_2 < param_3) {
          return 0;
        }
      }
    }
    if (pbVar6 + param_3 < pbVar1) {
      *param_1 = (int)(pbVar6 + param_3);
      param_1[1] = uVar5 - param_3;
    }
    else {
      param_1[1] = 0;
      *param_1 = (int)(param_1 + 2);
    }
    *pbVar6 = bVar3;
    pbVar2 = pbVar6 + 8;
  }
  else {
    *pbVar2 = bVar3;
    if (pbVar2 + param_3 < pbVar1) {
      *param_1 = *param_1 + param_3;
      param_1[1] = param_1[1] - param_3;
    }
    else {
      param_1[1] = 0;
      *param_1 = (int)(param_1 + 2);
    }
    pbVar2 = pbVar2 + 8;
  }
LAB_00467d8d:
  return (int)pbVar2 * 0x10 + (int)param_1 * -0xf;
}



/* FUN_00467d9e @ 00467d9e */

/* [binja] int32_t sub_467d9e(void* arg1, void** arg2, char* arg3, int32_t arg4) */

int __cdecl FUN_00467d9e(void *arg1,void **arg2,char *arg3,int arg4)

{
  void **ppvVar1;
  int *piVar2;
  char cVar3;
  void **ppvVar4;
  void *pvVar5;
  uint uVar6;
  
  uVar6 = (uint)(byte)*arg3;
  piVar2 = (int *)((int)arg1 + ((int)arg2 - *(int *)((int)arg1 + 0x10) >> 0xc) * 8 + 0x18);
  if ((uint)arg4 < uVar6) {
    *arg3 = (char)arg4;
    *piVar2 = *piVar2 + (uVar6 - arg4);
    piVar2[1] = 0xf1;
  }
  else {
    if ((uint)arg4 <= uVar6) {
      return 0;
    }
    ppvVar1 = (void **)(arg3 + arg4);
    if (arg2 + 0x3e < ppvVar1) {
      return 0;
    }
    for (ppvVar4 = (void **)(arg3 + uVar6); (ppvVar4 < ppvVar1 && (*(char *)ppvVar4 == '\0'));
        ppvVar4 = (void **)((int)ppvVar4 + 1)) {
    }
    if (ppvVar4 != ppvVar1) {
      return 0;
    }
    *arg3 = (char)arg4;
    if ((arg3 <= *arg2) && (*arg2 < ppvVar1)) {
      if (ppvVar1 < arg2 + 0x3e) {
        pvVar5 = (void *)0x0;
        *arg2 = ppvVar1;
        cVar3 = *(char *)ppvVar1;
        while (cVar3 == '\0') {
          pvVar5 = (void *)((int)pvVar5 + 1);
          cVar3 = *(char *)((int)ppvVar1 + (int)pvVar5);
        }
        arg2[1] = pvVar5;
      }
      else {
        arg2[1] = (void *)0x0;
        *arg2 = arg2 + 2;
      }
    }
    *piVar2 = *piVar2 + (uVar6 - arg4);
  }
  return 1;
}



/* crt_call_new_handler @ 00467e47 */

/* CRT: call new-handler; returns nonzero to retry allocation */

int __cdecl crt_call_new_handler(size_t size)

{
  int iVar1;
  
  if (DAT_004d9a74 != (code *)0x0) {
    iVar1 = (*DAT_004d9a74)(size);
    if (iVar1 != 0) {
      return 1;
    }
  }
  return 0;
}



/* FUN_00467e62 @ 00467e62 */

int __thiscall FUN_00467e62(void *this,int *param_1,byte *param_2,undefined4 *param_3)

{
  byte bVar1;
  undefined4 *puVar2;
  int *piVar3;
  byte bVar4;
  uint uVar5;
  uint uVar6;
  void *this_00;
  int *extraout_ECX;
  int *extraout_ECX_00;
  int *extraout_ECX_01;
  void *this_01;
  int *extraout_ECX_02;
  int *extraout_ECX_03;
  int *piVar7;
  byte bVar8;
  byte *pbVar9;
  byte *pbVar10;
  char *pcVar11;
  char *pcVar12;
  WCHAR *pWVar13;
  undefined *puVar14;
  int iVar15;
  bool bVar16;
  int *piVar17;
  char local_1c8;
  char local_1c7 [351];
  byte local_68 [32];
  undefined4 *local_48;
  WCHAR local_42;
  uint local_40;
  byte local_3c;
  undefined1 local_3b;
  byte local_39;
  int local_38;
  WCHAR *local_34;
  WCHAR *local_30;
  undefined8 local_2c;
  int local_24;
  int local_20;
  byte local_1c;
  char local_1b;
  char local_1a;
  char local_19;
  int *local_18;
  char local_13;
  char local_12;
  char local_11;
  int local_10;
  char local_9;
  undefined *local_8;
  
  local_19 = '\0';
  bVar1 = *param_2;
  local_8 = (undefined *)0x0;
  local_38 = 0;
  pbVar9 = param_2;
  piVar7 = (int *)crt_ctype_table;
  do {
    crt_ctype_table = (undefined *)piVar7;
    if (bVar1 == 0) {
LAB_00468868:
      if (local_18 == (int *)0xffffffff) {
LAB_0046886e:
        if ((local_38 == 0) && (local_19 == '\0')) {
          local_38 = -1;
        }
      }
      return local_38;
    }
    if ((int)DAT_0047b3cc < 2) {
      uVar5 = *(byte *)((int)piVar7 + (uint)bVar1 * 2) & 8;
    }
    else {
      piVar7 = (int *)0x8;
      uVar5 = crt_isctype(this,(uint)bVar1,8);
    }
    if (uVar5 != 0) {
      local_8 = local_8 + -1;
      piVar7 = param_1;
      uVar5 = FUN_004688ef((int *)&local_8,param_1);
      FUN_004688d8(uVar5,piVar7);
      uVar5 = crt_isspace(this_00,(uint)pbVar9[1]);
      piVar7 = extraout_ECX;
      pbVar10 = pbVar9;
      while (pbVar9 = pbVar10 + 1, uVar5 != 0) {
        piVar17 = (int *)(uint)pbVar10[2];
        uVar5 = crt_isspace(piVar7,(int)(uint)pbVar10[2]);
        piVar7 = piVar17;
        pbVar10 = pbVar9;
      }
    }
    if (*pbVar9 == 0x25) {
      local_39 = 0;
      local_1c = 0;
      local_1b = '\0';
      local_12 = '\0';
      local_13 = '\0';
      local_1a = '\0';
      puVar14 = (undefined *)0x0;
      local_9 = '\0';
      local_20 = 0;
      local_24 = 0;
      local_10 = 0;
      local_11 = '\x01';
      local_34 = (WCHAR *)0x0;
      do {
        uVar5 = (uint)pbVar9[1];
        param_2 = pbVar9 + 1;
        if ((int)DAT_0047b3cc < 2) {
          uVar6 = (byte)crt_ctype_table[uVar5 * 2] & 4;
          piVar7 = (int *)crt_ctype_table;
        }
        else {
          piVar17 = (int *)0x4;
          uVar6 = crt_isctype(piVar7,uVar5,4);
          piVar7 = piVar17;
        }
        if (uVar6 == 0) {
          if (uVar5 < 0x4f) {
            if (uVar5 != 0x4e) {
              if (uVar5 == 0x2a) {
                local_12 = local_12 + '\x01';
              }
              else if (uVar5 != 0x46) {
                if (uVar5 == 0x49) {
                  if ((pbVar9[2] != 0x36) || (pbVar9[3] != 0x34)) goto LAB_00467fbd;
                  local_34 = (WCHAR *)((int)local_34 + 1);
                  local_2c = 0;
                  param_2 = pbVar9 + 3;
                }
                else if (uVar5 == 0x4c) {
                  local_11 = local_11 + '\x01';
                }
                else {
LAB_00467fbd:
                  local_13 = local_13 + '\x01';
                }
              }
            }
          }
          else if (uVar5 == 0x68) {
            local_11 = local_11 + -1;
            local_9 = local_9 + -1;
          }
          else {
            if (uVar5 == 0x6c) {
              local_11 = local_11 + '\x01';
            }
            else if (uVar5 != 0x77) goto LAB_00467fbd;
            local_9 = local_9 + '\x01';
          }
        }
        else {
          local_24 = local_24 + 1;
          local_10 = (uVar5 - 0x30) + local_10 * 10;
        }
        pbVar9 = param_2;
      } while (local_13 == '\0');
      puVar2 = param_3;
      if (local_12 == '\0') {
        local_30 = (WCHAR *)*param_3;
        puVar2 = param_3 + 1;
        local_48 = param_3;
      }
      param_3 = puVar2;
      local_13 = '\0';
      if (local_9 == '\0') {
        if ((*param_2 == 0x53) || (*param_2 == 0x43)) {
          local_9 = '\x01';
        }
        else {
          local_9 = -1;
        }
      }
      uVar5 = *param_2 | 0x20;
      local_40 = uVar5;
      if (uVar5 != 0x6e) {
        if ((uVar5 == 99) || (uVar5 == 0x7b)) {
          local_8 = local_8 + 1;
          piVar7 = param_1;
          local_18 = (int *)FUN_004688be(param_1);
        }
        else {
          piVar7 = param_1;
          local_18 = (int *)FUN_004688ef((int *)&local_8,param_1);
        }
      }
      if ((local_24 != 0) && (local_10 == 0)) {
LAB_00468848:
        local_8 = local_8 + -1;
        FUN_004688d8((uint)local_18,param_1);
        goto LAB_00468868;
      }
      if (uVar5 < 0x70) {
        if (uVar5 == 0x6f) {
LAB_00468575:
          if (local_18 == (int *)0x2d) {
            local_1b = '\x01';
          }
          else if (local_18 != (int *)0x2b) goto LAB_004685aa;
          local_10 = local_10 + -1;
          if ((local_10 == 0) && (local_24 != 0)) {
            local_13 = '\x01';
          }
          else {
            local_8 = local_8 + 1;
            piVar7 = param_1;
            local_18 = (int *)FUN_004688be(param_1);
          }
          goto LAB_004685aa;
        }
        if (uVar5 != 99) {
          if (uVar5 == 100) goto LAB_00468575;
          if (uVar5 < 0x65) {
LAB_004682ed:
            if ((int *)(uint)*param_2 != local_18) goto LAB_00468848;
            local_19 = local_19 + -1;
            if (local_12 == '\0') {
              param_3 = local_48;
            }
            goto LAB_004687c9;
          }
          if (0x67 < uVar5) {
            if (uVar5 == 0x69) {
              uVar5 = 100;
              goto LAB_004680ab;
            }
            if (uVar5 != 0x6e) goto LAB_004682ed;
            puVar14 = local_8;
            if (local_12 != '\0') goto LAB_004687c9;
            goto LAB_004687a3;
          }
          pcVar11 = &local_1c8;
          if (local_18 == (int *)0x2d) {
            local_1c8 = '-';
            pcVar11 = local_1c7;
LAB_004680e1:
            local_10 = local_10 + -1;
            local_8 = local_8 + 1;
            piVar7 = param_1;
            local_18 = (int *)FUN_004688be(param_1);
          }
          else if (local_18 == (int *)0x2b) goto LAB_004680e1;
          if ((local_24 == 0) || (0x15d < local_10)) {
            local_10 = 0x15d;
          }
          while( true ) {
            piVar17 = local_18;
            if ((int)DAT_0047b3cc < 2) {
              uVar5 = (byte)crt_ctype_table[(int)local_18 * 2] & 4;
            }
            else {
              uVar5 = crt_isctype(piVar7,(int)local_18,4);
            }
            if ((uVar5 == 0) ||
               (iVar15 = local_10 + -1, bVar16 = local_10 == 0, local_10 = iVar15, bVar16)) break;
            local_20 = local_20 + 1;
            *pcVar11 = (char)piVar17;
            pcVar11 = pcVar11 + 1;
            local_8 = local_8 + 1;
            piVar7 = param_1;
            local_18 = (int *)FUN_004688be(param_1);
          }
          if ((DAT_0047b3d0 == (char)piVar17) &&
             (iVar15 = local_10 + -1, bVar16 = local_10 != 0, local_10 = iVar15, bVar16)) {
            local_8 = local_8 + 1;
            piVar7 = param_1;
            piVar17 = (int *)FUN_004688be(param_1);
            *pcVar11 = DAT_0047b3d0;
            while( true ) {
              pcVar11 = pcVar11 + 1;
              local_18 = piVar17;
              if ((int)DAT_0047b3cc < 2) {
                uVar5 = (byte)crt_ctype_table[(int)piVar17 * 2] & 4;
              }
              else {
                uVar5 = crt_isctype(piVar7,(int)piVar17,4);
              }
              if ((uVar5 == 0) ||
                 (iVar15 = local_10 + -1, bVar16 = local_10 == 0, local_10 = iVar15, bVar16)) break;
              local_20 = local_20 + 1;
              *pcVar11 = (char)piVar17;
              local_8 = local_8 + 1;
              piVar7 = param_1;
              piVar17 = (int *)FUN_004688be(param_1);
            }
          }
          pcVar12 = pcVar11;
          if ((local_20 != 0) &&
             (((piVar17 == (int *)0x65 || (piVar17 == (int *)0x45)) &&
              (iVar15 = local_10 + -1, bVar16 = local_10 != 0, local_10 = iVar15, bVar16)))) {
            *pcVar11 = 'e';
            pcVar12 = pcVar11 + 1;
            local_8 = local_8 + 1;
            piVar7 = param_1;
            piVar17 = (int *)FUN_004688be(param_1);
            local_18 = piVar17;
            if (piVar17 == (int *)0x2d) {
              *pcVar12 = '-';
              pcVar12 = pcVar11 + 2;
LAB_00468208:
              bVar16 = local_10 != 0;
              local_10 = local_10 + -1;
              if (bVar16) goto LAB_00468217;
              local_10 = 0;
            }
            else if (piVar17 == (int *)0x2b) goto LAB_00468208;
            while( true ) {
              if ((int)DAT_0047b3cc < 2) {
                uVar5 = (byte)crt_ctype_table[(int)piVar17 * 2] & 4;
              }
              else {
                uVar5 = crt_isctype(piVar7,(int)piVar17,4);
              }
              if ((uVar5 == 0) ||
                 (iVar15 = local_10 + -1, bVar16 = local_10 == 0, local_10 = iVar15, bVar16)) break;
              local_20 = local_20 + 1;
              *pcVar12 = (char)piVar17;
              pcVar12 = pcVar12 + 1;
LAB_00468217:
              local_8 = local_8 + 1;
              piVar7 = param_1;
              piVar17 = (int *)FUN_004688be(param_1);
              local_18 = piVar17;
            }
          }
          local_8 = local_8 + -1;
          piVar7 = param_1;
          FUN_004688d8((uint)piVar17,param_1);
          if (local_20 != 0) {
            if (local_12 == '\0') {
              local_38 = local_38 + 1;
              *pcVar12 = '\0';
              (*(code *)PTR_FUN_0047b1b0)(local_11 + -1,local_30,&local_1c8);
              piVar7 = extraout_ECX_00;
            }
            goto LAB_004687c9;
          }
          goto LAB_00468868;
        }
        if (local_24 == 0) {
          local_10 = local_10 + 1;
          local_24 = 1;
        }
        if ('\0' < local_9) {
          local_1a = '\x01';
        }
        pcVar11 = &DAT_0047db20;
LAB_004683ce:
        local_1c = 0xff;
        pbVar9 = (byte *)pcVar11;
        pbVar10 = param_2;
LAB_004683d2:
        param_2 = pbVar10;
        _memset(local_68,0,0x20);
        if ((local_40 == 0x7b) && (*pbVar9 == 0x5d)) {
          uVar5 = 0x5d;
          local_68[0xb] = 0x20;
          pbVar9 = pbVar9 + 1;
        }
        else {
          uVar5 = (uint)local_39;
        }
        while (pWVar13 = local_30, bVar1 = *pbVar9, bVar1 != 0x5d) {
          if (((bVar1 == 0x2d) && (bVar8 = (byte)uVar5, bVar8 != 0)) &&
             (bVar4 = pbVar9[1], bVar4 != 0x5d)) {
            if (bVar4 <= bVar8) {
              uVar5 = (uint)bVar4;
              bVar4 = bVar8;
            }
            if ((byte)uVar5 <= bVar4) {
              iVar15 = (bVar4 - uVar5) + 1;
              do {
                local_68[uVar5 >> 3] = local_68[uVar5 >> 3] | '\x01' << ((byte)uVar5 & 7);
                uVar5 = uVar5 + 1;
                iVar15 = iVar15 + -1;
              } while (iVar15 != 0);
            }
            uVar5 = 0;
            pbVar9 = pbVar9 + 2;
          }
          else {
            uVar5 = (uint)bVar1;
            local_68[bVar1 >> 3] = local_68[bVar1 >> 3] | '\x01' << (bVar1 & 7);
            pbVar9 = pbVar9 + 1;
          }
        }
        if (*pbVar9 == 0) goto LAB_00468868;
        if (local_40 == 0x7b) {
          param_2 = pbVar9;
        }
        local_8 = local_8 + -1;
        local_34 = local_30;
        piVar7 = param_1;
        FUN_004688d8((uint)local_18,param_1);
        while( true ) {
          if ((local_24 != 0) &&
             (iVar15 = local_10 + -1, bVar16 = local_10 == 0, local_10 = iVar15, bVar16))
          goto LAB_00468537;
          local_8 = local_8 + 1;
          local_18 = (int *)FUN_004688be(param_1);
          if (local_18 == (int *)0xffffffff) break;
          bVar1 = (byte)local_18;
          piVar7 = (int *)(int)(char)(local_68[(int)local_18 >> 3] ^ local_1c);
          if (((uint)piVar7 & 1 << (bVar1 & 7)) == 0) break;
          if (local_12 == '\0') {
            if (local_1a == '\0') {
              *(byte *)pWVar13 = bVar1;
              pWVar13 = (WCHAR *)((int)pWVar13 + 1);
              local_30 = pWVar13;
            }
            else {
              local_3c = bVar1;
              if ((crt_ctype_table[((uint)local_18 & 0xff) * 2 + 1] & 0x80) != 0) {
                local_8 = local_8 + 1;
                uVar5 = FUN_004688be(param_1);
                local_3b = (undefined1)uVar5;
              }
              FUN_0046cfeb(&local_42,&local_3c,DAT_0047b3cc);
              *pWVar13 = local_42;
              pWVar13 = pWVar13 + 1;
              piVar7 = extraout_ECX_01;
              local_30 = pWVar13;
            }
          }
          else {
            local_34 = (WCHAR *)((int)local_34 + 1);
          }
        }
        local_8 = local_8 + -1;
        piVar7 = param_1;
        FUN_004688d8((uint)local_18,param_1);
LAB_00468537:
        if (local_34 == pWVar13) goto LAB_00468868;
        if ((local_12 == '\0') && (local_38 = local_38 + 1, local_40 != 99)) {
          if (local_1a == '\0') {
            *(byte *)local_30 = 0;
          }
          else {
            *local_30 = L'\0';
          }
        }
      }
      else {
        if (uVar5 == 0x70) {
          local_11 = '\x01';
          goto LAB_00468575;
        }
        if (uVar5 == 0x73) {
          if ('\0' < local_9) {
            local_1a = '\x01';
          }
          pcVar11 = s_____0047db18;
          goto LAB_004683ce;
        }
        if (uVar5 == 0x75) goto LAB_00468575;
        if (uVar5 != 0x78) {
          if (uVar5 != 0x7b) goto LAB_004682ed;
          if ('\0' < local_9) {
            local_1a = '\x01';
          }
          pbVar9 = param_2 + 1;
          pbVar10 = pbVar9;
          if (*pbVar9 == 0x5e) {
            pcVar11 = (char *)(param_2 + 2);
            param_2 = pbVar9;
            goto LAB_004683ce;
          }
          goto LAB_004683d2;
        }
LAB_004680ab:
        if (local_18 == (int *)0x2d) {
          local_1b = '\x01';
LAB_0046833a:
          local_10 = local_10 + -1;
          if ((local_10 == 0) && (local_24 != 0)) {
            local_13 = '\x01';
          }
          else {
            local_8 = local_8 + 1;
            piVar7 = param_1;
            local_18 = (int *)FUN_004688be(param_1);
          }
        }
        else if (local_18 == (int *)0x2b) goto LAB_0046833a;
        if (local_18 == (int *)0x30) {
          local_8 = local_8 + 1;
          piVar7 = param_1;
          local_18 = (int *)FUN_004688be(param_1);
          if (((char)local_18 == 'x') || ((char)local_18 == 'X')) {
            local_8 = local_8 + 1;
            piVar7 = param_1;
            local_18 = (int *)FUN_004688be(param_1);
            uVar5 = 0x78;
          }
          else {
            local_20 = 1;
            if (uVar5 == 0x78) {
              local_8 = local_8 + -1;
              piVar7 = param_1;
              FUN_004688d8((uint)local_18,param_1);
              local_18 = (int *)0x30;
            }
            else {
              uVar5 = 0x6f;
            }
          }
        }
LAB_004685aa:
        if (local_34 == (WCHAR *)0x0) {
          if (local_13 == '\0') {
            while ((piVar17 = local_18, uVar5 != 0x78 && (uVar5 != 0x70))) {
              if ((int)DAT_0047b3cc < 2) {
                uVar6 = (byte)crt_ctype_table[(int)local_18 * 2] & 4;
              }
              else {
                piVar3 = (int *)0x4;
                uVar6 = crt_isctype(piVar7,(int)local_18,4);
                piVar7 = piVar3;
              }
              if (uVar6 == 0) goto LAB_00468771;
              if (uVar5 == 0x6f) {
                if (0x37 < (int)piVar17) goto LAB_00468771;
                iVar15 = (int)puVar14 << 3;
              }
              else {
                iVar15 = (int)puVar14 * 10;
              }
LAB_00468749:
              local_20 = local_20 + 1;
              puVar14 = (undefined *)(iVar15 + -0x30 + (int)piVar17);
              if ((local_24 != 0) && (local_10 = local_10 + -1, local_10 == 0)) goto LAB_0046877f;
              local_8 = local_8 + 1;
              piVar7 = param_1;
              local_18 = (int *)FUN_004688be(param_1);
            }
            if ((int)DAT_0047b3cc < 2) {
              uVar6 = (byte)crt_ctype_table[(int)local_18 * 2] & 0x80;
            }
            else {
              piVar3 = (int *)0x80;
              uVar6 = crt_isctype(piVar7,(int)local_18,0x80);
              piVar7 = piVar3;
            }
            if (uVar6 != 0) {
              iVar15 = (int)puVar14 << 4;
              piVar3 = piVar17;
              piVar17 = (int *)FUN_00468887(piVar7,(uint)piVar17);
              piVar7 = piVar3;
              local_18 = piVar17;
              goto LAB_00468749;
            }
LAB_00468771:
            local_8 = local_8 + -1;
            piVar7 = param_1;
            FUN_004688d8((uint)piVar17,param_1);
          }
LAB_0046877f:
          if (local_1b != '\0') {
            puVar14 = (undefined *)-(int)puVar14;
          }
        }
        else {
          if (local_13 == '\0') {
            while (piVar17 = local_18, uVar5 != 0x78) {
              if ((int)DAT_0047b3cc < 2) {
                uVar6 = (byte)crt_ctype_table[(int)local_18 * 2] & 4;
              }
              else {
                uVar6 = crt_isctype(piVar7,(int)local_18,4);
              }
              if (uVar6 == 0) goto LAB_00468693;
              if (uVar5 == 0x6f) {
                if (0x37 < (int)piVar17) goto LAB_00468693;
                local_2c = __allshl(3,(int)local_2c._4_4_);
                piVar7 = extraout_ECX_02;
              }
              else {
                local_2c = __allmul((uint)local_2c,(int)local_2c._4_4_,10,0);
                piVar7 = extraout_ECX_03;
              }
LAB_00468665:
              local_20 = local_20 + 1;
              piVar17 = piVar17 + -0xc;
              local_2c = CONCAT44((int)local_2c._4_4_ + ((int)piVar17 >> 0x1f) +
                                  (uint)CARRY4((uint)local_2c,(uint)piVar17),
                                  (undefined *)((uint)local_2c + (int)piVar17));
              if ((local_24 != 0) && (local_10 = local_10 + -1, local_10 == 0)) goto LAB_004686a1;
              local_8 = local_8 + 1;
              piVar7 = param_1;
              local_18 = (int *)FUN_004688be(param_1);
            }
            if ((int)DAT_0047b3cc < 2) {
              uVar6 = (byte)crt_ctype_table[(int)local_18 * 2] & 0x80;
            }
            else {
              uVar6 = crt_isctype(piVar7,(int)local_18,0x80);
            }
            if (uVar6 != 0) {
              local_2c = __allshl(4,(int)local_2c._4_4_);
              piVar7 = piVar17;
              piVar17 = (int *)FUN_00468887(this_01,(uint)piVar17);
              local_18 = piVar17;
              goto LAB_00468665;
            }
LAB_00468693:
            local_8 = local_8 + -1;
            piVar7 = param_1;
            FUN_004688d8((uint)piVar17,param_1);
          }
LAB_004686a1:
          if (local_1b != '\0') {
            piVar7 = (int *)-((int)local_2c._4_4_ + (uint)((uint)local_2c != 0));
            local_2c = CONCAT44(piVar7,-(uint)local_2c);
          }
        }
        if (uVar5 == 0x46) {
          local_20 = 0;
        }
        if (local_20 == 0) goto LAB_00468868;
        if (local_12 == '\0') {
          local_38 = local_38 + 1;
LAB_004687a3:
          if (local_34 == (WCHAR *)0x0) {
            if (local_11 == '\0') {
              *local_30 = (WCHAR)puVar14;
            }
            else {
              *(undefined **)local_30 = puVar14;
            }
          }
          else {
            *(uint *)local_30 = (uint)local_2c;
            *(int **)(local_30 + 2) = local_2c._4_4_;
            piVar7 = local_2c._4_4_;
          }
        }
      }
LAB_004687c9:
      local_19 = local_19 + '\x01';
      param_2 = param_2 + 1;
      this = piVar7;
    }
    else {
      local_8 = local_8 + 1;
      piVar7 = (int *)FUN_004688be(param_1);
      param_2 = pbVar9 + 1;
      local_18 = piVar7;
      if ((int *)(uint)*pbVar9 != piVar7) goto LAB_00468848;
      this = crt_ctype_table;
      if ((crt_ctype_table[((uint)piVar7 & 0xff) * 2 + 1] & 0x80) != 0) {
        local_8 = local_8 + 1;
        piVar17 = (int *)FUN_004688be(param_1);
        this = (void *)(uint)*param_2;
        param_2 = pbVar9 + 2;
        if (this != piVar17) {
          local_8 = local_8 + -1;
          FUN_004688d8((uint)piVar17,param_1);
          local_8 = local_8 + -1;
          FUN_004688d8((uint)piVar7,param_1);
          goto LAB_00468868;
        }
        local_8 = local_8 + -1;
      }
    }
    if ((local_18 == (int *)0xffffffff) && ((*param_2 != 0x25 || (param_2[1] != 0x6e))))
    goto LAB_0046886e;
    bVar1 = *param_2;
    pbVar9 = param_2;
    piVar7 = (int *)crt_ctype_table;
  } while( true );
}



/* FUN_00468887 @ 00468887 */

uint __thiscall FUN_00468887(void *this,uint param_1)

{
  uint uVar1;
  
  if (DAT_0047b3cc < 2) {
    uVar1 = (byte)crt_ctype_table[param_1 * 2] & 4;
  }
  else {
    uVar1 = crt_isctype(this,param_1,4);
  }
  if (uVar1 == 0) {
    param_1 = (param_1 & 0xffffffdf) - 7;
  }
  return param_1;
}



/* FUN_004688be @ 004688be */

/* [binja] uint32_t sub_4688be(int32_t* arg1) */

uint __cdecl FUN_004688be(int *arg1)

{
  int *piVar1;
  byte bVar2;
  uint uVar3;
  
  piVar1 = arg1 + 1;
  *piVar1 = *piVar1 + -1;
  if (-1 < *piVar1) {
    bVar2 = *(byte *)*arg1;
    *arg1 = (int)((byte *)*arg1 + 1);
    return (uint)bVar2;
  }
  uVar3 = crt_filbuf((FILE *)arg1);
  return uVar3;
}



/* FUN_004688d8 @ 004688d8 */

void __cdecl FUN_004688d8(uint param_1,int *param_2)

{
  if (param_1 != 0xffffffff) {
    FUN_0046d13f(param_1,param_2);
  }
  return;
}



/* FUN_004688ef @ 004688ef */

/* [binja] uint32_t sub_4688ef(int32_t* arg1, int32_t* arg2) */

uint __cdecl FUN_004688ef(int *arg1,int *arg2)

{
  uint c;
  uint uVar1;
  void *this;
  
  do {
    *arg1 = *arg1 + 1;
    c = FUN_004688be(arg2);
    uVar1 = crt_isspace(this,c);
  } while (uVar1 != 0);
  return c;
}



/* crt_skip_program_name @ 00468913 */

/* returns command line tail after argv[0] */

uchar * crt_skip_program_name(void)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  
  if (DAT_004db4ec == 0) {
    crt_mbcs_init();
  }
  bVar1 = *DAT_004db4e4;
  pbVar4 = DAT_004db4e4;
  if (bVar1 == 0x22) {
    while( true ) {
      pbVar3 = pbVar4;
      bVar1 = pbVar3[1];
      pbVar4 = pbVar3 + 1;
      if ((bVar1 == 0x22) || (bVar1 == 0)) break;
      iVar2 = FUN_0046d1ad(bVar1);
      if (iVar2 != 0) {
        pbVar4 = pbVar3 + 2;
      }
    }
    if (*pbVar4 == 0x22) goto LAB_00468950;
  }
  else {
    while (0x20 < bVar1) {
      bVar1 = pbVar4[1];
      pbVar4 = pbVar4 + 1;
    }
  }
  for (; (*pbVar4 != 0 && (*pbVar4 < 0x21)); pbVar4 = pbVar4 + 1) {
LAB_00468950:
  }
  return pbVar4;
}



/* crt_build_environ @ 0046896b */

/* builds environ array from environment block */

void crt_build_environ(void)

{
  char cVar1;
  size_t sVar2;
  undefined4 *puVar3;
  void *pvVar4;
  int iVar5;
  char *pcVar6;
  
  if (DAT_004db4ec == 0) {
    crt_mbcs_init();
  }
  iVar5 = 0;
  for (pcVar6 = DAT_004d99c4; *pcVar6 != '\0'; pcVar6 = pcVar6 + sVar2 + 1) {
    if (*pcVar6 != '=') {
      iVar5 = iVar5 + 1;
    }
    sVar2 = _strlen(pcVar6);
  }
  puVar3 = _malloc(iVar5 * 4 + 4);
  DAT_004d99a0 = puVar3;
  if (puVar3 == (undefined4 *)0x0) {
    __amsg_exit(9);
  }
  cVar1 = *DAT_004d99c4;
  pcVar6 = DAT_004d99c4;
  while (cVar1 != '\0') {
    sVar2 = _strlen(pcVar6);
    if (*pcVar6 != '=') {
      pvVar4 = _malloc(sVar2 + 1);
      *puVar3 = pvVar4;
      if (pvVar4 == (void *)0x0) {
        __amsg_exit(9);
      }
      crt_strcpy((char *)*puVar3,pcVar6);
      puVar3 = puVar3 + 1;
    }
    pcVar6 = pcVar6 + sVar2 + 1;
    cVar1 = *pcVar6;
  }
  crt_free_base(DAT_004d99c4);
  DAT_004d99c4 = (char *)0x0;
  *puVar3 = 0;
  DAT_004db4e8 = 1;
  return;
}



/* crt_build_argv @ 00468a24 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* parses command line into argv/argc */

void crt_build_argv(void)

{
  undefined4 *puVar1;
  byte *pbVar2;
  int local_c;
  int local_8;
  
  if (DAT_004db4ec == 0) {
    crt_mbcs_init();
  }
  GetModuleFileNameA((HMODULE)0x0,&DAT_004d9a7c,0x104);
  _DAT_004d99b0 = &DAT_004d9a7c;
  pbVar2 = &DAT_004d9a7c;
  if (*DAT_004db4e4 != 0) {
    pbVar2 = DAT_004db4e4;
  }
  crt_parse_cmdline(pbVar2,(undefined4 *)0x0,(byte *)0x0,&local_8,&local_c);
  puVar1 = _malloc(local_c + local_8 * 4);
  if (puVar1 == (undefined4 *)0x0) {
    __amsg_exit(8);
  }
  crt_parse_cmdline(pbVar2,puVar1,(byte *)(puVar1 + local_8),&local_8,&local_c);
  _DAT_004d9998 = puVar1;
  _DAT_004d9994 = local_8 + -1;
  return;
}



/* crt_parse_cmdline @ 00468abd */

/* low-level argv parser for command line */

void __cdecl
crt_parse_cmdline(byte *param_1,undefined4 *param_2,byte *param_3,int *param_4,int *param_5)

{
  byte bVar1;
  bool bVar2;
  bool bVar3;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  undefined4 *puVar7;
  
  *param_5 = 0;
  *param_4 = 1;
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = param_3;
    param_2 = param_2 + 1;
  }
  if (*param_1 == 0x22) {
    while( true ) {
      bVar1 = param_1[1];
      pbVar4 = param_1 + 1;
      if ((bVar1 == 0x22) || (bVar1 == 0)) break;
      if (((*(byte *)((int)&DAT_004da280 + bVar1 + 1) & 4) != 0) &&
         (*param_5 = *param_5 + 1, param_3 != (byte *)0x0)) {
        *param_3 = *pbVar4;
        param_3 = param_3 + 1;
        pbVar4 = param_1 + 2;
      }
      *param_5 = *param_5 + 1;
      param_1 = pbVar4;
      if (param_3 != (byte *)0x0) {
        *param_3 = *pbVar4;
        param_3 = param_3 + 1;
      }
    }
    *param_5 = *param_5 + 1;
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    if (*pbVar4 == 0x22) {
      pbVar4 = param_1 + 2;
    }
  }
  else {
    do {
      *param_5 = *param_5 + 1;
      if (param_3 != (byte *)0x0) {
        *param_3 = *param_1;
        param_3 = param_3 + 1;
      }
      bVar1 = *param_1;
      pbVar4 = param_1 + 1;
      if ((*(byte *)((int)&DAT_004da280 + bVar1 + 1) & 4) != 0) {
        *param_5 = *param_5 + 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = *pbVar4;
          param_3 = param_3 + 1;
        }
        pbVar4 = param_1 + 2;
      }
      if (bVar1 == 0x20) break;
      if (bVar1 == 0) goto LAB_00468b68;
      param_1 = pbVar4;
    } while (bVar1 != 9);
    if (bVar1 == 0) {
LAB_00468b68:
      pbVar4 = pbVar4 + -1;
    }
    else if (param_3 != (byte *)0x0) {
      param_3[-1] = 0;
    }
  }
  bVar2 = false;
  puVar7 = param_2;
  while (*pbVar4 != 0) {
    for (; (*pbVar4 == 0x20 || (*pbVar4 == 9)); pbVar4 = pbVar4 + 1) {
    }
    if (*pbVar4 == 0) break;
    if (puVar7 != (undefined4 *)0x0) {
      *puVar7 = param_3;
      puVar7 = puVar7 + 1;
      param_2 = puVar7;
    }
    *param_4 = *param_4 + 1;
    while( true ) {
      bVar3 = true;
      uVar6 = 0;
      for (; *pbVar4 == 0x5c; pbVar4 = pbVar4 + 1) {
        uVar6 = uVar6 + 1;
      }
      if (*pbVar4 == 0x22) {
        pbVar5 = pbVar4;
        if ((uVar6 & 1) == 0) {
          if ((!bVar2) || (pbVar5 = pbVar4 + 1, pbVar4[1] != 0x22)) {
            bVar3 = false;
            pbVar5 = pbVar4;
          }
          bVar2 = !bVar2;
          puVar7 = param_2;
        }
        uVar6 = uVar6 >> 1;
        pbVar4 = pbVar5;
      }
      for (; uVar6 != 0; uVar6 = uVar6 - 1) {
        if (param_3 != (byte *)0x0) {
          *param_3 = 0x5c;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      bVar1 = *pbVar4;
      if ((bVar1 == 0) || ((!bVar2 && ((bVar1 == 0x20 || (bVar1 == 9)))))) break;
      if (bVar3) {
        if (param_3 == (byte *)0x0) {
          if ((*(byte *)((int)&DAT_004da280 + bVar1 + 1) & 4) != 0) {
            pbVar4 = pbVar4 + 1;
            *param_5 = *param_5 + 1;
          }
        }
        else {
          if ((*(byte *)((int)&DAT_004da280 + bVar1 + 1) & 4) != 0) {
            *param_3 = bVar1;
            param_3 = param_3 + 1;
            pbVar4 = pbVar4 + 1;
            *param_5 = *param_5 + 1;
          }
          *param_3 = *pbVar4;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      pbVar4 = pbVar4 + 1;
    }
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    *param_5 = *param_5 + 1;
  }
  if (puVar7 != (undefined4 *)0x0) {
    *puVar7 = 0;
  }
  *param_4 = *param_4 + 1;
  return;
}



/* crt_get_environment_strings @ 00468c71 */

/* returns a malloc'd copy of the environment block */

char * crt_get_environment_strings(void)

{
  char cVar1;
  WCHAR WVar2;
  WCHAR *pWVar3;
  WCHAR *pWVar4;
  int iVar5;
  size_t _Size;
  LPSTR lpMultiByteStr;
  char *pcVar6;
  char *pcVar7;
  LPWCH lpWideCharStr;
  LPCH penv;
  LPSTR local_8;
  
  lpWideCharStr = (LPWCH)0x0;
  penv = (LPCH)0x0;
  if (DAT_004d9b80 == 0) {
    lpWideCharStr = GetEnvironmentStringsW();
    if (lpWideCharStr != (LPWCH)0x0) {
      DAT_004d9b80 = 1;
LAB_00468cc8:
      if ((lpWideCharStr == (LPWCH)0x0) &&
         (lpWideCharStr = GetEnvironmentStringsW(), lpWideCharStr == (LPWCH)0x0)) {
        return (char *)0x0;
      }
      WVar2 = *lpWideCharStr;
      pWVar4 = lpWideCharStr;
      while (WVar2 != L'\0') {
        do {
          pWVar3 = pWVar4;
          pWVar4 = pWVar3 + 1;
        } while (*pWVar4 != L'\0');
        pWVar4 = pWVar3 + 2;
        WVar2 = *pWVar4;
      }
      iVar5 = ((int)pWVar4 - (int)lpWideCharStr >> 1) + 1;
      _Size = WideCharToMultiByte(0,0,lpWideCharStr,iVar5,(LPSTR)0x0,0,(LPCCH)0x0,(LPBOOL)0x0);
      local_8 = (LPSTR)0x0;
      if (((_Size != 0) && (lpMultiByteStr = _malloc(_Size), lpMultiByteStr != (LPSTR)0x0)) &&
         (iVar5 = WideCharToMultiByte(0,0,lpWideCharStr,iVar5,lpMultiByteStr,_Size,(LPCCH)0x0,
                                      (LPBOOL)0x0), local_8 = lpMultiByteStr, iVar5 == 0)) {
        crt_free_base(lpMultiByteStr);
        local_8 = (LPSTR)0x0;
      }
      FreeEnvironmentStringsW(lpWideCharStr);
      return local_8;
    }
    penv = GetEnvironmentStrings();
    if (penv == (LPCH)0x0) {
      return (char *)0x0;
    }
    DAT_004d9b80 = 2;
  }
  else {
    if (DAT_004d9b80 == 1) goto LAB_00468cc8;
    if (DAT_004d9b80 != 2) {
      return (char *)0x0;
    }
  }
  if ((penv == (LPCH)0x0) && (penv = GetEnvironmentStrings(), penv == (LPCH)0x0)) {
    return (char *)0x0;
  }
  cVar1 = *penv;
  pcVar6 = penv;
  while (cVar1 != '\0') {
    do {
      pcVar7 = pcVar6;
      pcVar6 = pcVar7 + 1;
    } while (*pcVar6 != '\0');
    pcVar6 = pcVar7 + 2;
    cVar1 = *pcVar6;
  }
  pcVar7 = _malloc((size_t)(pcVar6 + (1 - (int)penv)));
  if (pcVar7 == (char *)0x0) {
    pcVar7 = (char *)0x0;
  }
  else {
    crt_bufcpy(pcVar7,penv,(size_t)(pcVar6 + (1 - (int)penv)));
  }
  FreeEnvironmentStringsA(penv);
  return pcVar7;
}



/* crt_runtime_error_banner @ 00468da3 */

/* runtime error prolog/epilog around report */

void crt_runtime_error_banner(void)

{
  if ((DAT_004d99cc == 1) || ((DAT_004d99cc == 0 && (DAT_0047b184 == 1)))) {
    crt_report_runtime_error(0xfc);
    if (DAT_004d9b84 != (code *)0x0) {
      (*DAT_004d9b84)();
    }
    crt_report_runtime_error(0xff);
  }
  return;
}



/* crt_report_runtime_error @ 00468ddc */

/* formats and displays CRT runtime errors */

void __cdecl crt_report_runtime_error(DWORD param_1)

{
  undefined4 *puVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  size_t sVar4;
  HANDLE hFile;
  int iVar5;
  CHAR *_Dest;
  char acStackY_1e3 [7];
  LPCVOID lpBuffer;
  LPOVERLAPPED lpOverlapped;
  CHAR local_1a8 [260];
  char local_a4 [160];
  
  iVar5 = 0;
  pDVar2 = &DAT_0047db28;
  do {
    if (param_1 == *pDVar2) break;
    pDVar2 = pDVar2 + 2;
    iVar5 = iVar5 + 1;
  } while (pDVar2 < &DAT_0047dbb8);
  if (param_1 == (&DAT_0047db28)[iVar5 * 2]) {
    if ((DAT_004d99cc == 1) || ((DAT_004d99cc == 0 && (DAT_0047b184 == 1)))) {
      pDVar2 = &param_1;
      puVar1 = (undefined4 *)(iVar5 * 8 + 0x47db2c);
      lpOverlapped = (LPOVERLAPPED)0x0;
      sVar4 = _strlen((char *)*puVar1);
      lpBuffer = (LPCVOID)*puVar1;
      hFile = GetStdHandle(0xfffffff4);
      WriteFile(hFile,lpBuffer,sVar4,pDVar2,lpOverlapped);
    }
    else if (param_1 != 0xfc) {
      DVar3 = GetModuleFileNameA((HMODULE)0x0,local_1a8,0x104);
      if (DVar3 == 0) {
        crt_strcpy(local_1a8,"<program name unknown>");
      }
      _Dest = local_1a8;
      sVar4 = _strlen(local_1a8);
      if (0x3c < sVar4 + 1) {
        sVar4 = _strlen(local_1a8);
        _Dest = acStackY_1e3 + sVar4;
        _strncpy(_Dest,"...",3);
      }
      crt_strcpy(local_a4,"Runtime Error!\n\nProgram: ");
      crt_strcat(local_a4,_Dest);
      crt_strcat(local_a4,"\n\n");
      crt_strcat(local_a4,*(char **)(iVar5 * 8 + 0x47db2c));
      acStackY_1e3[3] = '\0';
      acStackY_1e3[4] = -0x71;
      acStackY_1e3[5] = 'F';
      acStackY_1e3[6] = '\0';
      FUN_0046d5e3((int)local_a4,0x46feb8,0x12010);
    }
  }
  return;
}



/* FUN_00468f2f @ 00468f2f */

float10 __cdecl FUN_00468f2f(undefined8 param_1,short param_2)

{
  undefined8 local_c;
  
  local_c = (double)CONCAT26((param_2 + 0x3fe) * 0x10 | param_1._6_2_ & 0x800f,(int6)param_1);
  return (float10)local_c;
}



/* FUN_00468f58 @ 00468f58 */

undefined4 __cdecl FUN_00468f58(int param_1,uint param_2)

{
  undefined4 uStack_8;
  
  if (param_2 == 0x7ff00000) {
    if (param_1 == 0) {
      return 1;
    }
  }
  else if ((param_2 == 0xfff00000) && (param_1 == 0)) {
    return 2;
  }
  if ((param_2._2_2_ & 0x7ff8) == 0x7ff8) {
    uStack_8 = 3;
  }
  else {
    if (((param_2._2_2_ & 0x7ff8) != 0x7ff0) || (((param_2 & 0x7ffff) == 0 && (param_1 == 0)))) {
      return 0;
    }
    uStack_8 = 4;
  }
  return uStack_8;
}



/* FUN_00468fb2 @ 00468fb2 */

float10 __cdecl FUN_00468fb2(uint param_1,uint param_2,int *param_3)

{
  ushort uVar1;
  int iVar2;
  bool bVar3;
  int iVar4;
  float10 fVar5;
  undefined8 local_c;
  
  if ((double)CONCAT17(param_2._3_1_,CONCAT16(param_2._2_1_,CONCAT24((ushort)param_2,param_1))) ==
      0.0) {
    iVar4 = 0;
    local_c = 0.0;
  }
  else if (((param_2 & 0x7ff00000) == 0) && (((param_2 & 0xfffff) != 0 || (param_1 != 0)))) {
    iVar4 = -0x3fd;
    if (0.0 <= (double)CONCAT17(param_2._3_1_,
                                CONCAT16(param_2._2_1_,CONCAT24((ushort)param_2,param_1)))) {
      bVar3 = false;
    }
    else {
      bVar3 = true;
    }
    while ((param_2._2_1_ & 0x10) == 0) {
      iVar2 = CONCAT13(param_2._3_1_,CONCAT12(param_2._2_1_,(ushort)param_2)) << 1;
      param_2._0_2_ = (ushort)iVar2;
      param_2._2_1_ = (byte)((uint)iVar2 >> 0x10);
      param_2._3_1_ = (byte)((uint)iVar2 >> 0x18);
      if ((param_1 & 0x80000000) != 0) {
        param_2._0_2_ = (ushort)param_2 | 1;
      }
      param_1 = param_1 << 1;
      iVar4 = iVar4 + -1;
    }
    uVar1 = CONCAT11(param_2._3_1_,param_2._2_1_) & 0xffef;
    param_2._2_1_ = (byte)uVar1;
    param_2._3_1_ = (byte)(uVar1 >> 8);
    if (bVar3) {
      param_2._3_1_ = param_2._3_1_ | 0x80;
    }
    fVar5 = FUN_00468f2f(CONCAT17(param_2._3_1_,
                                  CONCAT16(param_2._2_1_,CONCAT24((ushort)param_2,param_1))),0);
    local_c = (double)fVar5;
  }
  else {
    fVar5 = FUN_00468f2f(CONCAT17(param_2._3_1_,
                                  CONCAT16(param_2._2_1_,CONCAT24((ushort)param_2,param_1))),0);
    local_c = (double)fVar5;
    iVar4 = (short)((ushort)(param_2 >> 0x14) & 0x7ff) + -0x3fe;
  }
  *param_3 = iVar4;
  return (float10)local_c;
}



/* FUN_00469073 @ 00469073 */

void __cdecl
FUN_00469073(uint *param_1,uint *param_2,uint param_3,uint param_4,undefined8 *param_5,
            undefined8 *param_6)

{
  uint *puVar1;
  undefined8 *puVar2;
  uint uVar3;
  
  uVar3 = param_3;
  puVar1 = param_2;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  if ((param_3 & 0x10) != 0) {
    param_3 = 0xc000008f;
    param_1[1] = param_1[1] | 1;
  }
  if ((uVar3 & 2) != 0) {
    param_3 = 0xc0000093;
    param_1[1] = param_1[1] | 2;
  }
  if ((uVar3 & 1) != 0) {
    param_3 = 0xc0000091;
    param_1[1] = param_1[1] | 4;
  }
  if ((uVar3 & 4) != 0) {
    param_3 = 0xc000008e;
    param_1[1] = param_1[1] | 8;
  }
  if ((uVar3 & 8) != 0) {
    param_3 = 0xc0000090;
    param_1[1] = param_1[1] | 0x10;
  }
  param_1[2] = (~*param_2 & 1) << 4 | param_1[2] & 0xffffffef;
  param_1[2] = (~*param_2 & 4) << 1 | param_1[2] & 0xfffffff7;
  param_1[2] = ~*param_2 >> 1 & 4 | param_1[2] & 0xfffffffb;
  param_1[2] = ~*param_2 >> 3 & 2 | param_1[2] & 0xfffffffd;
  param_1[2] = ~*param_2 >> 5 & 1 | param_1[2] & 0xfffffffe;
  uVar3 = FUN_00469565();
  puVar2 = param_6;
  if ((uVar3 & 1) != 0) {
    param_1[3] = param_1[3] | 0x10;
  }
  if ((uVar3 & 4) != 0) {
    param_1[3] = param_1[3] | 8;
  }
  if ((uVar3 & 8) != 0) {
    param_1[3] = param_1[3] | 4;
  }
  if ((uVar3 & 0x10) != 0) {
    param_1[3] = param_1[3] | 2;
  }
  if ((uVar3 & 0x20) != 0) {
    param_1[3] = param_1[3] | 1;
  }
  uVar3 = *puVar1 & 0xc00;
  if (uVar3 == 0) {
    *param_1 = *param_1 & 0xfffffffc;
  }
  else {
    if (uVar3 == 0x400) {
      uVar3 = *param_1 & 0xfffffffd | 1;
    }
    else {
      if (uVar3 != 0x800) {
        if (uVar3 == 0xc00) {
          *param_1 = *param_1 | 3;
        }
        goto LAB_004691e8;
      }
      uVar3 = *param_1 & 0xfffffffe | 2;
    }
    *param_1 = uVar3;
  }
LAB_004691e8:
  uVar3 = *puVar1 & 0x300;
  if (uVar3 == 0) {
    uVar3 = *param_1 & 0xffffffeb | 8;
LAB_0046921e:
    *param_1 = uVar3;
  }
  else {
    if (uVar3 == 0x200) {
      uVar3 = *param_1 & 0xffffffe7 | 4;
      goto LAB_0046921e;
    }
    if (uVar3 == 0x300) {
      *param_1 = *param_1 & 0xffffffe3;
    }
  }
  *param_1 = (param_4 & 0xfff) << 5 | *param_1 & 0xfffe001f;
  param_1[8] = param_1[8] | 1;
  param_1[8] = param_1[8] & 0xffffffe3 | 2;
  *(undefined8 *)(param_1 + 4) = *param_5;
  param_1[0x14] = param_1[0x14] | 1;
  param_1[0x14] = param_1[0x14] & 0xffffffe3 | 2;
  *(undefined8 *)(param_1 + 0x10) = *param_6;
  FUN_00469573();
  RaiseException(param_3,0,1,(ULONG_PTR *)&param_1);
  if ((param_1[2] & 0x10) != 0) {
    *puVar1 = *puVar1 & 0xfffffffe;
  }
  if ((param_1[2] & 8) != 0) {
    *puVar1 = *puVar1 & 0xfffffffb;
  }
  if ((param_1[2] & 4) != 0) {
    *puVar1 = *puVar1 & 0xfffffff7;
  }
  if ((param_1[2] & 2) != 0) {
    *puVar1 = *puVar1 & 0xffffffef;
  }
  if ((param_1[2] & 1) != 0) {
    *puVar1 = *puVar1 & 0xffffffdf;
  }
  uVar3 = *param_1 & 3;
  if (uVar3 == 0) {
    *puVar1 = *puVar1 & 0xfffff3ff;
  }
  else {
    if (uVar3 == 1) {
      uVar3 = *puVar1 & 0xfffff7ff | 0x400;
    }
    else {
      if (uVar3 != 2) {
        if (uVar3 == 3) {
          *(byte *)((int)puVar1 + 1) = *(byte *)((int)puVar1 + 1) | 0xc;
        }
        goto LAB_004692f3;
      }
      uVar3 = *puVar1 & 0xfffffbff | 0x800;
    }
    *puVar1 = uVar3;
  }
LAB_004692f3:
  uVar3 = *param_1 >> 2 & 7;
  if (uVar3 == 0) {
    uVar3 = *puVar1 & 0xfffff3ff | 0x300;
  }
  else {
    if (uVar3 != 1) {
      if (uVar3 == 2) {
        *puVar1 = *puVar1 & 0xfffff3ff;
      }
      goto LAB_0046931c;
    }
    uVar3 = *puVar1 & 0xfffff3ff | 0x200;
  }
  *puVar1 = uVar3;
LAB_0046931c:
  *puVar2 = *(undefined8 *)(param_1 + 0x10);
  return;
}



/* FUN_00469326 @ 00469326 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

bool __cdecl FUN_00469326(uint param_1,double *param_2,uint param_3)

{
  double dVar1;
  bool bVar2;
  uint uVar3;
  bool bVar4;
  float10 fVar5;
  undefined8 local_10;
  int local_8;
  
  uVar3 = param_1 & 0x1f;
  bVar2 = true;
  if (((param_1 & 8) != 0) && ((param_3 & 1) != 0)) {
    FUN_004695a5();
    uVar3 = param_1 & 0x17;
    goto LAB_0046951b;
  }
  if (((param_1 & 4) != 0) && ((param_3 & 4) != 0)) {
    FUN_004695a5();
    uVar3 = param_1 & 0x1b;
    goto LAB_0046951b;
  }
  if (((param_1 & 1) == 0) || ((param_3 & 8) == 0)) {
    if (((param_1 & 2) != 0) && ((param_3 & 0x10) != 0)) {
      bVar4 = (param_1 & 0x10) != 0;
      dVar1 = *param_2;
      if (dVar1 != 0.0) {
        fVar5 = FUN_00468fb2(SUB84(dVar1,0),(uint)((ulonglong)dVar1 >> 0x20),&local_8);
        local_8 = local_8 + -0x600;
        if (local_8 < -0x432) {
          local_10 = 0.0;
          bVar4 = bVar2;
        }
        else {
          local_10 = (double)(ulonglong)
                             (SUB87((double)fVar5,0) & 0xfffffffffffff | 0x10000000000000);
          if (local_8 < -0x3fd) {
            local_8 = -0x3fd - local_8;
            do {
              if ((((ulonglong)local_10 & 1) != 0) && (!bVar4)) {
                bVar4 = bVar2;
              }
              uVar3 = (uint)local_10 >> 1;
              if (((ulonglong)local_10 & 0x100000000) != 0) {
                local_10._3_1_ = (byte)((ulonglong)local_10 >> 0x18) >> 1;
                local_10._0_3_ = (undefined3)uVar3;
                local_10._0_4_ = CONCAT13(local_10._3_1_,(undefined3)local_10) | 0x80000000;
                uVar3 = (uint)local_10;
              }
              local_10._0_4_ = uVar3;
              local_10 = (double)CONCAT44(local_10._4_4_ >> 1,(uint)local_10);
              local_8 = local_8 + -1;
            } while (local_8 != 0);
          }
          if ((double)fVar5 < 0.0) {
            local_10 = -local_10;
          }
        }
        *param_2 = local_10;
        bVar2 = bVar4;
      }
      if (bVar2) {
        FUN_004695a5();
      }
      uVar3 = param_1 & 0x1d;
    }
    goto LAB_0046951b;
  }
  FUN_004695a5();
  uVar3 = param_3 & 0xc00;
  dVar1 = _DAT_0047dbb8;
  if (uVar3 == 0) {
    if (*param_2 <= 0.0) {
      dVar1 = -_DAT_0047dbb8;
    }
LAB_0046943b:
    *param_2 = dVar1;
  }
  else {
    if (uVar3 == 0x400) {
      dVar1 = _DAT_0047dbc8;
      if (*param_2 <= 0.0) {
        dVar1 = -_DAT_0047dbb8;
      }
      goto LAB_0046943b;
    }
    if (uVar3 == 0x800) {
      if (*param_2 <= 0.0) {
        dVar1 = -_DAT_0047dbc8;
      }
      goto LAB_0046943b;
    }
    if (uVar3 == 0xc00) {
      dVar1 = _DAT_0047dbc8;
      if (*param_2 <= 0.0) {
        dVar1 = -_DAT_0047dbc8;
      }
      goto LAB_0046943b;
    }
  }
  uVar3 = param_1 & 0x1e;
LAB_0046951b:
  if (((param_1 & 0x10) != 0) && ((param_3 & 0x20) != 0)) {
    FUN_004695a5();
    uVar3 = uVar3 & 0xffffffef;
  }
  return uVar3 == 0;
}



/* FUN_0046953d @ 0046953d */

/* [binja] int32_t* sub_46953d(int32_t* arg1) */

int * __cdecl FUN_0046953d(int *arg1)

{
  int *piVar1;
  
  if (arg1 == (int *)0x1) {
    arg1 = crt_errno_ptr();
    *arg1 = 0x21;
  }
  else if ((1 < (int)arg1) && ((int)arg1 < 4)) {
    piVar1 = crt_errno_ptr();
    *piVar1 = 0x22;
    return piVar1;
  }
  return arg1;
}



/* FUN_00469565 @ 00469565 */

int FUN_00469565(void)

{
  short in_FPUStatusWord;
  
  return (int)in_FPUStatusWord;
}



/* FUN_00469573 @ 00469573 */

int FUN_00469573(void)

{
  short in_FPUStatusWord;
  
  return (int)in_FPUStatusWord;
}



/* FUN_00469582 @ 00469582 */

int FUN_00469582(void)

{
  short in_FPUControlWord;
  
  return (int)in_FPUControlWord;
}



/* FUN_004695a5 @ 004695a5 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_004695a5(void)

{
  return;
}



/* crt_cxx_frame_handler @ 004695fb */

/* MSVC C++ exception frame handler */

int __cdecl
crt_cxx_frame_handler
          (PEXCEPTION_RECORD record,PVOID frame,DWORD context,void *dispatcher,int *func_info,
          int try_level,PVOID handler_data,char is_rethrow)

{
  code *pcVar1;
  int iVar2;
  
  if (*func_info != 0x19930520) {
    crt_invalid_parameter_noinfo_noreturn();
  }
  if ((record->ExceptionFlags & 0x66) == 0) {
    if (func_info[3] != 0) {
      if (((record->ExceptionCode == 0xe06d7363) && (0x19930520 < record->ExceptionInformation[0]))
         && (pcVar1 = *(code **)(record->ExceptionInformation[2] + 8), pcVar1 != (code *)0x0)) {
        iVar2 = (*pcVar1)(record,frame,context,dispatcher,func_info,try_level,handler_data,
                          is_rethrow);
        return iVar2;
      }
      FUN_00469696(record,frame,context,dispatcher,(int)func_info,is_rethrow,try_level,handler_data)
      ;
    }
  }
  else if ((func_info[1] != 0) && (try_level == 0)) {
    FUN_00469950((int)frame,dispatcher,(int)func_info,-1);
  }
  return 1;
}



/* FUN_00469696 @ 00469696 */

void __cdecl
FUN_00469696(PEXCEPTION_RECORD param_1,PVOID param_2,DWORD param_3,undefined4 param_4,int param_5,
            char param_6,int param_7,PVOID param_8)

{
  byte *arg1;
  bool bVar1;
  DWORD *pDVar2;
  undefined3 extraout_var;
  int *piVar3;
  int iVar4;
  int *piVar5;
  uint local_1c;
  uint local_18;
  int local_14;
  int local_10;
  int local_c;
  uint local_8;
  
  local_18 = local_18 & 0xffffff00;
  local_14 = *(int *)((int)param_2 + 8);
  if ((local_14 < -1) || (*(int *)(param_5 + 4) <= local_14)) {
    crt_invalid_parameter_noinfo_noreturn();
  }
  if (param_1->ExceptionCode == 0xe06d7363) {
    if (((param_1->NumberParameters == 3) && (param_1->ExceptionInformation[0] == 0x19930520)) &&
       (param_1->ExceptionInformation[2] == 0)) {
      pDVar2 = crt_get_thread_data();
      if (pDVar2[0x1b] == 0) {
        return;
      }
      pDVar2 = crt_get_thread_data();
      param_1 = (PEXCEPTION_RECORD)pDVar2[0x1b];
      pDVar2 = crt_get_thread_data();
      param_3 = pDVar2[0x1c];
      local_18 = CONCAT31(local_18._1_3_,1);
      bVar1 = FUN_0046d6d3(param_1,1);
      if (CONCAT31(extraout_var,bVar1) == 0) {
        crt_invalid_parameter_noinfo_noreturn();
      }
      if (param_1->ExceptionCode != 0xe06d7363) goto LAB_0046981e;
      if (((param_1->NumberParameters == 3) && (param_1->ExceptionInformation[0] == 0x19930520)) &&
         (param_1->ExceptionInformation[2] == 0)) {
        crt_invalid_parameter_noinfo_noreturn();
      }
    }
    iVar4 = local_14;
    if (((param_1->ExceptionCode == 0xe06d7363) && (param_1->NumberParameters == 3)) &&
       (param_1->ExceptionInformation[0] == 0x19930520)) {
      piVar3 = (int *)FUN_0046355c(param_5,param_7,local_14,&local_8,&local_1c);
      do {
        if (local_1c <= local_8) {
          if (param_6 == '\0') {
            return;
          }
          FUN_00469d72(param_1);
          return;
        }
        if ((*piVar3 <= iVar4) && (iVar4 <= piVar3[1])) {
          arg1 = (byte *)piVar3[4];
          for (local_10 = piVar3[3]; iVar4 = local_14, 0 < local_10; local_10 = local_10 + -1) {
            piVar5 = *(int **)(param_1->ExceptionInformation[2] + 0xc);
            for (local_c = *piVar5; 0 < local_c; local_c = local_c + -1) {
              piVar5 = piVar5 + 1;
              iVar4 = FUN_004698f3((char *)arg1,(char *)*piVar5,
                                   (int *)param_1->ExceptionInformation[2]);
              if (iVar4 != 0) {
                FUN_004699ee(param_1,param_2,param_3,param_4,param_5,arg1,(byte *)*piVar5,piVar3,
                             param_7,param_8);
                iVar4 = local_14;
                goto LAB_004697fe;
              }
            }
            arg1 = arg1 + 0x10;
          }
        }
LAB_004697fe:
        local_8 = local_8 + 1;
        piVar3 = piVar3 + 5;
      } while( true );
    }
  }
LAB_0046981e:
  if (param_6 == '\0') {
    FUN_00469849(param_1,param_2,param_3,param_4,param_5,local_14,param_7,param_8);
    return;
  }
  crt_terminate();
  return;
}



/* FUN_00469849 @ 00469849 */

void __cdecl
FUN_00469849(PEXCEPTION_RECORD param_1,PVOID param_2,DWORD param_3,undefined4 param_4,int param_5,
            int param_6,int param_7,PVOID param_8)

{
  DWORD *pDVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  uint local_c;
  uint local_8;
  
  pDVar1 = crt_get_thread_data();
  if ((pDVar1[0x1a] != 0) &&
     (iVar2 = FUN_00463431(&param_1->ExceptionCode,param_2,param_3,param_4,param_5,param_7,param_8),
     iVar2 != 0)) {
    return;
  }
  piVar3 = (int *)FUN_0046355c(param_5,param_7,param_6,&local_8,&local_c);
  for (; local_8 < local_c; local_8 = local_8 + 1) {
    if ((*piVar3 <= param_6) && (param_6 <= piVar3[1])) {
      iVar4 = piVar3[3] * 0x10 + piVar3[4];
      iVar2 = *(int *)(iVar4 + -0xc);
      if ((iVar2 == 0) || (*(char *)(iVar2 + 8) == '\0')) {
        FUN_004699ee(param_1,param_2,param_3,param_4,param_5,(byte *)(iVar4 + -0x10),(byte *)0x0,
                     piVar3,param_7,param_8);
      }
    }
    piVar3 = piVar3 + 5;
  }
  return;
}



/* FUN_004698f3 @ 004698f3 */

/* [binja] int32_t sub_4698f3(char* arg1, char* arg2, int32_t* arg3) */

int __cdecl FUN_004698f3(char *arg1,char *arg2,int *arg3)

{
  int iVar1;
  
  iVar1 = *(int *)(arg1 + 4);
  if ((iVar1 == 0) || (*(char *)(iVar1 + 8) == '\0')) {
LAB_0046994a:
    iVar1 = 1;
  }
  else {
    if (iVar1 == *(int *)(arg2 + 4)) {
LAB_00469924:
      if (((((*arg2 & 2U) == 0) || ((*arg1 & 8U) != 0)) &&
          (((*arg3 & 1U) == 0 || ((*arg1 & 1U) != 0)))) &&
         (((*arg3 & 2U) == 0 || ((*arg1 & 2U) != 0)))) goto LAB_0046994a;
    }
    else {
      iVar1 = _strcmp((char *)(iVar1 + 8),(char *)(*(int *)(arg2 + 4) + 8));
      if (iVar1 == 0) goto LAB_00469924;
    }
    iVar1 = 0;
  }
  return iVar1;
}



/* FUN_00469950 @ 00469950 */

void __cdecl FUN_00469950(int param_1,undefined4 param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0046ffd0;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  for (iVar2 = *(int *)(param_1 + 8); local_8 = 0xffffffff, iVar2 != param_4;
      iVar2 = *(int *)(*(int *)(param_3 + 8) + iVar2 * 8)) {
    if ((iVar2 < 0) || (*(int *)(param_3 + 4) <= iVar2)) {
      crt_invalid_parameter_noinfo_noreturn();
    }
    local_8 = 0;
    iVar1 = *(int *)(*(int *)(param_3 + 8) + 4 + iVar2 * 8);
    if (iVar1 != 0) {
      __CallSettingFrame_12(iVar1,param_1,0x103);
    }
  }
  *(int *)(param_1 + 8) = iVar2;
  ExceptionList = local_14;
  return;
}



/* FUN_004699ee @ 004699ee */

void __cdecl
FUN_004699ee(PEXCEPTION_RECORD param_1,PVOID param_2,DWORD param_3,undefined4 param_4,int param_5,
            byte *param_6,byte *param_7,int *param_8,int param_9,PVOID param_10)

{
  undefined *UNRECOVERED_JUMPTABLE;
  
  if (param_7 != (byte *)0x0) {
    FUN_00469bae(param_1,(int)param_2,(char *)param_6,(char *)param_7);
  }
  if (param_10 == (PVOID)0x0) {
    param_10 = param_2;
  }
  FUN_00463333((int)param_10,param_1);
  FUN_00469950((int)param_2,param_4,param_5,*param_8);
  *(int *)((int)param_2 + 8) = param_8[1] + 1;
  UNRECOVERED_JUMPTABLE =
       (undefined *)
       FUN_00469a69((DWORD)param_1,param_2,param_3,param_5,*(undefined4 *)(param_6 + 0xc),param_9,
                    0x100);
  if (UNRECOVERED_JUMPTABLE != (undefined *)0x0) {
    FUN_004632f1(UNRECOVERED_JUMPTABLE);
  }
  return;
}



/* FUN_00469a69 @ 00469a69 */

undefined4 __cdecl
FUN_00469a69(DWORD param_1,undefined4 param_2,DWORD param_3,undefined4 param_4,undefined4 param_5,
            int param_6,int param_7)

{
  DWORD *pDVar1;
  undefined4 uVar2;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0046ffe0;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  crt_get_thread_data();
  crt_get_thread_data();
  pDVar1 = crt_get_thread_data();
  pDVar1[0x1b] = param_1;
  pDVar1 = crt_get_thread_data();
  pDVar1[0x1c] = param_3;
  local_8 = 1;
  uVar2 = FUN_004633b8(param_2,param_4,param_5,param_6,param_7);
  local_8 = 0xffffffff;
  FUN_00469b36();
  ExceptionList = local_14;
  return uVar2;
}



/* FUN_00469b36 @ 00469b36 */

void FUN_00469b36(void)

{
  DWORD *pDVar1;
  int unaff_EBP;
  int unaff_ESI;
  int *unaff_EDI;
  
  *(undefined4 *)(unaff_ESI + -4) = *(undefined4 *)(unaff_EBP + -0x28);
  pDVar1 = crt_get_thread_data();
  pDVar1[0x1b] = *(DWORD *)(unaff_EBP + -0x1c);
  pDVar1 = crt_get_thread_data();
  pDVar1[0x1c] = *(DWORD *)(unaff_EBP + -0x20);
  if ((((*unaff_EDI == -0x1f928c9d) && (unaff_EDI[4] == 3)) && (unaff_EDI[5] == 0x19930520)) &&
     ((*(int *)(unaff_EBP + -0x24) == 0 && (*(int *)(unaff_EBP + -0x2c) != 0)))) {
    __abnormal_termination();
    FUN_00469d72(unaff_EDI);
  }
  return;
}



/* FUN_00469bae @ 00469bae */

/* [binja] void* sub_469bae(void* arg1, int32_t arg2, char* arg3, char* arg4) */

void * __cdecl FUN_00469bae(void *arg1,int arg2,char *arg3,char *arg4)

{
  int *dst;
  bool bVar1;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  int iVar2;
  void *pvVar3;
  undefined3 extraout_var_01;
  undefined3 extraout_var_02;
  undefined3 extraout_var_03;
  undefined3 extraout_var_04;
  undefined3 extraout_var_05;
  undefined3 extraout_var_06;
  undefined3 extraout_var_07;
  void *extraout_EAX;
  size_t size;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0046fff8;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  pvVar3 = *(void **)(arg3 + 4);
  if (pvVar3 == (void *)0x0) {
    return (void *)0x0;
  }
  if (*(char *)((int)pvVar3 + 8) == '\0') {
    return pvVar3;
  }
  if (*(int *)(arg3 + 8) == 0) {
    return (void *)0x0;
  }
  dst = (int *)(*(int *)(arg3 + 8) + 0xc + arg2);
  local_8 = 0;
  if ((*arg3 & 8U) == 0) {
    if ((*arg4 & 1U) == 0) {
      if (*(int *)(arg4 + 0x18) == 0) {
        ExceptionList = &local_14;
        bVar1 = FUN_0046d6d3(*(void **)((int)arg1 + 0x18),1);
        if ((CONCAT31(extraout_var_03,bVar1) != 0) &&
           (bVar1 = FUN_0046d6ef(dst,1), CONCAT31(extraout_var_04,bVar1) != 0)) {
          size = *(size_t *)(arg4 + 0x14);
          pvVar3 = (void *)FUN_00469dd9(*(int *)((int)arg1 + 0x18),(int *)(arg4 + 8));
          pvVar3 = crt_memmove(dst,pvVar3,size);
          ExceptionList = local_14;
          return pvVar3;
        }
      }
      else {
        ExceptionList = &local_14;
        bVar1 = FUN_0046d6d3(*(void **)((int)arg1 + 0x18),1);
        if (((CONCAT31(extraout_var_05,bVar1) != 0) &&
            (bVar1 = FUN_0046d6ef(dst,1), CONCAT31(extraout_var_06,bVar1) != 0)) &&
           (bVar1 = FUN_0046d70b(*(FARPROC *)(arg4 + 0x18)), CONCAT31(extraout_var_07,bVar1) != 0))
        {
          if ((*arg4 & 4U) != 0) {
            FUN_00469dd9(*(int *)((int)arg1 + 0x18),(int *)(arg4 + 8));
            pvVar3 = (void *)FUN_0046332c((int)dst,*(void **)(arg4 + 0x18));
            ExceptionList = local_14;
            return pvVar3;
          }
          FUN_00469dd9(*(int *)((int)arg1 + 0x18),(int *)(arg4 + 8));
          pvVar3 = (void *)FUN_00463325((int)dst,*(void **)(arg4 + 0x18));
          ExceptionList = local_14;
          return pvVar3;
        }
      }
    }
    else {
      ExceptionList = &local_14;
      bVar1 = FUN_0046d6d3(*(void **)((int)arg1 + 0x18),1);
      if ((CONCAT31(extraout_var_01,bVar1) != 0) &&
         (bVar1 = FUN_0046d6ef(dst,1), CONCAT31(extraout_var_02,bVar1) != 0)) {
        pvVar3 = crt_memmove(dst,*(void **)((int)arg1 + 0x18),*(size_t *)(arg4 + 0x14));
        if (*(int *)(arg4 + 0x14) != 4) {
          ExceptionList = local_14;
          return pvVar3;
        }
        iVar2 = *dst;
        if (iVar2 == 0) {
          ExceptionList = local_14;
          return (void *)0x0;
        }
        goto LAB_00469c3c;
      }
    }
  }
  else {
    ExceptionList = &local_14;
    bVar1 = FUN_0046d6d3(*(void **)((int)arg1 + 0x18),1);
    if ((CONCAT31(extraout_var,bVar1) != 0) &&
       (bVar1 = FUN_0046d6ef(dst,1), CONCAT31(extraout_var_00,bVar1) != 0)) {
      iVar2 = *(int *)((int)arg1 + 0x18);
      *dst = iVar2;
LAB_00469c3c:
      pvVar3 = (void *)FUN_00469dd9(iVar2,(int *)(arg4 + 8));
      *dst = (int)pvVar3;
      ExceptionList = local_14;
      return pvVar3;
    }
  }
  crt_invalid_parameter_noinfo_noreturn();
  ExceptionList = local_14;
  return extraout_EAX;
}



/* FUN_00469d72 @ 00469d72 */

/* [binja] void* sub_469d72(void* arg1) */

void * __cdecl FUN_00469d72(void *arg1)

{
  void *arg2;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_00470008;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  if ((arg1 != (void *)0x0) &&
     (arg2 = *(void **)(*(int *)((int)arg1 + 0x1c) + 4), arg2 != (void *)0x0)) {
    local_8 = 0;
    ExceptionList = &local_14;
    arg1 = (void *)FUN_00463325(*(int *)((int)arg1 + 0x18),arg2);
  }
  ExceptionList = local_14;
  return arg1;
}



/* FUN_00469dd9 @ 00469dd9 */

int __cdecl FUN_00469dd9(int param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  
  iVar1 = param_2[1];
  iVar2 = *param_2 + param_1;
  if (-1 < iVar1) {
    iVar2 = iVar2 + *(int *)(*(int *)(iVar1 + param_1) + param_2[2]) + iVar1;
  }
  return iVar2;
}



/* __CallSettingFrame@12 @ 00469e00 */

/* WARNING: Restarted to delay deadcode elimination for space: stack */
/* Library Function - Single Match
    __CallSettingFrame@12
   
   Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
   Studio 2019 Release */

void __CallSettingFrame_12(undefined4 param_1,undefined4 param_2,int param_3)

{
  code *pcVar1;
  
  pcVar1 = (code *)__NLG_Notify1(param_3);
  (*pcVar1)();
  if (param_3 == 0x100) {
    param_3 = 2;
  }
  __NLG_Notify1(param_3);
  return;
}



/* FUN_00469e4c @ 00469e4c */

uint __thiscall FUN_00469e4c(void *this,uint param_1,uint param_2)

{
  uint uVar1;
  undefined2 in_FPUControlWord;
  undefined4 local_8;
  
  local_8 = CONCAT22((short)((uint)this >> 0x10),in_FPUControlWord);
  uVar1 = FUN_00469e97(local_8);
  uVar1 = uVar1 & ~param_2 | param_1 & param_2;
  FUN_00469f29(uVar1);
  return uVar1;
}



/* FUN_00469e81 @ 00469e81 */

void __thiscall FUN_00469e81(void *this,uint param_1,uint param_2)

{
  FUN_00469e4c(this,param_1,param_2 & 0xfff7ffff);
  return;
}



/* FUN_00469e97 @ 00469e97 */

uint __cdecl FUN_00469e97(uint param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = 0;
  if ((param_1 & 1) != 0) {
    uVar1 = 0x10;
  }
  if ((param_1 & 4) != 0) {
    uVar1 = uVar1 | 8;
  }
  if ((param_1 & 8) != 0) {
    uVar1 = uVar1 | 4;
  }
  if ((param_1 & 0x10) != 0) {
    uVar1 = uVar1 | 2;
  }
  if ((param_1 & 0x20) != 0) {
    uVar1 = uVar1 | 1;
  }
  if ((param_1 & 2) != 0) {
    uVar1 = uVar1 | 0x80000;
  }
  uVar2 = param_1 & 0xc00;
  if (uVar2 != 0) {
    if (uVar2 == 0x400) {
      uVar1 = uVar1 | 0x100;
    }
    else if (uVar2 == 0x800) {
      uVar1 = uVar1 | 0x200;
    }
    else if (uVar2 == 0xc00) {
      uVar1 = uVar1 | 0x300;
    }
  }
  if ((param_1 & 0x300) == 0) {
    uVar1 = uVar1 | 0x20000;
  }
  else if ((param_1 & 0x300) == 0x200) {
    uVar1 = uVar1 | 0x10000;
  }
  if ((param_1 & 0x1000) != 0) {
    uVar1 = uVar1 | 0x40000;
  }
  return uVar1;
}



/* FUN_00469f29 @ 00469f29 */

uint __cdecl FUN_00469f29(uint param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = (uint)((param_1 & 0x10) != 0);
  if ((param_1 & 8) != 0) {
    uVar1 = uVar1 | 4;
  }
  if ((param_1 & 4) != 0) {
    uVar1 = uVar1 | 8;
  }
  if ((param_1 & 2) != 0) {
    uVar1 = uVar1 | 0x10;
  }
  if ((param_1 & 1) != 0) {
    uVar1 = uVar1 | 0x20;
  }
  if ((param_1 & 0x80000) != 0) {
    uVar1 = uVar1 | 2;
  }
  uVar2 = param_1 & 0x300;
  if (uVar2 != 0) {
    if (uVar2 == 0x100) {
      uVar1 = uVar1 | 0x400;
    }
    else if (uVar2 == 0x200) {
      uVar1 = uVar1 | 0x800;
    }
    else if (uVar2 == 0x300) {
      uVar1 = uVar1 | 0xc00;
    }
  }
  if ((param_1 & 0x30000) == 0) {
    uVar1 = uVar1 | 0x300;
  }
  else if ((param_1 & 0x30000) == 0x10000) {
    uVar1 = uVar1 | 0x200;
  }
  if ((param_1 & 0x40000) != 0) {
    uVar1 = uVar1 | 0x1000;
  }
  return uVar1;
}



/* FUN_00469fb2 @ 00469fb2 */

/* [binja] int32_t sub_469fb2(int32_t arg1, int32_t arg2) */

int __cdecl FUN_00469fb2(int arg1,int arg2)

{
  int *piVar1;
  int iVar2;
  
  if ((*(uint *)(arg1 + (arg2 / 0x20) * 4) & ~(-1 << (0x1fU - (char)(arg2 % 0x20) & 0x1f))) != 0) {
    return 0;
  }
  iVar2 = arg2 / 0x20 + 1;
  if (iVar2 < 3) {
    piVar1 = (int *)(arg1 + iVar2 * 4);
    do {
      if (*piVar1 != 0) {
        return 0;
      }
      iVar2 = iVar2 + 1;
      piVar1 = piVar1 + 1;
    } while (iVar2 < 3);
  }
  return 1;
}



/* FUN_00469ffb @ 00469ffb */

/* [binja] int32_t sub_469ffb(int32_t arg1, int32_t arg2) */

int __cdecl FUN_00469ffb(int arg1,int arg2)

{
  int iVar1;
  int iVar2;
  uint *puVar3;
  
  puVar3 = (uint *)(arg1 + (arg2 / 0x20) * 4);
  iVar1 = crt_add_u32_carry(*puVar3,1 << (0x1fU - (char)(arg2 % 0x20) & 0x1f),puVar3);
  iVar2 = arg2 / 0x20 + -1;
  if (-1 < iVar2) {
    puVar3 = (uint *)(arg1 + iVar2 * 4);
    do {
      if (iVar1 == 0) {
        return 0;
      }
      iVar1 = crt_add_u32_carry(*puVar3,1,puVar3);
      iVar2 = iVar2 + -1;
      puVar3 = puVar3 + -1;
    } while (-1 < iVar2);
  }
  return iVar1;
}



/* FUN_0046a051 @ 0046a051 */

/* [binja] int32_t sub_46a051(int32_t arg1, int32_t* arg2) */

int __cdecl FUN_0046a051(int arg1,int *arg2)

{
  uint *puVar1;
  int iVar2;
  byte bVar3;
  int iVar4;
  undefined4 *puVar5;
  int local_8;
  
  local_8 = 0;
  puVar1 = (uint *)(arg1 + ((int)arg2 / 0x20) * 4);
  bVar3 = 0x1f - (char)((int)arg2 % 0x20);
  if (((*puVar1 & 1 << (bVar3 & 0x1f)) != 0) &&
     (iVar2 = FUN_00469fb2(arg1,(int)arg2 + 1), iVar2 == 0)) {
    local_8 = FUN_00469ffb(arg1,(int)arg2 + -1);
  }
  *puVar1 = *puVar1 & -1 << (bVar3 & 0x1f);
  iVar2 = (int)arg2 / 0x20 + 1;
  if (iVar2 < 3) {
    puVar5 = (undefined4 *)(arg1 + iVar2 * 4);
    for (iVar4 = 3 - iVar2; iVar4 != 0; iVar4 = iVar4 + -1) {
      *puVar5 = 0;
      puVar5 = puVar5 + 1;
    }
  }
  return local_8;
}



/* FUN_0046a0dd @ 0046a0dd */

/* [binja] int32_t* sub_46a0dd(int32_t arg1, int32_t* arg2) */

int * __cdecl FUN_0046a0dd(int arg1,int *arg2)

{
  int iVar1;
  int iVar2;
  
  iVar1 = arg1 - (int)arg2;
  iVar2 = 3;
  do {
    *(int *)(iVar1 + (int)arg2) = *arg2;
    arg2 = arg2 + 1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  return arg2;
}



/* FUN_0046a0f8 @ 0046a0f8 */

/* [binja] void sub_46a0f8(int32_t* arg1) */

void __cdecl FUN_0046a0f8(int *arg1)

{
  *arg1 = 0;
  arg1[1] = 0;
  arg1[2] = 0;
  return;
}



/* FUN_0046a104 @ 0046a104 */

/* [binja] int32_t sub_46a104(int32_t* arg1) */

int __cdecl FUN_0046a104(int *arg1)

{
  int iVar1;
  
  iVar1 = 0;
  do {
    if (*arg1 != 0) {
      return 0;
    }
    iVar1 = iVar1 + 1;
    arg1 = arg1 + 1;
  } while (iVar1 < 3);
  return 1;
}



/* FUN_0046a11f @ 0046a11f */

/* [binja] int32_t* sub_46a11f(int32_t* arg1, int32_t arg2) */

int * __cdecl FUN_0046a11f(int *arg1,int arg2)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  byte bVar4;
  int iVar5;
  int iVar6;
  uint *puVar7;
  int local_8;
  
  local_8 = 3;
  iVar2 = arg2 / 0x20;
  iVar6 = arg2 % 0x20;
  arg2 = 0;
  bVar4 = (byte)iVar6;
  puVar7 = (uint *)arg1;
  do {
    uVar1 = *puVar7;
    *puVar7 = uVar1 >> (bVar4 & 0x1f) | arg2;
    puVar7 = puVar7 + 1;
    arg2 = (uVar1 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f);
    local_8 = local_8 + -1;
  } while (local_8 != 0);
  iVar6 = 2;
  iVar5 = 8;
  do {
    if (iVar6 < iVar2) {
      *(undefined4 *)(iVar5 + (int)arg1) = 0;
      piVar3 = arg1;
    }
    else {
      piVar3 = *(int **)(iVar5 + iVar2 * -4 + (int)arg1);
      *(int **)(iVar5 + (int)arg1) = piVar3;
    }
    iVar6 = iVar6 + -1;
    iVar5 = iVar5 + -4;
  } while (-1 < iVar5);
  return piVar3;
}



/* FUN_0046a1ac @ 0046a1ac */

/* [binja] int32_t sub_46a1ac(int16_t* arg1, int32_t* arg2, int32_t* arg3) */

int __cdecl FUN_0046a1ac(short *arg1,int *arg2,int *arg3)

{
  ushort uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int local_1c [3];
  uint local_10;
  int local_c;
  int local_8;
  
  uVar1 = arg1[5];
  local_10 = *(uint *)(arg1 + 3);
  local_c = *(int *)(arg1 + 1);
  uVar3 = uVar1 & 0x7fff;
  iVar4 = uVar3 - 0x3fff;
  local_8 = (uint)(ushort)*arg1 << 0x10;
  if (iVar4 == -0x3fff) {
    iVar4 = 0;
    iVar2 = FUN_0046a104((int *)&local_10);
    if (iVar2 != 0) {
LAB_0046a2d8:
      iVar2 = 0;
      goto LAB_0046a2da;
    }
    FUN_0046a0f8((int *)&local_10);
  }
  else {
    FUN_0046a0dd((int)local_1c,(int *)&local_10);
    iVar2 = FUN_0046a051((int)&local_10,(int *)arg3[2]);
    if (iVar2 != 0) {
      iVar4 = uVar3 - 0x3ffe;
    }
    iVar2 = arg3[1];
    if (iVar4 < iVar2 - arg3[2]) {
      FUN_0046a0f8((int *)&local_10);
    }
    else {
      if (iVar2 < iVar4) {
        if (*arg3 <= iVar4) {
          FUN_0046a0f8((int *)&local_10);
          local_10 = local_10 | 0x80000000;
          FUN_0046a11f((int *)&local_10,arg3[3]);
          iVar4 = arg3[5] + *arg3;
          iVar2 = 1;
          goto LAB_0046a2da;
        }
        local_10 = local_10 & 0x7fffffff;
        iVar4 = arg3[5] + iVar4;
        FUN_0046a11f((int *)&local_10,arg3[3]);
        goto LAB_0046a2d8;
      }
      FUN_0046a0dd((int)&local_10,local_1c);
      FUN_0046a11f((int *)&local_10,iVar2 - iVar4);
      FUN_0046a051((int)&local_10,(int *)arg3[2]);
      FUN_0046a11f((int *)&local_10,arg3[3] + 1);
    }
  }
  iVar4 = 0;
  iVar2 = 2;
LAB_0046a2da:
  local_10 = iVar4 << (0x1fU - (char)arg3[3] & 0x1f) | -(uint)((uVar1 & 0x8000) != 0) & 0x80000000 |
             local_10;
  if (arg3[4] == 0x40) {
    arg2[1] = local_10;
    *arg2 = local_c;
  }
  else if (arg3[4] == 0x20) {
    *arg2 = local_10;
  }
  return iVar2;
}



/* FUN_0046a318 @ 0046a318 */

/* [binja] int32_t sub_46a318(int16_t* arg1, int32_t* arg2) */

int __cdecl FUN_0046a318(short *arg1,int *arg2)

{
  int iVar1;
  
  iVar1 = FUN_0046a1ac(arg1,arg2,(int *)&DAT_0047dce0);
  return iVar1;
}



/* FUN_0046a32e @ 0046a32e */

/* [binja] int32_t sub_46a32e(int16_t* arg1, int32_t* arg2) */

int __cdecl FUN_0046a32e(short *arg1,int *arg2)

{
  int iVar1;
  
  iVar1 = FUN_0046a1ac(arg1,arg2,(int *)&DAT_0047dcf8);
  return iVar1;
}



/* FUN_0046a344 @ 0046a344 */

void __thiscall FUN_0046a344(void *this,uint *param_1,byte *param_2)

{
  int in_stack_fffffff0;
  
  crt_fp_parse(this,&stack0xfffffff0,(ushort *)&param_2,(int *)param_2,(byte *)0x0,0,0,0,
               in_stack_fffffff0);
  FUN_0046a318((short *)&stack0xfffffff0,(int *)param_1);
  return;
}



/* FUN_0046a371 @ 0046a371 */

void __thiscall FUN_0046a371(void *this,uint *param_1,byte *param_2)

{
  int in_stack_fffffff0;
  
  crt_fp_parse(this,&stack0xfffffff0,(ushort *)&param_2,(int *)param_2,(byte *)0x0,0,0,0,
               in_stack_fffffff0);
  FUN_0046a32e((short *)&stack0xfffffff0,(int *)param_1);
  return;
}



/* crt_fp_round_digits @ 0046a39e */

/* CRT: round float digits and adjust exponent for printf formatting */

void __cdecl crt_fp_round_digits(char *dst,int precision,int *fp_info)

{
  char *_Str;
  char *dst_00;
  char *pcVar1;
  size_t sVar2;
  char *pcVar3;
  char cVar4;
  
  dst_00 = dst;
  pcVar3 = (char *)fp_info[3];
  _Str = dst + 1;
  *dst = '0';
  pcVar1 = _Str;
  if (0 < precision) {
    dst = (char *)precision;
    precision = 0;
    do {
      cVar4 = *pcVar3;
      if (cVar4 == '\0') {
        cVar4 = '0';
      }
      else {
        pcVar3 = pcVar3 + 1;
      }
      *pcVar1 = cVar4;
      pcVar1 = pcVar1 + 1;
      dst = dst + -1;
    } while (dst != (char *)0x0);
  }
  *pcVar1 = '\0';
  if ((-1 < precision) && ('4' < *pcVar3)) {
    while (pcVar1 = pcVar1 + -1, *pcVar1 == '9') {
      *pcVar1 = '0';
    }
    *pcVar1 = *pcVar1 + '\x01';
  }
  if (*dst_00 == '1') {
    fp_info[1] = fp_info[1] + 1;
  }
  else {
    sVar2 = _strlen(_Str);
    crt_memmove(dst_00,_Str,sVar2 + 1);
  }
  return;
}



/* crt_fp_to_string @ 0046a415 */

/* formats a floating-point value for printf-style conversion */

int * __cdecl crt_fp_to_string(double value,int *out,uint *digits)

{
  int *piVar1;
  uint *puVar2;
  int iVar3;
  undefined4 in_stack_ffffffbc;
  undefined2 uVar4;
  short local_2c;
  char local_2a;
  char local_28 [24];
  uint local_10;
  uint uStack_c;
  undefined2 uStack_8;
  
  uVar4 = (undefined2)((uint)in_stack_ffffffbc >> 0x10);
  FUN_0046a471((int *)&local_10,(int *)&value);
  iVar3 = FUN_0046da83(local_10,uStack_c,CONCAT22(uVar4,uStack_8),0x11,0,&local_2c);
  puVar2 = digits;
  piVar1 = out;
  out[2] = iVar3;
  *out = (int)local_2a;
  out[1] = (int)local_2c;
  crt_strcpy((char *)digits,local_28);
  piVar1[3] = (int)puVar2;
  return piVar1;
}



/* FUN_0046a471 @ 0046a471 */

/* [binja] int32_t* sub_46a471(int32_t* arg1, int32_t* arg2) */

int * __cdecl FUN_0046a471(int *arg1,int *arg2)

{
  ushort uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint local_8;
  
  uVar1 = *(ushort *)((int)arg2 + 6);
  uVar3 = (uVar1 & 0x7ff0) >> 4;
  uVar2 = *arg2;
  local_8 = 0x80000000;
  if (uVar3 == 0) {
    if (((arg2[1] & 0xfffffU) == 0) && (uVar2 == 0)) {
      arg1[1] = 0;
      *arg1 = 0;
      *(undefined2 *)(arg1 + 2) = 0;
      return arg1;
    }
    iVar4 = 0x3c01;
    local_8 = 0;
  }
  else if (uVar3 == 0x7ff) {
    iVar4 = 0x7fff;
  }
  else {
    iVar4 = uVar3 + 0x3c00;
  }
  local_8 = uVar2 >> 0x15 | (arg2[1] & 0xfffffU) << 0xb | local_8;
  arg1[1] = local_8;
  *arg1 = uVar2 << 0xb;
  while ((local_8 & 0x80000000) == 0) {
    local_8 = (uint)*arg1 >> 0x1f | local_8 * 2;
    *arg1 = *arg1 * 2;
    arg1[1] = local_8;
    iVar4 = iVar4 + 0xffff;
  }
  *(ushort *)(arg1 + 2) = uVar1 & 0x8000 | (ushort)iVar4;
  return arg1;
}



/* _memset @ 0046a530 */

/* Library Function - Single Match
    _memset
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

void * __cdecl _memset(void *_Dst,int _Val,size_t _Size)

{
  uint uVar1;
  uint uVar2;
  size_t sVar3;
  uint *puVar4;
  
  if (_Size == 0) {
    return _Dst;
  }
  uVar1 = _Val & 0xff;
  puVar4 = _Dst;
  if (3 < _Size) {
    uVar2 = -(int)_Dst & 3;
    sVar3 = _Size;
    if (uVar2 != 0) {
      sVar3 = _Size - uVar2;
      do {
        *(undefined1 *)puVar4 = (undefined1)_Val;
        puVar4 = (uint *)((int)puVar4 + 1);
        uVar2 = uVar2 - 1;
      } while (uVar2 != 0);
    }
    uVar1 = uVar1 * 0x1010101;
    _Size = sVar3 & 3;
    uVar2 = sVar3 >> 2;
    if (uVar2 != 0) {
      for (; uVar2 != 0; uVar2 = uVar2 - 1) {
        *puVar4 = uVar1;
        puVar4 = puVar4 + 1;
      }
      if (_Size == 0) {
        return _Dst;
      }
    }
  }
  do {
    *(char *)puVar4 = (char)uVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
    _Size = _Size - 1;
  } while (_Size != 0);
  return _Dst;
}



/* crt_memmove @ 0046a590 */

/* CRT: copy memory with overlap handling */

void * __cdecl crt_memmove(void *dst,void *src,size_t size)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  if ((src < dst) && (dst < (void *)(size + (int)src))) {
    puVar3 = (undefined4 *)((size - 4) + (int)src);
    puVar4 = (undefined4 *)((size - 4) + (int)dst);
    if (((uint)puVar4 & 3) == 0) {
      uVar1 = size >> 2;
      uVar2 = size & 3;
      if (7 < uVar1) {
        for (; uVar1 != 0; uVar1 = uVar1 - 1) {
          *puVar4 = *puVar3;
          puVar3 = puVar3 + -1;
          puVar4 = puVar4 + -1;
        }
        switch(uVar2) {
        case 0:
          return dst;
        case 2:
          goto switchD_0046a747_caseD_2;
        case 3:
          goto switchD_0046a747_caseD_3;
        }
        goto switchD_0046a747_caseD_1;
      }
    }
    else {
      switch(size) {
      case 0:
        goto switchD_0046a747_caseD_0;
      case 1:
        goto switchD_0046a747_caseD_1;
      case 2:
        goto switchD_0046a747_caseD_2;
      case 3:
        goto switchD_0046a747_caseD_3;
      default:
        uVar1 = size - ((uint)puVar4 & 3);
        switch((uint)puVar4 & 3) {
        case 1:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          puVar3 = (undefined4 *)((int)puVar3 + -1);
          uVar1 = uVar1 >> 2;
          puVar4 = (undefined4 *)((int)puVar4 - 1);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return dst;
            case 2:
              goto switchD_0046a747_caseD_2;
            case 3:
              goto switchD_0046a747_caseD_3;
            }
            goto switchD_0046a747_caseD_1;
          }
          break;
        case 2:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          puVar3 = (undefined4 *)((int)puVar3 + -2);
          puVar4 = (undefined4 *)((int)puVar4 - 2);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return dst;
            case 2:
              goto switchD_0046a747_caseD_2;
            case 3:
              goto switchD_0046a747_caseD_3;
            }
            goto switchD_0046a747_caseD_1;
          }
          break;
        case 3:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
          puVar3 = (undefined4 *)((int)puVar3 + -3);
          puVar4 = (undefined4 *)((int)puVar4 - 3);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return dst;
            case 2:
              goto switchD_0046a747_caseD_2;
            case 3:
              goto switchD_0046a747_caseD_3;
            }
            goto switchD_0046a747_caseD_1;
          }
        }
      }
    }
    switch(uVar1) {
    case 7:
      puVar4[7 - uVar1] = puVar3[7 - uVar1];
    case 6:
      puVar4[6 - uVar1] = puVar3[6 - uVar1];
    case 5:
      puVar4[5 - uVar1] = puVar3[5 - uVar1];
    case 4:
      puVar4[4 - uVar1] = puVar3[4 - uVar1];
    case 3:
      puVar4[3 - uVar1] = puVar3[3 - uVar1];
    case 2:
      puVar4[2 - uVar1] = puVar3[2 - uVar1];
    case 1:
      puVar4[1 - uVar1] = puVar3[1 - uVar1];
      puVar3 = puVar3 + -uVar1;
      puVar4 = puVar4 + -uVar1;
    }
    switch(uVar2) {
    case 1:
switchD_0046a747_caseD_1:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      return dst;
    case 2:
switchD_0046a747_caseD_2:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      return dst;
    case 3:
switchD_0046a747_caseD_3:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
      return dst;
    }
switchD_0046a747_caseD_0:
    return dst;
  }
  puVar3 = dst;
  if (((uint)dst & 3) == 0) {
    uVar1 = size >> 2;
    uVar2 = size & 3;
    if (7 < uVar1) {
      for (; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar3 = *(undefined4 *)src;
        src = (undefined4 *)((int)src + 4);
        puVar3 = puVar3 + 1;
      }
      switch(uVar2) {
      case 0:
        return dst;
      case 2:
        goto switchD_0046a5c5_caseD_2;
      case 3:
        goto switchD_0046a5c5_caseD_3;
      }
      goto switchD_0046a5c5_caseD_1;
    }
  }
  else {
    switch(size) {
    case 0:
      goto switchD_0046a5c5_caseD_0;
    case 1:
      goto switchD_0046a5c5_caseD_1;
    case 2:
      goto switchD_0046a5c5_caseD_2;
    case 3:
      goto switchD_0046a5c5_caseD_3;
    default:
      uVar1 = (size - 4) + ((uint)dst & 3);
      switch((uint)dst & 3) {
      case 1:
        uVar2 = uVar1 & 3;
        *(undefined1 *)dst = *(undefined1 *)src;
        *(undefined1 *)((int)dst + 1) = *(undefined1 *)((int)src + 1);
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)dst + 2) = *(undefined1 *)((int)src + 2);
        src = (void *)((int)src + 3);
        puVar3 = (undefined4 *)((int)dst + 3);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *(undefined4 *)src;
            src = (undefined4 *)((int)src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return dst;
          case 2:
            goto switchD_0046a5c5_caseD_2;
          case 3:
            goto switchD_0046a5c5_caseD_3;
          }
          goto switchD_0046a5c5_caseD_1;
        }
        break;
      case 2:
        uVar2 = uVar1 & 3;
        *(undefined1 *)dst = *(undefined1 *)src;
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)dst + 1) = *(undefined1 *)((int)src + 1);
        src = (void *)((int)src + 2);
        puVar3 = (undefined4 *)((int)dst + 2);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *(undefined4 *)src;
            src = (undefined4 *)((int)src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return dst;
          case 2:
            goto switchD_0046a5c5_caseD_2;
          case 3:
            goto switchD_0046a5c5_caseD_3;
          }
          goto switchD_0046a5c5_caseD_1;
        }
        break;
      case 3:
        uVar2 = uVar1 & 3;
        *(undefined1 *)dst = *(undefined1 *)src;
        src = (void *)((int)src + 1);
        uVar1 = uVar1 >> 2;
        puVar3 = (undefined4 *)((int)dst + 1);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *(undefined4 *)src;
            src = (undefined4 *)((int)src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return dst;
          case 2:
            goto switchD_0046a5c5_caseD_2;
          case 3:
            goto switchD_0046a5c5_caseD_3;
          }
          goto switchD_0046a5c5_caseD_1;
        }
      }
    }
  }
  switch(uVar1) {
  case 7:
    puVar3[uVar1 - 7] = *(undefined4 *)((int)src + (uVar1 - 7) * 4);
  case 6:
    puVar3[uVar1 - 6] = *(undefined4 *)((int)src + (uVar1 - 6) * 4);
  case 5:
    puVar3[uVar1 - 5] = *(undefined4 *)((int)src + (uVar1 - 5) * 4);
  case 4:
    puVar3[uVar1 - 4] = *(undefined4 *)((int)src + (uVar1 - 4) * 4);
  case 3:
    puVar3[uVar1 - 3] = *(undefined4 *)((int)src + (uVar1 - 3) * 4);
  case 2:
    puVar3[uVar1 - 2] = *(undefined4 *)((int)src + (uVar1 - 2) * 4);
  case 1:
    puVar3[uVar1 - 1] = *(undefined4 *)((int)src + (uVar1 - 1) * 4);
    src = (void *)((int)src + uVar1 * 4);
    puVar3 = puVar3 + uVar1;
  }
  switch(uVar2) {
  case 1:
switchD_0046a5c5_caseD_1:
    *(undefined1 *)puVar3 = *(undefined1 *)src;
    return dst;
  case 2:
switchD_0046a5c5_caseD_2:
    *(undefined1 *)puVar3 = *(undefined1 *)src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)src + 1);
    return dst;
  case 3:
switchD_0046a5c5_caseD_3:
    *(undefined1 *)puVar3 = *(undefined1 *)src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)src + 1);
    *(undefined1 *)((int)puVar3 + 2) = *(undefined1 *)((int)src + 2);
    return dst;
  }
switchD_0046a5c5_caseD_0:
  return dst;
}



/* FUN_0046a8c5 @ 0046a8c5 */

/* [binja] int32_t sub_46a8c5() */

int FUN_0046a8c5(void)

{
  int extraout_EAX;
  
  __amsg_exit(2);
  return extraout_EAX;
}



/* FUN_0046a8ce @ 0046a8ce */

BOOL __cdecl
FUN_0046a8ce(DWORD param_1,LPCSTR param_2,int param_3,LPWORD param_4,UINT param_5,LCID param_6,
            int param_7)

{
  undefined1 *puVar1;
  WINBOOL WVar2;
  int iVar3;
  WORD local_20 [2];
  undefined1 *local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_00470018;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  local_1c = &stack0xffffffc8;
  iVar3 = DAT_004d9b88;
  ExceptionList = &local_14;
  puVar1 = &stack0xffffffc8;
  if (DAT_004d9b88 == 0) {
    ExceptionList = &local_14;
    WVar2 = GetStringTypeW(1,L"",1,local_20);
    iVar3 = 1;
    puVar1 = local_1c;
    if (WVar2 == 0) {
      WVar2 = GetStringTypeA(0,1,&DAT_004ab1a8,1,local_20);
      if (WVar2 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      iVar3 = 2;
      puVar1 = local_1c;
    }
  }
  local_1c = puVar1;
  DAT_004d9b88 = iVar3;
  if (DAT_004d9b88 != 2) {
    if (DAT_004d9b88 == 1) {
      if (param_5 == 0) {
        param_5 = DAT_004d9a5c;
      }
      iVar3 = MultiByteToWideChar(param_5,(-(uint)(param_7 != 0) & 8) + 1,param_2,param_3,
                                  (LPWSTR)0x0,0);
      if (iVar3 != 0) {
        local_8 = 0;
        crt_chkstk();
        local_1c = &stack0xffffffc8;
        _memset(&stack0xffffffc8,0,iVar3 * 2);
        local_8 = 0xffffffff;
        if ((&stack0x00000000 != (undefined1 *)0x38) &&
           (iVar3 = MultiByteToWideChar(param_5,1,param_2,param_3,(LPWSTR)&stack0xffffffc8,iVar3),
           iVar3 != 0)) {
          WVar2 = GetStringTypeW(param_1,(LPCWCH)&stack0xffffffc8,iVar3,param_4);
          ExceptionList = local_14;
          return WVar2;
        }
      }
    }
    ExceptionList = local_14;
    return 0;
  }
  if (param_6 == 0) {
    param_6 = DAT_004d9a4c;
  }
  WVar2 = GetStringTypeA(param_6,param_1,param_2,param_3,param_4);
  ExceptionList = local_14;
  return WVar2;
}



/* FUN_0046aa98 @ 0046aa98 */

uint FUN_0046aa98(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  uint fd;
  int local_8;
  int local_4;
  
  fd = 0xffffffff;
  crt_lock(0x12);
  local_8 = 0;
  local_4 = 0;
  piVar3 = &DAT_004da3c0;
  while (puVar2 = (undefined4 *)*piVar3, puVar1 = puVar2, puVar2 != (undefined4 *)0x0) {
    for (; puVar2 < puVar1 + 0x120; puVar2 = puVar2 + 9) {
      if ((*(byte *)(puVar2 + 1) & 1) == 0) {
        if (puVar2[2] == 0) {
          crt_lock(0x11);
          if (puVar2[2] == 0) {
            InitializeCriticalSection((LPCRITICAL_SECTION)(puVar2 + 3));
            puVar2[2] = puVar2[2] + 1;
          }
          crt_unlock(0x11);
        }
        EnterCriticalSection((LPCRITICAL_SECTION)(puVar2 + 3));
        if ((*(byte *)(puVar2 + 1) & 1) == 0) {
          *puVar2 = 0xffffffff;
          fd = ((int)puVar2 - *piVar3) / 0x24 + local_4;
          if (fd != 0xffffffff) goto LAB_0046abaa;
          break;
        }
        LeaveCriticalSection((LPCRITICAL_SECTION)(puVar2 + 3));
      }
      puVar1 = (undefined4 *)*piVar3;
    }
    local_4 = local_4 + 0x20;
    piVar3 = piVar3 + 1;
    local_8 = local_8 + 1;
    if (0x4da4bf < (int)piVar3) goto LAB_0046abaa;
  }
  puVar2 = _malloc(0x480);
  if (puVar2 != (undefined4 *)0x0) {
    DAT_004da4c0 = DAT_004da4c0 + 0x20;
    (&DAT_004da3c0)[local_8] = puVar2;
    puVar1 = puVar2;
    for (; puVar2 < puVar1 + 0x120; puVar2 = puVar2 + 9) {
      *(undefined1 *)(puVar2 + 1) = 0;
      *puVar2 = 0xffffffff;
      puVar2[2] = 0;
      *(undefined1 *)((int)puVar2 + 5) = 10;
      puVar1 = (undefined4 *)(&DAT_004da3c0)[local_8];
    }
    fd = local_8 << 5;
    crt_lock_fh(fd);
  }
LAB_0046abaa:
  crt_unlock(0x12);
  return fd;
}



/* FUN_0046abbb @ 0046abbb */

/* [binja] int32_t sub_46abbb(int32_t arg1, HANDLE arg2) */

int __cdecl FUN_0046abbb(int arg1,HANDLE arg2)

{
  int *piVar1;
  uint *puVar2;
  int iVar3;
  DWORD nStdHandle;
  
  if ((uint)arg1 < DAT_004da4c0) {
    iVar3 = (arg1 & 0x1fU) * 0x24;
    if (*(int *)((&DAT_004da3c0)[arg1 >> 5] + iVar3) == -1) {
      if (DAT_0047b184 == 1) {
        if (arg1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (arg1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (arg1 != 2) goto LAB_0046ac14;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,arg2);
      }
LAB_0046ac14:
      *(HANDLE *)((&DAT_004da3c0)[arg1 >> 5] + iVar3) = arg2;
      return 0;
    }
  }
  piVar1 = crt_errno_ptr();
  *piVar1 = 9;
  puVar2 = crt_doserrno_ptr();
  *puVar2 = 0;
  return -1;
}



/* FUN_0046ac37 @ 0046ac37 */

/* [binja] int32_t sub_46ac37(int32_t arg1) */

int __cdecl FUN_0046ac37(int arg1)

{
  int *piVar1;
  uint *puVar2;
  int iVar3;
  DWORD nStdHandle;
  
  if ((uint)arg1 < DAT_004da4c0) {
    iVar3 = (arg1 & 0x1fU) * 0x24;
    piVar1 = (int *)((&DAT_004da3c0)[arg1 >> 5] + iVar3);
    if (((*(byte *)(piVar1 + 1) & 1) != 0) && (*piVar1 != -1)) {
      if (DAT_0047b184 == 1) {
        if (arg1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (arg1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (arg1 != 2) goto LAB_0046ac93;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_0046ac93:
      *(undefined4 *)((&DAT_004da3c0)[arg1 >> 5] + iVar3) = 0xffffffff;
      return 0;
    }
  }
  piVar1 = crt_errno_ptr();
  *piVar1 = 9;
  puVar2 = crt_doserrno_ptr();
  *puVar2 = 0;
  return -1;
}



/* crt_get_osfhandle @ 0046acb6 */

/* CRT: map file descriptor to OS handle */

void * __cdecl crt_get_osfhandle(int fd)

{
  int *piVar1;
  uint *puVar2;
  
  if (((uint)fd < DAT_004da4c0) &&
     ((*(byte *)((&DAT_004da3c0)[fd >> 5] + 4 + (fd & 0x1fU) * 0x24) & 1) != 0)) {
    return *(void **)((&DAT_004da3c0)[fd >> 5] + (fd & 0x1fU) * 0x24);
  }
  piVar1 = crt_errno_ptr();
  *piVar1 = 9;
  puVar2 = crt_doserrno_ptr();
  *puVar2 = 0;
  return (void *)0xffffffff;
}



/* crt_lock_fh @ 0046acf8 */

/* lock CRT file handle entry */

void __cdecl crt_lock_fh(uint fd)

{
  int iVar1;
  int iVar2;
  
  iVar2 = (fd & 0x1f) * 0x24;
  iVar1 = (&DAT_004da3c0)[(int)fd >> 5] + iVar2;
  if (*(int *)(iVar1 + 8) == 0) {
    crt_lock(0x11);
    if (*(int *)(iVar1 + 8) == 0) {
      InitializeCriticalSection((LPCRITICAL_SECTION)(iVar1 + 0xc));
      *(int *)(iVar1 + 8) = *(int *)(iVar1 + 8) + 1;
    }
    crt_unlock(0x11);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)((&DAT_004da3c0)[(int)fd >> 5] + 0xc + iVar2));
  return;
}



/* crt_unlock_fh @ 0046ad57 */

/* unlock CRT file handle entry */

void __cdecl crt_unlock_fh(uint fd)

{
  LeaveCriticalSection
            ((LPCRITICAL_SECTION)((&DAT_004da3c0)[(int)fd >> 5] + 0xc + (fd & 0x1f) * 0x24));
  return;
}



/* crt_file_buffer_init @ 0046ad79 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* CRT: allocate/init FILE buffer (4KB or fallback small buffer) */

void __cdecl crt_file_buffer_init(FILE *fp)

{
  char *pcVar1;
  
  _DAT_004d99d0 = _DAT_004d99d0 + 1;
  pcVar1 = _malloc(0x1000);
  fp->_base = pcVar1;
  if (pcVar1 == (char *)0x0) {
    fp->_flag = fp->_flag | 4;
    fp->_base = (char *)&fp->_charbuf;
    fp->_bufsiz = 2;
  }
  else {
    fp->_flag = fp->_flag | 8;
    fp->_bufsiz = 0x1000;
  }
  fp->_cnt = 0;
  fp->_ptr = fp->_base;
  return;
}



/* crt_sopen @ 0046adbd */

/* CRT: open file with share mode, wraps CreateFile */

int __cdecl crt_sopen(char *filename,int oflag,int shflag,int pmode)

{
  byte *pbVar1;
  uint uVar2;
  uint fd;
  int *piVar3;
  uint *puVar4;
  HANDLE hFile;
  DWORD DVar5;
  int iVar6;
  long lVar7;
  int iVar8;
  bool bVar9;
  _SECURITY_ATTRIBUTES local_20;
  DWORD local_14;
  DWORD local_10;
  DWORD local_c;
  byte local_5;
  
  bVar9 = (oflag & 0x80U) == 0;
  local_20.nLength = 0xc;
  local_20.lpSecurityDescriptor = (LPVOID)0x0;
  if (bVar9) {
    local_5 = 0;
  }
  else {
    local_5 = 0x10;
  }
  local_20.bInheritHandle = (WINBOOL)bVar9;
  if (((oflag & 0x8000U) == 0) && (((oflag & 0x4000U) != 0 || (DAT_004d9cd8 != 0x8000)))) {
    local_5 = local_5 | 0x80;
  }
  uVar2 = oflag & 3;
  if (uVar2 == 0) {
    local_10 = 0x80000000;
  }
  else if (uVar2 == 1) {
    local_10 = 0x40000000;
  }
  else {
    if (uVar2 != 2) goto LAB_0046aec1;
    local_10 = 0xc0000000;
  }
  if (shflag == 0x10) {
    local_14 = 0;
  }
  else if (shflag == 0x20) {
    local_14 = 1;
  }
  else if (shflag == 0x30) {
    local_14 = 2;
  }
  else {
    if (shflag != 0x40) goto LAB_0046aec1;
    local_14 = 3;
  }
  uVar2 = oflag & 0x700;
  if (uVar2 < 0x401) {
    if ((uVar2 == 0x400) || (uVar2 == 0)) {
      local_c = 3;
    }
    else if (uVar2 == 0x100) {
      local_c = 4;
    }
    else {
      if (uVar2 == 0x200) goto LAB_0046aedb;
      if (uVar2 != 0x300) goto LAB_0046aec1;
      local_c = 2;
    }
  }
  else {
    if (uVar2 != 0x500) {
      if (uVar2 == 0x600) {
LAB_0046aedb:
        local_c = 5;
        goto LAB_0046aeeb;
      }
      if (uVar2 != 0x700) {
LAB_0046aec1:
        piVar3 = crt_errno_ptr();
        *piVar3 = 0x16;
        puVar4 = crt_doserrno_ptr();
        *puVar4 = 0;
        return -1;
      }
    }
    local_c = 1;
  }
LAB_0046aeeb:
  uVar2 = 0x80;
  if (((oflag & 0x100U) != 0) && ((~DAT_004d9980 & pmode & 0x80) == 0)) {
    uVar2 = 1;
  }
  if ((oflag & 0x40U) != 0) {
    uVar2 = uVar2 | 0x4000000;
    local_10 = CONCAT13(local_10._3_1_,0x10000);
  }
  if ((oflag & 0x1000U) != 0) {
    uVar2 = uVar2 | 0x100;
  }
  if ((oflag & 0x20U) == 0) {
    if ((oflag & 0x10U) != 0) {
      uVar2 = uVar2 | 0x10000000;
    }
  }
  else {
    uVar2 = uVar2 | 0x8000000;
  }
  fd = FUN_0046aa98();
  if (fd == 0xffffffff) {
    piVar3 = crt_errno_ptr();
    *piVar3 = 0x18;
    puVar4 = crt_doserrno_ptr();
    *puVar4 = 0;
    return -1;
  }
  hFile = CreateFileA(filename,local_10,local_14,&local_20,local_c,uVar2,(HANDLE)0x0);
  if (hFile != (HANDLE)0xffffffff) {
    DVar5 = GetFileType(hFile);
    if (DVar5 != 0) {
      if (DVar5 == 2) {
        local_5 = local_5 | 0x40;
      }
      else if (DVar5 == 3) {
        local_5 = local_5 | 8;
      }
      FUN_0046abbb(fd,hFile);
      iVar8 = (fd & 0x1f) * 0x24;
      filename._3_1_ = local_5 & 0x48;
      *(byte *)((&DAT_004da3c0)[(int)fd >> 5] + 4 + iVar8) = local_5 | 1;
      if ((((local_5 & 0x48) == 0) && ((local_5 & 0x80) != 0)) && ((oflag & 2U) != 0)) {
        local_14 = crt_lseek_nolock(fd,-1,2);
        if (local_14 == 0xffffffff) {
          puVar4 = crt_doserrno_ptr();
          if (*puVar4 == 0x83) goto LAB_0046b065;
        }
        else {
          shflag = shflag & 0xffffff;
          iVar6 = crt_read_nolock(fd,(char *)((int)&shflag + 3),1);
          if ((((iVar6 != 0) || (shflag._3_1_ != '\x1a')) ||
              (iVar6 = crt_chsize(fd,local_14), iVar6 != -1)) &&
             (lVar7 = crt_lseek_nolock(fd,0,0), lVar7 != -1)) goto LAB_0046b065;
        }
        crt_close(fd);
        uVar2 = 0xffffffff;
      }
      else {
LAB_0046b065:
        uVar2 = fd;
        if ((filename._3_1_ == 0) && ((oflag & 8U) != 0)) {
          pbVar1 = (byte *)((&DAT_004da3c0)[(int)fd >> 5] + 4 + iVar8);
          *pbVar1 = *pbVar1 | 0x20;
        }
      }
      goto LAB_0046b07e;
    }
    CloseHandle(hFile);
  }
  DVar5 = GetLastError();
  crt_dosmaperr(DVar5);
  uVar2 = 0xffffffff;
LAB_0046b07e:
  crt_unlock_fh(fd);
  return uVar2;
}



/* FUN_0046b08c @ 0046b08c */

byte __cdecl FUN_0046b08c(uint param_1)

{
  if (DAT_004da4c0 <= param_1) {
    return 0;
  }
  return *(byte *)((&DAT_004da3c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 0x40;
}



/* FUN_0046b0b5 @ 0046b0b5 */

int __cdecl FUN_0046b0b5(LPSTR param_1,WCHAR param_2)

{
  int iVar1;
  bool bVar2;
  
  InterlockedIncrement((LONG *)&DAT_004da3b0);
  bVar2 = DAT_004da3ac != 0;
  if (bVar2) {
    InterlockedDecrement((LONG *)&DAT_004da3b0);
    crt_lock(0x13);
  }
  iVar1 = FUN_0046b10e(param_1,param_2);
  if (bVar2) {
    crt_unlock(0x13);
  }
  else {
    InterlockedDecrement((LONG *)&DAT_004da3b0);
  }
  return iVar1;
}



/* FUN_0046b10e @ 0046b10e */

int __cdecl FUN_0046b10e(LPSTR param_1,WCHAR param_2)

{
  LPSTR lpMultiByteStr;
  int iVar1;
  int *piVar2;
  
  lpMultiByteStr = param_1;
  if (param_1 == (LPSTR)0x0) {
    return 0;
  }
  if (DAT_004d9a4c == 0) {
    if ((ushort)param_2 < 0x100) {
      *param_1 = (CHAR)param_2;
      return 1;
    }
  }
  else {
    param_1 = (LPSTR)0x0;
    iVar1 = WideCharToMultiByte(DAT_004d9a5c,0x220,&param_2,1,lpMultiByteStr,DAT_0047b3cc,(LPCCH)0x0
                                ,(LPBOOL)&param_1);
    if ((iVar1 != 0) && (param_1 == (LPSTR)0x0)) {
      return iVar1;
    }
  }
  piVar2 = crt_errno_ptr();
  *piVar2 = 0x2a;
  return -1;
}



/* __aulldiv @ 0046b180 */

/* Library Function - Single Match
    __aulldiv
   
   Library: Visual Studio */

undefined8 __aulldiv(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  uVar3 = param_1;
  uVar8 = param_4;
  uVar6 = param_2;
  uVar9 = param_3;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar5 = uVar8 >> 1;
      uVar9 = uVar9 >> 1 | (uint)((uVar8 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar8 = uVar5;
      uVar6 = uVar7;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar9;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar8 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar8)) ||
       ((param_2 <= uVar8 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  return CONCAT44(uVar3,iVar4);
}



/* __aullrem @ 0046b1f0 */

/* Library Function - Single Match
    __aullrem
   
   Library: Visual Studio */

undefined8 __aullrem(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  bool bVar11;
  
  uVar3 = param_1;
  uVar4 = param_4;
  uVar9 = param_2;
  uVar10 = param_3;
  if (param_4 == 0) {
    iVar6 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) %
                 (ulonglong)param_3);
    iVar7 = 0;
  }
  else {
    do {
      uVar5 = uVar4 >> 1;
      uVar10 = uVar10 >> 1 | (uint)((uVar4 & 1) != 0) << 0x1f;
      uVar8 = uVar9 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar9 & 1) != 0) << 0x1f;
      uVar4 = uVar5;
      uVar9 = uVar8;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar8,uVar3) / (ulonglong)uVar10;
    uVar3 = (int)uVar1 * param_4;
    lVar2 = (uVar1 & 0xffffffff) * (ulonglong)param_3;
    uVar9 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar4 = (uint)lVar2;
    uVar10 = uVar9 + uVar3;
    if (((CARRY4(uVar9,uVar3)) || (param_2 < uVar10)) || ((param_2 <= uVar10 && (param_1 < uVar4))))
    {
      bVar11 = uVar4 < param_3;
      uVar4 = uVar4 - param_3;
      uVar10 = (uVar10 - param_4) - (uint)bVar11;
    }
    iVar6 = -(uVar4 - param_1);
    iVar7 = -(uint)(uVar4 - param_1 != 0) - ((uVar10 - param_2) - (uint)(uVar4 < param_1));
  }
  return CONCAT44(iVar7,iVar6);
}



/* crt_fp_parse @ 0046b265 */

/* parses a floating-point string into an 80-bit buffer (CRT scanf helper) */

int __thiscall
crt_fp_parse(void *this,void *ctx,ushort *out,int *cursor,byte *str,int flags,int width,int prec,
            int mode)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  char *pcVar4;
  int iVar5;
  byte bVar6;
  byte *pbVar7;
  byte *pbVar8;
  int iVar9;
  byte *pbVar10;
  char local_60 [23];
  char local_49;
  ushort local_44;
  undefined2 uStack_42;
  undefined2 uStack_40;
  int *local_3e;
  ushort local_3a;
  int local_34;
  int local_30;
  undefined4 local_2c;
  int local_28;
  int local_24;
  byte *local_20;
  int local_1c;
  int local_18;
  int local_14;
  char *local_10;
  int local_c;
  uint local_8;
  
  local_10 = local_60;
  local_2c = 0;
  local_1c = 1;
  local_8 = 0;
  local_14 = 0;
  local_28 = 0;
  local_24 = 0;
  local_30 = 0;
  local_34 = 0;
  local_20 = (byte *)0x0;
  local_c = 0;
  local_18 = 0;
  pbVar8 = (byte *)cursor;
  while( true ) {
    bVar6 = *pbVar8;
    this = (void *)CONCAT31((int3)((uint)this >> 8),bVar6);
    if ((((bVar6 != 0x20) && (bVar6 != 9)) && (bVar6 != 10)) && (bVar6 != 0xd)) break;
    pbVar8 = pbVar8 + 1;
  }
  iVar1 = 4;
  iVar9 = 0;
  iVar5 = local_14;
LAB_0046b2bc:
  local_14 = iVar5;
  pbVar7 = pbVar8;
  iVar5 = 1;
  bVar6 = *pbVar7;
  pbVar8 = pbVar7 + 1;
  iVar2 = local_14;
  switch(iVar9) {
  case 0:
    if (('0' < (char)bVar6) && ((char)bVar6 < ':')) {
LAB_0046b2d9:
      local_14 = iVar2;
      iVar9 = 3;
      goto LAB_0046b4fe;
    }
    if (bVar6 == DAT_0047b3d0) goto LAB_0046b2e8;
    if (bVar6 == 0x2b) {
      local_2c = 0;
      iVar9 = 2;
      iVar5 = local_14;
    }
    else if (bVar6 == 0x2d) {
      local_2c = 0x8000;
      iVar9 = 2;
      iVar5 = local_14;
    }
    else {
      iVar9 = iVar5;
      iVar5 = local_14;
      if (bVar6 != 0x30) goto LAB_0046b5d8;
    }
    goto LAB_0046b2bc;
  case 1:
    local_14 = 1;
    if (('0' < (char)bVar6) && (iVar2 = iVar5, (char)bVar6 < ':')) goto LAB_0046b2d9;
    iVar9 = iVar1;
    if (bVar6 != DAT_0047b3d0) {
      iVar9 = iVar5;
      if ((bVar6 == 0x2b) || (iVar9 = local_14, bVar6 == 0x2d)) goto LAB_0046b36d;
      iVar9 = iVar5;
      local_14 = iVar5;
      if (bVar6 != 0x30) goto LAB_0046b346;
    }
    goto LAB_0046b2bc;
  case 2:
    if (('0' < (char)bVar6) && ((char)bVar6 < ':')) goto LAB_0046b2d9;
    if (bVar6 == DAT_0047b3d0) {
LAB_0046b2e8:
      iVar9 = 5;
      iVar5 = local_14;
    }
    else {
      iVar9 = iVar5;
      pbVar7 = (byte *)cursor;
      iVar5 = local_14;
      if (bVar6 != 0x30) goto LAB_0046b5dd;
    }
    goto LAB_0046b2bc;
  case 3:
    local_14 = iVar5;
    while( true ) {
      if (DAT_0047b3cc < 2) {
        uVar3 = (byte)crt_ctype_table[(uint)bVar6 * 2] & 4;
        this = crt_ctype_table;
      }
      else {
        pbVar7 = (byte *)0x4;
        uVar3 = crt_isctype(this,(uint)bVar6,4);
        this = pbVar7;
      }
      if (uVar3 == 0) break;
      if (local_8 < 0x19) {
        local_8 = local_8 + 1;
        pcVar4 = local_10 + 1;
        *local_10 = bVar6 - 0x30;
        local_10 = pcVar4;
      }
      else {
        local_c = local_c + 1;
      }
      bVar6 = *pbVar8;
      pbVar8 = pbVar8 + 1;
    }
    iVar9 = iVar1;
    iVar5 = local_14;
    if (bVar6 != DAT_0047b3d0) goto LAB_0046b45a;
    goto LAB_0046b2bc;
  case 4:
    local_14 = 1;
    local_28 = 1;
    iVar9 = iVar5;
    if (local_8 == 0) {
      while (iVar5 = local_28, iVar9 = local_14, bVar6 == 0x30) {
        local_c = local_c + -1;
        bVar6 = *pbVar8;
        pbVar8 = pbVar8 + 1;
      }
    }
    while( true ) {
      local_14 = iVar9;
      local_28 = iVar5;
      if (DAT_0047b3cc < 2) {
        uVar3 = (byte)crt_ctype_table[(uint)bVar6 * 2] & 4;
        this = crt_ctype_table;
      }
      else {
        pbVar7 = (byte *)0x4;
        uVar3 = crt_isctype(this,(uint)bVar6,4);
        this = pbVar7;
      }
      if (uVar3 == 0) break;
      if (local_8 < 0x19) {
        local_8 = local_8 + 1;
        local_c = local_c + -1;
        pcVar4 = local_10 + 1;
        *local_10 = bVar6 - 0x30;
        local_10 = pcVar4;
      }
      bVar6 = *pbVar8;
      pbVar8 = pbVar8 + 1;
      iVar5 = local_28;
      iVar9 = local_14;
    }
LAB_0046b45a:
    iVar9 = local_14;
    if ((bVar6 == 0x2b) || (bVar6 == 0x2d)) {
LAB_0046b36d:
      local_14 = iVar9;
      iVar9 = 0xb;
      pbVar8 = pbVar8 + -1;
      iVar5 = local_14;
    }
    else {
LAB_0046b346:
      if (((char)bVar6 < 'D') ||
         (('E' < (char)bVar6 && (((char)bVar6 < 'd' || ('e' < (char)bVar6)))))) goto LAB_0046b5d8;
      iVar9 = 6;
      iVar5 = local_14;
    }
    goto LAB_0046b2bc;
  case 5:
    local_28 = iVar5;
    if (DAT_0047b3cc < 2) {
      uVar3 = (byte)crt_ctype_table[(uint)bVar6 * 2] & 4;
      this = crt_ctype_table;
    }
    else {
      pbVar7 = (byte *)0x4;
      uVar3 = crt_isctype(this,(uint)bVar6,4);
      this = pbVar7;
    }
    iVar9 = iVar1;
    pbVar7 = (byte *)cursor;
    if (uVar3 != 0) goto LAB_0046b4fe;
    goto LAB_0046b5dd;
  case 6:
    pbVar7 = pbVar7 + -1;
    this = pbVar7;
    cursor = (int *)pbVar7;
    if (((char)bVar6 < '1') || ('9' < (char)bVar6)) {
      if (bVar6 == 0x2b) goto LAB_0046b533;
      if (bVar6 == 0x2d) goto LAB_0046b527;
      if (bVar6 != 0x30) goto LAB_0046b5dd;
LAB_0046b4cc:
      iVar9 = 8;
      iVar5 = local_14;
      goto LAB_0046b2bc;
    }
    break;
  case 7:
    if (((char)bVar6 < '1') || ('9' < (char)bVar6)) {
      pbVar7 = (byte *)cursor;
      if (bVar6 == 0x30) goto LAB_0046b4cc;
      goto LAB_0046b5dd;
    }
    break;
  case 8:
    local_24 = 1;
    while (bVar6 == 0x30) {
      bVar6 = *pbVar8;
      pbVar8 = pbVar8 + 1;
    }
    if (((char)bVar6 < '1') || ('9' < (char)bVar6)) goto LAB_0046b5d8;
    break;
  case 9:
    local_24 = 1;
    pbVar7 = (byte *)0x0;
    goto LAB_0046b55e;
  default:
    goto switchD_0046b2c8_caseD_a;
  case 0xb:
    if (prec != 0) {
      if (bVar6 == 0x2b) {
LAB_0046b533:
        iVar9 = 7;
        this = pbVar7;
        cursor = (int *)pbVar7;
        iVar5 = local_14;
      }
      else {
        cursor = (int *)pbVar7;
        if (bVar6 != 0x2d) goto LAB_0046b5dd;
LAB_0046b527:
        local_1c = -1;
        iVar9 = 7;
        this = pbVar7;
        cursor = (int *)pbVar7;
        iVar5 = local_14;
      }
      goto LAB_0046b2bc;
    }
    iVar9 = 10;
    pbVar8 = pbVar7;
switchD_0046b2c8_caseD_a:
    pbVar7 = pbVar8;
    iVar5 = local_14;
    if (iVar9 != 10) goto LAB_0046b2bc;
    goto LAB_0046b5dd;
  }
  iVar9 = 9;
LAB_0046b4fe:
  pbVar8 = pbVar8 + -1;
  iVar5 = local_14;
  goto LAB_0046b2bc;
LAB_0046b55e:
  if (DAT_0047b3cc < 2) {
    uVar3 = (byte)crt_ctype_table[(uint)bVar6 * 2] & 4;
    this = crt_ctype_table;
  }
  else {
    pbVar10 = (byte *)0x4;
    uVar3 = crt_isctype(this,(uint)bVar6,4);
    this = pbVar10;
  }
  if (uVar3 == 0) goto LAB_0046b5a8;
  this = (void *)(int)(char)bVar6;
  pbVar7 = (byte *)((int)this + (int)pbVar7 * 10 + -0x30);
  if (0x1450 < (int)pbVar7) goto LAB_0046b5a0;
  bVar6 = *pbVar8;
  pbVar8 = pbVar8 + 1;
  goto LAB_0046b55e;
LAB_0046b5a0:
  pbVar7 = (byte *)0x1451;
LAB_0046b5a8:
  while( true ) {
    local_20 = pbVar7;
    if (DAT_0047b3cc < 2) {
      uVar3 = (byte)crt_ctype_table[(uint)bVar6 * 2] & 4;
      this = crt_ctype_table;
    }
    else {
      pbVar7 = (byte *)0x4;
      uVar3 = crt_isctype(this,(uint)bVar6,4);
      this = pbVar7;
    }
    if (uVar3 == 0) break;
    bVar6 = *pbVar8;
    pbVar8 = pbVar8 + 1;
    pbVar7 = local_20;
  }
LAB_0046b5d8:
  pbVar7 = pbVar8 + -1;
LAB_0046b5dd:
  *(byte **)out = pbVar7;
  if (local_14 == 0) {
    local_44 = 0;
    local_3a = 0;
    local_3e = (int *)0x0;
    cursor = (int *)0x0;
    local_18 = 4;
    goto LAB_0046b6eb;
  }
  pcVar4 = local_10;
  if (0x18 < local_8) {
    if ('\x04' < local_49) {
      local_49 = local_49 + '\x01';
    }
    local_8 = 0x18;
    local_c = local_c + 1;
    pcVar4 = local_10 + -1;
  }
  if (local_8 == 0) {
    local_44 = 0;
    local_3a = 0;
    local_3e = (int *)0x0;
    cursor = (int *)0x0;
  }
  else {
    while (pcVar4 = pcVar4 + -1, *pcVar4 == '\0') {
      local_8 = local_8 - 1;
      local_c = local_c + 1;
    }
    FUN_0046d9bc(local_60,local_8,(int)&local_44);
    pbVar8 = local_20;
    if (local_1c < 0) {
      pbVar8 = (byte *)-(int)local_20;
    }
    pbVar8 = pbVar8 + local_c;
    if (local_24 == 0) {
      pbVar8 = pbVar8 + flags;
    }
    if (local_28 == 0) {
      pbVar8 = pbVar8 + -width;
    }
    if ((int)pbVar8 < 0x1451) {
      if (-0x1451 < (int)pbVar8) {
        FUN_0046e05b((int *)&local_44,(uint)pbVar8,(int)str);
        cursor = (int *)CONCAT22(uStack_40,uStack_42);
        goto LAB_0046b670;
      }
      local_34 = 1;
    }
    else {
      local_30 = 1;
    }
    local_3a = (ushort)cursor;
    local_3e = cursor;
    local_44 = local_3a;
  }
LAB_0046b670:
  if (local_30 == 0) {
    if (local_34 != 0) {
      local_44 = 0;
      local_3a = 0;
      local_3e = (int *)0x0;
      cursor = (int *)0x0;
      local_18 = 1;
    }
  }
  else {
    cursor = (int *)0x0;
    local_3a = 0x7fff;
    local_3e = (int *)0x80000000;
    local_44 = 0;
    local_18 = 2;
  }
LAB_0046b6eb:
  *(int **)((int)ctx + 6) = local_3e;
  *(int **)((int)ctx + 2) = cursor;
  *(ushort *)((int)ctx + 10) = local_3a | (ushort)local_2c;
  *(ushort *)ctx = local_44;
  return local_18;
}



/* FUN_0046c4cb @ 0046c4cb */

/* [binja] int32_t* sub_46c4cb(int32_t arg1, int32_t* arg2, uint32_t arg3) */

int * __cdecl FUN_0046c4cb(int arg1,int *arg2,uint arg3)

{
  int iVar1;
  bool bVar2;
  undefined3 extraout_var;
  int *piVar3;
  uint uVar4;
  uint local_5c [10];
  undefined8 local_34;
  uint local_24;
  
  arg3 = (uint)*(ushort *)arg3;
  iVar1 = *arg2;
  if (iVar1 == 1) {
LAB_0046c510:
    uVar4 = 8;
  }
  else if (iVar1 == 2) {
    uVar4 = 4;
  }
  else if (iVar1 == 3) {
    uVar4 = 0x11;
  }
  else if (iVar1 == 4) {
    uVar4 = 0x12;
  }
  else {
    if (iVar1 == 5) goto LAB_0046c510;
    if (iVar1 == 7) {
      *arg2 = 1;
      goto LAB_0046c566;
    }
    if (iVar1 != 8) goto LAB_0046c566;
    uVar4 = 0x10;
  }
  bVar2 = FUN_00469326(uVar4,(double *)(arg2 + 6),arg3);
  if (CONCAT31(extraout_var,bVar2) == 0) {
    if (((arg1 == 0x10) || (arg1 == 0x16)) || (arg1 == 0x1d)) {
      local_34 = *(undefined8 *)(arg2 + 4);
      local_24 = local_24 & 0xffffffe3 | 3;
    }
    else {
      local_24 = local_24 & 0xfffffffe;
    }
    FUN_00469073(local_5c,&arg3,uVar4,arg1,(undefined8 *)(arg2 + 2),(undefined8 *)(arg2 + 6));
  }
LAB_0046c566:
  FUN_00469582();
  if (((*arg2 != 8) && (DAT_0047e088 == 0)) &&
     (piVar3 = (int *)FUN_0046d66c(), piVar3 != (int *)0x0)) {
    return piVar3;
  }
  piVar3 = FUN_0046953d((int *)*arg2);
  return piVar3;
}



/* __frnd @ 0046c59b */

/* Library Function - Single Match
    __frnd
   
   Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release,
   Visual Studio 2019 Release */

float10 __cdecl __frnd(double param_1)

{
  return (float10)ROUND(param_1);
}



/* FUN_0046c5ad @ 0046c5ad */

void FUN_0046c5ad(void)

{
  if (DAT_004d9c48 == 0) {
    crt_lock(0xb);
    if (DAT_004d9c48 == 0) {
      FUN_0046c5db();
      DAT_004d9c48 = DAT_004d9c48 + 1;
    }
    crt_unlock(0xb);
  }
  return;
}



/* FUN_0046c5db @ 0046c5db */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_0046c5db(void)

{
  byte bVar1;
  byte bVar2;
  char *_Str1;
  DWORD DVar3;
  int iVar4;
  size_t sVar5;
  void *this;
  byte *_Source;
  int local_8;
  
  crt_lock(0xc);
  DAT_0047df18 = 0xffffffff;
  DAT_0047df08 = 0xffffffff;
  DAT_004d9b90 = 0;
  _Str1 = (char *)FUN_0046e0d7("TZ");
  if (_Str1 == (char *)0x0) {
    crt_unlock(0xc);
    DVar3 = GetTimeZoneInformation((LPTIME_ZONE_INFORMATION)&DAT_004d9b98);
    if (DVar3 == 0xffffffff) {
      return;
    }
    DAT_0047de70 = (void *)(DAT_004d9b98 * 0x3c);
    DAT_004d9b90 = 1;
    if (DAT_004d9bde != 0) {
      DAT_0047de70 = (void *)((int)DAT_0047de70 + DAT_004d9bec * 0x3c);
    }
    if ((DAT_004d9c32 == 0) || (DAT_004d9c40 == 0)) {
      DAT_0047de74 = 0;
      _DAT_0047de78 = 0;
    }
    else {
      DAT_0047de74 = 1;
      _DAT_0047de78 = (DAT_004d9c40 - DAT_004d9bec) * 0x3c;
    }
    iVar4 = WideCharToMultiByte(DAT_004d9a5c,0x220,(LPCWCH)&DAT_004d9b9c,-1,PTR_DAT_0047defc,0x3f,
                                (LPCCH)0x0,&local_8);
    if ((iVar4 == 0) || (local_8 != 0)) {
      *PTR_DAT_0047defc = 0;
    }
    else {
      PTR_DAT_0047defc[0x3f] = 0;
    }
    iVar4 = WideCharToMultiByte(DAT_004d9a5c,0x220,(LPCWCH)&DAT_004d9bf0,-1,PTR_DAT_0047df00,0x3f,
                                (LPCCH)0x0,&local_8);
    if ((iVar4 != 0) && (local_8 == 0)) {
      PTR_DAT_0047df00[0x3f] = 0;
      return;
    }
LAB_0046c84c:
    *PTR_DAT_0047df00 = 0;
  }
  else {
    if ((*_Str1 != '\0') &&
       ((DAT_004d9c44 == (char *)0x0 || (iVar4 = _strcmp(_Str1,DAT_004d9c44), iVar4 != 0)))) {
      crt_free_base(DAT_004d9c44);
      sVar5 = _strlen(_Str1);
      DAT_004d9c44 = _malloc(sVar5 + 1);
      if (DAT_004d9c44 != (char *)0x0) {
        crt_strcpy(DAT_004d9c44,_Str1);
        crt_unlock(0xc);
        _strncpy(PTR_DAT_0047defc,_Str1,3);
        _Source = (byte *)(_Str1 + 3);
        PTR_DAT_0047defc[3] = 0;
        bVar1 = *_Source;
        if (bVar1 == 0x2d) {
          _Source = (byte *)(_Str1 + 4);
        }
        iVar4 = FUN_00460dd2(this,_Source);
        DAT_0047de70 = (void *)(iVar4 * 0xe10);
        for (; (bVar2 = *_Source, bVar2 == 0x2b || (('/' < (char)bVar2 && ((char)bVar2 < ':'))));
            _Source = _Source + 1) {
        }
        if (*_Source == 0x3a) {
          _Source = _Source + 1;
          iVar4 = FUN_00460dd2(DAT_0047de70,_Source);
          DAT_0047de70 = (void *)((int)DAT_0047de70 + iVar4 * 0x3c);
          for (; ('/' < (char)*_Source && ((char)*_Source < ':')); _Source = _Source + 1) {
          }
          if (*_Source == 0x3a) {
            _Source = _Source + 1;
            iVar4 = FUN_00460dd2(DAT_0047de70,_Source);
            DAT_0047de70 = (void *)((int)DAT_0047de70 + iVar4);
            for (; ('/' < (char)*_Source && ((char)*_Source < ':')); _Source = _Source + 1) {
            }
          }
        }
        if (bVar1 == 0x2d) {
          DAT_0047de70 = (void *)-(int)DAT_0047de70;
        }
        DAT_0047de74 = (int)(char)*_Source;
        if (DAT_0047de74 != 0) {
          _strncpy(PTR_DAT_0047df00,(char *)_Source,3);
          PTR_DAT_0047df00[3] = 0;
          return;
        }
        goto LAB_0046c84c;
      }
    }
    crt_unlock(0xc);
  }
  return;
}



/* FUN_0046c862 @ 0046c862 */

bool __cdecl FUN_0046c862(int *param_1)

{
  bool bVar1;
  
  crt_lock(0xb);
  bVar1 = FUN_0046c883(param_1);
  crt_unlock(0xb);
  return bVar1;
}



/* FUN_0046c883 @ 0046c883 */

bool __cdecl FUN_0046c883(int *param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  if (DAT_0047de74 != 0) {
    uVar5 = param_1[5];
    if ((uVar5 != DAT_0047df08) || (uVar5 != DAT_0047df18)) {
      if (DAT_004d9b90 == 0) {
        FUN_0046ca2f(1,1,uVar5,4,1,0,0,2,0,0,0);
        FUN_0046ca2f(0,1,param_1[5],10,5,0,0,2,0,0,0);
      }
      else {
        if (DAT_004d9c30 != 0) {
          uVar6 = (uint)DAT_004d9c36;
          uVar3 = 0;
          uVar4 = 0;
        }
        else {
          uVar3 = (uint)DAT_004d9c34;
          uVar6 = 0;
          uVar4 = (uint)DAT_004d9c36;
        }
        FUN_0046ca2f(1,(uint)(DAT_004d9c30 == 0),uVar5,(uint)DAT_004d9c32,uVar4,uVar3,uVar6,
                     (uint)DAT_004d9c38,(uint)DAT_004d9c3a,(uint)DAT_004d9c3c,(uint)DAT_004d9c3e);
        if (DAT_004d9bdc != 0) {
          uVar6 = (uint)DAT_004d9be2;
          uVar3 = 0;
          uVar4 = 0;
          uVar5 = param_1[5];
        }
        else {
          uVar3 = (uint)DAT_004d9be0;
          uVar6 = 0;
          uVar4 = (uint)DAT_004d9be2;
          uVar5 = param_1[5];
        }
        FUN_0046ca2f(0,(uint)(DAT_004d9bdc == 0),uVar5,(uint)DAT_004d9bde,uVar4,uVar3,uVar6,
                     (uint)DAT_004d9be4,(uint)DAT_004d9be6,(uint)DAT_004d9be8,(uint)DAT_004d9bea);
      }
    }
    iVar1 = param_1[7];
    if (DAT_0047df0c < DAT_0047df1c) {
      if ((DAT_0047df0c <= iVar1) && (iVar1 <= DAT_0047df1c)) {
        if ((DAT_0047df0c < iVar1) && (iVar1 < DAT_0047df1c)) {
          return true;
        }
LAB_0046c9fb:
        iVar2 = ((param_1[2] * 0x3c + param_1[1]) * 0x3c + *param_1) * 1000;
        if (iVar1 == DAT_0047df0c) {
          return DAT_0047df10 <= iVar2;
        }
        return iVar2 < DAT_0047df20;
      }
    }
    else {
      if (iVar1 < DAT_0047df1c) {
        return true;
      }
      if (DAT_0047df0c < iVar1) {
        return true;
      }
      if ((iVar1 <= DAT_0047df1c) || (DAT_0047df0c <= iVar1)) goto LAB_0046c9fb;
    }
  }
  return false;
}



/* FUN_0046ca2f @ 0046ca2f */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl
FUN_0046ca2f(int param_1,int param_2,uint param_3,int param_4,int param_5,int param_6,int param_7,
            int param_8,int param_9,int param_10,int param_11)

{
  int iVar1;
  int iVar2;
  
  if (param_2 == 1) {
    if ((param_3 & 3) == 0) {
      iVar1 = (&DAT_0047df20)[param_4];
    }
    else {
      iVar1 = *(int *)(&DAT_0047df54 + param_4 * 4);
    }
    iVar2 = (int)(param_3 * 0x16d + -0x63db + iVar1 + 1 + ((int)(param_3 - 1) >> 2)) % 7;
    if (param_6 < iVar2) {
      iVar1 = iVar1 + 1 + (param_5 * 7 - iVar2) + param_6;
    }
    else {
      iVar1 = iVar1 + -6 + (param_5 * 7 - iVar2) + param_6;
    }
    if (param_5 == 5) {
      if ((param_3 & 3) == 0) {
        iVar2 = *(int *)(&DAT_0047df24 + param_4 * 4);
      }
      else {
        iVar2 = *(int *)(&DAT_0047df58 + param_4 * 4);
      }
      if (iVar2 < iVar1) {
        iVar1 = iVar1 + -7;
      }
    }
  }
  else {
    if ((param_3 & 3) == 0) {
      iVar1 = (&DAT_0047df20)[param_4];
    }
    else {
      iVar1 = *(int *)(&DAT_0047df54 + param_4 * 4);
    }
    iVar1 = iVar1 + param_7;
  }
  if (param_1 == 1) {
    DAT_0047df08 = param_3;
    DAT_0047df10 = ((param_8 * 0x3c + param_9) * 0x3c + param_10) * 1000 + param_11;
    DAT_0047df0c = iVar1;
  }
  else {
    DAT_0047df20 = ((param_8 * 0x3c + param_9) * 0x3c + _DAT_0047de78 + param_10) * 1000 + param_11;
    if (DAT_0047df20 < 0) {
      DAT_0047df20 = DAT_0047df20 + 86400000;
      DAT_0047df1c = iVar1 + -1;
    }
    else {
      DAT_0047df1c = iVar1;
      if (86399999 < DAT_0047df20) {
        DAT_0047df20 = DAT_0047df20 + -86400000;
        DAT_0047df1c = iVar1 + 1;
      }
    }
    DAT_0047df18 = param_3;
  }
  return;
}



/* FUN_0046cb6f @ 0046cb6f */

void FUN_0046cb6f(void)

{
  crt_report_runtime_error(10);
  FUN_0046d723((void *)0x16);
                    /* WARNING: Subroutine does not return */
  __exit(3);
}



/* _strcmp @ 0046cb90 */

/* Library Function - Single Match
    _strcmp
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

int __cdecl _strcmp(char *_Str1,char *_Str2)

{
  undefined2 uVar1;
  undefined4 uVar2;
  byte bVar3;
  byte bVar4;
  bool bVar5;
  
  if (((uint)_Str1 & 3) != 0) {
    if (((uint)_Str1 & 1) != 0) {
      bVar4 = *_Str1;
      _Str1 = _Str1 + 1;
      bVar5 = bVar4 < (byte)*_Str2;
      if (bVar4 != *_Str2) goto LAB_0046cbd4;
      _Str2 = _Str2 + 1;
      if (bVar4 == 0) {
        return 0;
      }
      if (((uint)_Str1 & 2) == 0) goto LAB_0046cba0;
    }
    uVar1 = *(undefined2 *)_Str1;
    _Str1 = _Str1 + 2;
    bVar4 = (byte)uVar1;
    bVar5 = bVar4 < (byte)*_Str2;
    if (bVar4 != *_Str2) goto LAB_0046cbd4;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((ushort)uVar1 >> 8);
    bVar5 = bVar4 < ((byte *)_Str2)[1];
    if (bVar4 != ((byte *)_Str2)[1]) goto LAB_0046cbd4;
    if (bVar4 == 0) {
      return 0;
    }
    _Str2 = (char *)((byte *)_Str2 + 2);
  }
LAB_0046cba0:
  while( true ) {
    uVar2 = *(undefined4 *)_Str1;
    bVar4 = (byte)uVar2;
    bVar5 = bVar4 < (byte)*_Str2;
    if (bVar4 != *_Str2) break;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((uint)uVar2 >> 8);
    bVar5 = bVar4 < ((byte *)_Str2)[1];
    if (bVar4 != ((byte *)_Str2)[1]) break;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((uint)uVar2 >> 0x10);
    bVar5 = bVar4 < ((byte *)_Str2)[2];
    if (bVar4 != ((byte *)_Str2)[2]) break;
    bVar3 = (byte)((uint)uVar2 >> 0x18);
    if (bVar4 == 0) {
      return 0;
    }
    bVar5 = bVar3 < ((byte *)_Str2)[3];
    if (bVar3 != ((byte *)_Str2)[3]) break;
    _Str2 = (char *)((byte *)_Str2 + 4);
    _Str1 = _Str1 + 4;
    if (bVar3 == 0) {
      return 0;
    }
  }
LAB_0046cbd4:
  return (uint)bVar5 * -2 + 1;
}



/* _strncpy @ 0046cc20 */

/* Library Function - Single Match
    _strncpy
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

char * __cdecl _strncpy(char *_Dest,char *_Source,size_t _Count)

{
  uint uVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  uint *puVar5;
  
  if (_Count == 0) {
    return _Dest;
  }
  puVar5 = (uint *)_Dest;
  if (((uint)_Source & 3) != 0) {
    while( true ) {
      uVar4 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 1);
      *(char *)puVar5 = (char)uVar4;
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
      if (_Count == 0) {
        return _Dest;
      }
      if ((char)uVar4 == '\0') break;
      if (((uint)_Source & 3) == 0) {
        uVar4 = _Count >> 2;
        goto joined_r0x0046cc5e;
      }
    }
    do {
      if (((uint)puVar5 & 3) == 0) {
        uVar4 = _Count >> 2;
        cVar3 = '\0';
        if (uVar4 == 0) goto LAB_0046cc9b;
        goto LAB_0046cd09;
      }
      *(char *)puVar5 = '\0';
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
    } while (_Count != 0);
    return _Dest;
  }
  uVar4 = _Count >> 2;
  if (uVar4 != 0) {
    do {
      uVar1 = *(uint *)_Source;
      uVar2 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 4);
      if (((uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff) & 0x81010100) != 0) {
        if ((char)uVar2 == '\0') {
          *puVar5 = 0;
joined_r0x0046cd05:
          while( true ) {
            uVar4 = uVar4 - 1;
            puVar5 = puVar5 + 1;
            if (uVar4 == 0) break;
LAB_0046cd09:
            *puVar5 = 0;
          }
          cVar3 = '\0';
          _Count = _Count & 3;
          if (_Count != 0) goto LAB_0046cc9b;
          return _Dest;
        }
        if ((char)(uVar2 >> 8) == '\0') {
          *puVar5 = uVar2 & 0xff;
          goto joined_r0x0046cd05;
        }
        if ((uVar2 & 0xff0000) == 0) {
          *puVar5 = uVar2 & 0xffff;
          goto joined_r0x0046cd05;
        }
        if ((uVar2 & 0xff000000) == 0) {
          *puVar5 = uVar2;
          goto joined_r0x0046cd05;
        }
      }
      *puVar5 = uVar2;
      puVar5 = puVar5 + 1;
      uVar4 = uVar4 - 1;
joined_r0x0046cc5e:
    } while (uVar4 != 0);
    _Count = _Count & 3;
    if (_Count == 0) {
      return _Dest;
    }
  }
  do {
    cVar3 = (char)*(uint *)_Source;
    _Source = (char *)((int)_Source + 1);
    *(char *)puVar5 = cVar3;
    puVar5 = (uint *)((int)puVar5 + 1);
    if (cVar3 == '\0') {
      while (_Count = _Count - 1, _Count != 0) {
LAB_0046cc9b:
        *(char *)puVar5 = cVar3;
        puVar5 = (uint *)((int)puVar5 + 1);
      }
      return _Dest;
    }
    _Count = _Count - 1;
  } while (_Count != 0);
  return _Dest;
}



/* FUN_0046cd20 @ 0046cd20 */

int __cdecl FUN_0046cd20(byte *param_1,byte *param_2)

{
  byte bVar1;
  int iVar2;
  byte abStack_28 [32];
  
  abStack_28[0x1c] = 0;
  abStack_28[0x1d] = 0;
  abStack_28[0x1e] = 0;
  abStack_28[0x1f] = 0;
  abStack_28[0x18] = 0;
  abStack_28[0x19] = 0;
  abStack_28[0x1a] = 0;
  abStack_28[0x1b] = 0;
  abStack_28[0x14] = 0;
  abStack_28[0x15] = 0;
  abStack_28[0x16] = 0;
  abStack_28[0x17] = 0;
  abStack_28[0x10] = 0;
  abStack_28[0x11] = 0;
  abStack_28[0x12] = 0;
  abStack_28[0x13] = 0;
  abStack_28[0xc] = 0;
  abStack_28[0xd] = 0;
  abStack_28[0xe] = 0;
  abStack_28[0xf] = 0;
  abStack_28[8] = 0;
  abStack_28[9] = 0;
  abStack_28[10] = 0;
  abStack_28[0xb] = 0;
  abStack_28[4] = 0;
  abStack_28[5] = 0;
  abStack_28[6] = 0;
  abStack_28[7] = 0;
  abStack_28[0] = 0;
  abStack_28[1] = 0;
  abStack_28[2] = 0;
  abStack_28[3] = 0;
  while( true ) {
    bVar1 = *param_2;
    if (bVar1 == 0) break;
    param_2 = param_2 + 1;
    abStack_28[(int)(uint)bVar1 >> 3] = abStack_28[(int)(uint)bVar1 >> 3] | '\x01' << (bVar1 & 7);
  }
  iVar2 = -1;
  do {
    iVar2 = iVar2 + 1;
    bVar1 = *param_1;
    if (bVar1 == 0) {
      return iVar2;
    }
    param_1 = param_1 + 1;
  } while ((abStack_28[(int)(uint)bVar1 >> 3] >> (bVar1 & 7) & 1) == 0);
  return iVar2;
}



/* FUN_0046cd60 @ 0046cd60 */

byte * __cdecl FUN_0046cd60(byte *param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  byte abStack_28 [32];
  
  abStack_28[0x1c] = 0;
  abStack_28[0x1d] = 0;
  abStack_28[0x1e] = 0;
  abStack_28[0x1f] = 0;
  abStack_28[0x18] = 0;
  abStack_28[0x19] = 0;
  abStack_28[0x1a] = 0;
  abStack_28[0x1b] = 0;
  abStack_28[0x14] = 0;
  abStack_28[0x15] = 0;
  abStack_28[0x16] = 0;
  abStack_28[0x17] = 0;
  abStack_28[0x10] = 0;
  abStack_28[0x11] = 0;
  abStack_28[0x12] = 0;
  abStack_28[0x13] = 0;
  abStack_28[0xc] = 0;
  abStack_28[0xd] = 0;
  abStack_28[0xe] = 0;
  abStack_28[0xf] = 0;
  abStack_28[8] = 0;
  abStack_28[9] = 0;
  abStack_28[10] = 0;
  abStack_28[0xb] = 0;
  abStack_28[4] = 0;
  abStack_28[5] = 0;
  abStack_28[6] = 0;
  abStack_28[7] = 0;
  abStack_28[0] = 0;
  abStack_28[1] = 0;
  abStack_28[2] = 0;
  abStack_28[3] = 0;
  while( true ) {
    bVar1 = *param_2;
    if (bVar1 == 0) break;
    param_2 = param_2 + 1;
    abStack_28[(int)(uint)bVar1 >> 3] = abStack_28[(int)(uint)bVar1 >> 3] | '\x01' << (bVar1 & 7);
  }
  do {
    pbVar2 = param_1;
    bVar1 = *pbVar2;
    if (bVar1 == 0) {
      return (byte *)0x0;
    }
    param_1 = pbVar2 + 1;
  } while ((abStack_28[(int)(uint)bVar1 >> 3] >> (bVar1 & 7) & 1) == 0);
  return pbVar2;
}



/* crt_chkstk @ 0046cda0 */

/* WARNING: Unable to track spacebase fully for stack */
/* CRT: stack probing helper for large alloca (size in EAX) */

void crt_chkstk(void)

{
  uint in_EAX;
  undefined1 *puVar1;
  undefined4 unaff_retaddr;
  
  puVar1 = &stack0x00000004;
  for (; 0xfff < in_EAX; in_EAX = in_EAX - 0x1000) {
    puVar1 = puVar1 + -0x1000;
  }
  *(undefined4 *)(puVar1 + (-4 - in_EAX)) = unaff_retaddr;
  return;
}



/* crt_strtol_l @ 0046cdcf */

/* CRT: parse integer with base (locale) */

long __thiscall crt_strtol_l(void *this,void *locale,char *str,char **endptr,int base)

{
  ulong uVar1;
  uint unaff_retaddr;
  
  uVar1 = crt_strtoxl(this,locale,str,endptr,0,unaff_retaddr);
  return uVar1;
}



/* crt_strtoxl @ 0046cde6 */

/* CRT: shared strto* core (base/sign/overflow) */

ulong __thiscall crt_strtoxl(void *this,void *locale,char *str,char **endptr,int base,uint flags)

{
  byte *pbVar1;
  char **ppcVar2;
  uint uVar3;
  char **ppcVar4;
  uint uVar5;
  int iVar6;
  int *piVar7;
  char **this_00;
  byte bVar8;
  undefined *puVar9;
  char **local_c;
  byte *local_8;
  
  local_c = (char **)0x0;
  bVar8 = *(byte *)locale;
  pbVar1 = locale;
  while( true ) {
    local_8 = pbVar1 + 1;
    if (DAT_0047b3cc < 2) {
      uVar3 = (byte)crt_ctype_table[(uint)bVar8 * 2] & 8;
      this = crt_ctype_table;
    }
    else {
      puVar9 = (undefined *)0x8;
      uVar3 = crt_isctype(this,(uint)bVar8,8);
      this = puVar9;
    }
    if (uVar3 == 0) break;
    bVar8 = *local_8;
    pbVar1 = local_8;
  }
  if (bVar8 == 0x2d) {
    base = base | 2;
LAB_0046ce41:
    bVar8 = *local_8;
    local_8 = pbVar1 + 2;
  }
  else if (bVar8 == 0x2b) goto LAB_0046ce41;
  if ((((int)endptr < 0) || (endptr == (char **)0x1)) || (0x24 < (int)endptr)) {
    if (str != (char *)0x0) {
      *(void **)str = locale;
    }
    return 0;
  }
  this_00 = (char **)0x10;
  if (endptr == (char **)0x0) {
    if (bVar8 != 0x30) {
      endptr = (char **)0xa;
      goto LAB_0046ceab;
    }
    if ((*local_8 != 0x78) && (*local_8 != 0x58)) {
      endptr = (char **)0x8;
      goto LAB_0046ceab;
    }
    endptr = (char **)0x10;
  }
  if (((endptr == (char **)0x10) && (bVar8 == 0x30)) && ((*local_8 == 0x78 || (*local_8 == 0x58))))
  {
    bVar8 = local_8[1];
    local_8 = local_8 + 2;
  }
LAB_0046ceab:
  ppcVar4 = (char **)(0xffffffff / ZEXT48(endptr));
  do {
    uVar3 = (uint)bVar8;
    if (DAT_0047b3cc < 2) {
      uVar5 = (byte)crt_ctype_table[uVar3 * 2] & 4;
    }
    else {
      ppcVar2 = (char **)0x4;
      uVar5 = crt_isctype(this_00,uVar3,4);
      this_00 = ppcVar2;
    }
    if (uVar5 == 0) {
      if (DAT_0047b3cc < 2) {
        uVar3 = *(ushort *)(crt_ctype_table + uVar3 * 2) & 0x103;
      }
      else {
        uVar3 = crt_isctype(this_00,uVar3,0x103);
      }
      if (uVar3 == 0) {
LAB_0046cf57:
        local_8 = local_8 + -1;
        if ((base & 8U) == 0) {
          if (str != (char *)0x0) {
            local_8 = locale;
          }
          local_c = (char **)0x0;
        }
        else if (((base & 4U) != 0) ||
                (((base & 1U) == 0 &&
                 ((((base & 2U) != 0 && ((char **)0x80000000 < local_c)) ||
                  (((base & 2U) == 0 && ((char **)0x7fffffff < local_c)))))))) {
          piVar7 = crt_errno_ptr();
          *piVar7 = 0x22;
          if ((base & 1U) == 0) {
            local_c = (char **)(((base & 2U) != 0) + 0x7fffffff);
          }
          else {
            local_c = (char **)0xffffffff;
          }
        }
        if (str != (char *)0x0) {
          *(byte **)str = local_8;
        }
        if ((base & 2U) == 0) {
          return (ulong)local_c;
        }
        return -(int)local_c;
      }
      iVar6 = crt_toupper((int)(char)bVar8);
      this_00 = (char **)(iVar6 + -0x37);
    }
    else {
      this_00 = (char **)((char)bVar8 + -0x30);
    }
    if (endptr <= this_00) goto LAB_0046cf57;
    if ((local_c < ppcVar4) ||
       ((local_c == ppcVar4 && (this_00 <= (char **)(0xffffffff % ZEXT48(endptr)))))) {
      local_c = (char **)((int)local_c * (int)endptr + (int)this_00);
      base = base | 8;
    }
    else {
      base = base | 0xc;
    }
    bVar8 = *local_8;
    local_8 = local_8 + 1;
  } while( true );
}



/* FUN_0046cfeb @ 0046cfeb */

uint __cdecl FUN_0046cfeb(LPWSTR param_1,byte *param_2,uint param_3)

{
  uint uVar1;
  bool bVar2;
  
  InterlockedIncrement((LONG *)&DAT_004da3b0);
  bVar2 = DAT_004da3ac != 0;
  if (bVar2) {
    InterlockedDecrement((LONG *)&DAT_004da3b0);
    crt_lock(0x13);
  }
  uVar1 = FUN_0046d048(param_1,param_2,param_3);
  if (bVar2) {
    crt_unlock(0x13);
  }
  else {
    InterlockedDecrement((LONG *)&DAT_004da3b0);
  }
  return uVar1;
}



/* FUN_0046d048 @ 0046d048 */

uint __cdecl FUN_0046d048(LPWSTR param_1,byte *param_2,uint param_3)

{
  byte bVar1;
  int iVar2;
  int *piVar3;
  
  if ((param_2 != (byte *)0x0) && (param_3 != 0)) {
    bVar1 = *param_2;
    if (bVar1 != 0) {
      if (DAT_004d9a4c == 0) {
        if (param_1 != (LPWSTR)0x0) {
          *param_1 = (ushort)bVar1;
        }
        return 1;
      }
      if ((crt_ctype_table[(uint)bVar1 * 2 + 1] & 0x80) == 0) {
        iVar2 = MultiByteToWideChar(DAT_004d9a5c,9,(LPCCH)param_2,1,param_1,
                                    (uint)(param_1 != (LPWSTR)0x0));
        if (iVar2 != 0) {
          return 1;
        }
      }
      else {
        if (1 < (int)DAT_0047b3cc) {
          if ((int)param_3 < (int)DAT_0047b3cc) goto LAB_0046d0da;
          iVar2 = MultiByteToWideChar(DAT_004d9a5c,9,(LPCCH)param_2,DAT_0047b3cc,param_1,
                                      (uint)(param_1 != (LPWSTR)0x0));
          if (iVar2 != 0) {
            return DAT_0047b3cc;
          }
        }
        if ((DAT_0047b3cc <= param_3) && (param_2[1] != 0)) {
          return DAT_0047b3cc;
        }
      }
LAB_0046d0da:
      piVar3 = crt_errno_ptr();
      *piVar3 = 0x2a;
      return 0xffffffff;
    }
    if (param_1 != (LPWSTR)0x0) {
      *param_1 = L'\0';
    }
  }
  return 0;
}



/* __allshl @ 0046d120 */

/* Library Function - Single Match
    __allshl
   
   Library: Visual Studio */

longlong __fastcall __allshl(byte param_1,int param_2)

{
  uint in_EAX;
  
  if (0x3f < param_1) {
    return 0;
  }
  if (param_1 < 0x20) {
    return CONCAT44(param_2 << (param_1 & 0x1f) | in_EAX >> 0x20 - (param_1 & 0x1f),
                    in_EAX << (param_1 & 0x1f));
  }
  return (ulonglong)(in_EAX << (param_1 & 0x1f)) << 0x20;
}



/* FUN_0046d13f @ 0046d13f */

uint __cdecl FUN_0046d13f(uint param_1,int *param_2)

{
  uint uVar1;
  
  if ((param_1 != 0xffffffff) &&
     ((uVar1 = param_2[3], (uVar1 & 1) != 0 || (((uVar1 & 0x80) != 0 && ((uVar1 & 2) == 0)))))) {
    if (param_2[2] == 0) {
      crt_file_buffer_init((FILE *)param_2);
    }
    if (*param_2 == param_2[2]) {
      if (param_2[1] != 0) {
        return 0xffffffff;
      }
      *param_2 = *param_2 + 1;
    }
    if ((*(byte *)(param_2 + 3) & 0x40) == 0) {
      *param_2 = *param_2 + -1;
      *(char *)*param_2 = (char)param_1;
    }
    else {
      *param_2 = *param_2 + -1;
      if (*(char *)*param_2 != (char)param_1) {
        *param_2 = (int)((char *)*param_2 + 1);
        return 0xffffffff;
      }
    }
    param_2[1] = param_2[1] + 1;
    param_2[3] = param_2[3] & 0xffffffefU | 1;
    return param_1 & 0xff;
  }
  return 0xffffffff;
}



/* FUN_0046d1ad @ 0046d1ad */

/* [binja] int32_t sub_46d1ad(char arg1) */

int __cdecl FUN_0046d1ad(char arg1)

{
  int iVar1;
  
  iVar1 = FUN_0046d1be(arg1,0,'\x04');
  return iVar1;
}



/* FUN_0046d1be @ 0046d1be */

/* [binja] int32_t sub_46d1be(char arg1, int32_t arg2, char arg3) */

int __cdecl FUN_0046d1be(char arg1,int arg2,char arg3)

{
  uint uVar1;
  
  if ((*(byte *)((int)&DAT_004da280 + (byte)arg1 + 1) & arg3) == 0) {
    if (arg2 == 0) {
      uVar1 = 0;
    }
    else {
      uVar1 = (uint)*(ushort *)(&DAT_0047b1ca + (uint)(byte)arg1 * 2) & arg2;
    }
    if (uVar1 == 0) {
      return 0;
    }
  }
  return 1;
}



/* crt_setmbcp @ 0046d1ef */

/* CRT: set multibyte code page and rebuild ctype tables */

int __cdecl crt_setmbcp(int codepage)

{
  BYTE *pBVar1;
  byte *pbVar2;
  byte bVar3;
  byte bVar4;
  UINT CodePage;
  UINT *pUVar5;
  WINBOOL WVar6;
  uint uVar7;
  uint uVar8;
  BYTE *pBVar9;
  int iVar10;
  byte *pbVar11;
  byte *pbVar12;
  int iVar13;
  undefined4 *puVar14;
  _cpinfo local_1c;
  uint local_8;
  
  crt_lock(0x19);
  CodePage = FUN_0046d39c(codepage);
  if (CodePage != DAT_004da164) {
    if (CodePage != 0) {
      iVar13 = 0;
      pUVar5 = &DAT_0047df98;
LAB_0046d22c:
      if (*pUVar5 != CodePage) goto code_r0x0046d230;
      local_8 = 0;
      puVar14 = &DAT_004da280;
      for (iVar10 = 0x40; iVar10 != 0; iVar10 = iVar10 + -1) {
        *puVar14 = 0;
        puVar14 = puVar14 + 1;
      }
      iVar13 = iVar13 * 0x30;
      *(undefined1 *)puVar14 = 0;
      pbVar12 = (byte *)(iVar13 + 0x47dfa8);
      do {
        bVar3 = *pbVar12;
        pbVar11 = pbVar12;
        while ((bVar3 != 0 && (bVar3 = pbVar11[1], bVar3 != 0))) {
          uVar8 = (uint)*pbVar11;
          if (uVar8 <= bVar3) {
            bVar4 = (&DAT_0047df90)[local_8];
            do {
              pbVar2 = (byte *)((int)&DAT_004da280 + uVar8 + 1);
              *pbVar2 = *pbVar2 | bVar4;
              uVar8 = uVar8 + 1;
            } while (uVar8 <= bVar3);
          }
          pbVar11 = pbVar11 + 2;
          bVar3 = *pbVar11;
        }
        local_8 = local_8 + 1;
        pbVar12 = pbVar12 + 8;
      } while (local_8 < 4);
      DAT_004da17c = 1;
      DAT_004da164 = CodePage;
      DAT_004da384 = FUN_0046d3e6(CodePage);
      DAT_004da170 = *(undefined4 *)(iVar13 + 0x47df9c);
      DAT_004da174 = *(undefined4 *)(iVar13 + 0x47dfa0);
      DAT_004da178 = *(undefined4 *)(iVar13 + 0x47dfa4);
      goto LAB_0046d380;
    }
    goto LAB_0046d37b;
  }
  goto LAB_0046d216;
code_r0x0046d230:
  pUVar5 = pUVar5 + 0xc;
  iVar13 = iVar13 + 1;
  if ((UINT *)0x47e087 < pUVar5) goto code_r0x0046d23b;
  goto LAB_0046d22c;
code_r0x0046d23b:
  WVar6 = GetCPInfo(CodePage,&local_1c);
  uVar8 = 1;
  if (WVar6 == 1) {
    DAT_004da384 = 0;
    puVar14 = &DAT_004da280;
    for (iVar13 = 0x40; iVar13 != 0; iVar13 = iVar13 + -1) {
      *puVar14 = 0;
      puVar14 = puVar14 + 1;
    }
    *(undefined1 *)puVar14 = 0;
    if (local_1c.MaxCharSize < 2) {
      DAT_004da17c = 0;
      DAT_004da164 = CodePage;
    }
    else {
      DAT_004da164 = CodePage;
      if (local_1c.LeadByte[0] != '\0') {
        pBVar9 = local_1c.LeadByte + 1;
        do {
          bVar3 = *pBVar9;
          if (bVar3 == 0) break;
          for (uVar7 = (uint)pBVar9[-1]; uVar7 <= bVar3; uVar7 = uVar7 + 1) {
            pbVar12 = (byte *)((int)&DAT_004da280 + uVar7 + 1);
            *pbVar12 = *pbVar12 | 4;
          }
          pBVar1 = pBVar9 + 1;
          pBVar9 = pBVar9 + 2;
        } while (*pBVar1 != 0);
      }
      do {
        pbVar12 = (byte *)((int)&DAT_004da280 + uVar8 + 1);
        *pbVar12 = *pbVar12 | 8;
        uVar8 = uVar8 + 1;
      } while (uVar8 < 0xff);
      DAT_004da384 = FUN_0046d3e6(CodePage);
      DAT_004da17c = 1;
    }
    DAT_004da170 = 0;
    DAT_004da174 = 0;
    DAT_004da178 = 0;
  }
  else {
    if (DAT_004d9cb0 == 0) {
      iVar13 = -1;
      goto LAB_0046d38d;
    }
LAB_0046d37b:
    FUN_0046d419();
  }
LAB_0046d380:
  FUN_0046d442();
LAB_0046d216:
  iVar13 = 0;
LAB_0046d38d:
  crt_unlock(0x19);
  return iVar13;
}



/* FUN_0046d39c @ 0046d39c */

int __cdecl FUN_0046d39c(int param_1)

{
  int iVar1;
  bool bVar2;
  
  if (param_1 == -2) {
    DAT_004d9cb0 = 1;
                    /* WARNING: Could not recover jumptable at 0x0046d3b6. Too many branches */
                    /* WARNING: Treating indirect jump as call */
    iVar1 = GetOEMCP();
    return iVar1;
  }
  if (param_1 == -3) {
    DAT_004d9cb0 = 1;
                    /* WARNING: Could not recover jumptable at 0x0046d3cb. Too many branches */
                    /* WARNING: Treating indirect jump as call */
    iVar1 = GetACP();
    return iVar1;
  }
  bVar2 = param_1 == -4;
  if (bVar2) {
    param_1 = DAT_004d9a5c;
  }
  DAT_004d9cb0 = (uint)bVar2;
  return param_1;
}



/* FUN_0046d3e6 @ 0046d3e6 */

undefined4 __cdecl FUN_0046d3e6(int param_1)

{
  if (param_1 == 0x3a4) {
    return 0x411;
  }
  if (param_1 == 0x3a8) {
    return 0x804;
  }
  if (param_1 == 0x3b5) {
    return 0x412;
  }
  if (param_1 != 0x3b6) {
    return 0;
  }
  return 0x404;
}



/* FUN_0046d419 @ 0046d419 */

void FUN_0046d419(void)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = &DAT_004da280;
  for (iVar1 = 0x40; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  *(undefined1 *)puVar2 = 0;
  DAT_004da164 = 0;
  DAT_004da17c = 0;
  DAT_004da384 = 0;
  DAT_004da170 = 0;
  DAT_004da174 = 0;
  DAT_004da178 = 0;
  return;
}



/* FUN_0046d442 @ 0046d442 */

/* [binja] void* sub_46d442() */

void * FUN_0046d442(void)

{
  WINBOOL WVar1;
  uint uVar2;
  void *pvVar3;
  char cVar4;
  uint uVar5;
  uint uVar6;
  ushort *puVar7;
  undefined1 uVar8;
  BYTE *pBVar9;
  CHAR *pCVar10;
  WORD local_518 [256];
  ushort local_318 [128];
  ushort local_218 [128];
  CHAR local_118 [256];
  _cpinfo local_18;
  
  WVar1 = GetCPInfo(DAT_004da164,&local_18);
  if (WVar1 == 1) {
    uVar2 = 0;
    do {
      local_118[uVar2] = (CHAR)uVar2;
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x100);
    local_118[0] = ' ';
    if (local_18.LeadByte[0] != 0) {
      pBVar9 = local_18.LeadByte + 1;
      do {
        uVar2 = (uint)local_18.LeadByte[0];
        if (uVar2 <= *pBVar9) {
          uVar5 = (*pBVar9 - uVar2) + 1;
          uVar6 = uVar5 >> 2;
          pCVar10 = local_118 + uVar2;
          while (uVar6 != 0) {
            uVar6 = uVar6 - 1;
            builtin_memcpy(pCVar10,"    ",4);
            pCVar10 = pCVar10 + 4;
          }
          for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
            *pCVar10 = ' ';
            pCVar10 = pCVar10 + 1;
          }
        }
        local_18.LeadByte[0] = pBVar9[1];
        pBVar9 = pBVar9 + 2;
      } while (local_18.LeadByte[0] != 0);
    }
    FUN_0046a8ce(1,local_118,0x100,local_518,DAT_004da164,DAT_004da384,0);
    crt_lcmap_string(DAT_004da384,0x100,local_118,0x100,local_218,0x100,DAT_004da164,0);
    crt_lcmap_string(DAT_004da384,0x200,local_118,0x100,local_318,0x100,DAT_004da164,0);
    pvVar3 = (void *)0x0;
    puVar7 = local_518;
    do {
      if ((*puVar7 & 1) == 0) {
        if ((*puVar7 & 2) != 0) {
          *(byte *)((int)pvVar3 + 0x4da281U) = *(byte *)((int)pvVar3 + 0x4da281U) | 0x20;
          uVar8 = *(undefined1 *)((int)local_318 + (int)pvVar3);
          goto LAB_0046d54e;
        }
        *(undefined1 *)((int)pvVar3 + 0x4da180) = 0;
      }
      else {
        *(byte *)((int)pvVar3 + 0x4da281U) = *(byte *)((int)pvVar3 + 0x4da281U) | 0x10;
        uVar8 = *(undefined1 *)((int)local_218 + (int)pvVar3);
LAB_0046d54e:
        *(undefined1 *)((int)pvVar3 + 0x4da180) = uVar8;
      }
      pvVar3 = (void *)((int)pvVar3 + 1);
      puVar7 = puVar7 + 1;
    } while (pvVar3 < (void *)0x100);
  }
  else {
    pvVar3 = (void *)0x0;
    do {
      if ((pvVar3 < (void *)0x41) || ((void *)0x5a < pvVar3)) {
        if (((void *)0x60 < pvVar3) && (pvVar3 < (void *)0x7b)) {
          *(byte *)((int)pvVar3 + 0x4da281U) = *(byte *)((int)pvVar3 + 0x4da281U) | 0x20;
          cVar4 = (char)pvVar3 + -0x20;
          goto LAB_0046d598;
        }
        *(undefined1 *)((int)pvVar3 + 0x4da180) = 0;
      }
      else {
        *(byte *)((int)pvVar3 + 0x4da281U) = *(byte *)((int)pvVar3 + 0x4da281U) | 0x10;
        cVar4 = (char)pvVar3 + ' ';
LAB_0046d598:
        *(char *)((int)pvVar3 + 0x4da180) = cVar4;
      }
      pvVar3 = (void *)((int)pvVar3 + 1);
    } while (pvVar3 < (void *)0x100);
  }
  return pvVar3;
}



/* crt_mbcs_init @ 0046d5c7 */

/* CRT: one-time init of multibyte/ctype tables (GetACP) */

void crt_mbcs_init(void)

{
  if (DAT_004db4ec == 0) {
    crt_setmbcp(-3);
    DAT_004db4ec = 1;
  }
  return;
}



/* FUN_0046d5e3 @ 0046d5e3 */

/* [binja] int32_t sub_46d5e3(int32_t arg1, int32_t arg2, int32_t arg3) */

int __cdecl FUN_0046d5e3(int arg1,int arg2,int arg3)

{
  HMODULE hModule;
  int iVar1;
  
  iVar1 = 0;
  if (DAT_004d9cb4 == (FARPROC)0x0) {
    hModule = LoadLibraryA("user32.dll");
    if (hModule != (HMODULE)0x0) {
      DAT_004d9cb4 = GetProcAddress(hModule,"MessageBoxA");
      if (DAT_004d9cb4 != (FARPROC)0x0) {
        DAT_004d9cb8 = GetProcAddress(hModule,"GetActiveWindow");
        DAT_004d9cbc = GetProcAddress(hModule,"GetLastActivePopup");
        goto LAB_0046d632;
      }
    }
    iVar1 = 0;
  }
  else {
LAB_0046d632:
    if (DAT_004d9cb8 != (FARPROC)0x0) {
      iVar1 = (*DAT_004d9cb8)();
      if ((iVar1 != 0) && (DAT_004d9cbc != (FARPROC)0x0)) {
        iVar1 = (*DAT_004d9cbc)(iVar1);
      }
    }
    iVar1 = (*DAT_004d9cb4)(iVar1,arg1,arg2,arg3);
  }
  return iVar1;
}



/* FUN_0046d66c @ 0046d66c */

undefined4 FUN_0046d66c(void)

{
  return 0;
}



/* FUN_0046d66f @ 0046d66f */

/* [binja] int32_t __stdcall sub_46d66f(int32_t* arg1) */

int FUN_0046d66f(int *arg1)

{
  int *piVar1;
  bool bVar2;
  int extraout_EAX;
  undefined3 extraout_var;
  int iVar3;
  
  piVar1 = (int *)*arg1;
  if (((*piVar1 == -0x1f928c9d) && (piVar1[4] == 3)) && (piVar1[5] == 0x19930520)) {
    crt_terminate();
    return extraout_EAX;
  }
  if ((DAT_004d9cc0 != (FARPROC)0x0) &&
     (bVar2 = FUN_0046d70b(DAT_004d9cc0), CONCAT31(extraout_var,bVar2) != 0)) {
    iVar3 = (*DAT_004d9cc0)(arg1);
    return iVar3;
  }
  return 0;
}



/* FUN_0046d6d3 @ 0046d6d3 */

bool __cdecl FUN_0046d6d3(void *param_1,UINT_PTR param_2)

{
  WINBOOL WVar1;
  
  WVar1 = IsBadReadPtr(param_1,param_2);
  return WVar1 == 0;
}



/* FUN_0046d6ef @ 0046d6ef */

bool __cdecl FUN_0046d6ef(LPVOID param_1,UINT_PTR param_2)

{
  WINBOOL WVar1;
  
  WVar1 = IsBadWritePtr(param_1,param_2);
  return WVar1 == 0;
}



/* FUN_0046d70b @ 0046d70b */

bool __cdecl FUN_0046d70b(FARPROC param_1)

{
  WINBOOL WVar1;
  
  WVar1 = IsBadCodePtr((FARPROC)param_1);
  return WVar1 == 0;
}



/* FUN_0046d723 @ 0046d723 */

/* [binja] int32_t sub_46d723(void* arg1) */

int __cdecl FUN_0046d723(void *arg1)

{
  bool bVar1;
  DWORD *pDVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  code *pcVar6;
  undefined4 *puVar7;
  DWORD local_10;
  DWORD local_c;
  
  bVar1 = false;
  if (arg1 == (void *)0x2) {
    puVar7 = &DAT_004d9cc4;
    pcVar6 = DAT_004d9cc4;
LAB_0046d7a9:
    bVar1 = true;
    crt_lock(1);
    pDVar2 = arg1;
  }
  else {
    if (((arg1 != (void *)0x4) && (arg1 != (void *)0x8)) && (arg1 != (void *)0xb)) {
      if (arg1 == (void *)0xf) {
        puVar7 = &DAT_004d9cd0;
        pcVar6 = DAT_004d9cd0;
      }
      else if (arg1 == (void *)0x15) {
        puVar7 = &DAT_004d9cc8;
        pcVar6 = DAT_004d9cc8;
      }
      else {
        if (arg1 != (void *)0x16) {
          return -1;
        }
        puVar7 = &DAT_004d9ccc;
        pcVar6 = DAT_004d9ccc;
      }
      goto LAB_0046d7a9;
    }
    pDVar2 = crt_get_thread_data();
    uVar3 = FUN_0046d8a5((int)arg1,pDVar2[0x14]);
    puVar7 = (undefined4 *)(uVar3 + 8);
    pcVar6 = (code *)*puVar7;
  }
  if (pcVar6 == (code *)0x1) {
    if (!bVar1) {
      return 0;
    }
    crt_unlock(1);
    return 0;
  }
  if (pcVar6 == (code *)0x0) {
    if (bVar1) {
      crt_unlock(1);
    }
                    /* WARNING: Subroutine does not return */
    __exit(3);
  }
  if (((arg1 == (void *)0x8) || (arg1 == (void *)0xb)) || (arg1 == (void *)0x4)) {
    local_c = pDVar2[0x15];
    pDVar2[0x15] = 0;
    if (arg1 == (void *)0x8) {
      local_10 = pDVar2[0x16];
      pDVar2[0x16] = 0x8c;
      goto LAB_0046d81d;
    }
  }
  else {
LAB_0046d81d:
    if (arg1 == (void *)0x8) {
      if (DAT_0047bad8 < DAT_0047badc + DAT_0047bad8) {
        iVar4 = DAT_0047bad8 * 0xc;
        iVar5 = DAT_0047bad8;
        do {
          iVar4 = iVar4 + 0xc;
          *(undefined4 *)((pDVar2[0x14] - 4) + iVar4) = 0;
          iVar5 = iVar5 + 1;
        } while (iVar5 < DAT_0047badc + DAT_0047bad8);
      }
      goto LAB_0046d85b;
    }
  }
  *puVar7 = 0;
LAB_0046d85b:
  if (bVar1) {
    crt_unlock(1);
  }
  if (arg1 == (void *)0x8) {
    (*pcVar6)(8,pDVar2[0x16]);
  }
  else {
    (*pcVar6)(arg1);
    if ((arg1 != (void *)0xb) && (arg1 != (void *)0x4)) {
      return 0;
    }
  }
  pDVar2[0x15] = local_c;
  if (arg1 == (void *)0x8) {
    pDVar2[0x16] = local_10;
  }
  return 0;
}



/* FUN_0046d8a5 @ 0046d8a5 */

uint __cdecl FUN_0046d8a5(int param_1,uint param_2)

{
  int *piVar1;
  uint uVar2;
  uint uVar3;
  
  uVar2 = param_2;
  if (*(int *)(param_2 + 4) != param_1) {
    uVar3 = param_2;
    do {
      uVar2 = uVar3 + 0xc;
      if (param_2 + DAT_0047bae4 * 0xc <= uVar2) break;
      piVar1 = (int *)(uVar3 + 0x10);
      uVar3 = uVar2;
    } while (*piVar1 != param_1);
  }
  if ((param_2 + DAT_0047bae4 * 0xc <= uVar2) || (*(int *)(uVar2 + 4) != param_1)) {
    uVar2 = 0;
  }
  return uVar2;
}



/* crt_add_u32_carry @ 0046d8e2 */

/* CRT: add two u32 values and return carry */

int __cdecl crt_add_u32_carry(uint a,uint b,uint *out)

{
  uint uVar1;
  int iVar2;
  
  iVar2 = 0;
  uVar1 = a + b;
  if ((uVar1 < a) || (uVar1 < b)) {
    iVar2 = 1;
  }
  *out = uVar1;
  return iVar2;
}



/* ___add_12 @ 0046d903 */

/* Library Function - Single Match
    ___add_12
   
   Library: Visual Studio 2003 Release */

void __cdecl ___add_12(uint *param_1,uint *param_2)

{
  int iVar1;
  
  iVar1 = crt_add_u32_carry(*param_1,*param_2,param_1);
  if (iVar1 != 0) {
    iVar1 = crt_add_u32_carry(param_1[1],1,param_1 + 1);
    if (iVar1 != 0) {
      param_1[2] = param_1[2] + 1;
    }
  }
  iVar1 = crt_add_u32_carry(param_1[1],param_2[1],param_1 + 1);
  if (iVar1 != 0) {
    param_1[2] = param_1[2] + 1;
  }
  crt_add_u32_carry(param_1[2],param_2[2],param_1 + 2);
  return;
}



/* crt_u96_shl1 @ 0046d961 */

/* CRT: shift 96-bit value left by 1 (in-place) */

void __cdecl crt_u96_shl1(uint *value)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = *value;
  uVar2 = value[1];
  *value = uVar1 * 2;
  value[1] = uVar2 * 2 | uVar1 >> 0x1f;
  value[2] = value[2] << 1 | uVar2 >> 0x1f;
  return;
}



/* crt_u96_shr1 @ 0046d98f */

/* CRT: shift 96-bit value right by 1 (in-place) */

void __cdecl crt_u96_shr1(uint *value)

{
  uint uVar1;
  
  uVar1 = value[1];
  value[1] = uVar1 >> 1 | value[2] << 0x1f;
  value[2] = value[2] >> 1;
  *value = *value >> 1 | uVar1 << 0x1f;
  return;
}



/* FUN_0046d9bc @ 0046d9bc */

/* [binja] int32_t sub_46d9bc(char* arg1, int32_t arg2, int32_t arg3) */

int __cdecl FUN_0046d9bc(char *arg1,int arg2,int arg3)

{
  int value;
  int iVar1;
  int extraout_EAX;
  uint local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
  value = arg3;
  local_8 = 0x404e;
  *(undefined4 *)arg3 = 0;
  *(undefined4 *)(arg3 + 4) = 0;
  *(undefined4 *)(arg3 + 8) = 0;
  iVar1 = 0;
  if (arg2 != 0) {
    arg3 = arg2;
    do {
      local_14 = *(uint *)value;
      local_10 = *(undefined4 *)(value + 4);
      local_c = *(undefined4 *)(value + 8);
      crt_u96_shl1((uint *)value);
      crt_u96_shl1((uint *)value);
      ___add_12((uint *)value,&local_14);
      crt_u96_shl1((uint *)value);
      local_10 = 0;
      local_c = 0;
      local_14 = (uint)*arg1;
      iVar1 = ___add_12((uint *)value,&local_14);
      arg1 = arg1 + 1;
      arg3 = arg3 + -1;
    } while (arg3 != 0);
  }
  while (*(int *)(value + 8) == 0) {
    *(uint *)(value + 8) = *(uint *)(value + 4) >> 0x10;
    iVar1 = *(uint *)value << 0x10;
    local_8 = local_8 + 0xfff0;
    *(uint *)(value + 4) = *(uint *)value >> 0x10 | *(uint *)(value + 4) << 0x10;
    *(int *)value = iVar1;
  }
  while ((*(uint *)(value + 8) & 0x8000) == 0) {
    crt_u96_shl1((uint *)value);
    local_8 = local_8 + 0xffff;
    iVar1 = extraout_EAX;
  }
  *(undefined2 *)(value + 10) = (undefined2)local_8;
  return CONCAT22((short)((uint)iVar1 >> 0x10),(undefined2)local_8);
}



/* FUN_0046da83 @ 0046da83 */

undefined4 __cdecl
FUN_0046da83(uint param_1,uint param_2,uint param_3,int param_4,byte param_5,short *param_6)

{
  short *psVar1;
  uint uVar2;
  short *psVar3;
  char cVar4;
  uint uVar5;
  short *psVar6;
  short *psVar7;
  short sVar8;
  int iVar9;
  int iVar10;
  char *pcVar11;
  undefined1 local_20;
  undefined1 local_1f;
  undefined1 local_1e;
  undefined1 local_1d;
  undefined1 local_1c;
  undefined1 local_1b;
  undefined1 local_1a;
  undefined1 local_19;
  undefined1 local_18;
  undefined1 local_17;
  undefined1 local_16;
  undefined1 local_15;
  undefined1 local_14 [4];
  undefined2 uStack_10;
  undefined4 local_e;
  undefined1 local_a;
  char cStack_9;
  undefined4 local_8;
  
  psVar3 = param_6;
  uVar5 = param_3 & 0x7fff;
  local_20 = 0xcc;
  local_1f = 0xcc;
  local_1e = 0xcc;
  local_1d = 0xcc;
  local_1c = 0xcc;
  local_1b = 0xcc;
  local_1a = 0xcc;
  local_19 = 0xcc;
  local_18 = 0xcc;
  local_17 = 0xcc;
  local_16 = 0xfb;
  local_15 = 0x3f;
  local_8 = 1;
  if ((param_3 & 0x8000) == 0) {
    *(undefined1 *)(param_6 + 1) = 0x20;
  }
  else {
    *(undefined1 *)(param_6 + 1) = 0x2d;
  }
  if ((((short)uVar5 != 0) || (param_2 != 0)) || (param_1 != 0)) {
    if ((short)uVar5 == 0x7fff) {
      *param_6 = 1;
      if (((param_2 == 0x80000000) && (param_1 == 0)) || ((param_2 & 0x40000000) != 0)) {
        if (((param_3 & 0x8000) == 0) || (param_2 != 0xc0000000)) {
          if ((param_2 != 0x80000000) || (param_1 != 0)) goto LAB_0046db78;
          pcVar11 = "1#INF";
        }
        else {
          if (param_1 != 0) {
LAB_0046db78:
            pcVar11 = "1#QNAN";
            goto LAB_0046db7d;
          }
          pcVar11 = "1#IND";
        }
        crt_strcpy((char *)(param_6 + 2),pcVar11);
        *(undefined1 *)((int)psVar3 + 3) = 5;
      }
      else {
        pcVar11 = "1#SNAN";
LAB_0046db7d:
        crt_strcpy((char *)(param_6 + 2),pcVar11);
        *(undefined1 *)((int)psVar3 + 3) = 6;
      }
      return 0;
    }
    local_14._0_2_ = 0;
    local_a = (undefined1)uVar5;
    cStack_9 = (char)(uVar5 >> 8);
    sVar8 = (short)(((uVar5 >> 8) + (param_2 >> 0x18) * 2) * 0x4d + -0x134312f4 + uVar5 * 0x4d10 >>
                   0x10);
    local_e = param_2;
    unique0x100002bd = param_1;
    FUN_0046e05b((int *)local_14,-(int)sVar8,1);
    if (0x3ffe < CONCAT11(cStack_9,local_a)) {
      sVar8 = sVar8 + 1;
      FUN_0046de3b((short *)local_14,(int *)&local_20);
    }
    *psVar3 = sVar8;
    iVar10 = param_4;
    if (((param_5 & 1) == 0) || (iVar10 = param_4 + sVar8, 0 < param_4 + sVar8)) {
      if (0x15 < iVar10) {
        iVar10 = 0x15;
      }
      iVar9 = CONCAT11(cStack_9,local_a) - 0x3ffe;
      local_a = 0;
      cStack_9 = '\0';
      param_6 = (short *)0x8;
      do {
        crt_u96_shl1((uint *)local_14);
        param_6 = (short *)((int)param_6 + -1);
      } while (param_6 != (short *)0x0);
      if (iVar9 < 0) {
        param_6 = (short *)0x0;
        for (uVar5 = -iVar9 & 0xff; uVar5 != 0; uVar5 = uVar5 - 1) {
          crt_u96_shr1((uint *)local_14);
        }
      }
      param_4 = iVar10 + 1;
      psVar6 = psVar3 + 2;
      param_6 = psVar6;
      uVar5 = unique0x100001cb;
      uVar2 = local_e;
      if (0 < param_4) {
        do {
          local_e._2_2_ = (undefined2)(uVar2 >> 0x10);
          local_e._0_2_ = (undefined2)uVar2;
          uStack_10 = (undefined2)(uVar5 >> 0x10);
          local_14._2_2_ = (undefined2)uVar5;
          param_1 = CONCAT22(local_14._2_2_,local_14._0_2_);
          param_2 = CONCAT22((undefined2)local_e,uStack_10);
          param_3 = CONCAT13(cStack_9,CONCAT12(local_a,local_e._2_2_));
          unique0x100002d1 = uVar5;
          local_e = uVar2;
          crt_u96_shl1((uint *)local_14);
          crt_u96_shl1((uint *)local_14);
          ___add_12((uint *)local_14,&param_1);
          crt_u96_shl1((uint *)local_14);
          cVar4 = cStack_9;
          cStack_9 = '\0';
          psVar6 = (short *)((int)param_6 + 1);
          param_4 = param_4 + -1;
          *(char *)param_6 = cVar4 + '0';
          param_6 = psVar6;
          uVar5 = stack0xffffffee;
          uVar2 = local_e;
        } while (param_4 != 0);
      }
      psVar7 = psVar6 + -1;
      psVar1 = psVar3 + 2;
      if ('4' < *(char *)((int)psVar6 + -1)) {
        for (; psVar1 <= psVar7; psVar7 = (short *)((int)psVar7 + -1)) {
          if ((char)*psVar7 != '9') {
            if (psVar1 <= psVar7) goto LAB_0046dcd5;
            break;
          }
          *(char *)psVar7 = '0';
        }
        psVar7 = (short *)((int)psVar7 + 1);
        *psVar3 = *psVar3 + 1;
LAB_0046dcd5:
        *(char *)psVar7 = (char)*psVar7 + '\x01';
LAB_0046dcd7:
        cVar4 = ((char)psVar7 - (char)psVar3) + -3;
        *(char *)((int)psVar3 + 3) = cVar4;
        *(undefined1 *)(cVar4 + 4 + (int)psVar3) = 0;
        return local_8;
      }
      for (; psVar1 <= psVar7; psVar7 = (short *)((int)psVar7 + -1)) {
        if ((char)*psVar7 != '0') {
          if (psVar1 <= psVar7) goto LAB_0046dcd7;
          break;
        }
      }
      *psVar3 = 0;
      *(undefined1 *)(psVar3 + 1) = 0x20;
      *(undefined1 *)((int)psVar3 + 3) = 1;
      *(char *)psVar1 = '0';
      goto LAB_0046dd0d;
    }
  }
  *psVar3 = 0;
  *(undefined1 *)(psVar3 + 1) = 0x20;
  *(undefined1 *)((int)psVar3 + 3) = 1;
  *(undefined1 *)(psVar3 + 2) = 0x30;
LAB_0046dd0d:
  *(undefined1 *)((int)psVar3 + 5) = 0;
  return 1;
}



/* crt_chsize @ 0046dd16 */

/* resize file (truncate/extend via lseek + SetEndOfFile/zero fill) */

int __cdecl crt_chsize(int fd,int size)

{
  long offset;
  long lVar1;
  int iVar2;
  uint count;
  int iVar3;
  uint *puVar4;
  int *piVar5;
  void *hFile;
  WINBOOL WVar6;
  DWORD DVar7;
  int iVar8;
  uint uVar9;
  char local_1008 [4064];
  undefined4 uStackY_28;
  
  crt_chkstk();
  iVar8 = 0;
  offset = crt_lseek_nolock(fd,0,1);
  if ((offset == -1) || (lVar1 = crt_lseek_nolock(fd,0,2), lVar1 == -1)) {
    iVar8 = -1;
  }
  else {
    uVar9 = size - lVar1;
    if ((int)uVar9 < 1) {
      if ((int)uVar9 < 0) {
        crt_lseek_nolock(fd,size,0);
        hFile = crt_get_osfhandle(fd);
        WVar6 = SetEndOfFile(hFile);
        iVar8 = (WVar6 != 0) - 1;
        if (iVar8 == -1) {
          piVar5 = crt_errno_ptr();
          *piVar5 = 0xd;
          DVar7 = GetLastError();
          puVar4 = crt_doserrno_ptr();
          *puVar4 = DVar7;
        }
      }
    }
    else {
      _memset(local_1008,0,0x1000);
      uStackY_28 = 0x46dd83;
      iVar2 = FUN_0046e261(fd,0x8000);
      do {
        count = 0x1000;
        if ((int)uVar9 < 0x1000) {
          count = uVar9;
        }
        iVar3 = crt_write_nolock(fd,local_1008,count);
        if (iVar3 == -1) {
          puVar4 = crt_doserrno_ptr();
          if (*puVar4 == 5) {
            piVar5 = crt_errno_ptr();
            *piVar5 = 0xd;
          }
          iVar8 = -1;
          break;
        }
        uVar9 = uVar9 - iVar3;
      } while (0 < (int)uVar9);
      FUN_0046e261(fd,iVar2);
    }
    crt_lseek_nolock(fd,offset,0);
  }
  return iVar8;
}



/* FUN_0046de3b @ 0046de3b */

/* [binja] int16_t* sub_46de3b(int16_t* arg1, int32_t* arg2) */

short * __cdecl FUN_0046de3b(short *arg1,int *arg2)

{
  short *psVar1;
  short sVar2;
  int iVar3;
  short *psVar4;
  int *piVar5;
  short *psVar6;
  int iVar7;
  ushort uVar8;
  uint uVar9;
  uint uVar10;
  byte local_28;
  undefined1 uStack_27;
  short sStack_26;
  short local_24;
  undefined2 uStack_22;
  undefined2 local_20;
  undefined1 uStack_1e;
  byte bStack_1d;
  int *local_1c;
  int local_18;
  int local_14;
  ushort *local_10;
  ushort *local_c;
  short *local_8;
  
  piVar5 = arg2;
  psVar4 = arg1;
  local_18 = 0;
  local_28 = 0;
  uStack_27 = 0;
  sStack_26 = 0;
  local_24 = 0;
  uStack_22 = 0;
  local_20 = 0;
  uStack_1e = 0;
  bStack_1d = 0;
  psVar6 = (short *)((ushort)arg1[5] & 0x7fff);
  uVar9 = *(ushort *)((int)arg2 + 10) & 0x7fff;
  uVar10 = (ushort)(*(ushort *)((int)arg2 + 10) ^ arg1[5]) & 0x8000;
  psVar1 = (short *)(uVar9 + (int)psVar6);
  if ((((ushort)psVar6 < 0x7fff) && (uVar8 = (ushort)uVar9, uVar8 < 0x7fff)) &&
     ((ushort)psVar1 < 0xbffe)) {
    if ((ushort)psVar1 < 0x3fc0) {
LAB_0046dede:
      psVar4[4] = 0;
      psVar4[5] = 0;
      psVar4[2] = 0;
      psVar4[3] = 0;
      psVar4[0] = 0;
      psVar4[1] = 0;
      return (short *)0x0;
    }
    if ((((ushort)psVar6 != 0) ||
        (psVar1 = (short *)((int)psVar1 + 1), (*(uint *)(arg1 + 4) & 0x7fffffff) != 0)) ||
       ((psVar6 = (short *)0x0, *(int *)(arg1 + 2) != 0 || (*(int *)arg1 != 0)))) {
      arg1 = psVar1;
      if (((uVar8 == 0) && (arg1 = (short *)((int)arg1 + 1), (arg2[2] & 0x7fffffffU) == 0)) &&
         ((arg2[1] == 0 && (*arg2 == 0)))) goto LAB_0046dede;
      local_14 = 0;
      local_8 = &local_24;
      arg2 = (int *)0x5;
      do {
        if (0 < (int)arg2) {
          local_c = (ushort *)(psVar4 + local_14);
          local_10 = (ushort *)(piVar5 + 2);
          local_1c = arg2;
          do {
            iVar7 = crt_add_u32_carry(*(uint *)(local_8 + -2),(uint)*local_c * (uint)*local_10,
                                      (uint *)(local_8 + -2));
            if (iVar7 != 0) {
              *local_8 = *local_8 + 1;
            }
            local_c = local_c + 1;
            local_10 = local_10 + -1;
            local_1c = (int *)((int)local_1c + -1);
          } while (local_1c != (int *)0x0);
        }
        local_8 = local_8 + 1;
        local_14 = local_14 + 1;
        arg2 = (int *)((int)arg2 + -1);
      } while (0 < (int)arg2);
      arg1 = arg1 + 0x6001;
      if ((short)arg1 < 1) {
LAB_0046df92:
        arg1 = (short *)((int)arg1 + 0xffff);
        if ((short)arg1 < 0) {
          iVar7 = -(int)(short)arg1;
          arg1 = (short *)((int)arg1 + iVar7);
          do {
            if ((local_28 & 1) != 0) {
              local_18 = local_18 + 1;
            }
            crt_u96_shr1((uint *)&local_28);
            iVar7 = iVar7 + -1;
          } while (iVar7 != 0);
          if (local_18 != 0) {
            local_28 = local_28 | 1;
          }
        }
      }
      else {
        do {
          if ((bStack_1d & 0x80) != 0) break;
          crt_u96_shl1((uint *)&local_28);
          arg1 = (short *)((int)arg1 + 0xffff);
        } while (0 < (short)arg1);
        if ((short)arg1 < 1) goto LAB_0046df92;
      }
      if ((0x8000 < CONCAT11(uStack_27,local_28)) ||
         (sVar2 = CONCAT11(bStack_1d,uStack_1e), iVar3 = CONCAT22(local_20,uStack_22),
         iVar7 = CONCAT22(local_24,sStack_26),
         (CONCAT22(sStack_26,CONCAT11(uStack_27,local_28)) & 0x1ffff) == 0x18000)) {
        if (CONCAT22(local_24,sStack_26) == -1) {
          iVar7 = 0;
          if (CONCAT22(local_20,uStack_22) == -1) {
            if (CONCAT11(bStack_1d,uStack_1e) == -1) {
              arg1 = (short *)((int)arg1 + 1);
              sVar2 = -0x8000;
              iVar3 = 0;
              iVar7 = 0;
            }
            else {
              sVar2 = CONCAT11(bStack_1d,uStack_1e) + 1;
              iVar3 = 0;
              iVar7 = 0;
            }
          }
          else {
            sVar2 = CONCAT11(bStack_1d,uStack_1e);
            iVar3 = CONCAT22(local_20,uStack_22) + 1;
          }
        }
        else {
          iVar7 = CONCAT22(local_24,sStack_26) + 1;
          sVar2 = CONCAT11(bStack_1d,uStack_1e);
          iVar3 = CONCAT22(local_20,uStack_22);
        }
      }
      local_24 = (short)((uint)iVar7 >> 0x10);
      sStack_26 = (short)iVar7;
      local_20 = (undefined2)((uint)iVar3 >> 0x10);
      uStack_22 = (undefined2)iVar3;
      bStack_1d = (byte)((ushort)sVar2 >> 8);
      uStack_1e = (undefined1)sVar2;
      psVar6 = arg1;
      if (0x7ffe < (ushort)arg1) goto LAB_0046e03b;
      psVar6 = (short *)((uint)arg1 | uVar10);
      *psVar4 = sStack_26;
      *(uint *)(psVar4 + 1) = CONCAT22(uStack_22,local_24);
      *(uint *)(psVar4 + 3) = CONCAT13(bStack_1d,CONCAT12(uStack_1e,local_20));
    }
    psVar4[5] = (short)psVar6;
  }
  else {
LAB_0046e03b:
    psVar4[2] = 0;
    psVar4[3] = 0;
    psVar4[0] = 0;
    psVar4[1] = 0;
    *(uint *)(psVar4 + 4) = (-(uint)((short)uVar10 != 0) & 0x80000000) + 0x7fff8000;
  }
  return psVar6;
}



/* FUN_0046e05b @ 0046e05b */

void __cdecl FUN_0046e05b(int *param_1,uint param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  undefined **ppuVar3;
  undefined **arg2;
  undefined2 local_10;
  undefined4 local_e;
  undefined2 uStack_a;
  undefined *puStack_8;
  
  ppuVar3 = &PTR_s_November_0047e120;
  if (param_2 != 0) {
    if ((int)param_2 < 0) {
      param_2 = -param_2;
      ppuVar3 = (undefined **)0x47e280;
    }
    if (param_3 == 0) {
      *(undefined2 *)param_1 = 0;
    }
    while (param_2 != 0) {
      ppuVar3 = ppuVar3 + 0x15;
      uVar1 = (int)param_2 >> 3;
      uVar2 = param_2 & 7;
      param_2 = uVar1;
      if (uVar2 != 0) {
        arg2 = ppuVar3 + uVar2 * 3;
        if (0x7fff < *(ushort *)(ppuVar3 + uVar2 * 3)) {
          local_10 = SUB42(*arg2,0);
          local_e._0_2_ = (undefined2)((uint)*arg2 >> 0x10);
          local_e._2_2_ = SUB42(arg2[1],0);
          uStack_a = (undefined2)((uint)arg2[1] >> 0x10);
          puStack_8 = arg2[2];
          local_e = CONCAT22(local_e._2_2_,(undefined2)local_e) + -1;
          arg2 = (undefined **)&local_10;
        }
        FUN_0046de3b((short *)param_1,(int *)arg2);
      }
    }
  }
  return;
}



/* FUN_0046e0d7 @ 0046e0d7 */

int __cdecl FUN_0046e0d7(uchar *param_1)

{
  int iVar1;
  size_t _MaxCount;
  size_t sVar2;
  int *piVar3;
  
  if (((DAT_004db4e8 != 0) &&
      ((DAT_004d99a0 != (int *)0x0 ||
       (((DAT_004d99a8 != 0 && (iVar1 = FUN_0046e301(), iVar1 == 0)) && (DAT_004d99a0 != (int *)0x0)
        ))))) && (piVar3 = DAT_004d99a0, param_1 != (uchar *)0x0)) {
    _MaxCount = _strlen((char *)param_1);
    for (; (char *)*piVar3 != (char *)0x0; piVar3 = piVar3 + 1) {
      sVar2 = _strlen((char *)*piVar3);
      if (((_MaxCount < sVar2) && (((uchar *)*piVar3)[_MaxCount] == '=')) &&
         (iVar1 = __mbsnbicoll((uchar *)*piVar3,param_1,_MaxCount), iVar1 == 0)) {
        return *piVar3 + 1 + _MaxCount;
      }
    }
  }
  return 0;
}



/* FUN_0046e160 @ 0046e160 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* [binja] int32_t sub_46e160(char* arg1, char* arg2, int32_t arg3) */

int __cdecl FUN_0046e160(char *arg1,char *arg2,int arg3)

{
  char cVar1;
  int iVar2;
  byte bVar3;
  ushort uVar4;
  uint uVar5;
  void *locale;
  int iVar6;
  void *this;
  void *locale_00;
  bool bVar7;
  
  iVar2 = _DAT_004da3b0;
  iVar6 = 0;
  if (arg3 != 0) {
    if (DAT_004d9a4c == 0) {
      do {
        bVar3 = *arg1;
        cVar1 = *arg2;
        uVar4 = CONCAT11(bVar3,cVar1);
        if (bVar3 == 0) break;
        uVar4 = CONCAT11(bVar3,cVar1);
        uVar5 = (uint)uVar4;
        if (cVar1 == '\0') break;
        arg1 = (char *)((byte *)arg1 + 1);
        arg2 = arg2 + 1;
        if ((0x40 < bVar3) && (bVar3 < 0x5b)) {
          uVar5 = (uint)CONCAT11(bVar3 + 0x20,cVar1);
        }
        uVar4 = (ushort)uVar5;
        bVar3 = (byte)uVar5;
        if ((0x40 < bVar3) && (bVar3 < 0x5b)) {
          uVar4 = (ushort)CONCAT31((int3)(uVar5 >> 8),bVar3 + 0x20);
        }
        bVar3 = (byte)(uVar4 >> 8);
        bVar7 = bVar3 < (byte)uVar4;
        if (bVar3 != (byte)uVar4) goto LAB_0046e1bf;
        arg3 = arg3 + -1;
      } while (arg3 != 0);
      iVar6 = 0;
      bVar3 = (byte)(uVar4 >> 8);
      bVar7 = bVar3 < (byte)uVar4;
      if (bVar3 != (byte)uVar4) {
LAB_0046e1bf:
        iVar6 = -1;
        if (!bVar7) {
          iVar6 = 1;
        }
      }
    }
    else {
      LOCK();
      _DAT_004da3b0 = _DAT_004da3b0 + 1;
      UNLOCK();
      bVar7 = 0 < DAT_004da3ac;
      if (bVar7) {
        LOCK();
        UNLOCK();
        _DAT_004da3b0 = iVar2;
        crt_lock(0x13);
      }
      uVar5 = (uint)bVar7;
      locale = (void *)0x0;
      locale_00 = (void *)0x0;
      do {
        locale = (void *)CONCAT31((int3)((uint)locale >> 8),*arg1);
        locale_00 = (void *)CONCAT31((int3)((uint)locale_00 >> 8),*arg2);
        if ((locale == (void *)0x0) || (locale_00 == (void *)0x0)) break;
        arg1 = arg1 + 1;
        arg2 = arg2 + 1;
        locale_00 = (void *)crt_tolower_l((void *)arg3,locale_00,(int)locale);
        locale = (void *)crt_tolower_l(this,locale,arg3);
        bVar7 = locale < locale_00;
        if (locale != locale_00) goto LAB_0046e235;
        arg3 = arg3 + -1;
      } while ((void *)arg3 != (void *)0x0);
      iVar6 = 0;
      bVar7 = locale < locale_00;
      if (locale != locale_00) {
LAB_0046e235:
        iVar6 = -1;
        if (!bVar7) {
          iVar6 = 1;
        }
      }
      if (uVar5 == 0) {
        LOCK();
        _DAT_004da3b0 = _DAT_004da3b0 + -1;
        UNLOCK();
      }
      else {
        crt_unlock(0x13);
      }
    }
  }
  return iVar6;
}



/* FUN_0046e261 @ 0046e261 */

int __cdecl FUN_0046e261(uint param_1,int param_2)

{
  byte bVar1;
  int *piVar2;
  byte bVar3;
  
  bVar1 = *(byte *)((&DAT_004da3c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24);
  if (param_2 == 0x8000) {
    bVar3 = bVar1 & 0x7f;
  }
  else {
    if (param_2 != 0x4000) {
      piVar2 = crt_errno_ptr();
      *piVar2 = 0x16;
      return -1;
    }
    bVar3 = bVar1 | 0x80;
  }
  *(byte *)((&DAT_004da3c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) = bVar3;
  return (-(uint)((bVar1 & 0x80) != 0) & 0xffffc000) + 0x8000;
}



/* __mbsnbicoll @ 0046e2c2 */

/* Library Function - Single Match
    __mbsnbicoll
   
   Library: Visual Studio 2003 Release */

int __cdecl __mbsnbicoll(uchar *_Str1,uchar *_Str2,size_t _MaxCount)

{
  int iVar1;
  
  if (_MaxCount == 0) {
    return 0;
  }
  iVar1 = FUN_0046e36f(DAT_004da384,1,_Str1,_MaxCount,_Str2,_MaxCount,DAT_004da164);
  if (iVar1 == 0) {
    return 0x7fffffff;
  }
  return iVar1 + -2;
}



/* FUN_0046e301 @ 0046e301 */

/* [binja] int32_t sub_46e301() */

int FUN_0046e301(void)

{
  LPCWCH lpWideCharStr;
  size_t _Size;
  char *lpMultiByteStr;
  int iVar1;
  undefined4 *puVar2;
  
  lpWideCharStr = (LPCWCH)*DAT_004d99a8;
  puVar2 = DAT_004d99a8;
  while( true ) {
    if (lpWideCharStr == (LPCWCH)0x0) {
      return 0;
    }
    _Size = WideCharToMultiByte(1,0,lpWideCharStr,-1,(LPSTR)0x0,0,(LPCCH)0x0,(LPBOOL)0x0);
    if (((_Size == 0) || (lpMultiByteStr = _malloc(_Size), lpMultiByteStr == (char *)0x0)) ||
       (iVar1 = WideCharToMultiByte(1,0,(LPCWCH)*puVar2,-1,lpMultiByteStr,_Size,(LPCCH)0x0,
                                    (LPBOOL)0x0), iVar1 == 0)) break;
    FUN_0046e617(lpMultiByteStr,0);
    lpWideCharStr = (LPCWCH)puVar2[1];
    puVar2 = puVar2 + 1;
  }
  return -1;
}



/* FUN_0046e36f @ 0046e36f */

int __cdecl
FUN_0046e36f(LCID param_1,DWORD param_2,byte *param_3,int param_4,byte *param_5,int param_6,
            UINT param_7)

{
  undefined1 *puVar1;
  int iVar2;
  WINBOOL WVar3;
  BYTE *pBVar4;
  int iVar5;
  _cpinfo local_40;
  undefined1 *local_2c;
  PCNZWCH local_28;
  int local_24;
  int local_20;
  undefined1 *local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_004701b8;
  puStack_10 = &LAB_00465e70;
  local_14 = ExceptionList;
  local_1c = &stack0xffffffb0;
  ExceptionList = &local_14;
  puVar1 = &stack0xffffffb0;
  if (DAT_004d9cf4 == 0) {
    ExceptionList = &local_14;
    iVar2 = CompareStringW(0,0,L"",1,L"",1);
    if (iVar2 == 0) {
      iVar2 = CompareStringA(0,0,&DAT_004ab1a8,1,&DAT_004ab1a8,1);
      if (iVar2 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      DAT_004d9cf4 = 2;
      puVar1 = local_1c;
    }
    else {
      DAT_004d9cf4 = 1;
      puVar1 = local_1c;
    }
  }
  local_1c = puVar1;
  if (0 < param_4) {
    param_4 = FUN_0046e5ec((char *)param_3,param_4);
  }
  if (0 < param_6) {
    param_6 = FUN_0046e5ec((char *)param_5,param_6);
  }
  if (DAT_004d9cf4 == 2) {
    iVar2 = CompareStringA(param_1,param_2,(PCNZCH)param_3,param_4,(PCNZCH)param_5,param_6);
    ExceptionList = local_14;
    return iVar2;
  }
  if (DAT_004d9cf4 == 1) {
    if (param_7 == 0) {
      param_7 = DAT_004d9a5c;
    }
    if ((param_4 == 0) || (param_6 == 0)) {
      if (param_4 == param_6) {
        ExceptionList = local_14;
        return 2;
      }
      if (1 < param_6) {
        ExceptionList = local_14;
        return 1;
      }
      if (1 < param_4) {
        ExceptionList = local_14;
        return 3;
      }
      WVar3 = GetCPInfo(param_7,&local_40);
      if (WVar3 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      if (0 < param_4) {
        if (local_40.MaxCharSize < 2) {
          ExceptionList = local_14;
          return 3;
        }
        pBVar4 = local_40.LeadByte;
        while( true ) {
          if (local_40.LeadByte[0] == 0) {
            ExceptionList = local_14;
            return 3;
          }
          if (pBVar4[1] == 0) break;
          if ((*pBVar4 <= *param_3) && (*param_3 <= pBVar4[1])) {
            ExceptionList = local_14;
            return 2;
          }
          pBVar4 = pBVar4 + 2;
          local_40.LeadByte[0] = *pBVar4;
        }
        ExceptionList = local_14;
        return 3;
      }
      if (0 < param_6) {
        if (local_40.MaxCharSize < 2) {
          ExceptionList = local_14;
          return 1;
        }
        pBVar4 = local_40.LeadByte;
        while( true ) {
          if (local_40.LeadByte[0] == 0) {
            ExceptionList = local_14;
            return 1;
          }
          if (pBVar4[1] == 0) break;
          if ((*pBVar4 <= *param_5) && (*param_5 <= pBVar4[1])) {
            ExceptionList = local_14;
            return 2;
          }
          pBVar4 = pBVar4 + 2;
          local_40.LeadByte[0] = *pBVar4;
        }
        ExceptionList = local_14;
        return 1;
      }
    }
    local_20 = MultiByteToWideChar(param_7,9,(LPCCH)param_3,param_4,(LPWSTR)0x0,0);
    if (local_20 != 0) {
      local_8 = 0;
      crt_chkstk();
      local_8 = 0xffffffff;
      if ((&stack0x00000000 != (undefined1 *)0x50) &&
         (local_28 = (PCNZWCH)&stack0xffffffb0, local_1c = &stack0xffffffb0,
         iVar2 = MultiByteToWideChar(param_7,1,(LPCCH)param_3,param_4,(LPWSTR)&stack0xffffffb0,
                                     local_20), iVar2 != 0)) {
        iVar2 = MultiByteToWideChar(param_7,9,(LPCCH)param_5,param_6,(LPWSTR)0x0,0);
        if (iVar2 != 0) {
          local_8 = 1;
          local_24 = iVar2;
          crt_chkstk();
          local_8 = 0xffffffff;
          if ((&stack0x00000000 != (undefined1 *)0x50) &&
             (local_2c = &stack0xffffffb0, local_1c = &stack0xffffffb0,
             iVar5 = MultiByteToWideChar(param_7,1,(LPCCH)param_5,param_6,(LPWSTR)&stack0xffffffb0,
                                         iVar2), iVar5 != 0)) {
            iVar2 = CompareStringW(param_1,param_2,local_28,local_20,(PCNZWCH)&stack0xffffffb0,iVar2
                                  );
            ExceptionList = local_14;
            return iVar2;
          }
        }
      }
    }
  }
  ExceptionList = local_14;
  return 0;
}



/* FUN_0046e5ec @ 0046e5ec */

int __cdecl FUN_0046e5ec(char *param_1,int param_2)

{
  char *pcVar1;
  int iVar2;
  
  iVar2 = param_2;
  for (pcVar1 = param_1; (iVar2 != 0 && (iVar2 = iVar2 + -1, *pcVar1 != '\0')); pcVar1 = pcVar1 + 1)
  {
  }
  if (*pcVar1 != '\0') {
    return param_2;
  }
  return (int)pcVar1 - (int)param_1;
}



/* FUN_0046e617 @ 0046e617 */

/* [binja] int32_t sub_46e617(char* arg1, int32_t arg2) */

int __cdecl FUN_0046e617(char *arg1,int arg2)

{
  byte *pbVar1;
  int iVar2;
  int *piVar3;
  size_t sVar4;
  char *dst;
  int *piVar5;
  bool bVar6;
  
  if (arg1 == (char *)0x0) {
    return -1;
  }
  pbVar1 = FUN_0046e85d((byte *)arg1,0x3d);
  if (pbVar1 == (byte *)0x0) {
    return -1;
  }
  if ((byte *)arg1 == pbVar1) {
    return -1;
  }
  bVar6 = pbVar1[1] == 0;
  if (DAT_004d99a0 == DAT_004d99a4) {
    DAT_004d99a0 = FUN_0046e7f6(DAT_004d99a0);
  }
  if (DAT_004d99a0 == (int *)0x0) {
    if ((arg2 == 0) || (DAT_004d99a8 == (undefined4 *)0x0)) {
      if (bVar6) {
        return 0;
      }
      DAT_004d99a0 = _malloc(4);
      if (DAT_004d99a0 == (int *)0x0) {
        return -1;
      }
      *DAT_004d99a0 = 0;
      if (DAT_004d99a8 == (undefined4 *)0x0) {
        DAT_004d99a8 = _malloc(4);
        if (DAT_004d99a8 == (undefined4 *)0x0) {
          return -1;
        }
        *DAT_004d99a8 = 0;
      }
    }
    else {
      iVar2 = FUN_0046e301();
      if (iVar2 != 0) {
        return -1;
      }
    }
  }
  piVar3 = DAT_004d99a0;
  iVar2 = FUN_0046e79e((uchar *)arg1,(int)pbVar1 - (int)arg1);
  if ((iVar2 < 0) || (*piVar3 == 0)) {
    if (bVar6) {
      return 0;
    }
    if (iVar2 < 0) {
      iVar2 = -iVar2;
    }
    piVar3 = crt_realloc(piVar3,iVar2 * 4 + 8);
    if (piVar3 == (int *)0x0) {
      return -1;
    }
    piVar3[iVar2] = (int)arg1;
    piVar3[iVar2 + 1] = 0;
  }
  else {
    if (!bVar6) {
      piVar3[iVar2] = (int)arg1;
      goto LAB_0046e74b;
    }
    piVar5 = piVar3 + iVar2;
    crt_free_base((void *)piVar3[iVar2]);
    for (; *piVar5 != 0; piVar5 = piVar5 + 1) {
      iVar2 = iVar2 + 1;
      *piVar5 = piVar5[1];
    }
    piVar3 = crt_realloc(piVar3,iVar2 << 2);
    if (piVar3 == (int *)0x0) goto LAB_0046e74b;
  }
  DAT_004d99a0 = piVar3;
LAB_0046e74b:
  if (arg2 != 0) {
    sVar4 = _strlen(arg1);
    dst = _malloc(sVar4 + 2);
    if (dst != (char *)0x0) {
      crt_strcpy(dst,arg1);
      pbVar1[(int)dst - (int)arg1] = 0;
      SetEnvironmentVariableA
                (dst,(LPCSTR)(~-(uint)bVar6 & (uint)(pbVar1 + ((int)dst - (int)arg1) + 1)));
      crt_free_base(dst);
    }
  }
  return 0;
}



/* FUN_0046e79e @ 0046e79e */

int __cdecl FUN_0046e79e(uchar *param_1,size_t param_2)

{
  uchar *_Str2;
  int iVar1;
  int *piVar2;
  
  _Str2 = (uchar *)*DAT_004d99a0;
  piVar2 = DAT_004d99a0;
  while( true ) {
    if (_Str2 == (uchar *)0x0) {
      return -((int)piVar2 - (int)DAT_004d99a0 >> 2);
    }
    iVar1 = __mbsnbicoll(param_1,_Str2,param_2);
    if ((iVar1 == 0) &&
       ((*(char *)(*piVar2 + param_2) == '=' || (*(char *)(*piVar2 + param_2) == '\0')))) break;
    _Str2 = (uchar *)piVar2[1];
    piVar2 = piVar2 + 1;
  }
  return (int)piVar2 - (int)DAT_004d99a0 >> 2;
}



/* FUN_0046e7f6 @ 0046e7f6 */

/* [binja] void* sub_46e7f6(int32_t* arg1) */

void * __cdecl FUN_0046e7f6(int *arg1)

{
  int iVar1;
  int *piVar2;
  undefined4 *puVar3;
  char *pcVar4;
  int iVar5;
  undefined4 *puVar6;
  
  iVar5 = 0;
  if (arg1 != (int *)0x0) {
    iVar1 = *arg1;
    piVar2 = arg1;
    while (iVar1 != 0) {
      piVar2 = piVar2 + 1;
      iVar5 = iVar5 + 1;
      iVar1 = *piVar2;
    }
    puVar3 = _malloc(iVar5 * 4 + 4);
    if (puVar3 == (undefined4 *)0x0) {
      __amsg_exit(9);
    }
    pcVar4 = (char *)*arg1;
    puVar6 = puVar3;
    while (pcVar4 != (char *)0x0) {
      arg1 = arg1 + 1;
      pcVar4 = strdup_malloc(pcVar4);
      *puVar6 = pcVar4;
      puVar6 = puVar6 + 1;
      pcVar4 = (char *)*arg1;
    }
    *puVar6 = 0;
    return puVar3;
  }
  return (void *)0x0;
}



/* FUN_0046e85d @ 0046e85d */

byte * __cdecl FUN_0046e85d(byte *param_1,uint param_2)

{
  byte bVar1;
  byte *pbVar2;
  uint uVar3;
  
  if (DAT_004da17c == 0) {
    pbVar2 = (byte *)_strchr((char *)param_1,param_2);
  }
  else {
    crt_lock(0x19);
    while( true ) {
      bVar1 = *param_1;
      uVar3 = (uint)bVar1;
      if (bVar1 == 0) break;
      if ((*(byte *)((int)&DAT_004da280 + uVar3 + 1) & 4) == 0) {
        pbVar2 = param_1;
        if (param_2 == uVar3) break;
      }
      else {
        pbVar2 = param_1 + 1;
        if (param_1[1] == 0) {
          crt_unlock(0x19);
          return (byte *)0x0;
        }
        if (param_2 == CONCAT11(bVar1,param_1[1])) {
          crt_unlock(0x19);
          return param_1;
        }
      }
      param_1 = pbVar2 + 1;
    }
    crt_unlock(0x19);
    pbVar2 = (byte *)(~-(uint)(param_2 != uVar3) & (uint)param_1);
  }
  return pbVar2;
}



/* strdup_malloc @ 0046e8f4 */

/* malloc+copy helper */

char * __cdecl strdup_malloc(char *src)

{
  size_t sVar1;
  char *pcVar2;
  
  if (src != (char *)0x0) {
    sVar1 = _strlen(src);
    pcVar2 = _malloc(sVar1 + 1);
    if (pcVar2 != (char *)0x0) {
      pcVar2 = crt_strcpy(pcVar2,src);
      return pcVar2;
    }
  }
  return (char *)0x0;
}



